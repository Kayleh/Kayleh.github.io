<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Kayleh&#39;s blog</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://kayleh.top/"/>
  <updated>2020-09-30T17:23:43.355Z</updated>
  <id>https://kayleh.top/</id>
  
  <author>
    <name>Kayleh</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>偏导数</title>
    <link href="https://kayleh.top/partial-derivative/"/>
    <id>https://kayleh.top/partial-derivative/</id>
    <published>2020-09-30T05:38:35.000Z</published>
    <updated>2020-09-30T17:23:43.355Z</updated>
    
    <content type="html"><![CDATA[<h3 id="在某点偏导的定义"><a href="#在某点偏导的定义" class="headerlink" title="在某点偏导的定义"></a>在某点偏导的定义</h3><p><img src= "/img/loading.gif" data-lazy-src="/partial-derivative/Blog\source\_posts\偏导数\1601445508700.png" alt="1601445508700"></p><p><img src= "/img/loading.gif" data-lazy-src="/partial-derivative/Users\Kara\AppData\Roaming\Typora\typora-user-images\1601445566320.png" alt="1601445566320"></p><blockquote><p>对y求导时，是把x看作常数，对y求导</p><p>对x求导时，是把y看作常数，对x求导</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="/partial-derivative/Blog\source\_posts\偏导数\1601445908951.png" alt="1601445908951"></p><p><img src= "/img/loading.gif" data-lazy-src="/partial-derivative/Blog\source\_posts\偏导数\1601483632915.png" alt="1601483632915"></p><p><img src= "/img/loading.gif" data-lazy-src="/partial-derivative/Blog\source\_posts\偏导数\1601484198275.png" alt="1601484198275"></p><h4 id="多元函数可导不连续"><a href="#多元函数可导不连续" class="headerlink" title="多元函数可导不连续"></a>多元函数可导不连续</h4><p><img src= "/img/loading.gif" data-lazy-src="/partial-derivative/Blog\source\_posts\偏导数\1601484542681.png" alt="1601484542681"></p><p>例题：</p><p><img src= "/img/loading.gif" data-lazy-src="/partial-derivative/Blog\source\_posts\偏导数\1601485323277.png" alt="1601485323277"></p><h4 id="几何意义"><a href="#几何意义" class="headerlink" title="几何意义"></a>几何意义</h4><p><img src= "/img/loading.gif" data-lazy-src="/partial-derivative/Blog\source\_posts\偏导数\1601486051149.png" alt="1601486051149"></p><h4 id="二阶偏导数和混合偏导"><a href="#二阶偏导数和混合偏导" class="headerlink" title="二阶偏导数和混合偏导"></a>二阶偏导数和混合偏导</h4><p><img src= "/img/loading.gif" data-lazy-src="/partial-derivative/Blog\source\_posts\偏导数\1601486294681.png" alt="1601486294681"></p><blockquote><p>先求x再求y跟先求y再求x时一样的</p></blockquote><p>如果两个混合二阶偏导数在区域d上是连续的。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h3 id=&quot;在某点偏导的定义&quot;&gt;&lt;a href=&quot;#在某点偏导的定义&quot; class=&quot;headerlink&quot; title=&quot;在某点偏导的定义&quot;&gt;&lt;/a&gt;在某点偏导的定义&lt;/h3&gt;&lt;p&gt;&lt;img src= &quot;/img/loading.gif&quot; data-lazy-src=&quot;/p
      
    
    </summary>
    
    
    
      <category term="math" scheme="https://kayleh.top/tags/math/"/>
    
  </entry>
  
  <entry>
    <title>多元函数</title>
    <link href="https://kayleh.top/multi-function/"/>
    <id>https://kayleh.top/multi-function/</id>
    <published>2020-09-28T17:10:02.000Z</published>
    <updated>2020-09-29T17:36:01.525Z</updated>
    
    <content type="html"><![CDATA[<h1 id="空间解析几何"><a href="#空间解析几何" class="headerlink" title="空间解析几何"></a>空间解析几何</h1><p><img src= "/img/loading.gif" data-lazy-src="/multi-function/Blog\source\_posts\多元函数\1601354294435.png" alt="1601354294435"></p><p>两点之间距离</p><p><img src= "/img/loading.gif" data-lazy-src="/multi-function/Blog\source\_posts\多元函数\1601354442692.png" alt="1601354442692"></p><p><img src= "/img/loading.gif" data-lazy-src="/multi-function/Blog\source\_posts\多元函数\1601354799490.png" alt="1601354799490"></p><h3 id="平面方程"><a href="#平面方程" class="headerlink" title="平面方程"></a><strong>平面方程</strong></h3><p><img src= "/img/loading.gif" data-lazy-src="/multi-function/Blog\source\_posts\多元函数\1601354842773.png" alt="1601354842773"></p><h3 id="球面方程"><a href="#球面方程" class="headerlink" title="球面方程"></a>球面方程</h3><p><img src= "/img/loading.gif" data-lazy-src="/multi-function/Blog\source\_posts\多元函数\1601354949365.png" alt="1601354949365"></p><p><img src= "/img/loading.gif" data-lazy-src="/multi-function/Blog\source\_posts\多元函数\1601355067816.png" alt="1601355067816"></p><p>z是正的表示求的上半部分，负的表示下半部分。</p><p>旋转抛物面：</p><p><img src= "/img/loading.gif" data-lazy-src="/multi-function/Blog\source\_posts\多元函数\1601355316536.png" alt="1601355316536"></p><p>双曲抛物面：</p><p><img src= "/img/loading.gif" data-lazy-src="/multi-function/Blog\source\_posts\多元函数\1601355447432.png" alt="1601355447432"></p><h1 id="多元函数"><a href="#多元函数" class="headerlink" title="多元函数"></a>多元函数</h1><p>邻域</p><p>开集：所有的点都是内点</p><p><img src= "/img/loading.gif" data-lazy-src="/multi-function/Blog\source\_posts\多元函数\1601398417032.png" alt="1601398417032"></p><p>闭区域：既包含内点和边界点</p><h3 id="二元函数的极限"><a href="#二元函数的极限" class="headerlink" title="二元函数的极限"></a>二元函数的极限</h3><blockquote><p>证明极限不存在</p><p>找两种不同的逼近方式</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="/multi-function/Blog\source\_posts\多元函数\1601399459395.png" alt="1601399459395"></p><p>例题：</p><p><img src= "/img/loading.gif" data-lazy-src="/multi-function/Blog\source\_posts\多元函数\1601399650482.png" alt="1601399650482"></p><p><img src= "/img/loading.gif" data-lazy-src="/multi-function/Blog\source\_posts\多元函数\1601399792399.png" alt="1601399792399"></p><p>求极限</p><p><img src= "/img/loading.gif" data-lazy-src="/multi-function/Blog\source\_posts\多元函数\1601400065760.png" alt="1601400065760"></p><p><img src= "/img/loading.gif" data-lazy-src="/multi-function/Blog\source\_posts\多元函数\1601400252209.png" alt="1601400252209"></p><p><img src= "/img/loading.gif" data-lazy-src="/multi-function/Blog\source\_posts\多元函数\1601400533096.png" alt="1601400533096"></p><h3 id="连续"><a href="#连续" class="headerlink" title="连续"></a>连续</h3><p><img src= "/img/loading.gif" data-lazy-src="/multi-function/Blog\source\_posts\多元函数\1601400850590.png" alt="1601400850590"></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;空间解析几何&quot;&gt;&lt;a href=&quot;#空间解析几何&quot; class=&quot;headerlink&quot; title=&quot;空间解析几何&quot;&gt;&lt;/a&gt;空间解析几何&lt;/h1&gt;&lt;p&gt;&lt;img src= &quot;/img/loading.gif&quot; data-lazy-src=&quot;/multi-fun
      
    
    </summary>
    
    
    
      <category term="math" scheme="https://kayleh.top/tags/math/"/>
    
  </entry>
  
  <entry>
    <title>广义积分和瑕积分</title>
    <link href="https://kayleh.top/generalized-integral/"/>
    <id>https://kayleh.top/generalized-integral/</id>
    <published>2020-09-28T13:58:19.000Z</published>
    <updated>2020-09-28T17:13:31.080Z</updated>
    
    <content type="html"><![CDATA[<h1 id="广义积分"><a href="#广义积分" class="headerlink" title="广义积分"></a>广义积分</h1><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/广义积分/1601302982305.png" alt="1601302982305"></p><h3 id="无穷限积分"><a href="#无穷限积分" class="headerlink" title="无穷限积分"></a>无穷限积分</h3><p>①上限是无穷的，就对b求导</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/广义积分/1601303240702.png" alt="1601303240702"></p><p>如果极限存在，就是收敛的，如果不存在，就是发散的。</p><p>②下限是无穷的，就对a求导</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/广义积分/1601303277989.png" alt="1601303277989"></p><p>③上下限都是无穷</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/广义积分/1601303420141.png" alt="1601303420141"></p><p>结合①和②来求。</p><h4 id="例题："><a href="#例题：" class="headerlink" title="例题："></a>例题：</h4><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/广义积分/1601303693780.png" alt="1601303693780"></p><p>广义的牛顿-莱布尼茨公式</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/广义积分/1601303809560.png" alt="1601303809560"></p><h5 id="总结："><a href="#总结：" class="headerlink" title="总结："></a>总结：</h5><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/广义积分/1601303899003.png" alt="1601303899003"></p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/广义积分/1601304242138.png" alt="1601304242138"></p><h3 id="性质"><a href="#性质" class="headerlink" title="性质"></a>性质</h3><blockquote><p>-也收敛</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/广义积分/1601304752667.png" alt="1601304752667"></p><blockquote><p>2）第二个性质。反之，不一定</p></blockquote><p>分部积分和换元积分也成立。</p><h3 id="收敛判定"><a href="#收敛判定" class="headerlink" title="收敛判定"></a>收敛判定</h3><p>定理：</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/广义积分/1601305473068.png" alt="1601305473068"></p><h4 id="★★★比较判别法"><a href="#★★★比较判别法" class="headerlink" title="★★★比较判别法"></a>★★★比较判别法</h4><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/广义积分/1601305670196.png" alt="1601305670196"></p><p>大敛则小敛，小散大必散</p><blockquote><p>找一个比被积函数大的易比函数进行比较</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/广义积分/1601306623507.png" alt="1601306623507"></p><hr><h3 id="绝对收敛、条件收敛"><a href="#绝对收敛、条件收敛" class="headerlink" title="绝对收敛、条件收敛"></a>绝对收敛、条件收敛</h3><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/广义积分/1601307238632.png" alt="1601307238632"></p><p>绝对收敛必收敛</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/广义积分/1601308675891.png" alt="1601308675891"></p><h2 id="瑕积分"><a href="#瑕积分" class="headerlink" title="#瑕积分"></a>#瑕积分</h2>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;广义积分&quot;&gt;&lt;a href=&quot;#广义积分&quot; class=&quot;headerlink&quot; title=&quot;广义积分&quot;&gt;&lt;/a&gt;广义积分&lt;/h1&gt;&lt;p&gt;&lt;img src= &quot;/img/loading.gif&quot; data-lazy-src=&quot;https://cdn.jsdeli
      
    
    </summary>
    
    
    
      <category term="math" scheme="https://kayleh.top/tags/math/"/>
    
  </entry>
  
  <entry>
    <title>定积分</title>
    <link href="https://kayleh.top/definite-integral/"/>
    <id>https://kayleh.top/definite-integral/</id>
    <published>2020-09-26T12:38:49.000Z</published>
    <updated>2020-09-28T17:12:16.910Z</updated>
    
    <content type="html"><![CDATA[<h1 id="定积分"><a href="#定积分" class="headerlink" title="定积分"></a>定积分</h1><h3 id="性质"><a href="#性质" class="headerlink" title="性质"></a>性质</h3><blockquote><p>插入分点，区间内取任意值，求任意值的函数值，$△x_n$小区间的长度</p><p>拉姆达是最大的区间</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/定积分/1601053742391.png" alt="1601053742391"></p><h3 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h3><p>$f(x)$在$[a,b]$有界，在$[a,b]$任意插入分点</p><p>分成n个区间，△x_1,△x_2….△x_n,任取一点 $\xi_i$ </p><script type="math/tex; mode=display">\int_a^b{f(x)dx}=\lim_{\lambda \to 0} \sum_{i=1}^n{f(\xi_i)△x_i}</script><script type="math/tex; mode=display">\lambda=max\{△x_1...△x_n\}</script><h4 id="注意："><a href="#注意：" class="headerlink" title="注意："></a>注意：</h4><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/定积分/1601055940188.png" alt="1601055940188"></p><p>两个图像都是一样的</p><h3 id="定理"><a href="#定理" class="headerlink" title="定理"></a>定理</h3><p>1）连续就可积</p><p>2）有界，有限个间断点，可积</p><h3 id="几何意义"><a href="#几何意义" class="headerlink" title="几何意义"></a>几何意义</h3><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/定积分/1601056351353.png" alt="1601056351353"></p><p>②积分等于面积的相反数</p><h3 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h3><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/定积分/1601056797153.png" alt="1601056797153"></p><h2 id="定积分的近似计算"><a href="#定积分的近似计算" class="headerlink" title="定积分的近似计算"></a>定积分的近似计算</h2><h4 id="矩形法"><a href="#矩形法" class="headerlink" title="矩形法"></a>矩形法</h4><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/定积分/1601089155704.png" alt="1601089155704"></p><h4 id="梯形法"><a href="#梯形法" class="headerlink" title="梯形法"></a>梯形法</h4><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/定积分/1601090462955.png" alt="1601090462955"></p><h4 id="抛物线法"><a href="#抛物线法" class="headerlink" title="抛物线法"></a>抛物线法</h4><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/定积分/1601090743620.png" alt="1601090743620"></p><h2 id="性质-1"><a href="#性质-1" class="headerlink" title="性质"></a>性质</h2><p>1）当b=a时，</p><script type="math/tex; mode=display">\int_a^a{f(x)=0}</script><p>2）<script type="math/tex">\int_a^b{f(x)dx}= - \int_b^a{f(x)dx}</script></p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/定积分/1601100327822.png" alt="1601100327822"></p><blockquote><p>不管是a&lt;c&lt;b还是a&lt;b&lt;c,性质2公式都成立</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/定积分/1601100611938.png" alt="1601100611938"></p><h4 id="推论"><a href="#推论" class="headerlink" title="推论"></a>推论</h4><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/定积分/1601100749415.png" alt="1601100749415"></p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/定积分/1601101052364.png" alt="1601101052364"></p><p>性质6</p><h3 id="定积分中值定理"><a href="#定积分中值定理" class="headerlink" title="定积分中值定理"></a>定积分中值定理</h3><blockquote><p>f(x)必须是连续的</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/定积分/1601101655002.png" alt="1601101655002"></p><p>在最小值和最大值之间一定能找到一点$\xi$</p><p>函数值$f(\xi)$就是<strong>平均值</strong>。</p><h1 id="微积分的基本原理"><a href="#微积分的基本原理" class="headerlink" title="微积分的基本原理"></a>微积分的基本原理</h1><h2 id="积分上限函数"><a href="#积分上限函数" class="headerlink" title="积分上限函数"></a>积分上限函数</h2><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/定积分/1601110706936.png" alt="1601110706936"></p><p>x是变化的</p><hr><h3 id="定义-1"><a href="#定义-1" class="headerlink" title="定义"></a>定义</h3><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/定积分/1601110816738.png" alt="1601110816738"></p><p>积分上限函数p(x)是连续的</p><hr><h3 id="定理-1"><a href="#定理-1" class="headerlink" title="定理"></a>定理</h3><p>如果f(x)在[a,b]上连续，那么p(x)在积分区域上<strong>可导</strong></p><script type="math/tex; mode=display">p'(x)=f(x)</script><p>1)如果上限是x，直接将x代入被积函数</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/定积分/1601111539113.png" alt="1601111539113"></p><p>2)如果x是下限，取相反数，再直接将x代入被积函数</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/定积分/1601111632965.png" alt="1601111632965"></p><p>3）如果上限是x的函数g(x)</p><p>复合函数求导——链式法则</p><p>1.把上限g(x)直接代入被积函数</p><p>2.对上限求导g’(x)</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/定积分/1601111926046.png" alt="1601111926046"></p><p>4）如果上限是x的函数h(x)</p><p>1.把上限h(x)直接代入被积函数</p><p>2.对上限求导h’(x)</p><p>3.取相反数，加负号</p><p>5）上下都是x的函数，</p><p>可以根据积分的性质，在h(x)和g(x)之间任取一点C，求h(x)到c的积分和c到g(x)的积分。</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/定积分/1601112251309.png" alt="1601112251309"></p><hr><h4 id="例题-1"><a href="#例题-1" class="headerlink" title="例题"></a>例题</h4><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/定积分/1601112870379.png" alt="1601112870379"></p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/定积分/1601139602455.png" alt="1601139602455"></p><hr><h3 id="牛顿莱布尼茨公式"><a href="#牛顿莱布尼茨公式" class="headerlink" title="牛顿莱布尼茨公式"></a>牛顿莱布尼茨公式</h3><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/定积分/1601140289642.png" alt="1601140289642"></p><p>例题：<img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/定积分/1601141863229.png" alt="1601141863229"></p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/定积分/1601142031603.png" alt="1601142031603"></p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/定积分/1601142825530.png" alt="1601142825530"></p><h2 id="定积分的换元积分法"><a href="#定积分的换元积分法" class="headerlink" title="定积分的换元积分法"></a>定积分的换元积分法</h2><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/定积分/1601183156945.png" alt="1601183156945"></p><h4 id="例题："><a href="#例题：" class="headerlink" title="例题："></a>例题：</h4><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/定积分/1601184315091.png" alt="1601184315091"></p><p>3ln3</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/定积分/1601185910499.png" alt="1601185910499"></p><p>sin的值是1到-1来回波动，在因为a是正的，所以就是从0到1的范围</p><p>又可以这么写：</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/定积分/1601186045641.png" alt="1601186045641"></p><hr><h4 id="★"><a href="#★" class="headerlink" title="★"></a>★</h4><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/定积分/1601186556806.png" alt="1601186556806"></p><p><strong>积分区间关于原点对称</strong></p><p>例题：</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/定积分/1601187310285.png" alt="1601187310285"></p><p>$1+x^2$分之1是arctanx的导数，提出去所以是对$(arctanx)^2$求导</p><p>证明：</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/定积分/1601187747971.png" alt="1601187747971"></p><p>sin（派/2-X）= cosx</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/定积分/1601189272798.png" alt="1601189272798"></p><p>同时求导</p><h2 id="定积分的分部积分法"><a href="#定积分的分部积分法" class="headerlink" title="定积分的分部积分法"></a>定积分的分部积分法</h2><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/定积分/1601190092256.png" alt="1601190092256"></p><p>例题：<img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/定积分/1601190921495.png" alt="1601190921495"></p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/定积分/1601191359757.png" alt="1601191359757"></p><p>=1/2</p><p>优先级：反对幂三指</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/定积分/1601192056564.png" alt="1601192056564"></p><h1 id="应用"><a href="#应用" class="headerlink" title="应用"></a>应用</h1><h2 id="求面积"><a href="#求面积" class="headerlink" title="求面积"></a>求面积</h2><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/定积分/1601224434165.png" alt="1601224434165"></p><p>x型：垂直于x轴</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/定积分/1601225369727.png" alt="1601225369727"></p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/定积分/1601225743031.png" alt="1601225743031"></p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/定积分/1601226092741.png" alt="1601226092741"></p><h2 id="求体积"><a href="#求体积" class="headerlink" title="求体积"></a>求体积</h2><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/定积分/1601226647106.png" alt="1601226647106"></p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/定积分/1601226802688.png" alt="1601226802688"></p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/定积分/1601226875100.png" alt="1601226875100"></p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/定积分/1601227123788.png" alt="1601227123788"></p><h2 id="经济问题"><a href="#经济问题" class="headerlink" title="经济问题"></a>经济问题</h2>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;定积分&quot;&gt;&lt;a href=&quot;#定积分&quot; class=&quot;headerlink&quot; title=&quot;定积分&quot;&gt;&lt;/a&gt;定积分&lt;/h1&gt;&lt;h3 id=&quot;性质&quot;&gt;&lt;a href=&quot;#性质&quot; class=&quot;headerlink&quot; title=&quot;性质&quot;&gt;&lt;/a&gt;性质&lt;/h3&gt;&lt;b
      
    
    </summary>
    
    
    
      <category term="math" scheme="https://kayleh.top/tags/math/"/>
    
  </entry>
  
  <entry>
    <title>定积分</title>
    <link href="https://kayleh.top/calculus/"/>
    <id>https://kayleh.top/calculus/</id>
    <published>2020-09-26T07:10:24.000Z</published>
    <updated>2020-09-26T18:09:56.592Z</updated>
    
    <summary type="html">
    
    </summary>
    
    
    
      <category term="math" scheme="https://kayleh.top/tags/math/"/>
    
  </entry>
  
  <entry>
    <title>图床</title>
    <link href="https://kayleh.top/pictrue-bed/"/>
    <id>https://kayleh.top/pictrue-bed/</id>
    <published>2020-09-25T12:45:24.000Z</published>
    <updated>2020-09-25T14:10:09.924Z</updated>
    
    <content type="html"><![CDATA[<p>原地址<a href="https://www.jianshu.com/u/e68ebf1b004c" target="_blank" rel="noopener">https://www.jianshu.com/u/e68ebf1b004c</a></p><h2 id="Github-repo图床"><a href="#Github-repo图床" class="headerlink" title="Github repo图床"></a>Github repo图床</h2><p>Github的repo也可以储存东西，最直接的就是程序的版本控制，当然也可以用来当作备份储存，用来储存图片（github官方回复是：该行为不构成abuse，如果把github当图床算滥用，那么那么多人把微博当图床怎么就理所应当捏）。其实github对于国内的响应速度并不快，而且时不时被block，所以用github当图床完全是出于储存个人用途的自创图片，并不能当CDN使用。github自从被微软收购后，我对github的信心大增，代码以前只敢用git管理保存在本地，现在可以放心大胆上传到github了（很多是private，所以不可见），github图床主要就是图个稳定，也并不是想恶意刷github服务器的流量，恶意影响大家的体验。</p><ol><li>新建repo，名称任意</li></ol><ol><li><p>打开账户/Settings/Developer settings/Personal access tokens,点击Generate new token</p><p><img src= "/img/loading.gif" data-lazy-src="https:////upload-images.jianshu.io/upload_images/17029678-88e1807b0a33255e.png?imageMogr2/auto-orient/strip|imageView2/2/w/233/format/webp" alt="img"></p><p>image</p><p><img src= "/img/loading.gif" data-lazy-src="https:////upload-images.jianshu.io/upload_images/17029678-7656c08d619ed359.png?imageMogr2/auto-orient/strip|imageView2/2/w/1002/format/webp" alt="img"></p><p>image</p></li><li><p>在弹出的产生token页面，Token description随意填写，但是一定要勾选上这几项</p><p><img src= "/img/loading.gif" data-lazy-src="https:////upload-images.jianshu.io/upload_images/17029678-55b2842f6875b416.png?imageMogr2/auto-orient/strip|imageView2/2/w/784/format/webp" alt="img"></p><p>image</p></li><li><p>下载PicGo客户端对应的版本并安装，github地址：<a href="https://links.jianshu.com/go?to=https%3A%2F%2Fgithub.com%2FMolunerfinn%2FPicGo%2Freleases" target="_blank" rel="noopener">https://github.com/Molunerfinn/PicGo/releases</a></p></li><li><p>启动PicGo后，打开设置界面，点击</p><p><img src= "/img/loading.gif" data-lazy-src="https:////upload-images.jianshu.io/upload_images/17029678-3ed6d235f87629c4.png?imageMogr2/auto-orient/strip|imageView2/2/w/800/format/webp" alt="img"></p><p>image</p><p>在第一栏填入你的github名称/repo名称；在第二栏填入你的分支名称，默认为master；在第三栏填入你刚才申请到的Token；第四栏填入你的repo中的储存路径；最后点击确认，再点击设为默认图床</p></li><li><p>使用QQ截图Ctrl+Alt+A或者微信的Alt+A截图后，按下Ctrl+Shiht+P快捷键即可自动上传到github对应的repo中，上传完成后，会有提示，自动将对应的图片地址送入剪贴板中，直接Ctrl+V即可粘贴对应的地址出来了~~</p></li></ol>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;原地址&lt;a href=&quot;https://www.jianshu.com/u/e68ebf1b004c&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;https://www.jianshu.com/u/e68ebf1b004c&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=
      
    
    </summary>
    
    
    
      <category term="front" scheme="https://kayleh.top/tags/front/"/>
    
  </entry>
  
  <entry>
    <title>不定积分</title>
    <link href="https://kayleh.top/indefinite-integral/"/>
    <id>https://kayleh.top/indefinite-integral/</id>
    <published>2020-09-23T09:06:12.000Z</published>
    <updated>2020-09-26T02:23:27.786Z</updated>
    
    <content type="html"><![CDATA[<p>$F’(x)=f(x)$</p><p>$F(x)$是$f(x)$的<strong>一个</strong>原函数.</p><blockquote><p>F(x)是f(x)的一个原函数，F(x)+c也是f(x)的原函数</p></blockquote><p>$f(x)$是$F’(x)$的导函数.</p><p>知道$F’(x)$,$f(x)$只有唯一一个</p><p>知道$f(x)$,$F’(x)$可以有无穷多个</p><h1 id="不定积分"><a href="#不定积分" class="headerlink" title="不定积分"></a>不定积分</h1><p>$f(x)$的原函数的全体</p><p><strong>$\int_{}{}f(x) \text{d}x$</strong> </p><blockquote><p>$\int_{}{}$:    sum,积分符号</p><p>$x$:    积分变量</p><p>$f(x)$:    被积函数</p></blockquote><p>$\int_{}{}f(x) \text{d}x = F(x)+c$</p><h4 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h4><p>1) $\int_{}{}x^2 \text{d}x = \frac{1}{3}x^3+c$</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/不定积分/1600870737910.png" alt></p><h2 id="几何意义"><a href="#几何意义" class="headerlink" title="几何意义"></a>几何意义</h2><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/不定积分/1600871376478.png" alt></p><h3 id="性质"><a href="#性质" class="headerlink" title="性质"></a>性质</h3><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/不定积分/1600871618223.png" alt></p><script type="math/tex; mode=display">\int_{}{}kf(x)\text{d}x=k\int_{}{}f(x)\text{d}x</script><p>k可以朝外拿：</p><p>①k是常数</p><p>②k是与x无关的另变量</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/不定积分/1600874436855.png" alt="1600874436855.png"></p><blockquote><p>有限个可以，但无限个不能</p></blockquote><h2 id="基本积分公式"><a href="#基本积分公式" class="headerlink" title="基本积分公式"></a>基本积分公式</h2><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/不定积分/1600875099212.png" alt="1600875099212.png"></p><p>例题：</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/不定积分/1600880107488.png" alt="1600880107488.png"></p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/不定积分/1600880350925.png" alt="1600880350925.png"></p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/不定积分/1600880532801.png" alt="1600880532801"></p><h1 id="积分法"><a href="#积分法" class="headerlink" title="积分法"></a>积分法</h1><h2 id="第一换元积分法-凑微分法"><a href="#第一换元积分法-凑微分法" class="headerlink" title="第一换元积分法(凑微分法)"></a>第一换元积分法(凑微分法)</h2><blockquote><p>求原函数</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/不定积分/1600959600842.png" alt="1600959600842"></p><p>1）把d外面的某项拿到d里面(变成原函数)</p><p>2）凑基本积分公式</p><h3 id="例题："><a href="#例题：" class="headerlink" title="例题："></a>例题：</h3><p>dk()=kd()</p><p>d()里面的项可以随意<strong>加减</strong>常数</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/不定积分/1600964019281.png" alt="1600964019281"></p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/不定积分/1.png" alt="1600965342157"></p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/不定积分/1600966288346.png" alt="1600966288346"></p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/不定积分/1600966889415.png" alt="1600966889415"></p><h2 id="第二换元积分"><a href="#第二换元积分" class="headerlink" title="第二换元积分"></a>第二换元积分</h2><blockquote><p>求导</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/不定积分/1600968183522.png" alt="1600968183522"></p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/不定积分/1600968762395.png" alt="1600968762395"></p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/不定积分/1600969286878.png" alt="1600969286878"></p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/不定积分/1600969564112.png" alt="1600969564112"></p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/不定积分/1600969724741.png" alt="1600969724741"></p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/不定积分/1600969833171.png" alt="1600969833171"></p><h6 id="公式"><a href="#公式" class="headerlink" title="公式"></a>公式</h6><h2 id="分部积分法"><a href="#分部积分法" class="headerlink" title="分部积分法"></a>分部积分法</h2><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/不定积分/1600996506632.png" alt="1600996506632.png"></p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/不定积分/1600997159717.png" alt="1600997159717.png"></p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/不定积分/1600997865246.png" alt="1600997865246.png"></p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/不定积分/1600998084405.png" alt="1600998084405"></p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/不定积分/1600998742526.png" alt="1600998742526"></p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/不定积分/1600999265802.png" alt></p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/不定积分/1600999440603.png" alt="1601020665712.png"></p><p>优先：</p><blockquote><p>$e^x,sinx,cosx,x(x^n),lnx,arctanx$</p></blockquote><h1 id="有理函数积分"><a href="#有理函数积分" class="headerlink" title="有理函数积分"></a>有理函数积分</h1><p>分子的最高次数比较高：</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/不定积分/1601020665712.png" alt="1601020665712.png"></p><p>最高次数相等(最终使分母次数高)：</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/不定积分/1601020930143.png" alt="1601020930143"></p><p>所有方法都要化成分母次数比分子次数高。</p><h3 id="真分式"><a href="#真分式" class="headerlink" title="真分式"></a>真分式</h3><p>分母次数比分子次数高的叫做<strong>真分式</strong></p><h4 id="第一类题目"><a href="#第一类题目" class="headerlink" title="第一类题目"></a>第一类题目</h4><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/不定积分/1601021927432.png" alt="1601021927432"></p><p>1）$b^2-4ac=0$ $ax^2+bx+c=0$</p><p>$a(x-x_1)^2=0$</p><p>例如：<img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/不定积分/1601022001083.png" alt="1601022001083"></p><p>2）$b^2-4ac&gt;0$ $ax^2+bx+c=0$有两个不等的根</p><p>$a(x-x_1)(x-x_2)=0$</p><p>待定系数法：</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/不定积分/1601022253671.png" alt="1601022253671"></p><p><img src= "/img/loading.gif" data-lazy-src="https://raw.githubusercontent.com/Kayleh/Picture_bed/master/hexo/1601022285476.png" alt="1601022285476" style="zoom:33%;"></p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/不定积分/1601022327199.png" alt="1601022327199"></p><p>3）$b^2-4ac&lt;0$ $ax^2+bx+c=0$没有实根</p><p><img src= "/img/loading.gif" data-lazy-src="https://raw.githubusercontent.com/Kayleh/Picture_bed/master/hexo/1601022770780.png" alt="1601022770780" style="zoom:33%;"></p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/不定积分/1601022751842.png" alt="1601022751842"></p><h4 id="第二类题目"><a href="#第二类题目" class="headerlink" title="第二类题目"></a>第二类题目</h4><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/不定积分/1601022980770.png" alt="1601022980770"></p><p>1）$b^2-4ac=0$ $ax^2+bx+c=0$</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/不定积分/1601023694401.png" alt="1601023694401"></p><p>2）$b^2-4ac&gt;0$</p><p>待定系数法：</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/不定积分/1601023802367.png" alt="1601023802367"></p><p>3）$b^2-4ac&lt;0$</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/不定积分/1601024256435.png" alt="1601024256435"></p><h4 id="第三类题目"><a href="#第三类题目" class="headerlink" title="第三类题目"></a>第三类题目</h4><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/不定积分/1601028039597.png" alt="1601028039597"></p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/不定积分/1601030780920.png" alt="1601030780920"></p><p>第一类表达式</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/不定积分/1601030922466.png" alt="1601030922466"></p><p>比如：</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/不定积分/1601030765738.png" alt="1601030765738"></p><p>3）<img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/不定积分/1601031708083.png" alt="1601031708083"></p><p>第二类</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/不定积分/1601030987071.png" alt="1601030987071"></p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/不定积分/1601031354989.png" alt="1601031354989"></p><p>解法：</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/不定积分/1601032503258.png" alt="1601032503258"></p><p>左右相等：</p><p>$A_1+2A_2=0$平方项</p><p>$A_2+2A_3=0$1次项</p><p>$A_1+A_3=1$常数项</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/不定积分/1601035938562.png" alt="1601035938562"></p><p>或者：</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/不定积分/1601036063786.png" alt="1601036063786"></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;$F’(x)=f(x)$&lt;/p&gt;
&lt;p&gt;$F(x)$是$f(x)$的&lt;strong&gt;一个&lt;/strong&gt;原函数.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;F(x)是f(x)的一个原函数，F(x)+c也是f(x)的原函数&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;$f(x)
      
    
    </summary>
    
    
    
      <category term="math" scheme="https://kayleh.top/tags/math/"/>
    
  </entry>
  
  <entry>
    <title>函数作图</title>
    <link href="https://kayleh.top/function-graphing/"/>
    <id>https://kayleh.top/function-graphing/</id>
    <published>2020-09-23T05:41:02.000Z</published>
    <updated>2020-09-26T02:19:20.737Z</updated>
    
    <content type="html"><![CDATA[<h2 id="渐近线"><a href="#渐近线" class="headerlink" title="渐近线"></a>渐近线</h2><blockquote><p>水平、垂直、斜</p></blockquote><h3 id="水平渐近线"><a href="#水平渐近线" class="headerlink" title="水平渐近线"></a>水平渐近线</h3><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/函数作图/1600844913776.png" alt="1600844913776"></p><p>例题：</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/函数作图/1600845192751.png" alt="1600845192751"></p><h3 id="垂直渐近线"><a href="#垂直渐近线" class="headerlink" title="垂直渐近线"></a>垂直渐近线</h3><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/函数作图/1600845395147.png" alt="1600845395147"></p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/函数作图/1600845415524.png" alt="1600845415524"></p><h3 id="斜渐近线"><a href="#斜渐近线" class="headerlink" title="斜渐近线"></a>斜渐近线</h3><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/函数作图/1600845708818.png" alt="1600845708818"></p><p>例题：</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/函数作图/1600846462394.png" alt="1600846462394"></p><p>分子次数比分母高，取无穷</p><p>分子与分母次数一样，极限等于最高次的系数之比</p><h2 id="微分法作图-“导数”"><a href="#微分法作图-“导数”" class="headerlink" title="微分法作图 “导数”"></a>微分法作图 “导数”</h2><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/函数作图/1600847435593.png" alt="1600847435593"></p><p>例如：</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/函数作图/1600850081188.png" alt="1600850081188"><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/函数作图/1600851679622.png" alt="1600851679622"></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;渐近线&quot;&gt;&lt;a href=&quot;#渐近线&quot; class=&quot;headerlink&quot; title=&quot;渐近线&quot;&gt;&lt;/a&gt;渐近线&lt;/h2&gt;&lt;blockquote&gt;
&lt;p&gt;水平、垂直、斜&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&quot;水平渐近线&quot;&gt;&lt;a href=&quot;#水平
      
    
    </summary>
    
    
      <category term="高数" scheme="https://kayleh.top/categories/%E9%AB%98%E6%95%B0/"/>
    
    
      <category term="math" scheme="https://kayleh.top/tags/math/"/>
    
  </entry>
  
  <entry>
    <title>极值和最值</title>
    <link href="https://kayleh.top/extreme-value-and-maximum-value/"/>
    <id>https://kayleh.top/extreme-value-and-maximum-value/</id>
    <published>2020-09-20T15:04:06.000Z</published>
    <updated>2020-09-26T02:18:41.593Z</updated>
    
    <content type="html"><![CDATA[<h2 id="极值和最值"><a href="#极值和最值" class="headerlink" title="极值和最值"></a>极值和最值</h2><h4 id="定理："><a href="#定理：" class="headerlink" title="定理："></a>定理：</h4><p>f(x)在$x_0$可导，且在$x_0$取极值。$f’(x_0)=0$</p><p>证明：</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/极值和最值/1600782477572.png" alt="1600782477572"></p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/极值和最值/1600782713732.png" alt="1600782713732"></p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/极值和最值/1600782897701.png" alt="1600782897701"></p><h2 id="求极值"><a href="#求极值" class="headerlink" title="求极值"></a>求极值</h2><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/极值和最值/1600783007899.png" alt="1600783007899"></p><p>例题：</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/极值和最值/1600783465855.png" alt="1600783465855"></p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/极值和最值/1600783793596.png" alt="1600783793596"></p><h4 id="定理：-1"><a href="#定理：-1" class="headerlink" title="定理："></a>定理：</h4><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/极值和最值/1600784625648.png" alt="1600784625648"></p><p>f(x)的二阶导数也等于0的时候，不能判断：</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/极值和最值/1600784848861.png" alt="1600784848861"></p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/极值和最值/1600785712089.png" alt="1600785712089"></p><h2 id="最值"><a href="#最值" class="headerlink" title="最值"></a>最值</h2><p>极值是局部区域的，最值是全部区域</p><h3 id="求最值"><a href="#求最值" class="headerlink" title="求最值"></a>求最值</h3><p>找到这几个点：</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/极值和最值/1600794952240.png" alt="1600794952240"></p><p>连续并单调的函数，最值就是端点；</p><p>在区间内的极值就是最值。</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/极值和最值/1600795107694.png" alt="1600795107694"></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;极值和最值&quot;&gt;&lt;a href=&quot;#极值和最值&quot; class=&quot;headerlink&quot; title=&quot;极值和最值&quot;&gt;&lt;/a&gt;极值和最值&lt;/h2&gt;&lt;h4 id=&quot;定理：&quot;&gt;&lt;a href=&quot;#定理：&quot; class=&quot;headerlink&quot; title=&quot;定理：&quot;&gt;&lt;/
      
    
    </summary>
    
    
    
      <category term="math" scheme="https://kayleh.top/tags/math/"/>
    
  </entry>
  
  <entry>
    <title>函数的单调性和凸凹性</title>
    <link href="https://kayleh.top/monotonicity-and-convexity-of-functions/"/>
    <id>https://kayleh.top/monotonicity-and-convexity-of-functions/</id>
    <published>2020-09-20T05:00:16.000Z</published>
    <updated>2020-09-26T02:19:40.561Z</updated>
    
    <content type="html"><![CDATA[<h2 id="单调性"><a href="#单调性" class="headerlink" title="单调性"></a>单调性</h2><p> 增f’(x)&gt;0减f’(x)&lt;0</p><p>f’(x)≥0，等号在个别点上成立，仍然也是增函数</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/函数的单调性和凸凹性/1600590092595.png" alt="1600590092595"></p><p>f’(0)不存在,左右导数</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/函数的单调性和凸凹性/1600590517124.png" alt="1600590517124"></p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/函数的单调性和凸凹性/1600590714485.png" alt="1600590714485"></p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/函数的单调性和凸凹性/1600591157427.png" alt="1600591157427"></p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/函数的单调性和凸凹性/1600591335926.png" alt="1600591335926"></p><h2 id="凸凹性"><a href="#凸凹性" class="headerlink" title="凸凹性"></a>凸凹性</h2><p>定义：</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/函数的单调性和凸凹性/1600591695747.png" alt="1600591695747"></p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/函数的单调性和凸凹性/1600592034891.png" alt="1600592034891"></p><p>利用拉格朗日中值定理：</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/函数的单调性和凸凹性/1600593230688.png" alt="1600593230688"></p><p>例题：</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/函数的单调性和凸凹性/1600593545557.png" alt="1600593545557"></p><p>求凸凹区间和拐点：</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/函数的单调性和凸凹性/1600593697583.png" alt="1600593697583"></p><p>f‘’不存在：</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/函数的单调性和凸凹性/1600593903938.png" alt="1600593903938"></p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/函数的单调性和凸凹性/1600594115945.png" alt="1600594115945"></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;单调性&quot;&gt;&lt;a href=&quot;#单调性&quot; class=&quot;headerlink&quot; title=&quot;单调性&quot;&gt;&lt;/a&gt;单调性&lt;/h2&gt;&lt;p&gt; 增f’(x)&amp;gt;0减f’(x)&amp;lt;0&lt;/p&gt;
&lt;p&gt;f’(x)≥0，等号在个别点上成立，仍然也是增函数&lt;/p&gt;
&lt;p&gt;&lt;i
      
    
    </summary>
    
    
    
      <category term="math" scheme="https://kayleh.top/tags/math/"/>
    
  </entry>
  
  <entry>
    <title>洛必达法则</title>
    <link href="https://kayleh.top/law-of-robida/"/>
    <id>https://kayleh.top/law-of-robida/</id>
    <published>2020-09-19T14:31:17.000Z</published>
    <updated>2020-09-26T02:16:26.860Z</updated>
    
    <content type="html"><![CDATA[<h1 id="洛必达法则"><a href="#洛必达法则" class="headerlink" title="洛必达法则"></a>洛必达法则</h1><h3 id="两种形式："><a href="#两种形式：" class="headerlink" title="两种形式："></a>两种形式：</h3><script type="math/tex; mode=display">\frac{0}{0}</script><script type="math/tex; mode=display">\frac{\infty}{\infty}</script><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/洛必达法则/1600529727634.png" alt="1600529727634"></p><h3 id="frac-0-0"><a href="#frac-0-0" class="headerlink" title="\frac{0}{0}"></a><script type="math/tex">\frac{0}{0}</script></h3><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/洛必达法则/1600529882424.png" alt="1600529882424"></p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/洛必达法则/1600534332058.png" alt="1600534332058"></p><p>例题：</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/洛必达法则/1600534495973.png" alt="1600534495973"></p><p>重要极限也可以用洛必达法则证明：</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/洛必达法则/1600534564326.png" alt="1600534564326"></p><blockquote><p>必须是$\frac{0}{0}$型或$\frac{\infty}{\infty}$型才可以再次求导。</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/洛必达法则/1600535683379.png" alt="1600535683379"></p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/洛必达法则/1600535923847.png" alt="1600535923847"></p><h3 id="frac-infty-infty"><a href="#frac-infty-infty" class="headerlink" title="\frac{\infty}{\infty}"></a><script type="math/tex">\frac{\infty}{\infty}</script></h3><p>其实和$\frac{0}{0}$没区别：</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/洛必达法则/1600536068546.png" alt="1600536068546"></p><p>例题：</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/洛必达法则/1600536513889.png" alt="1600536513889"></p><p>趋于正无穷的速度：</p><p>对数&lt;幂函数&lt;指数函数</p><h2 id="洛必达法则注意"><a href="#洛必达法则注意" class="headerlink" title="洛必达法则注意"></a>洛必达法则注意</h2><p>1)只有$\frac{0}{0}$或$\frac{\infty}{\infty}$才用</p><p>2)不要一味求导，与重要极限、等价无穷小替换结合</p><p>3)<img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/洛必达法则/1600536878642.png" alt="1600536878642"></p><p>例题：</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/洛必达法则/1600537030481.png" alt="1600537030481"></p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/洛必达法则/1600537514365.png" alt="1600537514365"></p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/洛必达法则/1600537595187.png" alt="1600537595187"></p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/洛必达法则/1600537822232.png" alt="1600537822232"></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;洛必达法则&quot;&gt;&lt;a href=&quot;#洛必达法则&quot; class=&quot;headerlink&quot; title=&quot;洛必达法则&quot;&gt;&lt;/a&gt;洛必达法则&lt;/h1&gt;&lt;h3 id=&quot;两种形式：&quot;&gt;&lt;a href=&quot;#两种形式：&quot; class=&quot;headerlink&quot; title=&quot;两种形
      
    
    </summary>
    
    
    
      <category term="math" scheme="https://kayleh.top/tags/math/"/>
    
  </entry>
  
  <entry>
    <title>微分</title>
    <link href="https://kayleh.top/differential/"/>
    <id>https://kayleh.top/differential/</id>
    <published>2020-09-17T15:39:06.000Z</published>
    <updated>2020-09-26T02:16:36.005Z</updated>
    
    <content type="html"><![CDATA[<h1 id="微分"><a href="#微分" class="headerlink" title="微分"></a>微分</h1><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/微分/1600361375405.png" alt="1600361375405"></p><h2 id="微分的定义："><a href="#微分的定义：" class="headerlink" title="微分的定义："></a>微分的定义：</h2><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/微分/1600361823824.png" alt="1600361823824"></p><p><strong>充要条件</strong></p><p>可微就可导，可导就可微</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/微分/1600362288099.png" alt="1600362288099"></p><p>A就是$x_0$上的导数</p><script type="math/tex; mode=display">dy=f^{'}(x)△x=f^{'}(x)dx</script><p>$△x=dx$是精确值，$△y≈dy$是近似值</p><p>导数也叫微商 ，导数定义的dy是对dx求导，可以看做一个整体：</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/微分/1600363016711.png" alt="1600363016711"></p><h3 id="例题："><a href="#例题：" class="headerlink" title="例题："></a>例题：</h3><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/微分/1600363590738.png" alt="1600363590738"></p><h3 id="微分的几何意义"><a href="#微分的几何意义" class="headerlink" title="微分的几何意义"></a>微分的几何意义</h3><p><img src= "/img/loading.gif" data-lazy-src="/differential/1600363809382.png" alt="1600363809382" style="zoom:50%;"></p><h2 id="基本公式"><a href="#基本公式" class="headerlink" title="基本公式"></a>基本公式</h2><p>$dc=c’dx=0$</p><p>略</p><h2 id="四则运算"><a href="#四则运算" class="headerlink" title="四则运算"></a>四则运算</h2><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/微分/1600394726408.png" alt="1600394726408"></p><h3 id="例题：-1"><a href="#例题：-1" class="headerlink" title="例题："></a>例题：</h3><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/微分/1600395225067.png" alt="1600395225067"></p><p>不变性：</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/微分/1600396809213.png" alt="1600396809213"></p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/微分/1600396977930.png" alt="1600396977930"></p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/微分/1600397139589.png" alt="1600397139589"></p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/微分/1600398508737.png" alt="1600398508737"></p><h2 id="微分应用"><a href="#微分应用" class="headerlink" title="微分应用"></a>微分应用</h2><blockquote><p>近似计算</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/微分/1600398647225.png" alt="1600398647225"></p><p><script type="math/tex">f(x_0+△x)≈f(x_0)+f'(x_0)△x</script> ，|△x|取很小</p><h4 id="例题：-2"><a href="#例题：-2" class="headerlink" title="例题："></a>例题：</h4><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/微分/1600400532839.png" alt="1600400532839"></p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/微分/1600401937159.png" alt="1600401937159"></p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/微分/1600403890381.png" alt="1600403890381"></p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/微分/1600404415925.png" alt="1600404415925"></p><h2 id="微分中值定理"><a href="#微分中值定理" class="headerlink" title="微分中值定理"></a>微分中值定理</h2><h3 id="费马定理"><a href="#费马定理" class="headerlink" title="费马定理"></a>费马定理</h3><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/微分/1600413540338.png" alt="1600413540338"></p><p>左导数和右导数要想相等，只能等于0</p><p>∴$f^{‘}(x_0)=0$</p><h4 id="驻点："><a href="#驻点：" class="headerlink" title="驻点："></a>驻点：</h4><p>导数为0的点就叫驻点。</p><h3 id="罗尔定理"><a href="#罗尔定理" class="headerlink" title="罗尔定理"></a>罗尔定理</h3><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/微分/1600418546474.png" alt="1600418546474"> </p><h3 id="拉姆朗日中值定理"><a href="#拉姆朗日中值定理" class="headerlink" title="拉姆朗日中值定理"></a>拉姆朗日中值定理</h3><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/微分/1600418973628.png" alt="1600418973628"></p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/微分/1600419102500.png" alt="1600419102500"></p><blockquote><p>f(x)在区间I连续，I内可导且导数恒为0。f(x)=C</p><p>证明：</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/微分/1600419285714.png" alt="1600419285714"></p></blockquote><h3 id="柯西中值定理"><a href="#柯西中值定理" class="headerlink" title="柯西中值定理"></a>柯西中值定理</h3><p>由拉姆朗日中值定理推出：</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/微分/1600420461707.png" alt="1600420461707"></p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/微分/1600420576192.png" alt="1600420576192"></p><p>柯西能推出拉格朗日定理，拉格朗日能推出罗尔</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/微分/1600421270529.png" alt="1600421270529"></p><h3 id="泰勒定理"><a href="#泰勒定理" class="headerlink" title="#泰勒定理"></a>#泰勒定理</h3><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/微分/1600522802705.png" alt="1600522802705"></p><p>定理：$f(x)$表示成$x-x_0$的n次多项式+$R_n (x)$</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/微分/1600524775977.png" alt="1600524775977"></p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/微分/1600525026726.png" alt="1600525026726"></p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/微分/1600525632036.png" alt="1600525632036"></p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/微分/1600525747934.png" alt="1600525747934"></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;微分&quot;&gt;&lt;a href=&quot;#微分&quot; class=&quot;headerlink&quot; title=&quot;微分&quot;&gt;&lt;/a&gt;微分&lt;/h1&gt;&lt;p&gt;&lt;img src= &quot;/img/loading.gif&quot; data-lazy-src=&quot;https://cdn.jsdelivr.net/g
      
    
    </summary>
    
    
    
      <category term="math" scheme="https://kayleh.top/tags/math/"/>
    
  </entry>
  
  <entry>
    <title>导数</title>
    <link href="https://kayleh.top/derivative/"/>
    <id>https://kayleh.top/derivative/</id>
    <published>2020-09-15T16:20:05.000Z</published>
    <updated>2020-09-26T02:24:10.509Z</updated>
    
    <content type="html"><![CDATA[<h4 id="变化率"><a href="#变化率" class="headerlink" title="变化率"></a>变化率</h4><p>$x_0 \to x_0+△x$.</p><p>$f(x_0) \to f(x_0+△x)$</p><p>$\frac{f(x_0+△x)-f(x_0)}{△x}$</p><p>从x_0到x_0+△x的平均变化率</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/导数/1600188583801.png" alt="1600188583801"></p><p>导数的四个符号</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/导数/1600188748075.png" alt="1600188748075"></p><p>导数的三种表达方式</p><h3 id="例题："><a href="#例题：" class="headerlink" title="例题："></a>例题：</h3><p>1)</p><p>$y=x^2$  </p><p>$y’$ </p><p>$y’|_{x=2}$</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/导数/1600189489349.png" alt="1600189489349"></p><p>=4;</p><h3 id="求导"><a href="#求导" class="headerlink" title="求导"></a>求导</h3><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/导数/1600189764709.png" alt="1600189764709"></p><h3 id="导数意义"><a href="#导数意义" class="headerlink" title="导数意义"></a>导数意义</h3><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/导数/1600221028096.png" alt="1600221028096"></p><p>例题：</p><p>求$y=x^3$在(1,1)的切线和法线</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/导数/1600250579429.png" alt="1600250579429"></p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/导数/1600234017440.png" alt></p><p>左右导数，左右导数都存在并相等</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/导数/1600235099441.png" alt></p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/导数/1600235529621.png" alt></p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/导数/1600235803697.png" alt></p><h2 id="求导法则："><a href="#求导法则：" class="headerlink" title="求导法则："></a>求导法则：</h2><p>(1)$u(x)、v(x)$可导，$(u(x)+v(x))’=u’(x)+v’(x)$</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/导数/1600252000327.png" alt="1600252000327"></p><p>(2)$(uv)’=u’v+uv’$</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/导数/1600252779790.png" alt="1600252779790"></p><p>(3)$\frac{u}{v}=\frac{u’v+uv’}{v^2}$</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/导数/1600253704886.png" alt="1600253704886"></p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/导数/1600253831993.png" alt="1600253831993"></p><h3 id="反函数求导法则："><a href="#反函数求导法则：" class="headerlink" title="反函数求导法则："></a>反函数求导法则：</h3><p>$y=f(x)$ . $x=\phi(y)$</p><p> 反函数=导数的倒数 $\phi(y)=\frac{1}{f’(x)}$</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/导数/1600255372014.png" alt="1600255372014"></p><p><img src= "/img/loading.gif" data-lazy-src="/derivative/1600255541697.png" alt="1600255541697" style="zoom:50%;"></p><h3 id="复合函数："><a href="#复合函数：" class="headerlink" title="复合函数："></a>复合函数：</h3><h4 id="链式法则："><a href="#链式法则：" class="headerlink" title="链式法则："></a>链式法则：</h4><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/导数/1600256472549.png" alt="1600256472549"></p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/导数/1600257193054.png" alt="1600257193054"></p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/导数/1600257319985.png" alt="1600257319985"></p><p>剥洋葱解法，从外往里剥。</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/导数/1600257524549.png" alt="1600257524549"></p><h2 id="高阶函数"><a href="#高阶函数" class="headerlink" title="高阶函数"></a>高阶函数</h2><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/导数/1600271203725.png" alt="1600271203725"></p><p>对$y$求两次导数，记作$y^{‘’}$,二阶导数</p><p>或者$\frac{d^2y}{dx^2}$</p><p>从4阶开始用数字表示:$y^{(4)}$</p><h4 id="例题：-1"><a href="#例题：-1" class="headerlink" title="例题："></a>例题：</h4><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/导数/1600272928789.png" alt="1600272928789"></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h4 id=&quot;变化率&quot;&gt;&lt;a href=&quot;#变化率&quot; class=&quot;headerlink&quot; title=&quot;变化率&quot;&gt;&lt;/a&gt;变化率&lt;/h4&gt;&lt;p&gt;$x_0 \to x_0+△x$.&lt;/p&gt;
&lt;p&gt;$f(x_0) \to f(x_0+△x)$&lt;/p&gt;
&lt;p&gt;$\frac{f(x_
      
    
    </summary>
    
    
    
      <category term="math" scheme="https://kayleh.top/tags/math/"/>
    
  </entry>
  
  <entry>
    <title>连续</title>
    <link href="https://kayleh.top/continuous/"/>
    <id>https://kayleh.top/continuous/</id>
    <published>2020-09-14T15:53:48.000Z</published>
    <updated>2020-09-26T02:16:50.585Z</updated>
    
    <content type="html"><![CDATA[<h4 id="增量-改变量"><a href="#增量-改变量" class="headerlink" title="增量(改变量)"></a>增量(改变量)</h4><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/连续/1600101409179.png" alt="1600101409179"></p><p>△x是自变量的增量，△y是因变量的增量</p><p>定义：</p><p>f(x)在$x_0$的邻域内有定义，$△x\to 0$,$△y\to 0$</p><script type="math/tex; mode=display">\lim_{x\to 0}△y=\lim\_{x\to 0} [f(x_0+△x)-f(x_0)]=0</script><p>&amp;或者</p><script type="math/tex; mode=display">\lim_{x\to x_0} f(x) = f(x_0)</script><p>那么就叫这个函数在这点$x_0$上是连续的</p><p>1)在$x_0$处有定义</p><p>2)$x\to x_0  f(x)$有极限</p><p>3)极限=在$x_0$处的定义，$f(x_0)$</p><h4 id="左连续-x-0-delta-x-0"><a href="#左连续-x-0-delta-x-0" class="headerlink" title="左连续 $(x_0-\delta,x_0]$"></a>左连续 $(x_0-\delta,x_0]$</h4><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/连续/1600103890373.png" alt="1600103890373"></p><p>在x_0处连续的充要条件是既是左连续也是右连续</p><h4 id="在区间上连续"><a href="#在区间上连续" class="headerlink" title="在区间上连续"></a>在区间上连续</h4><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/连续/1600141661421.png" alt="1600141661421"></p><h4 id="间断点"><a href="#间断点" class="headerlink" title="间断点"></a>间断点</h4><p>连续的条件</p><p>1)在$x_0$处有定义</p><p>2)$x\to x_0  f(x)$有极限</p><p>3)极限=定义</p><ul><li><p>无穷间断</p><p>在$x_0$处没有定义</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/连续/1600142602334.png" alt="1600142602334"></p></li><li><p>振荡</p><p>$x\to x_0  f(x)$没有极限</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/连续/1600142774007.png" alt="1600142774007"></p></li><li><p>跳跃</p><p>左右极限不相等</p><p><img src= "/img/loading.gif" data-lazy-src="/continuous/1600142892062.png" alt="1600142892062" style="zoom:50%;"></p></li><li><p>可去</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/连续/1600143079362.png" alt="1600143079362"></p></li></ul><h3 id="第一类间断点："><a href="#第一类间断点：" class="headerlink" title="第一类间断点："></a>第一类间断点：</h3><p>左右极限均存在，<strong>跳跃</strong>、<strong>可去</strong>间断点</p><h3 id="第二类间断点："><a href="#第二类间断点：" class="headerlink" title="第二类间断点："></a>第二类间断点：</h3><p>左右极限不存在，<strong>无穷间断</strong>、<strong>振荡</strong></p><h4 id="例题："><a href="#例题：" class="headerlink" title="例题："></a>例题：</h4><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/连续/1600144334745.png" alt="1600144334745"></p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/连续/1600144487842.png" alt="1600144487842"></p><p>左右极限都存在但不相等</p><h2 id="运算法则"><a href="#运算法则" class="headerlink" title="运算法则"></a>运算法则</h2><p>四则运算 $f(x)±g(x).g(x)f(x).\frac{f(x)}{g(x)} (g(x)≠0)$ 依然连续</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/连续/1600145522288.png" alt="1600145522288"></p><p>例题：</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/连续/1600161636813.png" alt="1600161636813"></p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/连续/1600162013682.png" alt="1600162013682"></p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/连续/1600164950987.png" alt="1600164950987"></p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/连续/1600167044079.png" alt="1600167044079"></p><p>$f(x)= e^{lnf(x)}$、两个重要极限</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/连续/1600167548596.png" alt="1600167548596"></p><h2 id="闭区间上连续性质"><a href="#闭区间上连续性质" class="headerlink" title="闭区间上连续性质"></a>闭区间上连续性质</h2><p>(有界性) 如果在$[a,b]$上是连续的，有界</p><p>(最值性) 如果在$[a,b]$上是连续的，b有最大最小值</p><p>(介值性) 如果在$[a,b]$上是连续的，最小值m，最大值M，介于m和M之间的任意一个取值：m&lt;c&lt;M</p><p>必存在一点$\xi$:      $f(\xi)=c$</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/连续/1600168581142.png" alt="1600168581142"></p><h3 id="零点存在定理"><a href="#零点存在定理" class="headerlink" title="零点存在定理"></a>零点存在定理</h3><p>[a,b]上是连续的，f(a)f(b)&lt;0 异号</p><p>在(a,b)存在一点$\xi$，$f(\xi)=0$</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/连续/1600169591606.png" alt="1600169591606"></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h4 id=&quot;增量-改变量&quot;&gt;&lt;a href=&quot;#增量-改变量&quot; class=&quot;headerlink&quot; title=&quot;增量(改变量)&quot;&gt;&lt;/a&gt;增量(改变量)&lt;/h4&gt;&lt;p&gt;&lt;img src= &quot;/img/loading.gif&quot; data-lazy-src=&quot;https://
      
    
    </summary>
    
    
    
      <category term="math" scheme="https://kayleh.top/tags/math/"/>
    
  </entry>
  
  <entry>
    <title>无穷小与无穷大</title>
    <link href="https://kayleh.top/infinitesimal-and-infinite/"/>
    <id>https://kayleh.top/infinitesimal-and-infinite/</id>
    <published>2020-09-12T08:33:41.000Z</published>
    <updated>2020-09-26T02:14:10.962Z</updated>
    
    <content type="html"><![CDATA[<h1 id="无穷小量"><a href="#无穷小量" class="headerlink" title="无穷小量"></a>无穷小量</h1><h3 id="定义："><a href="#定义：" class="headerlink" title="定义："></a>定义：</h3><p>极限为0的变量称为无穷小量，简称无穷小. </p><p>f(x)→0</p><p>常用希腊字母 $\alpha$ ,$\beta$ ,$\gamma$</p><p><img src= "/img/loading.gif" data-lazy-src="](https://cdn.jsdelivr.net/gh/kayleh/cdn/img/无穷小与无穷大/1599900342394.png" alt="1599900342394" style="zoom:80%;"></p><script type="math/tex; mode=display">\lim_{x\to0}x^2=0 极限为0</script><script type="math/tex; mode=display">\lim_{x\to1}x^2=1 极限为1</script><script type="math/tex; mode=display">\lim_{x\to\infty}x^2=0 极限为\infty</script><h3 id="定理"><a href="#定理" class="headerlink" title="定理:"></a>定理:</h3><p>1.无穷小 × 有界 是无穷小</p><p><img src= "/img/loading.gif" data-lazy-src="](https://cdn.jsdelivr.net/gh/kayleh/cdn/img/无穷小与无穷大/1599986185723.png" alt="1599986185723"></p><p><img src= "/img/loading.gif" data-lazy-src="](https://cdn.jsdelivr.net/gh/kayleh/cdn/img/无穷小与无穷大/1599986310095.png" alt="1599986310095"></p><p>另一个例题</p><p><img src= "/img/loading.gif" data-lazy-src="](https://cdn.jsdelivr.net/gh/kayleh/cdn/img/无穷小与无穷大/1599986445115.png" alt="1599986445115" style="zoom:67%;"></p><p>分解后面的ardtanx，加上绝对值|ardtanx|，说明是有界的。</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/无穷小与无穷大/1599986528426.png" alt="1599986528426"></p><p>2.<img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/无穷小与无穷大/1599986676909.png" alt="1599986676909"></p><h1 id="无穷大"><a href="#无穷大" class="headerlink" title="无穷大"></a>无穷大</h1><p>$f(x)-&gt;+\infty 或-\infty$</p><p>1)两个无穷大相乘=无穷大</p><p>2)无穷大+有界-&gt;无穷大</p><h3 id="定理："><a href="#定理：" class="headerlink" title="定理："></a>定理：</h3><p>3.</p><ul><li>f(x)无穷大  $\frac{1}{f(x)}$无穷小 (同一变化过程)</li><li>f(x)无穷小  $\frac{1}{f(x)}$无穷小(同一变化过程)</li></ul><h1 id="极限的运算法则"><a href="#极限的运算法则" class="headerlink" title="极限的运算法则"></a>极限的运算法则</h1><p>定理(四则运算) 若$\lim f(x)=a  , \lim g(x)=b$（前提是每个函数极限存在,项是有限个的）</p><p>1)$\lim (f(x)+g(x))=\lim f(x) ± \lim g(x)=a ± b$</p><p>2)$\lim f(x)g(x)=\lim f(x) · \lim g(x)$</p><p>3)$\lim \frac{f(x)}{g(x)}=\frac {\lim f(x)}{\lim g(x)}(b≠0)$</p><p>其实就是把极限带进去</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/无穷小与无穷大/1599989272603.png" alt="1599989272603"></p><p>$\lim f(x)^n=(\lim f(x))^n$</p><p>例如：</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/无穷小与无穷大/1599991572302.png" alt="1599991572302"></p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/无穷小与无穷大/1599991769614.png" alt="1599991769614"></p><h3 id="frac-infty-infty"><a href="#frac-infty-infty" class="headerlink" title="$\frac{\infty}{\infty}$"></a>$\frac{\infty}{\infty}$</h3><p>分子、分母同次，最高次的系数之比（分子分母都趋于无穷）</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/无穷小与无穷大/1599992066326.png" alt="1599992066326"></p><p>分母次数高，0</p><p>分子次数高，$\infty$</p><p>分子有理化</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/无穷小与无穷大/1599992521008.png" alt="1599992521008"></p><h3 id="无限个项：多项式"><a href="#无限个项：多项式" class="headerlink" title="无限个项：多项式"></a>无限个项：多项式</h3><p>$ \frac{n(a_1+a_n)}{2}$</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/无穷小与无穷大/1599992622470.png" alt="1599992622470"></p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/无穷小与无穷大/1599993150129.png" alt="1599993150129"></p><p>=1</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/无穷小与无穷大/1599993401288.png" alt="1599993401288"></p><h1 id="极限存在准则-两个重要极限"><a href="#极限存在准则-两个重要极限" class="headerlink" title="极限存在准则 两个重要极限"></a>极限存在准则 两个重要极限</h1><p>一、夹逼定理：存在三个函数f(x).g(x).h(x)</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/无穷小与无穷大/1600002658181.png" alt="1600002658181"></p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/无穷小与无穷大/1600003472051.png" alt="1600003472051"></p><p>中间的一堆乘起来小于1，当n趋于无穷时，左边趋于0，右边趋于0</p><p>二、单调有界数列必有极限</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/无穷小与无穷大/1600005635112.png" alt="1600005635112"></p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/无穷小与无穷大/1600009971627.png" alt="1600009971627"></p><p>∴单调递增</p><h2 id="两个重要极限"><a href="#两个重要极限" class="headerlink" title="两个重要极限"></a>两个重要极限</h2><script type="math/tex; mode=display">\lim_{x\to0} \frac{sinx}{x}=1</script><p>例题1</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/无穷小与无穷大/1600011716508.png" alt="1600011716508"></p><p><img src= "/img/loading.gif" data-lazy-src="](https://cdn.jsdelivr.net/gh/kayleh/cdn/img/无穷小与无穷大/1600011741245.png" alt="1600011741245" style="zoom:67%;"></p><p>例题2</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/无穷小与无穷大/1600011828835.png" alt="1600011828835"></p><p><img src= "/img/loading.gif" data-lazy-src="](https://cdn.jsdelivr.net/gh/kayleh/cdn/img/无穷小与无穷大/1600012281358.png" alt="1600012281358" style="zoom:80%;"></p><p>例题3</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/无穷小与无穷大/1600012406004.png" alt="1600012406004"></p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/无穷小与无穷大/1600013433140.png" alt="1600013433140"></p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/无穷小与无穷大/1600054647972.png" alt="1600054647972"></p><p>利用反函数：</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/无穷小与无穷大/1600054832389.png" alt="1600054832389"></p><p>题型：</p><p><img src= "/img/loading.gif" data-lazy-src="](https://cdn.jsdelivr.net/gh/kayleh/cdn/img/无穷小与无穷大/1600055078141.png" alt="1600055078141" style="zoom:150%;"></p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/无穷小与无穷大/1600055150818.png" alt="1600055150818"></p><ul><li><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/无穷小与无穷大/1600055302965.png" alt="1600055302965"></p></li><li><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/无穷小与无穷大/1600055402981.png" alt="1600055402981"></p></li><li><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/无穷小与无穷大/1600056574474.png" alt="1600056574474"></p></li><li></li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/无穷小与无穷大/1600060254757.png" alt="1600060254757"></p><h1 id="无穷小的比较"><a href="#无穷小的比较" class="headerlink" title="无穷小的比较"></a>无穷小的比较</h1><p>$\lim f(x)=0$ ,$\lim$ $g(x)=0$ ,$g(x)≠0$</p><ul><li><p>$\lim \frac{f(x)}{g(x)}=0$ .$f(x)$比$g(x)$高阶无穷小，$f(x)=o(g(x))$</p></li><li><p>$\lim \frac{f(x)}{g(x)}=\infty$ .$f(x)$比$g(x)$低阶无穷小，没有符号</p></li></ul><p>如: $x\to 0$ , $\frac{x}{x^2}$ ,分母的趋0速度更快， $\frac{1}{x}$</p><ul><li>$\lim \frac{f(x)}{g(x)}=c≠0$，同阶无穷小；</li></ul><p>如：$x&gt;0$ , $\frac{4x}{2x}=2$</p><ul><li>$\lim \frac{f(x)}{g(x)}=c=1$ , 等价无穷小$f(x)$~$g(x)$</li></ul><p>例题：</p><p>1)$ln(1+x)$~$x$  $x\to0$</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/无穷小与无穷大/1600086990031.png" alt="1600086990031"></p><p>2)$e^x-1$~$x$</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/无穷小与无穷大/1600087533941.png" alt="1600087533941"></p><p>有个结论：</p><p>$a^x-1$~$xlna$</p><p>3)$\sqrt[n]{1+x}-1$~$\frac{1}{n}x$</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/无穷小与无穷大/1600088081673.png" alt="1600088081673"></p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/无穷小与无穷大/1600088599482.png" alt="1600088599482"></p><p>可以直接用的公式：</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/无穷小与无穷大/1600088819483.png" alt="1600088819483"></p><p>$f_1(x)$~$f_2(x)$,$g_1(x)$~$g_2(x)$ ,  $\lim \frac{f_2(x)}{g_2(x)}$存在极限</p><p>$\lim \frac{f_1(x)}{g_1(x)}$ = $\lim \frac{f_2(x)}{g_2(x)}$</p><p>1）两个无穷小之比才用</p><p>2）分子或分母是因子的乘积，选部分因替换</p><p>$\frac{(●)×(●)×(■)}{(●)×(■)}$</p><p>只保留■。</p><p>例题：</p><p>∵ $sinx$~$x$</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/无穷小与无穷大/1600094985483.png" alt="1600094985483"></p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/无穷小与无穷大/1600095161294.png" alt="1600095161294"></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;无穷小量&quot;&gt;&lt;a href=&quot;#无穷小量&quot; class=&quot;headerlink&quot; title=&quot;无穷小量&quot;&gt;&lt;/a&gt;无穷小量&lt;/h1&gt;&lt;h3 id=&quot;定义：&quot;&gt;&lt;a href=&quot;#定义：&quot; class=&quot;headerlink&quot; title=&quot;定义：&quot;&gt;&lt;/a&gt;定义
      
    
    </summary>
    
    
      <category term="高数" scheme="https://kayleh.top/categories/%E9%AB%98%E6%95%B0/"/>
    
    
      <category term="math" scheme="https://kayleh.top/tags/math/"/>
    
  </entry>
  
  <entry>
    <title>极限</title>
    <link href="https://kayleh.top/limit/"/>
    <id>https://kayleh.top/limit/</id>
    <published>2020-09-12T02:30:50.000Z</published>
    <updated>2020-09-26T02:18:51.938Z</updated>
    
    <content type="html"><![CDATA[<h1 id="极限"><a href="#极限" class="headerlink" title="极限"></a>极限</h1><blockquote><p> [“极限”是数学中的分支——微积分的基础概念，广义的“极限”是指“无限靠近而永远不能到达”的意思。数学中的“极限”指：某一个函数中的某一个变量，此变量在变大（或者变小）的永远变化的过程中，逐渐向某一个确定的数值A不断地逼近而“永远不能够重合到A”（“永远不能够等于A，但是取等于A‘已经足够取得高精度计算结果）的过程中，此变量的变化，被人为规定为“永远靠近而不停止”、其有一个“不断地极为靠近A点的趋势”。极限是一种“变化状态”的描述。此变量永远趋近的值A叫做“极限值”（当然也可以用其他符号表示）。 </p></blockquote><p>证明：1=0.9999·····？</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/极限/1599927106892.png" alt="1599927106892"></p><p>比如</p><p>假设有一圆</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/极限/1.png" alt="1599879927815"></p><p>有内接圆面积$A_1$</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/极限/2.png" alt="1599880274448"></p><p>记内接十二边形的面积为$A_2$</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/极限/3.png" alt="1599880425245"></p><p>24边形</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/极限/1599880485257.png" alt="1599880485257"></p><p>就可以得到一个数列{$A_n$}</p><h2 id="数列的极限"><a href="#数列的极限" class="headerlink" title="数列的极限"></a>数列的极限</h2><p>当n→$\infty$时，{$A_n$}也无限接近于某一确定的数值，这个数值称为数列{$A_n$}当n→$\infty$时的极限。</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/极限/1599880801602.png" alt="1599880801602"></p><p><img src= "/img/loading.gif" data-lazy-src="/limit/1599881076960.png" alt="1599881076960" style="zoom:80%;"></p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/极限/1599928047079.png" alt="1599928047079"></p><p>后面的值都落在这个邻域里面</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/极限/1599928641478.png" alt="1599928641478"></p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/极限/1599930175659.png" alt="1599930175659"></p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/极限/1599930952171.png" alt="1599930952171"></p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/极限/1599931509911.png" alt="1599931509911"></p><blockquote><p>n一定是 &gt; ???</p></blockquote><p>要求 $\lvert x_n -1 \rvert$=$\frac{1}{n}$&lt;$\epsilon$,只要n&gt;[$\frac{1}{\epsilon} $],以后的一切项均满足 $\lvert x_n -1 \rvert$&lt;$\epsilon$.</p><p>对于任意给定的正数$\epsilon$，总存在着一个正整数N(比如取N=[$\frac{1}{\epsilon}$]),当n&gt;N时，</p><script type="math/tex; mode=display">\lvert x_n -1 \rvert<\epsilon</script><p><img src= "/img/loading.gif" data-lazy-src="/limit/1599881826669.png" alt="1599881826669" style="zoom:67%;"></p><p>记作</p><script type="math/tex; mode=display">\lim_{n\to \infty} x_n = a或x_n→a(n→\infty)</script><p>如果上述a不存在，则称数列 <script type="math/tex">{x_n}</script>没有极限,或者说数列 <script type="math/tex">{x_n}</script> 是发散的，也说 $\lim_{n\to \infty} x_n$ 不存在.</p><h3 id="注意："><a href="#注意：" class="headerlink" title="注意："></a>注意：</h3><p>1.$\epsilon$的“任意给定”性极其重要；</p><p>2.N与$\epsilon$有关，有$\epsilon$的给定而确定；</p><p>3.$\forall$表示“任意给定”，$\exists$表示“存在”</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/极限/1599882486761.png" alt="1599882486761"></p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/极限/1599882565625.png" alt="1599882565625"></p><h5 id="例子："><a href="#例子：" class="headerlink" title="例子："></a>例子：</h5><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/极限/1599882657525.png" alt="1599882657525"></p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/极限/1599882730949.png" alt="1599882730949"></p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/极限/1599882888658.png" alt="1599882888658"></p><h3 id="性质"><a href="#性质" class="headerlink" title="性质"></a>性质</h3><p>性质1：{$x_n$}收敛 ，极限唯一.</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/极限/1599972015185.png" alt="1599972015185"></p><p>性质2：{$x_n$}收敛 ，有界</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/极限/1599972553113.png" alt="1599972553113"></p><ul><li>有界是收敛的必要，不是充分条件</li><li>单调有界，则有极限</li></ul><p>性质3：保号性$\lim_{x_n} = a$  , a&gt;0(a<0) ,$\exists$n, n>N  ,$x_n$&gt;0</0)></p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/极限/1599973321254.png" alt="1599973321254"></p><p>性质4：{$x_n$}收敛于a，子数列{$x_kn$}收敛于a.</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/极限/1599974407571.png" alt="1599974407571"></p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/极限/1599974801668.png" alt="1599974801668"></p><h2 id="函数极限："><a href="#函数极限：" class="headerlink" title="函数极限："></a>函数极限：</h2><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/极限/1599975390882.png" alt="1599975390882"></p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/极限/1599975713115.png" alt="1599975713115"></p><p>&lt; $\epsilon$</p><blockquote><p>取 X</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/极限/1599976461869.png" alt="1599976461869"></p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/极限/1599978196708.png" alt="1599978196708"></p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/极限/1599978312714.png" alt="1599978312714"></p><h4 id="x→-x-0-时函数f-x-的极限"><a href="#x→-x-0-时函数f-x-的极限" class="headerlink" title="x→$x_0$时函数f(x)的极限"></a>x→$x_0$时函数f(x)的极限</h4><p>(1)x→$x_0^-$,表示x从点$x_0$的左侧无限接近于$x_0$,此时x&lt;$x_0$;</p><p>(2)x→$x_0^+$,表示x从点$x_0$的右侧无限接近于$x_0$,此时x&gt;$x_0$;</p><p>(3)x→$x_0$,表示x从点$x_0$的左右两侧无限接近于$x_0$.</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/极限/1599894351689.png" alt="1599894351689"></p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/极限/1599978599316.png" alt="1599978599316"></p><p>注意：</p><p>(1)$x_0$是一个常数，而x是动点，是变化的量.</p><p>(2)在上述x的三个变化过程中，x无限地接近$x_0$,但永远不等于$x_0$.</p><h4 id="左极限："><a href="#左极限：" class="headerlink" title="左极限："></a>左极限：</h4><script type="math/tex; mode=display">f(x_0^-)=\lim_{x\to x_0^-} f(x) = A</script><p>称函数f(x)当x→$x_0^-$时以A为极限，简称f(x)在$x_0$点处左极限为A；</p><h4 id="右极限："><a href="#右极限：" class="headerlink" title="右极限："></a>右极限：</h4><script type="math/tex; mode=display">f(x_0^+)=\lim_{x\to x_0^+} f(x) = A</script><p>称函数f(x)当x→$x_0^+$时以A为极限，简称f(x)在$x_0$点处右极限为A；</p><h4 id="极限："><a href="#极限：" class="headerlink" title="极限："></a>极限：</h4><script type="math/tex; mode=display">\lim_{x\to x_0^-}f(x)=\lim_{x\to x_0^+}f(x)=\lim_{x\to x_0}f(x)=A</script><p>称函数f(x)当x→$x_0$时以A为极限，简称f(x)在$x_0$点处极限为A；    </p><p>函数y=f(x)在$x_0$处的极限与$f(x_0)$的取值、是否存在毫无关系!</p><p><img src= "/img/loading.gif" data-lazy-src="/limit/1599899267900.png" alt="1599899267900" style="zoom:67%;"></p><p><img src= "/img/loading.gif" data-lazy-src="/limit/1599899445163.png" alt="1599899445163" style="zoom:67%;"></p><p><img src= "/img/loading.gif" data-lazy-src="/limit/1599899539081.png" alt="1599899539081" style="zoom: 67%;"></p><h4 id="性质："><a href="#性质：" class="headerlink" title="性质："></a>性质：</h4><p>1.$\limf(x)$存在，是唯一的</p><p>2.局部有界性</p><p>3.局部保号性</p><p>4.</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/极限/1599984624615.png" alt="1599984624615"></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;极限&quot;&gt;&lt;a href=&quot;#极限&quot; class=&quot;headerlink&quot; title=&quot;极限&quot;&gt;&lt;/a&gt;极限&lt;/h1&gt;&lt;blockquote&gt;
&lt;p&gt; [“极限”是数学中的分支——微积分的基础概念，广义的“极限”是指“无限靠近而永远不能到达”的意思。数学中的“极限
      
    
    </summary>
    
    
    
      <category term="math" scheme="https://kayleh.top/tags/math/"/>
    
  </entry>
  
  <entry>
    <title>值传递</title>
    <link href="https://kayleh.top/pass-by-value/"/>
    <id>https://kayleh.top/pass-by-value/</id>
    <published>2020-09-10T05:01:12.000Z</published>
    <updated>2020-09-20T05:18:16.473Z</updated>
    
    <content type="html"><![CDATA[<h2 id="传值调用"><a href="#传值调用" class="headerlink" title="传值调用"></a>传值调用</h2><p>向函数传递参数的传值调用方法，把参数的实际值复制给函数的形式参数。在这种情况下，修改函数内的形式参数不会影响实际参数。默认情况下，C++ 使用传值调用方法来传递参数。一般来说，这意味着函数内的代码<strong>不会改变用于调用函数的实际参数。</strong></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 函数声明</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">swap</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 函数定义</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">swap</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> temp;</span><br><span class="line">    temp = x; <span class="comment">/* 保存 x 的值 */</span></span><br><span class="line">    x = y;    <span class="comment">/* 把 y 赋值给 x */</span></span><br><span class="line">    y = temp; <span class="comment">/* 把 x 赋值给 y */</span></span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// 局部变量声明</span></span><br><span class="line">    <span class="keyword">int</span> a = <span class="number">100</span>;</span><br><span class="line">    <span class="keyword">int</span> b = <span class="number">200</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">"before swap,a:"</span> &lt;&lt; a &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">"before swap,b:"</span> &lt;&lt; b &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 调用函数来交换值</span></span><br><span class="line">    swap(a, b);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">"After swap,a:"</span> &lt;&lt; a &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">"After swap,b:"</span> &lt;&lt; b &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="指针调用"><a href="#指针调用" class="headerlink" title="指针调用"></a>指针调用</h2><p>向函数传递参数的指针调用方法，把参数的地址复制给形式参数。在函数内，该地址用于访问调用中要用到的实际参数。这意味着，修改形式参数会影响实际参数。</p><p>按指针传递值，参数指针被传递给函数，就像传递其他值给函数一样。因此相应地，在下面的函数 swap()中，您需要声明函数参数为指针类型，该函数用于交换参数所指向的两个整数变量的值。</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">swap</span><span class="params">(<span class="keyword">int</span> *x, <span class="keyword">int</span> *y)</span></span>;</span><br><span class="line"><span class="comment">// 函数定义</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">swap</span><span class="params">(<span class="keyword">int</span> *x, <span class="keyword">int</span> *y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> temp;</span><br><span class="line">    temp = *x;    <span class="comment">/* 保存地址 x 的值 */</span></span><br><span class="line">    *x = *y;        <span class="comment">/* 把 y 赋值给 x */</span></span><br><span class="line">    *y = temp;    <span class="comment">/* 把 x 赋值给 y */</span></span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> a = <span class="number">100</span>;</span><br><span class="line">    <span class="keyword">int</span> b = <span class="number">200</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">"before swap,a:"</span> &lt;&lt; a &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">"before swap,b:"</span> &lt;&lt; b &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 调用函数来交换值</span></span><br><span class="line"><span class="comment">     * &amp;a 表示指向 a 的指针，即变量 a 的地址</span></span><br><span class="line"><span class="comment">     * &amp;b 表示指向 b 的指针，即变量 b 的地址</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    swap(&amp;a, &amp;b);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">"After swap,a:"</span> &lt;&lt; a &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">"After swap,b:"</span> &lt;&lt; b &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr><h2 id="引用调用"><a href="#引用调用" class="headerlink" title="引用调用"></a>引用调用</h2><p>//向函数传递参数的引用调用方法，把引用的地址复制给形式参数。在函数内，该引用用于访问调用中要用到的实际参数。这意味着，修改形式参数会影响实际参数。//按引用传递值，参数引用被传递给函数，就像传递其他值给函数一样。因此相应地，//在下面的函数 swap()中，您需要声明函数参数为引用类型，该函数用于交换参数所指向的两个整数变量的值。</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">swap</span><span class="params">(<span class="keyword">int</span> &amp;x, <span class="keyword">int</span> &amp;y)</span></span>;</span><br><span class="line"><span class="comment">// 函数定义</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">swap</span><span class="params">(<span class="keyword">int</span> &amp;x, <span class="keyword">int</span> &amp;y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> temp;</span><br><span class="line">    temp = x;    <span class="comment">/* 保存地址 x 的值 */</span></span><br><span class="line">    x = y;        <span class="comment">/* 把 y 赋值给 x */</span></span><br><span class="line">    y = temp;    <span class="comment">/* 把 x 赋值给 y */</span></span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">// 局部变量声明</span></span><br><span class="line">    <span class="keyword">int</span> a = <span class="number">100</span>;</span><br><span class="line">    <span class="keyword">int</span> b = <span class="number">200</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">"before swap,a:"</span> &lt;&lt; a &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">"before swap,b:"</span> &lt;&lt; b &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 调用函数来交换值</span></span><br><span class="line">    swap(a, b);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">"After swap,a:"</span> &lt;&lt; a &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; <span class="string">"After swap,b:"</span> &lt;&lt; b &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;传值调用&quot;&gt;&lt;a href=&quot;#传值调用&quot; class=&quot;headerlink&quot; title=&quot;传值调用&quot;&gt;&lt;/a&gt;传值调用&lt;/h2&gt;&lt;p&gt;向函数传递参数的传值调用方法，把参数的实际值复制给函数的形式参数。在这种情况下，修改函数内的形式参数不会影响实际参数。默认情
      
    
    </summary>
    
    
      <category term="C" scheme="https://kayleh.top/categories/C/"/>
    
    
      <category term="C" scheme="https://kayleh.top/tags/C/"/>
    
  </entry>
  
  <entry>
    <title>docker虚拟化容器</title>
    <link href="https://kayleh.top/docker-virtualized-container/"/>
    <id>https://kayleh.top/docker-virtualized-container/</id>
    <published>2020-08-28T08:36:20.000Z</published>
    <updated>2020-09-26T02:11:16.075Z</updated>
    
    <content type="html"><![CDATA[<p>docker</p><a id="more"></a><h2 id="为什么会有docker出现"><a href="#为什么会有docker出现" class="headerlink" title="为什么会有docker出现"></a>为什么会有docker出现</h2><blockquote><p>一款产品从开发到上线，从操作系统，到运行环境，再到应用配置。作为开发+运维之间的协作我们需要关心很多东西，这也是很多互联网公司都不得不面对的问题，特别是各种版本的迭代之后，不同版本环境的兼容，对运维人员都是考验<br>Docker之所以发展如此迅速，也是因为它对此给出了一个标准化的解决方案。<br>环境配置如此麻烦，换一台机器，就要重来一次，费力费时。很多人想到，能不能从根本上解决问题，软件可以带环境安装？也就是说，安装的时候，把原始环境一模一样地复制过来。开发人员利用 Docker 可以消除协作编码时“在我的机器上可正常工作”的问题。</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/docker虚拟化容器/1.png" alt="1598604152509"><br>之前在服务器配置一个应用的运行环境，要安装各种软件，就拿尚硅谷电商项目的环境来说吧，Java/Tomcat/MySQL/JDBC驱动包等。安装和配置这些东西有多麻烦就不说了，它还不能跨平台。假如我们是在 Windows 上安装的这些环境，到了 Linux 又得重新装。况且就算不跨操作系统，换另一台同样操作系统的服务器，要移植应用也是非常麻烦的。</p><p>传统上认为，软件编码开发/测试结束后，所产出的成果即是程序或是能够编译执行的二进制字节码等(java为例)。而为了让这些程序可以顺利执行，开发团队也得准备完整的部署文件，让维运团队得以部署应用程式，开发需要清楚的告诉运维部署团队，用的全部配置文件+所有软件环境。不过，即便如此，仍然常常发生部署失败的状况。Docker镜像的设计，使得Docker得以打破过去「程序即应用」的观念。透过镜像(images)将作业系统核心除外，运作应用程式所需要的系统环境，由下而上打包，达到应用程式跨平台间的无缝接轨运作。</p></blockquote><h1 id="docker理念"><a href="#docker理念" class="headerlink" title="docker理念"></a>docker理念</h1><p>Docker是基于Go语言实现的云开源项目。<br>Docker的主要目标是“Build，Ship and Run Any App,Anywhere”，也就是通过对应用组件的封装、分发、部署、运行等生命周期的管理，使用户的APP（可以是一个WEB应用或数据库应用等等）及其运行环境能够做到“一次封装，到处运行”。</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/docker虚拟化容器/2.png" alt="1598604211629"></p><p>Linux 容器技术的出现就解决了这样一个问题，而 Docker 就是在它的基础上发展过来的。将应用运行在 Docker 容器上面，而 Docker 容器在任何操作系统上都是一致的，这就实现了跨平台、跨服务器。只需要一次配置好环境，换到别的机子上就可以一键部署好，大大简化了操作</p><p>解决了运行环境和配置问题软件容器，方便做持续集成并有助于整体发布的容器虚拟化技术。</p><h3 id="能干吗？"><a href="#能干吗？" class="headerlink" title="能干吗？"></a>能干吗？</h3><h4 id="之前的虚拟机技术："><a href="#之前的虚拟机技术：" class="headerlink" title="之前的虚拟机技术："></a>之前的虚拟机技术：</h4><p>虚拟机（virtual machine）就是带环境安装的一种解决方案。<br>它可以在一种操作系统里面运行另一种操作系统，比如在Windows 系统里面运行Linux 系统。应用程序对此毫无感知，因为虚拟机看上去跟真实系统一模一样，而对于底层系统来说，虚拟机就是一个普通文件，不需要了就删掉，对其他部分毫无影响。这类虚拟机完美的运行了另一套系统，能够使应用程序，操作系统和硬件三者之间的逻辑不变。  </p><p><img src= "/img/loading.gif" data-lazy-src="/docker-virtualized-container/Blog\source\_posts\docker虚拟化容器\3.png" alt="1598604274549" style="zoom:67%;"></p><p>虚拟机的缺点：<br>1    资源占用多               2    冗余步骤多                 3    启动慢</p><h4 id="容器虚拟化技术"><a href="#容器虚拟化技术" class="headerlink" title="容器虚拟化技术"></a>容器虚拟化技术</h4><p>由于前面虚拟机存在这些缺点，Linux 发展出了另一种虚拟化技术：Linux 容器（Linux Containers，缩写为 LXC）。<br>Linux 容器不是模拟一个完整的操作系统，而是对进程进行隔离。有了容器，就可以将软件运行所需的所有资源打包到一个隔离的容器中。容器与虚拟机不同，不需要捆绑一整套操作系统，只需要软件工作所需的库资源和设置。系统因此而变得高效轻量并保证部署在任何环境中的软件都能始终如一地运行。</p><p><img src= "/img/loading.gif" data-lazy-src="/docker-virtualized-container/Blog\source\_posts\docker虚拟化容器\4.png" alt="1598604334770" style="zoom:67%;"></p><p>比较了 Docker 和传统虚拟化方式的不同之处：<br><em>传统虚拟机技术是虚拟出一套硬件后，在其上运行一个完整操作系统，在该系统上再运行所需应用进程；</em>而容器内的应用进程直接运行于宿主的内核，容器内没有自己的内核，而且也没有进行硬件虚拟。因此容器要比传统虚拟机更为轻便。</p><ul><li>每个容器之间互相隔离，每个容器有自己的文件系统 ，容器之间进程不会相互影响，能区分计算资源。</li></ul><h4 id="开发-运维（DevOps）"><a href="#开发-运维（DevOps）" class="headerlink" title="开发/运维（DevOps）"></a>开发/运维（DevOps）</h4><blockquote><p>一次构建、随处运行</p></blockquote><ul><li><p>更快速的应用交付和部署</p><blockquote><p>传统的应用开发完成后，需要提供一堆安装程序和配置说明文档，安装部署后需根据配置文档进行繁杂的配置才能正常运行。Docker化之后只需要交付少量容器镜像文件，在正式生产环境加载镜像并运行即可，应用安装配置在镜像里已经内置好，大大节省部署配置和测试验证时间。</p></blockquote></li><li><p>更便捷的升级和扩缩容</p><blockquote><p>随着微服务架构和Docker的发展，大量的应用会通过微服务方式架构，应用的开发构建将变成搭乐高积木一样，每个Docker容器将变成一块“积木”，应用的升级将变得非常容易。当现有的容器不足以支撑业务处理时，可通过镜像运行新的容器进行快速扩容，使应用系统的扩容从原先的天级变成分钟级甚至秒级。</p></blockquote></li><li><p>更简单的系统运维</p><blockquote><p>应用容器化运行后，生产环境运行的应用可与开发、测试环境的应用高度一致，容器会将应用程序相关的环境和状态完全封装起来，不会因为底层基础架构和操作系统的不一致性给应用带来影响，产生新的BUG。当出现程序异常时，也可以通过测试环境的相同容器进行快速定位和修复。</p></blockquote></li><li><p>更高效的计算资源利用</p><blockquote><p>Docker是内核级虚拟化，其不像传统的虚拟化技术一样需要额外的Hypervisor支持，所以在一台物理机上可以运行很多个容器实例，可大大提升物理服务器的CPU和内存的利用率。</p></blockquote></li></ul><p>docker中文网站：<a href="https://www.docker-cn.com/" target="_blank" rel="noopener">https://www.docker-cn.com/</a></p><p>仓库：Docker Hub官网: <a href="https://hub.docker.com/" target="_blank" rel="noopener">https://hub.docker.com/</a></p><h1 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h1><h4 id="前提："><a href="#前提：" class="headerlink" title="前提："></a>前提：</h4><h5 id="CentOS-Docker-安装"><a href="#CentOS-Docker-安装" class="headerlink" title="CentOS Docker 安装"></a>CentOS Docker 安装</h5><p>Docker支持以下的CentOS版本：<br>CentOS 7 (64-bit)<br>CentOS 6.5 (64-bit) 或更高的版本</p><h5 id="前提条件"><a href="#前提条件" class="headerlink" title="前提条件"></a>前提条件</h5><p>目前，CentOS 仅发行版本中的内核支持 Docker。<br>Docker 运行在 CentOS 7 上，要求系统为64位、系统内核版本为 3.10 以上。<br>Docker 运行在 CentOS-6.5 或更高的版本的 CentOS 上，要求系统为64位、系统内核版本为 2.6.32-431 或者更高版本。</p><h5 id="查看自己的内核"><a href="#查看自己的内核" class="headerlink" title="查看自己的内核"></a>查看自己的内核</h5><p>uname命令用于打印当前系统相关信息（内核版本号、硬件架构、主机名称和操作系统类型等）。</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/docker虚拟化容器/6.png" alt="1598605075304"></p><p>查看已安装的CentOS版本信息（CentOS6.8有，CentOS7无该命令）</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/docker虚拟化容器/7.png" alt="1598605093121"></p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/docker虚拟化容器/8.png" alt="1598605106745"></p><h3 id="Docker的基本组成"><a href="#Docker的基本组成" class="headerlink" title="Docker的基本组成"></a>Docker的基本组成</h3><p>镜像（image）</p><ul><li><p>Docker 镜像（Image）就是一个只读的模板。镜像可以用来创建 Docker 容器，一个镜像可以创建很多容器。</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/docker虚拟化容器/9.png" alt="1"></p></li></ul><p>容器（container）</p><ul><li><p>Docker 利用容器（Container）独立运行的一个或一组应用。容器是用镜像创建的运行实例。</p><p>它可以被启动、开始、停止、删除。每个容器都是相互隔离的、保证安全的平台。</p><p>可以把容器看做是一个简易版的 Linux 环境（包括root用户权限、进程空间、用户空间和网络空间等）和运行在其中的应用程序。</p><p>容器的定义和镜像几乎一模一样，也是一堆层的统一视角，唯一区别在于容器的最上面那一层是可读可写的。</p></li></ul><p>仓库（repository）</p><ul><li><p>仓库（Repository）是集中存放镜像文件的场所。<br>仓库(Repository)和仓库注册服务器（Registry）是有区别的。仓库注册服务器上往往存放着多个仓库，每个仓库中又包含了多个镜像，每个镜像有不同的标签（tag）。</p><p>仓库分为公开仓库（Public）和私有仓库（Private）两种形式。<br>最大的公开仓库是 Docker Hub(<a href="https://hub.docker.com/)，" target="_blank" rel="noopener">https://hub.docker.com/)，</a><br>存放了数量庞大的镜像供用户下载。国内的公开仓库包括阿里云 、网易云 等</p></li></ul><p>小总结</p><blockquote><p>需要正确的理解仓储/镜像/容器这几个概念:</p><p> Docker 本身是一个容器运行载体或称之为管理引擎。我们把应用程序和配置依赖打包好形成一个可交付的运行环境，这个打包好的运行环境就似乎 image镜像文件。只有通过这个镜像文件才能生成 Docker 容器。image 文件可以看作是容器的模板。Docker 根据 image 文件生成容器的实例。同一个 image 文件，可以生成多个同时运行的容器实例。</p><ul><li>image 文件生成的容器实例，本身也是一个文件，称为镜像文件。</li><li>一个容器运行一种服务，当我们需要的时候，就可以通过docker客户端创建一个对应的运行实例，也就是我们的容器</li><li>至于仓储，就是放了一堆镜像的地方，我们可以把镜像发布到仓储中，需要的时候从仓储中拉下来就可以了。</li></ul></blockquote><h3 id="Docker的架构图"><a href="#Docker的架构图" class="headerlink" title="Docker的架构图"></a>Docker的架构图</h3><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/docker虚拟化容器/10.png" alt="1598605341500"></p><h2 id="CentOS7安装Docker"><a href="#CentOS7安装Docker" class="headerlink" title="CentOS7安装Docker"></a>CentOS7安装Docker</h2><blockquote><p><a href="https://docs.docker.com/install/linux/docker-ce/centos/" target="_blank" rel="noopener">https://docs.docker.com/install/linux/docker-ce/centos/</a></p><p>官网中文安装参考手册:</p><p><a href="https://docs.docker-cn.com/engine/installation/linux/docker-ce/centos/#prerequisites" target="_blank" rel="noopener">https://docs.docker-cn.com/engine/installation/linux/docker-ce/centos/#prerequisites</a></p></blockquote><ol><li><p>确定你是CentOS7及以上版本</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /etc/redhat-release</span><br></pre></td></tr></table></figure></li><li><p>yum安装gcc相关</p><p>CentOS7能上外网</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/docker虚拟化容器/5.png" alt="1"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">yum -y install gcc</span><br><span class="line">yum -y install gcc-c++</span><br></pre></td></tr></table></figure></li><li><p>卸载旧版本</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum -y remove docker docker-common docker-selinux docker-engine</span><br></pre></td></tr></table></figure><p>2018.3官网版本</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">yum remove docker \</span><br><span class="line">                  docker-client \</span><br><span class="line">                  docker-client-latest \</span><br><span class="line">                  docker-common \</span><br><span class="line">                  docker-latest \</span><br><span class="line">                  docker-latest-logrotate \</span><br><span class="line">                  docker-logrotate \</span><br><span class="line">                  docker-selinux \</span><br><span class="line">                  docker-engine-selinux \</span><br><span class="line">                  docker-engine</span><br></pre></td></tr></table></figure></li><li><p>安装需要的软件包</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install -y yum-utils device-mapper-persistent-data lvm2</span><br></pre></td></tr></table></figure></li><li><p>设置stable镜像仓库</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo</span><br></pre></td></tr></table></figure></li><li><p>更新yum软件包索引</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum makecache fast</span><br></pre></td></tr></table></figure></li><li><p>安装DOCKER CE</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum -y install docker-ce</span><br></pre></td></tr></table></figure></li><li><p>启动docker</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl <span class="built_in">start</span> docker</span><br></pre></td></tr></table></figure></li><li><p>测试</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker version</span><br><span class="line">docker run hello-world</span><br></pre></td></tr></table></figure></li><li><p>配置镜像加速</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> -p /etc/docker</span><br><span class="line">vim  /etc/docker/daemon.json</span><br><span class="line">----</span><br><span class="line"> </span><br><span class="line"> #网易云</span><br><span class="line">&#123;"registry-mirrors": ["http://hub-mirror.c.<span class="number">163</span>.com"] &#125;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"> #阿里云</span><br><span class="line">&#123;</span><br><span class="line">  "registry-mirrors": ["https://｛自已的编码｝.mirror.aliyuncs.com"]</span><br><span class="line">&#125;</span><br><span class="line">----</span><br><span class="line">systemctl daemon-reload</span><br><span class="line">systemctl restart docker</span><br></pre></td></tr></table></figure></li><li><p>卸载</p><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">systemctl stop docker </span><br><span class="line">yum -y remove docker-ce</span><br><span class="line">rm -rf /var/lib/docker</span><br></pre></td></tr></table></figure></li></ol><h1 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h1><h4 id="阿里云镜像加速"><a href="#阿里云镜像加速" class="headerlink" title="阿里云镜像加速"></a>阿里云镜像加速</h4><blockquote><p><a href="https://dev.aliyun.com/search.html" target="_blank" rel="noopener">https://dev.aliyun.com/search.html</a></p></blockquote><p>登陆阿里云开发者平台,获取加速器地址</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/docker虚拟化容器/11.png" alt="1598605448117"></p><p>配置本机Docker运行镜像加速器</p><p>鉴于国内网络问题，后续拉取 Docker 镜像十分缓慢，我们可以需要配置加速器来解决，<br>我使用的是阿里云的本人自己账号的镜像地址(需要自己注册有一个属于你自己的)：   <a href="https://xxxx.mirror.aliyuncs.com" target="_blank" rel="noopener">https://xxxx.mirror.aliyuncs.com</a></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">vim &#x2F;etc&#x2F;sysconfig&#x2F;docker</span><br><span class="line"></span><br><span class="line">将获得的自己账户下的阿里云加速地址配置进</span><br><span class="line">other_args&#x3D;&quot;--registry-mirror&#x3D;https:&#x2F;&#x2F;你自己的账号加速信息.mirror.aliyuncs.com&quot;</span><br></pre></td></tr></table></figure><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/docker虚拟化容器/12.png" alt="1598605528307"></p><p>重新启动Docker后台服务：service docker restart</p><p>Linux 系统下配置完加速器需要检查是否生效</p><p>如果从结果中看到了配置的—registry-mirror参数说明配置成功，如下所示:</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/docker虚拟化容器/13.png" alt="1598605562504"></p><h2 id="启动Docker后台容器-测试运行-hello-world"><a href="#启动Docker后台容器-测试运行-hello-world" class="headerlink" title="启动Docker后台容器(测试运行 hello-world)"></a>启动Docker后台容器(测试运行 hello-world)</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run hello-world</span><br></pre></td></tr></table></figure><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/docker虚拟化容器/14.png" alt="1598605611408"></p><p>输出这段提示以后，hello world就会停止运行，容器自动终止。</p><ul><li>run干了什么</li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/docker虚拟化容器/15.png" alt="1598605642470"></p><h3 id="Docker是怎么工作的"><a href="#Docker是怎么工作的" class="headerlink" title="Docker是怎么工作的"></a>Docker是怎么工作的</h3><blockquote><p>Docker是一个Client-Server结构的系统，Docker守护进程运行在主机上， 然后通过Socket连接从客户端访问，守护进程从客户端接受命令并管理运行在主机上的容器。 容器，是一个运行时环境，就是我们前面说到的集装箱。</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/docker虚拟化容器/16.png" alt="1598605821646"></p><h3 id="为什么Docker比较比VM快"><a href="#为什么Docker比较比VM快" class="headerlink" title="为什么Docker比较比VM快"></a>为什么Docker比较比VM快</h3><blockquote><p>(1)docker有着比虚拟机更少的抽象层。由亍docker不需要Hypervisor实现硬件资源虚拟化,运行在docker容器上的程序直接使用的都是实际物理机的硬件资源。因此在CPU、内存利用率上docker将会在效率上有明显优势。</p><p>(2)docker利用的是宿主机的内核,而不需要Guest OS。因此,当新建一个容器时,docker不需要和虚拟机一样重新加载一个操作系统内核。仍而避免引寻、加载操作系统内核返个比较费时费资源的过程,当新建一个虚拟机时,虚拟机软件需要加载Guest OS,返个新建过程是分钟级别的。而docker由于直接利用宿主机的操作系统,则省略了返个过程,因此新建一个docker容器只需要几秒钟。</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/docker虚拟化容器/17.png" alt="1"></p><h1 id="Docker常用命令"><a href="#Docker常用命令" class="headerlink" title="Docker常用命令"></a>Docker常用命令</h1><h3 id="帮助命令"><a href="#帮助命令" class="headerlink" title="帮助命令"></a>帮助命令</h3><ul><li>docker version</li><li>docker info</li><li>docker —help</li></ul><h3 id="镜像命令"><a href="#镜像命令" class="headerlink" title="镜像命令"></a>镜像命令</h3><ul><li><p>docker images</p><blockquote><p>列出本地主机上的镜像</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/docker虚拟化容器/18.png" alt="1598606088968"></p><p>各个选项说明:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">REPOSITORY：表示镜像的仓库源</span><br><span class="line">TAG：镜像的标签</span><br><span class="line">IMAGE ID：镜像ID</span><br><span class="line">CREATED：镜像创建时间</span><br><span class="line">SIZE：镜像大小</span><br></pre></td></tr></table></figure><p>同一仓库源可以有多个 TAG，代表这个仓库源的不同个版本，我们使用 REPOSITORY:TAG 来定义不同的镜像。<br>如果你不指定一个镜像的版本标签，例如你只使用 ubuntu，docker 将默认使用 ubuntu:latest 镜像</p><p><strong>OPTIONS说明：</strong></p><p>-a :列出本地所有的镜像（含中间映像层）</p><p>-q :只显示镜像ID。</p><p>—digests :显示镜像的摘要信息</p><p>—no-trunc :显示完整的镜像信息</p></blockquote></li><li><p>docker search 某个XXX镜像名字</p><blockquote><p><a href="https://hub.docker.com" target="_blank" rel="noopener">https://hub.docker.com</a></p><p>命令: docker search [OPTIONS] 镜像名字</p><p>OPTIONS说明：</p><p>—no-trunc : 显示完整的镜像描述</p><p>-s : 列出收藏数不小于指定值的镜像。</p><p>—automated : 只列出 automated build类型的镜像；</p></blockquote></li><li><p>docker pull 某个XXX镜像名字</p><blockquote><p>下载镜像</p><p>docker pull 镜像名字[:TAG]</p></blockquote></li><li><p>docker rmi 某个XXX镜像名字ID</p><p>删除镜像</p><p>删除单个 docker rmi  -f 镜像ID</p><p>删除多个 docker rmi -f 镜像名1:TAG 镜像名2:TAG </p><p>删除全部 docker rmi -f $(docker images -qa)</p></li></ul><p>？思考</p><blockquote><p>结合我们Git的学习心得，大家猜猜是否会有<br>docker commit /docker push？？</p></blockquote><h3 id="容器命令"><a href="#容器命令" class="headerlink" title="容器命令"></a>容器命令</h3><blockquote><p>有镜像才能创建容器，这是根本前提(下载一个CentOS镜像演示)</p><p>docker pull centos</p></blockquote><p>新建并启动容器</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run [OPTIONS] IMAGE [COMMAND] [ARG...]</span><br></pre></td></tr></table></figure><p> OPTIONS说明:</p><blockquote><p>有些是一个减号，有些是两个减号</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">--name&#x3D;&quot;容器新名字&quot;: 为容器指定一个名称；</span><br><span class="line">-d: 后台运行容器，并返回容器ID，也即启动守护式容器；</span><br><span class="line">-i：以交互模式运行容器，通常与 -t 同时使用；</span><br><span class="line">-t：为容器重新分配一个伪输入终端，通常与 -i 同时使用；</span><br><span class="line">-P: 随机端口映射；</span><br><span class="line">-p: 指定端口映射，有以下四种格式</span><br><span class="line">      ip:hostPort:containerPort</span><br><span class="line">      ip::containerPort</span><br><span class="line">      hostPort:containerPort</span><br><span class="line">      containerPort</span><br></pre></td></tr></table></figure><ul><li>启动交互式容器</li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/docker虚拟化容器/19.png" alt="1598606569114"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#使用镜像centos:latest以交互模式启动一个容器,在容器内执行&#x2F;bin&#x2F;bash命令。</span><br><span class="line">docker run -it centos &#x2F;bin&#x2F;bash</span><br></pre></td></tr></table></figure><p>列出当前所有正在运行的容器</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">docker ps [OPTIONS]</span><br><span class="line">-------------------------------------</span><br><span class="line">OPTIONS说明</span><br><span class="line">-a :列出当前所有正在运行的容器+历史上运行过的</span><br><span class="line">-l :显示最近创建的容器。</span><br><span class="line">-n：显示最近n个创建的容器。</span><br><span class="line">-q :静默模式，只显示容器编号。</span><br><span class="line">--no-trunc :不截断输出。</span><br></pre></td></tr></table></figure><p>退出容器</p><blockquote><p>两种退出方式 </p><ul><li><p>exit</p><p>容器停止退出</p></li><li><p>ctrl+P+Q</p><p>容器不停止退出</p></li></ul></blockquote><p>启动容器</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker start 容器ID或者容器名</span><br></pre></td></tr></table></figure><p>重启容器</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker restart 容器ID或者容器名</span><br></pre></td></tr></table></figure><p>停止容器</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker stop 容器ID或者容器名</span><br></pre></td></tr></table></figure><p>强制停止容器</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker kill 容器ID或者容器名</span><br></pre></td></tr></table></figure><p>删除已停止的容器</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker rm 容器ID</span><br></pre></td></tr></table></figure><ul><li><p>一次性删除多个容器</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker rm -f $(docker ps -a -q)</span><br><span class="line">docker ps -a -q | xargs docker rm</span><br></pre></td></tr></table></figure></li></ul><p><strong>重要</strong></p><p>启动守护式容器</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">docker run -d 容器名</span><br><span class="line">----------------------------</span><br><span class="line"> </span><br><span class="line">#使用镜像centos:latest以后台模式启动一个容器</span><br><span class="line">docker run -d centos</span><br><span class="line"> </span><br><span class="line">问题：然后docker ps -a 进行查看, 会发现容器已经退出</span><br><span class="line">很重要的要说明的一点: Docker容器后台运行,就必须有一个前台进程.</span><br><span class="line">容器运行的命令如果不是那些一直挂起的命令（比如运行top，tail），就是会自动退出的。</span><br><span class="line"> </span><br><span class="line">这个是docker的机制问题,比如你的web容器,我们以nginx为例，正常情况下,我们配置启动服务只需要启动响应的service即可。例如</span><br><span class="line">service nginx start</span><br><span class="line">但是,这样做,nginx为后台进程模式运行,就导致docker前台没有运行的应用,</span><br><span class="line">这样的容器后台启动后,会立即自杀因为他觉得他没事可做了.</span><br><span class="line">所以，最佳的解决方案是,将你要运行的程序以前台进程的形式运行</span><br></pre></td></tr></table></figure><p>查看容器日志</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker logs -f -t --tail 容器ID</span><br></pre></td></tr></table></figure><ul><li><p>docker run -d centos /bin/sh -c “while true;do echo hello zzyy;sleep 2;done”</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/docker虚拟化容器/20.png" alt="1"></p><ul><li>-t 是加入时间戳</li><li>-f 跟随最新的日志打印</li><li>—tail 数字 显示最后多少条</li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/docker虚拟化容器/21.png" alt="1598606975626"></p></li></ul><p>查看容器内运行的进程</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker top 容器ID</span><br></pre></td></tr></table></figure><p>查看容器内部细节</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker inspect 容器ID</span><br></pre></td></tr></table></figure><p>进入正在运行的容器并以命令行交互</p><ul><li><p>docker exec -it 容器ID bashShell</p></li><li><p>重新进入docker attach 容器ID</p></li><li><p>上述两个区别</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">attach 直接进入容器启动命令的终端，不会启动新的进程</span><br><span class="line">exec 是在容器中打开新的终端，并且可以启动新的进程</span><br></pre></td></tr></table></figure></li></ul><p>从容器内拷贝文件到主机上</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker cp  容器ID:容器内路径 目的主机路径</span><br></pre></td></tr></table></figure><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/docker虚拟化容器/22.png" alt="1598607114510"></p><p>小总结</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/docker虚拟化容器/23.png" alt="1598607164719"></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">attach    Attach to a running container                 # 当前 shell 下 attach 连接指定运行镜像</span><br><span class="line">build     Build an image from a Dockerfile              # 通过 Dockerfile 定制镜像</span><br><span class="line">commit    Create a new image from a container changes   # 提交当前容器为新的镜像</span><br><span class="line">cp        Copy files&#x2F;folders from the containers filesystem to the host path   #从容器中拷贝指定文件或者目录到宿主机中</span><br><span class="line">create    Create a new container                        # 创建一个新的容器，同 run，但不启动容器</span><br><span class="line">diff      Inspect changes on a container&#39;s filesystem   # 查看 docker 容器变化</span><br><span class="line">events    Get real time events from the server          # 从 docker 服务获取容器实时事件</span><br><span class="line">exec      Run a command in an existing container        # 在已存在的容器上运行命令</span><br><span class="line">export    Stream the contents of a container as a tar archive   # 导出容器的内容流作为一个 tar 归档文件[对应 import ]</span><br><span class="line">history   Show the history of an image                  # 展示一个镜像形成历史</span><br><span class="line">images    List images                                   # 列出系统当前镜像</span><br><span class="line">import    Create a new filesystem image from the contents of a tarball # 从tar包中的内容创建一个新的文件系统映像[对应export]</span><br><span class="line">info      Display system-wide information               # 显示系统相关信息</span><br><span class="line">inspect   Return low-level information on a container   # 查看容器详细信息</span><br><span class="line">kill      Kill a running container                      # kill 指定 docker 容器</span><br><span class="line">load      Load an image from a tar archive              # 从一个 tar 包中加载一个镜像[对应 save]</span><br><span class="line">login     Register or Login to the docker registry server    # 注册或者登陆一个 docker 源服务器</span><br><span class="line">logout    Log out from a Docker registry server          # 从当前 Docker registry 退出</span><br><span class="line">logs      Fetch the logs of a container                 # 输出当前容器日志信息</span><br><span class="line">port      Lookup the public-facing port which is NAT-ed to PRIVATE_PORT    # 查看映射端口对应的容器内部源端口</span><br><span class="line">pause     Pause all processes within a container        # 暂停容器</span><br><span class="line">ps        List containers                               # 列出容器列表</span><br><span class="line">pull      Pull an image or a repository from the docker registry server   # 从docker镜像源服务器拉取指定镜像或者库镜像</span><br><span class="line">push      Push an image or a repository to the docker registry server    # 推送指定镜像或者库镜像至docker源服务器</span><br><span class="line">restart   Restart a running container                   # 重启运行的容器</span><br><span class="line">rm        Remove one or more containers                 # 移除一个或者多个容器</span><br><span class="line">rmi       Remove one or more images             # 移除一个或多个镜像[无容器使用该镜像才可删除，否则需删除相关容器才可继续或 -f 强制删除]</span><br><span class="line">run       Run a command in a new container              # 创建一个新的容器并运行一个命令</span><br><span class="line">save      Save an image to a tar archive                # 保存一个镜像为一个 tar 包[对应 load]</span><br><span class="line">search    Search for an image on the Docker Hub         # 在 docker hub 中搜索镜像</span><br><span class="line">start     Start a stopped containers                    # 启动容器</span><br><span class="line">stop      Stop a running containers                     # 停止容器</span><br><span class="line">tag       Tag an image into a repository                # 给源中镜像打标签</span><br><span class="line">top       Lookup the running processes of a container   # 查看容器中运行的进程信息</span><br><span class="line">unpause   Unpause a paused container                    # 取消暂停容器</span><br><span class="line">version   Show the docker version information           # 查看 docker 版本号</span><br><span class="line">wait      Block until a container stops, then print its exit code   # 截取容器停止时的退出状态值</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;docker&lt;/p&gt;
    
    </summary>
    
    
      <category term="linux" scheme="https://kayleh.top/categories/linux/"/>
    
    
      <category term="docker" scheme="https://kayleh.top/tags/docker/"/>
    
  </entry>
  
  <entry>
    <title>SnowFlake分布式ID雪花算法</title>
    <link href="https://kayleh.top/snowflake-distributed-id-algorithm/"/>
    <id>https://kayleh.top/snowflake-distributed-id-algorithm/</id>
    <published>2020-08-28T08:20:50.000Z</published>
    <updated>2020-09-20T05:18:37.302Z</updated>
    
    <summary type="html">
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>Seata处理分布式事务</title>
    <link href="https://kayleh.top/seata-handles-distributed-transactions/"/>
    <id>https://kayleh.top/seata-handles-distributed-transactions/</id>
    <published>2020-08-26T04:25:48.000Z</published>
    <updated>2020-09-25T14:31:29.741Z</updated>
    
    <content type="html"><![CDATA[<p>Seata</p><a id="more"></a><h1 id="分布式事务问题"><a href="#分布式事务问题" class="headerlink" title="分布式事务问题"></a>分布式事务问题</h1><p>分布式前</p><ul><li><p>单机单库没这个问题</p></li><li><p>从1：1 -&gt; 1:N -&gt; N: N</p></li></ul><p>分布式之后</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/Seata处理分布式事务/1.png" alt="1598416105757"></p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/Seata处理分布式事务/2.png" alt="1598416133712"></p><blockquote><p>一次业务操作需要跨多个数据源或需要跨多个系统进行远程调用，就会产生分布式事务问题</p></blockquote><h1 id="Seata简介"><a href="#Seata简介" class="headerlink" title="Seata简介"></a>Seata简介</h1><h3 id="是什么"><a href="#是什么" class="headerlink" title="是什么"></a>是什么</h3><blockquote><p>Seata是一款开源的分布式事务解决方案，致力于在微服务架构下提供高性能和简单易用的分布式事务服务</p><p><a href="http://seata.io/zh-cn/" target="_blank" rel="noopener">http://seata.io/zh-cn/</a></p></blockquote><h3 id="能干嘛"><a href="#能干嘛" class="headerlink" title="能干嘛"></a>能干嘛</h3><h4 id="一个典型的分布式事务过程"><a href="#一个典型的分布式事务过程" class="headerlink" title="一个典型的分布式事务过程"></a>一个典型的分布式事务过程</h4><p>分布式事务处理过程的-ID+三组件模型</p><blockquote><p>Transaction ID XID   全局唯一的事务ID</p></blockquote><p>3组件概念</p><blockquote><p>Transaction Coordinator(TC) </p><p>事务协调器，维护全局事务的运行状态，负责协调并驱动全局事务的提交或回滚;</p><p>Transaction  Manager(TM) </p><p>控制全局事务的边界，负责开启一个全局事务，并最终发起全局提交或全局回滚的决议;</p><p>Resource Manager(RM) </p><p>控制分支事务，负责分支注册，状态汇报，并接收事务协调器的指令，驱动分支（本地）事务的提交和回滚；</p></blockquote><h5 id="处理过程"><a href="#处理过程" class="headerlink" title="处理过程"></a>处理过程</h5><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/Seata处理分布式事务/3.png" alt="1598416360363"></p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/Seata处理分布式事务/4.png" alt="1598416368793"></p><p>下载</p><blockquote><p>发布说明:<a href="https://github.com/seata/seata/releases" target="_blank" rel="noopener">https://github.com/seata/seata/releases</a></p></blockquote><h3 id="怎么用"><a href="#怎么用" class="headerlink" title="怎么用"></a>怎么用</h3><ul><li><p>Spring 本地@Transactional</p></li><li><p>全局@GlobalTransactional</p><blockquote><p>SEATA的分布式交易解决方案</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/Seata处理分布式事务/5.png" alt="1598416447489"></p></blockquote></li></ul><h1 id="Seata-Server安装"><a href="#Seata-Server安装" class="headerlink" title="Seata-Server安装"></a>Seata-Server安装</h1><ol><li><p><a href="http://seata.io/zh-cn/" target="_blank" rel="noopener">http://seata.io/zh-cn/</a></p></li><li><p>下载版本</p></li><li><p>seata-server-0.9.0.zip解压到指定目录并修改conf目录下的file.conf配置文件</p><ul><li><p>先备份原始file.conf文件</p></li><li><p>主要修改：自定义事务组名称+事务日志存储模式为db+数据库连接信息</p></li><li><p>file.conf</p><blockquote><p>service模块</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vgroup_mapping.my_test_tx_group &#x3D; &quot;fsp_tx_group&quot;</span><br></pre></td></tr></table></figure><p>store模块</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">mode &#x3D; &quot;db&quot;</span><br><span class="line"> </span><br><span class="line">  url &#x3D; &quot;jdbc:mysql:&#x2F;&#x2F;127.0.0.1:3306&#x2F;seata&quot;</span><br><span class="line">  user &#x3D; &quot;root&quot;</span><br><span class="line">  password &#x3D; &quot;你自己的密码&quot;</span><br><span class="line"></span><br></pre></td></tr></table></figure></blockquote></li></ul></li><li><p>mysql5.7数据库新建库seata</p></li><li><p>在seata库里建表</p><ul><li><p>建表db_store.sql在\seata-server-0.9.0\seata\conf目录里面(1.0版本在readme.md里面)</p><blockquote><p>db_store.sql</p></blockquote></li><li><p>SQL</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- the table to store GlobalSession data</span></span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> <span class="keyword">if</span> <span class="keyword">exists</span> <span class="string">`global_table`</span>;</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> <span class="string">`global_table`</span> (</span><br><span class="line">  <span class="string">`xid`</span> <span class="built_in">varchar</span>(<span class="number">128</span>)  <span class="keyword">not</span> <span class="literal">null</span>,</span><br><span class="line">  <span class="string">`transaction_id`</span> <span class="built_in">bigint</span>,</span><br><span class="line">  <span class="string">`status`</span> <span class="built_in">tinyint</span> <span class="keyword">not</span> <span class="literal">null</span>,</span><br><span class="line">  <span class="string">`application_id`</span> <span class="built_in">varchar</span>(<span class="number">32</span>),</span><br><span class="line">  <span class="string">`transaction_service_group`</span> <span class="built_in">varchar</span>(<span class="number">32</span>),</span><br><span class="line">  <span class="string">`transaction_name`</span> <span class="built_in">varchar</span>(<span class="number">128</span>),</span><br><span class="line">  <span class="string">`timeout`</span> <span class="built_in">int</span>,</span><br><span class="line">  <span class="string">`begin_time`</span> <span class="built_in">bigint</span>,</span><br><span class="line">  <span class="string">`application_data`</span> <span class="built_in">varchar</span>(<span class="number">2000</span>),</span><br><span class="line">  <span class="string">`gmt_create`</span> datetime,</span><br><span class="line">  <span class="string">`gmt_modified`</span> datetime,</span><br><span class="line">  primary <span class="keyword">key</span> (<span class="string">`xid`</span>),</span><br><span class="line">  <span class="keyword">key</span> <span class="string">`idx_gmt_modified_status`</span> (<span class="string">`gmt_modified`</span>, <span class="string">`status`</span>),</span><br><span class="line">  <span class="keyword">key</span> <span class="string">`idx_transaction_id`</span> (<span class="string">`transaction_id`</span>)</span><br><span class="line">);</span><br><span class="line"> </span><br><span class="line"><span class="comment">-- the table to store BranchSession data</span></span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> <span class="keyword">if</span> <span class="keyword">exists</span> <span class="string">`branch_table`</span>;</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> <span class="string">`branch_table`</span> (</span><br><span class="line">  <span class="string">`branch_id`</span> <span class="built_in">bigint</span> <span class="keyword">not</span> <span class="literal">null</span>,</span><br><span class="line">  <span class="string">`xid`</span> <span class="built_in">varchar</span>(<span class="number">128</span>) <span class="keyword">not</span> <span class="literal">null</span>,</span><br><span class="line">  <span class="string">`transaction_id`</span> <span class="built_in">bigint</span> ,</span><br><span class="line">  <span class="string">`resource_group_id`</span> <span class="built_in">varchar</span>(<span class="number">32</span>),</span><br><span class="line">  <span class="string">`resource_id`</span> <span class="built_in">varchar</span>(<span class="number">256</span>) ,</span><br><span class="line">  <span class="string">`lock_key`</span> <span class="built_in">varchar</span>(<span class="number">128</span>) ,</span><br><span class="line">  <span class="string">`branch_type`</span> <span class="built_in">varchar</span>(<span class="number">8</span>) ,</span><br><span class="line">  <span class="string">`status`</span> <span class="built_in">tinyint</span>,</span><br><span class="line">  <span class="string">`client_id`</span> <span class="built_in">varchar</span>(<span class="number">64</span>),</span><br><span class="line">  <span class="string">`application_data`</span> <span class="built_in">varchar</span>(<span class="number">2000</span>),</span><br><span class="line">  <span class="string">`gmt_create`</span> datetime,</span><br><span class="line">  <span class="string">`gmt_modified`</span> datetime,</span><br><span class="line">  primary <span class="keyword">key</span> (<span class="string">`branch_id`</span>),</span><br><span class="line">  <span class="keyword">key</span> <span class="string">`idx_xid`</span> (<span class="string">`xid`</span>)</span><br><span class="line">);</span><br><span class="line"> </span><br><span class="line"><span class="comment">-- the table to store lock data</span></span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> <span class="keyword">if</span> <span class="keyword">exists</span> <span class="string">`lock_table`</span>;</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> <span class="string">`lock_table`</span> (</span><br><span class="line">  <span class="string">`row_key`</span> <span class="built_in">varchar</span>(<span class="number">128</span>) <span class="keyword">not</span> <span class="literal">null</span>,</span><br><span class="line">  <span class="string">`xid`</span> <span class="built_in">varchar</span>(<span class="number">96</span>),</span><br><span class="line">  <span class="string">`transaction_id`</span> <span class="keyword">long</span> ,</span><br><span class="line">  <span class="string">`branch_id`</span> <span class="keyword">long</span>,</span><br><span class="line">  <span class="string">`resource_id`</span> <span class="built_in">varchar</span>(<span class="number">256</span>) ,</span><br><span class="line">  <span class="string">`table_name`</span> <span class="built_in">varchar</span>(<span class="number">32</span>) ,</span><br><span class="line">  <span class="string">`pk`</span> <span class="built_in">varchar</span>(<span class="number">36</span>) ,</span><br><span class="line">  <span class="string">`gmt_create`</span> datetime ,</span><br><span class="line">  <span class="string">`gmt_modified`</span> datetime,</span><br><span class="line">  primary <span class="keyword">key</span>(<span class="string">`row_key`</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure></li></ul></li><li><p>修改seata-server-0.9.0\seata\conf目录下的registry.conf配置文件</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">registry &#123;</span><br><span class="line">  # file 、nacos 、eureka、redis、zk、consul、etcd3、sofa</span><br><span class="line">  type &#x3D; &quot;nacos&quot;</span><br><span class="line"> </span><br><span class="line">  nacos &#123;</span><br><span class="line">    serverAddr &#x3D; &quot;localhost:8848&quot;</span><br><span class="line">    namespace &#x3D; &quot;&quot;</span><br><span class="line">    cluster &#x3D; &quot;default&quot;</span><br><span class="line">  &#125;</span><br><span class="line">目的是：指明注册中心为nacos，及修改nacos连接信息</span><br></pre></td></tr></table></figure></li><li><p>先启动Nacos端口号8848</p></li><li><p>再启动seata-server</p><ul><li><p>softs\seata-server-0.9.0\seata\bin</p><blockquote><p>seata-server.bat</p></blockquote></li></ul></li></ol><h1 id="订单-库存-账户业务数据库准备"><a href="#订单-库存-账户业务数据库准备" class="headerlink" title="订单/库存/账户业务数据库准备"></a>订单/库存/账户业务数据库准备</h1><h3 id="以下演示都需要先启动Nacos后启动Seata，保证两个都OK"><a href="#以下演示都需要先启动Nacos后启动Seata，保证两个都OK" class="headerlink" title="以下演示都需要先启动Nacos后启动Seata，保证两个都OK"></a>以下演示都需要先启动Nacos后启动Seata，保证两个都OK</h3><blockquote><p>Seata没启动报错no available server to connect</p></blockquote><h3 id="分布式事务业务说明"><a href="#分布式事务业务说明" class="headerlink" title="分布式事务业务说明"></a>分布式事务业务说明</h3><p>业务说明</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/Seata处理分布式事务/6.png" alt="1598416862715"></p><p>下订单—&gt;扣库存—&gt;减账户（余额）</p><h3 id="创建业务数据库"><a href="#创建业务数据库" class="headerlink" title="创建业务数据库"></a>创建业务数据库</h3><h4 id="seata-order-存储订单的数据库"><a href="#seata-order-存储订单的数据库" class="headerlink" title="seata_order: 存储订单的数据库"></a>seata_order: 存储订单的数据库</h4><h4 id="seata-storage-存储库存的数据库"><a href="#seata-storage-存储库存的数据库" class="headerlink" title="seata_storage:存储库存的数据库"></a>seata_storage:存储库存的数据库</h4><h4 id="seata-account-存储账户信息的数据库"><a href="#seata-account-存储账户信息的数据库" class="headerlink" title="seata_account: 存储账户信息的数据库"></a>seata_account: 存储账户信息的数据库</h4><h4 id="建表SQL"><a href="#建表SQL" class="headerlink" title="建表SQL"></a>建表SQL</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">DATABASE</span> seata_order；</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">DATABASE</span> seata_storage；</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">DATABASE</span> seata_account；</span><br></pre></td></tr></table></figure><h3 id="按照上述3库分别建对应业务表"><a href="#按照上述3库分别建对应业务表" class="headerlink" title="按照上述3库分别建对应业务表"></a>按照上述3库分别建对应业务表</h3><p>seata_order库下建t_order表</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> t_order(</span><br><span class="line">    <span class="string">`id`</span> <span class="built_in">BIGINT</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> AUTO_INCREMENT PRIMARY <span class="keyword">KEY</span>,</span><br><span class="line">    <span class="string">`user_id`</span> <span class="built_in">BIGINT</span>(<span class="number">11</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'用户id'</span>,</span><br><span class="line">    <span class="string">`product_id`</span> <span class="built_in">BIGINT</span>(<span class="number">11</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'产品id'</span>,</span><br><span class="line">    <span class="string">`count`</span> <span class="built_in">INT</span>(<span class="number">11</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'数量'</span>,</span><br><span class="line">    <span class="string">`money`</span> <span class="built_in">DECIMAL</span>(<span class="number">11</span>,<span class="number">0</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'金额'</span>,</span><br><span class="line">    <span class="string">`status`</span> <span class="built_in">INT</span>(<span class="number">1</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'订单状态：0：创建中; 1：已完结'</span></span><br><span class="line">) <span class="keyword">ENGINE</span>=<span class="keyword">INNODB</span> AUTO_INCREMENT=<span class="number">7</span> <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=utf8;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> t_order;</span><br></pre></td></tr></table></figure><p>seata_storage库下建t_storage表</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> t_storage(</span><br><span class="line">    <span class="string">`id`</span> <span class="built_in">BIGINT</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> AUTO_INCREMENT PRIMARY <span class="keyword">KEY</span>,</span><br><span class="line">    <span class="string">`product_id`</span> <span class="built_in">BIGINT</span>(<span class="number">11</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'产品id'</span>,</span><br><span class="line">   <span class="string">`'total`</span> <span class="built_in">INT</span>(<span class="number">11</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'总库存'</span>,</span><br><span class="line">    <span class="string">`used`</span> <span class="built_in">INT</span>(<span class="number">11</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'已用库存'</span>,</span><br><span class="line">    <span class="string">`residue`</span> <span class="built_in">INT</span>(<span class="number">11</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'剩余库存'</span></span><br><span class="line">) <span class="keyword">ENGINE</span>=<span class="keyword">INNODB</span> AUTO_INCREMENT=<span class="number">2</span> <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=utf8;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> seata_storage.t_storage(<span class="string">`id`</span>,<span class="string">`product_id`</span>,<span class="string">`total`</span>,<span class="string">`used`</span>,<span class="string">`residue`</span>)</span><br><span class="line"><span class="keyword">VALUES</span>(<span class="string">'1'</span>,<span class="string">'1'</span>,<span class="string">'100'</span>,<span class="string">'0'</span>,<span class="string">'100'</span>);</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> t_storage;</span><br></pre></td></tr></table></figure><p>seata_account库下建t_account表</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> t_account(</span><br><span class="line">    <span class="string">`id`</span> <span class="built_in">BIGINT</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> AUTO_INCREMENT PRIMARY <span class="keyword">KEY</span> <span class="keyword">COMMENT</span> <span class="string">'id'</span>,</span><br><span class="line">    <span class="string">`user_id`</span> <span class="built_in">BIGINT</span>(<span class="number">11</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'用户id'</span>,</span><br><span class="line">    <span class="string">`total`</span> <span class="built_in">DECIMAL</span>(<span class="number">10</span>,<span class="number">0</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'总额度'</span>,</span><br><span class="line">    <span class="string">`used`</span> <span class="built_in">DECIMAL</span>(<span class="number">10</span>,<span class="number">0</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'已用余额'</span>,</span><br><span class="line">    <span class="string">`residue`</span> <span class="built_in">DECIMAL</span>(<span class="number">10</span>,<span class="number">0</span>) <span class="keyword">DEFAULT</span> <span class="string">'0'</span> <span class="keyword">COMMENT</span> <span class="string">'剩余可用额度'</span></span><br><span class="line">) <span class="keyword">ENGINE</span>=<span class="keyword">INNODB</span> AUTO_INCREMENT=<span class="number">2</span> <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=utf8;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> seata_account.t_account(<span class="string">`id`</span>,<span class="string">`user_id`</span>,<span class="string">`total`</span>,<span class="string">`used`</span>,<span class="string">`residue`</span>) <span class="keyword">VALUES</span>(<span class="string">'1'</span>,<span class="string">'1'</span>,<span class="string">'1000'</span>,<span class="string">'0'</span>,<span class="string">'1000'</span>)</span><br><span class="line"> </span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> t_account;</span><br></pre></td></tr></table></figure><h3 id="按照上述3库分别建对应的回滚日志表"><a href="#按照上述3库分别建对应的回滚日志表" class="headerlink" title="按照上述3库分别建对应的回滚日志表"></a>按照上述3库分别建对应的回滚日志表</h3><p>订单-库存-账户3个库下都需要建各自的回滚日志表</p><p>\seata-server-0.9.0\seata\conf目录下的db_undo_log.sql </p><p>建表SQL</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> <span class="string">`undo_log`</span>;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`undo_log`</span> (</span><br><span class="line">  <span class="string">`id`</span> <span class="built_in">bigint</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  <span class="string">`branch_id`</span> <span class="built_in">bigint</span>(<span class="number">20</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">  <span class="string">`xid`</span> <span class="built_in">varchar</span>(<span class="number">100</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">  <span class="string">`context`</span> <span class="built_in">varchar</span>(<span class="number">128</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">  <span class="string">`rollback_info`</span> longblob <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">  <span class="string">`log_status`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">  <span class="string">`log_created`</span> datetime <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">  <span class="string">`log_modified`</span> datetime <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">  <span class="string">`ext`</span> <span class="built_in">varchar</span>(<span class="number">100</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</span><br><span class="line">  PRIMARY <span class="keyword">KEY</span> (<span class="string">`id`</span>),</span><br><span class="line">  <span class="keyword">UNIQUE</span> <span class="keyword">KEY</span> <span class="string">`ux_undo_log`</span> (<span class="string">`xid`</span>,<span class="string">`branch_id`</span>)</span><br><span class="line">) <span class="keyword">ENGINE</span>=<span class="keyword">InnoDB</span> AUTO_INCREMENT=<span class="number">1</span> <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=utf8;</span><br></pre></td></tr></table></figure><h3 id="最终效果"><a href="#最终效果" class="headerlink" title="最终效果"></a>最终效果</h3><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/Seata处理分布式事务/7.png" alt="1598417026767"></p><h1 id="订单-库存-账户业务微服务准备"><a href="#订单-库存-账户业务微服务准备" class="headerlink" title="订单/库存/账户业务微服务准备"></a>订单/库存/账户业务微服务准备</h1><blockquote><h3 id="业务需求"><a href="#业务需求" class="headerlink" title="业务需求"></a>业务需求</h3><p>下订单-&gt;减库存-&gt;扣余额-&gt;改（订单）状态</p></blockquote><h2 id="新建订单Order-Module"><a href="#新建订单Order-Module" class="headerlink" title="新建订单Order-Module"></a>新建订单Order-Module</h2><ol><li><p>seata-order-service2001</p></li><li><p>POM</p></li></ol><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"> <span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--nacos--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-alibaba-nacos-discovery<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--seata--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-alibaba-seata<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">exclusions</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>seata-all<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.seata<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.seata<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>seata-all<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.9.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--feign--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-openfeign<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--web-actuator--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-actuator<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--mysql-druid--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.1.37<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>druid-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.1.10<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis.spring.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.0.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><p>3.YML</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">2001</span></span><br><span class="line"> </span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">seata-order-service</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">alibaba:</span></span><br><span class="line">      <span class="attr">seata:</span></span><br><span class="line">        <span class="comment">#自定义事务组名称需要与seata-server中的对应</span></span><br><span class="line">        <span class="attr">tx-service-group:</span> <span class="string">fsp_tx_group</span></span><br><span class="line">    <span class="attr">nacos:</span></span><br><span class="line">      <span class="attr">discovery:</span></span><br><span class="line">        <span class="attr">server-addr:</span> <span class="string">localhost:8848</span></span><br><span class="line">  <span class="attr">datasource:</span></span><br><span class="line">    <span class="attr">driver-class-name:</span> <span class="string">com.mysql.jdbc.Driver</span></span><br><span class="line">    <span class="attr">url:</span> <span class="string">jdbc:mysql://localhost:3306/seata_order</span></span><br><span class="line">    <span class="attr">username:</span> <span class="string">root</span></span><br><span class="line">    <span class="attr">password:</span> <span class="number">1111111</span></span><br><span class="line"> </span><br><span class="line"><span class="attr">feign:</span></span><br><span class="line">  <span class="attr">hystrix:</span></span><br><span class="line">    <span class="attr">enabled:</span> <span class="literal">false</span></span><br><span class="line"> </span><br><span class="line"><span class="attr">logging:</span></span><br><span class="line">  <span class="attr">level:</span></span><br><span class="line">    <span class="attr">io:</span></span><br><span class="line">      <span class="attr">seata:</span> <span class="string">info</span></span><br><span class="line"> </span><br><span class="line"><span class="attr">mybatis:</span></span><br><span class="line">  <span class="attr">mapperLocations:</span> <span class="string">classpath:mapper/*.xml</span></span><br></pre></td></tr></table></figure><p>4.file.conf</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">transport</span> <span class="string">&#123;</span></span><br><span class="line"><span class="comment">  # tcp udt unix-domain-socket</span></span><br><span class="line">  <span class="attr">type</span> = <span class="string">"TCP"</span></span><br><span class="line"><span class="comment">  #NIO NATIVE</span></span><br><span class="line">  <span class="attr">server</span> = <span class="string">"NIO"</span></span><br><span class="line"><span class="comment">  #enable heartbeat</span></span><br><span class="line">  <span class="attr">heartbeat</span> = <span class="string">true</span></span><br><span class="line"><span class="comment">  #thread factory for netty</span></span><br><span class="line">  <span class="meta">thread-factory</span> <span class="string">&#123;</span></span><br><span class="line">    <span class="meta">boss-thread-prefix</span> = <span class="string">"NettyBoss"</span></span><br><span class="line">    <span class="meta">worker-thread-prefix</span> = <span class="string">"NettyServerNIOWorker"</span></span><br><span class="line">    <span class="meta">server-executor-thread-prefix</span> = <span class="string">"NettyServerBizHandler"</span></span><br><span class="line">    <span class="meta">share-boss-worker</span> = <span class="string">false</span></span><br><span class="line">    <span class="meta">client-selector-thread-prefix</span> = <span class="string">"NettyClientSelector"</span></span><br><span class="line">    <span class="meta">client-selector-thread-size</span> = <span class="string">1</span></span><br><span class="line">    <span class="meta">client-worker-thread-prefix</span> = <span class="string">"NettyClientWorkerThread"</span></span><br><span class="line"><span class="comment">    # netty boss thread size,will not be used for UDT</span></span><br><span class="line">    <span class="meta">boss-thread-size</span> = <span class="string">1</span></span><br><span class="line"><span class="comment">    #auto default pin or 8</span></span><br><span class="line">    <span class="meta">worker-thread-size</span> = <span class="string">8</span></span><br><span class="line">  <span class="attr">&#125;</span></span><br><span class="line">  <span class="attr">shutdown</span> <span class="string">&#123;</span></span><br><span class="line"><span class="comment">    # when destroy server, wait seconds</span></span><br><span class="line">    <span class="attr">wait</span> = <span class="string">3</span></span><br><span class="line">  <span class="attr">&#125;</span></span><br><span class="line">  <span class="attr">serialization</span> = <span class="string">"seata"</span></span><br><span class="line">  <span class="attr">compressor</span> = <span class="string">"none"</span></span><br><span class="line"><span class="attr">&#125;</span></span><br><span class="line"> </span><br><span class="line"><span class="attr">service</span> <span class="string">&#123;</span></span><br><span class="line"> </span><br><span class="line">  <span class="meta">vgroup_mapping.fsp_tx_group</span> = <span class="string">"default" </span></span><br><span class="line"> </span><br><span class="line">  <span class="meta">default.grouplist</span> = <span class="string">"127.0.0.1:8091"</span></span><br><span class="line">  <span class="attr">enableDegrade</span> = <span class="string">false</span></span><br><span class="line">  <span class="attr">disable</span> = <span class="string">false</span></span><br><span class="line">  <span class="meta">max.commit.retry.timeout</span> = <span class="string">"-1"</span></span><br><span class="line">  <span class="meta">max.rollback.retry.timeout</span> = <span class="string">"-1"</span></span><br><span class="line">  <span class="attr">disableGlobalTransaction</span> = <span class="string">false</span></span><br><span class="line"><span class="attr">&#125;</span></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="attr">client</span> <span class="string">&#123;</span></span><br><span class="line">  <span class="meta">async.commit.buffer.limit</span> = <span class="string">10000</span></span><br><span class="line">  <span class="attr">lock</span> <span class="string">&#123;</span></span><br><span class="line">    <span class="meta">retry.internal</span> = <span class="string">10</span></span><br><span class="line">    <span class="meta">retry.times</span> = <span class="string">30</span></span><br><span class="line">  <span class="attr">&#125;</span></span><br><span class="line">  <span class="meta">report.retry.count</span> = <span class="string">5</span></span><br><span class="line">  <span class="meta">tm.commit.retry.count</span> = <span class="string">1</span></span><br><span class="line">  <span class="meta">tm.rollback.retry.count</span> = <span class="string">1</span></span><br><span class="line"><span class="attr">&#125;</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">## transaction log store</span></span><br><span class="line"><span class="attr">store</span> <span class="string">&#123;</span></span><br><span class="line"><span class="comment">  ## store mode: file、db</span></span><br><span class="line">  <span class="attr">mode</span> = <span class="string">"db"</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">  ## file store</span></span><br><span class="line">  <span class="attr">file</span> <span class="string">&#123;</span></span><br><span class="line">    <span class="attr">dir</span> = <span class="string">"sessionStore"</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">    # branch session size , if exceeded first try compress lockkey, still exceeded throws exceptions</span></span><br><span class="line">    <span class="meta">max-branch-session-size</span> = <span class="string">16384</span></span><br><span class="line"><span class="comment">    # globe session size , if exceeded throws exceptions</span></span><br><span class="line">    <span class="meta">max-global-session-size</span> = <span class="string">512</span></span><br><span class="line"><span class="comment">    # file buffer size , if exceeded allocate new buffer</span></span><br><span class="line">    <span class="meta">file-write-buffer-cache-size</span> = <span class="string">16384</span></span><br><span class="line"><span class="comment">    # when recover batch read size</span></span><br><span class="line">    <span class="meta">session.reload.read_size</span> = <span class="string">100</span></span><br><span class="line"><span class="comment">    # async, sync</span></span><br><span class="line">    <span class="meta">flush-disk-mode</span> = <span class="string">async</span></span><br><span class="line">  <span class="attr">&#125;</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">  ## database store</span></span><br><span class="line">  <span class="attr">db</span> <span class="string">&#123;</span></span><br><span class="line"><span class="comment">    ## the implement of javax.sql.DataSource, such as DruidDataSource(druid)/BasicDataSource(dbcp) etc.</span></span><br><span class="line">    <span class="attr">datasource</span> = <span class="string">"dbcp"</span></span><br><span class="line"><span class="comment">    ## mysql/oracle/h2/oceanbase etc.</span></span><br><span class="line">    <span class="meta">db-type</span> = <span class="string">"mysql"</span></span><br><span class="line">    <span class="meta">driver-class-name</span> = <span class="string">"com.mysql.jdbc.Driver"</span></span><br><span class="line">    <span class="attr">url</span> = <span class="string">"jdbc:mysql://127.0.0.1:3306/seata"</span></span><br><span class="line">    <span class="attr">user</span> = <span class="string">"root"</span></span><br><span class="line">    <span class="attr">password</span> = <span class="string">"123456"</span></span><br><span class="line">    <span class="meta">min-conn</span> = <span class="string">1</span></span><br><span class="line">    <span class="meta">max-conn</span> = <span class="string">3</span></span><br><span class="line">    <span class="meta">global.table</span> = <span class="string">"global_table"</span></span><br><span class="line">    <span class="meta">branch.table</span> = <span class="string">"branch_table"</span></span><br><span class="line">    <span class="meta">lock-table</span> = <span class="string">"lock_table"</span></span><br><span class="line">    <span class="meta">query-limit</span> = <span class="string">100</span></span><br><span class="line">  <span class="attr">&#125;</span></span><br><span class="line"><span class="attr">&#125;</span></span><br><span class="line"><span class="attr">lock</span> <span class="string">&#123;</span></span><br><span class="line"><span class="comment">  ## the lock store mode: local、remote</span></span><br><span class="line">  <span class="attr">mode</span> = <span class="string">"remote"</span></span><br><span class="line"> </span><br><span class="line">  <span class="attr">local</span> <span class="string">&#123;</span></span><br><span class="line"><span class="comment">    ## store locks in user's database</span></span><br><span class="line">  <span class="attr">&#125;</span></span><br><span class="line"> </span><br><span class="line">  <span class="attr">remote</span> <span class="string">&#123;</span></span><br><span class="line"><span class="comment">    ## store locks in the seata's server</span></span><br><span class="line">  <span class="attr">&#125;</span></span><br><span class="line"><span class="attr">&#125;</span></span><br><span class="line"><span class="attr">recovery</span> <span class="string">&#123;</span></span><br><span class="line"><span class="comment">  #schedule committing retry period in milliseconds</span></span><br><span class="line">  <span class="meta">committing-retry-period</span> = <span class="string">1000</span></span><br><span class="line"><span class="comment">  #schedule asyn committing retry period in milliseconds</span></span><br><span class="line">  <span class="meta">asyn-committing-retry-period</span> = <span class="string">1000</span></span><br><span class="line"><span class="comment">  #schedule rollbacking retry period in milliseconds</span></span><br><span class="line">  <span class="meta">rollbacking-retry-period</span> = <span class="string">1000</span></span><br><span class="line"><span class="comment">  #schedule timeout retry period in milliseconds</span></span><br><span class="line">  <span class="meta">timeout-retry-period</span> = <span class="string">1000</span></span><br><span class="line"><span class="attr">&#125;</span></span><br><span class="line"> </span><br><span class="line"><span class="attr">transaction</span> <span class="string">&#123;</span></span><br><span class="line">  <span class="meta">undo.data.validation</span> = <span class="string">true</span></span><br><span class="line">  <span class="meta">undo.log.serialization</span> = <span class="string">"jackson"</span></span><br><span class="line">  <span class="meta">undo.log.save.days</span> = <span class="string">7</span></span><br><span class="line"><span class="comment">  #schedule delete expired undo_log in milliseconds</span></span><br><span class="line">  <span class="meta">undo.log.delete.period</span> = <span class="string">86400000</span></span><br><span class="line">  <span class="meta">undo.log.table</span> = <span class="string">"undo_log"</span></span><br><span class="line"><span class="attr">&#125;</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">## metrics settings</span></span><br><span class="line"><span class="attr">metrics</span> <span class="string">&#123;</span></span><br><span class="line">  <span class="attr">enabled</span> = <span class="string">false</span></span><br><span class="line">  <span class="meta">registry-type</span> = <span class="string">"compact"</span></span><br><span class="line"><span class="comment">  # multi exporters use comma divided</span></span><br><span class="line">  <span class="meta">exporter-list</span> = <span class="string">"prometheus"</span></span><br><span class="line">  <span class="meta">exporter-prometheus-port</span> = <span class="string">9898</span></span><br><span class="line"><span class="attr">&#125;</span></span><br><span class="line"> </span><br><span class="line"><span class="attr">support</span> <span class="string">&#123;</span></span><br><span class="line"><span class="comment">  ## spring</span></span><br><span class="line">  <span class="attr">spring</span> <span class="string">&#123;</span></span><br><span class="line"><span class="comment">    # auto proxy the DataSource bean</span></span><br><span class="line">    <span class="meta">datasource.autoproxy</span> = <span class="string">false</span></span><br><span class="line">  <span class="attr">&#125;</span></span><br><span class="line"><span class="attr">&#125;</span></span><br></pre></td></tr></table></figure><p>5.registry.conf</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">registry</span> <span class="string">&#123;</span></span><br><span class="line"><span class="comment">  # file 、nacos 、eureka、redis、zk、consul、etcd3、sofa</span></span><br><span class="line">  <span class="attr">type</span> = <span class="string">"nacos"</span></span><br><span class="line"> </span><br><span class="line">  <span class="attr">nacos</span> <span class="string">&#123;</span></span><br><span class="line">    <span class="attr">serverAddr</span> = <span class="string">"localhost:8848"</span></span><br><span class="line">    <span class="attr">namespace</span> = <span class="string">""</span></span><br><span class="line">    <span class="attr">cluster</span> = <span class="string">"default"</span></span><br><span class="line">  <span class="attr">&#125;</span></span><br><span class="line">  <span class="attr">eureka</span> <span class="string">&#123;</span></span><br><span class="line">    <span class="attr">serviceUrl</span> = <span class="string">"http://localhost:8761/eureka"</span></span><br><span class="line">    <span class="attr">application</span> = <span class="string">"default"</span></span><br><span class="line">    <span class="attr">weight</span> = <span class="string">"1"</span></span><br><span class="line">  <span class="attr">&#125;</span></span><br><span class="line">  <span class="attr">redis</span> <span class="string">&#123;</span></span><br><span class="line">    <span class="attr">serverAddr</span> = <span class="string">"localhost:6379"</span></span><br><span class="line">    <span class="attr">db</span> = <span class="string">"0"</span></span><br><span class="line">  <span class="attr">&#125;</span></span><br><span class="line">  <span class="attr">zk</span> <span class="string">&#123;</span></span><br><span class="line">    <span class="attr">cluster</span> = <span class="string">"default"</span></span><br><span class="line">    <span class="attr">serverAddr</span> = <span class="string">"127.0.0.1:2181"</span></span><br><span class="line">    <span class="meta">session.timeout</span> = <span class="string">6000</span></span><br><span class="line">    <span class="meta">connect.timeout</span> = <span class="string">2000</span></span><br><span class="line">  <span class="attr">&#125;</span></span><br><span class="line">  <span class="attr">consul</span> <span class="string">&#123;</span></span><br><span class="line">    <span class="attr">cluster</span> = <span class="string">"default"</span></span><br><span class="line">    <span class="attr">serverAddr</span> = <span class="string">"127.0.0.1:8500"</span></span><br><span class="line">  <span class="attr">&#125;</span></span><br><span class="line">  <span class="attr">etcd3</span> <span class="string">&#123;</span></span><br><span class="line">    <span class="attr">cluster</span> = <span class="string">"default"</span></span><br><span class="line">    <span class="attr">serverAddr</span> = <span class="string">"http://localhost:2379"</span></span><br><span class="line">  <span class="attr">&#125;</span></span><br><span class="line">  <span class="attr">sofa</span> <span class="string">&#123;</span></span><br><span class="line">    <span class="attr">serverAddr</span> = <span class="string">"127.0.0.1:9603"</span></span><br><span class="line">    <span class="attr">application</span> = <span class="string">"default"</span></span><br><span class="line">    <span class="attr">region</span> = <span class="string">"DEFAULT_ZONE"</span></span><br><span class="line">    <span class="attr">datacenter</span> = <span class="string">"DefaultDataCenter"</span></span><br><span class="line">    <span class="attr">cluster</span> = <span class="string">"default"</span></span><br><span class="line">    <span class="attr">group</span> = <span class="string">"SEATA_GROUP"</span></span><br><span class="line">    <span class="attr">addressWaitTime</span> = <span class="string">"3000"</span></span><br><span class="line">  <span class="attr">&#125;</span></span><br><span class="line">  <span class="attr">file</span> <span class="string">&#123;</span></span><br><span class="line">    <span class="attr">name</span> = <span class="string">"file.conf"</span></span><br><span class="line">  <span class="attr">&#125;</span></span><br><span class="line"><span class="attr">&#125;</span></span><br><span class="line"> </span><br><span class="line"><span class="attr">config</span> <span class="string">&#123;</span></span><br><span class="line"><span class="comment">  # file、nacos 、apollo、zk、consul、etcd3</span></span><br><span class="line">  <span class="attr">type</span> = <span class="string">"file"</span></span><br><span class="line"> </span><br><span class="line">  <span class="attr">nacos</span> <span class="string">&#123;</span></span><br><span class="line">    <span class="attr">serverAddr</span> = <span class="string">"localhost"</span></span><br><span class="line">    <span class="attr">namespace</span> = <span class="string">""</span></span><br><span class="line">  <span class="attr">&#125;</span></span><br><span class="line">  <span class="attr">consul</span> <span class="string">&#123;</span></span><br><span class="line">    <span class="attr">serverAddr</span> = <span class="string">"127.0.0.1:8500"</span></span><br><span class="line">  <span class="attr">&#125;</span></span><br><span class="line">  <span class="attr">apollo</span> <span class="string">&#123;</span></span><br><span class="line">    <span class="meta">app.id</span> = <span class="string">"seata-server"</span></span><br><span class="line">    <span class="meta">apollo.meta</span> = <span class="string">"http://192.168.1.204:8801"</span></span><br><span class="line">  <span class="attr">&#125;</span></span><br><span class="line">  <span class="attr">zk</span> <span class="string">&#123;</span></span><br><span class="line">    <span class="attr">serverAddr</span> = <span class="string">"127.0.0.1:2181"</span></span><br><span class="line">    <span class="meta">session.timeout</span> = <span class="string">6000</span></span><br><span class="line">    <span class="meta">connect.timeout</span> = <span class="string">2000</span></span><br><span class="line">  <span class="attr">&#125;</span></span><br><span class="line">  <span class="attr">etcd3</span> <span class="string">&#123;</span></span><br><span class="line">    <span class="attr">serverAddr</span> = <span class="string">"http://localhost:2379"</span></span><br><span class="line">  <span class="attr">&#125;</span></span><br><span class="line">  <span class="attr">file</span> <span class="string">&#123;</span></span><br><span class="line">    <span class="attr">name</span> = <span class="string">"file.conf"</span></span><br><span class="line">  <span class="attr">&#125;</span></span><br><span class="line"><span class="attr">&#125;</span></span><br></pre></td></tr></table></figure><p>6.domain</p><ul><li><p>CommonResult</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.kayleh.springcloud.alibaba.domain;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> lombok.AllArgsConstructor;</span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"><span class="keyword">import</span> lombok.NoArgsConstructor;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CommonResult</span>&lt;<span class="title">T</span>&gt;</span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Integer code;</span><br><span class="line">    <span class="keyword">private</span> String  message;</span><br><span class="line">    <span class="keyword">private</span> T       data;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">CommonResult</span><span class="params">(Integer code, String message)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>(code,message,<span class="keyword">null</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>Order</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.kayleh.springcloud.alibaba.domain;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> lombok.AllArgsConstructor;</span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"><span class="keyword">import</span> lombok.NoArgsConstructor;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.math.BigDecimal;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Order</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">private</span> Long userId;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">private</span> Long productId;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">private</span> Integer count;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">private</span> BigDecimal money;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">private</span> Integer status; <span class="comment">//订单状态：0：创建中；1：已完结</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><p>7.Dao接口及实现</p><ul><li><p>OrderDao</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.kayleh.springcloud.alibaba.dao;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.kayleh.springcloud.alibaba.domain.Order;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Mapper;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Param;</span><br><span class="line"> </span><br><span class="line"><span class="meta">@Mapper</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">OrderDao</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="comment">//新建订单</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">create</span><span class="params">(Order order)</span></span>;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">//修改订单状态，从零改为1</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(@Param(<span class="string">"userId"</span>)</span> Long userId,@<span class="title">Param</span><span class="params">(<span class="string">"status"</span>)</span> Integer status)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>resources文件夹下新建mapper文件夹后添加</p><p>OrderMapper.xml</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span> <span class="meta-keyword">PUBLIC</span> <span class="meta-string">"-//mybatis.org//DTD Mapper 3.0//EN"</span> <span class="meta-string">"http://mybatis.org/dtd/mybatis-3-mapper.dtd"</span> &gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">"com.kayleh.springcloud.alibaba.dao.OrderDao"</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">"BaseResultMap"</span> <span class="attr">type</span>=<span class="string">"com.kayleh.springcloud.alibaba.domain.Order"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">"id"</span> <span class="attr">property</span>=<span class="string">"id"</span> <span class="attr">jdbcType</span>=<span class="string">"BIGINT"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"user_id"</span> <span class="attr">property</span>=<span class="string">"userId"</span> <span class="attr">jdbcType</span>=<span class="string">"BIGINT"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"product_id"</span> <span class="attr">property</span>=<span class="string">"productId"</span> <span class="attr">jdbcType</span>=<span class="string">"BIGINT"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"count"</span> <span class="attr">property</span>=<span class="string">"count"</span> <span class="attr">jdbcType</span>=<span class="string">"INTEGER"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"money"</span> <span class="attr">property</span>=<span class="string">"money"</span> <span class="attr">jdbcType</span>=<span class="string">"DECIMAL"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"status"</span> <span class="attr">property</span>=<span class="string">"status"</span> <span class="attr">jdbcType</span>=<span class="string">"INTEGER"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">"create"</span>&gt;</span></span><br><span class="line">        insert into t_order (id,user_id,product_id,count,money,status)</span><br><span class="line">        values (null,#&#123;userId&#125;,#&#123;productId&#125;,#&#123;count&#125;,#&#123;money&#125;,0);</span><br><span class="line">    <span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">"update"</span>&gt;</span></span><br><span class="line">        update t_order set status = 1</span><br><span class="line">        where user_id=#&#123;userId&#125; and status = #&#123;status&#125;;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">update</span>&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure></li></ul><p>8.Service接口及实现</p><ul><li><p>OrderService</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.kayleh.springcloud.alibaba.service;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.kayleh.springcloud.alibaba.domain.Order;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">OrderService</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">create</span><span class="params">(Order order)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><p>OrderServiceImpl</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.kayleh.springcloud.alibaba.service.impl;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.kayleh.springcloud.alibaba.dao.OrderDao;</span><br><span class="line"><span class="keyword">import</span> com.kayleh.springcloud.alibaba.domain.Order;</span><br><span class="line"><span class="keyword">import</span> com.kayleh.springcloud.alibaba.service.AccountService;</span><br><span class="line"><span class="keyword">import</span> com.kayleh.springcloud.alibaba.service.OrderService;</span><br><span class="line"><span class="keyword">import</span> com.kayleh.springcloud.alibaba.service.StorageService;</span><br><span class="line"><span class="keyword">import</span> io.seata.spring.annotation.GlobalTransactional;</span><br><span class="line"><span class="keyword">import</span> lombok.extern.slf4j.Sl f4j;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> javax.annotation.Resource;</span><br><span class="line"> </span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="meta">@Slf</span>4j</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">OrderServiceImpl</span> <span class="keyword">implements</span> <span class="title">OrderService</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> OrderDao orderDao;</span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> StorageService storageService;</span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> AccountService accountService;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 创建订单-&gt;调用库存服务扣减库存-&gt;调用账户服务扣减账户余额-&gt;修改订单状态</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">     </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="meta">@GlobalTransactional</span>(name = <span class="string">"fsp-create-order"</span>,rollbackFor = Exception<span class="class">.<span class="keyword">class</span>)</span></span><br><span class="line"><span class="class">    <span class="title">public</span> <span class="title">void</span> <span class="title">create</span>(<span class="title">Order</span> <span class="title">order</span>)</span>&#123;</span><br><span class="line">        log.info(<span class="string">"-----&gt;开始新建订单"</span>);</span><br><span class="line">        <span class="comment">//新建订单</span></span><br><span class="line">        orderDao.create(order);</span><br><span class="line"> </span><br><span class="line">        <span class="comment">//扣减库存</span></span><br><span class="line">        log.info(<span class="string">"-----&gt;订单微服务开始调用库存，做扣减Count"</span>);</span><br><span class="line">        storageService.decrease(order.getProductId(),order.getCount());</span><br><span class="line">        log.info(<span class="string">"-----&gt;订单微服务开始调用库存，做扣减end"</span>);</span><br><span class="line"> </span><br><span class="line">        <span class="comment">//扣减账户</span></span><br><span class="line">        log.info(<span class="string">"-----&gt;订单微服务开始调用账户，做扣减Money"</span>);</span><br><span class="line">        accountService.decrease(order.getUserId(),order.getMoney());</span><br><span class="line">        log.info(<span class="string">"-----&gt;订单微服务开始调用账户，做扣减end"</span>);</span><br><span class="line"> </span><br><span class="line">         </span><br><span class="line">        <span class="comment">//修改订单状态，从零到1代表已经完成</span></span><br><span class="line">        log.info(<span class="string">"-----&gt;修改订单状态开始"</span>);</span><br><span class="line">        orderDao.update(order.getUserId(),<span class="number">0</span>);</span><br><span class="line">        log.info(<span class="string">"-----&gt;修改订单状态结束"</span>);</span><br><span class="line"> </span><br><span class="line">        log.info(<span class="string">"-----&gt;下订单结束了"</span>);</span><br><span class="line"> </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul></li><li><p>StorageService</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.kayleh.springcloud.alibaba.service;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.kayleh.springcloud.alibaba.domain.CommonResult;</span><br><span class="line"><span class="keyword">import</span> org.springframework.cloud.openfeign.FeignClient;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.PostMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestParam;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.math.BigDecimal;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="meta">@FeignClient</span>(value = <span class="string">"seata-storage-service"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">StorageService</span></span>&#123;</span><br><span class="line">    <span class="meta">@PostMapping</span>(value = <span class="string">"/storage/decrease"</span>)</span><br><span class="line">    <span class="function">CommonResult <span class="title">decrease</span><span class="params">(@RequestParam(<span class="string">"productId"</span>)</span> Long productId, @<span class="title">RequestParam</span><span class="params">(<span class="string">"count"</span>)</span> Integer count)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>AccountService</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.kayleh.springcloud.alibaba.service;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.kayleh.springcloud.alibaba.domain.CommonResult;</span><br><span class="line"><span class="keyword">import</span> org.springframework.cloud.openfeign.FeignClient;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.PostMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestParam;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.math.BigDecimal;</span><br><span class="line"> </span><br><span class="line"><span class="meta">@FeignClient</span>(value = <span class="string">"seata-account-service"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">AccountService</span></span>&#123;</span><br><span class="line">    <span class="meta">@PostMapping</span>(value = <span class="string">"/account/decrease"</span>)</span><br><span class="line">    <span class="function">CommonResult <span class="title">decrease</span><span class="params">(@RequestParam(<span class="string">"userId"</span>)</span> Long userId, @<span class="title">RequestParam</span><span class="params">(<span class="string">"money"</span>)</span> BigDecimal money)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><p>9.Controller</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.kayleh.springcloud.alibaba.controller;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.kayleh.springcloud.alibaba.domain.CommonResult;</span><br><span class="line"><span class="keyword">import</span> com.kayleh.springcloud.alibaba.domain.Order;</span><br><span class="line"><span class="keyword">import</span> com.kayleh.springcloud.alibaba.service.OrderService;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.GetMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestController;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> javax.annotation.Resource;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">OrderController</span></span>&#123;</span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> OrderService orderService;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">    <span class="meta">@GetMapping</span>(<span class="string">"/order/create"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> CommonResult <span class="title">create</span><span class="params">(Order order)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        orderService.create(order);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> CommonResult(<span class="number">200</span>,<span class="string">"订单创建成功"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>10.Config配置</p><ul><li><p>MyBatisConfig</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.kayleh.springcloud.alibaba.config;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.mybatis.spring.annotation.MapperScan;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@MapperScan</span>(&#123;<span class="string">"com.kayleh.springcloud.alibaba.dao"</span>&#125;)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyBatisConfig</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>DataSourceProxyConfig</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.kayleh.springcloud.alibaba.config;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.alibaba.druid.pool.DruidDataSource;</span><br><span class="line"><span class="keyword">import</span> io.seata.rm.datasource.DataSourceProxy;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.mybatis.spring.SqlSessionFactoryBean;</span><br><span class="line"><span class="keyword">import</span> org.mybatis.spring.transaction.SpringManagedTransactionFactory;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Value;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.context.properties.ConfigurationProperties;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.core.io.support.PathMatchingResourcePatternResolver;</span><br><span class="line"><span class="keyword">import</span> javax.sql.DataSource;</span><br><span class="line">  </span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DataSourceProxyConfig</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">    <span class="meta">@Value</span>(<span class="string">"$&#123;mybatis.mapperLocations&#125;"</span>)</span><br><span class="line">    <span class="keyword">private</span> String mapperLocations;</span><br><span class="line"> </span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="meta">@ConfigurationProperties</span>(prefix = <span class="string">"spring.datasource"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> DataSource <span class="title">druidDataSource</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> DruidDataSource();</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> DataSourceProxy <span class="title">dataSourceProxy</span><span class="params">(DataSource dataSource)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> DataSourceProxy(dataSource);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> SqlSessionFactory <span class="title">sqlSessionFactoryBean</span><span class="params">(DataSourceProxy dataSourceProxy)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        SqlSessionFactoryBean sqlSessionFactoryBean = <span class="keyword">new</span> SqlSessionFactoryBean();</span><br><span class="line">        sqlSessionFactoryBean.setDataSource(dataSourceProxy);</span><br><span class="line">        sqlSessionFactoryBean.setMapperLocations(<span class="keyword">new</span> PathMatchingResourcePatternResolver().getResources(mapperLocations));</span><br><span class="line">        sqlSessionFactoryBean.setTransactionFactory(<span class="keyword">new</span> SpringManagedTransactionFactory());</span><br><span class="line">        <span class="keyword">return</span> sqlSessionFactoryBean.getObject();</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><p>11.主启动</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.kayleh.springcloud.alibaba;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.SpringApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.autoconfigure.jdbc.DataSourceAutoConfiguration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.cloud.client.discovery.EnableDiscoveryClient;</span><br><span class="line"><span class="keyword">import</span> org.springframework.cloud.openfeign.EnableFeignClients;</span><br><span class="line"> </span><br><span class="line"><span class="meta">@EnableDiscoveryClient</span></span><br><span class="line"><span class="meta">@EnableFeignClients</span></span><br><span class="line"><span class="meta">@SpringBootApplication</span>(exclude = DataSourceAutoConfiguration<span class="class">.<span class="keyword">class</span>)//取消数据源自动创建的配置</span></span><br><span class="line"><span class="class"><span class="title">public</span> <span class="title">class</span> <span class="title">SeataOrderMainApp2001</span></span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        SpringApplication.run(SeataOrderMainApp2001<span class="class">.<span class="keyword">class</span>, <span class="title">args</span>)</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="新建库存Storage-Module"><a href="#新建库存Storage-Module" class="headerlink" title="新建库存Storage-Module"></a>新建库存Storage-Module</h2><p>1.seata-order-service2002</p><p>2.POM</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">       <span class="comment">&lt;!--nacos--&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-alibaba-nacos-discovery<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">       <span class="comment">&lt;!--seata--&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-alibaba-seata<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">exclusions</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">                   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>seata-all<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.seata<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.seata<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>seata-all<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.9.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">       <span class="comment">&lt;!--feign--&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-openfeign<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis.spring.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.0.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.1.37<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>druid-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.1.10<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><p>3.YML</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">2002</span></span><br><span class="line"> </span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">seata-storage-service</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">alibaba:</span></span><br><span class="line">      <span class="attr">seata:</span></span><br><span class="line">        <span class="attr">tx-service-group:</span> <span class="string">fsp_tx_group</span></span><br><span class="line">    <span class="attr">nacos:</span></span><br><span class="line">      <span class="attr">discovery:</span></span><br><span class="line">        <span class="attr">server-addr:</span> <span class="string">localhost:8848</span></span><br><span class="line">  <span class="attr">datasource:</span></span><br><span class="line">    <span class="attr">driver-class-name:</span> <span class="string">com.mysql.jdbc.Driver</span></span><br><span class="line">    <span class="attr">url:</span> <span class="string">jdbc:mysql://localhost:3306/seata_storage</span></span><br><span class="line">    <span class="attr">username:</span> <span class="string">root</span></span><br><span class="line">    <span class="attr">password:</span> <span class="number">111111</span></span><br><span class="line"> </span><br><span class="line"><span class="attr">logging:</span></span><br><span class="line">  <span class="attr">level:</span></span><br><span class="line">    <span class="attr">io:</span></span><br><span class="line">      <span class="attr">seata:</span> <span class="string">info</span></span><br><span class="line"> </span><br><span class="line"><span class="attr">mybatis:</span></span><br><span class="line">  <span class="attr">mapperLocations:</span> <span class="string">classpath:mapper/*.xml</span></span><br></pre></td></tr></table></figure><p>4.file.conf</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">transport</span> <span class="string">&#123;</span></span><br><span class="line"><span class="comment">  # tcp udt unix-domain-socket</span></span><br><span class="line">  <span class="attr">type</span> = <span class="string">"TCP"</span></span><br><span class="line"><span class="comment">  #NIO NATIVE</span></span><br><span class="line">  <span class="attr">server</span> = <span class="string">"NIO"</span></span><br><span class="line"><span class="comment">  #enable heartbeat</span></span><br><span class="line">  <span class="attr">heartbeat</span> = <span class="string">true</span></span><br><span class="line"><span class="comment">  #thread factory for netty</span></span><br><span class="line">  <span class="meta">thread-factory</span> <span class="string">&#123;</span></span><br><span class="line">    <span class="meta">boss-thread-prefix</span> = <span class="string">"NettyBoss"</span></span><br><span class="line">    <span class="meta">worker-thread-prefix</span> = <span class="string">"NettyServerNIOWorker"</span></span><br><span class="line">    <span class="meta">server-executor-thread-prefix</span> = <span class="string">"NettyServerBizHandler"</span></span><br><span class="line">    <span class="meta">share-boss-worker</span> = <span class="string">false</span></span><br><span class="line">    <span class="meta">client-selector-thread-prefix</span> = <span class="string">"NettyClientSelector"</span></span><br><span class="line">    <span class="meta">client-selector-thread-size</span> = <span class="string">1</span></span><br><span class="line">    <span class="meta">client-worker-thread-prefix</span> = <span class="string">"NettyClientWorkerThread"</span></span><br><span class="line"><span class="comment">    # netty boss thread size,will not be used for UDT</span></span><br><span class="line">    <span class="meta">boss-thread-size</span> = <span class="string">1</span></span><br><span class="line"><span class="comment">    #auto default pin or 8</span></span><br><span class="line">    <span class="meta">worker-thread-size</span> = <span class="string">8</span></span><br><span class="line">  <span class="attr">&#125;</span></span><br><span class="line">  <span class="attr">shutdown</span> <span class="string">&#123;</span></span><br><span class="line"><span class="comment">    # when destroy server, wait seconds</span></span><br><span class="line">    <span class="attr">wait</span> = <span class="string">3</span></span><br><span class="line">  <span class="attr">&#125;</span></span><br><span class="line">  <span class="attr">serialization</span> = <span class="string">"seata"</span></span><br><span class="line">  <span class="attr">compressor</span> = <span class="string">"none"</span></span><br><span class="line"><span class="attr">&#125;</span></span><br><span class="line"> </span><br><span class="line"><span class="attr">service</span> <span class="string">&#123;</span></span><br><span class="line"><span class="comment">  #vgroup-&gt;rgroup</span></span><br><span class="line">  <span class="meta">vgroup_mapping.fsp_tx_group</span> = <span class="string">"default"</span></span><br><span class="line"><span class="comment">  #only support single node</span></span><br><span class="line">  <span class="meta">default.grouplist</span> = <span class="string">"127.0.0.1:8091"</span></span><br><span class="line"><span class="comment">  #degrade current not support</span></span><br><span class="line">  <span class="attr">enableDegrade</span> = <span class="string">false</span></span><br><span class="line"><span class="comment">  #disable</span></span><br><span class="line">  <span class="attr">disable</span> = <span class="string">false</span></span><br><span class="line"><span class="comment">  #unit ms,s,m,h,d represents milliseconds, seconds, minutes, hours, days, default permanent</span></span><br><span class="line">  <span class="meta">max.commit.retry.timeout</span> = <span class="string">"-1"</span></span><br><span class="line">  <span class="meta">max.rollback.retry.timeout</span> = <span class="string">"-1"</span></span><br><span class="line">  <span class="attr">disableGlobalTransaction</span> = <span class="string">false</span></span><br><span class="line"><span class="attr">&#125;</span></span><br><span class="line"> </span><br><span class="line"><span class="attr">client</span> <span class="string">&#123;</span></span><br><span class="line">  <span class="meta">async.commit.buffer.limit</span> = <span class="string">10000</span></span><br><span class="line">  <span class="attr">lock</span> <span class="string">&#123;</span></span><br><span class="line">    <span class="meta">retry.internal</span> = <span class="string">10</span></span><br><span class="line">    <span class="meta">retry.times</span> = <span class="string">30</span></span><br><span class="line">  <span class="attr">&#125;</span></span><br><span class="line">  <span class="meta">report.retry.count</span> = <span class="string">5</span></span><br><span class="line">  <span class="meta">tm.commit.retry.count</span> = <span class="string">1</span></span><br><span class="line">  <span class="meta">tm.rollback.retry.count</span> = <span class="string">1</span></span><br><span class="line"><span class="attr">&#125;</span></span><br><span class="line"> </span><br><span class="line"><span class="attr">transaction</span> <span class="string">&#123;</span></span><br><span class="line">  <span class="meta">undo.data.validation</span> = <span class="string">true</span></span><br><span class="line">  <span class="meta">undo.log.serialization</span> = <span class="string">"jackson"</span></span><br><span class="line">  <span class="meta">undo.log.save.days</span> = <span class="string">7</span></span><br><span class="line"><span class="comment">  #schedule delete expired undo_log in milliseconds</span></span><br><span class="line">  <span class="meta">undo.log.delete.period</span> = <span class="string">86400000</span></span><br><span class="line">  <span class="meta">undo.log.table</span> = <span class="string">"undo_log"</span></span><br><span class="line"><span class="attr">&#125;</span></span><br><span class="line"> </span><br><span class="line"><span class="attr">support</span> <span class="string">&#123;</span></span><br><span class="line"><span class="comment">  ## spring</span></span><br><span class="line">  <span class="attr">spring</span> <span class="string">&#123;</span></span><br><span class="line"><span class="comment">    # auto proxy the DataSource bean</span></span><br><span class="line">    <span class="meta">datasource.autoproxy</span> = <span class="string">false</span></span><br><span class="line">  <span class="attr">&#125;</span></span><br><span class="line"><span class="attr">&#125;</span></span><br></pre></td></tr></table></figure><p>5.registry.conf</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">registry</span> <span class="string">&#123;</span></span><br><span class="line"><span class="comment">  # file 、nacos 、eureka、redis、zk</span></span><br><span class="line">  <span class="attr">type</span> = <span class="string">"nacos"</span></span><br><span class="line"> </span><br><span class="line">  <span class="attr">nacos</span> <span class="string">&#123;</span></span><br><span class="line">    <span class="attr">serverAddr</span> = <span class="string">"localhost:8848"</span></span><br><span class="line">    <span class="attr">namespace</span> = <span class="string">""</span></span><br><span class="line">    <span class="attr">cluster</span> = <span class="string">"default"</span></span><br><span class="line">  <span class="attr">&#125;</span></span><br><span class="line">  <span class="attr">eureka</span> <span class="string">&#123;</span></span><br><span class="line">    <span class="attr">serviceUrl</span> = <span class="string">"http://localhost:8761/eureka"</span></span><br><span class="line">    <span class="attr">application</span> = <span class="string">"default"</span></span><br><span class="line">    <span class="attr">weight</span> = <span class="string">"1"</span></span><br><span class="line">  <span class="attr">&#125;</span></span><br><span class="line">  <span class="attr">redis</span> <span class="string">&#123;</span></span><br><span class="line">    <span class="attr">serverAddr</span> = <span class="string">"localhost:6381"</span></span><br><span class="line">    <span class="attr">db</span> = <span class="string">"0"</span></span><br><span class="line">  <span class="attr">&#125;</span></span><br><span class="line">  <span class="attr">zk</span> <span class="string">&#123;</span></span><br><span class="line">    <span class="attr">cluster</span> = <span class="string">"default"</span></span><br><span class="line">    <span class="attr">serverAddr</span> = <span class="string">"127.0.0.1:2181"</span></span><br><span class="line">    <span class="meta">session.timeout</span> = <span class="string">6000</span></span><br><span class="line">    <span class="meta">connect.timeout</span> = <span class="string">2000</span></span><br><span class="line">  <span class="attr">&#125;</span></span><br><span class="line">  <span class="attr">file</span> <span class="string">&#123;</span></span><br><span class="line">    <span class="attr">name</span> = <span class="string">"file.conf"</span></span><br><span class="line">  <span class="attr">&#125;</span></span><br><span class="line"><span class="attr">&#125;</span></span><br><span class="line"> </span><br><span class="line"><span class="attr">config</span> <span class="string">&#123;</span></span><br><span class="line"><span class="comment">  # file、nacos 、apollo、zk</span></span><br><span class="line">  <span class="attr">type</span> = <span class="string">"file"</span></span><br><span class="line"> </span><br><span class="line">  <span class="attr">nacos</span> <span class="string">&#123;</span></span><br><span class="line">    <span class="attr">serverAddr</span> = <span class="string">"localhost"</span></span><br><span class="line">    <span class="attr">namespace</span> = <span class="string">""</span></span><br><span class="line">    <span class="attr">cluster</span> = <span class="string">"default"</span></span><br><span class="line">  <span class="attr">&#125;</span></span><br><span class="line">  <span class="attr">apollo</span> <span class="string">&#123;</span></span><br><span class="line">    <span class="meta">app.id</span> = <span class="string">"fescar-server"</span></span><br><span class="line">    <span class="meta">apollo.meta</span> = <span class="string">"http://192.168.1.204:8801"</span></span><br><span class="line">  <span class="attr">&#125;</span></span><br><span class="line">  <span class="attr">zk</span> <span class="string">&#123;</span></span><br><span class="line">    <span class="attr">serverAddr</span> = <span class="string">"127.0.0.1:2181"</span></span><br><span class="line">    <span class="meta">session.timeout</span> = <span class="string">6000</span></span><br><span class="line">    <span class="meta">connect.timeout</span> = <span class="string">2000</span></span><br><span class="line">  <span class="attr">&#125;</span></span><br><span class="line">  <span class="attr">file</span> <span class="string">&#123;</span></span><br><span class="line">    <span class="attr">name</span> = <span class="string">"file.conf"</span></span><br><span class="line">  <span class="attr">&#125;</span></span><br><span class="line"><span class="attr">&#125;</span></span><br></pre></td></tr></table></figure><p>6.domain</p><ul><li><p>CommonResult</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.kayleh.springcloud.alibaba.domain;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> lombok.AllArgsConstructor;</span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"><span class="keyword">import</span> lombok.NoArgsConstructor;</span><br><span class="line"> </span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CommonResult</span>&lt;<span class="title">T</span>&gt;</span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Integer code;</span><br><span class="line">    <span class="keyword">private</span> String  message;</span><br><span class="line">    <span class="keyword">private</span> T       data;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">CommonResult</span><span class="params">(Integer code, String message)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>(code,message,<span class="keyword">null</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>Storage</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.kayleh.springcloud.alibaba.domain;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"> </span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Storage</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">// 产品id</span></span><br><span class="line">    <span class="keyword">private</span> Long productId;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">//总库存</span></span><br><span class="line">    <span class="keyword">private</span> Integer total;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">    <span class="comment">//已用库存</span></span><br><span class="line">    <span class="keyword">private</span> Integer used;</span><br><span class="line"> </span><br><span class="line">  </span><br><span class="line">    <span class="comment">//剩余库存</span></span><br><span class="line">    <span class="keyword">private</span> Integer residue;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><p>7.Dao接口及实现</p><ul><li><p>StorageDao</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.kayleh.springcloud.alibaba.dao;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Mapper;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Param;</span><br><span class="line"> </span><br><span class="line"><span class="meta">@Mapper</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">StorageDao</span> </span>&#123;</span><br><span class="line">    <span class="comment">//扣减库存信息</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">decrease</span><span class="params">(@Param(<span class="string">"productId"</span>)</span> Long productId, @<span class="title">Param</span><span class="params">(<span class="string">"count"</span>)</span> Integer count)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>resources文件夹下新建mapper文件夹后添加</p><p>StorageMapper.xml</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span> <span class="meta-keyword">PUBLIC</span> <span class="meta-string">"-//mybatis.org//DTD Mapper 3.0//EN"</span> <span class="meta-string">"http://mybatis.org/dtd/mybatis-3-mapper.dtd"</span> &gt;</span></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">"com.kayleh.springcloud.alibaba.dao.StorageDao"</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">"BaseResultMap"</span> <span class="attr">type</span>=<span class="string">"com.kayleh.springcloud.alibaba.domain.Storage"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">"id"</span> <span class="attr">property</span>=<span class="string">"id"</span> <span class="attr">jdbcType</span>=<span class="string">"BIGINT"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"product_id"</span> <span class="attr">property</span>=<span class="string">"productId"</span> <span class="attr">jdbcType</span>=<span class="string">"BIGINT"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"total"</span> <span class="attr">property</span>=<span class="string">"total"</span> <span class="attr">jdbcType</span>=<span class="string">"INTEGER"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"used"</span> <span class="attr">property</span>=<span class="string">"used"</span> <span class="attr">jdbcType</span>=<span class="string">"INTEGER"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"residue"</span> <span class="attr">property</span>=<span class="string">"residue"</span> <span class="attr">jdbcType</span>=<span class="string">"INTEGER"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">"decrease"</span>&gt;</span></span><br><span class="line">        UPDATE</span><br><span class="line">            t_storage</span><br><span class="line">        SET</span><br><span class="line">            used = used + #&#123;count&#125;,residue = residue - #&#123;count&#125;</span><br><span class="line">        WHERE</span><br><span class="line">            product_id = #&#123;productId&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">update</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure></li></ul><p>8.Service接口及实现</p><ul><li><p>StorageService</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.kayleh.springcloud.alibaba.service;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">StorageService</span> </span>&#123;</span><br><span class="line">    </span><br><span class="line">     <span class="comment">// 扣减库存</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">decrease</span><span class="params">(Long productId, Integer count)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>StorageServiceImpl</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.kayleh.springcloud.alibaba.service.impl;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.kayleh.springcloud.alibaba.dao.StorageDao;</span><br><span class="line"><span class="keyword">import</span> com.kayleh.springcloud.alibaba.service.StorageService ;</span><br><span class="line"><span class="keyword">import</span> org.slf4j.Logger;</span><br><span class="line"><span class="keyword">import</span> org.slf4j.LoggerFactory;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> javax.annotation.Resource;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StorageServiceImpl</span> <span class="keyword">implements</span> <span class="title">StorageService</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Logger LOGGER = LoggerFactory.getLogger(StorageServiceImpl<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line"> </span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> StorageDao storageDao;</span><br><span class="line"> </span><br><span class="line">     <span class="comment">// 扣减库存</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">decrease</span><span class="params">(Long productId, Integer count)</span> </span>&#123;</span><br><span class="line">        LOGGER.info(<span class="string">"-------&gt;storage-service中扣减库存开始"</span>);</span><br><span class="line">        storageDao.decrease(productId,count);</span><br><span class="line">        LOGGER.info(<span class="string">"-------&gt;storage-service中扣减库存结束"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><p>9.Controller</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.kayleh.springcloud.alibaba.controller;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.kayleh.springcloud.alibaba.domain.CommonResult ;</span><br><span class="line"><span class="keyword">import</span> com.kayleh.springcloud.alibaba.service.StorageService ;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestController;</span><br><span class="line"> </span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StorageController</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> StorageService storageService;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">    <span class="comment">//扣减库存</span></span><br><span class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"/storage/decrease"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> CommonResult <span class="title">decrease</span><span class="params">(Long productId, Integer count)</span> </span>&#123;</span><br><span class="line">        storageService.decrease(productId, count);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> CommonResult(<span class="number">200</span>,<span class="string">"扣减库存成功！"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>10.Config配置</p><ul><li><p>MyBatisConfig</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.kayleh.springcloud.alibaba.config;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.mybatis.spring.annotation.MapperScan;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@MapperScan</span>(&#123;<span class="string">"com.kayleh.springcloud.alibaba.dao"</span>&#125;)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyBatisConfig</span> </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>DataSourceProxyConfig</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.kayleh.springcloud.alibaba.config;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.alibaba.druid.pool.DruidDataSource;</span><br><span class="line"><span class="keyword">import</span> io.seata.rm.datasource.DataSourceProxy;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.mybatis.spring.SqlSessionFactoryBean;</span><br><span class="line"><span class="keyword">import</span> org.mybatis.spring.transaction.SpringManagedTransactionFactory;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Value;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.context.properties.ConfigurationProperties;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.core.io.support.PathMatchingResourcePatternResolver;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> javax.sql.DataSource;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DataSourceProxyConfig</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="meta">@Value</span>(<span class="string">"$&#123;mybatis.mapperLocations&#125;"</span>)</span><br><span class="line">    <span class="keyword">private</span> String mapperLocations;</span><br><span class="line"> </span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="meta">@ConfigurationProperties</span>(prefix = <span class="string">"spring.datasource"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> DataSource <span class="title">druidDataSource</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> DruidDataSource();</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> DataSourceProxy <span class="title">dataSourceProxy</span><span class="params">(DataSource dataSource)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> DataSourceProxy(dataSource);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> SqlSessionFactory <span class="title">sqlSessionFactoryBean</span><span class="params">(DataSourceProxy dataSourceProxy)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        SqlSessionFactoryBean sqlSessionFactoryBean = <span class="keyword">new</span> SqlSessionFactoryBean();</span><br><span class="line">        sqlSessionFactoryBean.setDataSource(dataSourceProxy);</span><br><span class="line">        sqlSessionFactoryBean.setMapperLocations(<span class="keyword">new</span> PathMatchingResourcePatternResolver().getResources(mapperLocations));</span><br><span class="line">        sqlSessionFactoryBean.setTransactionFactory(<span class="keyword">new</span> SpringManagedTransactionFactory());</span><br><span class="line">        <span class="keyword">return</span> sqlSessionFactoryBean.getObject();</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><p>11.主启动</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.kayleh.springcloud.alibaba;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.SpringApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.autoconfigure.jdbc.DataSourceAutoConfiguration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.cloud.client.discovery.EnableDiscoveryClient;</span><br><span class="line"><span class="keyword">import</span> org.springframework.cloud.openfeign.EnableFeignClients;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.Arrays;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.ForkJoinWorkerThread;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="meta">@SpringBootApplication</span>(exclude = DataSourceAutoConfiguration<span class="class">.<span class="keyword">class</span>)</span></span><br><span class="line"><span class="class">@<span class="title">EnableDiscoveryClient</span></span></span><br><span class="line"><span class="class">@<span class="title">EnableFeignClients</span></span></span><br><span class="line"><span class="class"><span class="title">public</span> <span class="title">class</span> <span class="title">SeataStorageServiceApplication2002</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        SpringApplication.run(SeataStorageServiceApplication2002<span class="class">.<span class="keyword">class</span>, <span class="title">args</span>)</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="新建账户Account-Module"><a href="#新建账户Account-Module" class="headerlink" title="新建账户Account-Module"></a>新建账户Account-Module</h2><p>1.seata-account-service2003</p><p>2.POM</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">       <span class="comment">&lt;!--nacos--&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-alibaba-nacos-discovery<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">       <span class="comment">&lt;!--seata--&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-alibaba-seata<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">exclusions</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">                   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>seata-all<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">                   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.seata<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.seata<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>seata-all<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">version</span>&gt;</span>0.9.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">       <span class="comment">&lt;!--feign--&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-openfeign<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis.spring.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.0.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.1.37<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>druid-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.1.10<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><p>3.YML</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">2003</span></span><br><span class="line"> </span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">seata-account-service</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">alibaba:</span></span><br><span class="line">      <span class="attr">seata:</span></span><br><span class="line">        <span class="attr">tx-service-group:</span> <span class="string">fsp_tx_group</span></span><br><span class="line">    <span class="attr">nacos:</span></span><br><span class="line">      <span class="attr">discovery:</span></span><br><span class="line">        <span class="attr">server-addr:</span> <span class="string">localhost:8848</span></span><br><span class="line">  <span class="attr">datasource:</span></span><br><span class="line">    <span class="attr">driver-class-name:</span> <span class="string">com.mysql.jdbc.Driver</span></span><br><span class="line">    <span class="attr">url:</span> <span class="string">jdbc:mysql://localhost:3306/seata_account</span></span><br><span class="line">    <span class="attr">username:</span> <span class="string">root</span></span><br><span class="line">    <span class="attr">password:</span> <span class="number">1111111</span></span><br><span class="line"> </span><br><span class="line"><span class="attr">feign:</span></span><br><span class="line">  <span class="attr">hystrix:</span></span><br><span class="line">    <span class="attr">enabled:</span> <span class="literal">false</span></span><br><span class="line"> </span><br><span class="line"><span class="attr">logging:</span></span><br><span class="line">  <span class="attr">level:</span></span><br><span class="line">    <span class="attr">io:</span></span><br><span class="line">      <span class="attr">seata:</span> <span class="string">info</span></span><br><span class="line"> </span><br><span class="line"><span class="attr">mybatis:</span></span><br><span class="line">  <span class="attr">mapperLocations:</span> <span class="string">classpath:mapper/*.xml</span></span><br></pre></td></tr></table></figure><p>4.file.conf</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">transport</span> <span class="string">&#123;</span></span><br><span class="line"><span class="comment">  # tcp udt unix-domain-socket</span></span><br><span class="line">  <span class="attr">type</span> = <span class="string">"TCP"</span></span><br><span class="line"><span class="comment">  #NIO NATIVE</span></span><br><span class="line">  <span class="attr">server</span> = <span class="string">"NIO"</span></span><br><span class="line"><span class="comment">  #enable heartbeat</span></span><br><span class="line">  <span class="attr">heartbeat</span> = <span class="string">true</span></span><br><span class="line"><span class="comment">  #thread factory for netty</span></span><br><span class="line">  <span class="meta">thread-factory</span> <span class="string">&#123;</span></span><br><span class="line">    <span class="meta">boss-thread-prefix</span> = <span class="string">"NettyBoss"</span></span><br><span class="line">    <span class="meta">worker-thread-prefix</span> = <span class="string">"NettyServerNIOWorker"</span></span><br><span class="line">    <span class="meta">server-executor-thread-prefix</span> = <span class="string">"NettyServerBizHandler"</span></span><br><span class="line">    <span class="meta">share-boss-worker</span> = <span class="string">false</span></span><br><span class="line">    <span class="meta">client-selector-thread-prefix</span> = <span class="string">"NettyClientSelector"</span></span><br><span class="line">    <span class="meta">client-selector-thread-size</span> = <span class="string">1</span></span><br><span class="line">    <span class="meta">client-worker-thread-prefix</span> = <span class="string">"NettyClientWorkerThread"</span></span><br><span class="line"><span class="comment">    # netty boss thread size,will not be used for UDT</span></span><br><span class="line">    <span class="meta">boss-thread-size</span> = <span class="string">1</span></span><br><span class="line"><span class="comment">    #auto default pin or 8</span></span><br><span class="line">    <span class="meta">worker-thread-size</span> = <span class="string">8</span></span><br><span class="line">  <span class="attr">&#125;</span></span><br><span class="line">  <span class="attr">shutdown</span> <span class="string">&#123;</span></span><br><span class="line"><span class="comment">    # when destroy server, wait seconds</span></span><br><span class="line">    <span class="attr">wait</span> = <span class="string">3</span></span><br><span class="line">  <span class="attr">&#125;</span></span><br><span class="line">  <span class="attr">serialization</span> = <span class="string">"seata"</span></span><br><span class="line">  <span class="attr">compressor</span> = <span class="string">"none"</span></span><br><span class="line"><span class="attr">&#125;</span></span><br><span class="line"> </span><br><span class="line"><span class="attr">service</span> <span class="string">&#123;</span></span><br><span class="line"> </span><br><span class="line">  <span class="meta">vgroup_mapping.fsp_tx_group</span> = <span class="string">"default" #修改自定义事务组名称</span></span><br><span class="line"> </span><br><span class="line">  <span class="meta">default.grouplist</span> = <span class="string">"127.0.0.1:8091"</span></span><br><span class="line">  <span class="attr">enableDegrade</span> = <span class="string">false</span></span><br><span class="line">  <span class="attr">disable</span> = <span class="string">false</span></span><br><span class="line">  <span class="meta">max.commit.retry.timeout</span> = <span class="string">"-1"</span></span><br><span class="line">  <span class="meta">max.rollback.retry.timeout</span> = <span class="string">"-1"</span></span><br><span class="line">  <span class="attr">disableGlobalTransaction</span> = <span class="string">false</span></span><br><span class="line"><span class="attr">&#125;</span></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="attr">client</span> <span class="string">&#123;</span></span><br><span class="line">  <span class="meta">async.commit.buffer.limit</span> = <span class="string">10000</span></span><br><span class="line">  <span class="attr">lock</span> <span class="string">&#123;</span></span><br><span class="line">    <span class="meta">retry.internal</span> = <span class="string">10</span></span><br><span class="line">    <span class="meta">retry.times</span> = <span class="string">30</span></span><br><span class="line">  <span class="attr">&#125;</span></span><br><span class="line">  <span class="meta">report.retry.count</span> = <span class="string">5</span></span><br><span class="line">  <span class="meta">tm.commit.retry.count</span> = <span class="string">1</span></span><br><span class="line">  <span class="meta">tm.rollback.retry.count</span> = <span class="string">1</span></span><br><span class="line"><span class="attr">&#125;</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">## transaction log store</span></span><br><span class="line"><span class="attr">store</span> <span class="string">&#123;</span></span><br><span class="line"><span class="comment">  ## store mode: file、db</span></span><br><span class="line">  <span class="attr">mode</span> = <span class="string">"db"</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">  ## file store</span></span><br><span class="line">  <span class="attr">file</span> <span class="string">&#123;</span></span><br><span class="line">    <span class="attr">dir</span> = <span class="string">"sessionStore"</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">    # branch session size , if exceeded first try compress lockkey, still exceeded throws exceptions</span></span><br><span class="line">    <span class="meta">max-branch-session-size</span> = <span class="string">16384</span></span><br><span class="line"><span class="comment">    # globe session size , if exceeded throws exceptions</span></span><br><span class="line">    <span class="meta">max-global-session-size</span> = <span class="string">512</span></span><br><span class="line"><span class="comment">    # file buffer size , if exceeded allocate new buffer</span></span><br><span class="line">    <span class="meta">file-write-buffer-cache-size</span> = <span class="string">16384</span></span><br><span class="line"><span class="comment">    # when recover batch read size</span></span><br><span class="line">    <span class="meta">session.reload.read_size</span> = <span class="string">100</span></span><br><span class="line"><span class="comment">    # async, sync</span></span><br><span class="line">    <span class="meta">flush-disk-mode</span> = <span class="string">async</span></span><br><span class="line">  <span class="attr">&#125;</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">  ## database store</span></span><br><span class="line">  <span class="attr">db</span> <span class="string">&#123;</span></span><br><span class="line"><span class="comment">    ## the implement of javax.sql.DataSource, such as DruidDataSource(druid)/BasicDataSource(dbcp) etc.</span></span><br><span class="line">    <span class="attr">datasource</span> = <span class="string">"dbcp"</span></span><br><span class="line"><span class="comment">    ## mysql/oracle/h2/oceanbase etc.</span></span><br><span class="line">    <span class="meta">db-type</span> = <span class="string">"mysql"</span></span><br><span class="line">    <span class="meta">driver-class-name</span> = <span class="string">"com.mysql.jdbc.Driver"</span></span><br><span class="line">    <span class="attr">url</span> = <span class="string">"jdbc:mysql://127.0.0.1:3306/seata"</span></span><br><span class="line">    <span class="attr">user</span> = <span class="string">"root"</span></span><br><span class="line">    <span class="attr">password</span> = <span class="string">"123456"</span></span><br><span class="line">    <span class="meta">min-conn</span> = <span class="string">1</span></span><br><span class="line">    <span class="meta">max-conn</span> = <span class="string">3</span></span><br><span class="line">    <span class="meta">global.table</span> = <span class="string">"global_table"</span></span><br><span class="line">    <span class="meta">branch.table</span> = <span class="string">"branch_table"</span></span><br><span class="line">    <span class="meta">lock-table</span> = <span class="string">"lock_table"</span></span><br><span class="line">    <span class="meta">query-limit</span> = <span class="string">100</span></span><br><span class="line">  <span class="attr">&#125;</span></span><br><span class="line"><span class="attr">&#125;</span></span><br><span class="line"><span class="attr">lock</span> <span class="string">&#123;</span></span><br><span class="line"><span class="comment">  ## the lock store mode: local、remote</span></span><br><span class="line">  <span class="attr">mode</span> = <span class="string">"remote"</span></span><br><span class="line"> </span><br><span class="line">  <span class="attr">local</span> <span class="string">&#123;</span></span><br><span class="line"><span class="comment">    ## store locks in user's database</span></span><br><span class="line">  <span class="attr">&#125;</span></span><br><span class="line"> </span><br><span class="line">  <span class="attr">remote</span> <span class="string">&#123;</span></span><br><span class="line"><span class="comment">    ## store locks in the seata's server</span></span><br><span class="line">  <span class="attr">&#125;</span></span><br><span class="line"><span class="attr">&#125;</span></span><br><span class="line"><span class="attr">recovery</span> <span class="string">&#123;</span></span><br><span class="line"><span class="comment">  #schedule committing retry period in milliseconds</span></span><br><span class="line">  <span class="meta">committing-retry-period</span> = <span class="string">1000</span></span><br><span class="line"><span class="comment">  #schedule asyn committing retry period in milliseconds</span></span><br><span class="line">  <span class="meta">asyn-committing-retry-period</span> = <span class="string">1000</span></span><br><span class="line"><span class="comment">  #schedule rollbacking retry period in milliseconds</span></span><br><span class="line">  <span class="meta">rollbacking-retry-period</span> = <span class="string">1000</span></span><br><span class="line"><span class="comment">  #schedule timeout retry period in milliseconds</span></span><br><span class="line">  <span class="meta">timeout-retry-period</span> = <span class="string">1000</span></span><br><span class="line"><span class="attr">&#125;</span></span><br><span class="line"> </span><br><span class="line"><span class="attr">transaction</span> <span class="string">&#123;</span></span><br><span class="line">  <span class="meta">undo.data.validation</span> = <span class="string">true</span></span><br><span class="line">  <span class="meta">undo.log.serialization</span> = <span class="string">"jackson"</span></span><br><span class="line">  <span class="meta">undo.log.save.days</span> = <span class="string">7</span></span><br><span class="line"><span class="comment">  #schedule delete expired undo_log in milliseconds</span></span><br><span class="line">  <span class="meta">undo.log.delete.period</span> = <span class="string">86400000</span></span><br><span class="line">  <span class="meta">undo.log.table</span> = <span class="string">"undo_log"</span></span><br><span class="line"><span class="attr">&#125;</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">## metrics settings</span></span><br><span class="line"><span class="attr">metrics</span> <span class="string">&#123;</span></span><br><span class="line">  <span class="attr">enabled</span> = <span class="string">false</span></span><br><span class="line">  <span class="meta">registry-type</span> = <span class="string">"compact"</span></span><br><span class="line"><span class="comment">  # multi exporters use comma divided</span></span><br><span class="line">  <span class="meta">exporter-list</span> = <span class="string">"prometheus"</span></span><br><span class="line">  <span class="meta">exporter-prometheus-port</span> = <span class="string">9898</span></span><br><span class="line"><span class="attr">&#125;</span></span><br><span class="line"> </span><br><span class="line"><span class="attr">support</span> <span class="string">&#123;</span></span><br><span class="line"><span class="comment">  ## spring</span></span><br><span class="line">  <span class="attr">spring</span> <span class="string">&#123;</span></span><br><span class="line"><span class="comment">    # auto proxy the DataSource bean</span></span><br><span class="line">    <span class="meta">datasource.autoproxy</span> = <span class="string">false</span></span><br><span class="line">  <span class="attr">&#125;</span></span><br><span class="line"><span class="attr">&#125;</span></span><br></pre></td></tr></table></figure><p>5.registry.conf</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">registry</span> <span class="string">&#123;</span></span><br><span class="line"><span class="comment">  # file 、nacos 、eureka、redis、zk、consul、etcd3、sofa</span></span><br><span class="line">  <span class="attr">type</span> = <span class="string">"nacos"</span></span><br><span class="line"> </span><br><span class="line">  <span class="attr">nacos</span> <span class="string">&#123;</span></span><br><span class="line">    <span class="attr">serverAddr</span> = <span class="string">"localhost:8848"</span></span><br><span class="line">    <span class="attr">namespace</span> = <span class="string">""</span></span><br><span class="line">    <span class="attr">cluster</span> = <span class="string">"default"</span></span><br><span class="line">  <span class="attr">&#125;</span></span><br><span class="line">  <span class="attr">eureka</span> <span class="string">&#123;</span></span><br><span class="line">    <span class="attr">serviceUrl</span> = <span class="string">"http://localhost:8761/eureka"</span></span><br><span class="line">    <span class="attr">application</span> = <span class="string">"default"</span></span><br><span class="line">    <span class="attr">weight</span> = <span class="string">"1"</span></span><br><span class="line">  <span class="attr">&#125;</span></span><br><span class="line">  <span class="attr">redis</span> <span class="string">&#123;</span></span><br><span class="line">    <span class="attr">serverAddr</span> = <span class="string">"localhost:6379"</span></span><br><span class="line">    <span class="attr">db</span> = <span class="string">"0"</span></span><br><span class="line">  <span class="attr">&#125;</span></span><br><span class="line">  <span class="attr">zk</span> <span class="string">&#123;</span></span><br><span class="line">    <span class="attr">cluster</span> = <span class="string">"default"</span></span><br><span class="line">    <span class="attr">serverAddr</span> = <span class="string">"127.0.0.1:2181"</span></span><br><span class="line">    <span class="meta">session.timeout</span> = <span class="string">6000</span></span><br><span class="line">    <span class="meta">connect.timeout</span> = <span class="string">2000</span></span><br><span class="line">  <span class="attr">&#125;</span></span><br><span class="line">  <span class="attr">consul</span> <span class="string">&#123;</span></span><br><span class="line">    <span class="attr">cluster</span> = <span class="string">"default"</span></span><br><span class="line">    <span class="attr">serverAddr</span> = <span class="string">"127.0.0.1:8500"</span></span><br><span class="line">  <span class="attr">&#125;</span></span><br><span class="line">  <span class="attr">etcd3</span> <span class="string">&#123;</span></span><br><span class="line">    <span class="attr">cluster</span> = <span class="string">"default"</span></span><br><span class="line">    <span class="attr">serverAddr</span> = <span class="string">"http://localhost:2379"</span></span><br><span class="line">  <span class="attr">&#125;</span></span><br><span class="line">  <span class="attr">sofa</span> <span class="string">&#123;</span></span><br><span class="line">    <span class="attr">serverAddr</span> = <span class="string">"127.0.0.1:9603"</span></span><br><span class="line">    <span class="attr">application</span> = <span class="string">"default"</span></span><br><span class="line">    <span class="attr">region</span> = <span class="string">"DEFAULT_ZONE"</span></span><br><span class="line">    <span class="attr">datacenter</span> = <span class="string">"DefaultDataCenter"</span></span><br><span class="line">    <span class="attr">cluster</span> = <span class="string">"default"</span></span><br><span class="line">    <span class="attr">group</span> = <span class="string">"SEATA_GROUP"</span></span><br><span class="line">    <span class="attr">addressWaitTime</span> = <span class="string">"3000"</span></span><br><span class="line">  <span class="attr">&#125;</span></span><br><span class="line">  <span class="attr">file</span> <span class="string">&#123;</span></span><br><span class="line">    <span class="attr">name</span> = <span class="string">"file.conf"</span></span><br><span class="line">  <span class="attr">&#125;</span></span><br><span class="line"><span class="attr">&#125;</span></span><br><span class="line"> </span><br><span class="line"><span class="attr">config</span> <span class="string">&#123;</span></span><br><span class="line"><span class="comment">  # file、nacos 、apollo、zk、consul、etcd3</span></span><br><span class="line">  <span class="attr">type</span> = <span class="string">"file"</span></span><br><span class="line"> </span><br><span class="line">  <span class="attr">nacos</span> <span class="string">&#123;</span></span><br><span class="line">    <span class="attr">serverAddr</span> = <span class="string">"localhost"</span></span><br><span class="line">    <span class="attr">namespace</span> = <span class="string">""</span></span><br><span class="line">  <span class="attr">&#125;</span></span><br><span class="line">  <span class="attr">consul</span> <span class="string">&#123;</span></span><br><span class="line">    <span class="attr">serverAddr</span> = <span class="string">"127.0.0.1:8500"</span></span><br><span class="line">  <span class="attr">&#125;</span></span><br><span class="line">  <span class="attr">apollo</span> <span class="string">&#123;</span></span><br><span class="line">    <span class="meta">app.id</span> = <span class="string">"seata-server"</span></span><br><span class="line">    <span class="meta">apollo.meta</span> = <span class="string">"http://192.168.1.204:8801"</span></span><br><span class="line">  <span class="attr">&#125;</span></span><br><span class="line">  <span class="attr">zk</span> <span class="string">&#123;</span></span><br><span class="line">    <span class="attr">serverAddr</span> = <span class="string">"127.0.0.1:2181"</span></span><br><span class="line">    <span class="meta">session.timeout</span> = <span class="string">6000</span></span><br><span class="line">    <span class="meta">connect.timeout</span> = <span class="string">2000</span></span><br><span class="line">  <span class="attr">&#125;</span></span><br><span class="line">  <span class="attr">etcd3</span> <span class="string">&#123;</span></span><br><span class="line">    <span class="attr">serverAddr</span> = <span class="string">"http://localhost:2379"</span></span><br><span class="line">  <span class="attr">&#125;</span></span><br><span class="line">  <span class="attr">file</span> <span class="string">&#123;</span></span><br><span class="line">    <span class="attr">name</span> = <span class="string">"file.conf"</span></span><br><span class="line">  <span class="attr">&#125;</span></span><br><span class="line"><span class="attr">&#125;</span></span><br></pre></td></tr></table></figure><p>6.domain</p><ul><li><p>CommonResult</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.kayleh.springcloud.alibaba.domain;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> lombok.AllArgsConstructor;</span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"><span class="keyword">import</span> lombok.NoArgsConstructor;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CommonResult</span>&lt;<span class="title">T</span>&gt;</span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Integer code;</span><br><span class="line">    <span class="keyword">private</span> String  message;</span><br><span class="line">    <span class="keyword">private</span> T       data;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">CommonResult</span><span class="params">(Integer code, String message)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>(code,message,<span class="keyword">null</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>Account</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.kayleh.springcloud.alibaba.domain;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> lombok.AllArgsConstructor;</span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"><span class="keyword">import</span> lombok.NoArgsConstructor;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.math.BigDecimal;</span><br><span class="line"> </span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Account</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 用户id</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> Long userId;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 总额度</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> BigDecimal total;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 已用额度</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> BigDecimal used;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 剩余额度</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> BigDecimal residue;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><p>7.Dao接口及实现</p><ul><li><p>AccountDao</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.kayleh.springcloud.alibaba.dao;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Mapper;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Param;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Repository;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.math.BigDecimal;</span><br><span class="line"> </span><br><span class="line"><span class="meta">@Mapper</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">AccountDao</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 扣减账户余额</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">decrease</span><span class="params">(@Param(<span class="string">"userId"</span>)</span> Long userId, @<span class="title">Param</span><span class="params">(<span class="string">"money"</span>)</span> BigDecimal money)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>resources文件夹下新建mapper文件夹后添加</p><p>AccountMapper.xml</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span> <span class="meta-keyword">PUBLIC</span> <span class="meta-string">"-//mybatis.org//DTD Mapper 3.0//EN"</span> <span class="meta-string">"http://mybatis.org/dtd/mybatis-3-mapper.dtd"</span> &gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">"com.kayleh.springcloud.alibaba.dao.AccountDao"</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">"BaseResultMap"</span> <span class="attr">type</span>=<span class="string">"com.kayleh.springcloud.alibaba.domain.Account"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">"id"</span> <span class="attr">property</span>=<span class="string">"id"</span> <span class="attr">jdbcType</span>=<span class="string">"BIGINT"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"user_id"</span> <span class="attr">property</span>=<span class="string">"userId"</span> <span class="attr">jdbcType</span>=<span class="string">"BIGINT"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"total"</span> <span class="attr">property</span>=<span class="string">"total"</span> <span class="attr">jdbcType</span>=<span class="string">"DECIMAL"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"used"</span> <span class="attr">property</span>=<span class="string">"used"</span> <span class="attr">jdbcType</span>=<span class="string">"DECIMAL"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"residue"</span> <span class="attr">property</span>=<span class="string">"residue"</span> <span class="attr">jdbcType</span>=<span class="string">"DECIMAL"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">    <span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">"decrease"</span>&gt;</span></span><br><span class="line">        UPDATE t_account</span><br><span class="line">        SET</span><br><span class="line">          residue = residue - #&#123;money&#125;,used = used + #&#123;money&#125;</span><br><span class="line">        WHERE</span><br><span class="line">          user_id = #&#123;userId&#125;;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">update</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure></li></ul><p>8.Service接口及实现</p><ul><li><p>AccountService</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.kayleh.springcloud.alibaba.service;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestParam;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.ResponseBody;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> java.math.BigDecimal;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">AccountService</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 扣减账户余额</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">decrease</span><span class="params">(@RequestParam(<span class="string">"userId"</span>)</span> Long userId, @<span class="title">RequestParam</span><span class="params">(<span class="string">"money"</span>)</span> BigDecimal money)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>AccountServiceImpl</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.kayleh.springcloud.alibaba.service.impl;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.kayleh.springcloud.alibaba.dao.AccountDao;</span><br><span class="line"><span class="keyword">import</span> com.kayleh.springcloud.alibaba.service.AccountService ;</span><br><span class="line"><span class="keyword">import</span> org.slf4j.Logger;</span><br><span class="line"><span class="keyword">import</span> org.slf4j.LoggerFactory;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> javax.annotation.Resource;</span><br><span class="line"><span class="keyword">import</span> java.math.BigDecimal;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.TimeUnit;</span><br><span class="line"> </span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 账户业务实现类</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AccountServiceImpl</span> <span class="keyword">implements</span> <span class="title">AccountService</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Logger LOGGER = LoggerFactory.getLogger(AccountServiceImpl<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    AccountDao accountDao;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 扣减账户余额</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">decrease</span><span class="params">(Long userId, BigDecimal money)</span> </span>&#123;</span><br><span class="line">        </span><br><span class="line">         LOGGER.info(<span class="string">"-------&gt;account-service中扣减账户余额开始"</span>);</span><br><span class="line">        <span class="keyword">try</span> &#123; TimeUnit.SECONDS.sleep(<span class="number">20</span>); &#125; <span class="keyword">catch</span> (InterruptedException e) &#123; e.printStackTrace(); &#125;</span><br><span class="line">        accountDao.decrease(userId,money);</span><br><span class="line">        LOGGER.info(<span class="string">"-------&gt;account-service中扣减账户余额结束"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><p>9.Controller</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.kayleh.springcloud.alibaba.controller;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.kayleh.springcloud.alibaba.domain.CommonResult ;</span><br><span class="line"><span class="keyword">import</span> com.kayleh.springcloud.alibaba.service.AccountService ;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.PostMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestParam;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestController;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> javax.annotation.Resource;</span><br><span class="line"><span class="keyword">import</span> java.math.BigDecimal;</span><br><span class="line"> </span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AccountController</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    AccountService accountService;</span><br><span class="line"> </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 扣减账户余额</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@RequestMapping</span>(<span class="string">"/account/decrease"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> CommonResult <span class="title">decrease</span><span class="params">(@RequestParam(<span class="string">"userId"</span>)</span> Long userId, @<span class="title">RequestParam</span><span class="params">(<span class="string">"money"</span>)</span> BigDecimal money)</span>&#123;</span><br><span class="line">        accountService.decrease(userId,money);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> CommonResult(<span class="number">200</span>,<span class="string">"扣减账户余额成功！"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>10.Config配置</p><ul><li><p>MyBatisConfig</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.kayleh.springcloud.alibaba.config;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.mybatis.spring.annotation.MapperScan;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"> </span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@MapperScan</span>(&#123;<span class="string">"com.kayleh.springcloud.alibaba.dao"</span>&#125;)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyBatisConfig</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>DataSourceProxyConfig</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.kayleh.springcloud.alibaba.config;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> com.alibaba.druid.pool.DruidDataSource;</span><br><span class="line"><span class="keyword">import</span> io.seata.rm.datasource.DataSourceProxy;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.mybatis.spring.SqlSessionFactoryBean;</span><br><span class="line"><span class="keyword">import</span> org.mybatis.spring.transaction.SpringManagedTransactionFactory;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Value;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.context.properties.ConfigurationProperties;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.core.io.support.PathMatchingResourcePatternResolver;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> javax.sql.DataSource;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DataSourceProxyConfig</span> </span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="meta">@Value</span>(<span class="string">"$&#123;mybatis.mapperLocations&#125;"</span>)</span><br><span class="line">    <span class="keyword">private</span> String mapperLocations;</span><br><span class="line"> </span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="meta">@ConfigurationProperties</span>(prefix = <span class="string">"spring.datasource"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> DataSource <span class="title">druidDataSource</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> DruidDataSource();</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> DataSourceProxy <span class="title">dataSourceProxy</span><span class="params">(DataSource dataSource)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> DataSourceProxy(dataSource);</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> SqlSessionFactory <span class="title">sqlSessionFactoryBean</span><span class="params">(DataSourceProxy dataSourceProxy)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        SqlSessionFactoryBean sqlSessionFactoryBean = <span class="keyword">new</span> SqlSessionFactoryBean();</span><br><span class="line">        sqlSessionFactoryBean.setDataSource(dataSourceProxy);</span><br><span class="line">        sqlSessionFactoryBean.setMapperLocations(<span class="keyword">new</span> PathMatchingResourcePatternResolver().getResources(mapperLocations));</span><br><span class="line">        sqlSessionFactoryBean.setTransactionFactory(<span class="keyword">new</span> SpringManagedTransactionFactory());</span><br><span class="line">        <span class="keyword">return</span> sqlSessionFactoryBean.getObject();</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><p>11.主启动</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.kayleh.springcloud.alibaba;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.SpringApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.autoconfigure.jdbc.DataSourceAutoConfiguration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.cloud.client.discovery.EnableDiscoveryClient;</span><br><span class="line"><span class="keyword">import</span> org.springframework.cloud.openfeign.EnableFeignClients;</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="meta">@SpringBootApplication</span>(exclude = DataSourceAutoConfiguration<span class="class">.<span class="keyword">class</span>)</span></span><br><span class="line"><span class="class">@<span class="title">EnableDiscoveryClient</span></span></span><br><span class="line"><span class="class">@<span class="title">EnableFeignClients</span></span></span><br><span class="line"><span class="class"><span class="title">public</span> <span class="title">class</span> <span class="title">SeataAccountMainApp2003</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        SpringApplication.run(SeataAccountMainApp2003<span class="class">.<span class="keyword">class</span>, <span class="title">args</span>)</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="Test"><a href="#Test" class="headerlink" title="Test"></a>Test</h1><p>下订单-&gt;减库存-&gt;扣余额-&gt;改（订单）状态</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/Seata处理分布式事务/8.png" alt="1598418701820"></p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/Seata处理分布式事务/9.png" alt="1598418752655"></p><p>数据库初始情况</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/Seata处理分布式事务/10.png" alt="1598418770944"></p><p>正常下单</p><blockquote><p><a href="http://localhost:2001/order/create?userid=1&amp;producrid=1&amp;counr=10&amp;money=100" target="_blank" rel="noopener">http://localhost:2001/order/create?userid=1&amp;producrid=1&amp;counr=10&amp;money=100</a></p><p>数据库情况</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/Seata处理分布式事务/11.png" alt="1598418805563"></p></blockquote><h3 id="超时异常，没加-GlobalTransactional"><a href="#超时异常，没加-GlobalTransactional" class="headerlink" title="超时异常，没加@GlobalTransactional"></a>超时异常，没加@GlobalTransactional</h3><p>seata-order-service2003的decrease</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">在accountDao调用decrease之前</span><br><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line">    TimeUnit.SECONDS.sleep(<span class="number">20</span>);</span><br><span class="line">&#125;<span class="keyword">catch</span>(InterruptException e)&#123;</span><br><span class="line">    e.printStackTrace();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><p>AccountServiceImpl添加超时</p></li><li><p>数据库情况</p></li><li><p>故障情况</p><blockquote><p>当库存和账户余额扣减后，订单状态并没有设置为已经完成，没有从零改为1</p><p>而且由于feign的重试机制，账户余额还有可能被多次扣减</p></blockquote></li></ul><h3 id="超时异常，添加-GlobalTransactional"><a href="#超时异常，添加-GlobalTransactional" class="headerlink" title="超时异常，添加@GlobalTransactional"></a>超时异常，添加@GlobalTransactional</h3><p>orderServiceImpl</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GlobalTransactional</span>(name = <span class="string">"fsp-create-order"</span>,rollbackFor = Exception<span class="class">.<span class="keyword">class</span>)</span></span><br></pre></td></tr></table></figure><ul><li><p>AccountServiceImpl添加超时</p></li><li><p>OrderServiceImpl@GlobalTransactional</p></li><li><p>下单后数据库数据并没有任何改变</p><blockquote><p>记录都添加不进来</p></blockquote></li></ul><h1 id="Seata之原理简介"><a href="#Seata之原理简介" class="headerlink" title="Seata之原理简介"></a>Seata之原理简介</h1><h2 id="Seata"><a href="#Seata" class="headerlink" title="Seata"></a>Seata</h2><blockquote><p>2019年1月份蚂蚁金服和阿里巴巴共同开源的分布式事务解决方案</p><p>Simple Extensible Autonomous Transaction Architecture,简单可扩展自治事务框架</p><p>2020起初，参加工作后用1.0以后的版本<img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/Seata处理分布式事务/12.png" alt="图像"></p></blockquote><h2 id="再看TC-TM-RM三大组件"><a href="#再看TC-TM-RM三大组件" class="headerlink" title="再看TC/TM/RM三大组件"></a>再看TC/TM/RM三大组件</h2><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/Seata处理分布式事务/13.png" alt="1598419006224"></p><p>分布式事务的执行流程</p><blockquote><p>TM开启分布式事务(TM向TC注册全局事务记录)</p><p>换业务场景，编排数据库，服务等事务内资源（RM向TC汇报资源准备状态）</p><p>TM结束分布式事务，事务一阶段结束（TM通知TC提交/回滚分布式事务）</p><p>TC汇总事务信息，决定分布式事务是提交还是回滚</p><p>TC通知所有RM提交/回滚资源，事务二阶段结束。</p></blockquote><h2 id="AT模式如何做到对业务的无侵入"><a href="#AT模式如何做到对业务的无侵入" class="headerlink" title="AT模式如何做到对业务的无侵入"></a>AT模式如何做到对业务的无侵入</h2><p>是什么</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/Seata处理分布式事务/14.png" alt="1598419068562"></p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/Seata处理分布式事务/15.png" alt="1598419095784"></p><p>一阶段加载</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/Seata处理分布式事务/16.png" alt="1598419109689"></p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/Seata处理分布式事务/17.png" alt="1598419122066"></p><p>二阶段提交</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/Seata处理分布式事务/18.png" alt="1598419138114"></p><p>二阶段回滚</p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/Seata处理分布式事务/19.png" alt="1598419157493"></p><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/Seata处理分布式事务/20.png" alt="1598419170919"></p><p>debug</p><h5 id="补充"><a href="#补充" class="headerlink" title="补充"></a>补充</h5><p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/kayleh/cdn/img/Seata处理分布式事务/21.png" alt="1598419193998"></p><p><img src= "/img/loading.gif" data-lazy-src="/seata-handles-distributed-transactions/22.png" alt="1598419205394" style="zoom: 80%;"></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Seata&lt;/p&gt;
    
    </summary>
    
    
      <category term="分布式" scheme="https://kayleh.top/categories/%E5%88%86%E5%B8%83%E5%BC%8F/"/>
    
    
      <category term="DistributedMicroservices" scheme="https://kayleh.top/tags/DistributedMicroservices/"/>
    
  </entry>
  
</feed>
